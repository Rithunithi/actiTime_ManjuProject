var otelFull=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g}));var r="function",i="object",a="undefined",o="prototype",s="hasOwnProperty",c="default",u=Object,l=u[o],f=u.assign,d=u.create,p=u.defineProperty,g=l[s]},function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g}));var r="function",i="object",a="undefined",o="prototype",s="hasOwnProperty",c="default",u=Object,l=u[o],f=u.assign,d=u.create,p=u.defineProperty,g=l[s]},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(0);function i(){return typeof globalThis!==r.l&&globalThis?globalThis:typeof self!==r.l&&self?self:typeof window!==r.l&&window?window:typeof global!==r.l&&global?global:null}function a(e){throw new TypeError(e)}function o(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&a("Object prototype may only be an Object:"+e),i[r.k]=e,new i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1);function i(){return typeof globalThis!==r.l&&globalThis?globalThis:typeof self!==r.l&&self?self:typeof window!==r.l&&window?window:typeof global!==r.l&&global?global:null}function a(e){throw new TypeError(e)}function o(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&a("Object prototype may only be an Object:"+e),i[r.k]=e,new i}},,,,,,,function(e,t,n){"use strict";n.r(t);var r,i=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),o=new(function(){function e(){this.externalLogger=new a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;Object.create;var l,f=(l=[],{fireEvent:function(e){l.forEach((function(t){return t(e)}))},addListener:function(e){e&&l.push(e)}});function d(e,t,n){f.fireEvent({level:e,category:t,message:n})}function p(e,t,n){d(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}var g,v={};!function(e){var t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,n=/^[a-zA-Z0-9_\.]{1,95}$/;function r(e){return n.test(e)}function i(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!r(e.name))throw new Error("Invalid dataField name");2===e.dataType&&a(e.value)}))}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!r(n.name))throw new Error("Invalid eventContract");i(n.dataFields)}i(e.dataFields)},e.validateInt=a}(g||(g={}));function h(e,t){return{name:e,dataType:1,value:t,classification:4}}function m(e,t){return{name:e,dataType:2,value:t,classification:4}}function y(e,t){return{name:e,dataType:3,value:t,classification:4}}function T(e,t){return{name:e,dataType:0,value:t,classification:4}}function b(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?u({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var S=function(){function e(e,t,n){var r,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=u(u({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.sendTelemetryEvent=function(e){var t=b(e),n=t.telemetryProperties;if(n.customerContentVersion||n.customerContentType)d(0,0,(function(){return"Customer content"}));else{if(!n.ariaTenantToken||!n.nexusTenantToken){var r=function(e){for(var t=e.length;t>0;){var n=e.substr(0,t);if(v[n])return v[n];t=e.lastIndexOf(".",t-1)}}(t.eventName);if(!r)return void d(0,0,(function(){return"No tenant token: "+e.eventName}));n.ariaTenantToken=r.ariaTenantToken,n.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=b(e),n=t.telemetryProperties;return(!n.customerContentVersion||n.customerContentVersion>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,t.dataFields.push(m("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):d(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void p(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){var n=e.telemetryProperties;n.customerContentVersion&&n.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(T("OTelJS.Version","4.8.10")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(n=i.dataFields).push.apply(n,this.partAFields),e.eventContract=i}this.config.disableValidation||g.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,t=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&t.forEach((function(t){e.sendTelemetryEventInternal(t)}))},e.prototype.setTenantToken=function(e,t,n){!function(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?v[e]=t:d(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return b(e)},e.prototype.getConfig=function(){return this.config},e}(),C=n(16),E=Object,_=E.getPrototypeOf,x=0;function w(e,t){return e&&E.prototype.hasOwnProperty.call(e,t)}function O(e){return e&&(e===E.prototype||e===Array.prototype)}function k(e){return O(e)||e===Function.prototype}function P(e){if(e){if(_)return _(e);var t=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(t)return t}return null}function I(e,t){var n=[],r=E.getOwnPropertyNames;if(r)n=r(e);else for(var i in e)"string"==typeof i&&w(e,i)&&n.push(i);if(n&&n.length>0)for(var a=0;a<n.length;a++)t(n[a])}function M(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||w(e,t))}function N(e){throw new TypeError("DynamicProto: "+e)}function F(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function A(e,t,n,r){var i=null;if(e&&w(n,"_dynClass")){var a=e._dynInstFuncs||{};if((i=(a[n._dynClass]||{})[t])||N("Missing ["+t+"] function"),!i._dynInstChk&&!1!==a._dynInstChk){for(var o=!w(e,t),s=P(e),c=[];o&&s&&!k(s)&&!F(c,s);){var u=s[t];if(u){o=u===r;break}c.push(s),s=P(s)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){a._dynInstChk=!1}}}return i}function L(e,t,n){var r=t[e];return r===n&&(r=P(t)[e]),"function"!=typeof r&&N("["+e+"] is not a function"),r}function D(e,t,n,r,i){if(!O(e)){var a=n._dynInstFuncs=n._dynInstFuncs||{},o=a[t]=a[t]||{};!1!==a._dynInstChk&&(a._dynInstChk=!!i),I(n,(function(t){M(n,t,!1)&&n[t]!==r[t]&&(o[t]=n[t],delete n[t],(!w(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var r=A(this,t,e,n)||L(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function R(e,t){return w(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function U(e,t,n,r){w(e,"prototype")||N("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(_)for(var n=[],r=P(t);r&&!k(r)&&!F(n,r);){if(r===e)return!0;n.push(r),r=P(r)}return!1})(i,t)||N("["+R(e)+"] is not in class hierarchy of ["+R(t)+"]");var a=null;w(i,"_dynClass")?a=i._dynClass:(a="_dynCls$"+R(e,"_")+"$"+x,x++,i._dynClass=a);var o=U._dfOpts,s=!!o.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var c=function(e){var t={};return I(e,(function(n){!t[n]&&M(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var a=e._dynInstFuncs||{};!1!==a._dynInstChk&&(i=(a[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var a={};I(n,(function(e){a[e]=i(t,n,e)}));for(var o=P(e),s=[];o&&!k(o)&&!F(s,o);)I(o,(function(e){!a[e]&&M(o,e,!_)&&(a[e]=i(t,o,e))})),s.push(o),o=P(o);return a}(i,t,c,s));var u=!!_&&!!o.setInstFuncs;u&&r&&(u=!!r.setInstFuncs),D(i,a,t,c,!1!==u)}U._dfOpts={setInstFuncs:!0,useBaseInst:!0};var W=U,B=n(0),j=n(5),V=B.d;B.b.freeze,B.b.seal;function K(e){return B.f.toString.call(e)}function z(e,t){return typeof e===t}function H(e){return void 0===e||typeof e===B.l}function q(e){return null===e||H(e)}function J(e){return!q(e)}function G(e,t){return e&&B.e.call(e,t)}function Q(e){return typeof e===B.j}function X(e){return typeof e===B.h}function Z(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!q(e))try{q(e.addEventListener)?q(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function $(e,t,n,r){if(void 0===r&&(r=!1),!q(e))try{q(e.removeEventListener)?q(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}function Y(e,t){if(e)for(var n in e)B.e.call(e,n)&&t.call(e,n,e[n])}function ee(e,t){if(e&&t){var n=t.length,r=e.length;if(e===t)return!0;if(r>=n){for(var i=r-1,a=n-1;a>=0;a--){if(e[i]!=t[a])return!1;i--}return!0}}return!1}function te(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function ne(e){return"[object Date]"===K(e)}function re(e){return"[object Array]"===K(e)}function ie(e){return"[object Error]"===K(e)}function ae(e){return"string"==typeof e}function oe(e){return"number"==typeof e}function se(e){return"boolean"==typeof e}function ce(e){if(ne(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ue(e,t,n){for(var r=e.length,i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}function le(e,t,n){for(var r=e.length,i=n||0,a=Math.max(i>=0?i:r-Math.abs(i),0);a<r;a++)if(a in e&&e[a]===t)return a;return-1}function fe(e,t,n){for(var r=e.length,i=n||e,a=new Array(r),o=0;o<r;o++)o in e&&(a[o]=t.call(i,e[o],e));return a}function de(e,t,n){var r,i=e.length,a=0;if(arguments.length>=3)r=arguments[2];else{for(;a<i&&!(a in e);)a++;r=e[a++]}for(;a<i;)a in e&&(r=t(r,e[a],a,e)),a++;return r}function pe(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var ge=!{toString:null}.propertyIsEnumerable("toString"),ve=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function he(e){var t=typeof e;t===B.h||t===B.j&&null!==e||Object(j.c)("objKeys called on non-object");var n=[];for(var r in e)e&&B.e.call(e,r)&&n.push(r);if(ge)for(var i=ve.length,a=0;a<i;a++)e&&B.e.call(e,ve[a])&&n.push(ve[a]);return n}function me(e,t,n,r){if(V)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),V(e,t,i),!0}catch(e){}return!1}function ye(){var e=Date;return e.now?e.now():(new e).getTime()}function Te(e,t,n,r,i){var a=n;return e&&((a=e[t])===n||i&&!i(a)||r&&!r(n)||(a=n,e[t]=a)),a}function be(e){return!e}function Se(e){return!!e}function Ce(e){throw new Error(e)}var Ee,_e=function(){function e(t,n,r){var i,a=this,o=!1;(a.start=ye(),a.name=t,a.isAsync=r,a.isChildEvt=function(){return!1},X(n))&&(o=me(a,"payload",(function(){return!i&&X(n)&&(i=n(),n=null),i})));a.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?a[t]:(a.ctx||{})[t]:null},a.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)a[t]||(a.isChildEvt=function(){return!0}),a[t]=n;else if(t===e.ChildrenContextKey)a[t]=n;else{(a.ctx=a.ctx||{})[t]=n}},a.complete=function(){var t=0,r=a.getCtx(e.ChildrenContextKey);if(re(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}a.time=ye()-a.start,a.exTime=a.time-t,a.complete=function(){},!o&&X(n)&&(a.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),xe=function e(t){this.ctx={},W(e,this,(function(e){e.create=function(e,t,n){return new _e(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))};function we(e,t,n,r,i){if(e){var a=e;if(X(a.getPerfMgr)&&(a=a.getPerfMgr()),a){var o=void 0,s=a.getCtx("CoreUtils.doPerf");try{if(o=a.create(t(),r,i)){if(s&&o.setCtx&&(o.setCtx(_e.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(_e.ChildrenContextKey);c||(c=[],s.setCtx(_e.ChildrenContextKey,c)),c.push(o)}return a.setCtx("CoreUtils.doPerf",o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&a.fire(o),a.setCtx("CoreUtils.doPerf",s)}}}return n()}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Ee||(Ee={}));var Oe={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103},ke=null,Pe=null,Ie=!1;function Me(e){var t=Object(j.a)();return t&&t[e]?t[e]:"window"===e&&Ne()?window:null}function Ne(){return Boolean(typeof window===B.j&&window)}function Fe(){return Ne()?window:Me("window")}function Ae(){return Boolean(typeof document===B.j&&document)?document:Me("document")}function Le(){return Boolean(typeof navigator===B.j&&navigator)}function De(){return Le()?navigator:Me("navigator")}function Re(){return Boolean(typeof JSON===B.j&&JSON||null!==Me("JSON"))}function Ue(){return Re()?JSON||Me("JSON"):null}function We(){var e=De();if(e&&(e.userAgent!==Pe||null===ke)){var t=((Pe=e.userAgent)||"").toLowerCase();ke=te(t,"msie")||te(t,"trident/")}return ke}function Be(e){var t=Object[B.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Re()&&(n=Ue().stringify(e)),t+n}function je(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Ve=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";Re()&&(i=Ue().stringify(r));var a=(t?" message:"+je(t):"")+(r?" props:"+je(i):"");this.message+=a}return e.dataType="MessageData",e}();var Ke=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};W(e,this,(function(e){function i(e,n){var r=t[e];return q(r)?n:r}q(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,a,o){void 0===o&&(o=!1);var s=new Ve(n,i,o,a);if(e.enableDebugExceptions())throw s;if(!H(s.message)){var c=e.consoleLoggingLevel();if(o){var u=+s.messageId;!r[u]&&c>=Ee.WARNING&&(e.warnToConsole(s.message),r[u]=!0)}else c>=Ee.WARNING&&e.warnToConsole(s.message);e.logInternalMessage(t,s)}},e.warnToConsole=function(e){var t=typeof console!==B.l?console:Me("console");if(t){var n="log";t.warn&&(n="warn"),X(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var a=!0,o="AITR_"+i.messageId;if(r[o]?a=!1:r[o]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new Ve(Oe.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))},ze=function(e,t){var n=this,r=null,i=X(e.processTelemetry),a=X(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(o,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";we(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{s.setNext(r),a&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(o,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(Ee.CRITICAL,Oe.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(o,s)}}else r&&(n._hasRun=!0,r.processTelemetry(o,s))}),(function(){return{item:o}}),!o.sync)}};function He(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var a=e[i];if(a&&X(a.processTelemetry)){var o=new ze(a,t);n.push(o),r&&r.setNext(o),r=o}}return n.length>0?n[0]:null}var qe=function e(t,n,r,i){var a=this,o=null;null!==i&&(t&&X(t.getPlugin)?o=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var a=e.getPlugin();(i||a===n)&&(i=!0,r.push(a)),e=e.getNext()}return i||r.push(n),He(r,t)}(t,a,i||t.getPlugin()):i?o=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],ue(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),He(r,t)}(t,a,i):H(i)&&(o=He(t,a))),a.core=function(){return r},a.diagLog=function(){return function(e,t){return(e||{}).logger||new Ke(t)}(r,n)},a.getCfg=function(){return n},a.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},a.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var o=a.getExtCfg(e,null);return o&&!q(o[t])?i=o[t]:n&&!q(n[t])&&(i=n[t]),q(i)?r:i},a.hasNext=function(){return null!=o},a.getNext=function(){return o},a.setNext=function(e){o=e},a.processNext=function(e){var t=o;t&&(o=t.getNext(),t.processTelemetry(e,a))},a.createNew=function(t,i){return void 0===t&&(t=null),new e(t||o,n,r,i)}},Je=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&X(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var a=n||new qe(null,{},e.core);i=r&&r.getPlugin?a.createNew(null,r.getPlugin):a.createNew(null,r)}return i},e._baseTelInit=function(i,a,o,s){i&&Te(i,"extensionConfig",[],null,q),!s&&a&&(s=a.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=a,n=new qe(s,i,a,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}();function Ge(e,t){for(var n=[],r=null,i=e.getNext();i;){var a=i.getPlugin();a&&(r&&X(r.setNextPlugin)&&X(a.processTelemetry)&&r.setNextPlugin(a),X(a.isInitialized)&&a.isInitialized()||n.push(a),r=a,i=i.getNext())}ue(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function Qe(e){return e.sort((function(e,t){var n=0,r=X(t.processTelemetry);return X(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var Xe=function(e){function t(){var n,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){ue(e,(function(e){e.priority<500&&Ce("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,W(t,r,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&ue(n,(function(n){n.length>0&&r._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(r,a,o){e.isInitialized()||(t.initialize(r,a,o),function(e,t){n=[],e&&ue(e,(function(e){return i(e)}));if(t){var r=[];ue(t,(function(e){e.priority>500&&r.push(e)})),i(r)}}((r||{}).channels,o),ue(n,(function(e){return Ge(new qe(e,r,a),o)})))}})),r}var n;return Object(C.b)(t,e),t._staticInit=(me(n=t.prototype,"ChannelControls",n.getChannelControls),void me(n,"channelQueue",n.getChannelControls)),t}(Je),Ze=null,$e=null,Ye=null,et=Ae(),tt={},nt={};function rt(e,t){var n=at._ckMgr||nt._ckMgr;return n||(n=at._ckMgr=at(e,t),nt._ckMgr=n),n}function it(e){return!e||e.isEnabled()}function at(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Te(t,"domain",e.cookieDomain,J,q),Te(t,"path",e.cookiePath||"/",null,q),q(t.enabled)){var n=void 0;H(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),H(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||nt),r=n.path||"/",i=n.domain,a=!1!==n.enabled,o={isEnabled:function(){var e=a&&ot(t),n=nt._ckMgr;return e&&n&&o!==n&&(e=it(n)),e},setEnabled:function(e){a=!1!==e},set:function(e,t,a,s,c){if(it(o)){var u={},l=pe(t||""),f=l.indexOf(";");if(-1!==f&&(l=pe(t.substring(0,f)),u=st(t.substring(f+1))),Te(u,"domain",s||i,Se,H),!q(a)){var d=We();if(H(u.expires)){var p=ye()+1e3*a;if(p>0){var g=new Date;g.setTime(p),Te(u,"expires",ct(g,d?"toGMTString":"toUTCString")||ct(g,d?"toGMTString":"toUTCString")||"",Se)}}d||Te(u,"max-age",""+a,null,H)}var v=function(e){if(e&&Ie){var t=Me("__mockLocation");if(t)return t}return typeof location===B.j&&location?location:Me("location")}();v&&"https:"===v.protocol&&(Te(u,"secure",null,null,H),null===$e&&($e=!dt((De()||{}).userAgent)),$e&&Te(u,"SameSite","None",null,H)),Te(u,"path",c||r,null,H),(n.setCookie||ft)(e,ut(l,u))}},get:function(e){var t="";return it(o)&&(t=(n.getCookie||lt)(e)),t},del:function(e,t){it(o)&&o.purge(e,t)},purge:function(e,r){if(ot(t)){var i=((a={}).path=r||"/",a.expires="Thu, 01 Jan 1970 00:00:01 GMT",a);We()||(i["max-age"]="0"),(n.delCookie||ft)(e,ut("",i))}var a}};return o._ckMgr=o,o}function ot(e){if(null===Ze){Ze=!1;try{Ze=void 0!==(et||{}).cookie}catch(n){e&&e.throwInternal(Ee.WARNING,Oe.CannotAccessCookie,"Cannot access document.cookie - "+(ie(t=n)?t.name:""),{exception:Be(n)})}}var t;return Ze}function st(e){var t={};e&&e.length&&ue(pe(e).split(";"),(function(e){if(e=pe(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[pe(e.substring(0,n))]=pe(e.substring(n+1))}}));return t}function ct(e,t){return X(e[t])?e[t]():null}function ut(e,t){var n=e||"";return Y(t,(function(e,t){n+="; "+e+(q(t)?"":"="+t)})),n}function lt(e){var t="";if(et){var n=et.cookie||"";Ye!==n&&(tt=st(n),Ye=n),t=pe(tt[e]||"")}return t}function ft(e,t){et&&(et.cookie=e+"="+t)}function dt(e){return!!ae(e)&&(!(!te(e,"CPU iPhone OS 12")&&!te(e,"iPad; CPU OS 12"))||(!!(te(e,"Macintosh; Intel Mac OS X 10_14")&&te(e,"Version/")&&te(e,"Safari"))||(!(!te(e,"Macintosh; Intel Mac OS X 10_14")||!ee(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!te(e,"Chrome/5")&&!te(e,"Chrome/6"))||(!(!te(e,"UnrealEngine")||te(e,"Chrome"))||!(!te(e,"UCBrowser/12")&&!te(e,"UCBrowser/11")))))))}var pt=2,gt=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;W(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=le(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=le(e.listeners,t)},e.eventsSent=function(t){ue(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){ue(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){ue(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||ue(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},vt=function(e){function t(){var n=e.call(this)||this;return W(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],pt)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new Ke(e),i||new gt(e))},e.track=function(r){we(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),Ce("Invalid telemetry item")),function(e){if(q(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];ue(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:ce(new Date),baseType:Ve.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return Object(C.b)(t,e),t}((function e(){var t,n,r,i,a,o=!1;W(e,this,(function(e){e._extensions=new Array,n=new Xe,e.logger=Object(j.b)({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return o},e.initialize=function(t,i,a,s){var c,u,l,f;e.isInitialized()&&Ce("Core should not be initialized more than once"),t&&!q(t.instrumentationKey)||Ce("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=t||{},t.extensions=q(t.extensions)?[]:t.extensions,(u="extensionConfig",(c=t)?!(f=c[u])&&q(f)&&(f=H(l)?{}:l,c[u]=f):f=H(l)?{}:l,f).NotificationManager=s,a&&(e.logger=a);var d=[];d.push.apply(d,i.concat(t.extensions)),d=Qe(d);var p=[],g=[],v={};ue(d,(function(e){(q(e)||q(e.initialize))&&Ce("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(q(v[t])?v[t]=r:a.warnToConsole("Two extensions have same priority #"+t+" - "+v[t]+", "+r)),!t||t<n.priority?p.push(e):g.push(e)})),d.push(n),p.push(n),d=Qe(d),e._extensions=d,Ge(new qe([n],t,e),d),Ge(new qe(p,t,e),d),e._extensions=p,0===e.getTransmissionControls().length&&Ce("No channels available"),o=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){Te(n,"iKey",e.config.instrumentationKey,null,be),Te(n,"time",ce(new Date),null,be),Te(n,"ver","4.0",null,q),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new qe(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=Object(j.b)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return a||(a=at(e.config,e.logger)),a},e.setCookieMgr=function(e){a=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new xe(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(ue(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),ht=1,mt=4,yt=0,Tt=1,bt=6,St=7,Ct=Object(C.a)(Object(C.a)({},Oe),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),Et=!1,_t=123456789,xt=987654321;function wt(e){e<0&&(e>>>=0),_t=123456789+e&4294967295,xt=987654321-e&4294967295,Et=!0}function Ot(){try{var e=2147483647&ye();wt((4294967296*Math.random()^e)+e)}catch(e){}}function kt(e){return e>0?Math.floor(Pt()/4294967295*(e+1))>>>0:0}function Pt(e){var t,n=Me("crypto")||Me("msCrypto");return n&&n.getRandomValues?t=4294967295&n.getRandomValues(new Uint32Array(1))[0]:We()?(Et||Ot(),t=4294967295&Mt()):t=Math.floor(4294967296*Math.random()|0),e||(t>>>=0),t}function It(e){e?wt(e):Ot()}function Mt(e){var t=((xt=36969*(65535&xt)+(xt>>16)&4294967295)<<16)+(65535&(_t=18e3*(65535&_t)+(_t>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}var Nt,Ft=null;B.l;function At(e,t){var n=!1,r=Fe();r&&(n=Z(r,e,t),n=Z(r.body,e,t)||n);var i=Ae();return i&&(n=Vt.Attach(i,e,t)||n),n}function Lt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(jt,(function(e){var t=0|kt(15);return("x"===e?t:3&t|8).toString(16)}))}function Dt(){var e=Me("performance");return e&&e.now?e.now():ye()}function Rt(e){void 0===e&&(e=22);for(var t=Pt()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Pt()<<2&4294967295|3&t)>>>0,n=0);return r}function Ut(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Pt())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Pt())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var Wt,Bt={_canUseCookies:void 0,isTypeof:z,isUndefined:H,isNullOrUndefined:q,hasOwnProperty:G,isFunction:X,isObject:Q,isDate:ne,isArray:re,isError:ie,isString:ae,isNumber:oe,isBoolean:se,toISOString:ce,arrForEach:ue,arrIndexOf:le,arrMap:fe,arrReduce:de,strTrim:pe,objCreate:j.b,objKeys:he,objDefineAccessors:me,addEventHandler:At,dateNow:ye,isIE:We,disableCookies:function(){Kt().setEnabled(!1)},newGuid:Lt,perfNow:Dt,newId:Rt,randomValue:kt,random32:Pt,mwcRandomSeed:It,mwcRandom32:Mt,generateW3CId:Ut},jt=/[xy]/g,Vt={Attach:Z,AttachEvent:Z,Detach:$,DetachEvent:$};function Kt(e,t){var n=rt(e,t),r=Bt._canUseCookies;return null===Ft&&(Ft=[],Nt=r,me(Bt,"_canUseCookies",(function(){return Nt}),(function(e){Nt=e,ue(Ft,(function(t){t.setEnabled(e)}))}))),-1===le(Ft,n)&&Ft.push(n),se(r)&&n.setEnabled(r),se(Nt)&&n.setEnabled(Nt),n}(Wt={})[0]=yt,Wt[2]=bt,Wt[1]=Tt,Wt[3]=St,Wt[4098]=bt,Wt[4097]=Tt,Wt[4099]=St;Boolean(Ae()),Boolean(Fe());function zt(e){return!!(e&&oe(e)&&e>=ht&&e<=mt)}function Ht(e){void 0===e&&(e="D");var t=Lt();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function qt(e,t,n,r,i){var a={},o=!1,s=0,c=arguments.length,u=Object[B.k],l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(o=l[0],s++);s<c;s++){Y(e=l[s],(function(e,t){o&&t&&Q(t)?re(t)?(a[e]=a[e]||[],ue(t,(function(t,n){t&&Q(t)?a[e][n]=qt(!0,a[e][n],t):a[e][n]=t}))):a[e]=qt(!0,a[e],t):a[e]=t}))}return a}var Jt=Dt;B.l,B.j,B.l,j.b;var Gt,Qt=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",W(t,n,(function(e,t){e.initialize=function(n,r,i,a){we(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var o=n.propertyStorageOverride;if(o&&(!o.getProperty||!o.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&ue(n.channels,(function(t){t&&ue(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&ue(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,i,a)}catch(t){e.logger.throwInternal(Ee.CRITICAL,Ct.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:r,logger:i,notificationManager:a}}))},e.track=function(n){we(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Jt(),zt(r.latency)||(r.latency=ht);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver="1DS-Web-JS-3.1.4";var a=r.baseData=r.baseData||{};a.properties||(a.properties={});var o=a.properties;o.version||(o.version=""),""!==e.pluginVersionString&&(o.version=e.pluginVersionString)}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(C.b)(t,e),t}(vt),Xt=n(17),Zt=n(1),$t=n(6);!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Gt||(Gt={}));var Yt={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103},en=0,tn=13,nn=32,rn=1,an=2,on=3,sn=4,cn=0,un=1,ln=6,fn=7,dn=Object(Xt.a)(Object(Xt.a)({},Yt),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),pn=Zt.d;Zt.b.freeze,Zt.b.seal;function gn(e){return Zt.f.toString.call(e)}function vn(e,t){return typeof e===t}function hn(e){return void 0===e||typeof e===Zt.l}function mn(e){return null===e||hn(e)}function yn(e){return!mn(e)}function Tn(e,t){return e&&Zt.e.call(e,t)}function bn(e){return typeof e===Zt.j}function Sn(e){return typeof e===Zt.h}function Cn(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!mn(e))try{mn(e.addEventListener)?mn(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function En(e,t,n,r){if(void 0===r&&(r=!1),!mn(e))try{mn(e.removeEventListener)?mn(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}function _n(e,t){if(e)for(var n in e)Zt.e.call(e,n)&&t.call(e,n,e[n])}function xn(e,t){if(e&&t){var n=t.length,r=e.length;if(e===t)return!0;if(r>=n){for(var i=r-1,a=n-1;a>=0;a--){if(e[i]!=t[a])return!1;i--}return!0}}return!1}function wn(e,t){var n=!1;if(e&&t){var r=t.length;if(e===t)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}}return n}function On(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function kn(e){return"[object Date]"===gn(e)}function Pn(e){return"[object Array]"===gn(e)}function In(e){return"[object Error]"===gn(e)}function Mn(e){return"string"==typeof e}function Nn(e){return"number"==typeof e}function Fn(e){return"boolean"==typeof e}function An(e){if(kn(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Ln(e,t,n){for(var r=e.length,i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}function Dn(e,t,n){for(var r=e.length,i=n||0,a=Math.max(i>=0?i:r-Math.abs(i),0);a<r;a++)if(a in e&&e[a]===t)return a;return-1}function Rn(e,t,n){for(var r=e.length,i=n||e,a=new Array(r),o=0;o<r;o++)o in e&&(a[o]=t.call(i,e[o],e));return a}function Un(e,t,n){var r,i=e.length,a=0;if(arguments.length>=3)r=arguments[2];else{for(;a<i&&!(a in e);)a++;r=e[a++]}for(;a<i;)a in e&&(r=t(r,e[a],a,e)),a++;return r}function Wn(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var Bn=!{toString:null}.propertyIsEnumerable("toString"),jn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Vn(e){var t=typeof e;t===Zt.h||t===Zt.j&&null!==e||Object($t.c)("objKeys called on non-object");var n=[];for(var r in e)e&&Zt.e.call(e,r)&&n.push(r);if(Bn)for(var i=jn.length,a=0;a<i;a++)e&&Zt.e.call(e,jn[a])&&n.push(jn[a]);return n}function Kn(e,t,n,r){if(pn)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),pn(e,t,i),!0}catch(e){}return!1}function zn(){var e=Date;return e.now?e.now():(new e).getTime()}function Hn(e,t,n,r,i){var a=n;return e&&((a=e[t])===n||i&&!i(a)||r&&!r(n)||(a=n,e[t]=a)),a}function qn(e){return!!e}function Jn(e){return e&&(e=Object(Zt.b)(Zt.a?Object(Zt.a)({},e):e)),e}var Gn=null,Qn=null,Xn=!1;function Zn(e){var t=Object($t.a)();return t&&t[e]?t[e]:"window"===e&&$n()?window:null}function $n(){return Boolean(typeof window===Zt.j&&window)}function Yn(){return $n()?window:Zn("window")}function er(){return Boolean(typeof document===Zt.j&&document)?document:Zn("document")}function tr(){return Boolean(typeof navigator===Zt.j&&navigator)}function nr(){return tr()?navigator:Zn("navigator")}function rr(e){if(e&&Xn){var t=Zn("__mockLocation");if(t)return t}return typeof location===Zt.j&&location?location:Zn("location")}function ir(){return Boolean(typeof JSON===Zt.j&&JSON||null!==Zn("JSON"))}function ar(){return ir()?JSON||Zn("JSON"):null}function or(){var e=nr();return!(!e||!e.product)&&"ReactNative"===e.product}function sr(){var e=nr();if(e&&(e.userAgent!==Qn||null===Gn)){var t=((Qn=e.userAgent)||"").toLowerCase();Gn=On(t,"msie")||On(t,"trident/")}return Gn}function cr(e){var t=Object[Zt.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":ir()&&(n=ar().stringify(e)),t+n}var ur=null,lr=null,fr=null,dr=er(),pr={},gr={};function vr(e,t){var n=mr._ckMgr||gr._ckMgr;return n||(n=mr._ckMgr=mr(e,t),gr._ckMgr=n),n}function hr(e){return!e||e.isEnabled()}function mr(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Hn(t,"domain",e.cookieDomain,yn,mn),Hn(t,"path",e.cookiePath||"/",null,mn),mn(t.enabled)){var n=void 0;hn(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),hn(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||gr),r=n.path||"/",i=n.domain,a=!1!==n.enabled,o={isEnabled:function(){var e=a&&yr(t),n=gr._ckMgr;return e&&n&&o!==n&&(e=hr(n)),e},setEnabled:function(e){a=!1!==e},set:function(e,t,a,s,c){if(hr(o)){var u={},l=Wn(t||""),f=l.indexOf(";");if(-1!==f&&(l=Wn(t.substring(0,f)),u=Tr(t.substring(f+1))),Hn(u,"domain",s||i,qn,hn),!mn(a)){var d=sr();if(hn(u.expires)){var p=zn()+1e3*a;if(p>0){var g=new Date;g.setTime(p),Hn(u,"expires",br(g,d?"toGMTString":"toUTCString")||br(g,d?"toGMTString":"toUTCString")||"",qn)}}d||Hn(u,"max-age",""+a,null,hn)}var v=rr();v&&"https:"===v.protocol&&(Hn(u,"secure",null,null,hn),null===lr&&(lr=!_r((nr()||{}).userAgent)),lr&&Hn(u,"SameSite","None",null,hn)),Hn(u,"path",c||r,null,hn),(n.setCookie||Er)(e,Sr(l,u))}},get:function(e){var t="";return hr(o)&&(t=(n.getCookie||Cr)(e)),t},del:function(e,t){hr(o)&&o.purge(e,t)},purge:function(e,r){if(yr(t)){var i=((a={}).path=r||"/",a.expires="Thu, 01 Jan 1970 00:00:01 GMT",a);sr()||(i["max-age"]="0"),(n.delCookie||Er)(e,Sr("",i))}var a}};return o._ckMgr=o,o}function yr(e){if(null===ur){ur=!1;try{ur=void 0!==(dr||{}).cookie}catch(n){e&&e.throwInternal(Gt.WARNING,Yt.CannotAccessCookie,"Cannot access document.cookie - "+(In(t=n)?t.name:""),{exception:cr(n)})}}var t;return ur}function Tr(e){var t={};e&&e.length&&Ln(Wn(e).split(";"),(function(e){if(e=Wn(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[Wn(e.substring(0,n))]=Wn(e.substring(n+1))}}));return t}function br(e,t){return Sn(e[t])?e[t]():null}function Sr(e,t){var n=e||"";return _n(t,(function(e,t){n+="; "+e+(mn(t)?"":"="+t)})),n}function Cr(e){var t="";if(dr){var n=dr.cookie||"";fr!==n&&(pr=Tr(n),fr=n),t=Wn(pr[e]||"")}return t}function Er(e,t){dr&&(dr.cookie=e+"="+t)}function _r(e){return!!Mn(e)&&(!(!On(e,"CPU iPhone OS 12")&&!On(e,"iPad; CPU OS 12"))||(!!(On(e,"Macintosh; Intel Mac OS X 10_14")&&On(e,"Version/")&&On(e,"Safari"))||(!(!On(e,"Macintosh; Intel Mac OS X 10_14")||!xn(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!On(e,"Chrome/5")&&!On(e,"Chrome/6"))||(!(!On(e,"UnrealEngine")||On(e,"Chrome"))||!(!On(e,"UCBrowser/12")&&!On(e,"UCBrowser/11")))))))}var xr=!1,wr=123456789,Or=987654321;function kr(e){e<0&&(e>>>=0),wr=123456789+e&4294967295,Or=987654321-e&4294967295,xr=!0}function Pr(){try{var e=2147483647&zn();kr((4294967296*Math.random()^e)+e)}catch(e){}}function Ir(e){return e>0?Math.floor(Mr()/4294967295*(e+1))>>>0:0}function Mr(e){var t,n=Zn("crypto")||Zn("msCrypto");return n&&n.getRandomValues?t=4294967295&n.getRandomValues(new Uint32Array(1))[0]:sr()?(xr||Pr(),t=4294967295&Fr()):t=Math.floor(4294967296*Math.random()|0),e||(t>>>=0),t}function Nr(e){e?kr(e):Pr()}function Fr(e){var t=((Or=36969*(65535&Or)+(Or>>16)&4294967295)<<16)+(65535&(wr=18e3*(65535&wr)+(wr>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}var Ar,Lr=null;Zt.l;function Dr(e,t){var n=!1,r=Yn();r&&(n=Cn(r,e,t),n=Cn(r.body,e,t)||n);var i=er();return i&&(n=zr.Attach(i,e,t)||n),n}function Rr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Kr,(function(e){var t=0|Ir(15);return("x"===e?t:3&t|8).toString(16)}))}function Ur(){var e=Zn("performance");return e&&e.now?e.now():zn()}function Wr(e){void 0===e&&(e=22);for(var t=Mr()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Mr()<<2&4294967295|3&t)>>>0,n=0);return r}function Br(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Mr())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Mr())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var jr,Vr={_canUseCookies:void 0,isTypeof:vn,isUndefined:hn,isNullOrUndefined:mn,hasOwnProperty:Tn,isFunction:Sn,isObject:bn,isDate:kn,isArray:Pn,isError:In,isString:Mn,isNumber:Nn,isBoolean:Fn,toISOString:An,arrForEach:Ln,arrIndexOf:Dn,arrMap:Rn,arrReduce:Un,strTrim:Wn,objCreate:$t.b,objKeys:Vn,objDefineAccessors:Kn,addEventHandler:Dr,dateNow:zn,isIE:sr,disableCookies:function(){Hr().setEnabled(!1)},newGuid:Rr,perfNow:Ur,newId:Wr,randomValue:Ir,random32:Mr,mwcRandomSeed:Nr,mwcRandom32:Fr,generateW3CId:Br},Kr=/[xy]/g,zr={Attach:Cn,AttachEvent:Cn,Detach:En,DetachEvent:En};function Hr(e,t){var n=vr(e,t),r=Vr._canUseCookies;return null===Lr&&(Lr=[],Ar=r,Kn(Vr,"_canUseCookies",(function(){return Ar}),(function(e){Ar=e,Ln(Lr,(function(t){t.setEnabled(e)}))}))),-1===Dn(Lr,n)&&Lr.push(n),Fn(r)&&n.setEnabled(r),Fn(Ar)&&n.setEnabled(Ar),n}var qr=((jr={})[0]=cn,jr[2]=ln,jr[1]=un,jr[3]=fn,jr[4098]=ln,jr[4097]=un,jr[4099]=fn,jr),Jr=null,Gr=null;function Qr(e,t){var n=!1;if(e){if(!(n=t in e)){var r=e.prototype;r&&(n=t in r)}if(!n)try{n=!hn((new e)[t])}catch(e){}}return n}Boolean(er());var Xr=Boolean(Yn());function Zr(e){return!(""===e||mn(e))}function $r(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function Yr(){return null===Gr&&(Gr=tr()&&Boolean(nr().sendBeacon)),Gr}function ei(e){var t=!1;try{t=!!Zn("fetch");var n=Zn("Request");t&&e&&n&&(t=Qr(n,"keepalive"))}catch(e){}return t}function ti(){return void 0!==typeof XMLHttpRequest}function ni(e,t,n){if(!t&&!Zr(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Pn(t))t={value:t};else if("object"!==r||t.hasOwnProperty("value")){if(mn(t.value)||""===t.value||!Mn(t.value)&&!Nn(t.value)&&!Fn(t.value)&&!Pn(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Pn(t.value)&&!ci(t.value))return null;if(!mn(t.kind)){if(Pn(t.value)||!si(t.kind))return null;t.value=t.value.toString()}return t}function ri(){return null===Jr&&(Jr=void 0!==typeof XDomainRequest)&&ti()&&(Jr=Jr&&!Qr(XMLHttpRequest,"withCredentials")),Jr}function ii(e,t,n){var r=-1;if(!hn(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=qr[fi(e)]||-1;-1!==r&&-1!==i?r|=i:i===ln&&(r=i)}return r}function ai(e,t,n,r,i){var a={},o=!1,s=0,c=arguments.length,u=Object[Zt.k],l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(o=l[0],s++);s<c;s++){_n(e=l[s],(function(e,t){o&&t&&bn(t)?Pn(t)?(a[e]=a[e]||[],Ln(t,(function(t,n){t&&bn(t)?a[e][n]=ai(!0,a[e][n],t):a[e][n]=t}))):a[e]=ai(!0,a[e],t):a[e]=t}))}return a}var oi=Ur;function si(e){return e===en||e>en&&e<=tn||e===nn}function ci(e){return e.length>0}function ui(e){var t=Dr("beforeunload",e);return t=Dr("unload",e)||t,Dr("pagehide",e)||t}function li(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=oi()}function fi(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Zt.j&&(t=4,Pn(e)?(t=4096,e.length>0&&(t|=fi(e[0]))):Tn(e,"value")&&(t=8192|fi(e.value)))}return t}Zt.l,Zt.j,Zt.l,$t.b;var di=function(){function e(t,n,r){var i,a=this,o=!1;(a.start=zn(),a.name=t,a.isAsync=r,a.isChildEvt=function(){return!1},Sn(n))&&(o=Kn(a,"payload",(function(){return!i&&Sn(n)&&(i=n(),n=null),i})));a.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?a[t]:(a.ctx||{})[t]:null},a.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)a[t]||(a.isChildEvt=function(){return!0}),a[t]=n;else if(t===e.ChildrenContextKey)a[t]=n;else{(a.ctx=a.ctx||{})[t]=n}},a.complete=function(){var t=0,r=a.getCtx(e.ChildrenContextKey);if(Pn(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}a.time=zn()-a.start,a.exTime=a.time-t,a.complete=function(){},!o&&Sn(n)&&(a.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}();function pi(e,t,n,r,i){if(e){var a=e;if(Sn(a.getPerfMgr)&&(a=a.getPerfMgr()),a){var o=void 0,s=a.getCtx("CoreUtils.doPerf");try{if(o=a.create(t(),r,i)){if(s&&o.setCtx&&(o.setCtx(di.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(di.ChildrenContextKey);c||(c=[],s.setCtx(di.ChildrenContextKey,c)),c.push(o)}return a.setCtx("CoreUtils.doPerf",o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&a.fire(o),a.setCtx("CoreUtils.doPerf",s)}}}return n()}var gi=0,vi=1,hi=4,mi=5;function yi(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Ti=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";ir()&&(i=ar().stringify(r));var a=(t?" message:"+yi(t):"")+(r?" props:"+yi(i):"");this.message+=a}return e.dataType="MessageData",e}();var bi=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};W(e,this,(function(e){function i(e,n){var r=t[e];return mn(r)?n:r}mn(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,a,o){void 0===o&&(o=!1);var s=new Ti(n,i,o,a);if(e.enableDebugExceptions())throw s;if(!hn(s.message)){var c=e.consoleLoggingLevel();if(o){var u=+s.messageId;!r[u]&&c>=Gt.WARNING&&(e.warnToConsole(s.message),r[u]=!0)}else c>=Gt.WARNING&&e.warnToConsole(s.message);e.logInternalMessage(t,s)}},e.warnToConsole=function(e){var t=typeof console!==Zt.l?console:Zn("console");if(t){var n="log";t.warn&&(n="warn"),Sn(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var a=!0,o="AITR_"+i.messageId;if(r[o]?a=!1:r[o]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new Ti(Yt.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))},Si=function(e,t){var n=this,r=null,i=Sn(e.processTelemetry),a=Sn(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(o,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";pi(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{s.setNext(r),a&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(o,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(Gt.CRITICAL,Yt.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(o,s)}}else r&&(n._hasRun=!0,r.processTelemetry(o,s))}),(function(){return{item:o}}),!o.sync)}};function Ci(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var a=e[i];if(a&&Sn(a.processTelemetry)){var o=new Si(a,t);n.push(o),r&&r.setNext(o),r=o}}return n.length>0?n[0]:null}var Ei=function e(t,n,r,i){var a=this,o=null;null!==i&&(t&&Sn(t.getPlugin)?o=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var a=e.getPlugin();(i||a===n)&&(i=!0,r.push(a)),e=e.getNext()}return i||r.push(n),Ci(r,t)}(t,a,i||t.getPlugin()):i?o=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],Ln(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),Ci(r,t)}(t,a,i):hn(i)&&(o=Ci(t,a))),a.core=function(){return r},a.diagLog=function(){return function(e,t){return(e||{}).logger||new bi(t)}(r,n)},a.getCfg=function(){return n},a.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},a.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var o=a.getExtCfg(e,null);return o&&!mn(o[t])?i=o[t]:n&&!mn(n[t])&&(i=n[t]),mn(i)?r:i},a.hasNext=function(){return null!=o},a.getNext=function(){return o},a.setNext=function(e){o=e},a.processNext=function(e){var t=o;t&&(o=t.getNext(),t.processTelemetry(e,a))},a.createNew=function(t,i){return void 0===t&&(t=null),new e(t||o,n,r,i)}},_i=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&Sn(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var a=n||new Ei(null,{},e.core);i=r&&r.getPlugin?a.createNew(null,r.getPlugin):a.createNew(null,r)}return i},e._baseTelInit=function(i,a,o,s){i&&Hn(i,"extensionConfig",[],null,mn),!s&&a&&(s=a.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=a,n=new Ei(s,i,a,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),xi=function(){function e(t,n){var r=n?[].concat(n):[];this.iKey=function(){return t},this.count=function(){return r.length},this.events=function(){return r},this.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(r=t?r.concat(e):e.concat(r),e.length):0},this.split=function(n,i){var a=new e(t);if(n<r.length){var o=r.length-n;mn(i)||(o=i<o?i:o),a.addEvents(r.splice(n,o),!0)}return a}}return e.create=function(t,n){return new e(t,n)},e}(),wi=Math.min(2e6,65e3),Oi=/\./,ki=function e(t,n,r,i){var a=!!i,o=n,s={};W(e,this,(function(e){function n(e,t,i,c,u,l,f){_n(e,(function(e,d){var p=null;if(d||Zr(d)){var g=i,v=e,h=u,m=t;if(a&&!c&&Oi.test(e)){var y=e.split("."),T=y.length;if(T>1){h&&(h=h.slice());for(var b=0;b<T-1;b++){var S=y[b];m=m[S]=m[S]||{},g+="."+S,h&&h.push(S)}v=y[T-1]}}if(p=c&&function(e,t){var n=s[e];return void 0===n&&(e.length>=7&&(n=wn(e,"ext.metadata")||wn(e,"ext.web")),s[e]=n),n}(g)||!o||!o.handleField(g,v)?ni(v,d,r):o.value(g,v,d,r)){var C=p.value;if(m[v]=C,l&&l(h,v,p),f&&"object"==typeof C&&!Pn(C)){var E=h;E&&(E=E.slice()).push(v),n(d,C,g+"."+v,c,E,l,f)}}}}))}e.createPayload=function(e,t,n,r,i,a){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:a,sendReason:i}},e.appendPayload=function(n,r,i){var a=n&&r&&!n.overflow;return a&&pi(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),a=n.payloadBlob,o=n.numEvents,s=!1,c=[],u=[],l=n.isBeacon,f=l?65e3:3984588,d=l?wi:2e6,p=0,g=0;p<t.length;){var v=t[p];if(v){if(o>=i){n.overflow=r.split(p);break}var h=e.getEventBlob(v);if(h&&h.length<=d){var m=h.length;if(a.length+m>f){n.overflow=r.split(p);break}a&&(a+="\n"),a+=h,++g>20&&(a.substr(0,1),g=0),s=!0,o++}else h?c.push(v):u.push(v),t.splice(p,1),p--}p++}if(c&&c.length>0&&n.sizeExceed.push(xi.create(r.iKey(),c)),u&&u.length>0&&n.failedEvts.push(xi.create(r.iKey(),u)),s){n.batches.push(r),n.payloadBlob=a,n.numEvents=o;var y=r.iKey();-1===Dn(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),a},e.getEventBlob=function(e){try{return pi(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+$r(e.iKey);var r={},i=e.ext;i&&(t.ext=r,_n(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var a=t.data={};a.baseType=e.baseType;var o=a.baseData={};return n(e.baseData,o,"baseData",!1,["baseData"],(function(e,t,n){Pi(r,e,t,n)}),!0),n(e.data,a,"data",!1,[],(function(e,t,n){Pi(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))};function Pi(e,t,n,r){if(r&&e){var i=ii(r.value,r.kind,r.propertyType);if(i>-1){var a=e.metadata;a||(a=e.metadata={f:{}});var o=a.f;if(o||(o=a.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];o[c]||(o[c]={f:{}});var u=o[c].f;u||(u=o[c].f={}),o=u}o=o[n]={},Pn(r.value)?o.a={t:i}:o.t=i}}}var Ii,Mi=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),Ni=function e(){var t={};W(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(o=e.split(","),s=[],o&&Ln(o,(function(e){s.push(Wn(e))})),s);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),a=0;a<r.length;++a)t[r[a]]=zn()+i}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var n=t,r=Wn(e);return void 0!==n[r]&&n[r]>zn()||(delete n[r],!1)}}))},Fi=function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",a=!1;W(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,a||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){a||(e?(i=e,n=!0,a=!0):n=!1,t=!0)}}))},Ai=((Ii={})[1]="requeue",Ii[100]="requeue",Ii[200]="sent",Ii[8004]="drop",Ii[8003]="drop",Ii);function Li(e){try{return e.responseText}catch(e){}return""}var Di=function e(t,n,r,i){this._responseHandlers=[];var a,o,s,c,u="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-3.1.4",l=new Ni,f=!1,d=new Fi,p=!1,g=0,v=!0,h=[],m={},y=[],T=null,b=!1,S=!1;W(e,this,(function(e){var C=!0;function E(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?ri()?r=_:ti()&&(r=w):2===n&&ei(t)?r=x:p&&3===n&&Yr()&&(r=k),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function _(e,t,n){var r=new XDomainRequest;r.open("POST",e.urlString),r.onload=function(){var e=Li(r);O(t,200,{},e),B(e)},r.onerror=function(){O(t,400,{})},r.ontimeout=function(){O(t,500,{})},r.onprogress=function(){},n?r.send(e.data):a._setTimeoutOverride((function(){r.send(e.data)}),0)}function x(e,t,n){var r,i=((r={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(i.keepalive=!0),C&&(i.credentials="include"),e.headers&&Vn(e.headers).length>0&&(i.headers=e.headers),fetch(e.urlString,i).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),O(t,e.status,n,r),B(r)})).catch((function(e){O(t,0,{})}))}function w(e,t,n){function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Wn(r))}return e}function i(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},Mn(t)&&Ln(Wn(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=Wn(e.substring(0,t)).toLowerCase(),i=Wn(e.substring(t+1));n[r]=i}else n[Wn(e)]=1}})),i=n):(i=r(i,e,"time-delta-millis"),i=r(i,e,"kill-duration"),i=r(i,e,"kill-duration-seconds")),i}function a(e,n){O(t,e.status,i(e),n)}var o=new XMLHttpRequest;try{o.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(e){}C&&(o.withCredentials=!0),o.open("POST",e.urlString,!n),_n(e.headers,(function(e,t){o.setRequestHeader(e,t)})),o.onload=function(){var e=Li(o);a(o,e),B(e)},o.onerror=function(){a(o)},o.ontimeout=function(){a(o)},o.send(e.data)}function O(e,t,n,r){try{e(t,n,r)}catch(e){a.diagLog().throwInternal(Gt.WARNING,dn.SendPostOnCompleteFailure,cr(e))}}function k(e,t,n){var r=200,i=e._thePayload;try{var o=nr();if(!o.sendBeacon(e.urlString,e.data))if(i){var s=[];Ln(i.batches,(function(t){if(s&&t&&t.count()>0){for(var n=t.events(),r=0;r<n.length;r++)if(!o.sendBeacon(e.urlString,T.getEventBlob(n[r]))){s.push(t.split(r));break}}else s.push(t.split(0))})),j(s,8003,i.sendType,!0)}else r=0}catch(e){a.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),r=0}finally{O(t,r,{},"")}}function P(e){return 2===e||3===e}function I(e){return S&&P(e)&&(e=2),e}function M(){return!f&&g<n}function N(){var e=y;return y=[],e}function F(e,t,n){var r=!1;return e&&e.length>0&&!f&&o[t]&&T&&(r=0!==t||M()&&(n>0||d.allowRequestSending())),r}function A(e){var t={};return e&&Ln(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function L(e,n,r,i,c){if(e&&0!==e.length)if(f)j(e,1,i);else{i=I(i);try{var u=e,d=0!==i;pi(s,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],u=null,f=oi(),g=o[i]||(d?o[1]:o[0]),h=(S||P(i)||g&&3===g._transport)&&!v&&p&&Yr();F(e,i,n);){var m=e.shift();m&&m.count()>0&&(l.isTenantKilled(m.iKey())?s.push(m):(u=u||T.createPayload(n,r,d,h,c,i),T.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,U(u,f,oi(),c),f=oi(),u=null):(U(u,f,oi(),c),f=oi(),e=[m].concat(e),u=null)))}u&&U(u,f,oi(),c),e.length>0&&(y=e.concat(y)),j(s,8004,i)}),(function(){return{batches:A(u),retryCount:n,isTeardown:r,isSynchronous:d,sendReason:c,useSendBeacon:P(i),sendType:i}}),!d)}catch(e){a.diagLog().throwInternal(Gt.WARNING,dn.CannotSerializeObject,"Unexpected Exception sending batch: "+cr(e))}}}function D(e){var t=u,n="";Ln(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+zn().toString();var r=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),r=0;r<n.length;r++){var i=(n[r].ext||{}).intweb||{};if(Zr(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(Zr(r)&&(t=t+"&ext.intweb.msfpc="+r),d.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),s.getWParam){var i=s.getWParam();i>=0&&(t+="&w="+i)}for(var a=0;a<h.length;a++)t+="&"+h[a].name+"="+h[a].value;return t}function R(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function U(t,n,i,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var u=D(t),f=oi();pi(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var p=0;p<t.batches.length;p++)for(var h=t.batches[p].events(),y=0;y<h.length;y++){var T=h[y];if(b){var C=T.timings=T.timings||{};R(C,"sendEventStart",f),R(C,"serializationStart",n),R(C,"serializationCompleted",i)}T.sendAttempt>0?T.sendAttempt++:T.sendAttempt=1}j(t.batches,1e3+(c||0),t.sendType,!0);var E={data:t.payloadBlob,urlString:u,headers:ai({},m),_thePayload:t,_sendReason:c},_=null,x=!!e.sendHook,w=o[t.sendType];!P(t.sendType)&&t.isBeacon&&2===t.sendReason&&(w=o[2]||o[3]||w),w&&(_=function(n){d.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s=9e3,c=null,u=!1,f=!1;try{var p=!0;if(typeof t!==Zt.l){if(n){d.setClockSkew(n["time-delta-millis"]);var v=n["kill-duration"]||n["kill-duration-seconds"];Ln(l.setKillSwitchTenants(n["kill-tokens"],v),(function(e){Ln(i.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);i.numEvents-=n.count(),c.push(n)}}))}))}if(200==t)return void(s=200);(!Mi.shouldRetryForStatus(t)||i.numEvents<=0)&&(p=!1),s=9e3+t%1e3}if(p){s=100;var h=i.retryCnt;0===i.sendType&&(h<r?(u=!0,W((function(){0===i.sendType&&g--,L(i.batches,h+1,i.isTeardown,S?2:i.sendType,5)}),S,Mi.getMillisToBackoffForRetry(h))):f=!0)}}finally{u||(d.setClockSkew(),function(t,n,r,i){try{i&&a._backOffTransmission(),200===n&&(i||t.isSync||a._clearBackOff(),function(e){if(b){var t=oi();Ln(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,b&&Ln(n,(function(e){R(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),j(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(g--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,s,o,f)),j(c,8004,i.sendType)}}(n,i,t,c)},o=t.isTeardown||t.isSync;try{w.sendPOST(n,i,o),e.sendListener&&e.sendListener(E,n,o,t.isBeacon)}catch(e){a.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+cr(e)),O(i,0,{})}}),pi(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(_)if(0===t.sendType&&g++,x&&!t.isBeacon&&3!==w._transport){var n={data:E.data,urlString:E.urlString,headers:E.headers},r=!1;pi(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,v||e._thePayload||(e._thePayload=e._thePayload||E._thePayload,e._sendReason=e._sendReason||E._sendReason),_(e)}),t.isSync||t.isTeardown)}catch(e){r||_(E)}}))}else _(E)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:c}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&j(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&j(t.failedEvts,8002,t.sendType)}function W(e,t,n){t?e():a._setTimeoutOverride(e,n)}function B(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){a.diagLog().throwInternal(Gt.CRITICAL,dn.PostResponseHandler,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Zr(i.webResult)&&Zr(i.webResult.msfpc)&&c.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function j(e,t,n,r){if(e&&e.length>0&&i){var o=i[(u=t,l=Ai[u],Zr(l)||(l="oth",u>=9e3&&u<=9999?l="rspFail":u>=8e3&&u<=8999?l="drop":u>=1e3&&u<=1999&&(l="send")),l)];if(o){var c=0!==n;pi(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){W((function(){try{o.call(i,e,t,c,n)}catch(e){a.diagLog().throwInternal(Gt.CRITICAL,dn.NotificationException,"send request notification failed: "+e)}}),r||c,0)}),(function(){return{batches:A(e),reason:t,isSync:c,sendSync:r,sendType:n}}),!c)}}var u,l}e.initialize=function(e,t,n,r,i){var l;i||(i={}),u=e+u,s=t,c=t.getCookieMgr(),b=!s.config.disableEventTimings;var f=!!s.config.enableCompoundKey;a=n;var d=i.valueSanitizer,g=i.stringifyObjects;hn(i.enableCompoundKey)||(f=!!i.enableCompoundKey),p=!or(),T=new ki(s,d,g,f);var h=r;if(!r){v=!1;var m=rr();m&&m.protocol&&"file:"===m.protocol.toLowerCase()&&(C=!1);var y=[];y=or()?[2,1]:[1,2,3];var S=i.transports;S&&(Nn(S)?y=[S].concat(y):Pn(S)&&(y=S.concat(y))),r=E(y,!1),h=E(y,!0),r||a.diagLog().warnToConsole("No available transport to send events")}(l={})[0]=r,l[1]=h||E([1,2,3],!0),l[2]=E([3,2,1],!0)||h,l[3]=E([2,3,1],!0)||h,o=l},e._getDbgPlgTargets=function(){return[o[0],l,T,o]},e.addQueryStringParameter=function(e,t){for(var n=0;n<h.length;n++)if(h[n].name===e)return void(h[n].value=t);h.push({name:e,value:t})},e.addHeader=function(e,t){m[e]=t},e.canSendRequest=function(){return M()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,t){hn(e)&&(e=0),S&&(e=I(e),t=2),F(y,e,0)&&L(N(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!f&&0===g&&0===y.length},e.setUnloading=function(e){S=e},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;y.push(e)}return!0},e.teardown=function(){y.length>0&&L(N(),0,!0,2,2)},e.pause=function(){f=!0},e.resume=function(){f=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(mn(t)&&(t=1),S&&(t=I(t),n=2),L([e],0,!1,t,n||0))}}))},Ri=Xr?window:void 0,Ui=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.4";var i,a,o,s,c,u=!1,l=[],f=null,d=!1,p=0,g=500,v=0,h=1e4,m={},y="REAL_TIME",T=null,b=null,S=0,C=0,E={},_=-1,x=!0,w=!1;return W(t,r,(function(e,t){function r(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=rn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,x&&(e.ext=Jn(e.ext),e.baseData&&(e.baseData=Jn(e.baseData)),e.data&&(e.data=Jn(e.data))),e.sync)if(S||d)e.latency=on,e.sync=!1;else if(a)return x&&(e=Jn(e)),void a.sendSynchronousBatch(xi.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=v,i=h;n===sn&&(r=p,i=g);var o=!1;if(r<i)o=!L(e,t);else{var s=rn,c=20;n===sn&&(s=sn,c=1),o=!0,function(e,t,n,r){for(;n<=t;){var i=F(e,t,!0);if(i&&i.count()>0){var a=i.split(0,r),o=a.count();if(o>0)return n===sn?p-=o:v-=o,j("eventsDiscarded",[a],mi),!0}n++}return D(),!1}(e.iKey,e.latency,s,c)&&(o=!L(e,t))}o&&B("eventsDiscarded",[e],mi)}function O(e,t,n){var r=R(e,t,n);return a.sendQueuedRequests(t,n),r}function k(){return v>0}function P(){if(_>=0&&R(_,0,c)&&a.sendQueuedRequests(0,c),p>0&&!b&&!d){var e=m[y][2];e>=0&&(b=I((function(){b=null,O(sn,0,1),P()}),e))}var t=m[y][1];!T&&!f&&t>=0&&!d&&(k()?T=I((function(){T=null,O(0===C?on:rn,0,1),C++,C%=2,P()}),t):C=0)}function I(t,n){0===n&&S&&(n=1);var r=1e3;return S&&(r=Mi.getMillisToBackoffForRetry(S-1)),e._setTimeoutOverride(t,n*r)}function M(){null!==T&&(e._clearTimeoutOverride(T),T=null,C=0)}function N(t,n){M(),f&&(e._clearTimeoutOverride(f),f=null),d||O(rn,t,n)}function F(e,t,n){var r=E[t];r||(r=E[t=rn]);var i=r.iKeyMap[e];return!i&&n&&(i=xi.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function A(t,n){a.canSendRequest()&&!S&&(o>0&&v>o&&(n=!0),n&&null==f&&e.flush(t,null,20))}function L(e,t){x&&(e=Jn(e));var n=e.latency,r=F(e.iKey,n,!0);return!!r.addEvents([e],t)&&(n!==sn?(v++,t&&0===e.sendAttempt&&A(!e.sync,s>0&&r.count()>=s)):p++,!0)}function D(){for(var e=0,t=0,n=function(n){var r=E[n];r&&r.batches&&Ln(r.batches,(function(r){n===sn?e+=r.count():t+=r.count()}))},r=rn;r<=sn;r++)n(r);v=t,p=e}function R(t,n,r){var i=!1,o=0===n;return!o||a.canSendRequest()?pi(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=sn;n>=t;){var r=E[n];r&&r.batches&&r.batches.length>0&&(Ln(r.batches,(function(t){a.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),n===sn?p-=t.count():v-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&B("eventsDiscarded",e,hi),i&&_>=t&&(_=-1,c=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!o):(_=_>=0?Math.min(_,t):t,c=Math.max(c,r)),i}function U(){(m={}).REAL_TIME=[2,1,0],m.NEAR_REAL_TIME=[6,3,0],m.BEST_EFFORT=[18,9,0]}function W(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){e.diagLog().throwInternal(Gt.CRITICAL,dn.NotificationException,t+" notification failed: "+n)}}function B(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&W(e,[t].concat(n))}function j(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&Ln(t,(function(t){t&&t.count()>0&&W(e,[t.events()].concat(n))}))}function V(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,h/6)}U(),E[sn]={batches:[],iKeyMap:{}},E[on]={batches:[],iKeyMap:{}},E[an]={batches:[],iKeyMap:{}},E[rn]={batches:[],iKeyMap:{}},V(),a=new Di(500,2,1,{requeue:function(t,n){var i=[];Ln(t,(function(t){t&&t.count()>0&&Ln(t.events(),(function(t){t&&(t.sync&&(t.latency=sn,t.sync=!1),t.sendAttempt<6?(li(t,e.identifier),r(t,!1)):i.push(t))}))})),i.length>0&&B("eventsDiscarded",i,vi);w&&N(2,2)},send:function(e,t,n){e&&e.length>0&&W("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){j("eventsSent",e,t),P()},drop:function(e,t){j("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:gi)},rspFail:function(e){j("eventsDiscarded",e,vi),P()},oth:function(e,t){j("eventsDiscarded",e,gi),P()}}),e._getDbgPlgTargets=function(){return[a]},e.initialize=function(r,s,c){pi(s,(function(){return"PostChannel:initialize"}),(function(){var u=s;t.initialize(r,s,c),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=l.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(Ri),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(Ri),x=!n.disableOptimizeObj&&!!Zn("chrome");var f=u.getWParam;u.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},n.eventsLimitInMem>0&&(h=n.eventsLimitInMem),n.immediateEventLimit>0&&(g=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),V(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),Zr(r.anonCookieName)&&a.addQueryStringParameter("anoncknm",r.anonCookieName),a.sendHook=n.payloadPreprocessor,a.sendListener=n.payloadListener;var d,p=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;function v(e){"beforeunload"!==(e||Yn().event).type&&(w=!0,a.setUnloading(w)),N(2,2)}e._notificationManager=r.extensionConfig.NotificationManager,a.initialize(p,e.core,e,i,n),ui(v),Dr("pagehide",d=v),Dr("visibilitychange",(function(e){var t=er();d&&t&&"hidden"===t.visibilityState&&d(e)})),function(e){var t=Dr("pageshow",e);Dr("visibilitychange",(function(t){var n=er();e&&n&&"visible"===n.visibilityState&&e(t)}))}((function(e){w=!1,a.setUnloading(w)})),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:c}}))},e.processTelemetry=function(t,i){li(t,e.identifier);var a=(i=e._getTelCtx(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;a&&(o=o||!!a.disableTelemetry);var s=t;o||u||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),a&&a.overrideInstrumentationKey&&(s.iKey=a.overrideInstrumentationKey),r(s,!0),w?N(2,2):P()),e.processNext(s,i)},e.setEventQueueLimits=function(e,t){h=e>0?e:1e4,o=t>0?t:0,V();var n=v>e;if(!n&&s>0)for(var r=rn;!n&&r<=on;r++){var i=E[r];i&&i.batches&&Ln(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}A(!0,n)},e.teardown=function(){N(2,2),u=!0,a.teardown()},e.pause=function(){M(),d=!0,a.pause()},e.resume=function(){d=!1,a.resume(),P()},e.addResponseHandler=function(e){a._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){M(),U(),y="REAL_TIME",P(),_n(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),m[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),d||(M(),n=n||1,e?(R(rn,0,n),D(),null==f?f=I((function(){!function e(t,n){O(rn,0,n),function e(t){a.isCompletelyIdle()?t():f=I((function(){e(t)}),.25)}((function(){t&&t(),l.length>0?f=I((function(){return e(l.shift(),n)}),0):(f=null,k()&&P())}))}(t,n)}),0):l.push(t)):(O(rn,1,n),null!=t&&t()))},e.setMsaAuthTicket=function(e){a.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=k,e._setTransmitProfile=function(e){y!==e&&void 0!==m[e]&&(M(),y=e,P())},e._backOffTransmission=function(){S<4&&(S++,M(),P())},e._clearBackOff=function(){S&&(S=0,M(),P())}})),r}return Object(Xt.b)(t,e),t}(_i),Wi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Ui;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=u(u({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Qt);function Bi(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,i;switch(r=n.prependDataToken?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var a={value:t.value,propertyType:i};e[r]=a}}))}function ji(e,t){try{return e()}catch(e){return p(1,"1DS Sink",e),t}}var Vi,Ki=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=450,t._properties={},t}return c(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){Object.assign?Object.assign(e.data,this._properties):e.data=qt(e.data,this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){Bi(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},t}(Je),zi=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Hi=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new zi(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(Vi||(Vi={}));var qi=function(e){function t(t,n){var r,i,a=e.call(this,t,n)||this;a.usePartAPlugin=!0;var o=new Ki,s=function(e){e&&e.addNotificationListener({eventsSent:function(e){d(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),d(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){d(0,2,(function(){return"Discarded "+e.length+" event(s) because "+t})),d(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),a.eventsDiscarded+=e.length}})};function c(e,t,n,r){var i={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:u({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new Wi;return a.initialize(i,r),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new Hi(e.stats)),a}a.sendTelemetryEvent=function(e){return ji((function(){var t=a.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),void 0)},a.sendCustomerContent=function(e){return ji((function(){var t=a.getOneDSCustomerContent(e);t&&i&&i.track(t)}),void 0)},a.addPersistentDataFields=function(e){o.addDataFields(e)},a.flush=function(e){r&&r.flush(e)},a.shutdown=function(){try{r&&r.shutdown()}catch(e){d(0,2,(function(){return"An error occurred on shutdown"}))}};var l=[o];if(n.plugins&&l.push.apply(l,n.plugins),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=c(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,l),n.enableCustomerContent&&n.endpointUrl===Vi.PUBLIC&&(i=c(n,"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",Vi.CUSTOMER_CONTENT,l)),n.disableStatsTracking||(s(r),s(i)),a.addPersistentDataFields(t),a}return c(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],i=!1,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},o={},s=Ht(),c=(new Date).getTime().toString(),l=function(e,t){if(1===t.eventType)return"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},f=function(e,t){var i,a=b(e);if(function(e){for(var t=function(t){var n=r[t];if(!n.processEvent(e))return d(2,1,(function(){return e.eventName+" suppressed by "+n.name})),{value:!1}},n=0;n<r.length;n++){var i=t(n);if("object"==typeof i)return i.value}return!0}(a)){n.eventsProcessed++;var f=((i=a.timestamp)?new Date(i):new Date).toISOString(),p={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":a.eventName,"Event.Source":"OTelJS","Event.Time":{value:f,propertyType:9}};Bi(p,a.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),p["Event.Id"]=s+"."+n.eventsProcessed;var g="custom";a.eventContract&&(a.eventContract.name&&(p["Event.Contract"]=a.eventContract.name,g+="."+a.eventContract.name.toLowerCase().replace(/\./g,"_")),Bi(p,a.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var v={iKey:l(a,t),name:a.eventName,data:p,time:f,baseType:g,ext:{sdk:{seq:n.eventsProcessed,epoch:c}}};return n.usePartAPlugin||(v.data=u(u({},v.data),o)),v}};this.getOneDSTelemetryEvent=function(e){return f(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return f(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.addPersistentDataFields=function(e){Bi(o,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),this.addPersistentDataFields(e),this.addPreprocessor(a)}));function Ji(e){return{name:"App",contract:{name:"App",dataFields:[ta("Name",e.name),ta("Platform",e.platform),ta("Version",e.version)]}}}function Gi(e){return{name:"Session",contract:{name:"Session",dataFields:[ta("Id",e.sessionId),ta("EcsETag",e.flightsImpressionId)]}}}function Qi(e){return{name:"Release",contract:{name:"Release",dataFields:[ta("AudienceGroup",e.audienceGroup)]}}}function Xi(e){return{name:"Browser",contract:{name:"Browser",dataFields:[ta("Name",e.browserName),ta("Version",e.browserVersion)]}}}function Zi(e){return{name:"Culture",contract:{name:"Culture",dataFields:[ta("UiLanguage",e.appLanguage)]}}}function $i(e){return{name:"User",contract:{name:"User",dataFields:[ta("PrimaryIdentityHash",e.loggableUserId),ta("PrimaryIdentitySpace",e.loggableUserIdSpace),ta("TenantId",e.omsTenantId),na("IsAnonymous",e.isAnonymousUser)]}}}function Yi(e){return{name:"WAC",contract:{name:"WAC",dataFields:[ta("Host",e.host),ta("ServerDocId",e.serverDocId),ta("Datacenter",e.datacenter),na("IsSynthetic",e.isSynthetic),na("IsBusinessUser",e.isBusinessUser),na("IsEdu",e.isEduUser),ta("ApplicationMode",e.applicationMode),ta("ApplicationModeExtended",e.applicationModeExtended),ta("BrowserLanguage",e.browserLanguage),ta("ContentLanguage",e.contentLanguage),ta("OsVersion",e.osVersion),ta("Ring",e.ring),ta("UiHost",e.uiHost),ta("SessionOrigin",e.sessionOrigin),ta("UiHostIntegrationType",e.uiHostIntegrationType)]}}}var ea;function ta(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function na(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools"}(ea||(ea={}));var ra=ea.msoulscat_MSOSP_OTelJS;var ia={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,oneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",collectorEndpointUrl:"",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4,enableCustomerContent:!1},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4},samplingSettings:{enabled:!1,sampleRate:.02}};function aa(e,t){return null==e?t:e}function oa(e,t){return null==e?t:e}function sa(e,t){return null==e?t:e}function ca(e,t){return e?e+"."+t:t}function ua(e,t,n,r){n&&r.push(T(""+ca(e,t),n))}function la(e,t,n,r){"boolean"==typeof n&&r.push(h(""+ca(e,t),n))}function fa(e,t,n,r){"number"==typeof n&&r.push(m(""+ca(e,t),n))}var da=function(e){var t=[];return fa("Activity.Result","Code",e.code,t),ua("Activity.Result","Type",e.type,t),fa("Activity.Result","Tag",e.tag,t),la("Activity.Result","IsExpected",e.isExpected,t),t.push(T("zC.Activity.Result","Office.System.Result")),t},pa={contractName:"Office.System.Activity",getFields:function(e){var t=[];return ua("Activity","CV",e.cV,t),fa("Activity","Duration",e.duration,t),fa("Activity","Count",e.count,t),fa("Activity","AggMode",e.aggMode,t),la("Activity","Success",e.success,t),e.result&&t.push.apply(t,da(e.result)),t.push(T("zC.Activity",this.contractName)),t}},ga=function(e){var t=[];return fa("UserAction","Id",e.id,t),ua("UserAction","Name",e.name,t),ua("UserAction","CommandSurface",e.commandSurface,t),ua("UserAction","ParentName",e.parentName,t),ua("UserAction","TriggerMethod",e.triggerMethod,t),fa("UserAction","TimeOffsetMs",e.timeOffsetMs,t),t};function va(e){var t=[];if(e)for(var n=0;n<e.length;n+=1)t.push.apply(t,ha(e[n]));return t}function ha(e,t){e.name||(e.name="DataFieldNameIsMissing");var n=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),r=t?t+"."+e.name:e.name;switch(n){case 0:return[];case 1:return[h(r,e.bool)];case 2:return[T(r,e.string)];case 3:return[m(r,Math.floor(e.int64))];case 4:return[y(r,e.double)];case 5:return[T(r,new Date(e.date).toISOString())];case 6:return function(e,t){var n=[];if(t.dataFields)for(var r=0;r<t.dataFields.length;r+=1)n.push.apply(n,ha(t.dataFields[r],e));return n}(r,e.contract);default:throw new Error(n)}}var ma=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4)&&(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%1e3/1e3}(t),this.samplingKey=e,!0)},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1)&&(this.samplingValue=t,this.samplingKey=e,!0)},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto)&&(window.crypto.getRandomValues(e),this.samplingValue=e[0]%1e3/1e3,this.samplingKey="Random",!0)},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var r=e.eventContract.dataFields;r.push(y("Event.SampleRate",t)),r.push(y("Session.SamplingValue",n)),this.samplingKey&&r.push(T("Session.SamplingKey",this.samplingKey)),r.push(h("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}();function ya(e){return"number"==typeof e}var Ta,ba=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if("Office.Telemetry.OTelJS.EventThrottled"===t)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):ya(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),ya(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,r){return!(e>t)||(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[r]&&(this._eventThrottleReported[r]=!0,this._telemetrySink.sendTelemetryEvent({eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[T("SinkName",this._sinkName||""),T("ThrottledEvent.Name",r),m(n,t)]})),d(2,1,(function(){return"1DS Sink Event Throttle: Exceeded "+t+" "+n+": "+r})),!1)},e}(),Sa=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.logOtelEvent=void 0,this.resetStats()}return e.prototype.setLogOtelTelemetryEventFunc=function(e){this.logOtelEvent=e},e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,sampledNotSent:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0,oteljsVersion:"4.8.10"},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStatsViaUls=function(){this.computeSessionAverages(),o.sendTraceTag(this.config.tags.sessionStats,ra,r.Info,JSON.stringify(this.stats))},e.prototype.logSessionStatsViaOTel=function(){if(this.computeSessionAverages(),this.logOtelEvent){var e={eventName:this.config.tags.sessionStatsEventName,dataFields:[{name:"Processed",value:this.stats.processed,dataType:3},{name:"Sent",value:this.stats.sent,dataType:3},{name:"Throttled",value:this.stats.throttled,dataType:3},{name:"SampledNotSent",value:this.stats.sampledNotSent,dataType:3},{name:"Dropped",value:this.stats.dropped,dataType:3},{name:"EventsProcessingTime",value:this.stats.eventsProcessingTime,dataType:3},{name:"TaskExecutionTime",value:this.stats.taskExecutionTime,dataType:3},{name:"TaskExecutionCount",value:this.stats.taskExecutionCount,dataType:3},{name:"BytesOverWire",value:this.stats.bytesOverWire,dataType:3},{name:"AverageProcessingTimeCostPerEvent",value:this.stats.averageProcessingTimeCostPerEvent||0,dataType:3}],eventFlags:{}};this.logOtelEvent(e)}},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(o.sendTraceTag(this.config.tags.taskStats,ra,r.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&o.sendTraceTag(this.config.tags.taskDetailsStats,ra,r.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,i){if(e>this.config.settings.durationThreshold&&o.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,ra,r.Info,"Task took ".concat(e," ms")),this.stats.taskExecutionTime+=e,t>0){var a=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(a),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=i||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:a,s:n,t:i}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&o.sendTraceTag(this.config.tags.sdkHealth,ra,r.Warning,"Telemetry pipeline might be malfunctioning: Processed=".concat(this.stats.processed,", Sent=").concat(this.stats.sent,", Dropped=").concat(this.stats.dropped,", SessionDuration=").concat(e," ms"))},e}();function Ca(e){var t,n,r=(t=e.statsSettings,n={settings:t,tags:{sessionStatsEventName:"Office.Online.Telemetry.OTelJS.OneDS.Session.Stats",sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new Sa(n)),i=new ka({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,samplingSettings:e.samplingSetings,stats:r,createSinkFunc:Ea,createSamplerFunc:_a,createThrottlerFunc:xa,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});return r.setLogOtelTelemetryEventFunc(i.sendOtelTelemetryEvent.bind(i)),i}function Ea(e,t,n){var i=function(e,t){var n;n=e.collectorEndpointUrl?e.collectorEndpointUrl:function(e){var t=Vi[e];void 0===t&&(o.sendTraceTag(593597411,ra,r.Error,"Unknown 1DS endpoint ".concat(e," - defaulting to Public one")),t=Vi.PUBLIC);return t}(e.collectorEndpointEnum);var i={endpointUrl:n,notificationListener:new wa(t),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,n){t.recordUploadTaskDuration(e,n)},networkStats:function(e){t.stats.bytesOverWire+=e}},disableStatsTracking:!0,extensionConfig:{PostChannel:{enableCompoundKey:!0}},enableOptionalEvents:!0};return i.enableCustomerContent=e.enableCustomerContent,i}(e,n);return new qi(t||[],i)}function _a(e,t,n){var r=new ma;return"number"==typeof n&&r.setSampleRate(n),e&&r.enableWithIdentifier("PrimaryIdentityHash",e)||t&&r.enableWithIdentifier("SessionId",t)?r:void 0}function xa(e){return new ba("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}(Ta||(Ta={}));var wa=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=Ta[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function Oa(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}var ka=function(){function e(e){this._processedEvent=new i,this._throttledEvent=new i,this._logger=new S(void 0,void 0,{disableValidation:!0}),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl,this._enableCustomerContent=e.transportSettings.enableCustomerContent;var t,n=va((t=e.alwaysOnMetadata)?[Ji,Gi,Qi,Xi,Zi,Yi,$i].map((function(e){return e(t)})):[]);this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._logger.addSink(this._sink),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings),this._eventSampler=void 0,e.samplingSettings.enabled&&e.alwaysOnMetadata&&this.setupSampler(e.createSamplerFunc,e.alwaysOnMetadata,e.samplingSettings.sampleRate)}return e.prototype.setupSampler=function(e,t,n){this._eventSampler=e(t.loggableUserId,t.sessionId,n),this._eventSampler&&o.sendTraceTag(577275598,ra,r.Info,"Sampler added. Measures enabled: "+this._eventSampler.isMeasuresEnabled())},e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?o.sendTraceTag(593597389,ra,r.Info,"Collector ping 200 OK."):o.sendTraceTag(593597390,ra,r.Warning,"Collector ping 200 OK but with invalid response."):o.sendTraceTag(593597391,ra,r.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){o.sendTraceTag(593597392,ra,r.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.processEvent=function(e,t){var n=!1,r=!1,i=Oa(),a=b(e);this._throttlingEnabled&&!this._eventThrottler.processEvent(a)?n=!0:this._enabled&&(this._eventSampler&&!this._eventSampler.processEvent(a)?r=!0:t(a)),this._reporter.stats.eventsProcessingTime+=Oa()-i,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):r?this._reporter.stats.sampledNotSent+=1:(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.sendOtelCustomerContent=function(e,t){var n=this;this._enableCustomerContent&&this._logger.sendCustomerContent&&this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendCustomerContent(e)}))},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=this;this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendTelemetryEvent(e)}))},e.prototype.flush=function(e){this._sink instanceof qi&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&(this._reporter.logSessionStatsViaOTel(),this._sink.shutdown()),this._reporter.logSessionStatsViaUls(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var Pa,Ia=[{id:1,namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{id:2,namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{id:3,namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{id:4,namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{id:4,namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{id:5,namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{id:26,namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{id:6,namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{id:7,namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{id:8,namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{id:9,namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{id:10,namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{id:27,namespace:"Office.Shared.Online",ariaTenant:"d034371e26194a76a187c7108b3837ca-731725e8-1dc7-4eca-a754-b09c9d2b8dd5-6502"},{id:11,namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{id:12,namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{id:13,namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{id:14,namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{id:15,namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{id:28,namespace:"Office.Shared.Online.Health",ariaTenant:"2800319cefba4489867c1ff30d41e7e1-ea67d761-9485-4d25-bc39-f3144e34b773-6869"},{id:16,namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{id:17,namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{id:18,namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{id:19,namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{id:20,namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{id:21,namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{id:22,namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{id:23,namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{id:24,namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{id:25,namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"},{id:29,namespace:"Office.Extensibility",ariaTenant:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439"}],Ma=!1,Na="",Fa="",Aa="unknown";function La(e){if(Ma)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");var t;!function(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}(e.ulsLogger),e.loggingCategory&&(t=e.loggingCategory,ra=t),e.alwaysOnMetadata&&(Aa="".concat(e.alwaysOnMetadata.name,", ")+"".concat(e.alwaysOnMetadata.applicationMode,", ")+"".concat(e.alwaysOnMetadata.applicationModeExtended)),o.sendTraceTag(595947925,ra,r.Info,"Initializing Otel library [".concat(Aa,"] with settings ").concat(function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e))),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(Na="Office.Online.UserAction",Fa="Office.Online.Data.Activity",o.sendTraceTag(595900060,ra,r.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(Na="Office.".concat(e.alwaysOnMetadata.name,".Online.UserAction."),Fa="Office.".concat(e.alwaysOnMetadata.name,".Online.Data.Activity.")))}(e);var n=function(e){return Ca({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.oneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings,samplingSetings:e.samplingSettings})}(function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||ia.alwaysOnMetadata,useOneDsLogger:aa(e.otelUseOneDsSink,ia.useOneDsLogger),logToUls:aa(e.sendToUls,ia.logToUls),oneDsTransportSettings:{enabled:aa(e.sendToAria,ia.oneDsTransportSettings.enabled),collectorEndpointEnum:sa(e.ariaEndpointTarget,ia.oneDsTransportSettings.collectorEndpointEnum),collectorEndpointUrl:sa(e.ariaEndpointUrl,ia.oneDsTransportSettings.collectorEndpointUrl),eventUploadFrequency:oa(e.eventUploadFrequency,ia.oneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:oa(e.cacheMemorySizeLimitInNumberOfEvents,ia.oneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents),enableCustomerContent:aa(e.enableCustomerContent,ia.oneDsTransportSettings.enableCustomerContent)},throttlingSettings:{enabled:aa(e.wacAriaThrottlingIsEnabled,ia.throttlingSettings.enabled),totalEventsThrottlePerSec:oa(e.wacAriaTotalEventsThrottlePerSec,ia.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:oa(e.wacAriaSingleEventThrottlePerSec,ia.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:sa(e.otelEventNamesToBeSuppressedCommaSeparated,ia.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},statsSettings:{taskDurationLogFrequency:oa(e.taskDurationLogFrequency,ia.statsSettings.taskDurationLogFrequency),durationThreshold:oa(e.taskDurationLogThreshold,ia.statsSettings.durationThreshold),reportTaskDetails:aa(e.reportTaskDetails,ia.statsSettings.reportTaskDetails),sessionDurationCutoff:ia.statsSettings.sessionDurationCutoff},samplingSettings:{enabled:aa(e.samplingIsEnabled,ia.samplingSettings.enabled),sampleRate:oa(e.sampleRate,ia.samplingSettings.sampleRate)}}}(e));e.sendToUls&&(n.onProcessedEvent().addListener(Wa),n.onThrottledEvent().addListener(Ba)),f.addListener((function(t){!function(e,t){if(2===e.category&&!t)return;o.sendTraceTag(595947933,ra,function(e){switch(e){case 3:return r.Verbose;case 2:return r.Info;case 1:return r.Warning;case 0:return r.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),Ia.forEach((function(e){n.setTenantToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&n.pingCollectorPingUrl(),e.pingCollectorEndpoint&&n.pingCollectorEndpoint(),Pa=n,Ma=!0,o.sendTraceTag(595947926,ra,r.Info,"Successfully initialized Otel library")}function Da(e,t){ja();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=va(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{}};return 1===e.samplingPolicy&&(n.eventFlags={samplingPolicy:1}),n}(e);Pa.sendOtelTelemetryEvent(n,t)}function Ra(e,t){ja(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=Fa+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=va(e.dataFields),r=pa.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:pa.contractName,dataFields:r},dataFields:n,eventFlags:{}}}(e);Pa.sendOtelTelemetryEvent(n,t)}function Ua(e,t){ja(),null==e.name&&(e.name=Na,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=va(e.dataFields),r=ga({id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,r);var i=pa.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:pa.contractName,dataFields:i},dataFields:n,eventFlags:{}}}(e);Pa.sendOtelTelemetryEvent(n,t)}function Wa(e){o.sendTraceTag(595947932,ra,r.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Ba(e){o.sendTraceTag(593597440,ra,r.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function ja(){if(!Ma)throw new Error("Telemetry is not initialized!")}function Va(e){switch(e.kind){case"event":try{Da(e.event)}catch(t){o.sendTraceTag(595947920,ra,r.Error,"Error while processing TelemetryEvent ".concat(e.event.name," : ").concat(Ka(t)))}break;case"activity":try{Ra(e.event)}catch(t){o.sendTraceTag(595947921,ra,r.Error,"Error while processing ActivityEvent ".concat(e.event.name," : ").concat(Ka(t)))}break;case"action":try{Ua(e.event)}catch(t){o.sendTraceTag(595928211,ra,r.Error,"Error while processing UserActionEvent ".concat(e.event.name," : ").concat(Ka(t)))}break;case"otel":try{!function(e){var t;ja();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var r=va(e.additionalDataFields);(t=n.dataFields).push.apply(t,r)}Pa.sendOtelTelemetryEvent(n)}(e.event)}catch(i){var t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(595947922,ra,r.Error,"Error while processing OtelEvent ".concat(t," : ").concat(Ka(i)))}break;case"otelcc":try{!function(e){var t;ja();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var r=va(e.additionalDataFields);(t=n.dataFields).push.apply(t,r)}Pa.sendOtelCustomerContent(n)}(e.event)}catch(i){var n;t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(572298211,ra,r.Error,"Error while processing OTel CustomerContent ".concat(t," : ").concat(Ka(i)))}break;case"addNamespaceMapping":try{i=e.namespace,a=e.ariaTenantToken,ja(),Pa.setTenantToken(i,a)}catch(t){o.sendTraceTag(595947923,ra,r.Error,"Error while adding namespace mapping for ".concat(e.namespace," : ").concat(Ka(t)))}break;case"shutdown":try{ja(),o.sendTraceTag(595947931,ra,r.Info,"Otel library shutdown triggered [".concat(Aa,"]")),Pa.shutdown()}catch(e){o.sendTraceTag(595947924,ra,r.Error,"Error while processing shutdown event : ".concat(Ka(e)))}break;case"flush":try{ja(),Pa.flush(!0)}catch(e){o.sendTraceTag(559810652,ra,r.Error,"Error while processing flush event : ".concat(Ka(e)))}break;default:throw new Error(e)}var i,a}function Ka(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var za=new(function(){function e(){}return e.prototype.initialize=function(e){if(!e)throw new Error("Must supplied valid telemetry settings!");La(e)},e.prototype.processTelemetryEvent=function(e){Va(e)},e}());n.d(t,"TelemetryFullGlobal",(function(){return za})),n.d(t,"initializeEventProcessor",(function(){return La})),n.d(t,"processEvent",(function(){return Va}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(0),i=n(5),a=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])r.f[r.i].call(t,a)&&(e[a]=t[a]);return e}),o=function(e,t){return(o=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),o(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1),i=n(6),a=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])r.f[r.i].call(t,a)&&(e[a]=t[a]);return e}),o=function(e,t){return(o=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),o(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}}]);
//# sourceMappingURL=otelFull.min.js.map