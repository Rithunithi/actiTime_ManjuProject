(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1404:function(y,D,b){function a(R){var I=W.call(this)||this;I.Nc=R;I.dc();return I}function d(R,I){var Q=this;this.gde=this.DIc=!1;this.oDb=function(O,ba){(null===ba||void 0===ba?0:ba.AG)&&P.a.GGg([ba.AG])&&(Q.Fsc=!0)};this.vq=function(){Q.Fsc=!1};this.Zc=function(O,ba){N.b(ba)&&Q.Wda(!0);Q.Fsc=!1};this.od=function(){Q.tQ=Q.$.tQ;Q.Wda()};this.Dyf=function(){Q.ZR()};this.Fxf=function(){Q.tQ=Q.$.tQ};this.kxd=function(){ia.g(Q.$).Ca.yq(Q.kxd);
Q.tQ=Q.$.tQ};this.ORf=I;this.$=R;this.$.userOperationManager.uy(this.Fxf);this.$.Rk(this.od);this.$.fa.kCg(this.Dyf);this.$.fa.Sj(this.Zc);this.$.BTc(this.oDb);this.$.fa.aP(this.vq);this.Wda()}function c(){this.sOc=this.vNc=this.lkb=this.rb=null}function k(R,I,Q,O){this.Cfa=this.vfa=this.Gfa=this.Ffa=null;this.ADa=0;this.vD=this.rOc=this.RBa=this.aDc=this.wEa=null;this.Ud=R;this.m8=I;this.h1=Q;this.fj=O;this.u6d=!0;this.rL=!1;this.Hz=3;this.wqa=!0}function n(R,I){this.Nr=null;this.Ffa=CommonUIStrings.l_SavedStatus;
this.Gfa=CommonUIStrings.l_SavingStatus;this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.mRb=I;this.h1=R;this.Hz=3;this.wqa=!0}function l(R){this.Cfa=this.vfa=this.Gfa=this.Ffa=null;this.U7d=this.Hw=this.rL=!1;this.FNc=this.i8d=null;this.a8d=0;this.ub=this.g8d=null;this.h1=R;this.Hz=3;this.Thb=!0}b.r(D);y=b(0);var f=b(80),u=b(13),v=b(168),m=b(47);l.prototype.initialize=function(R,I,Q){var O=this;this.Ffa=this.Fed(R,I);this.Gfa=CommonUIStrings.l_SavingStatus;
this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.h1&&this.h1.execute(function(ba){ba.wTc(Object(f.a)(O,O.CMb,"updateToSavingStatus"))});this.Hw=!0;this.ub=Q;return!0};l.prototype.Wda=function(R,I){this.rL=R;this.Hz=I;this.ZR(this.Thb)};l.prototype.ZR=function(R){!this.Thb&&R&&(this.g8d=new Date);this.Thb=R;R=null;3===this.Hz&&(R=this.Thb?this.Ffa:this.Gfa);this.fbh(R)};l.prototype.Fed=function(R,I){return R?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};l.prototype.CMb=function(){this.ZR(!1)};l.prototype.uMh=function(){switch(this.Hz){case 1:return this.vfa;case 2:return this.Cfa;default:return null}};l.prototype.E$h=function(R){return this.U7d===this.rL&&this.a8d===this.Hz&&this.i8d===R};l.prototype.HFe=function(R){var I=this;appChrome.getHeaderApi().then(function(Q){Q.updateDocumentTitleStatus(I.rL,R,I.uMh(),I.g8d,I.Thb);return null});this.FNc=null};l.prototype.fbh=
function(R){var I=this;this.Hw&&v.c()&&!this.E$h(R)&&(m.a.SOf()?(this.FNc&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.FNc=window.requestIdleCallback(function(){I.HFe(R)})):window.requestAnimationFrame(function(){I.HFe(R)}),this.U7d=this.rL,this.i8d=R,this.a8d=this.Hz)};Object(y.a)(l,"ReactSaveStatusUIHandler",null,[246]);var A=b(170);n.prototype.Wu=function(){var R=this;this.h1&&this.h1.execute(function(I){I.wTc(Object(f.a)(R,R.CMb,
"updateToSavingStatus"))});this.mRb.execute(function(I){R.Nr=I})};n.prototype.Wda=function(R,I){this.Hz=I;3===I?this.ZR(this.wqa):2===I?this.yUd(this.Cfa):this.yUd(this.vfa)};n.prototype.CMb=function(){this.ZR(!1)};n.prototype.ZR=function(R){this.wqa=R;this.yUd(this.wqa?this.Ffa:this.Gfa)};n.prototype.yUd=function(R){this.Nr&&this.Nr.Qj(A.a.iGj,this.aYg(R))};n.prototype.aYg=function(R){var I={};I.StatusText=R;return I};Object(y.a)(n,"SaveStatusPostMessageHandler",null,[246]);var x=b(834),t=b(165),
z=b(87);k.prototype.initialize=function(R,I){if(!this.Ud)return!1;this.Ffa=this.Fed(R,I);this.Gfa=CommonUIStrings.l_SavingStatus;this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.Wu();return!0};k.prototype.Fed=function(R,I){return R?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};k.prototype.Wu=function(){var R=this;this.m8&&this.m8.execute(function(I){I.KBg(Object(f.a)(R,
R.hCe,"createStatusAndModeElements"));I.BBg(Object(f.a)(R,R.wsj,"showHideSaveStatusElement"));I.uDj&&R.hCe(null,null)});this.h1&&this.h1.execute(function(I){I.wTc(Object(f.a)(R,R.CMb,"updateToSavingStatus"))})};k.prototype.Xs=function(){this.vD&&this.Ud&&this.Ud.GF(this.vD)};k.prototype.wsj=function(R,I){this.Wda("true"===I,this.Hz)};k.prototype.Wda=function(R,I){this.rL=R;this.Hz=I;this.aDc&&(this.aDc.style.display=this.rL||3===this.Hz||!this.wEa?"none":"");this.RBa&&(this.RBa.style.display=this.rL||
3===this.Hz?"none":"",this.RBa.innerText=1===this.Hz?this.vfa:this.Cfa,this.RBa.title=1===this.Hz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.rOc&&(this.rOc.style.display=this.rL||1===this.Hz||!this.wEa&&!this.RBa?"none":"");this.vD&&(this.vD.style.display=this.rL||1===this.Hz?"none":"",this.ZR(this.wqa),this.vD.title=CommonUIStrings.l_SaveStatusTooltip)};k.prototype.hCe=function(R,I){R=document.getElementById(x.CuiHelper.Y4e);I&&I.lPj||!R||""===this.Ffa||
""===this.Gfa||""===this.vfa||""===this.Cfa||(this.wEa=document.getElementById(x.CuiHelper.f_b),this.aDc=x.CuiHelper.vsa(R,"BreadcrumbAppModeDash","-",null,!1),this.RBa=x.CuiHelper.vsa(R,"BreadcrumbAppModeStatus",1===this.Hz?this.vfa:this.Cfa,null,!1),this.P9f(this.RBa),this.rOc=x.CuiHelper.vsa(R,"BreadcrumbSaveStatusDash","-",null,!1),this.vD=x.CuiHelper.vsa(R,"BreadcrumbSaveStatus",this.Ffa,null,!1),this.P9f(this.vD),this.Wda(this.rL,this.Hz))};k.prototype.CMb=function(){this.ZR(!1)};k.prototype.ZR=
function(R){this.wqa=R;this.ZKj(this.wqa?this.Ffa:this.Gfa)};k.prototype.ZKj=function(R){!this.vD||3!==this.Hz&&2!==this.Hz||(this.u6d&&!this.wqa?(this.ADa=this.vD.offsetWidth<this.ADa?this.ADa:this.vD.offsetWidth,this.dIj(this.Gfa),this.u6d=!1):this.vD.innerText=R)};k.prototype.P9f=function(R){R.style.direction=this.fj?"rtl":"ltr";R.style.width="auto";R.style.textAlign=this.fj?"right":"left";R.style.display=this.rL?"none":"";R.setAttribute("Unselectable","on")};k.prototype.dIj=function(R){this.vD&&
(this.vD.style.width="",this.vD.innerText=R,this.ADa=this.vD.offsetWidth<this.ADa?this.ADa:this.vD.offsetWidth,R=t.a.qA(this.vD),this.vD.style.width=this.ADa-z.a.HC(R.paddingLeft)-z.a.HC(R.paddingRight)+1+"px")};Object(y.a)(k,"SaveStatusUIHandler",null,[246]);var r=b(5),G=b(97);c.prototype.di=function(R){var I=this;this.rb=R;r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.rb.register(n,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new n(I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"),
I.rb.mc("Postmessage.IHostPostmessenger"))}):r.AFrameworkApplication.sa.Pa.gef||(r.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?this.rb.register(l,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new l(I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"))}):this.rb.register(k,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new k(G.EventHandlerManager.instance,
I.rb.mc("Common.App.Header.HeaderEventSource"),I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)}))};c.prototype.init=function(){r.AFrameworkApplication.ga.$v(Object(f.a)(this,this.QA,"onFullAppSettingsReady"))};c.prototype.QA=function(){var R=r.AFrameworkApplication.ga,I=!!r.AFrameworkApplication.sa.Pa&&4===r.AFrameworkApplication.sa.Pa.Lj;if(R.ra("WordEditorAutoSaveImprovementIsEnabled")||R.ra("PptEditorSaveStatusInHeaderEnabled")||I&&R.ra("SimplifiedReactRibbonUxIsEnabled")||
R.ra("ExcelSaveStatusInHeaderEnabled")||R.ra("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?(this.sOc=this.rb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.sOc.Wu():r.AFrameworkApplication.sa.Pa.gef||(r.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?(this.vNc=this.rb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.vNc.initialize(R.ra("IsSkyDrive"),R.Ua("HostNameToIncludeInSavedStatus"),
r.AFrameworkApplication.ga):(this.lkb=this.rb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.lkb.initialize(R.ra("IsSkyDrive"),R.Ua("HostNameToIncludeInSavedStatus")))};c.prototype.dispose=function(){this.lkb&&this.lkb.Xs()};tl.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(y.a)(c,"PackageManager",null,[4,5]);D=b(274);var w=b(10),B=b(86),U=b(216),N=b(219),P=b(27),ia=b(20);d.prototype.dispose=function(){this.$&&
(this.$.ml(this.od),this.$.bHd(this.oDb),this.$.userOperationManager&&this.$.userOperationManager.pz(this.Fxf),this.$.fa&&(this.$.fa.d6i(this.Dyf),this.$.fa.kk(this.Zc),this.$.fa.lW(this.vq)),ia.g(this.$)&&ia.g(this.$).Ca&&ia.g(this.$).Ca.yq(this.kxd))};d.prototype.Wda=function(R){R=!this.$.isEditMode||(void 0===R?!1:R);this.ORf.Wda(R,this.$.isEditMode?3:1);this.ZR()};d.prototype.ZR=function(){this.$.isEditMode&&this.ORf.ZR(!this.tQ&&!this.bji&&!this.Fsc)};tl.Object.defineProperties(d.prototype,{bji:{configurable:!0,
enumerable:!0,get:function(){return this.$.fa?this.$.fa.Egf:!1}},tQ:{configurable:!0,enumerable:!0,get:function(){return this.DIc},set:function(R){R?this.DIc=!0:ia.g(this.$)&&ia.g(this.$).Ca&&(ia.g(this.$).Ca.cH()?this.DIc=!1:ia.g(this.$).Ca.np(this.kxd));this.ZR()}},Fsc:{configurable:!0,enumerable:!0,get:function(){return this.gde},set:function(R){this.gde=R;this.ZR()}}});Object(y.a)(d,"SaveStatusManager",null,[3]);var W=U.a;vm(a,W);a.prototype.create=function(){var R=this,I=B.a.instance;I.mc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(Q){var O=
new d(R.Nc,Q);I.register(d,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").zc().Ic(function(){return O});R.Fb(I.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ja=function(R){R.da.Ha(299,new a(R))};Object(y.a)(a,"SaveStatusFactory",U.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");D.a.instance.mj(new c);w.a.Ga(a.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/bf886d5165f80796e4988fe7739b2ed0/EwaDS.savestatus.js.map