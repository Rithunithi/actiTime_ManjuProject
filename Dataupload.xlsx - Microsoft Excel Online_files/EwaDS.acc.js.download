(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1379:function(y,D,b){function a(X){var ta=Pf.call(this)||this;ta.$=X;ta.dc();return ta}function d(X,ta){var tb=Cj.call(this)||this;tb.rnb=function(Rb,Fc){Rb=Fc.t4;var lc=tb.gridView;Fc=Fc.u0h;var Jd=Fc.Jh,he=Fc.D9;dg.a.Yg&&Array.add(he,new z(Jd,lc));switch(Rb){case 24:Array.add(Fc.D9,new x(Jd,Fc));break;case 0:Array.add(Fc.D9,new r(Jd,lc));dg.a.Pr||Array.add(he,new G(Jd,tb.gridView.$,Fc.paneType,tb.tableManager,tb.rp));
Array.add(he,new c(Fc,Jd,lc,Fc.paneType));break;case 3:Array.add(he,new P(Jd));dg.a.Pr||(Array.add(he,new B(Jd,tb.gridView.$,Fc.paneType,tb.Hx,tb.rp,Fc)),Array.add(he,new u(Jd,tb.gridView,tb.Hx,tb.rp,Fc)),Array.add(he,new f(Jd,tb.gridView,tb.Hx,tb.rp,Fc)));break;case 4:case 5:Array.add(he,new l(Jd));break;case 30:Array.add(he,new n(Jd));break;case 16:Array.add(he,new k(Jd));Array.add(he,new A(Fc,Jd,lc,Fc.paneType));break;case 11:case 12:Array.add(he,new m(Jd,11===Rb));break;case 17:Array.add(he,new P(Jd));
break;case 19:Array.add(he,new P(Jd)),Array.add(he,new ia(Fc,Jd,lc,Fc.paneType))}Fc.SZb=!0};tb.$=X;tb.gridView=lf.g(X);tb.tableManager=ta;tb.Hx=new t(tb.gridView);tb.rp=new Q(tb.gridView);tb.gridView.Nb&&(tb.gridView.Nb.BAg(tb.rnb),tb.gridView.Nb.update(!1));X.da.Ha(64,tb);return tb}function c(X,ta,tb,Rb){return W.call(this,X,ta,tb,Rb)||this}function k(X){var ta=I.call(this,X)||this;k.iqb(X,Oc.a.Fqh+" "+tg.a.Jta);k.iqb(X,Oc.a.Eqh+" "+tg.a.Jta);k.iqb(X,Oc.a.Bqh+" "+tg.a.Jta);k.iqb(X,Oc.a.Dqh+" "+tg.a.Jta);
k.iqb(X,tg.a.Cqh);return ta}function n(X){var ta=I.call(this,X)||this;appChrome.renderSpinner(X);return ta}function l(X){var ta=I.call(this,X)||this;l.Vpb(X,Oc.a.kqh+" "+tg.a.Jta);l.Vpb(X,Oc.a.jqh+" "+tg.a.Jta);l.Vpb(X,Oc.a.gqh+" "+tg.a.Jta);l.Vpb(X,Oc.a.iqh+" "+tg.a.Jta);l.Vpb(X,tg.a.hqh);return ta}function f(X,ta,tb,Rb,Fc){var lc=v.call(this,X,ta,tb,Rb,Fc)||this;lc.tCb=function(){var Jd=3===Qf.a.Wb;lc.lqd&&!Jd?lc.rp.FIb(lc.zaa,lc.HK,!1):!lc.lqd&&Jd&&lc.rp.FIb(lc.zaa,lc.HK,!0);lc.lqd=Jd};lc.dJi=
function(Jd,he){he.xwb===lc.zaa.W9&&lc.rp.FIb(lc.zaa,lc.HK,!he.start&&lc.DOd())};Qf.a.ble(lc.tCb);lc.lqd=3===Qf.a.Wb;lc.rp.eBg(lc.dJi);return lc}function u(X,ta,tb,Rb,Fc){return v.call(this,X,ta,tb,Rb,Fc)||this}function v(X,ta,tb,Rb,Fc){var lc=I.call(this,X)||this;lc.NK=null;lc.qb=null;lc.Y2=0;lc.sourceRange=null;lc.gd=null;lc.MRa=!1;lc.onPointerDown=function(Jd){Jd=hg.a(lc.$).Fe(Jd);if(lc.VYf(Jd)&&!lc.MRa){lc.ojf();lc.qb=lc.rp.Yad();lc.NK=lc.rp.q_e(Jd);if(!lc.qb||!lc.NK||!lc.NK.range)return Jc.ULS.shipAssertTag(537159361,
0,!!lc.qb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Jc.ULS.shipAssertTag(537159360,0,!!lc.NK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Jc.ULS.shipAssertTag(537159331,0,!!lc.NK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;lc.gd=lc.NK.range.clone();lc.sourceRange=lc.gd.clone();lc.Y2=lc.CWe(Jd);if(4===lc.Y2)return Jc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;var he=lc.kYe(Jd,!0);if(!he)return Jc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!lc.vBe(he))return Jc.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;lc.gridView.MKa=!0;lc.qb.MD(!1);lc.Hx.QGe(Jd.Sb);lc.rp.tHf(!0,lc.zaa.W9);lc.qb.textBox.removeSelection();lc.qb.NXb(lc.f3e);lc.sKf();lc.MRa=!0;sg.b(lc.$,!0)}return!0};lc.f3e=function(){lc.f8b(!0)};
lc.gridView=ta;lc.$=ta.$;lc.HK=[];lc.ha=lc.gridView.ha;lc.Hx=tb;lc.rp=Rb;lc.zaa=Fc;lc.coloredReferencesManager=lc.$.da.Aa(281);Jc.ULS.shipAssertTag(537159362,0,!!lc.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");ta=yl(lc.yPf());for(tb=ta.next();!tb.done;tb=ta.next())tb=lc.rp.NAe(X,tb.value,lc.gme(),lc.onPointerDown),Array.add(lc.HK,tb);X=yl(lc.HK);for(ta=X.next();!ta.done;ta=X.next())ta=ta.value,
Fd.a.instance.pa(wf.a.VV,ta,Object(Sc.a)(lc.Hx,lc.Hx.n6e,"hoveringStarted")),Fd.a.instance.pa(wf.a.nz,ta,Object(Sc.a)(lc.Hx,lc.Hx.o6e,"hoveringStopped"));lc.SXa(Fc);return lc}function m(X,ta){var tb=I.call(this,X)||this;var Rb=document.createElement("div"),Fc=document.createElement("div");Rb.className=ta?N.Hqh:N.Jqh;Fc.className=ta?N.Iqh:N.Gqh;X.appendChild(Rb);X.appendChild(Fc);return tb}function A(X,ta,tb,Rb){return W.call(this,X,ta,tb,Rb)||this}function x(X,ta){var tb=I.call(this,X)||this;tb.qxf=
function(){if(!tb.Hu)return Jc.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;tb.Hu.KHf(tb.YG,!1);tb.Hu.FIe(tb.YG,!1);if(3===tb.Hu.model.state)return!0;tb.Hu.j6e(!0);return!0};tb.Vxa=function(){if(!tb.Hu)return!1;tb.Hu.NWi();tb.Hu.xId(tb.YG,!1);if(3===tb.Hu.model.state)return!0;tb.Hu.j6e(!1);return!0};tb.onPointerDown=function(Rb){return tb.Hu?2!==Rb.zb||Rb.An?!1:!0:!1};tb.zCb=function(){if(!tb.Hu)return!1;tb.Hu.xId(tb.YG,!0);
tb.Hu.KHf(tb.YG,!0);tb.Hu.FIe(tb.YG,!0);tb.Hu.MHb(!0);return!0};tb.onDoubleClick=function(Rb){if(Rb.Ea)return Rb.Ea.stopPropagation(),!0;Jc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};tb.Hu=Object(pe.a)(nh.a,ta.metadata);tb.OJ=document.createElement("div");tb.OJ.id=String.format("{0}-{1}",X.id,df.a.rue);tb.OJ.className=Di.a.WQg;tb.YG=document.createElement("div");tb.YG.id=String.format("{0}-{1}",X.id,df.a.DYc);tb.YG.className=
Di.a.DYc;tb.OJ.appendChild(tb.YG);X.appendChild(tb.OJ);Jc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Fd.a.instance.pa(wf.a.VV,tb.OJ,tb.qxf);Fd.a.instance.pa(wf.a.nz,tb.OJ,tb.Vxa);Fd.a.instance.pa(wf.a.pointerDown,tb.OJ,tb.onPointerDown);Xh.a.instance.pa(wf.a.click,tb.OJ,tb.zCb);Xh.a.instance.pa(wf.a.Ij,tb.OJ,tb.onDoubleClick);return tb}function t(X){var ta=this;this.Sh=function(){ta.Bmd=!1};
this.dr=function(){ta.Bmd=!0};this.gridView=X;this.c4a=0;this.Bmd=this.cfc=!1;this.f5=Number.NaN;this.gridView.ha.l9(this.dr);this.gridView.ha.i2(this.Sh);this.gridView.ha.Ile(this.Sh)}function z(X,ta){var tb=I.call(this,X)||this;tb.XJi=function(Rb){var Fc=td.HelperMethods.Am(Rb),lc=tb.Zua.eXd(Rb.clientPoint);if(!lc)return!1;var Jd=lc.hf,he=tb.Zua.Ca.H2a(Jd.hashCode).Kia(lc.rI);if(!he)return!1;Rb=Jd.sj.domElement;lc=td.HelperMethods.Gje(td.HelperMethods.LJa(Jd.domElement,Rb),lc.rI);Jd=0;he=tb.Zua.sc(he.getRange());
for(var Te=0,yg=z.Gue.length;Te<yg;++Te){var Kg=z.Gue[Te];if(128!==Kg&&64!==Kg||!tb.Zua.$.isEditMode){var Ug=he.GJa(Kg);if(Ug&&Ug.y4a&&"none"!==Ug.y4a.style.display){Ug=Ug.y4a;var ae=td.HelperMethods.LJa(Ug,Rb);Ug=new Sys.UI.Bounds(ae.x,ae.y,Ug.offsetWidth,Ug.offsetHeight);if(cb.a.EA(Ug,lc)){Jd=Kg;break}}}}return Jd?(he.invoke(Jd,Fc),!0):!1};tb.clg=ta;K.a.instance.pa(wf.a.click,X,tb.XJi);return tb}function r(X,ta){var tb=P.call(this,X)||this;tb.Sh=function(){tb.domElement.classList.remove(N.selecting);
Ed.c(tb.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};tb.dr=function(){tb.domElement.classList.add(N.selecting)};tb.onPointerDown=function(Rb){2!==Rb.zb||Rb.An||(tb.gridView.ha.selectionType=4,tb.gridView.ha.sourceRange=tb.gridView.ha.va.Qd,Ed.c(tb.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};tb.Nba=function(){tb.gridView.$.Ce(1983983164,2,30,null);return!0};tb.od=function(){rf.DOMElementExtensions.setVisible(tb.R$,tb.gridView.$.isEditMode)};tb.V5=function(){rf.DOMElementExtensions.setVisible(tb.R$,
!1)};tb.U5=function(){rf.DOMElementExtensions.setVisible(tb.R$,!0)};tb.Nuf=function(){rf.DOMElementExtensions.setVisible(tb.R$,!1)};tb.Muf=function(){rf.DOMElementExtensions.setVisible(tb.R$,!0)};tb.XBb=function(Rb,Fc){rf.DOMElementExtensions.setVisible(tb.R$,!Fc.Yhe)};tb.gridView=ta;ta=document.createElement("div");ta.className=tg.a.zqh;tb.R$=ta;tb.od(null,null);X.appendChild(ta);Fd.a.instance.pa(wf.a.pointerDown,tb.R$,tb.onPointerDown);K.a.instance.pa(wf.a.Ij,tb.R$,tb.Nba);tb.gridView.ha.l9(tb.dr);
tb.gridView.ha.i2(tb.Sh);tb.gridView.$.Rk(tb.od);tb.gridView.$.Ab.eYb(tb.V5);tb.gridView.$.Ab.dYb(tb.U5);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(tb.gridView.wke(tb.XBb),tb.gridView.rc.wm(tb.Nuf),tb.gridView.rc.hq(tb.Muf));return tb}function G(X,ta,tb,Rb,Fc){var lc=U.call(this,X,ta,tb,Fc)||this;lc.D5b=Ve.a.instance.ea(2192);lc.SGe=Ve.a.instance.ea(2193);lc.Zuc=Ve.a.instance.ea(2194);lc.sYf=Ve.a.instance.ea(2195);lc.qu=null;lc.sda=null;lc.HQ=!1;
lc.isRow=!1;lc.Lh=!1;lc.GQ=!1;lc.XHa=null;lc.cRa=null;lc.Nff=0;lc.pJ=0;lc.onKeyDown=function(Jd){if(lc.Xq){if(lc.sec(Jd)||Jd.Ea.keyCode===ha.a.meb)return lc.Jmd||(h.KeyInputManager.instance.pa(wf.a.Vd,lc.domElement.ownerDocument.body,lc.onKeyUp),lc.Jmd=!0),!lc.yZ&&lc.sec(Jd)&&(lf.g(lc.$).Bh.Rt(G.Lze),lc.yZ=!0),lc.zZ||Jd.Ea.keyCode!==ha.a.meb||(lf.g(lc.$).Bh.Rt(U.K5c),lc.zZ=!0,2===lc.pJ?(lc.Yra(!1),lc.L2=0,lc.qu=lc.GQ?[11]:[12],lc.HQ=lc.GQ,lc.qFd(),lc.GSa()):3===lc.pJ?(lc.Rob(!1),lc.L2=lc.isRow?1:
2,lc.BFb(),lc.t7()):1===lc.pJ&&(lc.vZc(!1),lc.BFb(),lc.t7())),!0}else if(!lc.yZ&&(Jd.Ea.keyCode===ha.a.eBa||dg.a.isMac&&Jd.Ea.keyCode===ha.a.leb))return h.KeyInputManager.instance.pa(wf.a.Vd,lc.domElement.ownerDocument.body,lc.onKeyUp),lf.g(lc.$).Bh.Rt(G.Lze),lc.yZ=!0;return!1};lc.onKeyUp=function(Jd){if(lc.Xq){if(lc.sec(Jd)||Jd.Ea.keyCode===ha.a.meb)return lc.Nff=lc.sec(Jd)?0:1,lc.fH&&lf.g(lc.$).Bh.Rt(U.K5c),Jd.Ea.keyCode===ha.a.meb&&(2===lc.pJ?(lc.Rob(!1),lc.L2=0,lc.BFb(!0),lc.t7(!0)):3===lc.pJ?
(lc.Yra(!1),lc.L2=lc.isRow?1:2,lc.qu=lc.isRow?[11]:[12],lc.qFd(!0),lc.GSa(!0)):1===lc.pJ&&(lc.Yra(!1),lc.qu=lc.GQ?[11]:[12],lc.xKf(!0),lc.GSa(!0))),lc.dzc(lc.Nff),!0}else if(Jd.Ea.keyCode===ha.a.eBa||dg.a.isMac&&Jd.Ea.keyCode===ha.a.leb)return lc.dzc(),lc.fH&&lf.g(lc.$).Bh.Rt(U.KGe),!0;return!1};lc.L8a=function(Jd){Jd=hg.a(lc.$).Fe(Jd);5===lc.ru?lc.wxf(Jd):(lc.fH=!1,lc.Nb.kl(lc.qu),!lc.$.xs([lc.gd],!1)||lc.DZi()||lc.bcf()||(lc.ha.sourceRange=lc.sourceRange.clone(),lc.Xq?lc.XUi():lc.wOe(),lc.a5()?
lc.gd.top>lc.sourceRange.top&&(Jd=lc.gd.height,lc.gd.top-=Jd,lc.gd.bottom-=Jd):lc.gd.left>lc.sourceRange.left&&(Jd=lc.gd.width,lc.gd.left-=Jd,lc.gd.right-=Jd),lc.lda()));lc.UL(lc.I8a,lc.L8a);lc.tableRange=null;lc.ru=-1;lc.Xq&&(lc.sda=null,lc.pJ=0);return!0};lc.PCb=function(){lc.fH=!1;lc.pJ=0;lc.Nb.kl(lc.qu);if(!lc.$.xs([lc.gd],!1))return lc.UL(lc.OCb,lc.PCb),lc.ru=-1,!0;if(!(lc.ha.va.Qd.equals(lc.gd)||lc.Fdc(lc.gd)||lc.Fdc(lc.sourceRange)||lc.bcf())){lc.lda();lc.ha.sourceRange=lc.sourceRange.clone();
var Jd=lc.ha.sourceRange,he=lc.ha.va.Qd,Te={};lc.$.Ce(-694765314,2,30,(Te[df.a.krb]=lc.yZ,Te[df.a.F5c]=!0,Te[df.a.J5c]=lc.HQ,Te[df.a.jta]=Jd,Te[df.a.ita]=he,Te[df.a.G5c]=lc.zZ,Te));lc.yZ||(lc.gd.top>lc.sourceRange.top&&(lc.isRow||lc.gd.left===lc.sourceRange.left&&lc.HQ)?(Jd=lc.gd.height,lc.gd.top-=Jd,lc.gd.bottom-=Jd):lc.gd.left>lc.sourceRange.left&&(lc.Lh||lc.gd.top===lc.sourceRange.top&&!lc.HQ)&&(Jd=lc.gd.width,lc.gd.left-=Jd,lc.gd.right-=Jd),lc.lda())}lc.UL(lc.OCb,lc.PCb);lc.tableRange=null;lc.sda=
null;lc.ru=-1;lc.HQ=!1;return!0};lc.I8a=function(Jd){var he=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");he&&(Jd=hg.a(lc.$).Fe(Jd));var Te=Jd.clientPoint;he||(Jd=hg.a(lc.$).Fe(Jd));lc.Xq&&(lc.ica=Jd);if(Jd=lc.ha.gr(Te,Jd.Sb,5,void 0,void 0,!0)){if(lc.tableRange.contains(Jd.topLeft)){he=lf.g(lc.$);var yg=he.Lg(Jd),Kg=he.fg(lc.paneType);Te=hi.a.Yt(Kg.view.Ng,lc.domElement.parentNode,Te,he.rtl);Kg=!1;var Ug=2;lc.a5()&&Te.y-yg.topLeft.y>yg.height/2?(Kg=!0,Ug=
1):!lc.a5()&&Te.x-yg.topLeft.x>yg.width/2&&(Kg=!0);if(Kg){he=he.sl("DragSelectionClickBehavior.OnPointerMoveRearrange",he.IG,Ug);try{he.Ou(Jd),he.$$mn(),Jd=he.$$cu().range}finally{he&&he.dispose()}}lc.gd=lc.KXc(Jd);lc.ha.sourceRange=lc.gd;lc.Nb.Jl(lc.gd,lc.qu);lc.Nb.Yr(lc.qu);lc.Nb.kl(lc.Uia());if(6!==lc.ru){for(Jd=1;4>=Jd;Jd++)he=lc.to[Jd.toString()],he.parentNode.removeChild(he),lc.Nb.OG(lc.a5()?11:12,Jd).Jh.appendChild(he);lc.ru=6}}else if(lc.gd=lc.uob(Jd),lc.Xq)lc.D2e(!1);else if(lc.Nb.Jl(lc.gd,
lc.Uia()),lc.Nb.Yr(lc.Uia()),lc.Nb.kl(lc.qu),5!==lc.ru){for(Jd=1;4>=Jd;Jd++)he=lc.to[Jd.toString()],he.parentNode.removeChild(he),lc.Nb.OG(lc.n$b(),Jd).Jh.appendChild(he);lc.ru=5}lc.FW()}return!0};lc.OCb=function(Jd){var he=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");he&&(Jd=hg.a(lc.$).Fe(Jd));var Te=Jd.clientPoint;he||(Jd=hg.a(lc.$).Fe(Jd));lc.ica=Jd;if(he=lc.ha.gr(Te,Jd.Sb,5,void 0,void 0,!0)){if(lc.m4e(he))return lc.gd=lc.uob(he),lc.C2e(!1),!0;var yg=
lf.g(lc.$),Kg=yg.Lg(he),Ug=yg.fg(lc.paneType);Te=hi.a.Yt(Ug.view.Ng,lc.domElement.parentNode,Te,yg.rtl);Ug=!1;var ae=2;lc.HQ=!1;if(lc.isRow||lc.Lh){lc.isRow&&Te.y-Kg.topLeft.y>Kg.height/2?(Ug=!0,ae=1):lc.Lh&&Te.x-Kg.topLeft.x>Kg.width/2&&(Ug=!0);if(Ug){Jd=yg.sl("DragSelectionClickBehavior.OnPointerMoveDragInsert",yg.IG,ae);try{Jd.Ou(he),Jd.$$mn(),he=Jd.$$cu().range}finally{Jd&&Jd.dispose()}}lc.gd=lc.uob(he)}else{Te.x-Kg.topLeft.x===Kg.width?(lc.HQ=!1,Ug=!0):Te.y-Kg.topLeft.y>Kg.height/2&&(Ug=!0,lc.HQ=
!0,ae=1);lc.sda&&(lc.HQ=lc.GQ);if(Ug){yg=yg.sl("DragSelectionClickBehavior.OnPointerMoveDragInsert",yg.IG,ae);try{yg.Ou(he),yg.$$mn(),he=yg.$$cu().range}finally{yg&&yg.dispose()}}lc.Nb.kl(lc.qu);lc.qu=lc.HQ?[11]:[12];for(yg=1;4>=yg;yg++)(Kg=lc.to[yg.toString()])&&Kg.parentNode.removeChild(Kg),lc.to[yg.toString()]=null;lc.Tma(Jd.clientPoint,Jd.Sb,lc.HQ?11:12,!0);lc.gd=lc.KXc(he)}lc.ha.sourceRange=lc.gd;lc.Nb.Jl(lc.gd,lc.qu);lc.Nb.Yr(lc.qu);lc.Nb.kl(lc.Uia());if(6!==lc.ru){for(Jd=1;4>=Jd;Jd++)he=lc.to[Jd.toString()],
he.parentNode.removeChild(he),lc.Nb.OG(lc.isRow||lc.HQ?11:12,Jd).Jh.appendChild(he);lc.ru=6}lc.FW()}return!0};lc.Sh=function(){lc.domElement.classList.remove(N.selecting)};lc.dr=function(){lc.domElement.classList.add(N.selecting)};lc.kd=function(){if(lc.$.isEditMode){var Jd=lc.oqj();lc.ULd(Jd)}};lc.azf=function(){lc.Xq?lc.fH&&5<=lc.ru&&(lc.tableRange?lc.zZ?lc.Yra(!0):lc.vZc(!0):lc.zZ?lc.isRow||lc.Lh?lc.Yra(!0):lc.Rob(!0):lc.isRow||lc.Lh?lc.Rob(!0):lc.Yra(!0)):lc.fH&&5<=lc.ru&&(lc.tableRange?(lc.Nb.kl(lc.qu),
lc.UL(lc.I8a,lc.L8a)):(lc.Nb.kl(lc.Uia()),lc.UL(Object(Sc.a)(lc,lc.Nj,"onPointerMove"),Object(Sc.a)(lc,lc.Zg,"onPointerUp"))))};lc.tableManager=Rb;lc.tableRange=null;lc.to={};lc.fH=!1;lc.yZ=!1;lc.zZ=!1;lc.Jmd=!1;lc.ha.l9(lc.dr);lc.ha.i2(lc.Sh);lc.ha.Ile(lc.azf);lc.ha.iG(lc.kd);return lc}function w(X,ta){this.destinationRange=this.sourceRange=null;this.sourceRange=X;this.destinationRange=ta}function B(X,ta,tb,Rb,Fc,lc){var Jd=U.call(this,X,ta,tb,Fc)||this;Jd.NK=null;Jd.qb=null;Jd.e3e=function(){Jd.z7b(!0)};
Jd.gridView=lf.g(Jd.$);Jd.Hx=Rb;Jd.coloredReferencesManager=Jd.$.da.Aa(281);Jc.ULS.shipAssertTag(537159391,0,!!Jd.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");X=yl(Jd.fC);for(ta=X.next();!ta.done;ta=X.next())ta=ta.value,Fd.a.instance.pa(wf.a.VV,ta,Object(Sc.a)(Jd.Hx,Jd.Hx.n6e,"hoveringStarted")),Fd.a.instance.pa(wf.a.nz,ta,Object(Sc.a)(Jd.Hx,Jd.Hx.o6e,"hoveringStopped"));Jd.SXa(lc);return Jd}
function U(X,ta,tb,Rb){var Fc=P.call(this,X)||this;Fc.MRa=!1;Fc.Vhe=null;Fc.Uhe=null;Fc.Vqa=0;Fc.Xq=me.EwaSettings.getBooleanFeatureGate(Fh.a.A5b,!1);Fc.L2=0;Fc.Whd=0;Fc.$Wd=0;Fc.Rla=null;Fc.sourceRange=null;Fc.gd=null;Fc.ica=null;Fc.onPointerDown=function(lc){lc=hg.a(Fc.$).Fe(lc);if(2===lc.zb&&!lc.An&&!Fc.MRa){var Jd=Fc.Ked(lc);if(!Jd)return Jc.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Fc.gd=Jd.clone();Fc.sourceRange=Fc.gd.clone();
Fc.Rla=Fc.gd;if(Jd=Fc.EMh(lc))Fc.ru=5,Fc.$Wd=Jd.top-Fc.sourceRange.top,Fc.Whd=Jd.left-Fc.sourceRange.left,lf.g(Fc.$).Bh.Rt(Fc.Xq?U.K5c:U.KGe),Fc.mxf(lc),Fc.MRa=!0,sg.b(Fc.$,!0)}return!1};Fc.od=function(lc,Jd){Jd.WJ||Fc.ULd(Fc.$.isEditMode)};Fc.fC=[];Fc.$=ta;Fc.ha=lf.g(Fc.$).ha;Fc.paneType=tb;Fc.rp=Rb;ta=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");tb=dg.a.Af;ta=yl(ta&&!tb?[N.tqh,N.mqh,N.pqh,N.rqh]:[N.uqh,N.nqh,N.qqh,N.sqh]);for(tb=ta.next();!tb.done;tb=ta.next())tb=Fc.rp.NAe(X,
tb.value,Fc.Xq?[N.oqh]:[N.lqh],Fc.onPointerDown),Array.add(Fc.fC,tb);Fc.$.Rk(Fc.od);Fc.ULd(Fc.$.isEditMode);return Fc}function N(){}function P(X){var ta=I.call(this,X)||this;var tb=document.createElement("div");tb.className=tg.a.Aqh;X.appendChild(tb);return ta}function ia(X,ta,tb,Rb){return W.call(this,X,ta,tb,Rb)||this}function W(X,ta,tb,Rb){var Fc=I.call(this,ta)||this;Fc.Ymb=!1;Fc.cZb=!1;Fc.cpd=!1;Fc.eZa=null;Fc.apd=!1;Fc.Raa=!1;Fc.iw=function(){Fc.Ymb&&Fc.apd?Fc.ena():Fc.q4()};Fc.Tuf=function(Jd){3===
Jd.zb&&(Fc.apd=!0,Fc.ena());return!1};Fc.Uuf=function(Jd){if(3===Jd.zb){if(!Jd.Sb||Fc.jai(Jd))return!1;Fc.apd=!1;Fc.q4()}return!1};Fc.Sh=function(){Fc.Raa&&Fc.WUd();Fc.ena();Fc.cpd=!1};Fc.dr=function(){Fc.q4();Fc.cpd=!0};Fc.Yxa=function(Jd,he){he.t4===Fc.t4&&(he.visible?Fc.cpd||Fc.ena():Fc.q4())};Fc.HAf=function(){Fc.Vuf(Fc.hO.domElement,!1)};Fc.drf=function(){Fc.Vuf(Fc.JL.domElement,!0)};Fc.Dlc=function(Jd,he){Fc.ha.Lya(he)};Fc.Elc=function(Jd,he){Fc.ha.Lya(kg.b(he))};Fc.tCb=function(){3===Qf.a.Wb?
Fc.ena():Fc.q4();Fc.Raa&&1===Qf.a.Wb&&Fc.WUd()};Fc.IAf=function(){Fc.$gj()};Fc.kHe=function(){Fc.q4()};Fc.Wo=function(){Fc.ha.Qa.nc&&Fc.q4()};Fc.Sqf=function(){Fc.q4()};Fc.Luf=function(Jd,he){Fc.WUd();3===he.zb?Fc.ena():Fc.q4()};Fc.ppc=function(){Fc.Ymb&&(Fc.q4(),Fc.ena())};var lc=tb.$;Fc.ny=tb;Fc.ha=tb.ha;Fc.zaa=X;Fc.Bej=ta;Fc.paneType=Rb;X=Fc.domElement.currentStyle;ta="#000000";X&&(ta=X.borderTopColor);Fc.hO=new R(Fc.Y9c(),ta,lc);Fc.JL=new R(Fc.Y9c(),ta,lc);Fc.hnd=lc.fa.isNamedObjectViewMode&&
1===lc.workbookContext.NovMode;Fc.hO.Ske(Fc.HAf);Fc.hO.Rke(Fc.Dlc);Fc.hO.Tke(Fc.Elc);Fc.JL.Ske(Fc.drf);Fc.JL.Rke(Fc.Dlc);Fc.JL.Tke(Fc.Elc);X=yl(Fc.gridView.jn);for(ta=X.next();!ta.done;ta=X.next())ta=ta.value,vf.a.instance.pa(wf.a.Ff,ta.domElement,Fc.Uuf),vf.a.instance.pa(wf.a.De,ta.domElement,Fc.Tuf);tb.view.it(Fc.iw);tb.Kc.wm(Fc.kHe);tb.Nb.tmb(Fc.Yxa);tb.AXb(Fc.Sqf);lc.Yz(Fc.ppc);tb.Nq(Fc.ppc);Fc.ha.i2(Fc.Sh);Fc.ha.l9(Fc.dr);tb.DD(Fc.Wo);Fc.ha.GXb(Fc.Luf);Qf.a.ble(Fc.tCb);Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(lc.da,
376,377,0),function(Jd){Jd.result.ICg(Fc.IAf)},lc.ma,3);return Fc}function R(X,ta,tb){var Rb=Jh.call(this,document.createElement("div"))||this;Rb.G3b=null;Rb.jNb=!1;Rb.onPointerDown=function(lc){lc=hg.a(Rb.$)?hg.a(Rb.$).Fe(lc):lc;Rb.jNb=!1;if(3===(Qf.a.Wb=lc.zb)){var Jd=lc.Ea.rawEvent,he=Jd.srcElement||Jd.target;rf.DOMElementExtensions.Ye(Rb.domElement,he)&&rf.DOMElementExtensions.Ye(Jd.currentTarget,he)&&(Rb.jNb=!0,Rb.G3b=lc.clientPoint)}return!1};Rb.Zg=function(lc){lc=hg.a(Rb.$)?hg.a(Rb.$).Fe(lc):
lc;Rb.raiseEvent("GrPointerUp",lc);return Rb.jNb=!1};Rb.Nj=function(lc){lc=hg.a(Rb.$)?hg.a(Rb.$).Fe(lc):lc;3===lc.zb&&Rb.jNb&&Rb.OZh(lc.clientPoint)&&(Rb.raiseEvent("GrDrag"),Rb.jNb=!1);return!1};Rb.Vc=function(lc){hg.a(Rb.$)&&hg.a(Rb.$).Fe(lc);return!0};Rb.$=tb;tb=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");var Fc=dg.a.Af;Rb.domElement.classList.add(!tb||Fc?tg.a.GNe:tg.a.FNe);Rb.domElement.classList.add(tg.a.b7b);X.appendChild(Rb.domElement);rf.DOMElementExtensions.setVisible(Rb.domElement,
!1);Rb.iKa=document.createElement("div");Rb.iKa.classList.add(tg.a.a7b);Rb.iKa.style.borderColor=ta;Rb.domElement.appendChild(Rb.iKa);Fd.a.instance.pa(wf.a.pointerDown,Rb.domElement,Rb.onPointerDown);Fd.a.instance.pa(wf.a.Wd,Rb.domElement,Rb.Zg);vf.a.instance.pa(wf.a.De,Rb.domElement,Rb.Zg);Fd.a.instance.pa(wf.a.lh,Rb.domElement,Rb.Nj);vf.a.instance.pa(wf.a.Ig,Rb.domElement,Rb.Nj);K.a.instance.pa(wf.a.click,Rb.domElement,Rb.Vc);return Rb}function I(X,ta){return gf.call(this,X,void 0===ta?null:ta)||
this}function Q(X){var ta=Pe.call(this)||this;ta.vlf=[3];ta.gridView=X;return ta}function O(X,ta){var tb=ge.call(this)||this;tb.start=X;tb.xwb=ta;return tb}function ba(X){var ta=Td.call(this)||this;ta.$=X;ta.dc();return ta}function ca(X){var ta=pd.call(this)||this;X.da.Ha(376,ta);return ta}function S(X){var ta=ic.call(this)||this;ta.$=X;ta.dc();return ta}function Y(){this.fJd=le.AFrameworkApplication.IXd;this.Eri=le.AFrameworkApplication.uPj;this.tokens=le.AFrameworkApplication.nVh();this.priority=
le.AFrameworkApplication.JXd;this.xce=this.Ekj();this.hRc=le.AFrameworkApplication.mVh();this.sJc=!1;this.Ace=le.AFrameworkApplication.IXd;le.AFrameworkApplication.ga&&(this.sJc=le.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",!1))&&(this.Ace=le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",le.AFrameworkApplication.IXd))}function ma(X,ta,tb,Rb,Fc,lc,Jd){var he=this;
Rb=void 0===Rb?null:Rb;Fc=void 0===Fc?!1:Fc;lc=void 0===lc?null:lc;Jd=void 0===Jd?!1:Jd;this.sqa=0;this.Qfa=this.Ri=null;this.JVb=new Qa.a;this.sS=new Qa.a;this.Sl=null;this.bSb=!1;this.je=X;this.hbe=ta;this.hbe.execute(function(Te){Te.Km(Rc.a.iid,Object(Sc.a)(he,he.hFi,"onHostResponseReceived"))});this.L8=tb;this.Ufe=new Kb.a("WebServiceCall","TokenRefresh");this.qj=Rb||new Z(X);this.Xqg=Fc;this.NS=lc?lc:Oa.SessionStatusManager.instance;this.b3d=Jd}function Z(X){this.vo={};this.lX={};this.ppg={};
this.Qif=15;this.m7d=!1;this.crg=new Date;this.jSb=new Date;this.je=X;this.AVb=new ve.a(2,2,6E4*this.Qif,Object(Sc.a)(this,this.Kcg,"writeMeasures"),135,"SL",!1);this.je.gh(this.AVb);this.S4h()}function xa(){}function na(X,ta){var tb=this;this.documentVisibilityObserver=null;this.Ma=new Ec.a;this.Ww=null;this.Fcb=this.Xjb=!1;this.Opc=null;this.GFb=!1;this.Asd=!0;this.S7d=this.r7d=this.CG=this.$kb=!1;this.mS=null;this.k3e=function(){if(!tb.r8b||tb.r8b&&tb.$.fa.oc)tb.L3e(!1);else if(tb.Asd){tb.Asd=
!1;var Rb=Th.a(tb.$);Jc.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",Rb.ui?Rb.ui.activityName:"None",tb.z5f())}};this.Zc=function(Rb,Fc){tb.context&&(Rb=tb.$.fa,Fc.aH&&tb.context.AFb&&!tb.context.syc?(tb.context.syc=!0,Fc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Fc.IsUserActive=Rb.Df.Yq,Fc.RefreshAccessTokenCorrelationID=
tb.context.correlationID,Fc=ke.a.Hc(Fc),Jc.ULS.sendTraceTag(537170708,0,50,Fc)):tb.r8b&&tb.Xjb&&!Rb.oc&&!tb.context.a3c&&(Fc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},tb.Ww&&(tb.Ww.C(),Fc.Aborted=!0,me.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(Fc.ResetStopRefreshRetriesUntilTokenExpired=!0,tb.Fcb=!1)),Fc.TimeUntilTokenExpirationInMin=tb.z5f(),Fc.RefreshAccessTokenCorrelationID=tb.context.correlationID,
Fc=ke.a.Hc(Fc),Jc.ULS.sendTraceTag(572019856,0,50,Fc)))};this.Uxa=function(){if(tb.context&&tb.context.AFb&&!tb.context.syc){var Rb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Rb.CreatedForExpired=tb.context.a3c;Rb.RefreshAccessTokenCorrelationID=tb.context.correlationID;Rb.OpenWorkbookErrors=yh.a.Uc(tb.$.fa.dF);Rb.ExecutionContextErrors=yh.a.Uc(Th.a(tb.$).nd.errors);Rb.accesstokenTTL=le.AFrameworkApplication.qk;Rb=ke.a.Hc(Rb);Jc.ULS.sendTraceTag(537170707,0,15,Rb)}};this.K3e=
function(){tb.Fcb=!1;tb.L3e(!0)};this.Izd=function(){tb.GFb&&(tb.$.fa.Df.eza(tb.Izd),tb.GFb=!1);tb.b2f()};this.$=X;this.qTd=ta;this.gFd=X.Ub.Xh("WebServiceCall","refreshToken");this.r8b=me.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");nf.a.instance.LTc(this.K3e);nf.a.instance.JTc(this.k3e);ta=this.$.fa;ta.Sj(this.Zc);ta.SXb(this.Uxa);this.Rsi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.tYf=this.$.ya.ShortAccessTokenExpirationPromptSeconds;
this.DJf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.hag(X.fa.eCf,le.AFrameworkApplication.qk);X=new Date;ta={};Jc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(ta.AccessTokenTtl=le.AFrameworkApplication.qk,ta.NowGetTime=X.getTime(),ta.BootTime=le.AFrameworkApplication.Pga,ta.WopiTokenExpiresAfterMinutes=le.AFrameworkApplication.GXd,ta.WopiTokenTaskItemPriority=le.AFrameworkApplication.JXd,ta));this.$.da.Za(291,function(Rb){tb.documentVisibilityObserver=
Rb})}function pa(X,ta){this.JVb=X;this.sS=ta}function Ia(){return Ma.apply(this,arguments)||this}function Ma(){}function lb(){}function zb(X,ta){this.AFb=!1;this.correlationID=X;this.a3c=ta;this.syc=!1;this.creationTime=Zg.a.Ra.Kb}function Ya(X){var ta=Wb.call(this)||this;ta.Ma=new Ec.a;ta.$kb=!1;ta.CG=!1;ta.$=X;return ta}function Wb(){this.Rde=this.IOc=!1;var X=le.AFrameworkApplication.qk;if(!(0>=X)){this.qk=X;X=new Date;var ta={};Jc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
(ta.AccessTokenTtl=this.qk,ta.NowGetTime=X.getTime(),ta.BootTime=le.AFrameworkApplication.Pga,ta));nf.a.instance.LTc(Object(Sc.a)(this,this.$Na,"onSessionExpiredDetected"));nf.a.instance.JTc(Object(Sc.a)(this,this.izf,"onSessionExpiringDetected"))}}function Zb(X){var ta=th.call(this)||this;ta.$=X;ta.dc();return ta}function da(X,ta,tb){tb=void 0===tb?null:tb;var Rb=Yg.call(this,ta)||this;Rb.sheetTabActivatePreviousHidden=Ve.a.instance.ea(706);Rb.sheetTabActivateNextHidden=Ve.a.instance.ea(708);Rb.svgIconProvider=
null;Rb.qh=[];Rb.lK=Array(6);Rb.lvd=Array(6);Rb.Ok=null;Rb.QNd=null;Rb.Yuc=null;Rb.Pbb=null;Rb.Wuc=null;Rb.$G=null;Rb.Pwb=null;Rb.YQa=null;Rb.isRtl=!1;Rb.zu=0;Rb.ZJ=0;Rb.lrc=!1;Rb.w5b=!1;Rb.xma=0;Rb.coc=0;Rb.F5b=null;Rb.v$=null;Rb.r3=null;Rb.bM=null;Rb.mC=0;Rb.gbc=0;Rb.OKb=null;Rb.hzb=-1;Rb.DY=null;Rb.knc=0;Rb.Mwc=-1;Rb.Ula=0;Rb.Ysa=new Ja;Rb.qJc=!1;Rb.d_=null;Rb.cee=null;Rb.RNd=null;Rb.SNd=null;Rb.mrc=null;Rb.c7d=!1;Rb.mjd=null;Rb.Dud=!1;Rb.bee=null;Rb.AC=function(Fc,lc){Rb.wzf(lc.item)};Rb.aya=
function(Fc,lc){Fc=Rb.$.xa.oa.index;for(var Jd=0,he=Rb.qh.length;Jd<he;Jd++){var Te=Rb.nQ(Jd);if(Te.name===lc.oldName){Te.name=lc.newName;Rb.G_();Jd===Fc&&Rb.X_(6);break}}};Rb.Azf=function(Fc,lc){(Fc=Rb.B1a(lc.item))&&Fc.deb()};Rb.Bzf=function(Fc,lc){lc.visible?(Rb.RQa(!1),Rb.xzf(lc.item)):Rb.wzf(lc.item)};Rb.oK=function(Fc){Rb.JE?(Rb.DY=Fc,Rb.kMb()):(Rb.DY&&(Rb.coc+=Rb.DY.clientPoint.x-Fc.clientPoint.x),Rb.DY=Fc,Math.abs(Rb.coc)>=Rb.jdh&&Rb.kMb());return!0};Rb.lN=function(Fc){Fc.Ea.preventDefault();
return!1};Rb.KSf=function(Fc){Rb.HSf(Fc,!0)};Rb.JSf=function(Fc){Rb.HSf(Fc,!1)};Rb.j_=function(Fc){if(Rb.JE&&(Rb.Zy||Rb.Pdf(Fc)))if(Rb.w5b=Rb.caf(Fc),Rb.Zy){var lc;Fc=(lc=Rb.nQ(Rb.mC+1))?lc.sheet:null;Rb.reorderSheets(Fc,Rb.mC+1===Rb.ONd,!0)}else Fc=Rb.Dud?null:Rb.mjd,Rb.reorderSheets(Fc,Rb.Dud,!0);Rb.YP();return!0};Rb.Yh=function(Fc,lc){lc.xK&&Rb.$Vd(lc.xK);Rb.auc(!1);Rb.G_();lc.oa&&(Rb.$Vd(lc.oa),Rb.X_(6),Rb.fa.Ala())};Rb.kqf=function(Fc,lc){Rb.dAc(lc.item)};Rb.lqf=function(Fc,lc){Rb.dAc(lc.item)};
Rb.mqf=function(Fc,lc){Rb.dAc(lc.item)};Rb.UNa=function(Fc,lc){Rb.dAc(lc.item)};Rb.K5=function(){Rb.RZc()};Rb.od=function(){Rb.isVisible=!Rb.fa.isNamedObjectViewMode;Rb.RZc();Rb.S2c();me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(eh.d(Rb.$)||eh.e(Rb.$))&&(eg.PageLoadTrackingInfo.instance.L_("sheetTabBar",["sheetTabBar"]),eg.PageLoadTrackingInfo.instance.oW("sheetTabBar",["sheetTabBar"]));Rb.z2c();Rb.G_();Rb.RQa(!0);Rb.X_(6)};Rb.aj=function(){Rb.isVisible&&(Rb.G_(),
Rb.X_(6))};Rb.Kf=function(){Object(fc.a)(Sa,Rb.$G)===we.k(Rb.$.kg)&&Rb.z2c();for(var Fc=yl(Rb.qh),lc=Fc.next();!lc.done;lc=Fc.next())lc.value.Qgj(!we.k(Rb.$.kg))};Rb.zzf=function(Fc,lc){Rb.c7i(lc.item,lc.isUserOperation)};Rb.ZCb=function(Fc,lc){Rb.xzf(lc.item)};Rb.onKeyDown=function(Fc){switch(Fc.keyCode){case 9:var lc=Rb.domElement.querySelectorAll(rf.DOMElementExtensions.Ep),Jd=rf.DOMElementExtensions.zl(lc);lc=rf.DOMElementExtensions.Ry(lc);rf.DOMElementExtensions.jda(Fc,Jd,lc);break;case 39:case 37:rf.DOMElementExtensions.zVf(Fc,
Rb.domElement.querySelectorAll(rf.DOMElementExtensions.Ep),39===Fc.keyCode?!Rb.isRtl:Rb.isRtl)}Jc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",Fc.keyCode)};Rb.onScroll=function(){Rb.Ok.scrollLeft!==Rb.xma&&Rb.vBj()};Rb.P5=function(Fc){if(Fc.ctrlKey||Fc.c$)return!1;Rb.Ok.scrollLeft+=Math.floor(30*Fc.vBa);if(Rb.Zy&&Rb.JE){var lc=Rb.UWe("OnMouseWheel");lc&&Rb.WRd(0<Fc.vBa,lc.x+lc.width/2)}return!0};Rb.$E=function(Fc,lc){if(Rb.Ysa)Rb.r3e("PartialInteractivity",lc.ZO?3:
0);else{Rb.YP(!1);Rb.vMd(lc.ZO);Fc=yl(Rb.Fqe);for(var Jd=Fc.next();!Jd.done;Jd=Fc.next())(Jd=Jd.value)&&Jd.RW(lc.ZO);Fc=yl(Rb.qh);for(Jd=Fc.next();!Jd.done;Jd=Fc.next())(Jd=Jd.value)&&Jd.RW(lc.ZO)}};Rb.XBb=function(Fc,lc){Fc=0;lc.Yhe&&(Fc=2|(lc.Qnj?1:0));Rb.r3e("ComponentRangePicker",Fc)};Rb.$=X;Rb.fa=Rb.$.fa;Rb.Zy=Ae.a.Pbf();Rb.P5b=Rb.Zy&&!me.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Rb.gm=me.EwaSettings.la(524);Rb.cw=Ae.a.eod();Rb.Odf=
Rb.gm;Rb.Zy&&(Rb.c7d=Rb.gm&&!dg.a.Ku);Rb.Iui=Rb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Rb.Hui=Rb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;Rb.jdh=Rb.$.ya.SheetTabDragStartPixelThreshold;Rb.DOa=-1;Rb.COa=-1;Rb.R0c=!1;Rb.cw&&(Rb.svgIconProvider=tb);Rb.IB=new qe.a(Rb.domElement,3);Rb.gm&&Rb.domElement.classList.add(Lb.$mh);Rb.h3g();Rb.F0g();Rb.i3g();Rb.i4g();Rb.auc(!0);Rb.od(null,null);X=Rb.$.xa;X.Pf(Rb.Yh);X.DXb(Rb.K5);X.YX(Rb.AC);X.pga(Rb.ZCb);X.bFa(Rb.aya);X.Yke(Rb.zzf);X.EXa(Rb.Bzf);X.NAg(Rb.Azf);
X.oTc(Rb.kqf);X.Vke(Rb.lqf);X.Wke(Rb.mqf);X.Xke(Rb.UNa);Rb.$.Rk(Rb.od);Rb.$.Yz(Rb.aj);sd.a(Rb.$).Tg(Rb);Rb.$.da.Ha(32,Rb);me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&Rb.$.fa.jt(Rb.Kf);Rb.Xuc=Rb.Nd.Cd(Rb.domElement);Rb.Xuc.ja("keydown",Rb.onKeyDown);Lg.a(Rb.$).sq()&&Rb.$E(null,new pc.a(!0));Lg.a(Rb.$).pg.qga(Rb.$E);lf.g(Rb.$).wke(Rb.XBb);me.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Rb.Xuc.ja("mousedown",
function(Fc){Fc.preventDefault()});Xh.a.instance.pa(wf.a.wC,Rb.domElement,Rb.P5);Rb.PNd=Rb.Nd.Cd(Rb.Ok);Rb.PNd.ja("scroll",Rb.onScroll);Rb.vBj=ja.a(function(){Rb.G_()},200,Rb.$.ma,Od.a.Unj,!0);Rb.$.vE(df.a.Fuj);Rb.Odf&&(Rb.bee=new sb(Rb.$,Rb.YQa.domElement));me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&eg.PageLoadTrackingInfo.instance.gma("sheetTabBar",["sheetTabBar"]);return Rb}function za(X,ta,tb){ta=Ra.call(this,document.createElement("a"),ta)||this;ta.Xga=
me.EwaSettings.la(524)?Oc.a.N7c:Oc.a.Wnh;tb.yb(ta.domElement,Ve.a.instance.ea(697),0,ta.Xga,Ve.a.instance.ea(697),aa.a.f0c,!0);X.appendChild(ta.domElement);ta.wc.ja("contextmenu",function(Rb){de.g(Rb)});return ta}function hb(X,ta,tb,Rb,Fc,lc,Jd){var he=Ra.call(this,document.createElement("li"),X)||this;he.jYf=0;he.kYf=0;he.F_c=0;he.G_c=0;he.h3c=.5;he.KNd=!1;he.Cta=!1;he.eO=null;he.aBb=null;he.RD=null;he.sFc=null;he.color=null;he.wbf=!1;he.Ufc=!1;he.M3b="#BEBBB8";he.QCc=null;he.onKeyDown=function(Te){return 13!==
Te.Ea.keyCode||he.disabled?!1:(he.activateSheet(1),!0)};he.jz=function(Te){return 32!==Te.Ea.charCode||he.disabled?!1:(he.activateSheet(1),!0)};he.ZE=function(){he.disabled||(he.GR.wKi(he),he.GR.JE||he.Rma(!0,void 0,"OnMouseOver"))};he.HH=function(){he.disabled||he.Rma(!1,void 0,"OnMouseOut")};he.B8a=function(){he.GR.JE||(he.$wj(),he.sheet.P6||lf.g(he.$).mab(he.sheet.sheetName));return!1};he.Lyd=function(){he.uIe(!1);return!1};he.Vc=function(Te){if(he.disabled)return!0;var yg=lf.g(he.$);he.sheet.active||
3!==Te.zb?he.gm?he.activateSheet(Te.zb):Ae.a.Sod()&&yg.focus():(!Ae.a.iMa(he.$)&&!he.Pyb||yg.isEditing||yg.zi||yg.Uqb(),he.activateSheet(Te.zb));return 3!==Te.zb};he.onPointerDown=function(Te){if(he.disabled)return!0;he.uIe(!0);lf.g(he.$).inRangePicker&&Jc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var yg=3===Te.zb;if(2===Te.zb||yg&&he.owa)he.gm?(he.Rma(!0,!yg,"OnPointerDown"),yg=gg.Task.delay(yg?
he.kYf:he.jYf).CWR(function(){return!0})):yg=he.activateSheet(Te.zb),he.K5a&&(he.Ufc=!0,he.GR.mrc=Ff.TaskExtensions.Ba(yg,function(){he.Ufc&&he.GR.yKi(he,Te)},he.ma,11));return!1};he.Zg=function(Te){if(he.disabled||!he.K5a&&me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;var yg=he.GR.JE&&!Ae.a.Pbf();he.Ufc=!1;he.gm&&he.Rma(2===Te.zb,void 0,"OnPointerUp");he.GR.mrc&&(Ff.TaskExtensions.Ba(he.GR.mrc,function(){he.GR.xKi(he)},he.ma,11),he.GR.mrc=
null);return yg};he.lN=function(){if(!he.K5a&&me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;he.Ufc=!1;he.KNd||he.Rma(!1,void 0,"OnTouchMove");return!1};he.ywe=new Gb(he,X);he.gm=lc;he.cw=Jd;he.Pyb=Ae.a.Pyb(X);he.tld=me.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!he.cw;he.gm?(he.jYf=X.ya.SheetDragReorderDelayInMilliseconds,he.kYf=X.ya.SheetDragReorderDelayInMillisecondsForTouch,he.F_c=18,he.G_c=20):(he.F_c=
19,he.G_c=22);he.$=X;he.PUb=Rb;he.GR=Fc;he.K5a=Fc.Ume();he.u5g();he.t_g();he.lid=X.Ub.Xh("UserAction",he.name);he.umd=!1;rf.DOMElementExtensions.ro(he.domElement,df.a.vs,null,null);he.domElement.appendChild(he.anchor);he.anchor.appendChild(he.RD);he.Xma=new Qa.a;X=new wa(he.sheet,he.gm,he.cw);he.Xma.add(new Sb(he.$,X));he.$.fa.bJb&&(X=new va(he.sheet,he.gm,he.cw),he.Xma.add(new Sb(he.$,X)));he.tld||(X=new Fb(he.sheet,he.GR.Suc,function(){return he.color?hb.QOd(he.color):!1},he.cw),he.aBb=new Sb(he.$,
X),he.Xma.add(he.aBb));he.owa=he.GR.owa;he.deb();he.D1i();he.Fre=new qe.a(he.domElement,1);ta.insertBefore(he.domElement,tb);Ed.a(he.$)&&he.X$f(!0);return he}function Gb(X,ta){var tb=Le.call(this,X.domElement)||this;tb.onKeyDown=function(Rb){121===Rb.keyCode&&Rb.shiftKey&&!tb.$ma.disabled&&(tb.showContextMenu(new Sys.UI.Point(0,0),1,tb.$ma.anchor),de.g(Rb))};tb.Nba=function(Rb){if(!tb.$.isEditMode||tb.$ma.disabled)return!0;tb.rename(!1,Rb.zb);return!0};tb.Zk=function(Rb){return tb.$ma.disabled?!0:
tb.showContextMenu(Rb.clientPoint,Rb.zb,Rb.Sb)};tb.gee=X;tb.$=ta;K.a.instance.pa(wf.a.Ij,X.domElement,tb.Nba);Ee.a.instance.pa(X.domElement,tb.Zk);tb.wc.ja("keydown",tb.onKeyDown);return tb}function Sb(X,ta){var tb=this;this.Lpa=this.g1=this.sAa=this.Wj=null;this.Ecf=!1;this.uPc=this.vna=this.Xra=this.hha=this.Wra=null;this.ZE=function(){tb.dataSource.pH()&&Ff.TaskExtensions.Ba(tb.Yzb,function(){dialogControls.renderToolTip(tb.dataSource.yw(),"SheetIconTooltip",tb.dataSource.uTd(),tb.cI,10,!1,!1,
1)},tb.$.ma,3)};this.HH=function(){tb.dataSource.pH()&&tb.clearToolTip()};this.$=X;this.dataSource=ta;this.cw=Ae.a.eod()}function Fb(X,ta,tb,Rb){this.sheet=X;this.altText=Ve.a.instance.ea(1849);this.fDj=ta;this.OZf=tb;this.cw=Rb}function wa(X,ta,tb){this.gm=ta;this.cw=tb;this.sheet=X;this.altText=Ve.a.instance.ea(1926)}function va(X,ta,tb){this.gm=ta;this.cw=tb;this.sheet=X;this.altText=Ve.a.instance.ea(1927)}function sa(X,ta,tb){var Rb=Ra.call(this,document.createElement("a"),X,!0)||this;Rb.Rg=function(){Rb.RW(!1);
Rb.$.fa.hr(Rb.Rg)};Rb.Vc=function(Fc){Rb.Y5f(Fc.zb);return!0};Rb.onKeyDown=function(Fc){return 13===Fc.Ea.keyCode||32===Fc.Ea.keyCode?(Rb.Y5f(Fc.zb),!0):!1};Rb.Kra=ta.yb(Rb.domElement,Ve.a.instance.ea(503),0,Oc.a.Gmh,Ve.a.instance.ea(503),aa.a.nWh,Rb.disabled);Rb.domElement.classList.add(Lb.Jmh);tb.appendChild(Rb.domElement);Rb.$.fa.sn(Rb.Rg);Rb.t0i();return Rb}function sb(X,ta){var tb=ea.call(this,document.createElement("div"))||this;tb.cR=function(){Jc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");
tb.JNf(!1,"OnSheetsChanged")};tb.YBi=function(){tb.ak()};tb.XBi=function(){tb.mm()};tb.$=X;tb.tAj=ta;tb.Cta=!1;tb.zLb=0;return tb}function Tb(X,ta){this.sheetName=null;this.newSheetIndex=0;this.sheetName=X;this.newSheetIndex=ta}function Da(X,ta,tb){var Rb=Ra.call(this,document.createElement("a"),ta)||this;Rb.Vc=function(Fc){Rb.$.Ce(-684145703,Fc.zb,0,null);return!0};Rb.ACb=function(Fc){td.HelperMethods.mTd(Rb.Ase,Rb.Xga,Rb.Xga+df.a.Jcc,("mouseover"===Fc.type||"focus"===Fc.type)&&!lf.g(Rb.$).inRangePicker)};
Rb.$=ta;Rb.Xga=me.EwaSettings.la(524)?Oc.a.N7c:Oc.a.iMe;Rb.Ase=tb.yb(Rb.domElement,Ve.a.instance.ea(501),0,Rb.Xga,Ve.a.instance.ea(502),aa.a.f0c);X.appendChild(Rb.domElement);Rb.wc.ja("contextmenu",function(Fc){de.g(Fc)});Rb.wc.ja("mouseover",Rb.ACb);Rb.wc.ja("mouseout",Rb.ACb);K.a.instance.pa(wf.a.click,Rb.domElement,Rb.Vc);Rb.azb=h.KeyInputManager.instance.Ur(Rb.domElement,Rb.Vc,ha.a.$h,ha.a.K0);return Rb}function Sa(X,ta,tb,Rb){Rb=void 0===Rb?!1:Rb;var Fc=Ra.call(this,document.createElement("a"),
ta,Rb)||this;Fc.Vc=function(lc){Fc.disabled||Fc.$.Ce(-1935155518,lc.zb,30,null);return!0};Fc.ACb=function(lc){lc="mouseover"===lc.type||"focus"===lc.type;var Jd=Ed.a(Fc.$)?Fc.N9a:Fc.Kra;td.HelperMethods.mTd(Jd,Fc.Xga,Fc.Xga+df.a.Jcc,lc&&!lf.g(Fc.$).inRangePicker)};Fc.Mj=function(){Fc.RW(!0)};Fc.Rh=function(){Fc.RW(!1)};Fc.Xga=me.EwaSettings.la(524)?Oc.a.N7c:Oc.a.iMe;Fc.Kra=tb.yb(Fc.domElement,Ve.a.instance.ea(499),0,Fc.Xga,Ve.a.instance.ea(500),aa.a.f0c,Rb);X.appendChild(Fc.domElement);Fc.wc.ja("contextmenu",
function(lc){de.g(lc)});me.EwaSettings.la(524)||(Fc.wc.ja("mouseover",Fc.ACb),Fc.wc.ja("mouseout",Fc.ACb));K.a.instance.pa(wf.a.click,Fc.domElement,Fc.Vc);Fc.azb=h.KeyInputManager.instance.Ur(Fc.domElement,Fc.Vc,ha.a.$h,ha.a.K0);me.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(lf.g(Fc.$).rc.wm(Fc.Mj),lf.g(Fc.$).rc.hq(Fc.Rh));return Fc}function Ra(X,ta,tb){tb=void 0===tb?!1:tb;X=H.call(this,X)||this;X.Kra=null;X.N9a=null;X.$=ta;X.sX=tb;return X}function Lb(){}
function Ja(){this.tFe=new Ab.a(!0);this.FFc=0}function wb(X){return $h.call(this,X)||this}function Mb(X){this.zdh=X}function Eb(X){return Rg.call(this,X)||this}function Ic(X,ta,tb,Rb){var Fc=this;this.menuId=null;this.rQa=-1;this.hAf=function(){Fc.Cca()};this.RLi=function(lc){if(!(Fc.va.bLa()||(!me.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||fh.a(lc)||Fc.P4a())&&fh.a(lc)&&Fc.P4a())){lc=Fc.va.activeCell;var Jd=Fc.va.activeRange,he=Fc.tableManager.Wg.usedRange;
2===Fc.rQa&&Me.g(Fc.tableManager.Wg)&&lc.bottom===he.bottom&&(Jd=Jd.bba?new xc.Range(Jd.top-1,Jd.left,Jd.bottom-1,Jd.right,!1,!0):new xc.Range(Jd.top,Jd.left,Jd.bottom-1,Jd.right,!1,!0),lc=Jd.contains(lc)?lc:xc.Range.ld(Jd.bottom,lc.left),lf.g(Fc.$).ha.updateSelection(Jd,lc,0,3))}};this.iLi=function(lc){fh.a(lc)?(Jc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),Fc.$.Gf()):Jc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};
this.hLi=function(){Jc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");Fc.$.Gf()};this.jLi=function(lc,Jd){Jd&&Fc.ZK(Jd);fh.b(lc,-569193796)&&(Th.a(Fc.$).nd.AD(-569193796),Fc.Qji(lc.Errors[0]))};this.$=X;this.tableManager=ta;this.namedSheetViewPublic=tb;this.frame=this.$.frame;this.ha=lf.g(this.$).ha;this.va=this.ha.va;this.aw=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Rb;this.tableStyleManager.bCg(this.hAf)}
function Zc(X){X=Dh.call(this,X)||this;var ta=lf.g(X.$);ta=ta.Vb.vk(ta.ha.va.activeCell);Tf.a.yj(ta.TKb)?X.originalTitle="":X.originalTitle=ta.TKb;Tf.a.yj(ta.UKb)?X.originalDescription="":X.originalDescription=ta.UKb;ta=X.LU(X.originalTitle,X.originalDescription);X.initializeAndShow(Ve.a.instance.ea(726),X.$zj,ta);return X}function Pc(X){var ta=Tg.call(this,X)||this;ta.iAj=function(tb,Rb){1===tb&&ta.CEj(dd.D(ta.FCf(Rb[Pc.XHf])))};ta.iub=function(tb){tb=ta.mdd(tb);return ta.Jad(tb)};ta.gridView=lf.g(X);
ta.va=ta.gridView.ha.va;ta.lnc=ta.gridView.Vb.vk(ta.va.activeCell).usedRange;X=ta.LU(ta.lnc.toString());ta.initializeAndShow(Ve.a.instance.ea(717),ta.iAj,X);return ta}function vd(X,ta){X=Cf.call(this,X)||this;X.vAa=ta;return X}function Tc(X,ta){X=be.call(this,X,Ve.a.instance.ea(716))||this;X.vAa=ta;return X}function rb(X,ta,tb){this.gyb=!1;this.sharedSheetRange=ta;this.$=X;this.dh=this.$.Ub.Xh("UserAction","ConvertToRangeManager");this.tableName=tb}function eb(X,ta){var tb=this;this.pYd=null;this.qYd=
0;this.ej=null;this._state=0;this.moveNext=function(){try{for(tb._state=1;1===tb._state;)tb.hu=tb.hu()}catch(Rb){tb.dispose(),tb._state=3}};this.wf=X;this.EBa=ta;this.hu=this.fL;this.moveNext()}function Ta(X){this.tableName=null;this.tableName=X}function fb(X,ta,tb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=X;this.optionType=ta;this.isPivotTable=tb}function pb(X){this.originalRange=null;this.originalRange=X}function rc(X,ta){this.newName=this.oldName=null;this.oldName=
X;this.newName=ta}function vb(X,ta,tb,Rb){this.newDescription=this.originalDescription=this.newTitle=this.originalTitle=null;this.originalTitle=X;this.newTitle=ta;this.originalDescription=tb;this.newDescription=Rb}function E(X,ta,tb,Rb){X=Nb.call(this,X,tb)||this;X.hasHeaders=!1;X.isCreation=!1;X.hasHeaders=ta;X.isCreation=Rb;return X}function Nb(X,ta){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=X;this.tableRange=dd.l(X.Ranges[0],X.SheetName);this.styleIndex=ta}function ka(X){this.autoFilterOptions=
null;this.autoFilterOptions=X}function bb(X,ta){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=X;this.sortType=ta}function Ha(X){var ta=xb.call(this)||this;ta.tableStyleManager=null;ta.$=X;ta.dc();return ta}function Ga(X,ta,tb){var Rb=Dc.call(this)||this;var Fc={};Rb.UTi=(Fc.height="100%",Fc);Rb.EFb={};Rb.nfd=0;Rb.hHa=0;Rb.lastSyncTime=new Date;Rb.dda=-1;Rb.rN=null;Rb.Qla={};Rb.XK=null;Rb.xF={};Rb.YRa={};Rb.Lpc=null;Rb.Ccf=!1;Rb.isInitialized=!1;Rb.e5a=!1;Rb.Eyb=!1;Rb.Jsc=null;
Rb.$Re=!1;Rb.AKb=!1;Rb.bxc=!1;Rb.Dth=function(){Rb.Dgc()?Rb.$.fa.EGd(Rb.Dth):Rb.XJa("tableStyleManagerInitialization")};Rb.Fuf=function(lc,Jd,he){var Te=!1,yg=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(fh.a(lc))-315732528!==lc.Errors[0].MessageId&&(Jc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",yh.a.Uc(lc.Errors)),Rb.iyd(null,Jd,he));else if(Jc.ULS.sendTraceTag(537151202,
0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(lc=lc.Result)&&lc.TableStyleItems.length){he=60<lc.TableStyleItems.length;var Kg=!1,Ug=!1;if(Rb.XK)for(var ae=0;60>ae;++ae){var Re=lc.TableStyleItems[ae],Ri=Rb.XK.TableStyleItems[ae];if(yg&&Re.HasStyleViolations!==Ri.HasStyleViolations){Te=Ug=!0;break}for(var yj=0;9>yj&&!(yj>=Re.TableStyleElementsList.length);yj++)if(!Tf.a.equals(Re.TableStyleElementsList[yj].BackgroundColor,Ri.TableStyleElementsList[yj].BackgroundColor,!1)){Te=
Kg=!0;break}}else for(Rb.hHa=0,ae=yl(lc.TableStyleItems),Re=ae.next();!Re.done;Re=ae.next())Re=Re.value,Re.TableStyleElementsList&&Re.TableStyleElementsList.sort(jb.Mjf),Rb.xF[Re.Name]=Re;if(Kg||Ug)for(Kg=0;60>Kg;++Kg)Ug=lc.TableStyleItems[Kg],Rb.xF[Ug.Name]=Ug;if(he&&Rb.XK)for(Jc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",lc.TableStyleItems.length-60),Te=!0,he=60;he<lc.TableStyleItems.length;++he)Kg=lc.TableStyleItems[he],Kg.Name in
Rb.xF||Kg.TableStyleElementsList&&Kg.TableStyleElementsList.sort(jb.Mjf),Rb.xF[Kg.Name]=Kg;if(Xb.a(Rb.xF).length!==lc.TableStyleItems.length)for(Te=!0,Kg=he=60;Kg<Rb.XK.TableStyleItems.length;)he>=lc.TableStyleItems.length?delete Rb.xF[Rb.XK.TableStyleItems[Kg].Name]:he>=lc.TableStyleItems.length||!Tf.a.equals(lc.TableStyleItems[he].Name,Rb.XK.TableStyleItems[Kg].Name,!1)?delete Rb.xF[Rb.XK.TableStyleItems[Kg].Name]:++he,++Kg;Rb.XK=lc;Rb.XJf(Te);Te&&Rb.fXc();yg&&Jd&&("accessibility"===Jd?(Rb.AKb=
!1,Rb.bxc=!0):Rb.bxc=!1);Rb.Ccf||(Rb.$fi()&&Rb.$.Gf(),Rb.Ccf=!0);Rb.nfd=0;Rb.Eyb||Rb.$Re?yg&&Rb.bxc&&Rb.raiseEvent("RefreshTableStyleGallery"):(Rb.raiseEvent("RefreshTableStyleGallery"),Rb.$Re=!0)}};Rb.iyd=function(){Jc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");Rb.nfd++;5>Rb.nfd&&Ld.a.instance.create(function(){Rb.XJa("getTableStylesFailed")},1E3,Od.a.j4f,!0,!0)};Rb.gAf=function(){Rb.Eyb&&(Rb.Eyb=!1,Rb.Jsc&&Rb.Jsc(),Ld.a.instance.create(function(){Rb.XJa("galleryMenuClosed")},
1E3,Od.a.j4f,!0,!0))};Rb.$=X;Rb.Sa=ta;Rb.tableManager=tb;Rb.$.da.Ha(329,Rb);Rb.CXc=Rb.Ntb();Rb.$.Ka.cFa(Rb.gAf);return Rb}function Ua(X,ta,tb,Rb,Fc,lc){this.headerRow=X;this.totalRow=ta;this.firstCol=tb;this.lastCol=Rb;this.xR=Fc;this.qha=lc}function jb(){}function $a(){}function Yb(X){var ta=$e.call(this)||this;ta.tableManager=null;ta.$=X;ta.dc();return ta}function ec(X){var ta=Aa.call(this,lf.g(X))||this;ta.rob=null;ta.Cxc=null;ta.t0=null;ta.tob=null;ta.xne=!1;ta.G7d=null;ta.UPb=0;ta.O3b=null;ta.DZb=
function(){var tb={},Rb=ta.ved(),Fc;for(Fc in Rb){var lc=Rb[Fc];if(lc){var Jd=ta.HSh(lc);if(Jd){if(Jd in ta.OEa){var he=ta.OEa[Jd];if(he.yA){he.Hn.equals(lc)||(he.Hn=lc);delete ta.OEa[Jd];tb[Jd]=he;continue}}(he=Ca.createInstance(lf.g(ta.$),lc,ta.yCh(),ta))?tb[Jd]=he:Jc.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",lc.qE(!1))}}}ta.I0b(null,null);ta.yOb=tb};ta.I0b=function(){var tb=ta.OEa,Rb;for(Rb in tb){var Fc=Rb,lc=tb[Rb];lc&&(lc.dispose(),
delete ta.OEa[Fc])}ta.yOb={}};ta.aIf=function(){ta.I0b(null,null);ta.DZb(null,null)};ta.onFocus=function(){ta.G7d=lf.g(ta.$).ha.va.activeCell};ta.I5=function(){ta.$.isEditMode&&ta.Gh(null,null)};ta.Gh=function(){!ta.xne&&Cd.c(ta.$,ta.gridView.ha.va.activeCell)&&ta.oli()};ta.aN=function(){ta.Hwb(1);ta.$.fa.hr(ta.aN)};ta.uEb=function(){ta.xne=!0;ta.Cxc=new Za(ta.$)};ta.$=X;ta.gridView=lf.g(ta.$);ta.$.da.Ha(66,ta);ta.yOb={};ta.DZb(null,null);ta.$.xa&&ta.$.xa.Pf(ta.aIf);ta.wle(ta.DZb);ta.$.fa.i9(ta.I5);
ta.gridView.ha.fG(ta.Gh);ta.$.isEditMode&&ta.Gh(null,null);return ta}function Za(X){var ta=hh.call(this,document.createElement("div"))||this;ta.pQ=!1;ta.ACf=!1;ta.Fld=!1;ta.KRc=!1;ta.PHb=null;ta.Gh=function(){Cd.c(ta.$,ta.gridView.ha.va.activeCell)?(ta.cLa=!0,ta.Spb(!1)):(ta.cLa=!1,ta.C4=!1,ta.U8f())};ta.Ns=function(){ta.cLa?ta.Spb(!0):ta.C4=!1};ta.srf=function(){ta.KRc=!0;ta.cLa&&(ta.C4=!1)};ta.onContentReady=function(){ta.$.isEditMode?Cd.c(ta.$,ta.gridView.ha.va.activeCell)&&(ta.cLa=!0,ta.Spb(!1)):
ta.C4=!1};ta.PBb=function(){ta.KRc=!1;ta.cLa?ta.Spb(!1):ta.C4=!1};ta.Pe=function(tb,Rb){ta.cLa&&(tb=ta.gridView.xnc(Rb.$c.block.ie.BlockCachePosition.PaneType).JF(Rb.$c.hash))&&(tb.qHd(ta.rKa),tb.STc(ta.rKa))};ta.rKa=function(){ta.FNf()};ta.$=X;ta.gridView=lf.g(ta.$);ta.parentElement=ta.domElement;ta.parentElement.className=Wa.enh;ta.dKa=ta.gridView.Ui;ta.cLa=!0;ta.z4h();ta.CHg();ta.Spb(!1);Jc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return ta}function Wa(){}
function Ca(X,ta,tb,Rb){var Fc=ud.call(this,X)||this;Fc.i4f=[6];Fc.b4f=[26];Fc.Ar=null;Fc.Mgc=!1;Fc.Zxb=!1;Fc.taa=null;Fc.Js=null;Fc.onPointerDown=function(lc){if(1!==Fc.$.Ka.LG())return!0;lc=hg.a(Fc.$).Fe(lc);if(Fc.yA)return!0;var Jd=Lg.a(Fc.$).xmd||Lg.a(Fc.$).sq();if(Fc.sod||Jd)return Fc.qab(),!0;Fc.Js=Fc.Hn;Fc.XFd();Fc.Phd();Jd=2===lc.zb&&!lc.An;var he=3===lc.zb;if(Jd||he)lc=Fc.ha.gr(lc.clientPoint,lc.Sb,5,void 0,void 0,!0),lc||(lc=Fc.Js),Fc.Zxb=Jd,Fc.Mgc=he,Fc.Js=Fc.R0e(lc),Fc.Phd(),Jd?Fc.$0i():
he&&Fc.M1i(),sg.b(Fc.$,!0);return!0};Fc.Nj=function(lc){lc=hg.a(Fc.$).Fe(lc);if(!Fc.yA)return!1;if(lc=Fc.Zxb?Fc.ha.gr(lc.clientPoint,lc.Sb,5,void 0,void 0,!0):Fc.ha.gr(lc.clientPoint,lc.Sb,5,!0,!1,!0))lc=Fc.R0e(Fc.pYb(lc)),Fc.g_b(lc.bottomRight),Fc.Js.equals(lc)||(Fc.Js=lc,Fc.SFb(!1),Fc.XFd(!1),Fc.Phd(!1),Fc.n0h(),Fc.Nb.update(!1)),Fc.UIj(Fc.Js);return!0};Fc.Zg=function(lc){hg.a(Fc.$).Fe(lc);if(!Fc.yA)return!1;Fc.resizeTable();Fc.qab();return!0};Fc.lDb=function(lc){hg.a(Fc.$).Fe(lc);if(!Fc.yA)return Jc.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;Fc.resizeTable();Fc.qab();return!0};Fc.Vxa=function(lc){hg.a(Fc.$).Fe(lc);Fc.qab();return!0};Fc.nrf=function(){Fc.yA&&Fc.qab()};Fc.gridView=ta;Fc.$=ta.$;Fc.tableManager=Rb;Fc.ha=ta.ha;Fc.Nb=ta.Nb;Fc.parentElement=X;Fc.nNg();dg.a.Pr||dg.a.fwa||Fd.a.instance.pa(wf.a.pointerDown,Fc.taa,Fc.onPointerDown);Fc.Hn=tb;Fc.sod=!1;Fc.CJc=!1;Fc.tableManager.tzg(Fc.nrf);return Fc}function db(X){var ta=nb.call(this)||this;
ta.$=X;ta.dc();return ta}function $b(X){var ta=this;this.Rg=function(){ta.Ghf();ta.$.fa.hr(ta.Rg)};this.$=X;this.R3f={};this.TRd={};var tb=me.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",Rb=this.qXe(tb);Rb?(this.Yje(Rb),this.$.fa.Mh?this.Ghf():X.fa.sn(this.Rg),this.$.da.Ha(388,this)):Jc.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",tb)}function Jb(){}function Hc(X){var ta=Uf.call(this)||this;ta.sparklineManager=
null;ta.$=X;ta.dc();return ta}function uc(X,ta){X=Aa.call(this,X)||this;ta.Ha(240,X);return X}function Aa(X){var ta=Bf.call(this)||this;ta.BS=[];ta.Pe=function(he,Te){var yg,Kg=Te.$c.block;he=!1;if(Kg.tk&&Kg.state&1&&(yg=ta.view.fg(Te.$c.block.ie.BlockCachePosition.PaneType).JF(Te.$c.hash))){Kg=ta.TDd(Kg.re);if(yg=yg.Wf)for(var Ug=ta.BS.length-1;0<=Ug;Ug--)yg.contains(ta.BS[Ug].bottomRight)&&(Array.removeAt(ta.BS,Ug),he=!0);if(Kg)for(yg=0,Ug=Kg.length;yg<Ug;yg++)Array.add(ta.rangeList,He.a.fQ(Kg[yg])),
he=!0;he&&(Te=(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?ta.view.xnc(Te.$c.block.ie.BlockCachePosition.PaneType):ta.view.J2).JF(Te.$c.hash),ta.raiseEvent(Aa.UDd,new Qe.a(Te)))}};ta.Hm=function(){ta.MFb()};ta.ko=function(){ta.BS=[]};ta.Oge=X;var tb=X.Ca;tb.gq(ta.Pe);tb.nga(ta.Pe);tb.BXb(ta.Pe);tb.gG(ta.Hm);X.$.xa.aJ(ta.ko);X.$.xb.aJ(ta.ko);tb=yl(X.jn);for(var Rb=tb.next();!Rb.done;Rb=tb.next()){Rb=yl(Rb.value);for(var Fc=Rb.next();!Fc.done;Fc=
Rb.next()){Fc=yl(Fc.value);for(var lc=Fc.next();!lc.done;lc=Fc.next()){lc=lc.value;var Jd=X.Ca.jl(lc.hashCode);ta.Pe(ta,new Md.a(new od.a(Jd,lc.hashCode),null))}}}return ta}function mb(X){var ta=Ob.call(this)||this;ta.$=X;ta.dc();return ta}function dc(X,ta){var tb=this;this.KV=function(){tb.Ld||tb.qne()};this.Ld=!1;this.FY=ta.YT;this.ariaLiveNotifier=X;this.MXd=new bd(X,ta);this.FY&&this.FY.uQ?this.qne():this.ak()}function Ac(X,ta,tb){var Rb=this;this.Cvf=function(){Rb.MXd.KIf();Rb.ariaLiveNotifier.setEnabled(!0)};
this.$=ta;this.ariaLiveNotifier=X;this.MXd=new bd(X,ta);this.B8b=tb.Xdd(this.$);this.B8b.TAg(this.Cvf)}function bd(X,ta){this.$=ta;this.ariaLiveNotifier=X}function Kd(X){var ta=Ba.call(this)||this;ta.$=X;ta.dc();return ta}function Yd(X,ta,tb,Rb,Fc){var lc=this;this.gridReadoutNotifier=null;this.m$a=!1;this.Mra=this.lnb=null;this.tca=function(){me.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!lc.$?Jc.ULS.sendTraceTag(0,0,15,"calling readActiveItemDescription after dispose, ignoring."):
lf.g(lc.$).isEditing||lc.sZb.Bq()};this.syi=function(){if(!lf.g(lc.$).ha.Qa.tnd){var Jd=lc.ZBh();lc.readText(Jd.returnValue,Jd.activeCell)}};this.GH=function(){var Jd=lc.activeCell;lc.readText("Editing",Jd);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Jd&&Jd.pKa&&!lf.g(lc.$).$3e||lc.sZb.cancel()};this.kd=function(){lc.tca();lc.m$a&&lf.g(lc.$).inRangePicker&&1===Qf.a.Wb&&(null===lc.lnb?lc.lnb=Ld.a.instance.create(lc.rEd,Yd.HRc,"readSelectedRanges"):lc.lnb.Bq())};
this.$=ta;this.ariaLiveNotifier=X;this.sparklineManager=Rb;this.tableManager=tb;this.MC=new qd;this.b5a=Wd.b5a();this.m$a=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.b5a&&(me.EwaSettings.gH()?this.gridReadoutNotifier=Fc:this.gridReadoutNotifier=ta.da.Aa(244),Jc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Yd.HRc=700);this.sZb=Ld.a.instance.create(this.syi,Yd.HRc,Od.a.Sej,
!1);this.ak()}function qd(){this.activeItemName=null;this.Cdf=!1;this.tableName=null;this.VZa=0;this.Axc=!1}function Ie(){}function cc(X){switch(X){case 1:return 1405;case 2:return 1406;case 3:return 1407;case 4:return 1408;case 5:return 1409;case 6:return 1410;case 7:return 1411;case 8:return 1412;case 9:return 1413;case 10:return 1414;case 11:return 1415;case 12:return 1416;case 13:return 1417;case 14:return 1418;case 15:return 1419;case 16:return 1420;case 17:return 1421;case 18:return 1422;case 19:return 1423;
case 20:return 1424;case 21:return 1425;case 22:return 1428;case 23:return 1426;case 24:return 1427;case 25:return 1429;case 26:return 1430;case 27:return 1431;case 28:return 1432;default:return 1433}}function Qd(X){var ta=Hg.call(this)||this;ta.$=X;ta.dc();return ta}function Wd(X,ta){this.F_=this.r6=this.fW=null;this.Cia=ta;this.y4g(X);this.hTi();me.EwaSettings.gH()&&X.da.Ha(244,this)}function ee(X){var ta=$f.call(this)||this;ta.$=X;ta.dc();return ta}function ne(X,ta,tb){var Rb=this;this.$rf=function(Fc,
lc){Rb.DIf(lc.ee.command)};this.$=X;this.tea=document.createElement("div");this.tea.setAttribute(df.a.dP,df.a.rj);this.tea.className=mf.a.D7c;ta.insertBefore(this.tea,tb);this.Hfa=document.createElement("div");this.Hfa.setAttribute(df.a.dP,df.a.rj);this.Hfa.className=mf.a.D7c;ta.insertBefore(this.Hfa,this.tea);this.Gng=Ve.a.instance.Va(2);this.Kga=document.createElement("div");this.Kga.setAttribute(df.a.Sd,df.a.Bga);this.Kga.setAttribute(df.a.Cga,df.a.bnb);this.Kga.className=mf.a.D7c;ta.insertBefore(this.Kga,
this.Hfa);this.register();this.$.da.Ha(211,this)}function Bd(X,ta){ta&&(X.append(ta),X.append(Pd.Esd))}function Pd(X){this.vsc=X||""}function ze(X){var ta=xe.call(this)||this;ta.$=X;ta.dc();return ta}function Jf(X){var ta=zd.call(this)||this;ta.crd=null;ta.$=X;Jc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return ta}function oc(){return qf.call(this)||this}function hd(X){var ta=Sf.call(this)||this;ta.$=X;ta.dc();return ta}function wc(X){var ta=We.call(this,document.documentElement,
X)||this;ta.qB=0;ta.cJg=[Fe.a.f1c,Fe.a.awd,Fe.a.acc,Fe.a.i6f,Fe.a.kJd,Fe.a.hXc,Fe.a.fad,Fe.a.$1e,Fe.a.rWc,Fe.a.$Kb,Fe.a.Muj,Fe.a.igd,Fe.a.yYc,Fe.a.Isb,Fe.a.NNd,Fe.a.FYc,Fe.a.k2f,Fe.a.Chf,Fe.a.LWc];ta.VNj=[Fe.a.acc,Fe.a.Bbg,Fe.a.Abg,Fe.a.Cbg];ta.hUi=[Fe.a.acc,Fe.a.yFf,Fe.a.zFf,Fe.a.CFf];ta.jRg=[Fe.a.hSe,Fe.a.Z1e,Fe.a.dad,Fe.a.bad];ta.LTi=[Fe.a.f1c,Fe.a.awd,Fe.a.hXc,Fe.a.fad,Fe.a.rWc,Fe.a.$Kb,Fe.a.igd,Fe.a.yYc,Fe.a.Isb,Fe.a.NNd,Fe.a.TEf,Fe.a.FYc,Fe.a.LWc];var tb=Ve.a.instance.Va(251);ta.Kij=ta.$.shortcutKeyManager.H$b(tb);
ta.mode=0;X.da.Ha(15,ta);Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(X.da,21,137,1),function(Rb){Rb=Rb.result;Rb.Pn(Rc.a.olb);Rb.Km(Rc.a.olb,ta.SGb)},X.ma);return ta}function gb(){this.dlb=this.Rbe=this.rb=null;this.sm=!1}function kd(X,ta,tb,Rb,Fc,lc,Jd){this.nfb={};this.v1=X;this.yng=ta;this.oqa=new Cb(le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.DC.hkc);this.Sqa=new Cb(le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.DC.hkc);this.Upg=tb;this.hhe=Rb;this.gug={};this.xS=new Bb;this.Lkg=Fc;this.JSb="";this.rv=lc;this.c3d=Jd;return this}function Lc(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function Cb(X,ta,tb){this.task=
null;this.ndc=X;this.Cri=ta;this.taskManager=tb;this.retryCount=this.Rwb=0;this.aNc=this.szb=null}function Bb(){this._state=0;this.Q9d=this.S9d=this.R9d=null;this.state=this.Tfe=0;this.xIc=!1;return this}function Hb(X,ta,tb,Rb,Fc){this.Nlg=6E4;this.b7e="inactive";this.Ohe="active";this.AX=!0;this.je=X;this.Pkg=ta;this.$Gc=tb;this.GVb=Rb;this.Ya=new wd.a;Fc&&this.bxj();this.H7d=this.KXe()}function Pb(X,ta){this.nfb={};this.v1=X;this.ekb=new ed(ta,this.RAb.hkc,"GetMoreInfo");this.xo=new ce;return this}
function ed(X,ta,tb){this.EUb=this.Ri=null;this.TNc=0;this.Zqg=X;this.je=ta;this.g2d=tb}function Xc(X,ta,tb,Rb,Fc,lc,Jd,he){this.La=X;this.Og=ta;this.vgg=tb;this.V0=Rb;this.je=Fc;this.$Gc=lc;this.ilg=Jd;this.uVb=he}function ce(){this._state=0;this.GPc=this.Bjb=null;this.state=0;this.xIc=this.L5d=!1;return this}function Xd(){this._state=0}function nd(){this.nfb={}}function je(){this.rb=null}function Xe(){this.aVa=null}function Ne(X){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
le.AFrameworkApplication.ga.appSettings.RoamingServiceHandlerWebServiceBase||"",X,le.AFrameworkApplication.hj)}function Ig(X){var ta=new Be.a;le.AFrameworkApplication.Hd.Ul(Ne(X),1,null,null,!0,2,function(tb){200===tb.data.httpStatus?ta.setResult("true"===tb.data.fe.toLowerCase()):ta.setResult(!1)},function(){ta.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ta.task}function Lf(X,ta){this.La=X;this.sOb=ta}function Hf(X){var ta=ie.call(this,!1,!1,!0)||this;ta.sOb=X;return ta}function ag(X,
ta){this.ID=X;this.type=ta}function Bg(X,ta){this.value=X;this.contextId=ta}function uf(X,ta,tb,Rb,Fc,lc,Jd,he){this.type=X;this.startTime=null==tb||void 0==tb.value?new Bg(tb,null):tb;this.endTime=null==Rb||void 0==Rb.value?new Bg(Rb,null):Rb;null!=Fc&&void 0!=Fc.value||new Bg(Fc,null);null!=lc&&void 0!=lc.value||new Bg(lc,null);this.operationType=he}function sf(X){this.ID=X}function xg(){this.Ne=[];this.Mmb=[];this.BUc=0;this.duration=this.startTime=null;this.W5b={};this.Ntd=this.rud=this.XVc=-1}
b.r(D);var sc=b(0),Sc=b(80),Qc=b(140),ie=Qc.a;vm(Hf,ie);Hf.prototype.start=function(){var X={},ta={};X=(ta.id="AccessibilitySettingsDialog",ta.bodyControls=(X.tooltipPersistenceEnabled=this.sOb.l6e,X),ta);this.initializeAndShow("",Object(Sc.a)(this,this.R$i,"resultHandler"),X)};Hf.prototype.R$i=function(X,ta){1===X&&(this.sOb.l6e=ta.tooltipPersistenceEnabled)};Object(sc.a)(Hf,"AccessibilitySettingsDialog",Qc.a,[]);var ue=b(108),Ce=b(29);Lf.prototype.Mg=function(){this.La.$b(Ce.a.frj,ue.a.frame,Object(Sc.a)(this,
this.grj,"showAccessibilitySettingsDialogHandler"))};Lf.prototype.grj=function(){(new Hf(this.sOb)).start();return 32};Object(sc.a)(Lf,"AccessibilitySettingsDialogActor",null,[206]);var Be=b(139),le=b(5),hc=b(168);Xe.prototype.eli=function(){var X=this,ta=new Be.a;if(this.aVa)ta.setResult(this.aVa);else if(this.qdf()){var tb=Ig("getHoverableRibbonTooltipIsEnabled");tb.continueWith(function(){X.aVa=tb.result;hc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(tb.result);
ta.setResult(tb.result)},8)}else ta.setResult(!1)};Xe.prototype.qdf=function(){var X=le.AFrameworkApplication.ga.ra("IsRoamingServiceEnabled"),ta=le.AFrameworkApplication.ga.ra("IsAnonymousUser");return X&&!ta};tl.Object.defineProperties(Xe.prototype,{l6e:{configurable:!0,enumerable:!0,get:function(){return!!this.aVa},set:function(X){X!==this.aVa&&(this.aVa=X,hc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(X),this.qdf()&&le.AFrameworkApplication.Hd.Ul(Ne("saveHoverableRibbonTooltipIsEnabled"),
2,X.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(sc.a)(Xe,"AccessibilitySettingsInfo",null,[204]);var gd=b(274),xd=b(167);je.prototype.di=function(X){var ta=this;this.rb=X;this.rb.register(Xe,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ic(function(){return new Xe}).zc();this.rb.register(Lf,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ic(function(){return new Lf(le.AFrameworkApplication.Eb,
ta.rb.Hh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).zc()};je.prototype.init=function(){var X=this.rb.Hh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ta=this.rb.Hh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");X&&ta?(ta.Mg(),X.eli()):xd.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};je.prototype.dispose=function(){};je.main=function(){gd.a.instance.mj(new je)};
tl.Object.defineProperties(je.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(sc.a)(je,"AccessibilitySettingsPackage",null,[4,5]);var re=b(685),Jc=b(13);nd.prototype.Rug=function(X){this.nfb[X.id.toString()]=X};nd.prototype.fwi=function(X){var ta=this.nfb,tb;for(tb in ta)ta[tb].notify(X,!1);this.nfb={}};nd.prototype.UVi=function(X,ta){ta&&this.Rug(ta);return this.qyf(X,ta)};nd.prototype.q6c=function(X){this.fwi(X)};nd.prototype.$He=
function(X,ta){X.notify(ta,!0)};Object(sc.a)(nd,"AEventEmitter",null,[832]);var Bc;(function(X){X[X.notStarted=0]="notStarted";X[X.waiting=1]="waiting";X[X.shouldRetry=2]="shouldRetry";X[X.complete=3]="complete"})(Bc||(Bc={}));Object(sc.b)("EventResultState",Bc);tl.Object.defineProperties(Xd.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(X){var ta={};Jc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(ta.OldState=Bc[this._state],
ta.NewState=Bc[X],ta),"ResultType",this.a_e());this._state=X}}});Object(sc.a)(Xd,"AEventResult",null,[867]);vm(ce,Xd);ce.prototype.a_e=function(){return"GetMoreInfo Result"};tl.Object.defineProperties(ce.prototype,{hR:{configurable:!0,enumerable:!0,get:function(){return this.Bjb}},sna:{configurable:!0,enumerable:!0,get:function(){return this.GPc}},M6h:{configurable:!0,enumerable:!0,get:function(){return this.L5d}}});Object(sc.a)(ce,"GetMoreInfoResult",Xd,[868,867]);var ye=b(77),cb=b(47),nc=b(807),
Nc=b(371),Rc=b(170),Wc=b(689),fe=b(597);Xc.prototype.h0i=function(){this.I7a.$b(Ce.a.openUrlInNewTab,ue.a.frame,Object(Sc.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.I7a.$b(Ce.a.jOa,ue.a.frame,Object(Sc.a)(this,this.jOa,"openDocumentUrl"));le.AFrameworkApplication.SP?this.Uif():this.I7a.jf(Ce.a.v5b,ue.a.frame,Object(Sc.a)(this,this.v5b,"documentLoaded"),96)};Xc.prototype.openUrlInNewTab=function(X,ta,tb,Rb,Fc){Fc&&Fc.MenuItemId&&(X={},Jc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",
(X.Id=Fc.SourceControlId,X.AppType=fe.a[this.Dba],X)),cb.a.sf(Fc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};Xc.prototype.jOa=function(X,ta,tb,Rb,Fc){if(Fc&&Fc.MenuItemId){var lc=le.AFrameworkApplication.ga.ra("WacInTabOpenMRUIsEnabledForUiHost"),Jd=le.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");Jc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",lc,Jd);if(lc&&Jd){X={};Jc.ULS.sendTraceTag(592237458,
202,50,"Opening new tab {0}",(X.Id=Fc.SourceControlId,X.AppType=fe.a[this.Dba],X));Fc=Fc.MenuItemId.toString();var he={};he[Nc.a.iPa]="1";he[Nc.a.documentUrl]=Fc;he[Nc.a.reason]=Wc.a.open;Jc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");le.AFrameworkApplication.NU().execute(function(Te){Te.Qj(Rc.a.dta,he)})}else this.openUrlInNewTab(X,ta,tb,Rb,Fc)}return 32};Xc.prototype.v5b=function(){this.Uif();return 32};Xc.prototype.SMa=function(X,ta,tb){tb=void 0===
tb?"":tb;if(ta&&ta.AE){var Rb=nc.a[ta.status];ta=ta.AE.getTime();var Fc=this.Sv()-ta,lc={};Jc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(lc.Caller=X,lc.RequestStatus=Rb,lc.ElapsedMs=Fc,lc.StartTime=ta,lc.Notes=tb,lc))}else tb={},Jc.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",(tb.Caller=X,tb))};Xc.prototype.Uif=function(){var X=le.AFrameworkApplication.ga.ra("QPGVCI"),ta=ye.a.tA(document.URL,"wdNewAndOpenCt",
X);if(ta){ta=parseInt(ta);var tb=ye.a.tA(document.URL,"wdPreviousSession",X);X=ye.a.tA(document.URL,"wdPreviousCorrelation",X);var Rb=le.AFrameworkApplication.ga.ra("NAOPLP");if(le.AFrameworkApplication.SP){var Fc=le.AFrameworkApplication.SP.getTime();if(!ta||ta>Fc)Rb={},Jc.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(Rb.ClickTimestamp=ta,Rb.DocumentLoadedTime=Fc,Rb.SessionId=tb,Rb.Correlation=X,Rb));else{var lc={};Jc.ULS.sendTraceTag(5849683,
202,Rb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(lc.ClickToLoadTime=Fc-ta,lc.ClickTimestamp=ta,lc.SessionId=tb,lc.Correlation=X,lc))}}else Fc={},Jc.ULS.sendTraceTag(5849681,202,Rb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(Fc.ClickTimestamp=ta,Fc.SessionId=tb,Fc.Correlation=X,Fc))}};Xc.zU=function(){return new Xc(new re.a(function(){return le.AFrameworkApplication.Eb}),new re.a(function(){return le.AFrameworkApplication.Hd}),
new re.a(function(){return le.AFrameworkApplication.sa}),new re.a(function(){return le.AFrameworkApplication.sa.Pa.Lj}),new re.a(function(){return le.AFrameworkApplication.oj}),function(){return(new Date).getTime()},new re.a(function(){return le.AFrameworkApplication.sa.Pa.g_}),new re.a(function(){return le.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};tl.Object.defineProperties(Xc.prototype,{I7a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},fBb:{configurable:!0,
enumerable:!0,get:function(){return this.Og.value}},Ynf:{configurable:!0,enumerable:!0,get:function(){return this.vgg.value}},Dba:{configurable:!0,enumerable:!0,get:function(){return this.V0.value}},hkc:{configurable:!0,enumerable:!0,get:function(){return this.je.value}},Sv:{configurable:!0,enumerable:!0,get:function(){return this.$Gc}},g_:{configurable:!0,enumerable:!0,get:function(){return this.ilg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.uVb.value}}});
tl.Object.defineProperties(Xc,{instance:{configurable:!0,enumerable:!0,get:function(){return Xc.Na||(Xc.Na=Xc.zU())}}});Xc.Na=null;Object(sc.a)(Xc,"NewAndOpenCommonHelpers",null,[831]);var ve=b(109);ed.prototype.QDg=function(){this.TNc=this.Gab+1};ed.prototype.BId=function(X){this.Ri&&(this.je.Bp(this.Ri),this.Ri=null);X&&(this.TNc=0)};ed.prototype.jxj=function(X){var ta=this.mCj;0<=ta?(this.QDg(),this.BId(!1),this.Ri=new ve.a(4,1,ta,X,107),this.je.gh(this.Ri)):(this.BId(!0),X={},Jc.ULS.sendTraceTag(5849676,
202,50,"Retries exhausted {0}",(X.Action=this.g2d,X)))};tl.Object.defineProperties(ed.prototype,{Gab:{configurable:!0,enumerable:!0,get:function(){return this.TNc}},mCj:{configurable:!0,enumerable:!0,get:function(){return this.Gab>=this.WTf.length?-1:this.WTf[this.Gab]}},WTf:{configurable:!0,enumerable:!0,get:function(){if(!this.EUb){var X=(this.Zqg.value||"0").split(",");this.EUb=[];for(var ta=0;ta<X.length;ta++){var tb=parseInt(X[ta]);isNaN(tb)?(tb={},Jc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
(tb.Action=this.g2d,tb.Entry=X[ta],tb))):Array.add(this.EUb,tb)}}return this.EUb}}});Object(sc.a)(ed,"RetryHelper",null,[]);var kc=b(38),ad=b(28);vm(Pb,nd);Pb.prototype.bqi=function(){this.utd("Document opened")};Pb.prototype.O2g=function(X){var ta=this;return function(){ta.utd(X,!0)}};Pb.prototype.qyf=function(X,ta){ta=void 0===ta?null:ta;var tb={};Jc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(tb.Trigger=X,tb));3===this.xo.state?(ta&&this.$He(ta,this.xo),ta={},
Jc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(ta.Trigger=X,ta))):this.utd(X);return this.xo};Pb.prototype.utd=function(X,ta){this.ekb.BId(!(void 0===ta?0:ta));1===this.xo.state?(ta={},Jc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(ta.Trigger=X,ta.RetryIndex=this.ekb.Gab,ta))):(ta={},Jc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(ta.Trigger=X,ta.RetryIndex=this.ekb.Gab,ta)),this.xo.state=1,ta=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.RAb.g_,le.AFrameworkApplication.hj),this.RAb.fBb.g9(ta,1,null,null,[Pb.Tae,Pb.Xee],!1,5,this.T1g(),this.S1g(X),null))};Pb.prototype.T1g=function(){var X=this;return function(ta){var tb=!1,Rb=!1,Fc=!1;if(le.AFrameworkApplication.ga.ra("GetMoreInfoDataFromResponseBody"))if(ta.data.fe){var lc=kc.d(ta.data.fe);var Jd=lc.uu;lc.returnValue?Jd?(Fc=!0,X.xo.GPc=Jd.StorageServiceDisplayName,X.xo.Bjb=Pb.Sef(Jd.PersonalFileStorageUrl)?Jd.PersonalFileStorageUrl:"",""===X.xo.hR&&"SharePointOnlineConsumer"===
le.AFrameworkApplication.ga.Ua("FileSource")&&(X.xo.Bjb=ye.a.Eca(le.AFrameworkApplication.breadcrumbFolderUrl)),tb=""===X.xo.hR&&""!==X.xo.sna):Jc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Jc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else Jc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");
Fc||((Jd=ta.data.responseHeaders)?(X.xo.GPc=(Jd[Pb.Xee]||"").toString(),tb=(Jd[Pb.Tae]||"").toString(),X.xo.Bjb=Pb.Sef(tb)?tb:"",""===X.xo.hR&&"SharePointOnlineConsumer"===le.AFrameworkApplication.ga.Ua("FileSource")?(X.xo.Bjb=ye.a.Eca(le.AFrameworkApplication.breadcrumbFolderUrl),tb=""===X.xo.hR&&""!==X.xo.sna):tb=""===tb&&""!==X.xo.sna):(Jc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Rb=!0));Fc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
X.ekb.Gab,Rb,tb,Fc);X.RAb.SMa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ta.data,Fc);X.mUf(3,tb,Rb)}};Pb.prototype.S1g=function(X){var ta=this;return function(tb){ta.RAb.SMa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",tb.data,"Failure");ta.mUf(2);ta.ekb.jxj(ta.O2g(X))}};Pb.prototype.mUf=function(X,ta,tb){this.xo.state=X;this.xo.L5d=void 0===ta?!1:ta;this.xo.xIc=void 0===tb?!1:tb;this.q6c(this.xo)};Pb.zU=function(){return new Pb(new re.a(function(){return Xc.instance}),
new re.a(function(){return le.AFrameworkApplication.CMh}))};Pb.Sef=function(X){if(!X)return Jc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ad.a.Kl(X).startsWith("https://"))return!0;Jc.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};tl.Object.defineProperties(Pb.prototype,{RAb:{configurable:!0,enumerable:!0,get:function(){return this.v1.value}}});tl.Object.defineProperties(Pb,{instance:{configurable:!0,enumerable:!0,
get:function(){return Pb.Na||(Pb.Na=Pb.zU())}}});Pb.Tae="PersonalFileStorageUrl";Pb.Xee="StorageServiceDisplayName";Pb.Na=null;Object(sc.a)(Pb,"GetMoreInfoActor",nd,[]);var yd=b(98),wd=b(94);Hb.prototype.Iie=function(X){this.Ya.addHandler(this.Ohe,X)};Hb.prototype.mxg=function(X){this.Ya.addHandler(this.b7e,X)};Hb.prototype.bxj=function(){var X=new ve.a(5,2,this.Nlg,Object(Sc.a)(this,this.Y1h,"inactiveLoop"),108);this.Z1h.gh(X)};Hb.prototype.Y1h=function(){var X=this.KXe(),ta=this.Sv()-X;if(ta>this.gyc&&
this.AX){var tb={};Jc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(tb.TimeSinceLastActive=ta,tb));this.AX=!1;this.Ya.raiseEvent(this.b7e)}X-this.H7d>this.gyc&&(this.AX=!0,this.Ya.raiseEvent(this.Ohe));this.H7d=X};Hb.zU=function(){return new Hb(new re.a(function(){return yd.a.instance}),function(){return le.AFrameworkApplication.Rgf.getTime()},function(){return(new Date).getTime()},new re.a(function(){return le.AFrameworkApplication.gyc}),!0)};tl.Object.defineProperties(Hb.prototype,{Z1h:{configurable:!0,
enumerable:!0,get:function(){return this.je.value}},KXe:{configurable:!0,enumerable:!0,get:function(){return this.Pkg}},Sv:{configurable:!0,enumerable:!0,get:function(){return this.$Gc}},gyc:{configurable:!0,enumerable:!0,get:function(){return this.GVb.value}}});tl.Object.defineProperties(Hb,{instance:{configurable:!0,enumerable:!0,get:function(){return Hb.Na||(Hb.Na=Hb.zU())}}});Hb.Na=null;Object(sc.a)(Hb,"InactivityManager",null,[]);var pe=b(84),bf=b(1043);vm(Bb,Xd);Bb.prototype.a_e=function(){return"MruActor Result"};
tl.Object.defineProperties(Bb.prototype,{Nud:{configurable:!0,enumerable:!0,get:function(){return this.R9d}},mnf:{configurable:!0,enumerable:!0,get:function(){return this.S9d}},Mud:{configurable:!0,enumerable:!0,get:function(){return this.Q9d}},qCj:{configurable:!0,enumerable:!0,get:function(){return this.Tfe}}});Object(sc.a)(Bb,"MruResult",Xd,[866,867]);var Af=b(233);Cb.prototype.odi=function(X,ta){return X===Af.a.S$c||20===ta||18===ta||3===ta};Cb.prototype.uei=function(X){return 3===X||5===X||6===
X||7===X||9===X||10===X||11===X||12===X||13===X||14===X||15===X||16===X||23===X||26===X||27===X||28===X};Cb.prototype.reset=function(){this.Rwb=this.retryCount=0;this.aNc=this.szb=null;this.task&&(this.taskManager.Bp(this.task),this.task=null)};Cb.prototype.P5h=function(X,ta,tb,Rb){this.aNc=String.format("{0}_{1}",tb,Rb);if(this.retryCount>=this.Cri)return Jc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.odi(tb,Rb))return Jc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.uei(Rb)&&1<=this.Rwb)return this.szb=tb,!1;ta=Math.max(ta,this.ndc*Math.pow(2,this.Rwb));if(26===Rb)ta=Math.max(ta,3E4);else if(27===Rb||28===Rb)ta=Math.max(ta,6E4);9===Rb||412===tb&&(null==this.szb||412!==this.szb)?ta=500:this.Rwb+=1;this.szb=tb;this.retryCount+=1;this.task&&this.taskManager.Bp(this.task);Jc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ta);this.task=new ve.a(2,1,ta,X,107);this.taskManager.gh(this.task);return!0};tl.Object.defineProperties(Cb.prototype,
{Poc:{configurable:!0,enumerable:!0,get:function(){return this.aNc}}});Object(sc.a)(Cb,"RetryManager",null,[]);var bg=b(93);Object(sc.a)(Lc,"WriteOptions",null,[]);var og=b(579),Zf=b(178);vm(kd,nd);kd.prototype.S1i=function(){this.DC.I7a.$b(Ce.a.renameMostRecentlyUsedFileEntry,ue.a.frame,Object(Sc.a)(this,this.M6i,"renameMruEntry"))};kd.prototype.M6i=function(){return this.SXd("Rename")};kd.prototype.kqi=function(){this.llf("File Opened")};kd.prototype.lqi=function(){this.llf("IntervalUpdate")};kd.prototype.llf=
function(X){var ta={};Jc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(ta.Trigger=X,ta));this.SXd(X)};kd.prototype.W3=function(X){(X=ad.a.W3(X))&&X.startsWith(".")&&(X=X.substring(1,X.length));return X};kd.prototype.VTe=function(){switch(this.DC.Dba){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};kd.prototype.iUh=function(X){var ta=this.Lkg();if(!ta)return null;var tb=new Lc;tb.documentUrl=
this.c3d.value?encodeURI(ta):ta;tb.mruItemId=this.JSb;tb.app=this.VTe();if(ta=this.rv())tb.folderName=ta.breadcrumbFolderName,ta=ta.tn,tb.documentName=ad.a.Vq(ta),tb.documentExt=this.W3(ta);X&&(tb.documentName?tb.documentName.length?255<=tb.documentName.length?X.set("DocumentNameLength","Long"):2084<=tb.documentName.length&&X.set("DocumentNameLength","VeryLong"):X.set("DocumentNameLength","0"):X.set("DocumentNameLength","Null"));return JSON.stringify(tb)};kd.prototype.SXd=function(X,ta){ta=void 0===
ta?!1:ta;if(4===this.DC.Dba&&!le.AFrameworkApplication.UHa)return 2;var tb=this.kq();tb&&(tb.set("Trigger",X),tb.set("IsRetry",ta?"true":"false"),tb.set("MruIdSent",this.JSb?"true":"false"),tb.set("URLEncoded",this.c3d.value?"true":"false"));bg.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",tb);X=this.iUh(tb);if(!X)return ta=!le.AFrameworkApplication.webEditingEnabled,tb&&(tb.set("WebEditingIsEnabled",le.AFrameworkApplication.webEditingEnabled?"true":"false"),tb.set("ProtectedFile",le.AFrameworkApplication.Yoc?
"true":"false")),bg.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ta,!1,Object.assign(new Zf.a,{extendedProperties:tb})),2;this.Sqa&&!ta&&this.Sqa.reset();tb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.DC.g_,this.localeName);this.hhe?this.lBc["X-FileId"]=le.AFrameworkApplication.hj:tb+=String.format("&{0}",le.AFrameworkApplication.hj);le.AFrameworkApplication.Gb&&(this.lBc["X-Office-AudienceGroup"]=Object(pe.a)(String,le.AFrameworkApplication.Gb.AudienceGroup)||"");
this.lBc["X-Timeout"]=15E3;return this.DC.fBb.Ul(tb,2,X,this.lBc,!0,5,Object(Sc.a)(this,this.TPj,"writeMruV2EntryOnServerSuccessCallback"),Object(Sc.a)(this,this.v6g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};kd.prototype.TPj=function(X){this.j3e(X.data)};kd.prototype.j3e=function(X){var ta=this.kq();this.Sqa&&(ta&&this.Sqa.Poc&&(ta.set("LastError",this.Sqa.Poc),ta.set("NumRetries",this.Sqa.retryCount.toString())),this.Sqa.reset());var tb=bf.c(X.fe);tb&&
tb.diagnostics_data&&(this.JSb=tb.diagnostics_data.mru_id);X=+X.P2-+X.AE;ta&&ta.set("RequestDuration",X.toString());bg.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Zf.a,{extendedProperties:ta}))};kd.prototype.v6g=function(X){if(X.data.httpStatus===Af.a.oqb)this.j3e(X.data);else{var ta=X.data.httpStatus===Af.a.xEb,tb=this.kq();this.u3e(this.Sqa,X,this.k6g(),tb);tb&&(tb.set("StatusCode",X.data.httpStatus.toString()),ta||this.pSc(X.data,tb));bg.Health.instance.recordKpiFailure("WriteMru",
String.format("RequestFailed_{0}",X.data.httpStatus),ta,!1,Object.assign(new Zf.a,{extendedProperties:tb}))}};kd.prototype.k6g=function(){var X=this;return function(){X.SXd("Retry",!0)}};kd.prototype.IMh=function(){this.ejc("Polling")};kd.prototype.HMh=function(){this.ejc("Retry",!0)};kd.prototype.dqi=function(){this.ejc("Open")};kd.prototype.cqi=function(){this.ejc("Activity")};kd.prototype.ejc=function(X,ta){ta=void 0===ta?!1:ta;var tb={};Jc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",
(tb.Trigger=X,tb));if(tb=this.kq())tb.set("Trigger",X),tb.set("IsRetry",ta?"true":"false");bg.Health.instance.recordKpiUsage("GetMru",0,"smartfio",tb);this.oqa&&!ta&&this.oqa.reset();this.U1g(Object(Sc.a)(this,this.JMh,"getMruV2FromServerSuccessCallback"),Object(Sc.a)(this,this.GMh,"getMruFromServerFailureCallback"))};kd.prototype.pSc=function(X,ta){X&&X.responseHeaders&&(X=X.responseHeaders["X-CorrelationId"])&&ta.set("ServerCorrelationId",X)};kd.prototype.kq=function(){try{return new Map}catch(X){return null}};
kd.prototype.$mi=function(X,ta){X&&(ta&&ta.set("RequestDuration",(+X.P2-+X.AE).toString()),bg.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Zf.a,{extendedProperties:ta})))};kd.prototype.JMh=function(X){var ta="",tb=null,Rb=null,Fc=null,lc=bf.c(X.data.fe);lc&&(tb=lc.places?lc.places.items:[],Rb=lc.documents?lc.documents.items:[],(Fc=bf.a(lc))&&(ta=kc.c(Fc)));le.AFrameworkApplication.sa&&le.AFrameworkApplication.sa.Pa.HZ&&hc.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ta,
!0));ta=this.kq();this.oqa&&(ta&&this.oqa.Poc&&(ta.set("LastError",this.oqa.Poc),ta.set("NumRetries",this.oqa.retryCount.toString())),this.oqa.reset());Fc||tb||Rb?(this.DC.SMa("MruActor.GetMruV2FromServerSuccessCallback",X.data,"Success"),this.Szc(3,Fc,tb,Rb),this.$mi(X.data,ta)):(this.DC.SMa("MruActor.GetMruV2FromServerSuccessCallback",X.data,"Failure: Invalid JSON"),ta&&this.pSc(X.data,ta),bg.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Zf.a,{extendedProperties:ta})),
this.Szc(3,null,null,null,!0));this.q6c(this.xS)};kd.prototype.u3e=function(X,ta,tb,Rb){var Fc=0,lc=0,Jd=bf.c(ta.data.fe);Jd&&(null!=Jd.response_code&&(Fc=Jd.response_code,Rb&&Rb.set("MruResponseCode",Fc.toString()),9===Fc&&(this.JSb="")),Jd.error_data&&null!=Jd.error_data.retry_after_ms&&(lc=Jd.error_data.retry_after_ms,Rb&&Rb.set("ExpectedRetryAfter",lc.toString())));X&&(ta=X.P5h(tb,lc,ta.data.httpStatus,Fc),Rb&&(Rb.set("CurrentRetryCount",X.retryCount.toString()),Rb.set("RetryScheduled",ta?"true":
"false")))};kd.prototype.GMh=function(X){var ta=X.data.httpStatus===Af.a.xEb,tb=this.kq();tb&&(tb.set("StatusCode",X.data.httpStatus.toString()),ta||this.pSc(X.data,tb));this.DC.SMa("MruActor.GetMruFromServerFailureCallback",X.data,"Failure");this.Szc(2);this.u3e(this.oqa,X,Object(Sc.a)(this,this.HMh,"getMruFromServerRetryTask"),tb);bg.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",X.data.httpStatus),ta,!1,Object.assign(new Zf.a,{extendedProperties:tb}));this.q6c(this.xS);
le.AFrameworkApplication.sa&&le.AFrameworkApplication.sa.Pa.HZ&&hc.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1))};kd.prototype.Szc=function(X,ta,tb,Rb,Fc){if(3!==this.xS.state||3===X)this.xS.R9d=void 0===ta?null:ta,this.xS.S9d=void 0===tb?null:tb,this.xS.Q9d=void 0===Rb?null:Rb,this.xS.state=X,this.xS.xIc=void 0===Fc?!1:Fc,this.xS.Tfe=this.DC.Sv()};kd.prototype.qyf=function(X,ta){var tb={};Jc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(tb.Trigger=X,tb.ResultState=
this.xS.state,tb));ta&&3===this.xS.state&&this.$He(ta,this.xS);return this.xS};kd.prototype.U1g=function(X,ta){this.Szc(1);var tb={};var Rb=String.format(this.DC.g_+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.VTe(),this.localeName);this.Upg.value||(Rb+="&entity=docs");le.AFrameworkApplication.Gb&&(tb["X-Office-AudienceGroup"]=Object(pe.a)(String,le.AFrameworkApplication.Gb.AudienceGroup)||"");this.hhe?tb["X-FileId"]=le.AFrameworkApplication.hj:Rb+=String.format("&{0}",le.AFrameworkApplication.hj);
this.DC.fBb.Ul(Rb,1,null,tb,!0,5,X,ta,null)};kd.zU=function(){return new kd(new re.a(function(){return Xc.instance}),new re.a(function(){return og.a.DJ(le.AFrameworkApplication.lcid).name}),new re.a(function(){return le.AFrameworkApplication.sa.Pa.Lu}),le.AFrameworkApplication.ga.ra("MruWriteFileIdInHeader"),function(){return le.AFrameworkApplication.sa.Pa.NB},function(){return le.AFrameworkApplication.Zl},new re.a(function(){return le.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")}))};tl.Object.defineProperties(kd.prototype,
{lBc:{configurable:!0,enumerable:!0,get:function(){return this.gug}},DC:{configurable:!0,enumerable:!0,get:function(){return this.v1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.yng.value}}});tl.Object.defineProperties(kd,{instance:{configurable:!0,enumerable:!0,get:function(){return kd.Na||(kd.Na=kd.zU())}}});kd.Na=null;Object(sc.a)(kd,"MruActor",nd,[]);gb.prototype.di=function(X){this.rb=X;X.register(831,"Common.INewAndOpenCommonHelpers").zc().Ic(function(){return Xc.instance});
X.register(832,"Common.IEventEmitter<Common.IGetMoreInfoResult>").zc().Ic(function(){return Pb.instance});X.register(832,"Common.IEventEmitter<Common.IMruResult>").zc().Ic(function(){return kd.instance})};gb.prototype.init=function(){var X=this;le.AFrameworkApplication.ga.$v(function(){X.Awb()})};gb.prototype.Awb=function(){this.rb.resolve("Common.INewAndOpenCommonHelpers");this.rb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.rb.resolve("Common.IEventEmitter<Common.IMruResult>");
var X=!1;Xc.instance.h0i();le.AFrameworkApplication.Zka&&(X=!0);le.AFrameworkApplication.FIf&&(kd.instance.dqi(),0<le.AFrameworkApplication.nnf&&this.kje(),this.fnj(),X=!0);le.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&X&&Pb.instance.bqi();le.AFrameworkApplication.kKj&&(X=kd.instance,X.S1i(),X.kqi(),yd.a.instance.gh(this.lKj))};gb.prototype.fnj=function(){Hb.instance.Iie(Object(Sc.a)(kd.instance,kd.instance.cqi,"makeGetMruRequestActivityTrigger"));Hb.instance.Iie(Object(Sc.a)(this,
this.kje,"addGetMruFromServerTask"));Hb.instance.mxg(Object(Sc.a)(this,this.x9g,"deleteGetMruFromServerTask"))};gb.prototype.x9g=function(){yd.a.instance.Bp(this.onf)};gb.prototype.kje=function(){yd.a.instance.gh(this.onf)};gb.prototype.dispose=function(){this.sm||(this.sm=!0,this.dlb&&(yd.a.instance.Bp(this.dlb),this.dlb=null))};tl.Object.defineProperties(gb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},onf:{configurable:!0,enumerable:!0,get:function(){return this.Rbe||
(this.Rbe=new ve.a(5,2,le.AFrameworkApplication.nnf,Object(Sc.a)(kd.instance,kd.instance.IMh,"getMruFromServerTask"),109))}},lKj:{configurable:!0,enumerable:!0,get:function(){return this.dlb||(this.dlb=new ve.a(2,2,6E4*le.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(Sc.a)(kd.instance,kd.instance.lqi,"makeUpdateMruTask"),197))}}});Object(sc.a)(gb,"CorePackageManager",null,[4,5,3]);var If=b(514);new ag(0,0,0,0,0,0);new ag(1,1,0,0,
0,0);new ag(2,2,0,0,0,0);new ag(3,3,0,0,0,1);new ag(4,3,1,0,1,1);new ag(5,3,0,0,.42,1);new ag(6,3,.83,0,1,1);new ag(7,3,0,0,.58,1);new ag(8,3,.42,0,.58,1);new ag(9,3,.1,.25,.75,.9);new ag(10,3,.1,.9,.2,1);new ag(11,3,.1,.9,.2,1);new ag(12,3,.9,.1,.2,1);new ag(13,3,.4,0,0,1);new ag(14,3,.13,.21,.1,.7);new ag(15,3,.02,.33,.38,.77);new ag(16,3,.57,.17,.95,.75);new ag(17,3,0,.19,.07,.72);new ag(18,3,0,0,.95,.37);new ag(19,3,.66,0,.34,1);new ag(20,3,.8,0,.2,1);uf.prototype={type:0,startTime:new Bg(0,null),
endTime:new Bg(0,null),RSj:new Bg(0,null),PRj:new Bg(0,null),operationType:0};new sf(0,[new uf(5,0,0,0,null,1,1,0)]);new sf(1,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,50,null,1,1,0)]);new sf(2,[new uf(1,3,0,167,null,0,1,1),new uf(2,3,0,167,null,0,1,1)]);new sf(3,[new uf(3,3,0,167,null,0,1,1),new uf(4,3,0,167,null,0,1,1)]);new sf(4,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,167,null,1,1,0)]);new sf(5,[new uf(5,2,0,167,null,0,1,0)]);new sf(6,[new uf(1,3,0,100,null,0,1,1),new uf(2,3,0,100,null,0,1,1)]);
new sf(7,[new uf(3,3,0,100,null,0,1,1),new uf(4,3,0,100,null,0,1,1)]);new sf(8,[new uf(5,2,0,100,null,1,1,0)]);new sf(9,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,100,null,1,1,0)]);new sf(10,[new uf(5,2,0,100,null,0,1,0)]);new sf(11,[new uf(1,3,0,267,null,0,1,1),new uf(2,3,0,267,null,0,1,1)]);new sf(12,[new uf(3,3,0,267,null,0,1,1),new uf(4,3,0,267,null,0,1,1)]);new sf(13,[new uf(5,2,0,267,null,1,1,0)]);new sf(14,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,267,null,1,1,0)]);new sf(15,[new uf(5,2,0,267,
null,0,1,0)]);new sf(16,[new uf(6,3,0,267,null,0,1,1),new uf(7,3,0,267,null,0,1,1)]);new sf(17,[new uf(1,3,0,750,null,0,1,1),new uf(2,3,0,750,null,0,1,1)]);new sf(18,[new uf(3,3,0,750,null,0,1,1),new uf(4,3,0,750,null,0,1,1)]);new sf(19,[new uf(5,2,0,750,null,1,1,0)]);new sf(20,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,750,null,1,1,0)]);new sf(21,[new uf(6,3,0,1E3,null,0,1,1),new uf(7,3,0,1E3,null,0,1,1)]);new sf(22,[new uf(1,3,0,367,null,0,1,1),new uf(2,3,0,367,null,0,1,1)]);new sf(23,[new uf(3,3,
0,367,null,0,1,1),new uf(4,3,0,367,null,0,1,1)]);new sf(24,[new uf(5,2,0,367,null,1,1,0)]);new sf(25,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,367,null,1,1,0)]);new sf(26,[new uf(5,2,0,367,null,0,1,0)]);new sf(27,[new uf(5,2,0,0,null,1,1,0),new uf(5,2,0,50,null,0,1,0)]);new sf(28,[new uf(1,3,0,433,null,0,1,1),new uf(2,3,0,433,null,0,1,1)]);new sf(29,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,50,null,1,1,0),new uf(2,3,0,0,null,40,1,1),new uf(2,3,0,100,null,0,1,1)]);new sf(30,[new uf(2,0,0,0,null,32,1,
1),new uf(2,0,0,100,null,32,1,1),new uf(2,3,101,350,null,0,1,1),new uf(3,0,0,0,null,0,2,1),new uf(3,0,0,100,null,0,2,1),new uf(3,3,101,350,null,0,1,1),new uf(5,0,0,0,null,0,2,0),new uf(5,0,0,100,null,1,1,0)]);new sf(31,[new uf(2,3,0,267,null,32,1,1),new uf(3,3,0,267,null,0,2,1),new uf(5,2,0,0,null,1,0,0),new uf(5,2,0,267,null,0,2,0)]);new sf(32,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,100,null,0,2,0),new uf(5,2,101,267,null,1,1,0)]);new sf(33,[new uf(1,10,0,300,null,0,1,1),new uf(2,10,0,300,null,
0,1,1)]);new sf(34,[new uf(3,10,0,300,null,0,1,1),new uf(4,10,0,300,null,0,1,1)]);new sf(35,[new uf(1,8,0,750,null,0,1,1),new uf(2,8,0,750,null,0,1,1)]);new sf(36,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,200,null,0,2,0),new uf(5,3,201,500,null,1,1,0)]);new sf(37,[new uf(1,2,0,0,null,0,2,1),new uf(2,2,0,0,null,0,2,1),new uf(1,2,0,200,null,0,2,1),new uf(2,2,0,200,null,0,2,1),new uf(1,3,201,267,null,0,1,1),new uf(2,3,201,267,null,0,1,1)]);new sf(38,[new uf(1,3,0,267,null,0,1,1),new uf(2,3,0,267,null,
0,1,1)]);new sf(39,[new uf(5,2,0,0,null,0,2,0),new uf(5,2,0,267,null,1,1,0)]);new sf(40,[new uf(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(X){window.setTimeout(X,16)}}();xg.prototype={Ne:null,UEg:5,Mmb:null,BUc:0,startTime:null,duration:null,W5b:null,
XVc:-1,rud:-1,Ntd:-1};xg.prototype.Start=function(){this.startTime=new Date;this.W5b={}};xg.prototype.GetRecentAnimationStats=function(){var X,ta=[],tb=0;for(X=qg.BUc;X<qg.UEg;X++)null!=qg.Mmb[X]&&(ta[tb]=qg.Mmb[X],tb++);for(X=0;X<qg.BUc;X++)null!=qg.Mmb[X]&&(ta[tb]=qg.Mmb[X],tb++);return ta};xg.prototype.GetAnimationSqmStats=function(){var X=[];return X[0]=0>qg.XVc?0:qg.XVc,X[1]=0>qg.rud?0:qg.rud,X[2]=0>qg.Ntd?0:qg.Ntd,X};var qg=new xg;var Vf=b(216),Fe=b(245),zg=b(1211),Yf=b(142),jg=b(56),Ff=b(35),
de=b(69),Tf=b(19),Ve=b(14),We=zg.a;vm(wc,We);wc.prototype.IV=function(X){this.$.Fd&65536&&We.prototype.IV.call(this,X)};wc.prototype.Q2e=function(X){if(Tf.a.equals(this.Kij,this.$.shortcutKeyManager.Wcd(X),!1)){var ta=Yf.b(this.$);if(null===ta||void 0===ta?0:ta.canReceiveFocus)de.g(X),ta.Qe(!0,!1)}};tl.Object.defineProperties(wc.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.qB},set:function(X){this.qB=X;switch(X){case 0:this.Gwa=this.cJg;break;case 2:this.Gwa=this.VNj;
break;case 3:this.Gwa=this.hUi;break;case 4:this.Gwa=this.jRg;break;case 5:this.Gwa=this.LTi;break;default:Jc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(sc.a)(wc,"EwaAccessibilityManager",zg.a,[]);var Sf=Vf.a;vm(hd,Sf);hd.prototype.create=function(){this.Fb(this.$.da.Aa(15)||new wc(this.$))};hd.ja=function(X){X.da.Ha(157,new hd(X))};Object(sc.a)(hd,"AccessibilityManagerFactory",Vf.a,[]);var vg=b(10),kh=b(137),Pg=b(645),qf=Pg.a;vm(oc,qf);oc.prototype.dispose=
function(){kh.WacAirSpace.Fkd()&&kh.WacAirSpace.myc()};oc.prototype.animate=function(X,ta,tb,Rb,Fc){ta&&kh.WacAirSpace.QK(X.element,ta);kh.WacAirSpace.animate(X,Rb,Fc);tb&&kh.WacAirSpace.l2i(X.element,tb)};Object(sc.a)(oc,"AnimationManager",Pg.a,[3]);var ih=b(102),Qa=b(185),qb=b(941),tc=b(524),fd=b(86),Rd=b(74),zd=Rd.a;vm(Jf,zd);Jf.prototype.aaj=function(){var X=new Qa.a,ta=tc.a.Fq(fd.a.instance.mc("Common.IEventEmitter<Common.IMruResult>")),tb=new re.a(function(){return ta.result});this.crd=new re.a(function(){return new qb.a(tb.value,
null)});if(!this.crd)return X;var Rb=this.crd.value.Sy("NewAndOpenCoreManager",!1);if(!Rb||3!==Rb.state||!Rb.Mud)return Rb?Jc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",Rb.state,!Rb.Mud):Jc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Rb=Rb.Mud;for(var Fc=["xlsx","xlsb","xlsm"],lc=0;lc<Rb.length;lc++){var Jd=Rb[lc];if(!(0>Array.indexOf(Fc,Jd.extension))){var he=
String.format("{0}.{1}",Jd.title,Jd.extension),Te=bf.b(Jd,le.AFrameworkApplication.isRtl);Jd=Jd.url;if(he&&Te&&Jd){var yg={};X.add((yg[Jf.fileName]=he,yg[Jf.friendlyPath]=Te,yg[Jf.section]="mru",yg[Jf.absoluteUrl]=Jd,yg))}else Jd||Jc.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return X};Jf.prototype.dispose=function(){zd.prototype.dispose.call(this)};Jf.fileName="FileName";Jf.friendlyPath="FriendlyPath";Jf.section="Section";Jf.absoluteUrl="AbsoluteUrl";
Object(sc.a)(Jf,"NewAndOpenCoreManager",Rd.a,[833,3]);var xe=Vf.a;vm(ze,xe);ze.prototype.create=function(){this.Fb(this.$.da.Aa(451)||this.$.da.Ha(451,new Jf(this.$)))};ze.ja=function(X){X.da.Ha(164,new ze(X))};Object(sc.a)(ze,"NewAndOpenCoreFactory",Vf.a,[]);var me=b(1),mf=b(30),df=b(4),rf=b(11),Mg=b(241),lf=b(20);Pd.W1a=function(X){X=ad.a.If(X||"");return new Pd(X)};Pd.Y8b=function(X){return Pd.W1a(Ve.a.instance.ea(X))};Pd.tad=function(X){return new Pd(Ve.a.instance.Va(X))};Pd.Zyh=function(X,ta){for(var tb=
[],Rb=1;Rb<arguments.length;++Rb)tb[Rb-1]=arguments[Rb];return Pd.Yyh.apply(null,[Ve.a.instance.Cb(X)].concat(tb))};Pd.Yyh=function(X,ta){for(var tb=[],Rb=1;Rb<arguments.length;++Rb)tb[Rb-1]=arguments[Rb];Rb=tb.length;for(var Fc=Array(Rb),lc=0;lc<Rb;lc++)Fc[lc]=(tb[lc]||Pd.eIe).vsc;return new Pd(String.format.apply(null,[X].concat(Fc)))};tl.Object.defineProperties(Pd,{eIe:{configurable:!0,enumerable:!0,get:function(){return Pd.$2d||(Pd.$2d=new Pd(""))}},Esd:{configurable:!0,enumerable:!0,get:function(){return Pd.Y8d||
(Pd.Y8d=Pd.tad(2).vsc)}}});Pd.$2d=null;Pd.Y8d=null;Object(sc.a)(Pd,"SafeHtml",null,[856]);ne.prototype.dispose=function(){this.$&&this.unregister();rf.DOMElementExtensions.Sf(this.Kga);rf.DOMElementExtensions.Sf(this.tea);rf.DOMElementExtensions.Sf(this.Hfa);this.Hfa=this.tea=this.Kga=this.$=null};ne.prototype.setEnabled=function(X){this.eVf(this.Hfa,X)};ne.prototype.gij=function(){this.eVf(this.tea,!0)};ne.prototype.readText=function(X){this.mFb(Pd.W1a(X),!0)};ne.prototype.ePa=function(X){this.mFb(Pd.W1a(X),
!1)};ne.prototype.GIf=function(X,ta){if(1>ta||!X)Jc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var tb=new Sys.StringBuilder;X=String.format(Ve.a.instance.Cb(33),ta,X);Bd(tb,X);Bd(tb,Ve.a.instance.ea(836));this.mFb(Pd.W1a(tb.toString()),!1)}};ne.prototype.ZYi=function(X,ta,tb){if(1>tb||1>ta||ta>tb||!X)Jc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Rb=new Sys.StringBuilder;Bd(Rb,X);Rb.append(String.format(Ve.a.instance.Cb(54),ta,tb));
this.mFb(Pd.W1a(Rb.toString()),!1)}};ne.prototype.DIf=function(X){X=this.lQh(X);this.mFb(X,!1)};ne.prototype.mFb=function(X,ta){if(X=X?X.vsc:null)ta=ta?this.Hfa:this.tea,Tf.a.equals(ta.innerHTML,X,!1)&&(X+=Pd.Esd),ta.innerHTML=X};ne.prototype.r$a=function(X,ta){this.Kga.getAttribute(df.a.Cga)!==ta&&this.Kga.setAttribute(df.a.Cga,ta);X=X?Pd.W1a(X).vsc:"";this.Kga.innerHTML=X};ne.prototype.$Yi=function(X,ta,tb,Rb,Fc){Fc=void 0===Fc?!1:Fc;var lc=Ve.a.instance.Cb(53);Jc.ULS.shipAssertTag(537153949,0,
!(void 0===X||null===X));Jc.ULS.shipAssertTag(537153948,0,!(void 0===ta||null===ta));Jc.ULS.shipAssertTag(537153947,0,!(void 0===tb||null===tb));Jc.ULS.shipAssertTag(537153946,0,!(void 0===Rb||null===Rb));Jc.ULS.shipAssertTag(537153945,0,!(void 0===lc||null===lc));X=String.format(lc,X||"",ta||"",tb||"",Rb||"");Fc?this.r$a(X,df.a.FFa):this.readText(X)};ne.prototype.fIj=function(X){var ta=this.Hfa.style;X?(X=Mg.a.q_b(X.cell,ta),ta=X.gI,ta.top=ta.left=ta.bottom=ta.right=null,X.u9()):ta.cssText=""};ne.prototype.lQh=
function(X){switch(X){case -1985798686:return Pd.Y8b(12);case -911352779:return Pd.Y8b(11);case 237279923:return Pd.Y8b(13);case -1502853784:return Pd.tad(81);case -111689794:return Pd.tad(78);case -287251124:return this.Aed(1287,function(ta){return ta.bold});case -1925065947:return this.Aed(1288,function(ta){return ta.italic});case 1764140053:return this.Aed(1289,function(ta){return ta.underline})}return null};ne.prototype.register=function(){Jc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");
this.$&&(Jc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.gmb(this.$rf))};ne.prototype.unregister=function(){this.$&&this.$.Ka.T$a(this.$rf)};ne.prototype.eVf=function(X,ta){var tb=X===this.tea;ta?(X.setAttribute(df.a.Cga,df.a.FFa),tb&&X.setAttribute(df.a.Sd,df.a.Bga),X.setAttribute(df.a.dP,df.a.pp),X.removeAttribute(df.a.dP),X.innerHTML+=" "):(X.removeAttribute(df.a.Cga),tb&&X.removeAttribute(df.a.Sd),X.setAttribute(df.a.dP,df.a.rj))};
ne.prototype.Aed=function(X,ta){var tb=this.activeCell;if(!tb)return null;ta=ta(tb)?7:8;return Pd.Zyh(ta,Pd.Y8b(X))};tl.Object.defineProperties(ne.prototype,{Zwa:{configurable:!0,enumerable:!0,get:function(){return this.Gng}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return lf.g(this.$).sc(null)}}});Object(sc.a)(ne,"AriaLiveNotifier",null,[836,809,3]);var $f=Vf.a;vm(ee,$f);ee.prototype.create=function(){this.Fb(this.$.da.Aa(211)||
new ne(this.$,this.$.Ey,this.$.Ue))};ee.ja=function(X){X.da.Ha(212,new ee(X))};Object(sc.a)(ee,"AriaLiveNotifierFactory",Vf.a,[]);var dg=b(23),yf=b(209);Wd.prototype.readText=function(X){this.fW.setAttribute(df.a.Bv,X);this.r6.setAttribute(df.a.Bv,X);this.Gzj()};Wd.prototype.dispose=function(){this.F_&&this.F_.parentNode&&this.F_.parentNode.removeChild(this.F_);this.r6=this.fW=this.F_=this.Cia=null};Wd.prototype.y4g=function(X){var ta=X.Ib+"readoutElementWrapper",tb=X.Ib+"readoutElement1",Rb=X.Ib+
"readoutElement2";this.F_=document.getElementById(ta);this.F_||(this.F_=document.createElement(yf.a.div),this.F_.id=ta,this.fW=document.createElement(yf.a.label),this.fW.id=tb,this.r6=document.createElement(yf.a.label),this.r6.id=Rb,this.fW.style.width="0px",this.fW.style.height="0px",this.r6.style.width="0px",this.r6.style.height="0px",this.fW.tabIndex=-1,this.r6.tabIndex=-1,this.F_.appendChild(this.fW),this.F_.appendChild(this.r6),X=X.Ib+df.a.K0c,ta=document.getElementById(X),Jc.ULS.shipAssertTag(537153942,
3,!!ta,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",X),ta&&ta.appendChild(this.F_))};Wd.prototype.hTi=function(){this.Cia&&this.fW&&this.r6&&(this.Cia.setAttribute(df.a.o2,this.fW.id),this.Cia.setAttribute(df.a.jVc,String.format("{0} {1}",this.fW.id,this.r6.id)))};Wd.prototype.Gzj=function(){if(this.isActive){var X="";rf.DOMElementExtensions.hasAttribute(this.Cia,df.a.o2)&&(X=this.Cia.getAttribute(df.a.o2).toString());this.Cia.setAttribute(df.a.o2,
X===this.fW.id?this.r6.id:this.fW.id)}else Jc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};Wd.b5a=function(){if(null==Wd.Osb)if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1))Wd.Osb=!0,Jc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Wd.Osb=!1,dg.a.iH||dg.a.zf)Wd.Osb=!0,Jc.ULS.sendTraceTag(537153939,0,50,
"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Wd.Osb};Wd.ja=function(X){Wd.b5a()&&X.da.Ha(244,new Wd(X,lf.g(X).rc.textBox.pf))};tl.Object.defineProperties(Wd.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.Cia&&document.activeElement===this.Cia}}});Wd.Osb=null;Object(sc.a)(Wd,"FocusBasedReadout",null,[809,3]);var Hg=Vf.a;vm(Qd,Hg);Qd.prototype.create=function(){var X=this;Wd.b5a()?lf.g(this.$).rc.textBox.yT(function(){var ta=
X.$.da.Aa(244)||new Wd(X.$,lf.g(X.$).rc.textBox.pf);X.Fb(ta)}):this.Fb(null)};Qd.ja=function(X){X.da.Ha(315,new Qd(X))};Object(sc.a)(Qd,"FocusBasedReadoutFactory",Vf.a,[]);var Df=b(88),xc=b(24),dd=b(43),Cd=b(238),Ld=b(44),Od=b(42),ef=b(115);Ie.sed=function(X){return Ie.FZe(X.toString())};Ie.FZe=function(X){return Ie.BSg.test(X)?X.replace(Ie.PXi,"$1 ").replace(Ie.OXi,' "$1"').trim():X};Ie.z7i=function(X){var ta=X.lastIndexOf("!");return X.substring(0,-1<ta?ta+1:0)+Ie.FZe(X.substring(-1<ta?ta+1:0,X.length))};
tl.Object.defineProperties(Ie,{PXi:{configurable:!0,enumerable:!0,get:function(){return Ie.Jbe||(Ie.Jbe=RegExp("([A-Z]+)","g"))}},OXi:{configurable:!0,enumerable:!0,get:function(){return Ie.Ibe||(Ie.Ibe=RegExp("([A-Z])","g"))}},BSg:{configurable:!0,enumerable:!0,get:function(){return Ie.r0d||(Ie.r0d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});Ie.Jbe=null;Ie.Ibe=null;Ie.r0d=null;Object(sc.a)(Ie,"RangeAriaExtensions",
null,[]);Object(sc.a)(qd,"SelectionReadoutState",null,[]);var Xf=b(59),Qf=b(78);Yd.prototype.dispose=function(){this.$&&this.mm();Df.a.Fa(this.sZb);this.sparklineManager=this.$=this.sZb=null};Yd.prototype.AUe=function(X,ta,tb){tb=void 0===tb?!0:tb;if(!X)return"";var Rb=this.$.da,Fc=new Sys.StringBuilder;this.GFg(Fc,X,ta);if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var lc=this.tableManager.NJa(X.range);(null===lc||void 0===lc?0:lc.XOd)&&this.Pne(Fc,lc);lc=this.tableManager.eo(X.range);
(null===lc||void 0===lc?0:lc.mva)&&this.Pne(Fc,lc)}lc=X.vaa?this.oXe(X):X.text;Bd(Fc,lc);lc=this.$.activeItemName;this.MC.activeItemName!==lc&&(Bd(Fc,lc),this.MC.activeItemName=lc);lc=1===ta.length?dd.K(ta).isSingle?"":Ve.a.instance.ea(832):String.format(Ve.a.instance.Cb(30),ta.length);Bd(Fc,lc);lc=yl(ta);for(var Jd=lc.next();!Jd.done;Jd=lc.next())Jd=Jd.value,Bd(Fc,Ie.sed(Jd)),1===ta.length&&Yd.Bgi(Jd)&&(Jd=lf.g(this.$).Ca.Mr(Jd.bottomRight),void 0!==Jd&&null!==Jd&&Jd.text&&(Jd=Jd.vaa?this.nXe(Jd,
Jd.text):Jd.text,Bd(Fc,Jd)));lc=X.cell;lc=this.RNh(lc.dbj,lc.AVg);Bd(Fc,lc);this.rFg(Fc,X);tb&&(X.C5a?Bd(Fc,Ve.a.instance.ea(820)):X.PLa&&Bd(Fc,Ve.a.instance.ea(821)));if(X.hasAutoFilter||X.n4)this.HFg(Fc,X.hasAutoFilter?X.cell.HZb:X.cell.OQi),tb&&Bd(Fc,Ve.a.instance.ea(823));Cd.c(this.$,X.range)&&Bd(Fc,Ve.a.instance.ea(827));this.oFg(Fc,X);tb=(tb=Rb.Aa(14))?tb.ZCh():"";Bd(Fc,tb);X.MJ&&(tb=lf.g(this.$).Ca.Mr(X.range),tb=!!tb&&tb.r4e,Yd.ioj(X)?Yd.pFg(Fc,X):me.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
tb?Bd(Fc,Ve.a.instance.ea(825)):Bd(Fc,Ve.a.instance.ea(824)));X.uaa&&(Bd(Fc,Ve.a.instance.ea(826)),X.svb&&Bd(Fc,String.format(Ve.a.instance.Cb(16),X.I7g)),Bd(Fc,X.iconName));X.hasRichValueIcon&&(lc=this.$.da.Aa(271),tb="",lc&&X.cell.vhf&&(lc=lc.VP(X.cell.vhf))&&lc.DomainId.Id!==Yd.mPj&&(tb=lc.Name),X.cell.L8h?(Bd(Fc,String.format(Ve.a.instance.Cb(177),tb)),Bd(Fc,Ve.a.instance.ea(1755))):(Bd(Fc,String.format(Ve.a.instance.Cb(175),tb)),Bd(Fc,Ve.a.instance.ea(1754))));this.EZh(X)&&Bd(Fc,Yd.EJh(X));(Rb=
Rb.Aa(231))&&Bd(Fc,Rb.AXe(ta,!0));1===ta.length&&ta[0].isSingle&&Yd.hoj(X,ta[0],this.$)&&(ta=this.$.da.Aa(271))&&Bd(Fc,ta.jDh());X.ELb&&X.FLb&&Bd(Fc,X.FLb);(ta=X.cell.pRg)&&Bd(Fc,ta);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&X.lwa&&X.hEb&&(X=X.dBd)&&(Bd(Fc,Ve.a.instance.ea(1918)),Bd(Fc,X));return Fc.toString()};Yd.prototype.Rse=function(X){this.Mra=this.MC;this.MC=Object.assign(new qd,{activeItemName:this.Mra.activeItemName,Axc:X?this.Mra.Axc:!1,tableName:X?this.Mra.tableName:
"",VZa:X?this.Mra.VZa:-1})};Yd.prototype.SPf=function(){this.Mra&&(this.MC=this.Mra,this.Mra=null)};Yd.prototype.RNh=function(X,ta){return 2===X||2===ta?Ve.a.instance.ea(853):1===X||1===ta?Ve.a.instance.ea(854):""};Yd.prototype.oXe=function(X){return this.nXe(X.cell,X.text)};Yd.prototype.GFg=function(X,ta,tb){if(tb&&1===tb.length&&tb[0].isSingle){tb="";var Rb=this.tableManager.NJa(ta.range);Rb?(tb=Rb.pivotTableName,this.IUc(X,tb),this.Rne(X,!0,tb,Rb.Jec?Ve.a.instance.ea(815):""),Bd(X,this.tableManager.Bei(Rb,
ta.range)?Ve.a.instance.ea(817):""),Bd(X,this.tableManager.V9h(Rb,ta.range)?Ve.a.instance.ea(816):"")):(Rb=this.tableManager.eo(ta.range))?(tb=(tb=lf.g(this.$).Vb.vk(ta.range))?tb.name:"",this.IUc(X,tb),this.Rne(X,!1,tb,""),Bd(X,this.tableManager.Maf(Rb,ta.range)?Ve.a.instance.ea(816):"")):(this.IUc(X,tb),this.MC.tableName="",this.MC.VZa=-1)}};Yd.prototype.IUc=function(X,ta){ta!==this.MC.tableName&&this.MC.tableName&&(X.append(Ve.a.instance.ea(this.MC.Axc?814:813)),Bd(X," "+this.MC.tableName))};Yd.prototype.Rne=
function(X,ta,tb,Rb){tb!==this.MC.tableName&&(X.append(Ve.a.instance.ea(ta?812:811)),Bd(X," "+tb),Bd(X,Rb),this.MC.tableName=tb,this.MC.Axc=ta,this.MC.VZa=-1)};Yd.prototype.Pne=function(X,ta){var tb=lf.g(this.$).ha.va.activeCell;if(tb.top!==ta.top&&tb.left!==this.MC.VZa){X.append(Ve.a.instance.ea(816));ta=new xc.Range(ta.top,tb.left,ta.top,tb.left,!0,!0);Bd(X,Ie.sed(ta));if(ta=lf.g(this.$).sc(ta))ta=ta.vaa?this.oXe(ta):ta.text,Bd(X,ta);this.MC.VZa=tb.left}};Yd.prototype.nXe=function(X,ta){var tb=
X.e4a;return X.uvb?String.format(Ve.a.instance.Cb(14),ta,tb):String.format(Ve.a.instance.Cb(13),ta,Ie.z7i(tb))};Yd.prototype.ak=function(){Jc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var X=lf.g(this.$);Jc.ULS.shipAssertTag(537153929,0,!!X,"Can't register to grid's events");X&&(X.Kc.wm(this.GH),X.Ca.np(this.tca),X.DD(this.tca),this.m$a&&X.Kc.hq(this.Rh.bind(this)),X=X.ha,Jc.ULS.shipAssertTag(537153928,0,!!X,"Can't register to selectionManager's events"),
X&&(X.jG(this.kd),X.fG(this.tca),X.Qa.g2(this.tca),this.m$a&&(this.rEd=this.rEd.bind(this))))}};Yd.prototype.mm=function(){if(this.$){var X=lf.g(this.$);X&&(X.Kc.im(this.GH),X.Ca.yq(this.tca),X.lF(this.tca),this.m$a&&X.Kc.Rp(this.Rh),X=X.ha)&&(X.mF(this.tca),X.vN(this.tca),X.Qa.cma(this.tca))}};Yd.prototype.readText=function(X,ta){this.b5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(X):(me.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(X),this.m$a&&!ta||this.ariaLiveNotifier.fIj(ta))};Yd.prototype.Rh=function(){this.lnb&&this.lnb.cancel()};Yd.prototype.rEd=function(){this.readText(this.VQh())};Yd.prototype.VQh=function(){var X=this,ta="";lf.g(this.$).ha.rangePicker.uK.forEach(function(tb){ta+=X.KRh(tb)});return ta+=" selected"};Yd.prototype.KRh=function(X){return" "+(X.sheetId!==Xf.d(this.$.oa)?this.$.xa.Ted(X.sheetId).name:"")+" "+X.range.topLeft+" "+(X.range.isSingle?
"":X.range.bottomRight)};Yd.prototype.ZBh=function(){var X=null;var ta=lf.g(this.$).ha;if(1!==ta.Te&&!ta.Qa.nc)return Jc.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",ta.Te),{returnValue:"",activeCell:X};switch(ta.Te){case 2:return{returnValue:this.OEh(ta),activeCell:X};case 64:var tb=ta.Qa.nc.floatingObject,Rb="";if(ta=ta.Qa.nc.cs||ta.Qa.nc.Pd)Rb=(Rb=ta.firstChild)?rf.DOMElementExtensions.getTextContent(Rb):
"";return{returnValue:String.format(Ve.a.instance.Cb(52),Yd.m9b(tb.altText,tb.altTextDescription,tb.name),Rb,tb.altTextDescription),activeCell:X};case 4:return{returnValue:Yd.yEg(ta.Qa.nc.floatingObject),activeCell:X};case 512:return{returnValue:ef.a.$Ve(ta.Qa.nc.floatingObject.Y5c),activeCell:X};case 8:return tb=(tb=ta.Qa.nc.floatingObject)?tb.name:"",{returnValue:String.format(Ve.a.instance.Cb(50),tb),activeCell:X};case 1:return X=this.activeCell,{returnValue:this.AUe(X,ta.va.selectedRanges),activeCell:X}}return{returnValue:"",
activeCell:X}};Yd.prototype.OEh=function(X){var ta=new Sys.StringBuilder;ta.append(Yd.URg(X));var tb=this.$.da.Aa(231);tb&&Bd(ta,tb.AXe(X.Qa.nc.floatingObject,!1));return ta.toString()};Yd.prototype.EZh=function(X){X=X.Y9e();var ta=!1;this.MC.Cdf!==X&&(this.MC.Cdf=X,ta=!0);return ta};Yd.prototype.rFg=function(X,ta){if(ta.Dvb)if(ta=this.sparklineManager.SRh(ta)){var tb=Ve.a.instance,Rb=tb.ea;a:switch(ta.type){case 0:var Fc=808;break a;case 1:Fc=809;break a;default:Fc=810}tb=Rb.call(tb,Fc);Bd(X,String.format(Ve.a.instance.Cb(25),
tb));ta=String.format(Ve.a.instance.Cb(24),Ie.sed(ta.fwj));Bd(X,ta)}else Jc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Bd(X,String.format(Ve.a.instance.Cb(25),""))};Yd.prototype.HFg=function(X,ta){switch(ta){case 1:case 11:Bd(X,Ve.a.instance.ea(828));break;case 6:Bd(X,Ve.a.instance.ea(828));Bd(X,Ve.a.instance.ea(830));break;case 7:Bd(X,Ve.a.instance.ea(828));Bd(X,Ve.a.instance.ea(831));break;case 2:Bd(X,Ve.a.instance.ea(829));Bd(X,Ve.a.instance.ea(830));
break;case 3:Bd(X,Ve.a.instance.ea(829));Bd(X,Ve.a.instance.ea(831));break;default:Bd(X,Ve.a.instance.ea(829))}};Yd.prototype.oFg=function(X,ta){var tb,Rb=this.$.da.Aa(65);ta=Rb?Rb.vJa(ta.range):null;var Fc="",lc=Object(pe.a)(385,ta);if(ta)Fc=!ta.n5a&&lc&&lc.dgi?String.format(Ve.a.instance.Cb(29),lc.vAj):String.format(Ve.a.instance.Cb(23),ta.author);else if(null===(tb=null===Rb||void 0===Rb?void 0:Rb.Bn)||void 0===tb?0:tb.uE)Fc=String.format(Ve.a.instance.Cb(28),Rb.Bn.XM.author);Bd(X,Fc)};Yd.yEg=
function(X){return String.format(Ve.a.instance.Cb(51),Yd.m9b(X.altText,X.altTextDescription,X.name),X.altTextDescription)};Yd.EJh=function(X){return Ve.a.instance.ea(X.Y9e()?818:819)};Yd.m9b=function(X,ta,tb){return X||ta?X:tb};Yd.URg=function(X){var ta=X.Qa.nc;X=ta.floatingObject;var tb=X.Yc,Rb=tb.ChartTitle,Fc=X.altText,lc=X.altTextDescription,Jd=!!(tb.Attributes&4);return(ta=ta.getSelectionDescription())?ta:tb.DataRangeForDisplay?String.format(Ve.a.instance.Cb(Jd?48:46),Yd.m9b(Fc,lc,X.name),lc,
Rb,Ve.a.instance.ea(cc(tb.ChartCategory)),tb.DataRangeForDisplay):String.format(Ve.a.instance.Cb(Jd?49:47),Yd.m9b(Fc,lc,X.name),lc,Rb,Ve.a.instance.ea(cc(tb.ChartCategory)))};Yd.ioj=function(X){return me.EwaSettings.la(102)&&(X.V4a||X.Gec)};Yd.pFg=function(X,ta){if(!ta.HRa)Jc.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ta.V4a)ta=ta.HRa.topLeft.toString(),Bd(X,String.format(Ve.a.instance.Cb(26),
ta));else if(ta.Gec){var tb=ta.HRa.PW();ta=(tb.LastColumn-tb.FirstColumn+1).toString();tb=(tb.LastRow-tb.FirstRow+1).toString();Bd(X,String.format(Ve.a.instance.Cb(27),ta,tb))}};Yd.hoj=function(X,ta,tb){return X.MJ||!me.EwaSettings.la(138)?!1:(X=tb.da.Aa(271))?X.gec(ta):!1};Yd.Bgi=function(X){return X.top===X.bottom&&X.left+1===X.right||X.top+1===X.bottom&&X.left===X.right};tl.Object.defineProperties(Yd.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return lf.g(this.$).sc(null)}}});
Yd.mPj=268435712;Yd.HRc=500;Object(sc.a)(Yd,"SelectionReadoutHandler",null,[834,3]);var gg=b(55),Ba=Vf.a;vm(Kd,Ba);Kd.prototype.create=function(){var X=this,ta=this.$.da,tb=jg.GetServiceTaskFactory.Xa(ta,211,212,this.tb),Rb=jg.GetServiceTaskFactory.Xa(ta,66,134,this.tb),Fc=jg.GetServiceTaskFactory.Xa(ta,240,239,this.tb),lc=gg.Task.Ta(null);me.EwaSettings.gH()&&(lc=jg.GetServiceTaskFactory.Xa(ta,244,315,this.tb));Ff.TaskExtensions.Ba(Ff.TaskExtensions.ve([tb,Rb,Fc,lc],this.ma),function(){var Jd=ta.Aa(226)||
new Yd(tb.result,X.$,Rb.result,Fc.result,lc.result);X.Fb(Jd)},this.$.ma,3)};Kd.ja=function(X){X.da.Ha(227,new Kd(X))};Object(sc.a)(Kd,"SelectionReadoutHandlerFactory",Vf.a,[]);bd.prototype.KIf=function(){var X=this.aDh();this.ariaLiveNotifier.r$a(X,df.a.bnb)};bd.prototype.aDh=function(){var X=new Sys.StringBuilder;this.$.workbookContext&&Bd(X,this.$.workbookContext.WorkbookFileName);Bd(X,Ve.a.instance.ea(834));Bd(X,this.cDh());Bd(X,this.bDh());Bd(X,Ve.a.instance.ea(835));return X.toString()};bd.prototype.cDh=
function(){return this.$.isEditMode?Ve.a.instance.ea(839):Ve.a.instance.ea(840)};bd.prototype.bDh=function(){var X=this.xOj(),ta=this.$.xa.oa;X=1!==X?String.format(Ve.a.instance.Cb(31),X):Ve.a.instance.ea(833);X=new Sys.StringBuilder(X);ta&&ta.sheetName&&(X.append(Pd.Esd),X.append(String.format(Ve.a.instance.Cb(32),ta.sheetName)));return X.toString()};bd.prototype.xOj=function(){for(var X=0,ta=yl(this.$.xa.items),tb=ta.next();!tb.done;tb=ta.next())tb.value.visible&&X++;return X};Object(sc.a)(bd,"WorkbookReadout",
null,[]);Ac.prototype.dispose=function(){this.B8b&&this.B8b.Y4i(this.Cvf);this.B8b=this.ariaLiveNotifier=this.$=null};Object(sc.a)(Ac,"EmbeddedWorkbookReadoutHandler",null,[3]);dc.prototype.dispose=function(){this.mm();this.ariaLiveNotifier=this.FY=null;this.Ld=!0};dc.prototype.ak=function(){if(this.FY){this.FY.Nq(this.KV);this.FY.Ca.np(this.KV);this.FY.DD(this.KV);var X=Object(pe.a)(182,this.FY);X&&(X.Kc.wm(this.KV),X.ha.jG(this.KV),X.ha.fG(this.KV),X.ha.Qa.g2(this.KV))}else Jc.ULS.sendTraceTag(537153923,
0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};dc.prototype.mm=function(){if(this.FY){this.FY.Ca.yq(this.KV);this.FY.lF(this.KV);var X=Object(pe.a)(182,this.FY);X&&(X.Kc.im(this.KV),X.ha.mF(this.KV),X.ha.vN(this.KV),X.ha.Qa.cma(this.KV))}};dc.prototype.qne=function(){this.MXd.KIf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.gij();this.dispose()};Object(sc.a)(dc,"WorkbookReadoutHandler",null,[3]);var Ob=Vf.a;vm(mb,Ob);mb.prototype.create=function(){var X=
this,ta=jg.GetServiceTaskFactory.Xa(this.$.da,211,212,this.tb);if(this.$.lV){var tb=jg.GetServiceTaskFactory.Xa(this.$.da,12,477,this.tb);Ff.TaskExtensions.Ba(Ff.TaskExtensions.ve([ta,tb],this.$.ma),function(){var Rb=new Ac(ta.result,X.$,tb.result);X.Fb(Rb)},this.$.ma,3)}else Ff.TaskExtensions.Ba(ta,function(Rb){Rb=new dc(Rb.result,X.$);X.Fb(Rb)},this.$.ma,3)};mb.ja=function(X){X.da.Ha(229,new mb(X))};Object(sc.a)(mb,"WorkbookReadoutHandlerFactory",Vf.a,[]);var Ec=b(36),od=b(239),Md=b(356),He=b(177),
Qe=b(654),Bf=Ec.a;vm(Aa,Bf);Aa.prototype.dispose=function(){this.view&&(this.view.Ca.Zo(this.Pe),this.view.Ca.LH(this.Hm),this.view.Ca.R$a(this.Pe),this.view.Ca.aGb(this.Pe),this.view.$.xa.kF(this.ko),this.view.$.xb.kF(this.ko));this.BS=this.Oge=null;Bf.prototype.dispose.call(this)};Aa.prototype.sXb=function(X){X=this.TDd(X);var ta=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.IG:this.view.Ph;if(X&&0<X.length&&ta)for(var tb=0,Rb=
X.length;tb<Rb;tb++)ta.contains(this.BS[tb])||Array.add(this.BS,He.a.fQ(X[tb]))};Aa.prototype.MFb=function(){var X=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.IG:this.view.Ph;if(this.BS.length&&X)for(var ta=this.BS.length-1;0<=ta;ta--)X.contains(this.BS[ta])||Array.removeAt(this.BS,ta)};Aa.prototype.IZe=function(X){return this.cZe(X)};Aa.prototype.cZe=function(X){X=dd.I(X,this.BS,!0);return 0<X.length?X[0]:null};tl.Object.defineProperties(Aa.prototype,
{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.BS}},view:{configurable:!0,enumerable:!0,get:function(){return this.Oge}}});Aa.UDd="lrc";Object(sc.a)(Aa,"LoadedRangeCollection",Ec.a,[]);vm(uc,Aa);uc.prototype.SRh=function(X){for(var ta=yl(this.rangeList),tb=ta.next();!tb.done;tb=ta.next())if(tb=tb.value,X.range.contains(tb))return tb;return null};uc.prototype.TDd=function(X){return X.GridBlockModel&&(X=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(X.GridBlockModel))?
X.getSparklineRanges():null};Object(sc.a)(uc,"SparklineManager",Aa,[835]);var Uf=Vf.a;vm(Hc,Uf);Hc.prototype.create=function(){this.Fb(this.sparklineManager||(this.sparklineManager=new uc(lf.g(this.$),this.$.da)))};Hc.ja=function(X){X.da.Ha(239,new Hc(X))};Object(sc.a)(Hc,"SparklineManagerFactory",Vf.a,[]);var Ea=b(51),ob=b(281);Jb.yLe="ewa-svg-icon";Object(sc.a)(Jb,"CssClassNames",null,[]);var ac=b(305),vc=b(335);$b.prototype.dispose=function(){this.TRd=null;this.$.fa.hr(this.Rg)};$b.prototype.Uua=
function(X,ta,tb,Rb,Fc){Rb=void 0===Rb?null:Rb;Fc=void 0===Fc?null:Fc;var lc;(lc=this.TRd[X])||(this.TRd[X]=lc=this.HPi(this.R3f[X]));if(!lc)return Jc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",X),null;var Jd=lc.cloneNode(!0);if(!Jd.style){var he=ac.b(lc),Te=ac.b(Jd),yg={};yg.iconId=X;yg.isOriginalNodeStyleNull=void 0===lc.style||null===lc.style;yg.isOriginalNodeCurrentStyleNull=void 0===lc.currentStyle||null===lc.currentStyle;yg.isClonedNodeCurrentStyleNull=
void 0===Jd.currentStyle||null===Jd.currentStyle;yg.originalNode=he.substring(0,he.indexOf(">")+1);yg.clonedNode=Te.substring(0,Te.indexOf(">")+1);Jc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(yg))}X=String.format("height: {0}px; width: {0}px;",ta,tb);Jd.setAttribute("style",X);Fc&&(X=document.createElement("title"),X.innerHTML=Fc,Jd.insertBefore(X,Jd.childNodes[0]));if(Rb)for(Rb=yl(Rb),Fc=Rb.next();!Fc.done;Fc=Rb.next())Sys.UI.DomElement.addCssClass(Jd,
Fc.value);return Jd};$b.prototype.Haa=function(X,ta,tb,Rb,Fc,lc,Jd,he){Fc=void 0===Fc?0:Fc;lc=void 0===lc?0:lc;Jd=void 0===Jd?null:Jd;he=void 0===he?null:he;Fc&&lc||(lc=rf.DOMElementExtensions.getBoundingClientRect(Rb),Fc=lc.height,lc=lc.width);if(Jd=this.Uua(X,ta,tb,Jd,he))Rb.appendChild(Jd),(Rb=rf.DOMElementExtensions.dZ(Jd,"style",null))?Jd.setAttribute("style",Rb+String.format(" margin: {0}px {1}px;",(Fc-ta)/2,(lc-tb)/2)):Jc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
X);return Jd};$b.prototype.Ghf=function(){var X=this;Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(this.$.da,283,284,0),function(ta){ta=vc.c(ta.result.wo.loadScript("excel-uiSlice20-sprite"));Ff.TaskExtensions.Ba(ta,function(){var tb=X.qXe("excelUiSlice20Sprite");tb?X.Yje(tb):Jc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},X.$.ma,3)},this.$.da.ma,3)};$b.prototype.Yje=function(X){X=yl(X);for(var ta=X.next();!ta.done;ta=X.next())ta=ta.value,ta.type===
yf.a.P3f&&(this.R3f[ta.id]=ta)};$b.prototype.HPi=function(X){if(!X)return null;var ta=X.viewBox;X=X.children;var tb=document.createElementNS(ob.a.VRd,yf.a.P3f);Sys.UI.DomElement.addCssClass(tb,Jb.yLe);tb.setAttribute("focusable","false");tb.setAttribute("viewBox",ta);this.qyg(tb,X);return tb};$b.prototype.qyg=function(X,ta){ta=yl(ta);for(var tb=ta.next();!tb.done;tb=ta.next()){tb=tb.value;var Rb=document.createElementNS(ob.a.VRd,tb.type),Fc;for(Fc in tb){var lc=Fc,Jd=tb[Fc];"className"===lc?Rb.setAttribute("class",
Jd):Rb.setAttribute(lc,Jd)}X.appendChild(Rb)}};$b.prototype.qXe=function(X){return(X=window[X])?X.icons:null};Object(sc.a)($b,"SvgIconProvider",null,[829,3]);var nb=Vf.a;vm(db,nb);db.prototype.create=function(){var X=this;Ff.TaskExtensions.Ba(Ea.a.TZ([106],4,this.tb,void 0,void 0,void 0,387),function(){var ta=me.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[ta]?X.Fb(X.$.da.Aa(388)||new $b(X.$)):Jc.ULS.sendTraceTag(537151258,
0,50,"window.[{0}] returned null.",ta)},this.ma,3)};db.ja=function(X){X.da.Ha(387,new db(X))};Object(sc.a)(db,"SvgIconProviderFactory",Vf.a,[]);var fc=b(408),$d=b(527),Id=b(236),Me=b(153),se=b(121),td=b(8),af=b(336),Fd=b(169),wf=b(12),vf=b(158),pg=b(83),sg=b(234),Ze=b(105),Lg=b(39),hg=b(34),ud=pg.a;vm(Ca,ud);Ca.prototype.dispose=function(){this.qab();this.tableManager.N3i(this.nrf);this.ief||dg.a.Pr||dg.a.fwa||Fd.a.instance.za(wf.a.pointerDown,this.taa,this.onPointerDown);if(this.yA){sg.b(this.$,
!1);try{this.Xs()}catch(X){Jc.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",X)}}this.parentElement&&this.parentElement.contains(this.taa)&&this.parentElement.removeChild(this.taa);this.taa=this.parentElement=null;ud.prototype.dispose.call(this)};Ca.prototype.R0e=function(X){var ta=X.bottom-this.Hn.topLeft.bottom-1;return 0<=X.right-this.Hn.topLeft.right+1&&0<=ta&&X.bottom>=this.Hn.top&&X.right>=this.Hn.left?new xc.Range(this.Hn.top,
this.Hn.left,X.bottom,X.right,!1,!1):this.Js};Ca.prototype.Phd=function(X){this.luc([this.Js],6,void 0===X?!0:X);this.Nb.Yr(this.i4f)};Ca.prototype.SFb=function(X){X=void 0===X?!0:X;this.Nb.kl(this.i4f);this.luc([null],6,X)};Ca.prototype.XFd=function(X){X=void 0===X?!0:X;this.Nb.kl(this.b4f);this.luc([null],26,X)};Ca.prototype.n0h=function(){var X=!1;X=void 0===X?!0:X;var ta=this.hAj();0<ta.length&&(this.luc(ta,26,X),this.Nb.Yr(this.b4f))};Ca.prototype.hAj=function(){var X=[];this.Hn.contains(this.Js)&&
(this.Hn.right!==this.Js.right&&X.push(new xc.Range(this.Hn.top,this.Js.right+1,this.Js.bottom,this.Hn.right,!1,!1)),this.Hn.bottom!==this.Js.bottom&&X.push(new xc.Range(this.Js.bottom+1,this.Hn.left,this.Hn.bottom,this.Hn.right,!1,!1)));return X};Ca.prototype.resizeTable=function(){if(!this.Js.equals(this.Hn)){var X=new xc.Range(this.Hn.top,this.Hn.left,this.Js.bottom,this.Js.right,!1,!1);this.HEj(X);this.sod=!0}};Ca.prototype.onKeyDown=function(X){hg.a(this.$).Fe(X);return!0};Ca.prototype.l8a=function(){this.ief&&
(dg.a.Pr||dg.a.fwa||(Fd.a.instance.pa(wf.a.pointerDown,this.taa,this.onPointerDown),this.taa.classList.remove("ewr-table-resize-default-cursor"),this.CJc=this.taa.disabled=!1),this.CJc=!1)};Ca.prototype.nNg=function(){var X=document.createElement("div");X.className="ewr-table-resize-handle";var ta=document.createElement("div");ta.className="ewr-table-resize-fillhandle-higher";var tb=document.createElement("div");tb.className="ewr-table-resize-fillhandle-broader";X.appendChild(ta);X.appendChild(tb);
this.taa=X;this.parentElement.appendChild(this.taa)};Ca.prototype.g_b=function(X){var ta=this,tb=this.Js.contains(X),Rb=X.top,Fc=X.bottom,lc=X.left;X=X.right;var Jd=null;if(tb){if(this.gridView.hka(this.Hn.topLeft)&&!this.Hn.CRa)return;Rb=Math.max(1,Fc-5,this.Hn.top);lc=Math.max(1,X-5,this.Hn.left);Fc=Rb;X=lc;Jd=new xc.Range(Rb,lc,Rb,lc,!1,!1)}else Fc+=5,X+=5,Rb=Fc,lc=X,Jd=new xc.Range(Fc,X,Fc,X,!1,!1);this.gridView.hka(Jd)||(this.Ar?this.Ar.Qo||(this.Ar=Ld.a.instance.create(function(){ta.gridView.yt(Jd,
60,Ze.a.f4f)},40,Od.a.g4f)):this.Ar=Ld.a.instance.create(function(){ta.gridView.yt(Jd,60,Ze.a.f4f)},40,Od.a.g4f))};Ca.prototype.pYb=function(X){var ta=X;if(this.gridView.$a.m4){if(!this.gridView.sc(X.topLeft)){var tb=this.gridView.sl("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.IG,this.Js.top!==X.top?1:2);try{tb.Uk=this.Js.top<X.top||this.Js.left<X.left,tb.Ou(X.topLeft),ta=tb.$$cu().range}finally{tb&&tb.dispose()}}ta.right=ta.left+X.width-1;ta.bottom=ta.top+X.height-1}return ta};Ca.prototype.luc=
function(X,ta,tb){tb=void 0===tb?!0:tb;var Rb=[];X=yl(X);for(var Fc=X.next();!Fc.done;Fc=X.next())Rb.push(new af.a(Fc.value,Xf.d(this.$.oa)));this.Nb.uw(Rb,[ta],!0,void 0,tb)};Ca.prototype.$0i=function(){for(var X=yl(this.gridView.jn),ta=X.next();!ta.done;ta=X.next())Fd.a.instance.pa(wf.a.lh,ta.value.domElement,this.Nj);Fd.a.instance.pa(wf.a.Wd,document.documentElement,this.Zg);this.mFe()};Ca.prototype.M1i=function(){for(var X=yl(this.gridView.jn),ta=X.next();!ta.done;ta=X.next())vf.a.instance.pa(wf.a.Ig,
ta.value.domElement,this.Nj);vf.a.instance.pa(wf.a.De,document.documentElement,this.lDb);this.mFe()};Ca.prototype.Xs=function(){this.Zxb&&this.pHj();this.Mgc&&this.AHj()};Ca.prototype.pHj=function(){for(var X=yl(this.gridView.jn),ta=X.next();!ta.done;ta=X.next())Fd.a.instance.za(wf.a.lh,ta.value.domElement,this.Nj);Fd.a.instance.za(wf.a.Wd,document.documentElement,this.Zg);this.BJf()};Ca.prototype.AHj=function(){for(var X=yl(this.gridView.jn),ta=X.next();!ta.done;ta=X.next())vf.a.instance.za(wf.a.Ig,
ta.value.domElement,this.Nj);vf.a.instance.za(wf.a.De,document.documentElement,this.lDb);this.BJf()};Ca.prototype.mFe=function(){Fd.a.instance.pa(wf.a.nz,document.documentElement,this.Vxa);this.gridView.rc.c6b(!0)};Ca.prototype.BJf=function(){Fd.a.instance.za(wf.a.nz,document.documentElement,this.Vxa);this.gridView.rc.c6b(!1)};Ca.prototype.HEj=function(X){var ta={};X=(ta.ResizeTableRange=X,ta.OriginalTableRange=this.Hn,ta);this.$.Ce(-1400250766,Qf.a.Wb,30,X)};Ca.prototype.UIj=function(X){if(!this.Hn.contains(X)){X=
this.gAj();X=yl(X);for(var ta=X.next();!ta.done;ta=X.next())if(this.tableManager.Uod(ta.value)){this.gridView.Bh.Rt(df.a.Tvi);return}}this.gridView.rtl?this.gridView.Bh.Rt(df.a.$ui):this.gridView.Bh.Rt(df.a.Bxi)};Ca.prototype.qab=function(){if(this.yA){sg.b(this.$,!1);try{this.Xs()}catch(X){Jc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",X)}}this.Ar&&(this.Ar.cancel(),this.Ar.dispose());this.Mgc=this.Zxb=!1;this.SFb();this.XFd();
sg.b(this.$,!1);this.gridView.Bh.Rt(df.a.saa)};Ca.prototype.gAj=function(){var X=[];this.Hn.right!==this.Js.right&&X.push(new xc.Range(this.Hn.top,this.Hn.right+1,this.Js.bottom,this.Js.right,!1,!1));this.Hn.bottom!==this.Js.bottom&&X.push(new xc.Range(this.Hn.bottom+1,this.Hn.left,this.Js.bottom,this.Hn.right,!1,!1));return X};Ca.createInstance=function(X,ta,tb,Rb){if(!ta)return null;var Fc=X.Nb;Fc.uw(tb,[27],!0);Fc.Yr(Ca.bAj);tb=Fc.OG(27,X.$a.Kj(ta.bottomRight),Ca.wHh(ta,tb)).Jh;return new Ca(tb,
X,ta,Rb)};Ca.wHh=function(X,ta){for(var tb,Rb=0;Rb<ta.length;Rb++)if((null===(tb=ta[Rb])||void 0===tb?0:tb.range)&&ta[Rb].range.equals(X))return Rb;return 0};tl.Object.defineProperties(Ca.prototype,{yA:{configurable:!0,enumerable:!0,get:function(){return this.Zxb||this.Mgc}},ief:{configurable:!0,enumerable:!0,get:function(){return this.CJc}}});Ca.bAj=[27];Object(sc.a)(Ca,"TableResizeBehavior",pg.a,[]);var xf=b(232);Wa.enh="ewa-ttrd-buttonarea";Object(sc.a)(Wa,"CssClassNames",null,[]);var Nh=b(45),
Fg=b(125),mh=b(92),ld=b(127),mg=b(257),hh=xf.a;vm(Za,hh);Za.prototype.dispose=function(){this.$&&this.g$g();this.$=this.gridView=this.parentElement=this.dKa=null;hh.prototype.dispose.call(this)};Za.prototype.oFh=function(X){var ta=this.xTh(this.gridView.sc(null).range);return ta?String.format("=SUBTOTAL({0},{1})",X,ta):null};Za.prototype.xTh=function(X){var ta=lf.g(this.$).Vb.vk(X);if(!ta)return null;ta=Me.a(ta,!1);ta.right=ta.left=X.left;return ta.toString()};Za.prototype.z4h=function(){Za.FL={};
Za.FL["100"]=Ve.a.instance.ea(1055);Za.FL["101"]=Ve.a.instance.ea(1058);Za.FL["102"]=Ve.a.instance.ea(1057);Za.FL["103"]=Ve.a.instance.ea(1062);Za.FL["104"]=Ve.a.instance.ea(1059);Za.FL["105"]=Ve.a.instance.ea(1060);Za.FL["109"]=Ve.a.instance.ea(1056);Za.FL["107"]=Ve.a.instance.ea(1063);Za.FL["110"]=Ve.a.instance.ea(1065);Za.FL["111"]=Ve.a.instance.ea(1116)};Za.prototype.fPi=function(){var X=this.gridView.sc(null);if(X&&(X=X.MJ?X.formulaBarText:null))if("=SUBTOTAL("===X.substring(0,10)){if(X=X.substring(10,
13),X in Za.FL)return X}else return"111";return"100"};Za.prototype.CHg=function(){this.gridView.Ca.gq(this.Pe);this.gridView.ha.fG(this.Gh);this.gridView.Nq(this.onContentReady);this.gridView.rc.wm(this.srf);this.gridView.rc.hq(this.PBb)};Za.prototype.g$g=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.vN(this.Gh),this.gridView.Ca.Zo(this.Pe)),this.gridView.Us(this.onContentReady),this.gridView.rc&&(this.gridView.rc.im(this.srf),this.gridView.rc.Rp(this.PBb)),this.U8f())};Za.prototype.Spb=
function(X){this.eJj(X);this.Jyb&&(this.Gyj(),this.Clb?(this.ACf||this.NHg(),this.KRc?this.C4=!1:(this.C4=!0,this.FNf())):(Jc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.C4=!1))};Za.prototype.FNf=function(){var X=this;appChrome.renderTableTotalRowOptions(this.parentElement,Za.FL,Za.FL[this.fPi()].toString(),Math.round(hg.a(this.$).Fi(17)),function(ta){Jc.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",
ta);var tb={};tb=(tb.SelectedOption=Za.FL[ta],tb.FunctionKeyCode=ta,tb.Location="canvas",tb);ld.b(X.$).ae(Fg.a.mAj,tb,null,!0);if("111"===ta)return X.U7h(),!0;if("100"!==ta){X.PHb=X.oFh(ta);if(!X.PHb)return Jc.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;X.CQa(X.PHb)}else X.CQa("");rf.DOMElementExtensions.setFocus(X.gridView.Kc.textBox.domElement);return!0})};Za.prototype.U7h=function(){Jc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
var X=new mh.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Zb(X)};Za.prototype.Kua=function(X){if(!X)return null;var ta=this.gridView.rc.textBox.domElement;var tb=0<rf.DOMElementExtensions.getHeight(ta)&&0<rf.DOMElementExtensions.getWidth(ta)&&0<=ta.offsetTop&&0<=ta.offsetLeft;if(tb)ta=rf.DOMElementExtensions.Kua(ta,this.gridView.Ui);else{ta=this.gridView.getCellBounds(X.cell);var Rb=rf.DOMElementExtensions.getBoundingClientRect(this.gridView.Ui);ta=new Sys.UI.Bounds(ta.x-Rb.x,ta.y-Rb.y,
ta.width,ta.height)}if(ta)if(tb)2<ta.height&&2<ta.height&&(ta.x+=1,ta.y+=1,ta.height-=2,ta.width-=2);else if(tb=lf.g(this.$).BJ(X.cell))tb=tb.width,Rb=Tf.a.equals(Mg.a.u2a(X.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Rb&&(ta.x=ta.x+ta.width-tb),X.oka&&this.gridView.rtl===Rb&&(ta.width=tb);else return null;return ta};Za.prototype.eJj=function(X){var ta=this.Clb;if(ta){var tb=17>=ta.height?ta.y:ta.y+ta.height-17-2;ta=this.dci?this.gridView.rtl?ta.x:ta.x+ta.width-(17<ta.height?17:ta.height):
this.gridView.rtl?ta.x-(17<ta.height?17:ta.height):ta.x+ta.width;var Rb=hg.a(this.$).OJa(new Sys.UI.Point(ta,tb));this.parentElement.style.top=td.HelperMethods.Qb(Rb.y);this.parentElement.style.left=td.HelperMethods.Qb(Rb.x);hg.a(this.$).Xjj(this.parentElement);X&&(this.C4=this.gridView.Vgc(new Nh.a(ta,tb)))}else this.C4=!1};Za.prototype.NHg=function(){this.dKa.insertBefore(this.parentElement,this.dKa.firstChild);this.ACf=!0};Za.prototype.Gyj=function(){this.pQ||(this.gridView.view.it(this.Ns),this.pQ=
!0)};Za.prototype.U8f=function(){this.pQ&&this.gridView.view&&(this.gridView.view.Wr(this.Ns),this.pQ=!1)};Za.prototype.CQa=function(X){var ta=this.gridView.Kc,tb=this.gridView.sc(null);tb&&(X=Object.assign(new mg.a,{Text:X}),this.gridView.setCell(X,tb.range,0,127,null),ta.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};tl.Object.defineProperties(Za.prototype,{C4:{configurable:!0,enumerable:!0,get:function(){return this.Fld},set:function(X){this.Fld!==X&&(this.Fld=this.isVisible=X)}},Jyb:{configurable:!0,
enumerable:!0,get:function(){return!!(this.$.Fd&16)}},dci:{configurable:!0,enumerable:!0,get:function(){var X=this.gridView.ha.va.activeCell;return X.right===X.maxColumns}},Clb:{configurable:!0,enumerable:!0,get:function(){var X=this.gridView.sc(null);return X&&this.gridView.GZ(X.range)?this.Kua(X):(X&&Jc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});Za.lAj="TableTotalRowDropDownIconButtonId";Za.FL=null;Object(sc.a)(Za,
"TableTotalRowOptions",xf.a,[3]);vm(ec,Aa);ec.prototype.wle=function(X){this.addHandler(Aa.UDd,X)};ec.prototype.NMf=function(X){this.removeHandler(Aa.UDd,X)};ec.prototype.tzg=function(X){this.addHandler("tce",X)};ec.prototype.N3i=function(X){this.removeHandler("tce",X)};ec.prototype.Uod=function(X){return!!this.cZe(X)};ec.prototype.eo=function(X){return this.tPh(this.IZe(X))};ec.prototype.eUe=function(X){return this.IZe(X)};ec.prototype.I1i=function(X){X?(this.tob?this.tob!==X&&(Df.a.Fa(this.t0),
this.t0=null,this.tob=X):this.tob=X,this.t0||(this.t0=se.a.instance.Cd(this.tob)),this.t0.Bt("focusin")||this.t0.ja("focusin",this.onFocus)):Jc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};ec.prototype.Maf=function(X,ta){return X?X.mva&&X.top===ta.top:(Jc.ULS.shipAssertTag(537151244,0,!!X,"autofilterRange can't be null"),!1)};ec.prototype.NJa=function(X){X=this.rob?dd.I(X,this.rob):this.view.getRangeInformation(X);return 0<X.length&&
Object(fc.a)(Id.PivotTableRange,X[0])?X[0]:null};ec.prototype.V9h=function(X,ta){return X?!X.Jec&&!!X.a$&&X.a$.Rd(ta):(Jc.ULS.shipAssertTag(537151243,0,!!X,"Pivot table can't be null"),!1)};ec.prototype.Bei=function(X,ta){return X?!X.Jec&&!!X.aQa&&X.aQa.Rd(ta):(Jc.ULS.shipAssertTag(537151242,0,!!X,"Pivot table can't be null"),!1)};ec.prototype.sXb=function(X){Aa.prototype.sXb.call(this,X);if((X=td.HelperMethods.qZe(X))&&0<X.length){this.rob=Array(X.length);for(var ta=0;ta<X.length;ta++)this.rob[ta]=
He.a.fQ(X[ta])}};ec.prototype.MFb=function(){Aa.prototype.MFb.call(this);this.rob=null};ec.prototype.ZZg=function(X,ta){return this.Wze(X,ta).returnValue};ec.prototype.Wze=function(X,ta){var tb=this;var Rb=!1;if(!X||!ta)return{returnValue:!1,eY:Rb};X=X.clone();X.right+=1;X.left=X.right;if(!X.isValidRange)return{returnValue:!1,eY:Rb};if(X.top<ta.$a.Vi){var Fc=X.clone();Fc.bottom>=ta.$a.Vi&&(Fc.bottom=ta.$a.Vi-1);if(!function(){var Jd=tb.Vze(Fc,ta);Rb=Jd.eY;return Jd}().returnValue)return{returnValue:!1,
eY:Rb}}if(X.bottom>=ta.$a.Vi){var lc=X.clone();lc.top<=ta.$a.Vi&&(lc.top=ta.$a.Vi);if(!function(){var Jd=tb.Vze(lc,ta);Rb=Jd.eY;return Jd}().returnValue)return{returnValue:!1,eY:Rb}}return{returnValue:!0,eY:Rb}};ec.prototype.h4f=function(X){(X=this.eo(X.topLeft))&&X.toString()in this.OEa&&(this.OEa[X.toString()].sod=!1)};ec.prototype.FWi=function(){this.raiseEvent("tce")};ec.prototype.ki=function(X,ta){if(!this.Cxc)return!1;switch(ta){case -569786022:case 541421805:if(this.Cxc.C4){var tb=document.getElementById(Za.lAj);
tb&&Ld.a.instance.create(function(){rf.DOMElementExtensions.Kdc(tb,null)},0,Od.a.eAj,!0,!0)}return!0;default:return!1}};ec.prototype.dispose=function(){this.I0b(null,null);this.NMf(this.DZb);this.$.xa.rg(this.aIf);this.$.En(this.I0b);this.yOb=null;this.$.fa&&this.$.fa.v6(this.I5);this.gridView.ha.vN(this.Gh);this.Cxc=null;me.EwaSettings.la(420)&&this.t0&&(Df.a.Fa(this.t0),this.t0=null);Aa.prototype.dispose.call(this)};ec.prototype.RYh=function(X,ta,tb,Rb){var Fc=this.gridView.Vb.vk(new xc.Range(ta,
tb,ta,tb,!1,!1));if(this.O3b=Fc){var lc=Fc.usedRange,Jd=X.ctrlKey||dg.a.isMac&&de.b(X),he=!X.shiftKey&&Jd;X=X.shiftKey&&!Jd;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(lf.g(this.$).ha.selectionType=3);switch(Rb){case 0:this.UPb=0;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.X2c(X,lc.top,tb,lc.bottom,tb),this.NMd(ta,he,X)):this.OMd(lc.top,tb,lc.bottom,tb,Me.d(Fc),Me.g(Fc),he);break;case 1:this.UPb=1;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ta=this.X2c(X,ta,lc.left,ta,lc.right),this.NMd(ta,he,X)):this.OMd(ta,lc.left,ta,lc.right,!1,!1,he);break;case 2:this.UPb=2;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.X2c(X,lc.top,lc.left,lc.bottom,lc.right),this.NMd(ta,he,X)):this.OMd(lc.top,lc.left,lc.bottom,lc.right,Me.d(Fc),Me.g(Fc),he);break;default:Jc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Rb.toString());return}me.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&
(lf.g(this.$).ha.selectionType=3);Jc.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else Jc.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};ec.prototype.Goj=function(X){var ta=this.O3b.usedRange;return this.Lcf(X)||1!==this.pHa&&this.Lcf(new xc.Range(ta.top,X.left,ta.bottom,X.right,!1,!1))?!0:!1};ec.prototype.TDd=function(X){return X.Autofilters};
ec.prototype.Vze=function(X,ta){var tb=!1;var Rb=ta.$a.Kj(X),Fc=ta.fg(Rb).Ph;if(!Fc)return Jc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",Rb),{returnValue:!1,eY:tb};if(!Fc.Jf(X))return{returnValue:!0,eY:tb};X=ta.sl("TableManager.CouldExpandImpl",X,2);try{for(;X.$$mn();){if(X.$$cu().text||X.Vn.s4e)return tb=!0,{returnValue:!1,eY:tb};if(X.$$cu().VJ)return{returnValue:!1,eY:tb}}}finally{X&&X.dispose()}return{returnValue:!0,eY:tb}};ec.prototype.tPh=
function(X){if(!X)return null;var ta=new $d.AutofilterRange(X.top,X.left,X.bottom,X.right,null,null,null,X.id,X.mva);ta.CRa=X.CRa;for(var tb=0,Rb=this.rangeList.length;tb<Rb;tb++){var Fc=this.rangeList[tb];Fc.id===X.id&&Fc!==X&&this.Kdi(Fc)&&(ta.union(Fc),Fc.CRa&&(ta.CRa=!0))}return ta};ec.prototype.Kdi=function(X){return!!lf.g(this.$).Vb.vk(X)};ec.prototype.yCh=function(){for(var X=[],ta=yl(this.rangeList),tb=ta.next();!tb.done;tb=ta.next())tb=new af.a(this.eo(tb.value.topLeft),Xf.d(this.$.oa)),
X.push(tb);return X};ec.prototype.ved=function(){for(var X={},ta=yl(this.rangeList),tb=ta.next();!tb.done;tb=ta.next())if(tb=tb.value){var Rb=this.eo(tb.topLeft);Rb&&(X[Rb.toString()]=this.eo(tb.topLeft))}return X};ec.prototype.oli=function(){this.$.fa.Mh?this.Hwb(0):this.$.fa.sn(this.aN)};ec.prototype.Hwb=function(X){var ta=this;this.$.rE(function(tb){tb.pua(X).then(ta.uEb)})};ec.prototype.HSh=function(X){var ta=this.gridView.Vb.vk(X);return ta?ta.name:X.toString()};ec.prototype.OMd=function(X,ta,
tb,Rb,Fc,lc,Jd){var he=X+(Fc?1:0),Te=tb-(lc?1:0),yg=this.gridView.inRangePicker||this.gridView.zi,Kg=!1,Ug=new xc.Range(he,ta,Te,Rb,!1,!1);if(Fc||lc)for(Fc=yg?af.a.aHa(this.gridView.ha.rangePicker.uK):this.gridView.ha.va.selectedRanges,Fc=yl(Fc),lc=Fc.next();!lc.done;lc=Fc.next()){lc=lc.value;Kg=this.spb(lc,he,ta,Te,Rb);var ae=this.spb(lc,X,ta,tb,Rb);if(yg&&Kg)break;if(!yg&&(Kg||ae)){this.gridView.ha.updateSelection(lc,lc.topLeft,0,1);if(Jd&&ae)return;break}}Kg&&(Ug.top=X,Ug.bottom=tb);X=Ug.topLeft;
Jd?this.gridView.ha.updateSelection(Ug,X,0,1):yg?this.gridView.ha.bD([Ug],0,X,0):this.gridView.ha.updateSelection(Ug,X,0,3)};ec.prototype.NMd=function(X,ta,tb){X&&(tb=tb?lf.g(this.$).ha.va.activeCell:X.topLeft,ta?this.gridView.ha.updateSelection(X,tb,0,1):this.gridView.ha.bD([X],0,tb,0))};ec.prototype.X2c=function(X,ta,tb,Rb,Fc){var lc=Me.d(this.O3b),Jd=Me.g(this.O3b),he=ta+(1!==this.pHa&&lc?1:0),Te=Rb-(1!==this.pHa&&Jd?1:0),yg=this.gridView.inRangePicker||this.gridView.zi;if(X){var Kg=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&
yg&&!af.a.aHa(this.gridView.ha.rangePicker.uK).length?new xc.Range(he,tb,Te,Fc,!1,!1):yg?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.va.activeCell;Kg=new xc.Range(Kg.top<he?Kg.top:he,Kg.left<tb?Kg.left:tb,Kg.bottom>Te?Kg.bottom:Te,Kg.right>Fc?Kg.right:Fc,!1,!1)}else Kg=new xc.Range(he,tb,Te,Fc,!1,!1);if(1!==this.pHa&&(lc||Jd)&&(!X||X&&this.spb(Kg,he,tb,Te,Fc)))for(X=yg?af.a.aHa(this.gridView.ha.rangePicker.uK):this.gridView.ha.va.selectedRanges,X=yl(X),lc=X.next();!lc.done;lc=X.next())if(this.spb(lc.value,
he,tb,Te,Fc)){Kg.top=ta;Kg.bottom=Rb;break}return Kg};ec.prototype.Lcf=function(X){var ta=this.gridView.inRangePicker||this.gridView.zi?af.a.aHa(this.gridView.ha.rangePicker.uK):this.gridView.ha.va.selectedRanges;ta=yl(ta);for(var tb=ta.next();!tb.done;tb=ta.next())if(this.spb(tb.value,X.top,X.left,X.bottom,X.right))return!0;return!1};ec.prototype.spb=function(X,ta,tb,Rb,Fc){return!!X&&X.top===ta&&X.bottom===Rb&&X.left===tb&&X.right===Fc};tl.Object.defineProperties(ec.prototype,{OEa:{configurable:!0,
enumerable:!0,get:function(){return this.yOb}},dqd:{configurable:!0,enumerable:!0,get:function(){return this.G7d}},pHa:{configurable:!0,enumerable:!0,get:function(){return this.UPb}},Wg:{configurable:!0,enumerable:!0,get:function(){var X=lf.g(this.$);return X.Vb.vk(X.ha.va.activeCell,!1)}},V9a:{configurable:!0,enumerable:!0,get:function(){return this.dqd?lf.g(this.$).Vb.vk(this.dqd,!1):null}}});Object(sc.a)(ec,"TableManager",Aa,[828,3]);var $e=Vf.a;vm(Yb,$e);Yb.prototype.create=function(){this.Fb(this.tableManager||
(this.tableManager=new ec(this.$)))};Object(sc.a)(Yb,"TableManagerFactory",Vf.a,[]);var Qg=b(110),ch=b(948),wg=b(1416),Gi=b(850),mi=b(1368),ph=b(164),Ng=b(81),ai=b(107),Zg=b(26),ni=b(181),yh=b(27),fh=b(302);Object(sc.a)($a,"TableStyleElement",null,[]);var yi=b(876),ei=b(202),la=b(85),kb=b(553);jb.Mjf=function(X,ta){return jb.k4f[X.Type]-jb.k4f[ta.Type]};jb.I2a=function(X,ta){try{return appChrome.buildTableStyleGalleryIconNew(jb.uAa,jb.yna,X,ta)}catch(tb){return null}};jb.kef=function(X){return X&&
Qf.a.hd in X&&(X=X[Qf.a.hd])?Tf.a.eI(X,df.a.DEb):!1};jb.psa=function(X){var ta=[],tb=0;X=yl(X);for(var Rb=X.next();!Rb.done;Rb=X.next()){Rb=Rb.value;ta[tb]={};ta[tb].backgroundColor="white";ta[tb].color="black";for(var Fc in Rb){var lc=Rb[Fc];switch(Fc){case "background-color":ta[tb].backgroundColor=lc;break;case "color":ta[tb].color=lc;break;case "font-size":ta[tb].fontSize=lc;break;case "border-bottom":ta[tb].borderBottom=lc;break;case "border-right":ta[tb].borderRight=lc;break;case "border-left":ta[tb].borderLeft=
lc;break;case "border-top":ta[tb].borderTop=lc}}tb++}return ta};jb.r2b=function(X,ta){var tb=[];if(null===X||void 0===X?0:X.TableStyleElementsList)for(var Rb=!X.Category,Fc=0;Fc<jb.yna;Fc++)tb.push.apply(tb,jb.mGh(X,ta,Rb,Fc));else{if(jb.w4c)return jb.w4c;X={color:"black","background-color":"white"};for(ta=0;ta<jb.yna;ta++)for(Rb=0;Rb<jb.uAa;Rb++)tb.push(X);jb.w4c=tb}return tb};jb.ISh=function(X,ta){if(!X.TableStyleElementsList)return"";var tb="";X=yl(X.TableStyleElementsList);for(var Rb=X.next();!Rb.done;Rb=
X.next())if(Rb=Rb.value,Rb.BackgroundColor&&"#000000"!==Rb.BackgroundColor)switch(Rb.Type){case 0:tb=Rb.BackgroundColor;break;case 5:case 7:if(ta.qha||ta.xR)tb=Rb.BackgroundColor;break;case 3:case 4:if(ta.firstCol||ta.lastCol)tb=Rb.BackgroundColor;break;case 2:ta.totalRow&&(tb=Rb.BackgroundColor);break;case 1:ta.headerRow&&(tb=Rb.BackgroundColor)}return tb};jb.q1b=function(X){X=new ei.a(parseInt(String("0x"+X.substr(1,2))),parseInt(String("0x"+X.substr(3,2))),parseInt(String("0x"+X.substr(5,2))));
return yi.a.JJa(X)};jb.o0e=function(X,ta){if(!X||!ta)return"";ta=(ta=jb.ISh(X,ta))?jb.q1b(ta)+", ":Ve.a.instance.ea(2003)+", ";switch(X.Index){case 0:return ta+Ve.a.instance.ea(1937);case 1:return ta+Ve.a.instance.ea(1938);case 2:return ta+Ve.a.instance.ea(1939);case 3:return ta+Ve.a.instance.ea(1940);case 4:return ta+Ve.a.instance.ea(1941);case 5:return ta+Ve.a.instance.ea(1942);case 6:return ta+Ve.a.instance.ea(1943);case 7:return ta+Ve.a.instance.ea(1944);case 8:return ta+Ve.a.instance.ea(1945);
case 9:return ta+Ve.a.instance.ea(1946);case 10:return ta+Ve.a.instance.ea(1947);case 11:return ta+Ve.a.instance.ea(1948);case 12:return ta+Ve.a.instance.ea(1949);case 13:return ta+Ve.a.instance.ea(1950);case 14:return ta+Ve.a.instance.ea(1951);case 15:return ta+Ve.a.instance.ea(1952);case 16:return ta+Ve.a.instance.ea(1953);case 17:return ta+Ve.a.instance.ea(1954);case 18:return ta+Ve.a.instance.ea(1955);case 19:return ta+Ve.a.instance.ea(1956);case 20:return ta+Ve.a.instance.ea(1957);case 21:return ta+
Ve.a.instance.ea(1958);case 22:return ta+Ve.a.instance.ea(1959);case 23:return ta+Ve.a.instance.ea(1960);case 24:return ta+Ve.a.instance.ea(1961);case 25:return ta+Ve.a.instance.ea(1962);case 26:return ta+Ve.a.instance.ea(1963);case 27:return ta+Ve.a.instance.ea(1964);case 28:return ta+Ve.a.instance.ea(1965);case 29:return ta+Ve.a.instance.ea(1966);case 30:return ta+Ve.a.instance.ea(1967);case 31:return ta+Ve.a.instance.ea(1968);case 32:return ta+Ve.a.instance.ea(1969);case 33:return ta+Ve.a.instance.ea(1970);
case 34:return ta+Ve.a.instance.ea(1971);case 35:return ta+Ve.a.instance.ea(1972);case 36:return ta+Ve.a.instance.ea(1973);case 37:return ta+Ve.a.instance.ea(1974);case 38:return ta+Ve.a.instance.ea(1975);case 39:return ta+Ve.a.instance.ea(1976);case 40:return ta+Ve.a.instance.ea(1977);case 41:return ta+Ve.a.instance.ea(1978);case 42:return ta+Ve.a.instance.ea(1979);case 43:return ta+Ve.a.instance.ea(1980);case 44:return ta+Ve.a.instance.ea(1981);case 45:return ta+Ve.a.instance.ea(1982);case 46:return ta+
Ve.a.instance.ea(1983);case 47:return ta+Ve.a.instance.ea(1984);case 48:return ta+Ve.a.instance.ea(1985);case 49:return ta+Ve.a.instance.ea(1986);case 50:return ta+Ve.a.instance.ea(1987);case 51:return ta+Ve.a.instance.ea(1988);case 52:return ta+Ve.a.instance.ea(1989);case 53:return ta+Ve.a.instance.ea(1990);case 54:return ta+Ve.a.instance.ea(1991);case 55:return ta+Ve.a.instance.ea(1992);case 56:return ta+Ve.a.instance.ea(1993);case 57:return ta+Ve.a.instance.ea(1994);case 58:return ta+Ve.a.instance.ea(1995);
case 59:return ta+Ve.a.instance.ea(1996);default:return X.Name?X.Name:""}};jb.fNh=function(X){return(X+1)%jb.g1h};jb.Tub=function(X,ta,tb){tb=void 0===tb?"":tb;return X||!tb?String.format("{0}, {1}, -version, {2}",jb.B6e,X.Index.toString(),ta.toString()):String.format("{0}, {1}, -version, {2}",jb.B6e,tb,ta.toString())};jb.mGh=function(X,ta,tb,Rb){for(var Fc=[],lc=0;lc<jb.uAa;lc++)Fc.push(jb.Vbd(X,ta,tb,Rb,lc));return Fc};jb.Vbd=function(X,ta,tb,Rb,Fc){var lc=X.TableStyleElementsList;X=new $a;var Jd=
{};if(!lc)return Jd;for(var he=yl(lc),Te=he.next();!Te.done;Te=he.next())if(Te=Te.value,!Te.Type){X=Te;break}he=!!X.BackgroundColor;var yg="";!tb&&X.TableStyleBorderFromatList&&0<X.TableStyleBorderFromatList.length&&(yg=X.TableStyleBorderFromatList[0].Color);Jd["background-color"]=he?X.BackgroundColor:"#FFFFFF";X.FontColor||(X.FontColor="#000000");Jd.color=X.FontColor;jb.eve(Rb,Fc,Jd,X,yg,tb,he);lc=yl(lc);for(Te=lc.next();!Te.done;Te=lc.next())(Te=Te.value)&&Te.Type&&(2!==Te.Type||he||(Te.BackgroundColor=
X.BackgroundColor),jb.Ood(Te,Rb,Fc,ta)&&(Te.BackgroundColor&&(Jd["background-color"]=Te.BackgroundColor),Jd.color=Te.FontColor||X.FontColor,jb.eve(Rb,Fc,Jd,Te,yg,tb,he)));return Jd};jb.FU=function(X,ta,tb,Rb,Fc,lc){tb&&(tb.Color&&!tb.Style&&(tb.Style=1),tb.Style&&!tb.Color&&(tb.Color=Fc?"#000000":Rb?Rb:lc?"#FFFFFF":"#000000"),ta[jb.borders[X]]="1px "+jb.vV[tb.Style]+" "+tb.Color)};jb.Ood=function(X,ta,tb,Rb){return-1===X.Type?!1:jb.Pod(X,ta,tb,Rb)||jb.Kfi(X,ta,tb,Rb)||jb.Qod(X,ta,tb,Rb)};jb.Kfi=function(X,
ta,tb,Rb){return!ta&&Rb.headerRow||ta===jb.yna-1&&Rb.totalRow?!1:1===ta%2&&5===X.Type&&Rb.xR&&Rb.headerRow||1<ta&&!!((ta-1)%(X.BandSize+1))&&6===X.Type&&Rb.xR&&Rb.headerRow||!(ta%2)&&5===X.Type&&Rb.xR&&!Rb.headerRow||!!(ta%(X.BandSize+1))&&6===X.Type&&Rb.xR&&!Rb.headerRow||!(tb%2)&&7===X.Type&&Rb.qha||!!(tb%(X.BandSize+1))&&8===X.Type&&Rb.qha};jb.Qod=function(X,ta,tb,Rb){return ta===jb.yna-1&&2===X.Type&&Rb.totalRow||tb===jb.uAa-1&&ta===jb.yna-1&&12===X.Type&&Rb.totalRow&&Rb.lastCol||!tb&&ta===jb.yna-
1&&11===X.Type&&Rb.totalRow&&Rb.firstCol||tb===jb.uAa-1&&4===X.Type&&Rb.lastCol};jb.Pod=function(X,ta,tb,Rb){return!ta&&1===X.Type&&Rb.headerRow||!tb&&3===X.Type&&Rb.firstCol||!tb&&!ta&&9===X.Type&&Rb.headerRow&&Rb.firstCol||tb===jb.uAa-1&&!ta&&10===X.Type&&Rb.headerRow&&Rb.lastCol};jb.eve=function(X,ta,tb,Rb,Fc,lc,Jd){if(Rb.TableStyleBorderFromatList)for(var he=yl(Rb.TableStyleBorderFromatList),Te=he.next();!Te.done;Te=he.next())if(Te=Te.value,Te.Style)switch(Te.Position){case 0:X&&12!==Rb.Type&&
11!==Rb.Type&&2!==Rb.Type&&5!==Rb.Type&&6!==Rb.Type||jb.FU(0,tb,Te,Fc,lc,Jd);break;case 1:X!==jb.yna-1&&1!==Rb.Type&&10!==Rb.Type&&9!==Rb.Type&&5!==Rb.Type&&6!==Rb.Type||jb.FU(1,tb,Te,Fc,lc,Jd);break;case 2:ta&&12!==Rb.Type&&10!==Rb.Type&&7!==Rb.Type&&8!==Rb.Type&&4!==Rb.Type||jb.FU(2,tb,Te,Fc,lc,Jd);break;case 3:ta!==jb.uAa-1&&9!==Rb.Type&&11!==Rb.Type&&3!==Rb.Type&&7!==Rb.Type&&8!==Rb.Type||jb.FU(3,tb,Te,Fc,lc,Jd);break;case 5:ta!==jb.uAa-1&&3!==Rb.Type&&4!==Rb.Type&&7!==Rb.Type&&8!==Rb.Type&&jb.FU(3,
tb,Te,Fc,lc,Jd);break;case 6:X!==jb.yna-1&&2!==Rb.Type&&1!==Rb.Type&&5!==Rb.Type&&6!==Rb.Type&&jb.FU(1,tb,Te,Fc,lc,Jd)}};jb.LSh=function(){var X=Array(12);X[0]=0;X[7]=1;X[8]=2;X[5]=3;X[6]=4;X[4]=5;X[3]=6;X[1]=7;X[2]=8;X[9]=9;X[10]=10;X[11]=11;X[12]=13;return X};jb.yna=5;jb.uAa=5;jb.g1h=5;jb.B6e="TableStyleIcon";jb.vV=[null,la.a.solid,la.a.dashed,la.a.dotted,la.a.dashed,la.a.dotted,la.a.dashed,la.a.double];jb.borders=[kb.a.borderTop,kb.a.borderBottom,kb.a.borderLeft,kb.a.borderRight];jb.k4f=jb.LSh();
jb.w4c=null;Object(sc.a)(jb,"TableStyleHelper",null,[]);Ua.prototype.equals=function(X){return X?this.headerRow===X.headerRow&&this.totalRow===X.totalRow&&this.firstCol===X.firstCol&&this.lastCol===X.lastCol&&this.qha===X.qha&&this.xR===X.xR:!1};Object(sc.a)(Ua,"TableStyleOptions",null,[]);var Xb=b(924),Dc=Ec.a;vm(Ga,Dc);Ga.prototype.SYh=function(X){var ta=this.tableManager.Wg;if(!ta)return!1;X=X[Qf.a.hd];if(!X)return!1;switch(Number.parseInvariant(X)){case 0:return Me.d(ta);case 1:return Me.c(ta);
case 2:return Me.g(ta);case 3:return Me.e(ta);case 4:return Me.f(ta);case 5:return Me.b(ta);case 6:return ta.hasAutoFilter}return!1};Ga.prototype.YDf=function(X,ta){if(Qg.a.isEmpty(this.xF))return!0;if("PopulateTableMoreStylesMenu"!==X&&"PopulateTableAccessibleStylesMenu"!==X)return!1;if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===X&&!this.bxc)return this.AKb||(this.AKb=!0,this.XJa("accessibilityTab")),!0;this.Eyb=
!0;var tb=this.Sa.zp("TableStylesMenu"),Rb=this.Sa.iA("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Fc=this.Sa.iA("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),lc=this.Sa.iA("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Jd=this.Sa.iA("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),he=-123538519;if(ta.MenuId)if(Tf.a.contains(ta.MenuId,"FormatAsTable",!0))he=753331043,this.e5a=!0;else{var Te=Ve.a.instance.ea(1936);var yg=jb.Tub(null,1,"-1");
me.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Jd.ht("-1",he,"QueryTableStyle",0,"-1",yg,void 0,void 0,Te):Jd.ht("-1",he,"QueryTableStyle",0,"-1",void 0,void 0,void 0,Te);this.e5a=!1}yg=0;var Kg=this.xF,Ug;for(Ug in Kg){var ae=Kg[Ug];if(!me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==X||!ae.HasStyleViolations){Te=jb.o0e(ae,this.Ntb());var Re=jb.Tub(ae,this.hHa);if(ae)switch(ae.Category){case 0:Rb.ht(ae.Index.toString(),
he,"QueryTableStyle",0,ae.Index.toString(),Re,void 0,void 0,Te);yg++;break;case 3:Fc.ht(ae.Index.toString(),he,"QueryTableStyle",0,ae.Index.toString(),Re,void 0,void 0,Te);break;case 2:lc.ht(ae.Index.toString(),he,"QueryTableStyle",0,ae.Index.toString(),Re,void 0,void 0,Te);break;case 1:Jd.ht(ae.Index.toString(),he,"QueryTableStyle",0,ae.Index.toString(),Re,void 0,void 0,Te)}}}0<yg&&this.d2(tb,Rb,1904);this.d2(tb,Jd,1905);this.d2(tb,lc,1906);this.d2(tb,Fc,1907);ta.MenuItems=tb.JB();this.isInitialized||
(this.isInitialized=!0);return!0};Ga.prototype.TYh=function(X){var ta=this;X[ch.a.On]=!1;var tb=X[Qf.a.hd];if(tb&&!Qg.a.isEmpty(this.xF)){Tf.a.contains(X.ParentMenuId,"FormatAsTable",!0)?this.e5a=!0:this.e5a=!1;this.e5a||this.G9f();jb.kef(X)&&(tb=this.gub(tb).toString());var Rb=this.Ntb();X[ch.a.Alt]="-1"===tb?Ve.a.instance.ea(1936):jb.o0e(this.mfd(tb),Rb);if(tb in this.YRa&&Rb.equals(this.CXc))this.aEf(X,tb,Rb,!0);else{if(!this.Lpc||this.Lpc&&!this.Lpc.Qo)this.Qla={},this.Lpc=Ld.a.instance.create(function(){ta.XJf();
ta.CXc=ta.Ntb()},0,Od.a.kAj,!0,!0);this.ABd(Rb,X,tb)}}};Ga.prototype.getTableStyleIndexFromName=function(X){if(!X||Qg.a.isEmpty(this.xF))return-1;if(X in this.xF)return this.xF[X].Index;this.XJa("getTableStyleIndexFromName");return-1};Ga.prototype.Dgc=function(){return!!this.XK};Ga.prototype.gub=function(X){this.rN||this.fXc();return X in this.rN?this.rN[X]:-1};Ga.prototype.XJa=function(X){if(this.$.isEditMode)if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1)){var ta=new Date;if(30<ai.getElapsedSeconds(this.lastSyncTime,ta)||Qg.a.isEmpty(this.xF)||this.AKb){var tb=this.$.qa.ta.Xb();this.lastSyncTime=ta;X=this.AKb&&"accessibilityTab"===X||"galleryMenuClosed"===X;Ng.s(this.$.qa.ta,X,this.Fuf,this.iyd,null,X?"accessibility":"normal",tb)}}else if(tb=new Date,30<ai.getElapsedSeconds(this.lastSyncTime,tb)||Qg.a.isEmpty(this.xF))X=this.$.qa.ta.Xb(),this.lastSyncTime=tb,Ng.r(this.$.qa.ta,this.Fuf,this.iyd,null,null,X)};Ga.prototype.dispose=function(){this.rN=
this.YRa=this.XK=this.xF=null;this.$.Ka.Y$a(this.gAf);Dc.prototype.dispose.call(this)};Ga.prototype.bCg=function(X){this.addHandler("RefreshTableStyleGallery",X)};Ga.prototype.T5i=function(X){this.removeHandler("RefreshTableStyleGallery",X)};Ga.prototype.fXc=function(){var X={};this.tableManager.Wg&&(this.dda=this.getTableStyleIndexFromName(this.tableManager.Wg.Bxc));for(var ta=1;7>=ta;ta++)X["preview"+ta]=this.kMh(ta);this.rN=X};Ga.prototype.kMh=function(X){var ta=this.XK.TableStyleItems.length;
ta=4>=this.dda?this.dda+X-1:4<this.dda&&this.dda<ta-4?4===X?this.dda:Math.floor(this.dda+X-4):this.dda+X-1;-1===ta||ta.toString()in this.YRa||(ta=X-3);return ta};Ga.prototype.G9f=function(){if(this.tableManager.Wg){var X=!1,ta=this.getTableStyleIndexFromName(this.tableManager.Wg.Bxc);if(ta!==this.dda){if(this.rN){var tb=this.rN,Rb;for(Rb in tb)tb[Rb]===ta&&(X=!0)}this.dda=ta;X||Qg.a.isEmpty(this.YRa)||this.fXc()}}};Ga.prototype.d2=function(X,ta,tb){var Rb=this.Sa.Lc();Rb.Cp="Thin";Rb.title=Ve.a.instance.ea(tb);
Rb.buttons.push(ta);X.yc.push(Rb)};Ga.prototype.Ntb=function(){var X=this.tableManager.Wg;return this.e5a||!X?new Ua(!0,!1,!1,!1,!0,!1):new Ua(Me.d(X),Me.g(X),Me.c(X),Me.e(X),Me.f(X),Me.b(X))};Ga.prototype.XJf=function(X){X=void 0===X?!1:X;var ta={},tb={},Rb=this.Ntb();if(!Qg.a.isEmpty(this.xF)&&(this.tableManager.Wg&&this.G9f(),!Rb.equals(this.CXc)||X||Qg.a.isEmpty(this.YRa))){this.hHa=jb.fNh(this.hHa);X=this.xF;for(var Fc in X){var lc=X[Fc],Jd=jb.Tub(lc,this.hHa);ta[lc.Index.toString()]=jb.I2a(jb.psa(jb.r2b(lc,
Rb)),Jd);tb[Jd]=ta[lc.Index.toString()];this.DFb(tb)}Fc=jb.Tub(null,this.hHa,"-1");ta["-1"]=jb.I2a(jb.psa(jb.r2b(null,Rb)),Fc);tb[Fc]=ta["-1"];this.DFb(tb);ni.c(this.YRa,ta,!1)}};Ga.prototype.$fi=function(){var X=ph.a(this.$);return X?X.Lm.qo===df.a.tpc:!1};Ga.prototype.ABd=function(X,ta,tb){Number.parseInvariant(tb);"-1"===tb&&Tf.a.contains(ta.ParentMenuId,"FormatAsTable",!0)||this.aEf(ta,tb,X,!1)};Ga.prototype.aEf=function(X,ta,tb,Rb){var Fc=jb.Tub(null,this.hHa,ta);jb.kef(X)?(Fc in this.Qla?tb=
this.Qla[Fc]:(tb=jb.psa(jb.r2b(this.mfd(ta),tb)),this.Qla[Fc]=tb),X[ch.a.GalleryButtonProps]=Object.assign(new wg.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Fc,Alt:X[ch.a.Alt],MenuItemId:ta,TableCellStyles:tb,TableStyles:this.UTi})):(X[Gi.a.Icon]=Fc,X[ch.a.GalleryButtonProps]=Object.assign(new mi.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Fc,Alt:X[ch.a.Alt],MenuItemId:ta}),Rb||(Rb=[],this.mfd(ta),"-1"===ta||Tf.a.contains(X.ParentMenuId,"FormatAsTable",!0)||(Rb=jb.r2b(this.XK.TableStyleItems[Number.parseInvariant(ta)],
tb)),this.YRa[ta]=jb.I2a(jb.psa(Rb),Fc)))};Ga.prototype.DFb=function(X){var ta=this;if(this.Eyb)this.Jsc=function(){ta.DFb(X)};else{this.Jsc=null;var tb=[],Rb;for(Rb in X){var Fc=Rb;Fc in this.EFb?tb.push(Fc):this.EFb[Fc]=!0}try{0<tb.length&&appChrome.api.unregisterIcons(tb),Qg.a.isEmpty(X)||appChrome.api.registerIconProvider(function(){return X})}catch(lc){}}};Ga.prototype.mfd=function(X){X=Number.parseInvariant(X);if(-1===X||!this.XK)return null;if(60<X)for(var ta=60;ta<this.XK.TableStyleItems.length;++ta){var tb=
this.XK.TableStyleItems[ta];if(tb.Index===X)return tb}return this.XK.TableStyleItems[X]};Object(sc.a)(Ga,"TableStyleManager",Ec.a,[827,3]);var xb=Vf.a;vm(Ha,xb);Ha.prototype.create=function(){var X=this,ta=jg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb),tb=jg.GetServiceTaskFactory.Xa(this.$.da,66,134,this.tb);Ff.TaskExtensions.Ba(gg.Task.WAA(ta,tb),function(){X.Fb(X.tableStyleManager||(X.tableStyleManager=new Ga(X.$,ta.result,tb.result)))},this.$.ma,8)};Object(sc.a)(Ha,"TableStyleManagerFactory",
Vf.a,[]);var jd=b(817),ke=b(52);bb.prototype.AU=function(){return this.autoFilterOptions};Object(sc.a)(bb,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[98]);ka.prototype.AU=function(){return this.autoFilterOptions};Object(sc.a)(ka,"MacroRecorderRangeItemFilteredPayload",null,[98]);var Ge=b(1062),cf=b(368),kf=b(163),jf=b(175),Ef=b(273);Object(sc.a)(Nb,"MacroRecorderTableStyleAppliedPayload",null,[98]);vm(E,Nb);Object(sc.a)(E,"MacroRecorderRangeFormatedAsTablePayload",Nb,[]);vb.prototype.Hdd=
function(){return this.newTitle};Object(sc.a)(vb,"MacroRecorderTableAltTextEditedPayload",null,[98]);Object(sc.a)(rc,"MacroRecorderTableRenamedPayload",null,[98]);Object(sc.a)(pb,"MacroRecorderTableResizedPayload",null,[98]);Object(sc.a)(fb,"MacroRecorderTableStyleOptionToggledPayload",null,[98]);Object(sc.a)(Ta,"MacroRecorderTableConvertedToRangePayload",null,[98]);eb.prototype.fL=function(){Jc.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.wf.dh.Ac);if(this.EBa&&!fh.a(this.EBa)){this.wf.gyb=this.EBa.Result;if(this.wf.gyb)return this.pYd=yh.a.jd(3,2,0,722,0,-66108047,"ConvertToRange"),this.ej=Lg.a(this.wf.$).ri(this.pYd).G(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.ABc;this.wf.Ize();return this.Geb}return this.Q0};eb.prototype.Q0=function(){this.wf.dh.stop();Jc.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.wf.dh.Ac);
this._state=3};eb.prototype.Geb=function(){return this.Q0};eb.prototype.ABc=function(){this.qYd=this.ej.Sy();Jc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.wf.dh.Ac);this.qYd||this.wf.Hze();return this.Geb};eb.prototype.dispose=function(){};Object(sc.a)(eb,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[3]);var ya=b(871);rb.prototype.y9a=function(){var X=this;this.dh.start();
var ta=this.$.qa.ta.Xb();return me.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?ya.h(this.$.qa.ta,this.sharedSheetRange,function(tb){X.showDialog(tb)},null,null,null,ta):ya.h(this.$.qa.ta,this.sharedSheetRange,function(tb){X.Rrj(tb)},null,null,null,ta)};rb.prototype.showDialog=function(X){var ta=this;Jc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.dh.Ac);X&&!fh.a(X)&&((this.gyb=X.Result)?(X=yh.a.jd(3,2,0,722,0,-66108047,"ConvertToRange"),Ff.TaskExtensions.Ba(Lg.a(this.$).ri(X),function(tb){Jc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",ta.dh.Ac);tb.result||ta.Hze()},this.$.ma,11)):this.Ize());this.dh.stop();Jc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.dh.Ac)};rb.prototype.Rrj=
function(X){new eb(this,X)};rb.prototype.Pre=function(){var X={};X.IsQueryTable=this.gyb;X.Range=this.sharedSheetRange;return X};rb.prototype.Hze=function(){var X=this,ta=this.$.qa.ta;Jc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.q9e(194,function(tb,Rb,Fc){return ya.d(ta,X.Pre(),tb,Rb,Fc,null)});Jc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};rb.prototype.Ize=function(){var X=this,ta=this.$.qa.ta;Jc.ULS.sendTraceTag(537151188,
0,50,"Convert To Range initiated for Normal Table");this.q9e(193,function(tb,Rb,Fc){return ya.c(ta,X.Pre(),tb,Rb,Fc,null)},function(){return new Ta(X.tableName)});Jc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};rb.prototype.q9e=function(X,ta,tb){tb=void 0===tb?null:tb;cf.a(this.$.userOperationManager,ta,function(Rb){return new kf.a(X,0,Rb,void 0,tb)},null)};Object(sc.a)(rb,"ConvertToRangeManager",null,[]);var qa=b(1222),ub=b(1221),Dd=b(1259),be=Dd.a;vm(Tc,be);Tc.prototype.Wl=
function(){var X=this,ta=dd.s(this.WB.TableRange);return function(){return new E(ta,X.H3a.checked,X.vAa,!0)}};Tc.prototype.Uw=function(){var X=this,ta=dd.s(this.WB.TableRange);return function(tb,Rb,Fc){return ya.g(X.$.qa.ta,ta,X.H3a.checked,!1,X.WB.HasTotalRow,X.vAa,tb,Rb,Fc,null)}};Tc.prototype.Lx=function(X,ta,tb){be.prototype.Lx.call(this,X,ta,tb)};tl.Object.defineProperties(Tc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Cw:{configurable:!0,enumerable:!0,
get:function(){return 215}}});Object(sc.a)(Tc,"FormatAsTableDialogDeprecated",Dd.a,[]);var Je=b(1086),Cf=Je.a;vm(vd,Cf);vd.prototype.Wl=function(){var X=this,ta=dd.s(this.WB.TableRange);return function(){return new E(ta,X.hasHeaders,X.vAa,!0)}};vd.prototype.Uw=function(){var X=this,ta=dd.s(this.WB.TableRange),tb=this.WB.HasTotalRow;return function(Rb,Fc,lc){return ya.g(X.$.qa.ta,ta,X.hasHeaders,!1,tb,X.vAa,Rb,Fc,lc,null)}};tl.Object.defineProperties(vd.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"FormatAsTableDialog"}},Cw:{configurable:!0,enumerable:!0,get:function(){return 215}},Wn:{configurable:!0,enumerable:!0,get:function(){return Ve.a.instance.ea(716)}}});Object(sc.a)(vd,"FormatAsTableReactDialog",Je.a,[]);var Jg=b(521),$g=b(82),Tg=Jg.a;vm(Pc,Tg);Pc.prototype.FCf=function(X){X=X.startsWith("=")?X.substring(1,X.length):X;var ta=dd.Z(X,this.$.xa);X=ta.sheetName;var tb=ta.range;return ta.returnValue&&tb?(tb=dd.v(tb,this.$),tb.SheetName=Tf.a.equals(X,"",!0)?this.$.oa.name:
X,tb):null};Pc.prototype.LU=function(X){var ta={};return ta[Pc.w4]="ResizeTableDialog",ta[Pc.XHf]=X,ta.getInputErrorIfInvalid=this.iub,ta};Pc.prototype.mdd=function(X){X=this.FCf(X);if(!X)return 1;var ta=dd.D(X);return Tf.a.equals(X.SheetName,this.$.oa.sheetName,!0)&&this.lnc.top===ta.top&&this.lnc.Rd(ta)?0:2};Pc.prototype.Jad=function(X){var ta="";switch(X){case 1:ta=Ve.a.instance.ea(74);break;case 2:ta=$g.a.ym(Ve.a.instance.ea(73))}return ta};Pc.prototype.CEj=function(X){var ta={};X=(ta.ResizeTableRange=
X,ta.OriginalTableRange=this.lnc,ta);this.$.Ce(-1400250766,Qf.a.Wb,8,X)};tl.Object.defineProperties(Pc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});Pc.w4="id";Pc.XHf="range";Object(sc.a)(Pc,"ResizeTableDialog",Jg.a,[]);var Dh=Jg.a;vm(Zc,Dh);Zc.prototype.$zj=function(X,ta){if(1===X&&(X=ta[Zc.uCj],ta=ta[Zc.O9g],X!==this.originalTitle||ta!==this.originalDescription)){var tb={};X=(tb.Title=X,tb.Description=ta,tb);this.$.Ce(868579142,Qf.a.Wb,8,X)}};Zc.prototype.LU=
function(X,ta){var tb={};return tb.id="AltTextDialog",tb.title=X,tb.description=ta,tb};tl.Object.defineProperties(Zc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});Zc.w4="id";Zc.uCj="title";Zc.O9g="description";Object(sc.a)(Zc,"TableAltTextDialog",Jg.a,[]);var Mh=b(901),Oh=b(902),Li=b(132),Th=b(64);Ic.prototype.Xc=function(X,ta){switch(ta){case -544558380:return!(this.tableManager&&this.va.zM()&&!this.P4a()&&Me.d(this.tableManager.Wg));case 1544516694:return!(this.tableManager&&
(this.va.zM()?!this.P4a():this.va.bLa()));case -697806646:case 323142015:return!this.va.zM();case 341449783:case 2128797448:return!(this.tableManager&&this.tableManager.Uod(this.va.activeCell));case -123538519:return!(this.va.zM()&&this.tableStyleManager&&this.tableStyleManager.Dgc());case 756677940:return!(me.EwaSettings.la(420)&&this.n8h());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.o8h());case 844144422:return!this.va.zM();case -723113214:return!(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",
!1)&&this.va.zM())}return!1};Ic.prototype.executeCommand=function(X,ta,tb){var Rb=this,Fc;X=Ff.TaskExtensions.om();var lc=this.$.qa.ta,Jd=null,he=1,Te=ta.command,yg=this.$.qa.ta.Xb(),Kg=null;switch(Te){case -2058042992:var Ug=ke.a.li(tb[Qf.a.Kg]);Ic.sUf(this.$,Ug);Jd=function(ej,gj,ig){return ya.a(lc,Ug,null,null,!1,!1,!1,Mh.a.Tua(Li.a.Ara,Oh.a.clearAutoFilter,ej),gj,ig,null)};he=176;Kg=function(){return new ka(Ug)};break;case 504133448:case -798968736:case 477776686:var ae=ke.a.li(tb[Qf.a.Kg]),Re=
tb.TopCellAddress;Ic.sUf(this.$,ae);var Ri=504133448===ta.command?1:-798968736===ta.command?2:3;if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&Re){tb=this.tableManager.eo(Re);if(!tb&&me.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var yj=this.$.xa.oa;(null===(Fc=dd.D(yj.h0))||void 0===Fc?0:Fc.contains(Re))?tb=dd.D(yj.h0):Jc.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!me.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
tb&&!this.$.bVc([tb],!0,1))break}else if(tb&&!this.$.xs([tb],!0,1))break}Jd=function(ej,gj,ig){return Ng.hb(lc,ae,Ri,Ef.b(ej,Rb.jLi),gj,ig,Re,yg)};he=177;Kg=function(){return new bb(ae,Ri)};break;case 341449783:case 2128797448:this.rQa=341449783===Te?0:2;Fc=this.toggleTableStyleOption(lc,yg);Jd=Fc.ccg;he=Fc.operationName;Kg=Fc.Wl;break;case -712419744:this.aw?this.b9e(tb[df.a.event]):this.b9e(null);break;case 1868184698:me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",
!1)?new ub.a(this.$):(Fc=new qa.a(this.$),Fc.initialize(),Fc.nf());break;case 844144422:new Pc(this.$);break;case 1544516694:case -544558380:if(Fc=tb[Qf.a.hd])this.rQa=this.KSh(Fc),-1!==this.rQa&&(Fc=this.toggleTableStyleOption(lc,yg),Jd=Fc.ccg,he=Fc.operationName,Kg=Fc.Wl);break;case 756677940:if(this.P4a()&&this.Fcf()){Jc.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}var fg=tb.Text,Dj=this.pLh();if(Dj){Jd=function(ej,gj,ig){return ya.i(lc,fg,Dj,Ef.b(ej,Rb.iLi),Ef.a(gj,Rb.hLi),ig,yg)};he=217;var tj=null;this.tableManager.Wg?tj=this.tableManager.Wg.name:this.tableManager.V9a?tj=this.tableManager.V9a.name:Jc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");tj&&(Kg=function(){return new rc(tj,fg)})}else return Jc.ULS.sendTraceTag(537151175,
0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),gg.Task.Ta(!1);break;case 323142015:if(this.P4a())break;return(new rb(this.$,this.Zad(),this.tableManager.Wg.name)).y9a();case -1400250766:he=211;Jd=this.i$i(tb,lc,yg);var Bh=dd.m(tb.OriginalTableRange,this.$.xa.oa);Kg=function(){return new pb(Bh)};break;case 1872288872:this.tableManager.FWi();break;case -123538519:var uh=this.JSh(tb);Fc=Tf.a.contains(tb[Qf.a.hd],df.a.DEb,!0)||Tf.a.contains(tb[df.a.bI],"TableStyleIcon",!0)?"Preview Gallery":
"Pop-out Gallery";Jc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",Fc,uh.toString());var Ph=this.u_e();Ph&&(Jd=function(ej,gj,ig){return ya.b(lc,Ph,uh,ej,gj,ig,null,yg)},Kg=function(){return new Nb(Ph,uh)},he=212);break;case 753331043:Fc=tb[Qf.a.hd];if(!Fc)break;var ah=Number.parseInvariant(Fc);if(this.va.zM()){Jc.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",
ah);var zj=this.u_e();zj&&(Jd=function(ej,gj,ig){return ya.g(lc,zj,!1,!1,!1,ah,ej,gj,ig,null,yg)},Kg=function(){return new E(zj,!1,ah,!1)},he=215)}else Jc.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",ah),me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new vd(this.$,Number.parseInvariant(Fc)):(Fc=new Tc(this.$,Number.parseInvariant(Fc)),Fc.initialize(),Fc.nf());break;case 71074531:var Rf=
tb.HasHeader,ti=tb.TableRange;Jd=function(ej,gj,ig){return ya.e(lc,ti,Rf,!1,!1,ej,gj,ig,null)};Kg=function(){return new Ge.a(Rf,ti)};he=206;break;case -723113214:new Zc(this.$);break;case 868579142:he=1022;var Zj=tb.Title,uj=tb.Description,lj=this.Zad();Jd=function(ej,gj,ig){return ya.f(lc,Zj,uj,lj,ej,gj,ig,null)};var Gh=null,fi=null;this.tableManager.Wg?(Gh=this.tableManager.Wg.TKb,fi=this.tableManager.Wg.UKb):this.tableManager.V9a?(Gh=this.tableManager.V9a.TKb,fi=this.tableManager.V9a.UKb):Jc.ULS.sendTraceTag(527054241,
0,15,"TableCommandHandler.TableAltTextDialog: current table object and previous selected table object both found to be null while fetching originalTitle during executing table alt text command");Gh&&fi&&(Kg=function(){return new vb(Gh,Zj,fi,uj)});break;default:return jf.a(Te)}if(Jd){var wi=function(ej){return new kf.a(he,0,ej,void 0,Kg)};X=!this.namedSheetViewPublic||-2058042992!==Te&&504133448!==Te&&-798968736!==Te&&477776686!==Te?cf.a(this.$.userOperationManager,Jd,wi,ta):this.namedSheetViewPublic.dAa().continueWith(function(ej){ej.result&&
cf.a(Rb.$.userOperationManager,Jd,wi,ta)})}return X};Ic.prototype.toggleTableStyleOption=function(X,ta){var tb=this,Rb=this.va.bLa();Jc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Rb?"PivotTable":"table",this.rQa);var Fc=this.Zad();return{ccg:function(lc,Jd,he){return ya.k(X,Fc,tb.rQa,Ef.b(lc,tb.RLi),Jd,he,null,ta)},operationName:196,Wl:function(){return new fb(Fc,tb.rQa,Rb)}}};Ic.prototype.i$i=function(X,ta,tb){function Rb(Te){Te.Errors&&lc.tableManager.h4f(Jd)}
function Fc(){lc.tableManager.h4f(Jd)}var lc=this,Jd=X.OriginalTableRange,he=dd.m(X.ResizeTableRange,this.$.xa.oa);return function(Te,yg,Kg){return ya.j(ta,he,Ef.b(Te,Rb),Ef.a(yg,Fc),Kg,null,tb)}};Ic.prototype.JSh=function(X){var ta=-1;X[Qf.a.hd]&&(ta=X[Qf.a.hd],ta=Tf.a.contains(ta,df.a.DEb,!0)?this.tableStyleManager.gub(ta):Number.parseInvariant(X[Qf.a.hd]));return ta};Ic.prototype.Gc=function(X,ta){X=!1;switch(ta.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:X=
!0;break;case 756677940:X=me.EwaSettings.la(420);break;case -723113214:case 868579142:X=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return X};Ic.prototype.fd=function(X,ta,tb){X=!1;switch(ta){case "PopulateTableMoreStylesMenu":this.menuId=tb.MenuId;this.tableStyleManager.Dgc()||this.tableStyleManager.XJa("formatAsTableMenu");X=this.tableStyleManager.YDf(ta,tb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=tb.MenuId,this.tableStyleManager.Dgc()||
this.tableStyleManager.XJa("accessibilityTab"),X=this.tableStyleManager.YDf(ta,tb)}return X};Ic.prototype.dispose=function(){this.tableStyleManager.T5i(this.hAf)};Ic.prototype.Cca=function(){(Tf.a.contains(this.menuId,"Format",!0)||Tf.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Aw(this.menuId)};Ic.prototype.Zad=function(){return dd.v(this.va.activeCell,this.$)};Ic.prototype.pLh=function(){var X=this.tableManager.dqd;return X?dd.v(X,this.$):null};Ic.prototype.b9e=function(X){if(this.tableManager){var ta=
lf.g(this.$),tb=this.va.activeCell,Rb=this.tableManager.eo(tb),Fc=null;if(!Rb||Rb.CRa)for(ta=yl(ta.J2),Rb=ta.next();!Rb.done;Rb=ta.next()){Rb=yl(Rb.value);for(var lc=Rb.next();!lc.done;lc=Rb.next()){lc=lc.value;var Jd=lc.No;tb.left>=Jd[0]&&tb.left<=Jd[Jd.length-1]&&(Fc=(lc=lc.Ds(tb).EJ())?rf.DOMElementExtensions.vj(lc,mf.a.Fme):null)}}else{var he=ta.sc(xc.Range.ld(Rb.top,tb.left));if(this.aw){Ld.a.instance.create(function(){he.invoke(8,X)},0,Od.a.$3f,!0,!0);return}Fc=he.GJa(56).y4a}Fc&&Ld.a.instance.create(function(){rf.DOMElementExtensions.Kdc(Fc,
null)},0,Od.a.$3f,!0,!0)}};Ic.prototype.KSh=function(X){X=Number.parseInvariant(X);return-1<X&&8>=X?X:-1};Ic.prototype.P4a=function(){return!this.tableManager.Wg};Ic.prototype.Fcf=function(){return this.tableManager.V9a?!1:(Jc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};Ic.prototype.o8h=function(){var X=this.va.zM(),ta=this.va.Dh&&!lf.g(this.$).Vb.S4(this.va.Qd);return X||ta};Ic.prototype.n8h=function(){return this.va.zM()||
!this.Fcf()};Ic.prototype.MSh=function(X){var ta=[];X=yl(X);for(var tb=X.next();!tb.done;tb=X.next())if(tb=Cd.b(this.$,tb.value),null===tb||void 0===tb?0:tb.length){tb=yl(tb);for(var Rb=tb.next();!Rb.done;Rb=tb.next())Rb=Rb.value,Rb.usedRange&&!Array.contains(ta,Rb.usedRange)&&Array.add(ta,Rb.usedRange)}return ta};Ic.prototype.u_e=function(){var X=this.va.selectedRanges,ta=[];if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ta=this.MSh(X);else{X=
yl(X);for(var tb=X.next();!tb.done;tb=X.next())tb=tb.value,lf.g(this.$).Vb.S4(tb)&&Array.add(ta,tb)}return ta&&ta.length?dd.r(ta,this.$):null};Ic.prototype.ZK=function(X){me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(ta){ta.result.Pda(X);Jc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};Ic.prototype.Qji=
function(X){var ta=this;Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(this.$.da,446,447,0),function(tb){tb.result.t5g(ta.$,X)},this.$.ma,3)};Ic.sUf=function(X,ta){ta.SheetName=X.oa.name;ta.NamedObjectView=X.fa.isNamedObjectViewMode};Object(sc.a)(Ic,"TableCommandHandler",null,[147]);var Rg=jd.a;vm(Eb,Rg);Eb.prototype.dispose=function(){Rg.prototype.dispose.call(this)};Eb.prototype.Md=function(){var X=this,ta=jg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb),tb=jg.GetServiceTaskFactory.create(this.$.da,
330,this.ma,this.tb),Rb=jg.GetServiceTaskFactory.Xa(this.$.da,309,310,this.tb);Ff.TaskExtensions.Ba(gg.Task.WAA(ta,Rb,tb),function(){X.Ed([new Ic(X.$,ta.result,Rb.result,tb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ma,3)};Eb.ja=function(X){jd.a.de(86,new Eb(X))};Object(sc.a)(Eb,"TableCommandHandlerFactory",jd.a,[]);Mb.prototype.Xc=function(){return!1};Mb.prototype.executeCommand=function(X,ta){X=ta.command;ta=null;switch(X){case 1243860697:this.zdh.RCj();
break;default:ta=jf.a(X)}return ta||gg.Task.Ta(!0)};Mb.prototype.Gc=function(X,ta){return 1243860697===ta.command};Mb.prototype.fd=function(){return!1};Object(sc.a)(Mb,"SheetDropdownMenuCommandHandler",null,[147]);var $h=jd.a;vm(wb,$h);wb.prototype.Md=function(){var X=this;this.$.rE(function(ta){ta.vjd().then(function(){Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(X.$.da,32,33,X.tb),function(tb){X.Ed([new Mb(tb.result.Onj)])},X.$.ma)})})};wb.ja=function(X){jd.a.de(392,new wb(X))};Object(sc.a)(wb,
"SheetDropdownMenuCommandHandlerFactory",jd.a,[]);var gi=b(73),Ae=b(41),Xh=b(207),qi=b(40),h=b(117),Ab=b(32);Ja.prototype.TFg=function(X,ta){this.tFe.add(X,ta);this.G0()};Ja.prototype.G0=function(){var X=this;this.FFc=0;Ab.a.forEach(this.tFe.Nu,function(ta){X.FFc=X.b5c|ta.value})};tl.Object.defineProperties(Ja.prototype,{b5c:{configurable:!0,enumerable:!0,get:function(){return this.FFc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.b5c&1)}},operationButtonsDisabled:{configurable:!0,
enumerable:!0,get:function(){return!!(this.b5c&2)}}});Object(sc.a)(Ja,"SheetTabBarDisabledStateManager",null,[]);Lb.$mh="ewa-stb-uir";Lb.jLe="ewa-stb-drag";Lb.Kmh="ewa-stb-navarea";Lb.Lmh="ewa-stb-navarea-dimensions";Lb.Nmh="ewa-stb-navbutton";Lb.AY="cui-disabled";Lb.Iha="cui-img-container";Lb.Mmh="ewa-stb-navareaextra";Lb.Hmh="ewa-stb-contentarea";Lb.kLe="ewa-stb-left-scrollable";Lb.vLe="ewa-stb-right-scrollable";Lb.Ymh="ewa-stb-tabarea";Lb.Xmh="ewa-stb-sheettabmoveindicator";Lb.xLe="ewa-stb-tabs";
Lb.Nzj="tab-active";Lb.Uzj="tab-inactive";Lb.Tzj="tab-hover";Lb.Zmh="ewa-stb-tabs-ghost";Lb.Pzj="tab-anchor-text";Lb.dark="dark";Lb.light="light";Lb.Ozj="tab-active-text";Lb.Rzj="tab-content-container";Lb.Wzj="tab-text";Lb.Qmh="ewa-stb-nsv-inactive";Lb.Rmh="ewa-stb-nsv-inactive-svg";Lb.Omh="ewa-stb-nsv-active";Lb.Pmh="ewa-stb-nsv-active-svg";Lb.Vlh="ewa_nsv_margin";Lb.Imh="ewa-stb-disable-scrollbar";Lb.bki="leave-size-fixed-on-tab-hover-old";Lb.aki="leave-size-fixed-on-tab-hover";Lb.oLe="ewa-stb-locked-sheet";
Lb.pLe="ewa-stb-locked-sheet-svg";Lb.Jmh="ewa-stb-dropdown-menu-button";Lb.cih="ewa-active-sheet-menu-item";Object(sc.a)(Lb,"CssClassNames",null,[]);var jc=b(520),Oc=b(16),sd=b(256),we=b(96),Ue=b(519),qe=b(279),ja=b(459),Ka=b(95),qc=b(339),mc=b(211),Ed=b(370),pc=b(366),K=b(276),ha=b(91),H=xf.a;vm(Ra,H);Ra.prototype.dispose=function(){this.N9a=this.Kra=this.$=null;H.prototype.dispose.call(this)};Ra.prototype.RW=function(X){this.sX=X;this.domElement.setAttribute(df.a.tra,X.toString());rf.DOMElementExtensions.toggleCssClass(this.domElement,
jc.a.AY,X)};tl.Object.defineProperties(Ra.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.sX}}});Object(sc.a)(Ra,"SheetBarButton",xf.a,[]);var aa=b(836);vm(Sa,Ra);Sa.prototype.dispose=function(){K.a.instance.za(wf.a.click,this.domElement,this.Vc);h.KeyInputManager.instance.jv(this.domElement,this.azb);me.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&lf.g(this.$)&&lf.g(this.$).rc&&(lf.g(this.$).rc.im(this.Mj),lf.g(this.$).rc.Rp(this.Rh));
Ra.prototype.dispose.call(this)};Sa.prototype.RW=function(X){var ta=Sa.TYf(this.$);Ra.prototype.RW.call(this,X||ta)};Sa.TYf=function(X){return!X.isEditMode||!X.xa.count};Object(sc.a)(Sa,"InsertSheetButton",Ra,[]);vm(Da,Ra);Da.prototype.dispose=function(){K.a.instance.za(wf.a.click,this.domElement,this.Vc);h.KeyInputManager.instance.jv(this.domElement,this.azb);this.Ase=null;Ra.prototype.dispose.call(this)};Object(sc.a)(Da,"InsertTemplateButton",Ra,[]);Tb.prototype.getSheetName=function(){return this.sheetName};
Object(sc.a)(Tb,"MacroRecorderSheetReorderedPayload",null,[98]);var ea=xf.a;vm(sb,ea);sb.prototype.dispose=function(){this.mm();ea.prototype.dispose.call(this)};sb.prototype.RCj=function(){this.JNf(!0,"TogglerSheetDropdownMenu")};sb.prototype.JNf=function(X,ta){Jc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",ta,X,this.zLb);X&&(this.zLb+=1);var tb=this.$.Ub.Fc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",
ta,X,this.zLb,this.$.xa.count));X=this.i5g();appChrome.renderSheetDropdownMenu(this.domElement,this.tAj,X,this.zLb,this.YBi,this.XBi,function(){tb.stop()},Ed.a(this.$))};sb.prototype.i5g=function(){for(var X=this.$.xa,ta=[],tb=0;tb<X.count;tb++){var Rb=Object(pe.a)(Ka.a,X.getItem(tb));Rb.ey||(Rb=this.h5g(Rb),ta.push(Rb))}return ta};sb.prototype.h5g=function(X){var ta={};ta.key=X.name;ta.text=X.name;ta.onClick=this.j5g(X);X.active&&(ta.className=Ed.a(this.$)?"ewa-active-sheet-menu-item-present-mode":
Lb.cih);return ta};sb.prototype.j5g=function(X){var ta=this;return function(){var tb=new mh.a(-1876836819,0,ta.$.ed,30,null),Rb={};ta.$.Ka.Zb(tb,(Rb[df.a.MNd]=X.name,Rb))}};sb.prototype.ak=function(){if(!this.Cta){var X=this.$.xa;X.Pf(this.cR);X.DXb(this.cR);X.YX(this.cR);X.pga(this.cR);X.bFa(this.cR);X.Yke(this.cR);X.EXa(this.cR);this.Cta=!0}};sb.prototype.mm=function(){if(this.Cta){var X=this.$.xa;X.rg(this.cR);X.Bqc(this.cR);X.w6(this.cR);X.dma(this.cR);X.APa(this.cR);X.CMf(this.cR);X.iGb(this.cR);
this.Cta=!1}};Object(sc.a)(sb,"SheetDropdownMenu",xf.a,[855,3]);var ab=b(350);vm(sa,Ra);sa.prototype.dispose=function(){this.hHj();Ra.prototype.dispose.call(this)};sa.prototype.RW=function(X){Ra.prototype.RW.call(this,X||!this.$.fa.Rva)};sa.prototype.Y5f=function(X){this.disabled||(Jc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",ab.a[X]),this.$.Ka.Zb(new mh.a(1243860697,X,this.$.ed,30,null)))};sa.prototype.t0i=function(){K.a.instance.pa(wf.a.click,this.domElement,
this.Vc);h.KeyInputManager.instance.pa(wf.a.Rb,this.domElement,this.onKeyDown)};sa.prototype.hHj=function(){K.a.instance.za(wf.a.click,this.domElement,this.Vc);h.KeyInputManager.instance.za(wf.a.Rb,this.domElement,this.onKeyDown)};Object(sc.a)(sa,"SheetDropdownMenuAnchor",Ra,[]);var Vb=b(187),gc=b(135),$c=b(57),Zd=b(217),oe=b(160);va.prototype.pH=function(){return this.sheet.active};va.prototype.vmd=function(){return this.sheet.isLockPausedInSession};va.prototype.Wra=function(){return this.gm?Oc.a.nLe:
this.pH()?Oc.a.mLe:Oc.a.lLe};va.prototype.vna=function(){return this.sheet.ik?aa.a.sGf:aa.a.UGj};va.prototype.SRd=function(){return 13};va.prototype.URd=function(){return 12};va.prototype.hha=function(){return null};va.prototype.Xra=function(){return this.gm?this.cw?Lb.pLe:Lb.oLe:null};va.prototype.uTd=function(){return null};va.prototype.yw=function(){return null};va.prototype.Pid=function(){return 0};va.prototype.HUc=function(){return!0};Object(sc.a)(va,"LockPausedSheetIconDataSource",null,[865]);
wa.prototype.pH=function(){return this.sheet.active};wa.prototype.vmd=function(){return this.sheet.ik};wa.prototype.Wra=function(){return this.gm?Oc.a.nLe:this.pH()?Oc.a.mLe:Oc.a.lLe};wa.prototype.vna=function(){return aa.a.sGf};wa.prototype.SRd=function(){return 13};wa.prototype.URd=function(){return 12};wa.prototype.hha=function(){return null};wa.prototype.Xra=function(){return this.gm?this.cw?Lb.pLe:Lb.oLe:null};wa.prototype.uTd=function(){return null};wa.prototype.yw=function(){return null};wa.prototype.Pid=
function(){return 0};wa.prototype.HUc=function(){return!0};Object(sc.a)(wa,"LockedSheetIconDataSource",null,[865]);Fb.prototype.pH=function(){return this.sheet.active};Fb.prototype.vmd=function(){return this.sheet.ye.sC};Fb.prototype.hha=function(){return this.cw?this.pH()?Lb.Pmh:Lb.Rmh:this.pH()?Lb.Omh:Lb.Qmh};Fb.prototype.Wra=function(){return!this.pH()&&this.OZf()?Oc.a.Foh:Oc.a.Eoh};Fb.prototype.vna=function(){return!this.pH()&&this.OZf()?aa.a.Xnj:aa.a.Wnj};Fb.prototype.SRd=function(){return 14};
Fb.prototype.URd=function(){return 16};Fb.prototype.Xra=function(){return Lb.Vlh};Fb.prototype.uTd=function(){return this.sheet.ye.Hlb};Fb.prototype.yw=function(){return this.fDj};Fb.prototype.Pid=function(){return 8};Fb.prototype.HUc=function(){return!1};Object(sc.a)(Fb,"NamedSeetViewSheetIconDataSource",null,[865]);Sb.prototype.f$f=function(){if(this.cI&&(this.Wj||this.sAa)){if(this.cw){var X=this.dataSource.vna();this.vna!==X&&(this.sAa&&this.sAa.parentNode.removeChild(this.sAa),this.s8e(),this.vna=
X)}else X=this.dataSource.Wra(),this.Wra!==X&&(this.FHd(this.Wj,this.Wra,X),this.Wra=X);X=this.dataSource.hha();this.hha!==X&&(this.cw?this.o7i(this.sAa,this.hha,X):this.FHd(this.Wj,this.hha,X),this.hha=X);X=this.dataSource.Xra();this.Xra!==X&&(this.FHd(this.cI,this.Xra,X),this.Xra=X);this.dataSource.yw()&&!this.dataSource.pH()&&this.clearToolTip()}};Sb.prototype.tsj=function(X,ta,tb){this.u5h(X,ta,tb);rf.DOMElementExtensions.setVisible(this.cI,this.dataSource.vmd())};Sb.prototype.clearToolTip=function(){var X=
this;Ff.TaskExtensions.Ba(this.Yzb,function(){dialogControls.clearToolTip(X.dataSource.yw())},this.$.ma,3)};Sb.prototype.u5h=function(X,ta,tb){this.cI&&this.Ecf!==X&&(this.cI.parentNode.removeChild(this.cI),this.Xra=this.hha=this.vna=this.Wra=this.uPc=null,this.dataSource.yw()&&(this.wc.detach("mouseover",!0),this.wc.detach("mouseout",!0)));this.cI||(this.uPc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.cI,jc.a.Iha),Sys.UI.DomElement.addCssClass(this.cI,Oc.a.OB),me.EwaSettings.la(524)?
X===this.dataSource.HUc()?ta.appendChild(this.cI):ta.insertBefore(this.cI,tb):X?ta.insertBefore(this.cI,tb):ta.appendChild(this.cI),this.cw?this.s8e():(this.Wj=document.createElement("img"),this.Wj.tabIndex=-1,this.Wj.alt=this.dataSource.altText,this.cI.appendChild(this.Wj),this.Wj.src=Ea.a.Be(this.dataSource.Pid())),this.dataSource.yw()&&(this.wc.ja("mouseover",this.ZE,!0),this.wc.ja("mouseout",this.HH,!0)),this.Ecf=X)};Sb.prototype.o7i=function(X,ta,tb){X&&(Sys.UI.DomElement.removeCssClass(X,ta),
Sys.UI.DomElement.addCssClass(X,tb))};Sb.prototype.FHd=function(X,ta,tb){ta&&Sys.UI.DomElement.removeCssClass(X,ta);tb&&Sys.UI.DomElement.addCssClass(X,tb)};Sb.prototype.dispose=function(){Df.a.Fa(this.g1)};Sb.prototype.s8e=function(){var X=this.$.da.Aa(388);X?(this.sAa=X.Uua(this.dataSource.vna(),this.dataSource.SRd(),this.dataSource.URd()))?this.cI.appendChild(this.sAa):Jc.ULS.shipAssertTag(537153763,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.vna()):Jc.ULS.shipAssertTag(537153792,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};tl.Object.defineProperties(Sb.prototype,{wc:{configurable:!0,enumerable:!0,get:function(){return this.g1||(this.g1=se.a.instance.Cd(this.cI))}},Yzb:{configurable:!0,enumerable:!0,get:function(){var X=this;if(this.Lpa)return this.Lpa;var ta=new Be.a;this.$.rE(function(tb){Ff.TaskExtensions.Ba(tb.yrd(),function(){ta.setResult(!0)},X.$.ma,3)});return this.Lpa=ta.task}},cI:{configurable:!0,enumerable:!0,get:function(){return this.uPc}}});
Object(sc.a)(Sb,"SheetIcon",null,[3]);var Ee=b(348),pf=b(147),Le=pg.a;vm(Gb,Le);Gb.prototype.dispose=function(){this.$ma&&(K.a.instance.za(wf.a.Ij,this.$ma.domElement,this.Nba),Ee.a.instance.za(this.$ma.domElement,this.Zk),this.gee=null);this.$=null;Le.prototype.dispose.call(this)};Gb.prototype.showContextMenu=function(X,ta,tb){this.$ma.activate(ta,Ae.a.Sod());ta=new mh.a(-1075099431,ta,this.$.ed,30,null);var Rb,Fc={};return!pf.a(Rb=this.$.Ka.Zb(ta,(Fc[df.a.nYf]=X,Fc[Gb.Pnj]=this.$ma.sheet,Fc[df.a.oYf]=
tb,Fc)))&&(6!==Rb.status||Rb.result)};Gb.prototype.rename=function(X,ta){this.$.Ce(817296323,ta,X?19:0,null)};tl.Object.defineProperties(Gb.prototype,{$ma:{configurable:!0,enumerable:!0,get:function(){return this.gee}}});Gb.Pnj="Sheet";Object(sc.a)(Gb,"SheetOpsSheetClickHelper",pg.a,[]);vm(hb,Ra);hb.prototype.kJh=function(){return rf.DOMElementExtensions.canReceiveFocus(this.anchor)?this.anchor:null};hb.prototype.dispose=function(){if(this.Cta){Fd.a.instance.za(wf.a.pointerDown,this.domElement,this.onPointerDown);
h.KeyInputManager.instance.za(wf.a.Rb,this.domElement,this.onKeyDown);h.KeyInputManager.instance.za(wf.a.Ro,this.domElement,this.jz);K.a.instance.za(wf.a.click,this.domElement,this.Vc);Fd.a.instance.za(wf.a.VV,this.domElement,this.B8a);Fd.a.instance.za(wf.a.nz,this.domElement,this.Lyd);if(this.K5a||me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))Fd.a.instance.za(wf.a.Wd,this.domElement,this.Zg),this.owa&&(vf.a.instance.za(wf.a.De,this.domElement,this.Zg),
vf.a.instance.za(wf.a.Ig,this.domElement,this.lN));this.Cta=!1;this.M3b="#BEBBB8"}Df.a.pc([this.ywe,this.Fre]);this.eO=this.RD=this.QCc=this.GR=this.Fre=this.ywe=null;if(this.Xma){for(var X=yl(this.Xma),ta=X.next();!ta.done;ta=X.next())ta.value.dispose();this.Xma=null}this.color=this.PUb=null;Ra.prototype.dispose.call(this)};hb.prototype.RW=function(X){X&&this.Rma(!1,!1);Ra.prototype.RW.call(this,X)};hb.prototype.rPd=function(X){if($c.a.Qf.nH){this.BFe();var ta=jg.GetServiceTaskFactory.Xa(this.$.da,
322,323,1);Ff.TaskExtensions.Ba(ta,function(tb){Vb.UISurfaces.pM().then(function(Rb){var Fc=tb.result;Fc.Ojj(Rb);Fc.show(X);return null},function(Rb){Jc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Rb);return null})},this.ma,3)}};hb.prototype.Kje=function(){var X=this;if(this.sheet.active&&this.$.Oq){var ta=this.$.Oq,tb=lf.g(this.$),Rb=tb.CM;if(this.sheet.ye.sC){if(!this.aBb){var Fc=new Fb(this.sheet,this.GR.Suc,function(){return X.color?
hb.QOd(X.color):!1},this.cw);this.aBb=new Sb(this.$,Fc);this.Xma.add(this.aBb)}Rb?tb.Wdb(1):ta.classList.add(Oc.a.x8c);ta=hb.Edd(df.a.Mnf);tb=hb.Edd(df.a.bvd);Rb=hb.Edd(df.a.Dnf);Fc=this.sheet.ye.BOd;this.sheet.ye.BOd=!1;"true"===Rb&&Fc&&this.$.fa.EOd?(gc.a.vw(df.a.Dnf,"false",gc.a.a_),this.$.fa.EOd=!1,this.rPd(3)):"true"===ta&&"true"===tb&&"true"===Rb?this.$.fa.FOd&&this.$.fa.vJb&&(this.sheet.ye.pV?(ta=1,gc.a.vw(df.a.bvd,"false",gc.a.a_),this.$.fa.vJb=!1):ta=0,gc.a.vw(df.a.Mnf,"false",gc.a.a_),this.$.fa.FOd=
!1,this.rPd(ta)):this.sheet.ye.pV&&"true"===tb&&"true"===Rb&&this.$.fa.vJb&&(gc.a.vw(df.a.bvd,"false",gc.a.a_),this.$.fa.vJb=!1,this.rPd(2))}else this.BFe(),Rb?tb.Wdb(0):ta.classList.remove(Oc.a.x8c)}};hb.prototype.BFe=function(){if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var X=this.$.da.Aa(322);X&&X.dismiss()}else this.$.zod&&(X=jg.GetServiceTaskFactory.Xa(this.$.da,322,323,0),Ff.TaskExtensions.Ba(X,function(ta){ta.result.dismiss()},this.$.ma,3))};hb.prototype.deb=function(){this.name=
this.sheet.name;this.domElement.className=this.sheet.active||this.x5a()?Lb.Nzj:Lb.Uzj;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.eO.parentNode.classList.add(Lb.aki):this.eO.parentNode.classList.add(Lb.bki);this.Y$f();this.tld&&this.Kje();this.usj();this.dag();this.qzc();this.tld||this.Kje()};hb.prototype.uKi=function(){this.KNd=!0;this.Rma(!0,!0,"OnSheetReorderStarted")};hb.prototype.tKi=function(){this.KNd=!1;this.Rma(!1,void 0,"OnSheetReorderEnded")};hb.prototype.activate=
function(X,ta){X=void 0===X?0:X;ta=void 0===ta?!1:ta;this.D0b()||(this.sheet.activate(),ta&&lf.g(this.$).focus(),ta={},X=(ta.InputMethod=ab.a[X],ta.AppMode=this.$.ed,ta.Location="canvas",ta),ld.b(this.$).ae(Fg.a.Lnj,X))};hb.prototype.X$f=function(X){this.M3b=X?"#797775":"#BEBBB8";this.h3c=X?-.5:.5;this.sFc=X?Zd.a.Gp("#3B3A39"):Zd.a.Gp("#F5F5F5");this.dag()};hb.prototype.Qgj=function(X){this.K5a=X};hb.prototype.Cxd=function(X){X.u0c();this.Rue(X)};hb.prototype.Rue=function(X){X.d_a();this.sheet.activate()};
hb.prototype.cvg=function(X){X=new mh.a(-1876836819,X,this.$.ed,30,null);var ta={};return this.$.Ka.Zb(X,(ta[df.a.MNd]=this.sheet.name,ta))};hb.prototype.Y$f=function(){this.eO.parentNode.setAttribute("sheet-title",this.eO.innerText)};hb.prototype.qzc=function(){var X=this.$Ch();this.anchor.setAttribute(df.a.Bv,X);this.anchor.setAttribute(df.a.Dga,this.sheet.active.toString())};hb.prototype.$Ch=function(){var X=this.sheet.ye.sC,ta=this.sheet.ye.Hlb,tb=this.sheet.ik,Rb=this.sheet.isLockPausedInSession;
return X&&tb?String.format(Ve.a.instance.Cb(20),this.name,ta):X&&Rb?String.format(Ve.a.instance.Cb(22),this.name,ta):X?String.format(Ve.a.instance.Cb(19),this.name,ta):tb?String.format(Ve.a.instance.Cb(18),this.name):Rb?String.format(Ve.a.instance.Cb(21),this.name):this.name};hb.prototype.activateSheet=function(X){X=void 0===X?0:X;if(Ae.a.Sod()){if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.D0b())return gg.Task.Ta(!1);oe.a.current.zR="ActivateSheet";
this.sheet.activate();return gg.Task.Ta(!0)}return this.cvg(X)};hb.prototype.dag=function(){var X=this.sheet.tabColor;this.color=X?Zd.a.Gp(X):this.U8g;this.wbf=hb.QOd(this.color);this.Rma(!1,void 0,"UpdateTabColor")};hb.prototype.Rma=function(X,ta,tb){ta=void 0===ta?!1:ta;tb=void 0===tb?null:tb;if(this.sheet){tb=this.sheet.active;var Rb=this.x5a(),Fc=!!this.sheet.tabColor,lc=Zd.a.zF(tb||Rb?ei.a.white:this.color);this.RD.style.background="";tb||Rb?(Fc?me.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&
this.$.zKa?this.Jlj():this.gm?this.Ilj():this.Hlj():this.gm||(this.RD.style.backgroundColor=lc),this.RD.style.height=this.F_c.toString()+"px"):(this.RD.style.filter="",this.RD.style.backgroundColor=lc,this.RD.style.height=this.G_c.toString()+"px");this.eO.className=tb?Lb.Ozj:Rb?Lb.dark:this.wbf?Lb.light:Lb.dark;lc=yl(this.Xma);for(var Jd=lc.next();!Jd.done;Jd=lc.next())Jd.value.f$f();this.gm&&(X&&!Fc&&(this.RD.style.backgroundColor="#E1DFDD"),rf.DOMElementExtensions.toggleCssClass(this.domElement,
Lb.Tzj,X),ta?(Fc||(this.RD.style.backgroundColor=this.M3b),this.domElement.style.backgroundColor=this.M3b):(Fc||(this.RD.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.eO.style.fontWeight=tb||Rb||!this.gm&&X?this.gm?"600":"bold":""}else Jc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",tb)};hb.prototype.Ilj=function(){var X=this.RD.style,ta=Zd.a.zF(hb.PYc(this.color,
this.h3c));X.background=ta};hb.prototype.Hlj=function(){var X=this.RD.style,ta=Zd.a.zF(hb.PYc(this.color,1)),tb=Zd.a.zF(hb.PYc(this.color,this.h3c)),Rb="";if(dg.a.uka)Rb="-webkit-";else if(dg.a.zf)Rb="-moz-";else if(dg.a.Af){if(Rb="-ms-",!dg.a.l5a){X.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",ta,tb);return}}else dg.a.hcf&&(Rb="-o-");X.background=String.format("{0}linear-gradient({1}, {2})",Rb,ta,tb)};hb.prototype.Jlj=function(){this.RD.style.background=
"transparent"};hb.prototype.t_g=function(){this.QCc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Lb.Pzj;rf.DOMElementExtensions.ro(this.anchor,df.a.enb,null,null);this.tabIndex=-1};hb.prototype.u5g=function(){this.RD=document.createElement("span");this.RD.className=Lb.Rzj;this.eO=document.createElement("span");this.eO.className=Lb.Wzj;this.eO.dir=this.sheet.rtlName?"rtl":"ltr";this.RD.appendChild(this.eO)};hb.prototype.usj=function(){for(var X=this.$.XI,ta=
yl(this.Xma),tb=ta.next();!tb.done;tb=ta.next())tb.value.tsj(X,this.RD,this.eO)};hb.prototype.x5a=function(){return lf.g(this.$).x5a(this.sheet)};hb.prototype.$wj=function(){this.lid.start();this.umd=!0};hb.prototype.uIe=function(X){if(this.umd){this.lid.stop();var ta={};X=(ta["Sheet index"]=this.sheet.index,ta["Active Sheet"]=this.sheet.active,ta["Hovering time"]=this.lid.Ac,ta["Has been clicked"]=X,ta);Jc.ULS.sendTraceTag(537153686,0,50,kc.c(X));this.umd=!1}};hb.prototype.D1i=function(){Fd.a.instance.pa(wf.a.pointerDown,
this.domElement,this.onPointerDown);h.KeyInputManager.instance.pa(wf.a.Rb,this.domElement,this.onKeyDown);h.KeyInputManager.instance.pa(wf.a.Ro,this.domElement,this.jz);this.wc.ja("mouseover",this.ZE);this.wc.ja("mouseout",this.HH);Fd.a.instance.pa(wf.a.VV,this.domElement,this.B8a);Fd.a.instance.pa(wf.a.nz,this.domElement,this.Lyd);if(this.K5a||me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))Fd.a.instance.pa(wf.a.Wd,this.domElement,this.Zg),this.owa&&
(vf.a.instance.pa(wf.a.De,this.domElement,this.Zg),vf.a.instance.pa(wf.a.Ig,this.domElement,this.lN));K.a.instance.pa(wf.a.click,this.domElement,this.Vc);this.Cta=!0};hb.prototype.D0b=function(){var X=this.$.da.Aa(65);return X&&X.Oaa()?(X.uHb(),this.Rue(X),!0):!1};hb.Edd=function(X){var ta=gc.a.get(X);ta||(gc.a.vw(X,"true",gc.a.a_),ta=gc.a.get(X));return ta};hb.PYc=function(X,ta){if(1<ta||-1>ta)return X;var tb=X.r,Rb=X.g;X=X.b;0<ta?(tb=tb*(1-ta)+255*ta,Rb=Rb*(1-ta)+255*ta,X=X*(1-ta)+255*ta):(tb*=
1+ta,Rb*=1+ta,X*=1+ta);return ei.a.dtb(Math.round(tb),Math.round(Rb),Math.round(X))};hb.QOd=function(X){return 128>=(222*X.r+707*X.g+71*X.b)/1E3};tl.Object.defineProperties(hb.prototype,{U8g:{configurable:!0,enumerable:!0,get:function(){return this.sFc||(this.sFc=Zd.a.Gp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.eO.innerText},set:function(X){this.eO&&(this.eO.innerText=X,this.qzc(),this.Y$f())}},sheet:{configurable:!0,enumerable:!0,get:function(){return this.PUb}},
anchor:{configurable:!0,enumerable:!0,get:function(){return this.QCc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(X){this.anchor.tabIndex=X}}});Object(sc.a)(hb,"SheetTabButton",Ra,[]);vm(za,Ra);Object(sc.a)(za,"WorkbookProtectionButton",Ra,[]);var ng=b(48),eg=b(46),eh=b(53),Yg=xf.a;vm(da,Yg);da.prototype.yb=function(X,ta,tb,Rb,Fc,lc,Jd){Jd=void 0===Jd?!1:Jd;X.removeAttribute("Href");X.setAttribute(df.a.Sd,df.a.zr);X.className=Lb.Nmh;X.title=ta;
X.tabIndex=0;this.cw&&lc?tb=this.svgIconProvider.Haa(lc,12,12,X,24,24):(ta=document.createElement("span"),ta.className=this.gm?Oc.a.uUg:Oc.a.OB,ta.classList.add(jc.a.Iha),ta.tabIndex=-1,X.appendChild(ta),lc=document.createElement("img"),lc.src=Ea.a.Be(tb),lc.className=Rb,lc.alt=Fc,lc.tabIndex=-1,ta.appendChild(lc),tb=lc);Jd&&X.classList.add(jc.a.AY);return tb};da.prototype.dispose=function(){if(this.$){var X=this.$.xa;X.rg(this.Yh);X.Bqc(this.K5);X.w6(this.AC);X.dma(this.ZCb);X.APa(this.aya);X.CMf(this.zzf);
X.iGb(this.Bzf);X.S4i(this.Azf);X.RGd(this.kqf);X.zMf(this.lqf);X.AMf(this.mqf);X.BMf(this.UNa);this.$.ml(this.od);this.$.RC(this.aj);Lg.a(this.$)&&Lg.a(this.$).pg.ema(this.$E);this.Ysa&&lf.g(this.$).dMf(this.XBb);Xh.a.instance.za(wf.a.wC,this.domElement,this.P5)}Df.a.pc(this.lvd);this.lvd=null;if(this.lK)for(X=0;X<this.lK.length;X++){var ta=rf.DOMElementExtensions.EJ(this.lK[X],this.domElement,!1,"a");ta&&qi.a.ama(ta)}Df.a.Fa(this.IB);Df.a.Fa(this.Xuc);Df.a.Fa(this.PNd);this.PNd=this.Xuc=this.Pwb=
this.$G=this.IB=null;this.$&&this.Zy&&this.YP(!1);this.v$=null;this.VLd(null,"Dispose");this.OKb=this.bM=this.F5b=null;this.RZc();this.Pbb=this.Yuc=this.QNd=this.Ok=this.lK=this.$=this.fa=null;Yg.prototype.dispose.call(this)};da.prototype.Qe=function(X,ta){if(!ta){Jc.ULS.shipAssertTag(537153760,0,0<this.qh.length,"There is no sheet tab button.");if(!this.qh.length)return!1;X=null;for(var tb=yl(this.qh),Rb=tb.next();!Rb.done&&!(X=Rb.value.kJh());Rb=tb.next());if(!X)return Jc.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;rf.DOMElementExtensions.setFocus(X)}return!ta};da.prototype.Ah=function(X){return rf.DOMElementExtensions.Ye(this.Jb,X)};da.prototype.ji=function(){};da.prototype.Vh=function(){};da.prototype.reorderSheets=function(X,ta,tb){if(this.d_&&this.d_!==X){var Rb=this.d_.index;this.b7i(this.d_,X,ta);X=X?X.index-1:ta?this.$.xa.count-1:0;Rb!==X&&(this.coi(Rb,X,tb),this.zgh(this.d_.name,X))}};da.prototype.zUh=function(X){X=this.uia(X);return-1!==X&&this.zu<=X&&X<=
this.ZJ?this.qh[X].domElement:null};da.prototype.jLj=function(X){if(this.cw){for(var ta=0;ta<this.lK.length;ta++){var tb=this.lK[ta];if(tb&&this.svgIconProvider){var Rb=tb.parentNode;this.HLf(tb);Rb&&(this.lK[ta]=this.svgIconProvider.Haa(X?this.REf[ta]:this.mvd[ta],12,12,Rb,24,24))}}for(ta=0;ta<this.qh.length;ta++)this.qh[ta].X$f(X);this.YQa&&this.YQa.Kra&&this.W$f(aa.a.oWh,this.YQa,X);this.$G&&this.$G.Kra&&this.W$f(aa.a.BWg,this.$G,X)}};da.prototype.W$f=function(X,ta,tb){ta.N9a||(ta.N9a=this.svgIconProvider.Haa(X,
12,12,ta.Kra.parentNode,24,24));ta.N9a&&(rf.DOMElementExtensions.setVisible(ta.Kra,!tb),rf.DOMElementExtensions.setVisible(ta.N9a,tb))};da.prototype.yKi=function(X,ta){var tb=lf.g(this.$),Rb=tb.inRangePicker,Fc=td.HelperMethods.Am(ta);if(tb.isEditing&&!Rb){var lc=tb.xj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";me.EwaSettings.k5a()&&(lc=mc.a(lc,tb.rc.textBox.yAa));mc.b(this.$).Jna(Fc.rawEvent,lc);tb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}tb=this.owa&&3===ta.zb;(2!==
ta.zb||Fc.button)&&!tb||Rb||this.JE||Lg.a(this.$).sq()||(tb&&X.uKi(),this.hzb=ta.clientPoint.x,this.DY=ta,this.vJg(X))};da.prototype.wKi=function(X){!this.Zy&&this.JE&&this.CPd(X.sheet,!1)};da.prototype.xKi=function(X){this.Zy||(this.JE&&this.reorderSheets(X.sheet,!1,!0),this.YP());this.G_()};da.prototype.Ume=function(){return this.$.isEditMode&&!we.k(this.$.kg)};da.prototype.G_=function(){var X=this,ta=td.HelperMethods.Ska(function(){X.mJj();X.gm&&X.jlj();X.vMd()});Jc.ULS.sendTraceTag(537153757,
0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",ta)};da.prototype.jlj=function(){var X=this.ZJ===this.qh.length-1;rf.DOMElementExtensions.toggleCssClass(this.Pbb,this.$.XI?Lb.vLe:Lb.kLe,!!this.zu);rf.DOMElementExtensions.toggleCssClass(this.Pbb,this.$.XI?Lb.kLe:Lb.vLe,!X)};da.prototype.vMd=function(X){X=void 0===X?!1:X;var ta=!this.zu,tb=this.ZJ===this.qh.length-1;this.fWf(4,this.sheetTabActivatePreviousHidden,!ta);this.fWf(5,this.sheetTabActivateNextHidden,!tb);this.tuc(0,
ta||X);this.tuc(1,ta||X);this.tuc(2,tb||X);this.tuc(3,tb||X)};da.prototype.fWf=function(X,ta,tb){if(X=this.lK[X]){rf.DOMElementExtensions.setVisible(X,tb);var Rb=this.sYe(X);Rb.title="img"===X.nodeName?X.alt=0<this.qh.length&&tb?ta:"":X.title=0<this.qh.length&&tb?ta:"";Rb.tabIndex=tb?0:-1}};da.prototype.sYe=function(X){return this.cw?X.parentNode:X.parentNode.parentNode};da.prototype.tuc=function(X,ta){if(X=this.lK[X])X=this.sYe(X),void 0!==X&&null!==X&&(!this.qh.length||ta?(X.classList.add(jc.a.AY),
X.setAttribute(df.a.tra,"true")):(X.classList.remove(jc.a.AY),X.setAttribute(df.a.tra,"false")))};da.prototype.RQa=function(X){var ta=this.$.XI?this.qh.length-1:0,tb=this.J_e(this.$.XI?0:this.qh.length-1);tb&&(tb.borderRightWidth=X?"1px":"0");this.zu!==this.ZJ&&(tb=this.J_e(ta))&&(tb.borderRightWidth="0")};da.prototype.Vje=function(X,ta){this.qh||(this.qh=[]);-1===ta?Array.add(this.qh,X):Array.insert(this.qh,ta,X)};da.prototype.e3b=function(X,ta){var tb=-1,Rb=null;ta||(tb=this.eNh(X.index),-1!==tb&&
(Rb=this.VJa(tb)));X=new hb(this.$,this.Ok,Rb,X,this,this.gm,this.cw);this.Vje(X,tb);rf.DOMElementExtensions.setVisible(X.domElement,!0)};da.prototype.CPd=function(X,ta){var tb=this.B1a(X);if(tb){this.mjd=X;this.Dud=ta;X=tb.domElement;tb=this.isRtl?X.offsetLeft+(this.Ok.scrollWidth-this.Ok.clientWidth-this.Ok.scrollLeft):X.offsetLeft-this.Ok.scrollLeft;if(!this.isRtl&&ta||this.isRtl&&!ta)tb+=X.offsetWidth;this.Wuc.style.left=td.HelperMethods.Qb(tb-4);rf.DOMElementExtensions.setVisible(this.Wuc,!0)}};
da.prototype.C5e=function(){rf.DOMElementExtensions.setVisible(this.Wuc,!1)};da.prototype.X_=function(X){var ta=this,tb=td.HelperMethods.Ska(function(){switch(X){case 0:ta.Osc(0);break;case 1:ta.Osc(ta.zu-1);break;case 2:ta.Osc(ta.zu+1);break;case 3:ta.scrollIntoView(ta.qh.length-1);break;case 4:ta.zu&&1<=ta.qh.length&&(ta.Khe(ta.zu-1),ta.qKd());break;case 5:ta.ZJ!==ta.qh.length-1&&1<=ta.qh.length&&(ta.Khe(ta.ZJ+1),ta.qKd());break;case 6:ta.qKd()}});this.P5b&&this.JE&&this.kMb();Jc.ULS.sendTraceTag(537153755,
0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",X,tb)};da.prototype.Khe=function(X){(X=this.nQ(X))&&X.activate()};da.prototype.Svh=function(X){if(!X.ey)for(var ta=this.$.xa,tb=0,Rb=0,Fc=ta.count;Rb<Fc;Rb++){var lc=Object(pe.a)(Ka.a,ta.getItem(Rb));if(lc===X)return tb;lc.ey||tb++}return-1};da.prototype.Fvh=function(X){var ta=this.$.xa;X=X.index+1;for(var tb=ta.count;X<tb;X++){var Rb=Object(pe.a)(Ka.a,ta.getItem(X));if(!Rb.ey)return Rb}return null};da.prototype.uia=function(X){for(var ta=
0;ta<this.qh.length;ta++){var tb=this.nQ(ta);if(!tb)Jc.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",ta);else if(tb.sheet===X)return ta}return-1};da.prototype.B1a=function(X){X=this.uia(X);return this.nQ(X)};da.prototype.coi=function(X,ta,tb){var Rb={};Rb.a=this.$.ya.UserSessionId;Rb.b=tb;Rb.c=this.w5b;Rb.d=X;Rb.e=ta;Rb.f=this.$.xa.count;ng.b().Ne(2,Rb,tb)};da.prototype.b7i=function(X,ta,tb){var Rb=
Object(pe.a)(qc.a,this.$.xa);ta?(ta=ta.index,ta=X.index<ta?ta-1:ta):ta=tb?Rb.count-1:0;Rb.reorderSheet(X,ta,!0)};da.prototype.DVf=function(X){lf.g(this.$).Bh.Rt(X)};da.prototype.vJg=function(X){if(!this.lrc){var ta=this.domElement.ownerDocument.body;this.Zy?(Fd.a.instance.pa(wf.a.lh,document.documentElement,this.oK),this.owa&&(vf.a.instance.pa(wf.a.Ig,document.documentElement,this.oK),vf.a.instance.pa(wf.a.Ig,this.domElement,this.lN))):(Fd.a.instance.pa(wf.a.lh,ta,this.oK),vf.a.instance.pa(wf.a.Ig,
ta,this.oK));Fd.a.instance.pa(wf.a.Wd,document.documentElement,this.j_);vf.a.instance.pa(wf.a.De,ta,this.j_);this.lrc=!0}this.d_=X.sheet;this.w5b=!1;this.Zy?(this.bM=null,this.F5b=X,this.v$=X.domElement,this.VLd(rf.DOMElementExtensions.getBoundingClientRect(this.v$),"BeginSheetTabButtonDrag")):(Jc.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(Lb.jLe),this.domElement.style.cursor="",this.DVf("pointer"))};
da.prototype.YP=function(X){X=void 0===X?!0:X;if(this.lrc){this.DVf(df.a.saa);var ta=this.domElement.ownerDocument.body;this.Zy?(Fd.a.instance.za(wf.a.lh,document.documentElement,this.oK),this.owa&&(vf.a.instance.za(wf.a.Ig,document.documentElement,this.oK),vf.a.instance.za(wf.a.Ig,this.domElement,this.lN))):(Fd.a.instance.za(wf.a.lh,ta,this.oK),vf.a.instance.za(wf.a.Ig,ta,this.oK));Fd.a.instance.za(wf.a.Wd,document.documentElement,this.j_);vf.a.instance.za(wf.a.De,ta,this.j_);this.qJc=this.lrc=!1}this.coc=
0;this.w5b=!1;this.mjd=this.d_=null;this.Zy?(this.v$&&(this.v$.style.visibility="visible",this.v$=null),this.F5b=null,this.VLd(null,"EndSheetTabButtonDrag"),this.bM&&(this.bM.parentNode&&this.bM.parentNode.removeChild(this.bM),this.bM=null),this.t9i(X)):(this.domElement.classList.remove(Lb.jLe),this.C5e())};da.prototype.t9i=function(X){this.gRd(X);this.mC=this.hzb=-1};da.prototype.zgh=function(X,ta){function tb(Jd,he,Te){var yg=lc.Oa(9,null);yg.sheetName=X;yg.newSheetIndex=ta;return Ng.i(lc,"ReorderSheets",
yg,Jd,he,Te,null,0)}function Rb(){return new Tb(X,ta)}var Fc=this.$.qa,lc=Fc?Fc.ta:null;me.EwaSettings.tc()?this.$.userOperationManager.ic(new kf.a(557,0,tb,64,Rb),null):this.$.userOperationManager.ic(new Ue.a(557,0,tb,void 0,Rb),null)};da.prototype.nQ=function(X){return 0<=X&&X<this.qh.length?this.qh[X]:null};da.prototype.I_e=function(X){return(X=this.nQ(X))?X.sheet:null};da.prototype.VJa=function(X){return(X=this.nQ(X))?X.domElement:null};da.prototype.J_e=function(X){return(X=this.VJa(X))?X.style:
null};da.prototype.eNh=function(X){var ta=this.$.xa;X+=1;for(var tb=-1,Rb=this.qh?this.qh.length:0;X<ta.count;){var Fc=Object(pe.a)(Ka.a,ta.getItem(X));if(!Fc.ey){for(tb=0;tb<Rb&&this.I_e(tb)!==Fc;tb++);break}X++}return-1===tb||tb===Rb?-1:tb};da.prototype.wzf=function(X){var ta=this.B1a(X);ta&&(this.Zy&&this.JE&&(Jc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),me.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.YP()),this.Ok.removeChild(ta.domElement),ta=Array.indexOf(this.qh,ta),Array.removeAt(this.qh,ta),this.G_(),(!this.isRtl&&ta===this.qh.length||this.isRtl&&!ta)&&this.RQa(!0),this.P5b&&this.JE?X===this.d_?(this.YP(),this.X_(6)):this.kMb():this.X_(6))};da.prototype.xzf=function(X){var ta=Object(pe.a)(Ka.a,X);this.Zy&&this.JE&&(Jc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),me.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.YP());if(!ta.ey){this.RQa(!1);var tb=this.uia(X);-1===tb&&(Jc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.e3b(ta,!1),tb=this.uia(X));this.D3e(tb,!0)}};da.prototype.c7i=function(X,ta){var tb=this.B1a(X);tb&&(this.Zy&&this.JE&&!ta&&(Jc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),me.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.YP()),X=this.Jzj(X,tb),!me.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Zy&&X&&ta&&X.tKi())};da.prototype.Jzj=function(X,ta){var tb=Array.indexOf(this.qh,ta),Rb=this.Svh(Object(pe.a)(Ka.a,X));if(-1===Rb||-1===tb)return null;tb!==Rb||this.Zy?(this.RQa(!1),Rb=da.Z6i(tb,Rb,this.zu,this.ZJ),this.zu=Rb.rwh,this.ZJ=Rb.fji,ta&&ta.domElement.parentNode===this.Ok&&(this.Ok.removeChild(ta.domElement),Array.removeAt(this.qh,tb)),ta=this.Fvh(X),tb=this.uia(ta),
ta=new hb(this.$,this.Ok,this.VJa(tb),Object(pe.a)(Ka.a,X),this,this.gm,this.cw),this.Vje(ta,tb),tb=this.uia(X),this.D3e(tb,!1,!this.gm)):ta=null;return ta};da.prototype.lhh=function(){for(var X=this.qh?this.qh.length:0,ta=this.zu,tb=this.ZJ,Rb=0;Rb<X;Rb++){var Fc=this.nQ(Rb),lc=Rb>=ta;Fc&&(Fc.tabIndex=lc&&Rb<=tb?0:-1)}};da.prototype.bIj=function(){for(var X=this.qh?this.qh.length:0,ta=0;ta<X;ta++){var tb=this.nQ(ta);tb&&tb.deb()}};da.prototype.D3e=function(X,ta,tb){tb=void 0===tb?!0:tb;ta&&X<=this.zu&&
this.zu++;this.lhh();this.RQa(!0);this.G_();this.P5b&&this.JE?this.kMb():tb&&this.X_(6)};da.prototype.auc=function(X){var ta=this.$.XI;if(X||this.isRtl!==ta)this.isRtl=ta,this.domElement.classList.remove(this.isRtl?Oc.a.qLe:Oc.a.wLe),this.domElement.classList.add(this.isRtl?Oc.a.wLe:Oc.a.qLe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.bIj();X||this.RQa(!0);for(X=0;X<this.lK.length;X++)X&&3!==X&&(!this.gm||4!==X&&5!==X)&&this.gWf(X)};da.prototype.h3g=function(){var X=this.QNd=document.createElement("div");
X.className=Lb.Kmh;this.gm&&X.classList.add(Lb.Lmh);this.domElement.appendChild(X);this.Y2b(X,1,701,700);this.Y2b(X,2,703,702);this.Odf&&(this.YQa=new sa(this.$,this,X));this.gm||this.Y2b(X,4,707,706)};da.prototype.i3g=function(){var X=this.Yuc=document.createElement("div");X.className=Lb.Mmh;this.domElement.appendChild(X);this.gm||this.Y2b(X,5,709,708);this.z2c()};da.prototype.i4g=function(){var X=document.getElementById(df.a.Mnj),ta=document.getElementById(df.a.Nnj);X&&!ta&&Jc.ULS.sendTraceTag(537153746,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",X.parentNode.id,!!X.firstChild,!!document.getElementById(df.a.INd));if(Ae.a.Tdf(this.$)&&X&&ta)this.domElement.appendChild(X),this.RNd=X.firstChild,this.SNd=document.getElementById(df.a.INd),ta.style.visibility="visible";else{X=document.createElement("div");ta=document.createElement("div");X.className=Oc.a.Vmh;ta.className=
Oc.a.Tmh;ta.style.display="none";var tb=document.createElement("div");tb.className=Oc.a.Wmh;var Rb=document.createElement("div");Rb.className=Oc.a.Umh;var Fc=document.createElement("div");Fc.className=Oc.a.Smh;ta.appendChild(tb);ta.appendChild(Rb);ta.appendChild(Fc);X.appendChild(ta);this.domElement.appendChild(X);this.RNd=ta;this.SNd=Rb}};da.prototype.gWf=function(X){var ta=this.lK[X];if(ta)if(this.cw){var tb=ta.parentNode;this.HLf(ta);ta=Ed.a(this.$)?this.REf[X]:this.mvd[X];this.lK[X]=this.svgIconProvider.Haa(ta,
12,12,tb,24,24)}else ta.className=this.kvd[X]};da.prototype.HLf=function(X){(null===X||void 0===X?0:X.parentNode)&&X.parentNode.removeChild(X)};da.prototype.F0g=function(){var X=this.Pbb=document.createElement("div");X.className=Lb.Hmh;this.domElement.appendChild(X);this.k5g(X)};da.prototype.k5g=function(X){var ta=document.createElement("div");ta.className=Lb.Ymh;ta.classList.add(Lb.Imh);this.$.printingEnabled||ta.classList.add(mf.a.ENe);X.appendChild(ta);this.Ok=document.createElement("ul");rf.DOMElementExtensions.ro(this.Ok,
df.a.mVc,null,null);this.Ok.className=mf.a.xLe;ta.appendChild(this.Ok);this.a3g();this.cee=document.createElement("div");this.Suc.id="SheetIconTooltipContainer";ta.appendChild(this.Suc)};da.prototype.a3g=function(){var X=document.createElement("div"),ta="<div class='"+Oc.a.xUg+"'>{0}</div>",tb=Ea.a.Fbd(Oc.a.Vnh,0,"55_16_N","");X.innerHTML=String.format(ta,tb);X.className=Lb.Xmh;rf.DOMElementExtensions.setVisible(X,!1);this.Wuc=X;this.Ok.appendChild(X)};da.prototype.S2c=function(){for(var X=this.$.xa,
ta=0,tb=X.count;ta<tb;ta++){var Rb=Object(pe.a)(Ka.a,X.getItem(ta));Rb.ey||(this.e3b(Rb,!0),Rb.active&&Rb.activate())}};da.prototype.RZc=function(){Df.a.pc(this.qh);this.qh=[];this.ZJ=this.zu=0};da.prototype.Y2b=function(X,ta,tb,Rb){function Fc(Te){"mouseup"===Te.type&&lc.Zy&&lc.JE||de.g(Te);Jd.classList.contains(jc.a.AY)||(he?lc.jHi(Te,ta):lc.gm||lc.Dwf(Te,ta))}var lc=this,Jd=document.createElement("a");X.appendChild(Jd);X=this.mvd[ta];this.lK[ta]=this.yb(Jd,Ve.a.instance.ea(Rb),0,this.kvd[ta],Ve.a.instance.ea(tb),
X);if(5===ta||4===ta)rf.DOMElementExtensions.EJ(this.lK[ta],Jd,!1,"span").style.marginTop="10px";this.gWf(ta);tb=this.lvd[ta]=this.Nd.Cd(Jd);Fd.a.instance.pa(wf.a.pointerDown,Jd,function(Te){return Te.ctrlKey&&lc.oBi(ta)?!0:lc.Bwf(ta)});Fd.a.instance.pa(wf.a.Wd,Jd,function(){return lc.Cwf()});vf.a.instance.pa(wf.a.De,Jd,function(){return lc.Cwf()});Fd.a.instance.pa(wf.a.pointerOut,Jd,function(){return lc.IZc()});h.KeyInputManager.instance.pa(wf.a.Rb,Jd,function(Te){return 13!==Te.Ea.keyCode&&32!==
Te.Ea.keyCode||lc.R0c?!1:(lc.R0c=!0,lc.Bwf(ta))});h.KeyInputManager.instance.pa(wf.a.Vd,Jd,function(Te){return 13===Te.Ea.keyCode||32===Te.Ea.keyCode?(lc.R0c=!1,lc.IZc()):!1});var he=this.Ume();tb.ja("mouseover",Fc);tb.ja("mouseout",Fc);tb.ja("focus",Fc);tb.ja("blur",Fc);he&&tb.ja("mouseup",Fc)};da.prototype.caf=function(X){var ta=!1,tb=this.$.Ue;tb&&(ta=cb.a.EA(rf.DOMElementExtensions.getBoundingClientRect(tb),X.clientPoint));return ta};da.prototype.Pdf=function(X){return cb.a.EA(rf.DOMElementExtensions.getBoundingClientRect(this.domElement),
X.clientPoint)||this.caf(X)};da.prototype.Ovh=function(X){var ta=null,tb=X.clientPoint,Rb=this.zu;if(this.Pdf(X))for(Rb=this.zu;Rb<=this.ZJ;Rb++)if(ta=this.nQ(Rb))if(X=rf.DOMElementExtensions.getBoundingClientRect(ta.domElement),!this.isRtl&&tb.x<X.x+X.width||this.isRtl&&tb.x>X.x)break;return{returnValue:ta,krj:Rb>this.ZJ}};da.prototype.kMb=function(){if(this.Zy){if(!this.bM){Jc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.bM=this.v$.cloneNode(!0);if(!this.fRf(this.bM,this.v$,!0,"UpdateDragAndDropState"))return;this.v$.style.visibility="hidden";this.bM.classList.add(Lb.Zmh);this.bM.style.borderRightWidth="";this.gbc=this.DY.clientPoint.x-this.r3.width/2;this.bM.style.left=this.gbc+"px";this.mC=this.uia(this.d_);0>this.mC&&Jc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.P5b&&(this.mC=this.uia(this.d_));var X=rf.DOMElementExtensions.getBoundingClientRect(this.Ok),
ta=X.x;X=X.x+X.width;var tb=this.DY.clientPoint.x-this.r3.width/2;tb=Math.min(tb,X-this.r3.width);tb=Math.max(tb,ta);this.bM.style.transform="translateX("+Math.abs(tb-this.gbc)*(this.gbc<tb?1:-1)+"px)";var Rb=this.DY.clientPoint.x>this.hzb,Fc=this.DY.clientPoint.x;tb>=X-this.r3.width?(Fc=X-this.r3.width/2,this.oKd()||this.Ula||(Jc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.knc=this.Ok.scrollLeft,
this.Ula=window.requestAnimationFrame(this.KSf))):tb<=ta?(Fc=ta+this.r3.width/2,this.nKd()||this.Ula||(Jc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.knc=this.Ok.scrollLeft,this.Ula=window.requestAnimationFrame(this.JSf))):this.Ula&&(Jc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.gRd());this.DY.clientPoint.x!==
this.hzb&&(this.WRd(Rb,Fc),this.hzb=this.DY.clientPoint.x)}else X=this.Ovh(this.DY),ta=X.krj,(X=X.returnValue)?this.CPd(X.sheet,ta):this.C5e();this.qJc=!0};da.prototype.WRd=function(X,ta){for(var tb=this,Rb;function(){var Fc=tb.kdh(ta,X);Rb=Fc.b0b;return Fc}().returnValue;)this.OKb=Rb,this.QEg(X)};da.prototype.QEg=function(X){if(this.OKb){var ta=(X?1:-1)*this.r3.width;if(X&&!this.$.XI||!X&&this.$.XI){var tb=this.v$;var Rb=this.mC+1;var Fc=!0}else tb=(Rb=this.nQ(this.mC+1))?Rb.domElement:null,Rb=this.mC-
1,Fc=!1;if(this.fRf(this.OKb,tb,Fc,"AnimateSheetSwap")){Jc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.mC,Rb,this.ONd,X);0<=this.mC&&this.mC<this.qh.length&&0<=Rb&&Rb<this.qh.length?(X=this.qh[Rb],this.qh[Rb]=this.qh[this.mC],this.qh[this.mC]=X):(Jc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",
this.qh.length,this.mC,Rb),this.YP());this.mC=Rb;var lc=this.OKb;lc.style.transform="translateX("+ta+"px)";window.requestAnimationFrame(function(){lc.style.transform="translateX(0px)"})}}};da.prototype.fRf=function(X,ta,tb,Rb){function Fc(lc){return lc?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",lc.id,lc.className,lc.nodeName):null}try{return this.Ok.insertBefore(X,ta),!0}catch(lc){return X=this.B1a(this.d_),Jc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
X?X!==this.F5b?"Changed":"NoChange":"Removed",Rb,Fc(ta),Fc(ta.parentNode),Fc(this.Ok),tb,this.mC,this.ONd,lc),this.YP(),!1}};da.prototype.kdh=function(X,ta){var tb=this.$.XI===ta?this.nQ(this.mC-1):this.nQ(this.mC+1);if(!tb)return{returnValue:!1,b0b:null};tb=tb.domElement;var Rb=rf.DOMElementExtensions.getBoundingClientRect(tb);return this.r3?ta?{returnValue:X+this.r3.width/2>=Rb.x+.5*Rb.width,b0b:tb}:{returnValue:X-this.r3.width/2<=Rb.x+.5*Rb.width,b0b:tb}:(Jc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.YP(),{returnValue:!1,b0b:tb})};da.prototype.HSf=function(X,ta){var tb=ta?this.KSf:this.JSf;if(-1===this.Mwc)this.Mwc=X,this.Ula=window.requestAnimationFrame(tb);else{X=Math.floor((X-this.Mwc)/1E3*300);var Rb=this.$Gb>this.Kzb?1:-1;this.scrollLeft(Math.abs(this.Ok.scrollLeft-(ta?this.knc+X*Rb:this.knc-X*Rb))*(ta?-1:1));if(X=this.UWe("ScrollStep"))this.WRd(ta,X.x+X.width/2),ta&&!this.oKd()||!ta&&!this.nKd()?this.Ula=window.requestAnimationFrame(tb):(Jc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.gRd())}};da.prototype.oKd=function(){var X=this.$Gb>this.Kzb;return X&&this.xma>=this.$Gb||!X&&this.xma<=this.$Gb};da.prototype.nKd=function(){var X=this.$Gb>this.Kzb;return X&&this.xma<=this.Kzb||!X&&this.xma>=this.Kzb};da.prototype.gRd=function(X){X=void 0===X?!0:X;this.Ok&&(this.xma=this.Ok.scrollLeft);window.cancelAnimationFrame(this.Ula);this.Ula=0;this.Mwc=-1;X&&this.G_()};da.prototype.VLd=function(X,ta){X||Jc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
ta);this.r3=X};da.prototype.oBi=function(X){return 2===X?(this.X_(3),!0):1===X?(this.X_(0),!0):!1};da.prototype.Bwf=function(X){var ta=this;Jc.ULS.shipAssertTag(537153732,0,-1===this.DOa&&-1===this.COa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.DOa&&(window.clearTimeout(this.DOa),this.DOa=-1);-1!==this.COa&&(window.clearInterval(this.COa),this.COa=-1);this.X_(X);this.DOa=window.setTimeout(function(){ta.pxj(X)},
this.Iui);return!0};da.prototype.pxj=function(X){var ta=this;this.COa=window.setInterval(function(){ta.X_(X)},this.Hui)};da.prototype.Cwf=function(){this.IZc();return!this.Zy||!this.JE};da.prototype.IZc=function(){window.clearTimeout(this.DOa);window.clearInterval(this.COa);this.COa=this.DOa=-1;return!0};da.prototype.Dwf=function(X,ta){var tb=this.kvd[ta];td.HelperMethods.mTd(this.lK[ta],tb,tb+df.a.Jcc,"mouseover"===X.type||"focus"===X.type)};da.prototype.jHi=function(X,ta){var tb=this.Zec(ta),Rb=
5===ta;if("mouseup"===X.type){if(Rb||4===ta)tb||this.reorderSheets(null,Rb,!1),this.YP()}else!this.Zy&&this.JE?(tb||this.CPd(this.I_e(Rb?this.ZJ:this.zu),Rb),this.X_(Rb?2:1)):this.gm||this.Dwf(X,ta)};da.prototype.Zec=function(X){return!!rf.DOMElementExtensions.zcd(this.lK[X],"a").title};da.prototype.dAc=function(X){this.$Vd(X);this.G_()};da.prototype.$Vd=function(X){(X=this.B1a(X))&&X.deb()};da.prototype.qKd=function(){var X=this.$.xa;if(X.oa&&(!eh.e(this.$)||X.count))if(X=this.uia(X.oa),-1===X)Jc.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ta=this.VJa(X);X<this.zu?this.Osc(X):X>this.zu&&!this.Tod(ta)&&this.scrollIntoView(X)}};da.prototype.mJj=function(){this.zu=0;this.ZJ=this.qh.length-1;for(var X=!1,ta=0;ta<this.qh.length;ta++){var tb=this.nQ(ta);if(!tb)break;var Rb=this.Tod(tb.domElement);tb.tabIndex=Rb?0:-1;if(!X&&Rb)this.zu=ta,X=!0;else if(X&&!Rb){this.ZJ=ta-1;break}}};da.prototype.Osc=function(X){this.$.xa.count&&(this.qh.length||
this.S2c(),this.vUf(this.VJa(Math.max(0,Math.min(X,this.qh.length-1)))),this.G_())};da.prototype.scrollIntoView=function(X){Jc.ULS.shipAssertTag(537153697,0,X>=this.zu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.qh.length||this.S2c();var ta=this.VJa(Math.max(0,Math.min(X,this.qh.length-1))),tb=this.VJa(this.zu);if(!this.Tod(ta)){ta=rf.DOMElementExtensions.getBoundingClientRect(ta);var Rb=rf.DOMElementExtensions.getBoundingClientRect(this.Pbb);
ta=this.isRtl?Rb.x-ta.x:ta.x+ta.width-(Rb.x+Rb.width);for(Rb=0;tb&&Rb<ta;){var Fc=rf.DOMElementExtensions.getBoundingClientRect(tb);Rb+=Fc.width;tb=tb.nextSibling}tb?this.vUf(tb):Jc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.zu,this.ZJ,X)}this.G_()}};da.prototype.vUf=function(X){var ta=rf.DOMElementExtensions.getBoundingClientRect(this.Ok);X=rf.DOMElementExtensions.getBoundingClientRect(X);
this.isRtl?this.scrollLeft(Math.floor(ta.x+ta.width-(X.x+X.width+.5))):this.scrollLeft(Math.ceil(ta.x-X.x-.5))};da.prototype.scrollLeft=function(X){(0>X&&this.oKd()||0<X&&this.nKd())&&Jc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var ta=this.Ok.scrollLeft;if(this.isRtl){if(dg.a.ME||dg.a.zf){this.Ok.scrollLeft=this.xma=ta-X;return}if(dg.a.xA||dg.a.iH){this.Ok.scrollLeft=this.xma=ta+X;return}Jc.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Ok.scrollLeft=this.xma=ta-X};da.prototype.Tod=function(X){X=rf.DOMElementExtensions.getBoundingClientRect(X);var ta=rf.DOMElementExtensions.getBoundingClientRect(this.Pbb);return X&&ta?X.x>=ta.x-1&&X.x+X.width<=ta.x+ta.width+1:(Jc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};da.prototype.B3g=function(){var X=this.Yuc;if(Sa.TYf(this.$))this.gm?(Df.a.Fa(this.$G),
this.$G=new Sa(X,this.$,this,!0)):(Df.a.Fa(this.$G),this.$G=null);else if(!this.$G||this.gm)Df.a.Fa(this.$G),we.k(this.$.kg)?this.$G=new za(X,this.$,this):this.$G=new Sa(X,this.$,this)};da.prototype.FBe=function(X,ta){var tb=this.$.xa;if(!this.$.isEditMode||!tb.count)Df.a.Fa(ta),ta=null;else if(!ta)if(tb=this.gm?this.QNd:this.Yuc,we.k(this.$.kg))ta=new za(tb,this.$,this);else switch(X){case 0:ta=new Sa(tb,this.$,this);break;case 1:ta=new Da(tb,this.$,this);break;default:Jc.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ta};da.prototype.z2c=function(){me.EwaSettings.la(441)?(this.$G=this.FBe(0,this.$G),this.Pwb=this.FBe(1,this.Pwb)):this.B3g()};da.prototype.UWe=function(X){var ta=rf.DOMElementExtensions.getBoundingClientRect(this.bM);ta||(Jc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
X),this.YP());return ta};da.prototype.r3e=function(X,ta){this.Ysa.TFg(X,ta);this.YP(!1);this.vMd(this.navigationButtonsDisabled);X=yl(this.Vzj);for(ta=X.next();!ta.done;ta=X.next())(ta=ta.value)&&ta.RW(this.navigationButtonsDisabled);X=yl(this.Fqe);for(ta=X.next();!ta.done;ta=X.next())(ta=ta.value)&&ta.RW(this.operationButtonsDisabled)};da.Z6i=function(X,ta,tb,Rb){X<tb?(ta>tb&&tb--,ta>Rb&&Rb--):X>Rb?(ta<tb&&tb++,ta<Rb&&Rb++):ta<tb&&tb++;return{rwh:tb,fji:Rb}};tl.Object.defineProperties(da.prototype,
{Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return Fe.a.NNd}},JE:{configurable:!0,enumerable:!0,get:function(){return this.qJc}},ONd:{configurable:!0,enumerable:!0,get:function(){return this.qh.length}},Suc:{configurable:!0,enumerable:!0,get:function(){return this.cee}},owa:{configurable:!0,enumerable:!0,get:function(){return this.c7d}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Ysa&&this.Ysa.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Ysa&&this.Ysa.operationButtonsDisabled}},kvd:{configurable:!0,enumerable:!0,get:function(){return this.gm?this.$.XI?[Oc.a.N6b,Oc.a.sLe,Oc.a.uLe,Oc.a.M6b,Oc.a.Dta,Oc.a.Dta]:[Oc.a.M6b,Oc.a.uLe,Oc.a.sLe,Oc.a.N6b,Oc.a.Dta,Oc.a.Dta]:this.$.XI?[Oc.a.N6b,Oc.a.rLe,Oc.a.tLe,Oc.a.M6b,Oc.a.Dta,Oc.a.Dta]:
[Oc.a.M6b,Oc.a.tLe,Oc.a.rLe,Oc.a.N6b,Oc.a.Dta,Oc.a.Dta]}},mvd:{configurable:!0,enumerable:!0,get:function(){return this.$.XI?[null,aa.a.hye,aa.a.fye]:[null,aa.a.fye,aa.a.hye]}},REf:{configurable:!0,enumerable:!0,get:function(){return this.$.XI?[null,aa.a.iye,aa.a.gye]:[null,aa.a.gye,aa.a.iye]}},Kzb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(dg.a.ME)return 0;if(dg.a.zf)return-1*(this.Ok.scrollWidth-this.Ok.clientWidth);if(dg.a.Ku)return this.Ok.scrollWidth-this.Ok.clientWidth;
Jc.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},$Gb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(dg.a.ME)return this.Ok.scrollWidth-this.Ok.clientWidth;if(dg.a.zf||dg.a.Ku)return 0;Jc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Ok.scrollWidth-this.Ok.clientWidth}},Fqe:{configurable:!0,enumerable:!0,get:function(){return this.Ysa?[this.$G,this.Pwb]:[this.$G,this.Pwb,
this.YQa]}},Vzj:{configurable:!0,enumerable:!0,get:function(){return this.qh.concat(this.YQa)}},Onj:{configurable:!0,enumerable:!0,get:function(){return this.bee}}});Object(sc.a)(da,"SheetTabBarControl",xf.a,[830,3,107]);var th=Vf.a;vm(Zb,th);Zb.prototype.create=function(){var X=this,ta=this.$.Ib;if(!gi.a(this.$.ya,1)){var tb=document.getElementById(ta+df.a.Y3c);tb&&(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&eg.PageLoadTrackingInfo.instance.Kza(df.a.qYf),Ae.a.eod()?
Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.Xa(this.$.da,388,387,this.tb),function(Rb){X.Fb(X.$.da.Aa(32)||new da(X.$,tb,Rb.result))},this.$.ma,3):this.Fb(this.$.da.Aa(32)||new da(this.$,tb)))}};Zb.ja=function(X){X.da.Ha(33,new Zb(X))};Object(sc.a)(Zb,"SheetTabBarFactory",Vf.a,[]);var rh=b(49),nf=b(183);Wb.prototype.$Na=function(){nf.a.instance.lHd(Object(Sc.a)(this,this.$Na,"onSessionExpiredDetected"));Jc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.CYh()};Wb.prototype.izf=function(){nf.a.instance.kHd(Object(Sc.a)(this,
this.izf,"onSessionExpiringDetected"));this.Rde||this.IOc||(Jc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Rde=!0,this.Ptj())};Wb.prototype.CYh=function(){this.IOc||(le.AFrameworkApplication.nF(rh.a.Etc),this.IOc=!0,this.Otj())};Object(sc.a)(Wb,"ASessionExpirationManager",null,[]);var bh=b(246),xh=b(6),Ag=b(79),bi=b(248);vm(Ya,Wb);Ya.prototype.tle=function(X){this.Ma.addHandler("SessionExpired",X)};Ya.prototype.RXb=function(X){this.Ma.addHandler("TokenRefreshed",
X)};Ya.prototype.aHd=function(X){this.Ma.removeHandler("TokenRefreshed",X)};Ya.prototype.Tbc=function(){return nf.a.instance.FQ(le.AFrameworkApplication.qk)};Ya.prototype.dispose=function(){Df.a.Fa(this.Ma);this.$=null};Ya.prototype.Ptj=function(){this.$.isEditMode&&this.sbc(!1)};Ya.prototype.Otj=function(){this.$kb=!0;this.sbc(!0);this.Ma.raiseEvent("SessionExpired")};Ya.prototype.sbc=function(X){var ta=this;Jc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",
X,this.$.fa.paa);var tb=this.$.Ab.Ap;X&&tb&&tb.isVisible&&1299163859===tb.error.MessageId&&this.$.Ab.Ap.ou();var Rb=this.jd(X);Lg.a(this.$).Rs(new bh.a(xh.a.Qy,5,function(){var Fc=Th.a(ta.$),lc=Fc.nd.activityState;lc[Ag.a.U1]=ta.$.Znb(ta.$.isEditMode);lc[Ag.a.zL]=Ag.a.F7a;lc[bi.a.Kq]=xh.a.accessTokenExpiringWarning;Fc.nd.ft([Rb])}))};Ya.prototype.jd=function(X){return X?yh.a.bCe():this.e5g()};Ya.prototype.e5g=function(){var X=yh.a.jd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");X.Description=
this.accessTokenExpiringMessage;return X};tl.Object.defineProperties(Ya.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var X=(new Date(this.qk)).format(this.$.ya.ShortTimeFormat);return String.format(Ve.a.instance.Cb(77),X)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.$kb}},Sbb:{configurable:!0,enumerable:!0,get:function(){return!1}},dba:{configurable:!0,enumerable:!0,get:function(){return!1}},iFd:{configurable:!0,enumerable:!0,get:function(){return!1}},
e5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(sc.a)(Ya,"EwaAccessTokenExpirationManager",Wb,[207,208,3]);var Ti=b(179),Qi=b(687);Object(sc.a)(zb,"RefreshAccessTokenContext",null,[]);var jj=b(186),vh=b(113),Bi=b(133),li=b(33),T=b(112);Object(sc.a)(lb,"Error",null,[]);Object(sc.a)(Ma,"NamedResult",null,[]);vm(Ia,Ma);Object(sc.a)(Ia,"ErrorInfo",Ma,[]);tl.Object.defineProperties(pa.prototype,{tokens:{configurable:!0,enumerable:!0,get:function(){return this.JVb}},errors:{configurable:!0,
enumerable:!0,get:function(){return this.sS}}});Object(sc.a)(pa,"TokenRefreshArgs",null,[245]);na.prototype.tle=function(X){this.Ma.addHandler("SessionExpired",X)};na.prototype.RXb=function(X){this.Ma.addHandler("TokenRefreshed",X)};na.prototype.aHd=function(X){this.Ma.removeHandler("TokenRefreshed",X)};na.prototype.Tbc=function(){return nf.a.instance.FQ(le.AFrameworkApplication.qk)};na.prototype.dispose=function(){nf.a.instance.lHd(this.K3e);nf.a.instance.kHd(this.k3e);var X=this.$.fa;X&&(X.kk(this.Zc),
X.Sqc(this.Uxa));Df.a.Fa(this.Ma);this.documentVisibilityObserver=this.$=null};na.prototype.z5f=function(){return this.Tbc()?0:(le.AFrameworkApplication.qk-(new Date).getTime())/6E4};na.prototype.hag=function(X,ta){if(0<ta&&!this.Tbc()){var tb=le.AFrameworkApplication.ga.zd("AccessTokenExpirationPromptSeconds",le.AFrameworkApplication.TX),Rb=(ta-X.getTime())/6E4;Jc.ULS.shipAssertTag(537170713,0,0<=Rb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",
ta,X.getTime(),Rb);Rb<this.Rsi?(Jc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.tYf,Rb),le.AFrameworkApplication.TX=this.tYf):le.AFrameworkApplication.TX!==tb&&(Jc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",tb,Rb),le.AFrameworkApplication.TX=tb)}};
na.prototype.C_g=function(X){return!this.context||this.context.AFb||this.context.a3c!==X?(X=new zb(Ti.a.create().toString(),X),this.context&&!this.context.syc&&Jc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",X.correlationID,this.context.correlationID,this.context.AFb),this.mS=X,!0):!1};na.prototype.w9i=function(X){X&&this.CG&&!this.dba&&this.$.fa.Df.Yq&&!this.e5&&
(this.CG=!1)};na.prototype.L3e=function(X){var ta=this;this.w9i(X);if(!(this.Xjb||this.Fcb&&!X||this.CG)&&this.Sbb){this.Xjb=!0;var tb=this.context?this.context.creationTime:null,Rb=this.C_g(X);this.Asd=!0;var Fc=this.$.fa,lc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Rb};lc.IsUserActive=Fc.Df.Yq;lc.IsSessionActive=Fc.oc;lc.ContainsChangesWorkbookOperations=this.$.userOperationManager.MGa();lc.isSessionExpired=X;lc.stopRefreshRetriesUntilTokenExpired=this.Fcb;
lc.FailedToRefreshExpiredToken=this.CG;lc.numOfFailuresWhileUserIsActive=T.a.D5;lc.numOfFailuresWhileUserIsInActive=T.a.E5;lc.numOfFailuresWhileOffline=T.a.Bxa;lc.RefreshAccessTokenCorrelationID=this.context.correlationID;Rb&&tb&&(lc.TimeInMinFromPreviosContextCreation=Math.round(vh.b(Zg.a.Ra,tb)/60));tb=ke.a.Hc(lc);Jc.ULS.sendTraceTag(40416199,0,50,tb);this.gFd.start();this.r7d=Fc.Df.Yq;this.Ww=new Qi.a;this.Bki(X);var Jd=this.qTd.T_i(!X,this.Ww?this.Ww.token:null);Jd.continueWith(function(){ta.BTg();
var he=ta.qTd.fVi(Jd);ta.gFd.stop();var Te=ta.Tbc();if(!he||me.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Te){var yg=Jd.result.errors;he&&Te&&ta.wwg(yg);ta.mYh(yg,X)}else ta.Fcb=!1,ta.nYh(Jd.result.tokens,X);ta.Xjb=!1},this.r8b?8:0)}};na.prototype.wwg=function(X){var ta=[Object.assign(new lb,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];X.add(Object.assign(new Ia,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ta}))};na.prototype.Bki=
function(X){X&&(this.$.fa.Df.Yq?this.b2f():(this.$.fa.Df.dra(this.Izd),this.GFb=!0))};na.prototype.b2f=function(){var X=this;this.Opc=jj.AsyncMethodContext.Ky(function(){X.S_i()},1E3*this.DJf,Od.a.B_i,this.Opc)};na.prototype.BTg=function(){this.Opc&&this.Opc.cancel();this.GFb&&(this.$.fa.Df.eza(this.Izd),this.GFb=!1);this.Ww=null};na.prototype.S_i=function(){Jc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.DJf);
this.Ww.C()};na.prototype.mYh=function(X,ta){this.Fcb=!0;ta&&(this.CG||(this.$kb=this.CG=!0),this.qTd.Ofc(X)&&(this.S7d=!0));var tb=!ta||this.Sbb&&!T.a.pvc?40380379:39982555;ta=this.LAe(ta);ta.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ta.FailedToRefreshExpiredToken=this.CG;ta.LastErrorIsPermanent=this.e5;if(0<X.count){var Rb=X.na(0);ta.errorName=Rb.Name;0<Rb.Errors.length&&(ta.ErrorId=Rb.Errors[0].Id,Rb=Rb.Errors[0].Details,ta.ErrorDetails=this.Kch(Rb.toString())?"PiiScrubbed":
Rb)}ta=ke.a.Hc(ta);Jc.ULS.sendTraceTag(tb,0,15,ta);this.Ma.raiseEvent("TokenRefreshed",new pa(null,X))};na.prototype.Kch=function(X){return Tf.a.contains(X,"makes the internet safe for businesses",!0)};na.prototype.LAe=function(X){var ta={},tb=this.$.fa;ta.Name="";ta.IsUserActive=tb.Df.Yq;ta.IsSessionActive=tb.oc;ta.GotDeploymentOrTimedOutError=tb.paa;ta.TimeInSecFromLastStatefulSuccessfulRequest=tb.i7;ta.TimeFromLastUserActivityInMs=tb.Df.cdb;ta.calledFromSessionExpiredFlow=X;ta.RefreshTokenDurationInMS=
this.gFd.Ac;ta.numOfFailuresWhileUserIsActive=T.a.D5;ta.numOfFailuresWhileUserIsInActive=T.a.E5;ta.numOfFailuresWhileOffline=T.a.Bxa;ta.RefreshAccessTokenCorrelationID=this.context.correlationID;ta.accessTokenTTL=le.AFrameworkApplication.qk;ta.ContainsChangesWorkbookOperations=this.$.userOperationManager.MGa();ta.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.kj.toString():"Unknown";ta.TimeFromFirstOpenInHr=Math.floor(vh.b(Zg.a.Ra,ai.toUtc(tb.eCf))/3600);return ta};
na.prototype.nYh=function(X,ta){this.CG=!1;this.LLj();this.hag(new Date,le.AFrameworkApplication.qk);var tb=this.$.fa,Rb=!ta&&tb.Df.Yq,Fc=!this.$.isEditMode&&tb.t$a;ta=this.LAe(ta);ta.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ta.shouldTriggerSilentReloadAfterExpiring=Rb;ta.WopiTokenTaskItemPriority=le.AFrameworkApplication.JXd;ta.isDirtyViewSession=Fc;ta=ke.a.Hc(ta);Jc.ULS.sendTraceTag(39982556,0,15,ta);this.Ma.raiseEvent("TokenRefreshed",new pa(X,null));Fc?tb.Df.Yq&&(Jc.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),tb.X$c()):tb.Df.Yq?Rb&&(X=Th.a(this.$).nd.activityState,X[T.a.udb]=!0,X[Bi.a.WX]=!0,X[li.a.rs]=this.$.isEditMode,Lg.a(this.$).Rs(new bh.a(xh.a.Hma,2,null))):tb.oc&&Ng.m(this.$.qa.ta,!0,!1,!1,null,null,null,null,null)};na.prototype.LLj=function(){void 0!==this.$.fa.workbookContext.WorkbookUri&&null!==this.$.fa.workbookContext.WorkbookUri?(this.$.fa.workbookContext.WorkbookUri=
ye.a.dT(this.$.fa.workbookContext.WorkbookUri,le.AFrameworkApplication.YO,le.AFrameworkApplication.accessToken),this.$.fa.workbookContext.WorkbookUri=ye.a.dT(this.$.fa.workbookContext.WorkbookUri,le.AFrameworkApplication.UX,le.AFrameworkApplication.qk.toString()),this.$.fa.anc()):Jc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=le.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=le.AFrameworkApplication.qk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=ye.a.dT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,le.AFrameworkApplication.YO,le.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=ye.a.dT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,le.AFrameworkApplication.UX,le.AFrameworkApplication.qk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=ye.a.dT(this.$.ya.EmbedConfiguratorUrl,le.AFrameworkApplication.YO,le.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=ye.a.dT(this.$.ya.EmbedConfiguratorUrl,le.AFrameworkApplication.UX,le.AFrameworkApplication.qk.toString()));this.context.AFb=!0};tl.Object.defineProperties(na.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.$kb}},dba:{configurable:!0,
enumerable:!0,get:function(){return this.r7d}},e5:{configurable:!0,enumerable:!0,get:function(){return this.S7d}},context:{configurable:!0,enumerable:!0,get:function(){return this.mS}},Sbb:{configurable:!0,enumerable:!0,get:function(){return this.e5?!1:this.$.fa.Df.Yq?1>T.a.D5:6>T.a.E5}},iFd:{configurable:!0,enumerable:!0,get:function(){return this.Xjb}}});Object(sc.a)(na,"EwaAccessTokenExpirationRefreshManager",null,[207,208,3]);xa.PWb="ActivityDuration";xa.error="Error";xa.Hhh="Errors";xa.failed=
"Failed";xa.ewh="FirstActivity";xa.initialized="Initialized";xa.Sii="LastActivity";xa.haj="RetryOverride";xa.U8i="RequestGroups";xa.requests="Requests";xa.OPf="Responses";xa.Gtc="SessionDuration";xa.status="Status";xa.success="Success";xa.tokens="Tokens";Object(sc.a)(xa,"SessionExpirationStrings",null,[]);Z.prototype.Kcg=function(){var X={};Jc.ULS.sendTraceTag(41964821,217,50,Jc.ULS.Hc((X.Aggregate=this.lX,X.Current=this.vo,X)))};Z.prototype.S4h=function(){this.lX[xa.U8i]=0;this.lX[xa.requests]=0;
this.lX[xa.OPf]=0;this.lX[xa.status]=xa.initialized;this.lX[xa.ewh]=new Date;this.lX[xa.Gtc]=0;this.lX[xa.PWb]=0;this.lX[xa.Gtc]=0;this.vo[xa.Gtc]=0;this.lX[xa.PWb]=0;this.vo[xa.PWb]=0};Z.prototype.ijd=function(X,ta){var tb=X[ta];tb=tb?tb:0;tb++;X[ta]=tb;this.nMd(X)};Z.prototype.nMd=function(X){var ta=new Date;X[xa.PWb]=+ta-+this.jSb;this.jSb=ta;X[xa.Gtc]=+this.jSb-+this.crg;X[xa.Sii]=this.jSb};Z.prototype.ybb=function(X,ta){this.vo[X]=ta;this.nMd(this.vo)};Z.prototype.UUf=function(X,ta){this.vo[X]=
ta;this.nMd(this.vo)};Z.prototype.incrementCounter=function(X){this.ijd(this.vo,X);this.ijd(this.lX,X);this.ijd(this.ppg,X)};Z.prototype.flush=function(){this.m7d||(this.lX[xa.status]=this.vo[xa.status],this.Kcg(this.AVb),this.je.kma(this.AVb,6E4*this.Qif))};Z.prototype.stop=function(){Jc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.m7d=!0;this.je.Bp(this.AVb)};Object(sc.a)(Z,"SessionLogger",null,[283]);var Oa=b(688),Kb=b(1073);ma.prototype.hFi=function(X){if(X.MessageId!==
Rc.a.iid)xd.a(39408099,306,15,"Unexpected message.");else{var ta=new Qa.a,tb=new Qa.a;this.qj.incrementCounter(xa.OPf);var Rb=X.Values[Nc.a.bUf];if(!Rb||0>=Rb.length)xd.a(40122317,306,15,"Found no tokens in the dictionary"),Rb=X.Values;xd.a(40122318,306,100,"The Tokens array contains {0} tokens",Rb.length);this.qj.ybb("Correlation",X.CorrelationId);for(var Fc="",lc=0;lc<Rb.length;lc++){this.qj.UUf(xa.tokens,Rb.length);var Jd=Rb[lc],he=Jd;if(he&&he.Name){this.qj.incrementCounter(he.Name);var Te=Jd;
if(Te&&Te.Value)xd.a(39408128,306,100,"Received token with name: {0}",Te.Name),ta.add(Te),this.JVb.add(Te),this.qj.ybb(xa.status,xa.success),this.b3d&&this.NS&&this.NS.V9i();else if(Jd=this.NQh(Jd),xd.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",he.Name,JSON.stringify(Jd),this.Qfa),tb.add(Jd),this.sS.add(Jd),Fc=JSON.stringify(Jd),this.qj.ybb(xa.error,JSON.stringify(Jd)),this.qj.ybb(xa.status,xa.failed),this.b3d)for(he=yl(Jd.Errors),Jd=he.next();!Jd.done;Jd=
he.next())Jd=this.fIh(Jd.value),this.NS&&this.NS.Iyg(Jd)}}0<tb.count&&""!==Fc?(Rb=Object.assign(new Zf.a,{extendedProperties:new Map}),Rb.extendedProperties.set("Errors",Fc),bg.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Rb)):bg.Health.instance.recordKpiSuccess("WACTokenRefresh",null);xd.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ta.count,tb.count,X.CorrelationId,this.Qfa);0<tb.count&&!this.Ofc(tb)?(X=
this.L8.jQh(tb),X!==this.L8.fJd&&(this.qj.UUf(xa.haj,X),this.je.kma(this.Ri,X))):(this.qj.flush(),this.Ri&&(xd.a(39408131,306,100,"Deleting task {0} from task manager",this.Ri.name),this.je.Bp(this.Ri)),this.Sl&&!this.Sl.task.isCompleted&&this.Sl.setResult(new pa(ta,tb)))}};ma.prototype.NQh=function(X){if(!X)return null;var ta=Object.assign(new Ia,{Name:X.Name,Errors:[]});X=yl(X.Errors);for(var tb=X.next();!tb.done;tb=X.next()){tb=tb.value;var Rb=new lb;Rb.Id=tb.Id;Rb.Details=this.MQh(tb.Details);
ta.Errors.push(Rb)}return ta};ma.prototype.MQh=function(X){if(!X)return"";var ta=X.toLowerCase();return 0<ta.indexOf("<!doctype")?this.wed("Seems to contain HTML - Contains <!DOCTYPE"):0<ta.indexOf("<html")?this.wed("Seems to contain HTML - Contains <html>"):500<ta.length?this.wed(String.format("Error details content too long: Length: {0}",ta.length)):X};ma.prototype.wed=function(X){return String.format("{0} - Reason: [{1}]","### REDACTED ###",X)};ma.prototype.requestTokensOnce=function(){this.YOf()};
ma.prototype.YOf=function(){le.AFrameworkApplication.vsd("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.sqa>=this.L8.Eri?(xd.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Qfa),this.RAe(this.Sl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(bg.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Wej())};ma.prototype.Wej=function(){var X={};X[Nc.a.bUf]=
this.L8.tokens;var ta=Ti.a.create().toString();xd.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.L8.tokens),this.sqa+1,ta,this.Qfa);this.hbe.execute(function(tb){tb.Qj(Rc.a.Ene,X,ta)});this.sqa++;this.qj.incrementCounter(xa.requests)};ma.prototype.RAe=function(X,ta,tb){for(var Rb=new Qa.a,Fc=0;Fc<this.L8.tokens.length;Fc++){var lc=Object.assign(new Ia,{Name:this.L8.tokens[Fc],Errors:[Object.assign(new lb,{Id:ta,Details:tb})]});Rb.add(lc);this.sS.add(lc)}this.je.Bp(this.Ri);
this.qj.ybb(xa.Hhh,JSON.stringify(this.sS));this.qj.ybb(xa.status,xa.failed);X&&!X.task.isCompleted&&X.setResult(new pa(new Qa.a,this.sS))};ma.prototype.T_i=function(X,ta){var tb=this;ta=void 0===ta?null:ta;this.Ufe.start();this.bSb=X;this.Qfa=Ti.a.create().toString();xd.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Qfa,this.bSb);this.sqa=0;this.sS.clear();this.JVb.clear();var Rb=new Be.a;this.Sl=Rb;ta&&ta.R(function(){var Fc=!!Rb&&!Rb.task.isCompleted;xd.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",tb.Qfa,tb.bSb,Fc);Fc&&tb.RAe(Rb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Ri=new ve.a(this.L8.priority,2,this.L8.fJd,Object(Sc.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Rc.a.Ene,!0);this.Xqg&&this.YOf();this.je.gh(this.Ri);return this.Sl.task};ma.prototype.fVi=function(X){this.Ufe.stop();var ta=this.AZh(X.result.errors);Jc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ta,this.Qfa,this.bSb,this.sqa,this.sS.count,0<X.result.errors.count?X.result.errors.na(0).Name:"",0<X.result.errors.count&&0<X.result.errors.na(0).Errors.length?X.result.errors.na(0).Errors[0].Id:"",0<X.result.errors.count&&0<X.result.errors.na(0).Errors.length?X.result.errors.na(0).Errors[0].Details:"");return ta?!1:this.eVi(X.result.tokens)};ma.prototype.Ofc=function(X){return this.L8.Ofc(X)};ma.prototype.eVi=function(X){for(var ta=0;ta<X.count;ta++){var tb=X.na(ta);if(tb.Name===Nc.a.accessToken){var Rb=
(new Date).getTime();if(tb.Expiry>le.AFrameworkApplication.qk){var Fc={};Jc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(Fc.AccessTokenTtl=tb.Expiry,Fc.NowGetTime=Rb,Fc.BootTime=le.AFrameworkApplication.Pga,Fc),"PreviousAccessTokenTtl",le.AFrameworkApplication.qk);le.AFrameworkApplication.accessToken=tb.Value;le.AFrameworkApplication.qk=Math.floor(tb.Expiry);le.AFrameworkApplication.HXd=Rb;le.AFrameworkApplication.YWa=Math.floor(tb.Expiry)}else Fc={},Jc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(Fc.AccessTokenTtl=tb.Expiry,Fc.NowGetTime=Rb,Fc.BootTime=le.AFrameworkApplication.Pga,Fc),"PreviousAccessTokenTtl",le.AFrameworkApplication.qk)}}return!0};ma.prototype.AZh=function(X){for(var ta=!1,tb=0;tb<X.count;tb++){ta=!0;var Rb=X.na(tb);Jc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Rb.Name,JSON.stringify(Rb.Errors),this.Qfa)}return ta};ma.prototype.fIh=function(X){var ta=
rh.a.Etc;if(isNaN(parseInt(X.Id)))ta=rh.a.qPj;else{X=Number.parseInvariant(X.Id);switch(X){case 401:ta=rh.a.tPj;break;case 403:ta=rh.a.oPj;break;case 500:ta=rh.a.pPj;break;case 503:ta=rh.a.sPj}ta===rh.a.Etc&&(ta=500<X?rh.a.rPj:rh.a.nPj)}return ta};Object(sc.a)(ma,"TokenRefreshManager",null,[209]);Y.prototype.Ofc=function(X){var ta=JSON.stringify(X);if(this.hRc&&0<this.hRc.length)for(var tb=yl(this.hRc),Rb=tb.next();!Rb.done;Rb=tb.next())if(Rb=Rb.value,0<Rb.length&&0<=ta.indexOf(Rb))return!0;if(le.AFrameworkApplication.ga&&
le.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.StopTokenRefreshOn403",!1))for(X=yl(X),Rb=X.next();!Rb.done;Rb=X.next())if(Rb=Rb.value,Rb.Errors)for(ta=yl(Rb.Errors),Rb=ta.next();!Rb.done;Rb=ta.next())if((Rb=Rb.value)&&"403"===Rb.Id)return!0;return!1};Y.prototype.jQh=function(X){try{if(X)for(var ta=yl(X),tb=ta.next();!tb.done;tb=ta.next()){var Rb=tb.value;if(Rb.Errors)for(var Fc=yl(Rb.Errors),lc=Fc.next();!lc.done;lc=Fc.next()){var Jd=lc.value;if(Jd.Id in this.xce)return Number.parseInvariant(this.xce[Jd.Id].toString());
if(this.sJc)try{if(500<=Number.parseInvariant(Jd.Id))return le.AFrameworkApplication.vsd("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.Ace}catch(he){Jc.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",he.toString(),Jd.Id)}}}}catch(he){Jc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",he.toString())}return this.fJd};Y.prototype.Ekj=function(){var X={};try{if(!le.AFrameworkApplication.fbc()||
0>=le.AFrameworkApplication.fbc().length||""===le.AFrameworkApplication.fbc()[0])return X;for(var ta=yl(le.AFrameworkApplication.fbc()),tb=ta.next();!tb.done;tb=ta.next()){var Rb=tb.value;0<Rb.length&&(X[Rb]=le.AFrameworkApplication.vPj)}}catch(Fc){Jc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Fc.toString())}return X};Object(sc.a)(Y,"TokenRefreshPolicy",null,[210]);var ic=Vf.a;vm(S,ic);S.prototype.create=function(){le.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
le.AFrameworkApplication.ga.ra("RefreshAccessTokenSilently")?this.Fb(this.v1g()):this.Fb(this.$.da.Aa(38)||this.$.da.Ha(38,new Ya(this.$)))};S.prototype.v1g=function(){var X=this.$.da.Aa(38);if(X)return X;X=new ma(le.AFrameworkApplication.oj,le.AFrameworkApplication.NU(),new Y);return this.$.da.Ha(38,new na(this.$,X))};S.ja=function(X){X.da.Ha(39,new S(X))};Object(sc.a)(S,"AccessTokenExpirationManagerFactory",Vf.a,[]);var pd=Ec.a;vm(ca,pd);ca.prototype.ICg=function(X){this.addHandler("TAF",X)};ca.prototype.y6i=
function(X){this.removeHandler("TAF",X)};ca.prototype.SWi=function(){this.raiseEvent("TAF")};Object(sc.a)(ca,"GridHighlightBehaviorEventManager",Ec.a,[205,3]);var Td=Vf.a;vm(ba,Td);ba.prototype.create=function(){this.Fb(this.$.da.Aa(376)||new ca(this.$))};ba.ja=function(X){X.da.Ha(377,new ba(X))};Object(sc.a)(ba,"GridHighlightBehaviorEventManagerFactory",Vf.a,[]);var Gd=b(119),ge=Sys.EventArgs;vm(O,ge);Object(sc.a)(O,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var Pe=Ec.a;vm(Q,Pe);Q.prototype.eBg=
function(X){this.addHandler("mrek",X)};Q.prototype.jW=function(X,ta,tb){for(var Rb=yl(this.gridView.jn),Fc=Rb.next();!Fc.done;Fc=Rb.next())Fd.a.instance.pa(wf.a.lh,Fc.value.domElement,X);Fd.a.instance.pa(wf.a.Wd,document.documentElement,ta);this.gridView.rc.c6b(!0);tb&&Fd.a.instance.pa(wf.a.nz,this.gridView.Ui,ta)};Q.prototype.RUd=function(X,ta,tb){for(var Rb=yl(this.gridView.jn),Fc=Rb.next();!Fc.done;Fc=Rb.next())Fd.a.instance.za(wf.a.lh,Fc.value.domElement,X);Fd.a.instance.za(wf.a.Wd,document.documentElement,
ta);this.gridView.rc.c6b(!1);tb&&Fd.a.instance.za(wf.a.nz,this.gridView.Ui,ta)};Q.prototype.L0i=function(X,ta){for(var tb=yl(this.gridView.jn),Rb=tb.next();!Rb.done;Rb=tb.next())vf.a.instance.pa(wf.a.Ig,Rb.value.domElement,X);vf.a.instance.pa(wf.a.De,document.documentElement,ta)};Q.prototype.lHj=function(X,ta){for(var tb=yl(this.gridView.jn),Rb=tb.next();!Rb.done;Rb=tb.next())vf.a.instance.za(wf.a.Ig,Rb.value.domElement,X);vf.a.instance.za(wf.a.De,document.documentElement,ta)};Q.prototype.NAe=function(X,
ta,tb,Rb){var Fc=document.createElement("div");Fc.className=ta;ta=yl(tb);for(tb=ta.next();!tb.done;tb=ta.next())Fc.classList.add(tb.value);X.appendChild(Fc);Fd.a.instance.pa(wf.a.pointerDown,Fc,Rb);return Fc};Q.prototype.q_e=function(X){X=X.Sb.parentNode;if(!X)return Jc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;X=parseInt(X.getAttribute(df.a.xwb));return isNaN(X)?(Jc.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),
null):this.gridView.Nb.OG(3,1,X)};Q.prototype.FIb=function(X,ta,tb){X=(void 0===tb?!0:tb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.rci(X);ta=yl(ta);for(tb=ta.next();!tb.done;tb=ta.next())rf.DOMElementExtensions.setVisible(tb.value,X)};Q.prototype.Yad=function(){return this.gridView.xj?Gd.a(this.gridView.$):this.gridView.Kc};Q.prototype.UIf=function(){var X=this.Yad();X&&this.coloredReferencesManager?this.coloredReferencesManager.WW(X,null):(Jc.ULS.sendTraceTag(537159392,0,10,
"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Nb.kl(this.vlf),this.gridView.Nb.Jl(null,this.vlf))};Q.prototype.tHf=function(X,ta){this.raiseEvent("mrek",new O(X,ta))};tl.Object.defineProperties(Q.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var X=this.gridView.$.da.Aa(281);X||Jc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return X}}});Object(sc.a)(Q,"BehaviorHelperMethods",Ec.a,[]);var gf=pg.a;vm(I,gf);I.prototype.SXa=function(){};Object(sc.a)(I,"HighlightFlyweightBehavior",pg.a,[]);var kg=b(462),cg=b(118),Wg=b(9),tg=b(68),Jh=xf.a;vm(R,Jh);R.prototype.Ske=function(X){this.addHandler("GrDrag",X)};R.prototype.wMf=function(X){this.removeHandler("GrDrag",X)};R.prototype.Rke=function(X){this.addHandler("GrContxt",X)};R.prototype.vMf=function(X){this.removeHandler("GrContxt",X)};R.prototype.Tke=function(X){this.addHandler("GrPointerUp",
X)};R.prototype.xMf=function(X){this.removeHandler("GrPointerUp",X)};R.prototype.dispose=function(){qi.a.ama(this.domElement);Jh.prototype.dispose.call(this)};R.prototype.B$f=function(X){this.domElement.parentNode.removeChild(this.domElement);X.appendChild(this.domElement)};R.prototype.rUf=function(){this.domElement.classList.remove(tg.a.b7b);this.iKa.classList.remove(tg.a.a7b);this.iKa.classList.add(tg.a.HNe)};R.prototype.O8f=function(){this.iKa.classList.remove(tg.a.HNe);this.iKa.classList.add(tg.a.a7b);
this.domElement.classList.add(tg.a.b7b)};R.prototype.OZh=function(X){return!!this.G3b&&(3<Math.abs(X.x-this.G3b.x)||3<Math.abs(X.y-this.G3b.y))};R.Etb=function(X){var ta=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),tb=dg.a.Af;return ta&&!tb?(X=hg.a(X.$)?hg.a(X.$).zoom:Wg.a.Fba,Math.round(9/Math.max(X,1))):9};R.ytd=0;Object(sc.a)(R,"TouchGrippie",xf.a,[]);vm(W,I);W.prototype.dispose=function(){Df.a.pc([this.hO,this.JL]);this.hO.wMf(this.HAf);this.hO.vMf(this.Dlc);this.hO.xMf(this.Elc);
this.JL.wMf(this.drf);this.JL.vMf(this.Dlc);this.JL.xMf(this.Elc);for(var X=yl(this.gridView.jn),ta=X.next();!ta.done;ta=X.next())ta=ta.value,vf.a.instance.za(wf.a.Ff,ta.domElement,this.Uuf),vf.a.instance.za(wf.a.De,ta.domElement,this.Tuf);this.gridView.view.Wr(this.iw);this.gridView.Kc.im(this.kHe);this.gridView.Nb.qGb(this.Yxa);this.gridView.Aqc(this.Sqf);this.gridView.$.RC(this.ppc);this.gridView.Us(this.ppc);this.ha.K_(this.Sh);this.ha.Oca(this.dr);this.gridView.lF(this.Wo);this.ha.Dqc(this.Luf);
Qf.a.FMf(this.tCb);this.Raa&&Jc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(X=this.gridView.$.da.Aa(376))&&X.y6i(this.IAf);I.prototype.dispose.call(this)};W.prototype.iRa=function(){if(!this.zaa.range||!this.zaa.range.equals(this.Zab))return!1;var X=!this.gridView.OLa();return this.gridView.isEditing&&X&&(this.Zab.isRow||this.Zab.Lh)?!1:this.Raa?!0:3===Qf.a.Wb};W.prototype.q4=function(){this.Ymb&&(this.hO.set_visible(!1),this.JL.set_visible(!1),
this.Ymb=!1)};W.prototype.ena=function(){if(this.iRa()){this.EKj();var X=rf.DOMElementExtensions.getBoundingClientRect(this.eZa);X||Jc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.fa.isNamedObjectViewMode,this.hnd,this.cZb,this.gridView.Ui,this.gridView.$a.Zi);var ta=rf.DOMElementExtensions.getBoundingClientRect(this.Bej),tb=new Sys.UI.Bounds(ta.x-
X.x,ta.y-X.y,ta.width,ta.height),Rb=this.Zab,Fc=Rb.topLeft,lc=Rb.bottomRight,Jd=Rb.isRow||Rb.Lh;if(Rb.Lh){var he=this.svh();Rb=tb.x-2*R.Etb(this.gridView);var Te=he;var yg=tb.x+ta.width}else Rb.isRow?(Rb=yg=this.rvh(),Te=tb.y-2*R.Etb(this.gridView),he=tb.y+ta.height):(Te=tb.y,he=tb.y+ta.height,this.gridView.rtl?(Rb=tb.x+ta.width,yg=tb.x):(Rb=tb.x,yg=tb.x+ta.width));ta=R.ytd+(Jd?0:R.Etb(this.gridView));this.hO.style.left=td.HelperMethods.Qb(Rb-ta);this.hO.style.top=td.HelperMethods.Qb(Te-ta);this.JL.style.left=
td.HelperMethods.Qb(yg-ta);this.JL.style.top=td.HelperMethods.Qb(he-ta);this.hO.set_visible(this.Laf(Te,Rb,Fc,Jd,X));this.JL.set_visible(this.Laf(he,yg,lc,Jd,X));this.Ymb=!0}};W.prototype.Laf=function(X,ta,tb,Rb,Fc){var lc=rf.DOMElementExtensions.getBoundingClientRect(this.gridView.fg(this.paneType).domElement);Fc=new Sys.UI.Bounds(lc.x-Fc.x-3,lc.y-Fc.y-3,lc.width+6,lc.height+6);return(this.gridView.$a.Kj(tb)===this.paneType||Rb)&&cb.a.EA(Fc,new Sys.UI.Point(ta,X))};W.prototype.EKj=function(){if(this.hnd!==
this.cZb){this.eZa=null;var X=this.Y9c();this.hO.B$f(X);this.JL.B$f(X)}};W.prototype.svh=function(){return(this.gridView.view.visibleArea.height+this.gridView.$a.height+R.ytd-R.Etb(this.gridView))/2};W.prototype.rvh=function(){return(this.gridView.view.visibleArea.width+this.gridView.$a.width+R.ytd-R.Etb(this.gridView))/2};W.prototype.Lyf=function(){this.ena()};W.prototype.jai=function(X){return rf.DOMElementExtensions.nHb(X.Sb,Oc.a.Ir)&&(this.jbi(X)||this.kbi(X))};W.prototype.kbi=function(X){if(this.gridView.rtl)X=
X.clientPoint.x;else{var ta=rf.DOMElementExtensions.getBoundingClientRect(X.Sb);X=X.clientPoint.x-(ta.x+ta.width-cg.a.Sp)}return 0<X&&X<=cg.a.Sp};W.prototype.jbi=function(X){var ta=rf.DOMElementExtensions.getBoundingClientRect(X.Sb);X=X.clientPoint.y-(ta.y+ta.height-cg.a.Sp);return 0<X&&X<=cg.a.Sp};W.prototype.Vuf=function(X,ta){this.Raa&&Jc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.qYc(X,ta,this.Raa);this.q4()};W.prototype.$gj=function(){this.Raa||
(Jc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Raa=!0,this.hO.rUf(),this.JL.rUf(),this.gridView.ha.sourceRange=this.gridView.ha.va.Qd,this.ena())};W.prototype.WUd=function(){this.Raa&&(Jc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Raa=!1,this.hO.O8f(),this.JL.O8f())};W.prototype.Y9c=function(){if(!this.eZa){this.cZb=!1;if(this.hnd){var X=this.gridView.$.da.Aa(22);if(X)return this.cZb=!0,this.eZa=X.sx}this.eZa=
this.gridView.Ui}return this.eZa};tl.Object.defineProperties(W.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.ny}}});Object(sc.a)(W,"SelectionTouchGrippiesBehaviorBase",I,[]);vm(ia,W);ia.prototype.iRa=function(){var X=this.gridView.zi||this.gridView.isEditing;return!this.gridView.ha.va.Dh&&!X&&W.prototype.iRa.call(this)};tl.Object.defineProperties(ia.prototype,{t4:{configurable:!0,enumerable:!0,get:function(){return 19}},Zab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.va.activeRange}}});
Object(sc.a)(ia,"DiscontinuousSelectionTouchGrippiesBehavior",W,[]);var Fh=b(306);vm(P,I);Object(sc.a)(P,"SelectionBorderBehavior",I,[]);N.lqh="ewr-selection-draghandle";N.oqh="ewr-selection-draghandle-grab";N.uqh="ewr-selection-draghandle-top-ie";N.tqh="ewr-selection-draghandle-top";N.nqh="ewr-selection-draghandle-bottom-ie";N.mqh="ewr-selection-draghandle-bottom";N.qqh="ewr-selection-draghandle-left-ie";N.pqh="ewr-selection-draghandle-left";N.sqh="ewr-selection-draghandle-right-ie";N.rqh="ewr-selection-draghandle-right";
N.vqh="ewr-selection-dragtooltip";N.wqh="ewr-selection-dragtooltip-updated";N.Hqh="ewr_selection_rearrangeleft";N.Iqh="ewr_selection_rearrangeright";N.Jqh="ewr_selection_rearrangetop";N.Gqh="ewr_selection_rearrangebottom";N.selecting="selecting";N.Kqh="ewr-selection-resizemarqueehandle";N.Nqh="ewr-selection-resizemarqueehandle-topleft";N.Oqh="ewr-selection-resizemarqueehandle-topright";N.Lqh="ewr-selection-resizemarqueehandle-bottomleft";N.Mqh="ewr-selection-resizemarqueehandle-bottomright";N.bqh=
"ewr-marquee-thick";N.fqh="ewr-resizemarqueehandle-thick";Object(sc.a)(N,"CssClassNames",null,[]);vm(U,P);U.prototype.dispose=function(){var X=this;this.fC.forEach(function(ta){Fd.a.instance.za(wf.a.pointerDown,ta,X.onPointerDown)});Array.clear(this.fC);this.Rla=this.sourceRange=this.gd=null;Jc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.Vqa,!this.$);this.$&&(this.$.ml(this.od),1===this.Vqa&&(Jc.ULS.sendTraceTag(537159380,
0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.UL(this.Uhe,this.Vhe,!1)));P.prototype.dispose.call(this)};U.prototype.Zg=function(X){X=hg.a(this.$).Fe(X);return this.wxf(X)};U.prototype.wxf=function(X){if(5!==this.ru)return!1;(X=this.K8a(X))||this.z7b(!1);sg.b(this.$,!1);return X};U.prototype.Nj=function(X){X=hg.a(this.$).Fe(X);if(this.Xq&&this.uxf(X))return!0;if(X=this.ha.gr(X.clientPoint,X.Sb,5,void 0,void 0,!0)){X=this.uob(X);if(this.gd.equals(X))return!0;
this.gd=X;if(!this.t7())return Jc.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.z7b(!0),!1}return!0};U.prototype.jW=function(X,ta){Jc.ULS.shipAssertTag(537159377,0,!this.Vqa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Vqa+=1;this.Uhe=X;this.Vhe=ta;this.rp.jW(X,ta,this.TTd())};U.prototype.uob=function(X){if(!X||!this.gd)return Jc.ULS.shipAssertTag(537159376,0,
!!X,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Jc.ULS.shipAssertTag(537159375,0,!!this.gd,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var ta=this.gd.clone();1!==this.L2&&(ta.left=Math.max(X.left-this.Whd,1),ta.right=ta.left+this.sourceRange.width-1);2!==this.L2&&(ta.top=Math.max(X.top-this.$Wd,1),ta.bottom=ta.top+this.sourceRange.height-1);return this.pYb(ta)};U.prototype.UL=function(X,ta,tb,Rb){tb=void 0===tb?!0:tb;Rb=void 0===
Rb?!0:Rb;Jc.ULS.shipAssertTag(537159374,0,1===this.Vqa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Vqa;this.Xq||lf.g(this.$).Bh.Rt(df.a.saa);this.rp.RUd(X,ta,this.TTd());tb&&this.Sve(Rb);this.L2=0;this.MRa=!1};U.prototype.pYb=function(X){var ta=lf.g(this.$),tb=X;if(ta.$a.m4){if(!ta.sc(X.topLeft)){ta=ta.sl("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ta.IG,this.Rla.top!==X.top?1:2);try{ta.Uk=this.Rla.top<X.top||this.Rla.left<X.left,ta.Ou(X.topLeft),
tb=ta.$$cu().range}finally{ta&&ta.dispose()}}tb.right=tb.left+X.width-1;tb.bottom=tb.top+X.height-1}return this.Rla=tb};U.prototype.ULd=function(X){this.fC.forEach(function(ta){rf.DOMElementExtensions.setVisible(ta,X)})};U.prototype.EMh=function(X){var ta=X.Sb;X=X.clientPoint;if(!ta||!X)return Jc.ULS.shipAssertTag(537159373,0,!!ta,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Jc.ULS.shipAssertTag(537159372,0,!!X,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),
null;X.y+=ta===this.fC[U.C5b]?2:ta===this.fC[U.NGe]?-2:0;X.x+=ta===this.fC[U.PGe]?2:ta===this.fC[U.B5b]?-2:0;return this.ha.gr(X,ta,5,void 0,void 0,!0)};tl.Object.defineProperties(U.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return lf.g(this.$).Nb}},ru:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(X){this.ha.selectionType=X}}});U.KGe="move";U.K5c="grabbing";U.C5b=0;U.NGe=1;U.PGe=2;U.B5b=3;Object(sc.a)(U,"DragSelectionClickBehaviorBase",P,
[]);vm(B,U);B.prototype.SXa=function(X){this.rp.FIb(X,this.fC);this.Hx.lza()};B.prototype.mxf=function(X){Jc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.MKa=!0;this.qb.MD(!1);this.ru=5;this.Hx.QGe(X.Sb);this.qb.textBox.removeSelection();this.qb.NXb(this.e3e);this.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"));this.L2=this.sourceRange.isRow?1:this.sourceRange.Lh?2:0};B.prototype.K8a=
function(){var X=this.lda();this.ru=-1;this.UL(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"));return X};B.prototype.Sve=function(){this.gridView.MKa=!1;this.Hx.RGe(this.fC[0]);this.qb.textBox.setCaretPositionToEnd();this.qb.Nqc(this.e3e);this.rp.UIf()};B.prototype.z7b=function(X){Jc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");X&&this.UL(Object(Sc.a)(this,
this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"))};B.prototype.Ked=function(X){this.qb=this.rp.Yad();this.NK=this.rp.q_e(X);return this.qb&&this.NK&&this.NK.range?this.NK.range:(Jc.ULS.shipAssertTag(537159388,0,!!this.qb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Jc.ULS.shipAssertTag(537159387,0,!!this.NK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Jc.ULS.shipAssertTag(537159386,0,!!this.NK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),
null)};B.prototype.lda=function(){return this.NK?this.coloredReferencesManager.enf(this.qb,this.NK,this.gd):(Jc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};B.prototype.t7=function(){return this.lda()};B.prototype.TTd=function(){return!0};B.prototype.uxf=function(){return!1};Object(sc.a)(B,"DragMarqueeClickBehavior",U,[]);var Xg=b(911),hi=b(832),Ci=b(126);Object(sc.a)(w,
"MacroRecorderTableRowColumnRearrangedPayload",null,[98]);vm(G,U);G.prototype.dispose=function(){this.ha&&(this.ha.Oca(this.dr),this.ha.K_(this.Sh),this.ha.VMf(this.azf),this.ha.DK(this.kd));if(this.to)for(var X=1;4>=X;X++)rf.DOMElementExtensions.Sf(this.to[X.toString()]);this.to=this.qu=null;this.yZ&&this.dzc();this.Xq&&this.zZ&&this.dzc(1);U.prototype.dispose.call(this)};G.prototype.mxf=function(X){this.Xq&&(this.ica=X,this.sda=null,this.GQ=this.isRow=this.Lh=this.HQ=!1,h.KeyInputManager.instance.pa(wf.a.Rb,
this.domElement.ownerDocument.body,this.onKeyDown));this.fH=!0;this.tableRange=this.nPg(this.tableManager.eo(this.sourceRange.topLeft));lf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Xq?(this.sda=this.tableRange,this.pJ=1,this.qu=(this.GQ=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.ru=6,this.jW(this.I8a,this.L8a),this.XHa=this.D5b,this.cRa=this.Zuc,this.Tma(X.clientPoint,X.Sb,this.GQ?11:12,!0,!0),this.GSa(!0)):
(this.qu=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.ru=6,this.jW(this.I8a,this.L8a),this.Tma(X.clientPoint,X.Sb,this.isRow?11:12,!0)):(this.tableRange=null,this.Xq?(this.isRow=this.sourceRange.isRow,this.Lh=this.sourceRange.Lh,this.isRow||this.Lh?(this.pJ=3,this.L2=this.isRow?1:2,this.ru=6,this.qu=this.isRow?[11]:[12],this.jW(this.OCb,this.PCb),this.XHa=this.D5b,this.cRa=this.Zuc,this.Tma(X.clientPoint,X.Sb,this.isRow?11:
12,!0,!0),this.GSa(!0)):(this.pJ=2,this.L2=0,this.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp")),this.XHa=this.SGe,this.cRa=this.sYf,this.Tma(X.clientPoint,X.Sb,this.n$b(),!1,!0),this.t7(!0))):(this.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp")),h.KeyInputManager.instance.pa(wf.a.Rb,this.domElement.ownerDocument.body,this.onKeyDown),this.L2=this.sourceRange.isRow?1:this.sourceRange.Lh?2:0,this.Tma(X.clientPoint,X.Sb,
this.n$b(),!1),this.t7()))};G.prototype.K8a=function(){this.fH=!1;this.Xq&&(this.pJ=0);this.Nb.kl(this.Uia());if(!this.$.xs([this.gd],!1))return this.UL(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp")),this.ru=-1,!0;if(this.ha.va.Qd.equals(this.gd)||this.Fdc(this.gd)||this.Fdc(this.sourceRange))this.ru=-1;else{this.lda();this.ha.sourceRange=this.sourceRange.clone();var X=this.ha.sourceRange,ta=this.ha.va.Qd;if(this.Xq){var tb={};this.$.Ce(-694765314,2,30,(tb[df.a.krb]=
this.yZ,tb[df.a.jta]=X,tb[df.a.ita]=ta,tb[df.a.G5c]=this.zZ,tb))}else tb={},this.$.Ce(-694765314,2,30,(tb[df.a.krb]=this.yZ,tb[df.a.jta]=X,tb[df.a.ita]=ta,tb))}!this.Xq&&this.tableRange||this.UL(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"));return!0};G.prototype.Sve=function(X){X&&(h.KeyInputManager.instance.za(wf.a.Rb,this.domElement.ownerDocument.body,this.onKeyDown),this.Xq&&lf.g(this.$).Bh.Rt(df.a.saa),this.fH=!1);for(X=1;4>=X;X++){var ta=this.to[X.toString()];
ta&&ta.parentNode.removeChild(ta);this.to[X.toString()]=null}this.qu=null};G.prototype.uxf=function(X){var ta=this.ha.gr(X.clientPoint,X.Sb,5,void 0,void 0,!0);this.ica=X;return this.m4e(ta)?(this.gd=this.KXc(ta),this.C2e(!0),!0):this.vZh(ta)?(this.gd=this.uob(ta),this.D2e(!0),!0):!1};G.prototype.m4e=function(X){return!!this.sda&&1!==this.pJ&&!!X&&this.sda.contains(X.topLeft)};G.prototype.vZh=function(X){return!!this.sda&&1===this.pJ&&!!X&&!this.sda.contains(X.topLeft)};G.prototype.C2e=function(X){this.tableRange=
this.sda;this.pJ=1;var ta=!this.zZ;X?(this.Yra(!1),this.qu=this.GQ?[11]:[12],this.xKf(ta),this.GSa(ta)):(this.Rob(!1),this.BFb(ta),this.t7(ta))};G.prototype.D2e=function(X){this.tableRange=null;this.pJ=2;var ta=!this.zZ;X?(this.Yra(!1),this.qu=this.GQ?[11]:[12],this.HQ=this.GQ,this.qFd(ta),this.GSa(ta)):(this.vZc(!1),this.BFb(ta),this.t7(ta))};G.prototype.Ked=function(){return this.ha.va.Qd};G.prototype.lda=function(){this.ha.updateSelection(this.gd,this.gd.topLeft,0);return!0};G.prototype.t7=function(X){X=
void 0===X?!1:X;this.Nb.Jl(this.gd,this.Uia());this.Nb.Yr(this.Uia());this.FW(X);return!0};G.prototype.GSa=function(X){X=void 0===X?!1:X;this.Nb.Jl(this.gd,this.qu);this.Nb.Yr(this.qu);this.FW(X)};G.prototype.z7b=function(){Jc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};G.prototype.TTd=function(){return!1};G.prototype.oqj=function(){if(!lf.g(this.$).ha.va.Dh)return!1;var X=lf.g(this.$).getRangeInformation(this.ha.va.Qd);
X=yl(X);for(var ta=X.next();!ta.done;ta=X.next())if(Object(fc.a)(Id.PivotTableRange,ta.value))return!1;return!0};G.prototype.nPg=function(X){if(X&&X.contains(this.sourceRange)&&!X.equals(this.sourceRange)){if(X.mva&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===X.top){var ta=new xc.Range(this.sourceRange.top,this.sourceRange.left,X.bottom,this.sourceRange.right,!1,!1);if(!ta.equals(X))return this.sourceRange=ta,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,
0),X}this.Xq?this.GQ=X.left===this.sourceRange.left&&X.right===this.sourceRange.right:this.isRow=X.left===this.sourceRange.left&&X.right===this.sourceRange.right;if(X.top===this.sourceRange.top&&X.bottom===this.sourceRange.bottom||this.a5())return X}return null};G.prototype.KXc=function(X){var ta=X.clone();this.a5()?ta.left=Math.max(X.left-this.Whd,1):ta.top=Math.max(X.top-this.$Wd,1);ta.right=ta.left+this.sourceRange.width-1;ta.bottom=ta.top+this.sourceRange.height-1;return this.pYb(ta)};G.prototype.bcf=
function(){var X=this.gd.topLeft.Rd(this.sourceRange);return X||this.Xq&&!this.tableRange?X:this.a5()?this.gd.top===this.sourceRange.bottom+1:this.gd.left===this.sourceRange.right+1};G.prototype.DZi=function(){if(this.a5()&&this.gd.left!==this.tableRange.left||!this.a5()&&this.gd.top!==this.tableRange.top){var X=yh.a.jd(1,1,0,884,0,2065438552,"RearrangeInvalidDest");Lg.a(this.$).St([X]);return!0}return!1};G.prototype.XUi=function(){var X=this,ta=this.$.Ub.Fc("UserAction","RearrangeRowColumnClientSide"),
tb={},Rb=(tb.CopyPasteTargetType=1,tb.OperationId=Ti.a.create().toString(),tb.Stopwatch=ta,tb.DragDropIsShiftKeyDown=this.zZ,tb.EncounteredDeploymentErrors=!1,tb),Fc=this.yZ?2:1,lc=this.$.da.Aa(254);(new Promise(function(Jd,he){X.wOe(function(Te){Te.Errors&&0<Te.Errors.length?he(new Xg.a(22,Te.Errors)):Jd(!0)},function(Te){Te=Ci.a.yg(Te.data);he(new Xg.a(22,Te))})})).then(function(){Jc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);lc&&lc.Xni(Rb,Fc,X.sourceRange,X.gd);return Promise.resolve(!0)},function(Jd){Jc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Jd?copyPasteInfra.getStringifiedError(Jd):"null",1);return lc?lc.IIi(Jd,Rb,Fc,X.sourceRange,X.gd):Promise.reject(Jd)})};G.prototype.wOe=function(X,ta){function tb(){return new w(Jd,lc)}function Rb(he,Te,yg){var Kg=Fc.$.qa.ta;he=X?Ef.b(he,X):he;Te=ta?Ef.a(Te,ta):Te;var Ug=Kg.Oa(41,null);Ug.sourceRange=Jd;
Ug.destinationRange=lc;return Ng.i(Kg,"RearrangeRowColumn",Ug,he,Te,yg,null,0)}var Fc=this;X=void 0===X?null:X;ta=void 0===ta?null:ta;var lc={};this.a5()?(lc.FirstRow=this.gd.top-1,lc.FirstColumn=0,lc.DeltaColumn=0,lc.DeltaRow=this.gd.bottom-this.gd.top+1):(lc.FirstRow=0,lc.FirstColumn=this.gd.left-1,lc.DeltaColumn=this.gd.right-this.gd.left+1,lc.DeltaRow=0);lc.LastRow=Wg.a.dz;lc.LastColumn=Wg.a.ew;lc.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.xb.getItemByName(this.$.xb.oa.name).sheetName;var Jd=
dd.v(this.sourceRange,this.$);me.EwaSettings.tc()?this.$.userOperationManager.ic(new kf.a(514,0,Rb,64,tb),null):this.$.userOperationManager.ic(new Ue.a(514,0,Rb,void 0,tb),null)};G.prototype.Fdc=function(X){X=lf.g(this.$).getRangeInformation(X);for(var ta=0,tb=X.length;ta<tb;++ta)if(Object(fc.a)(Id.PivotTableRange,X[ta]))return X=yh.a.jd(1,0,0,879,0,2105176604,"InsDelCellsPivotTable"),Lg.a(this.$).St([X]),!0;return!1};G.prototype.Tma=function(X,ta,tb,Rb,Fc){Fc=void 0===Fc?!1:Fc;var lc=rf.DOMElementExtensions.getBoundingClientRect(ta),
Jd=ta===this.fC[U.C5b]||ta===this.fC[U.NGe];if(this.Xq){var he=ta===this.fC[U.PGe]||ta===this.fC[U.B5b];this.isRow&&he||this.Lh&&Jd?he="100px":(Jd=this.isRow||Jd,he=(Jd?Fc?G.hDj:G.mDj:Fc?G.gDj:G.jDj)+"px");ta=Jd?ta===this.fC[U.C5b]?"top":"bottom":ta===this.fC[U.B5b]?"right":"left";X=100*(Jd?X.x-lc.x:X.y-lc.y)/(Jd?lc.width:lc.height);for(lc=1;4>=lc;lc++){Rb=document.createElement("div");var Te=document.createElement("div"),yg=document.createElement("div");Rb.appendChild(Te);Rb.appendChild(yg);Fc&&
(Te=document.createElement("div"),Rb.appendChild(Te),rf.DOMElementExtensions.kuc(Rb,G.psh),yg.style.fontWeight="bold");Rb.className=N.wqh;this.to[lc.toString()]=Rb;this.Nb.OG(tb,lc).Jh.appendChild(Rb);Rb=this.to[lc.toString()];Rb.style[ta]=he;Rb.style[Jd?"left":"top"]=X+"%"}}else for(Fc=(Jd?-G.lDj:-G.iDj)+"px",he=Jd?ta===this.fC[U.C5b]?"top":"bottom":ta===this.fC[U.B5b]||Rb?"right":"left",ta=100*(Jd?Rb?0:X.x-lc.x:X.y-lc.y)/(Jd?lc.width:lc.height),X=1;4>=X;X++)lc=document.createElement("div"),lc.className=
N.vqh,this.to[X.toString()]=lc,this.Nb.OG(tb,X).Jh.appendChild(lc),lc=this.to[X.toString()],lc.style[he]=Fc,lc.style[Jd?"left":"top"]=ta+"%"};G.prototype.FW=function(X){X=void 0===X?!1:X;var ta=this.gd.toString();if(this.Xq)for(var tb=1;4>=tb;tb++)this.to[tb.toString()].childNodes[0].innerText=ta,this.to[tb.toString()].childNodes[1].innerText=this.XHa,X&&(this.to[tb.toString()].childNodes[2].innerText=this.cRa);else for(X=1;4>=X;X++)this.to[X.toString()].innerText=ta};G.prototype.dzc=function(X){X=
void 0===X?0:X;X?1===X&&(this.zZ=!1):this.yZ=!1;this.Xq&&(this.yZ||this.zZ)||(h.KeyInputManager.instance.za(wf.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),this.Jmd=!1)};G.prototype.Yra=function(X){this.Nb.kl(this.Uia());this.UL(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"),void 0,X)};G.prototype.Rob=function(X){this.Nb.kl(this.qu);this.UL(this.OCb,this.PCb,void 0,X)};G.prototype.vZc=function(X){this.Nb.kl(this.qu);this.UL(this.I8a,this.L8a,void 0,X)};
G.prototype.BFb=function(X){X=void 0===X?!1:X;this.ru=5;this.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"));this.XHa=this.SGe;this.cRa=this.sYf;this.Tma(this.ica.clientPoint,this.ica.Sb,this.n$b(),!1,X)};G.prototype.qFd=function(X){X=void 0===X?!1:X;this.ru=6;this.jW(this.OCb,this.PCb);this.XHa=this.D5b;this.cRa=this.Zuc;this.Tma(this.ica.clientPoint,this.ica.Sb,this.isRow||this.GQ?11:12,!0,X)};G.prototype.xKf=function(X){X=void 0===X?!1:X;this.ru=6;this.jW(this.I8a,
this.L8a);this.XHa=this.D5b;this.cRa=this.Zuc;this.Tma(this.ica.clientPoint,this.ica.Sb,this.a5()?11:12,!0,X)};G.prototype.sec=function(X){return X.Ea.keyCode===ha.a.eBa||dg.a.isMac&&X.Ea.keyCode===ha.a.leb};G.prototype.a5=function(){return!this.Xq&&this.isRow||this.Xq&&this.GQ};G.prototype.n$b=function(){return this.Xq?45:6};G.prototype.Uia=function(){return this.Xq?G.bdh:G.edh};G.iDj=50;G.lDj=25;G.jDj=-85;G.mDj=-40;G.gDj=-120;G.hDj=-50;G.psh=41;G.Lze="copy";G.edh=[6];G.bdh=[45];Object(sc.a)(G,"DragSelectionClickBehavior",
U,[]);vm(r,P);r.prototype.dispose=function(){Fd.a.instance.za(wf.a.pointerDown,this.R$,this.onPointerDown);K.a.instance.za(wf.a.Ij,this.R$,this.Nba);this.gridView.$&&(this.gridView.ha.Oca(this.dr),this.gridView.ha.K_(this.Sh),this.gridView.$.ml(this.od),this.gridView.$.Ab.$qc(this.V5),this.gridView.$.Ab.Zqc(this.U5),me.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(this.gridView.dMf(this.XBb),this.gridView.rc.im(this.Nuf),this.gridView.rc.Rp(this.Muf)));
P.prototype.dispose.call(this)};Object(sc.a)(r,"FillHandleClickBehavior",P,[]);vm(z,I);tl.Object.defineProperties(z.prototype,{Zua:{configurable:!0,enumerable:!0,get:function(){return this.clg}}});z.Gue=[1,2,32,256,128,64];Object(sc.a)(z,"IPadSelectionClickThroughBehavior",I,[]);t.prototype.dispose=function(){this.gridView.ha.Oca(this.dr);this.gridView.ha.K_(this.Sh);this.gridView.ha.VMf(this.Sh)};t.prototype.lza=function(){this.c4a=0;this.cfc=!1;this.f5=Number.NaN};t.prototype.n6e=function(X){this.Azc(X.Sb,
1);return!0};t.prototype.o6e=function(X){this.Azc(X.Sb,-1);return!0};t.prototype.QGe=function(X){this.cfc=!0;this.Azc(X,1)};t.prototype.RGe=function(X){this.cfc=!1;this.Azc(X,-1)};t.prototype.Azc=function(X,ta){if(X)if(X.parentNode)if(this.Bmd)isNaN(this.f5)||(this.Mzc(this.f5,!1),this.f5=Number.NaN);else if(X=parseInt(X.parentNode.getAttribute(df.a.xwb)),isNaN(X))Jc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.f5)&&
X!==this.f5){if(this.cfc)return;this.Mzc(this.f5,!1)}if(isNaN(this.f5)||X!==this.f5)this.f5=X,this.c4a=0;!this.c4a&&0<ta&&this.Mzc(X,!0);this.c4a=Math.max(this.c4a+ta,0);!this.c4a&&0>ta&&(this.Mzc(X,!1),this.f5=Number.NaN)}else Jc.ULS.shipAssertTag(537159367,0,!!X.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else Jc.ULS.shipAssertTag(537159368,0,!!X,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};t.prototype.Mzc=function(X,ta){for(var tb=1;4>=
tb;tb++){var Rb=this.gridView.Nb.OG(3,tb,X).Jh;rf.DOMElementExtensions.toggleCssClass(Rb,N.bqh,ta);for(Rb=Rb.firstChild;Rb;Rb=Rb.nextSibling)Tf.a.contains(Rb.className,"resizemarqueehandle",!0)&&rf.DOMElementExtensions.toggleCssClass(Rb,N.fqh,ta)}};Object(sc.a)(t,"MarqueeHoveringManager",null,[]);var Di=b(963),nh=b(1252);vm(x,I);x.prototype.dispose=function(){Fd.a.instance.za(wf.a.VV,this.OJ,this.qxf);Fd.a.instance.za(wf.a.nz,this.OJ,this.Vxa);Fd.a.instance.za(wf.a.pointerDown,this.OJ,this.onPointerDown);
Xh.a.instance.za(wf.a.click,this.OJ,this.zCb);Xh.a.instance.za(wf.a.Ij,this.OJ,this.onDoubleClick);rf.DOMElementExtensions.Sf(this.YG);this.YG=null;rf.DOMElementExtensions.Sf(this.OJ);this.Hu=this.OJ=null;I.prototype.dispose.call(this)};x.prototype.SXa=function(X){this.Hu=Object(pe.a)(nh.a,X.metadata)};Object(sc.a)(x,"RangeCatchUpActivityHighlightBehavior",I,[]);vm(A,W);A.prototype.iRa=function(){return(this.gridView.inRangePicker||this.gridView.zi)&&W.prototype.iRa.call(this)};tl.Object.defineProperties(A.prototype,
{t4:{configurable:!0,enumerable:!0,get:function(){return 16}},Zab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.abd(!1)}}});Object(sc.a)(A,"RangePickerTouchGrippiesBehavior",W,[]);vm(m,I);Object(sc.a)(m,"RearrangeHighlightBehavior",I,[]);var Sd;(function(X){X[X.topLeft=0]="topLeft";X[X.topRight=1]="topRight";X[X.bottomLeft=2]="bottomLeft";X[X.bottomRight=3]="bottomRight";X[X.error=4]="error"})(Sd||(Sd={}));Object(sc.b)("Corner",Sd);vm(v,I);v.prototype.dispose=function(){var X=
this;this.HK.forEach(function(ta){Fd.a.instance.za(wf.a.pointerDown,ta,X.onPointerDown)});Array.clear(this.HK);I.prototype.dispose.call(this)};v.prototype.SXa=function(X){this.zaa=X;this.qme(X);this.rp.FIb(X,this.HK,this.DOd());this.Hx.lza()};v.prototype.Nj=function(X){X=hg.a(this.$).Fe(X);X=this.kYe(X,!1);if(!X)return!0;X=this.vBe(X);if(!X)return Jc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.f8b(!0),!1;if(this.gd.equals(X))return!0;this.gd=
X;X=this.t7();X||(Jc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.f8b(!0));return X};v.prototype.Zg=function(X){var ta=this;X=hg.a(this.$).Fe(X);X=this.lda();Jc.ULS.shipAssertTag(537159325,0,X,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");dg.a.xA&&(this.ha.Pcc(!0),window.setTimeout(function(){ta.ha.Pcc(!1)},100));this.f8b(!X);return X};v.prototype.kYe=function(X,ta){var tb=X.Sb;X=X.clientPoint;if(!tb||!X)return Jc.ULS.shipAssertTag(537159324,
0,!!tb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Jc.ULS.shipAssertTag(537159323,0,!!X,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ta&&(X=this.gnf(X));ta=this.ha.gr(X,tb,0,!0,!1,!0);ta||(X=this.gnf(X),ta=this.ha.gr(X,tb,0,!0,!1,!0));return ta};v.prototype.gnf=function(X){X.y+=this.Y2&&1!==this.Y2?-2:2;X.x+=this.Y2&&2!==this.Y2?-2:2;return X};v.prototype.vBe=function(X){if(!X||!this.sourceRange)return Jc.ULS.shipAssertTag(537159322,0,!!X,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),
Jc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(this.Y2){if(1===this.Y2)return new xc.Range(X.top,this.sourceRange.left,this.sourceRange.bottom,X.right,!0,!1);if(2===this.Y2)return new xc.Range(this.sourceRange.top,X.left,X.bottom,this.sourceRange.right,!0,!1);if(3===this.Y2)return new xc.Range(this.sourceRange.top,this.sourceRange.left,X.bottom,X.right,!0,!1)}else return new xc.Range(X.top,X.left,this.sourceRange.bottom,
this.sourceRange.right,!0,!1);Jc.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",Sd[this.Y2]);return null};v.prototype.lda=function(){return this.coloredReferencesManager.enf(this.qb,this.NK,this.gd)};v.prototype.t7=function(){return this.lda()};v.prototype.f8b=function(X){X&&Jc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");
this.Hx.RGe(this.HK[0]);this.rp.tHf(!1,this.zaa.W9);this.qb.textBox.setCaretPositionToEnd();this.qb.Nqc(this.f3e);this.I8f();this.MRa=this.gridView.MKa=!1;sg.b(this.$,!1);this.rp.UIf()};Object(sc.a)(v,"ResizeMarqueeBehaviorBase",I,[]);vm(u,v);u.prototype.yPf=function(){return[N.Nqh,N.Oqh,N.Lqh,N.Mqh]};u.prototype.gme=function(){return[N.Kqh]};u.prototype.CWe=function(X){X=X.Sb;if(X===this.HK[0])return 0;if(X===this.HK[1])return 1;if(X===this.HK[2])return 2;if(X===this.HK[3])return 3;Jc.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};u.prototype.sKf=function(){this.rp.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"),!0)};u.prototype.I8f=function(){this.rp.RUd(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"),!0)};u.prototype.VYf=function(X){return 2===(Qf.a.Wb=X.zb)&&!X.An};u.prototype.DOd=function(){return!0};u.prototype.ojf=function(){Jc.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};u.prototype.qme=function(X){for(var ta=yl(this.HK),tb=ta.next();!tb.done;tb=ta.next())tb.value.style.backgroundColor=X.Jh.style.borderColor};Object(sc.a)(u,"ResizeMarqueeMouseBehavior",v,[]);vm(f,v);f.prototype.dispose=function(){Qf.a.FMf(this.tCb);v.prototype.dispose.call(this)};f.prototype.yPf=function(){return[tg.a.Vph,tg.a.Uph]};f.prototype.gme=function(){var X=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),
ta=dg.a.Af;X=!X||ta;return[X?tg.a.GNe:tg.a.FNe,tg.a.b7b,X?tg.a.Tph:tg.a.a7b]};f.prototype.CWe=function(X){X=X.Sb;if(X===this.HK[0])return 0;if(X===this.HK[1])return 3;Jc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};f.prototype.sKf=function(){dg.a.Ku?this.rp.jW(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"),!1):this.rp.L0i(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,
this.Zg,"onPointerUp"))};f.prototype.I8f=function(){dg.a.Ku?this.rp.RUd(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"),!1):this.rp.lHj(Object(Sc.a)(this,this.Nj,"onPointerMove"),Object(Sc.a)(this,this.Zg,"onPointerUp"))};f.prototype.VYf=function(X){return 3===(Qf.a.Wb=X.zb)};f.prototype.DOd=function(){return 3===Qf.a.Wb};f.prototype.ojf=function(){Jc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};
f.prototype.qme=function(){};Object(sc.a)(f,"ResizeMarqueeTouchBehavior",v,[]);vm(l,I);l.Vpb=function(X,ta){var tb=document.createElement("div");tb.className=ta;X.appendChild(tb)};Object(sc.a)(l,"SelectionCutCopyBehavior",I,[]);vm(n,I);Object(sc.a)(n,"SelectionPasteBehavior",I,[]);vm(k,I);k.iqb=function(X,ta){var tb=document.createElement("div");tb.className=ta;X.appendChild(tb)};Object(sc.a)(k,"SelectionRangePickerBehavior",I,[]);vm(c,W);c.prototype.iRa=function(){var X=this.gridView.zi||this.gridView.isEditing;
return this.gridView.ha.va.Dh&&!X&&W.prototype.iRa.call(this)};tl.Object.defineProperties(c.prototype,{t4:{configurable:!0,enumerable:!0,get:function(){return 0}},Zab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.va.Qd}}});Object(sc.a)(c,"SelectionTouchGrippiesBehavior",W,[]);var Cj=Rd.a;vm(d,Cj);d.prototype.dispose=function(){this.gridView.Nb.L4i(this.rnb);this.Hx&&(this.Hx.dispose(),this.Hx=null);Cj.prototype.dispose.call(this)};Object(sc.a)(d,"GridHighlightsBehaviorManager",
Rd.a,[]);var Pf=Vf.a;vm(a,Pf);a.prototype.create=function(){var X=this;Ff.TaskExtensions.Ba(jg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb),function(ta){X.Fb(X.$.da.Aa(64)||new d(X.$,ta.result))},this.ma,3)};a.ja=function(X){X.da.Ha(149,new a(X))};Object(sc.a)(a,"GridHighlightsBehaviorManagerFactory",Vf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");je.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");gd.a.instance.mj(new gb);If.a.Yi('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:27px;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
If.a.Yi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
If.a.Yi(".ewa-svg-icon{height:100%;width:100%}");If.a.Yi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
vg.a.Ga(hd.ja);ih.a.Xi.Ha(141,new oc);vg.a.Ga(ze.ja);(function(){vg.a.Ga(function(X){ee.ja(X);me.EwaSettings.gH()?Qd.ja(X):Wd.ja(X);Kd.ja(X);mb.ja(X)})})();vg.a.Ga(Hc.ja);vg.a.Ga(db.ja);(function(){vg.a.Ga(function(X){X.da.Ha(134,new Yb(X));X.da.Ha(330,new Ha(X))})})();vg.a.Ga(Eb.ja);(function(){vg.a.Ga(function(X){Zb.ja(X);wb.ja(X)})})();Type.registerNamespace("Common.App.SessionExpiration");vg.a.Ga(S.ja);vg.a.Ga(a.ja);vg.a.Ga(ba.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/a9fb6707f0862a33a94a3ac906c79313/EwaDS.acc.js.map