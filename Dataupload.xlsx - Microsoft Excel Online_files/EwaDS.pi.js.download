(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1215:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.WBc="b-ring_Apc_Trans";a.xdg="cdn_static_resource_ewa_image";Object(y.a)(a,"ResourceHosts",null,[])},1262:function(y,D,b){function a(){}function d(u,v,m,A,x){this.url="";this.r4a=!1;this.j7=-1;this.testIteration=0;this.baseUrl=m;this.fsf=A;this.bid=v;this.result=new c(v,x)}function c(u,v){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=
this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=u;this.caller=v;this.reset()}y=b(0);var k=b(52),n=b(13),l=b(277);c.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(y.a)(c,"NetworkTestResult",null,[]);var f=b(599);d.prototype.JJd=function(){try{if(this.r4a)n.ULS.sendTraceTag(537155206,0,
50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.bid);else{this.reset();this.r4a=!0;this.result.startTimeMs=Date.now();var u=new l.QueryStringBuilder(this.baseUrl);u.e9("tid",this.result.startTimeMs.toString());this.url=u.toString();this.Xej();this.testIteration++;this.result.testIteration=this.testIteration}}catch(v){this.xsb("Exeption: "+v.message)}};d.prototype.reset=function(){this.url="";this.result.reset();this.r4a=!1;this.j7=-1};d.prototype.clearTimeout=
function(){-1!==this.j7&&(window.clearTimeout(this.j7),this.j7=-1)};d.prototype.Xej=function(){var u=this;try{var v=new XMLHttpRequest;v.onreadystatechange=function(){4===v.readyState&&(200===v.status?u.Vvh():u.xsb(String.format("Error when downloading resource. status code: {0}, status text: {1}",v.status,v.statusText),v.status.toString()))};v.onerror=function(){u.xsb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",v.status,v.statusText))};this.j7=
window.setTimeout(function(){u.j7=-1;u.xsb("Request timeout")},1E4);v.open("GET",this.url,!0);v.send(null)}catch(m){this.xsb("Exeption: "+m.message)}};d.prototype.Vvh=function(){this.r4a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.E1b())};d.prototype.xsb=function(u,v){v=void 0===v?null:v;this.r4a&&(this.clearTimeout(),this.result.errorMessage=u,this.result.isSuccess=!1,this.result.errorStatusCode=
v,this.E1b())};d.prototype.E1b=function(){this.r4a=!1;this.fsf&&this.fsf(this.result,this.bid)};Object(y.a)(d,"NetworkTestReq",null,[]);b.d(D,"a",function(){return a});a.Mad=function(u,v,m,A){A=void 0===A?null:A;a.fkc||(a.fkc=Array.isArray(k.a.li(m.ya.NetworkMeasurementUrlList))?k.a.li(m.ya.NetworkMeasurementUrlList):null);for(var x=[],t=0;t<a.fkc.length;t++){var z=a.fkc[t],r=z.key;r||(r=z.Key);if(!A||Array.contains(A,r)){var G=z.value;G||(G=z.Value);r&&G&&x.push(new d(m,r,G,u,v))}}return x};a.fkc=
null;Object(y.a)(a,"NetworkConnectionHelpers",null,[])},1378:function(y,D,b){function a(T){var Oa=li.call(this)||this;Oa.$=T;Oa.dc();return Oa}function d(T,Oa,Kb,ic){var pd=this;this.CK=null;this.G$f=function(){pd.CK&&(pd.oXd=Le.a.Ra.se.m,pd.hide(),ni.a.instance.create(function(){pd.MKj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.DFe=function(Td){10===Td&&pd.NHa()};this.Yah=function(){if(pd.CK){var Td=document.getElementById("PasteRecoveryUI");Td&&$d.a.rj===Td.getAttribute($d.a.bY)&&
Td.click();pd.NHa()}};this.EFe=function(){pd.NHa()};this.FFe=function(){pd.NHa()};this.onKeyUp=function(Td){if(pd.CK){if(pd.NZ)return!1;if(17===Td.Ea.keyCode&&pd.q7b){Td=document.getElementById("PasteRecoveryUI");if(!Td)return Bc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Gd=Td.getAttribute($d.a.bY)||"";if($d.a.pp===Gd)return Td.click(),!0}}return!1};this.onKeyDown=function(Td){if(pd.CK){pd.q7b=!1;pd.NZ=Td.ctrlKey;Td=Td.Ea.keyCode;if(27===Td)return pd.NHa(),
!0;if(17===Td)return pd.q7b=!0}return!1};this.Jxa=function(Td,Gd){Td=Gd.ee;pd.A6a=Td;-1027730316!==Td.command&&-1059615499!==Td.command?pd.NHa():(Gd=Gd.properties)&&Gd.launcherId!==pd.zLh()&&pd.NHa()};this.$=T;this.qpc=Oa;this.Et=Kb;this.nk=ic;this.uqd=this.A6a=this.eqd=null;this.NZ=this.q7b=this.T4b=this.icc=!1;this.oXd=0;this.$.da.Ha(406,this)}function c(T){var Oa=vh.call(this)||this;Oa.$=T;Oa.dc();return Oa}function k(T,Oa,Kb){Kb=void 0===Kb?!0:Kb;var ic=jj.call(this)||this;ic.vRa=null;ic.ina=
null;ic.ANa=null;ic.R1b=null;ic.k0=null;ic.Wnf=0;ic.G$a=!1;ic.F$a=!1;ic.Ypc=!1;ic.documentVisibilityObserver=null;ic.Xnf=null;ic.uuj=null;ic.afa=!1;ic.h7=0;ic.djd=0;ic.myb=!1;ic.N0f=0;ic.lOd=!1;ic.w0=null;ic.FCb=function(){Bc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");ic.Ijc(1,!1)};ic.Nxa=function(){ic.Zja||ic.jAb?window.setTimeout(function(){ic.nTd()},ic.Wnf):ic.nTd();ic.documentVisibilityObserver.dGb(ic.Nxa);ic.myb=!1};ic.Rh=function(){Bc.ULS.sendTraceTag(537155218,
0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",ic.jAb&&ic.jvc,ic.Dic&&!ic.afa&&ic.lJb);ic.jAb&&ic.jvc&&ic.Ihe();ic.Dic&&!ic.afa&&ic.lJb&&ic.Fhe();Df.g(ic.$).rc.Rp(ic.Rh);ic.F$a=!1;ic.G$a=!1};ic.Gwf=function(){Bc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");ic.Ijc(1,!0);ic.F$a&&!ic.G$a&&Df.g(ic.$).rc.Rp(ic.Rh);ic.F$a=!1};ic.Uba=function(pd,Td){ic.djd=ic.h7;ic.h7=Td.eyc};
ic.Kzf=function(){ic.$&&(ic.Ypc||(ha.a(ic.$).gQ(K.a.kOa).eAg(ic.Rwf),ic.$.Rk(ic.od),ic.Ypc=!0),ic.afa=ic.X8h(),ic.Ijc(2,!1))};ic.Rwf=function(){var pd=ha.a(ic.$).ui,Td=pd.rGg();pd=mi.f(pd.es.nd.errors,function(Gd){return Gd.MessageIdName});Bc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Td,ic.afa,wg.a.Hc(pd));Td&&(ic.vRa?(ic.afa=!1,ic.uDe(),ic.ezc()):ic.ina&&(ic.vDe(),ic.ezc()))};ic.od=function(){ic.$?
(Bc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),ic.afa=!1,me.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&ic.k0&&ic.k0.Qo&&(Zg.a.Fa(ic.k0),ic.k0=null),me.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&ic.w0&&ic.w0.Qo&&(Zg.a.Fa(ic.w0),ic.w0=null),ic.Ijc(2,!0),ic.ezc()):Bc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};
ic.lsf=function(){ic.Rmf(!0)};ic.msf=function(){ic.Rmf(!1)};ic.GUb=G.Pki;ic.x0c=G.connected;ic.$=T;ic.uf=T.qa.uf;ic.QYf=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");ic.lJb=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");ic.jvc=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Kb&&(ic.Xnf=new f(T,Oa));me.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&
ic.$.da.Za(291,function(pd){ic.documentVisibilityObserver=pd});ic.jvc&&(me.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||ic.$.da.Za(291,function(pd){ic.documentVisibilityObserver=pd}),ic.Wnf=ic.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,ic.uf.lBg(ic.FCb),ic.uf.omb(ic.Gwf),ic.uf.yke(ic.lsf),ic.uf.Kzg(ic.msf));if(ic.QYf||ic.lJb)ic.uuj=new n(ic.$,ic);ic.Gjf=ic.$.ya.LongInactivityTimePeriodSeconds;ic.$.fa.PTc(ic.Kzf);ic.$.fa.Df.dra(ic.Uba);ic.lJb&&(ic.N0f=
ic.$.ya.SilentReopenDuringWorkDelayMs);return ic}function n(T){var Oa=this;this.W6=null;this.Lzf=function(Kb,ic){Oa.Izf(ic,3)};this.bwf=function(Kb,ic){Oa.Izf(ic,2)};this.$=T;this.pg=nf.a(this.$).pg;this.pg.dle(this.bwf);this.pg.yCg(this.Lzf)}function l(T,Oa,Kb,ic){T=r.call(this,T,Oa,Kb)||this;T.wasInteruptedByOfflineMode=!1;T.type=ic;T.wasInteruptedByOfflineMode=!1;return T}function f(T,Oa){this.Xka=this.uvd=this.Zpf=null;this.$=T;!me.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||
me.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&bf.a.zf||(this.Zpf=new u(T,Oa));me.EwaSettings.la(212)&&(this.uvd=new A(this.$),this.uvd.S2h());!me.EwaSettings.la(588)||me.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&bf.a.zf||(this.Xka=new Ag.NetworkConnectionHealthChecker(this.$));this.PXg=new x(this.$)}function u(T,Oa){var Kb=this;this.zNa=this.ZT=null;this.BCd=-1;this.Ksb=null;this.Dgf=Sf.Task.delay(0);this.F8a=function(ic,
pd){pd.ZO?Kb.NHi(pd.wna):Kb.OHi()};this.Vba=function(ic,pd){5===pd.HCf&&Kb.H1a()};this.ARf=function(ic,pd){Kb.ZT.oij(pd.rU)};this.H1a=function(){Kb.zNa.SIj();Kb.scj(u.HAd,Sys.Serialization.JavaScriptSerializer.serialize(Kb.zNa))};this.s8i=function(ic){if(ic=ic.result)Kb.Vbg=!0,Bc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",ic)};this.z2i=function(){Kb.Vbg&&(Kb.$?gg.TaskExtensions.Ba(Kb.indexedDB.D4c(u.HAd),
function(){Bc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},Kb.$.ma):Bc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.GNa=function(){if(Kb.zNa&&0<Kb.zNa.count){var ic=Sys.Serialization.JavaScriptSerializer.serialize(Kb.zNa);Bc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",
ic)}};this.$=T;this.indexedDB=Oa;this.Vbg=!1;this.indexedDB.og()&&(this.indexedDB.initialize(u.kjd,u.ljd),this.M7i(),this.zNa=new m(this.$.ya.UserSessionId),nf.a(this.$).pg.vTc(this.F8a));this.nk=xb.a.instance.VD();this.nk.ja("beforeunload",this.GNa)}function v(T,Oa,Kb){T=r.call(this,T,Oa,Kb)||this;T.timeFromLastOffline=0;T._errorDataDuringOfflineMode=null;T.timeFromLastOffline=-1;T.type=5;return T}function m(T){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;
this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=T}function A(T){var Oa=this;this.EQf=null;this.pqd=this.sud=this.ABb=this.BBb=0;this.sOd=!1;this.n0c=this.ARa=this.uwc=this.H7a=null;this.C0c=0;this.afj=function(){if(12E4>Oa.$.fa.Df.cdb)for(var Kb=yl(Oa.uwc),ic=Kb.next();!ic.done;ic=Kb.next())ic.value.JJd();else Oa.bRd("UserInactive")};this.B8i=function(Kb){Kb=Sys.Serialization.JavaScriptSerializer.serialize(Kb);Bc.ULS.sendTraceTag(388821830,0,50,Kb)};this.R7i=function(Kb){if(Kb){var ic=
Oa.n0c[Kb.testIteration.toString()];ic?ic.push(Kb):(ic=[Kb],Oa.n0c[Kb.testIteration.toString()]=ic);if(ic.length===Oa.EQf.length){ic=Sys.Serialization.JavaScriptSerializer.serialize(ic);if(Oa.$&&Oa.$.uf){if(Kb.EstimatedLatency=Oa.$.uf.zqe,Oa.$.uf.zqe>Oa.$.ku.ExcelRountripThresholdMs){Bc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",ic,Oa.C0c++);return}}else Bc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");
Bc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",ic);Oa.C0c=1}}};this.Zh=function(Kb,ic){Kb=ic.context.methodName;if(Kb===df.a.Z2a||Kb===df.a.Pua)Oa.ABb++,Kb=Date.now(),Oa.wpj(Kb)&&(Oa.ABb=0,Oa.pqd=Kb,Oa.vxj())};this.Uba=function(){Oa.KQd("OnThrottledUserActivity")};this.HV=function(){Oa.bRd("OnDocumentHidden")};this.Nxa=function(){Oa.KQd("OnDocumentUnhidden")};this.$=T;if(this.tOd=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.xSg())this.EQf=
[Ti.a.WBc],this.C0c=1,this.n0c={},this.$.fa.Df.dra(this.Uba),this.$.da.Za(291,function(Kb){Kb.aFa(Oa.HV);Kb.imb(Oa.Nxa)})}function x(T){var Oa=this;this.whc=this.data=null;this.g9c=0;this.Sye=null;this.nsf=function(Kb,ic){ic.ZO?(Oa.data=new z(Le.a.Ra.Kb,Oa.$,5===ic.wna,!!ic.wna,Oa.$.uf.disconnectionSource,Oa.Sye),Oa.whc=Oa.$.uf.Jgf,Oa.g9c=1,Oa.$.qa.uf.$Cg(Oa.Xo),xh.a(Oa.$).fTc(Oa.zRf)):(Oa.data.MAi(Oa.$,5===ic.wna),Oa.$.qa.uf.kNf(Oa.Xo),Oa.data.lastFailedRequestToOnlineTimeGapSec=th.getElapsedSeconds(Oa.whc,
Le.a.Ra.Kb),me.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?$f.b().bIb(557682689,0,50,t.connectivityIssues,Oa.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",wg.a.Hc(Oa.data)):Bc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",wg.a.Hc(Oa.data)),me.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
Oa.data&&Oa.data.isToastShown&&Wc.Health.instance.recordQosError(Bf.a.kUg,[Uf.a.Shc],!0,!1,!1,!1,null),xh.a(Oa.$).JGd(Oa.zRf),Oa.data=null)};this.zRf=function(Kb,ic){Oa.data.nij(ic.rU)};this.Xo=function(Kb,ic){Oa.data.a_i(ic.context.methodName);Kb=Le.a.Ra.Kb;ic=th.getElapsedSeconds(Oa.whc,Kb);Oa.whc=Kb;ic>Oa.data.longestDurationBetweenFailedRequestsSec&&(Oa.data.longestDurationBetweenFailedRequestsSec=ic);Oa.g9c++;Oa.data.averageDurationBetweenFailedRequestsSec=Oa.SOg(ic)};this.ksf=function(Kb,ic){Oa.Sye=
ic.KEj};this.$=T;nf.a(this.$).pg.zke(this.nsf);this.$.uf.yke(this.ksf)}function t(){}function z(T,Oa,Kb,ic,pd,Td){T=r.call(this,T,Oa,ic)||this;T.swappedByOffline=!1;T.swappedOffline=!1;T.averageDurationBetweenFailedRequestsSec=0;T.longestDurationBetweenFailedRequestsSec=0;T.lastFailedRequestToOnlineTimeGapSec=0;T.disconnectionSource=null;T.errorDataDuringConnectivityIssuesMode=null;T.failedRequests=[];T.triggeringRequest=null;T.type=4;T.swappedOffline=Kb;T.disconnectionSource=Enum.toString(bh.a,pd);
T.triggeringRequest=Td;return T}function r(T,Oa,Kb){var ic=this,pd;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.brf=function(Td,Gd){ic.blockedOperationsCount++;
Td=String.format("{0}_{1}_{2})",Gd.componentName,Gd.actionName,Gd.details);ic.blockedActions[Td]=ic.blockedActions[Td]?ic.blockedActions[Td]+1:1;ic.isToastShown&&ic.blockedUserOperationsWhileToastShown++};this.Jzd=function(Td){ic.durationUntilUserInactive=th.getElapsedSeconds(ic.startTime,Le.a.Ra.Kb);Td.jNf(ic.Jzd)};this.HV=function(){ic.hasTabbedOut=!0};this.Vba=function(Td,Gd){Gd.HCf!==ic.type||ic.isToastShown||(ic.durationUntilToastShownMs=rh.a(Le.a.Ra,ic.startTime),ic.toastRaiser=Gd.toastRaiser,
ic.isToastShown=!0)};this.startTime=T;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Kb;if(null===(pd=Oa.fa)||void 0===pd?0:pd.Df)this.wasUserActiveOnPIStart=Oa.fa.Df.Yq;this.ak(Oa);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Oa.Ab.dR,T=Oa.da.Aa(183),this.isTaskPaneShown=!!T&&T.isVisible&&!T.isCollapsed,this.isTaskPaneCollapsed=!!T&&T.isVisible&&T.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=
!1}function G(){}function w(T){var Oa=Yg.call(this)||this;Oa.Nc=T;Oa.dc();return Oa}function B(T,Oa,Kb){Kb=void 0===Kb?null:Kb;var ic=eh.call(this)||this;ic.wZa=null;ic.i4a=null;ic.hdc=null;ic.iCa=null;Bc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");ic.$=T;ic.yjb=new S(T);ic.o3h(T,Kb);Kb=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMOWaitsForMergeToEnd",!1);ic.jfa=new Y(ic.iCa,ic.yjb,!Kb);ic.bId=new U(T,ic.jfa,Oa,Kb);me.EwaSettings.la(255)&&(ic.hdc=new pa(T,
ic));Bc.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created");return ic}function U(T,Oa,Kb,ic,pd,Td){pd=void 0===pd?null:pd;Td=void 0===Td?null:Td;var Gd=eg.call(this)||this;Gd.gGe=null;Gd.Bma=null;Gd.crb=null;Gd.Zyb=0;Gd.u6a=null;Gd.$yb=null;Gd.Txf=function(ge,Pe){Gd.hFe?Gd.gGe.nQi(Pe.Cba):Gd.crb&&Gd.vTf(Pe.Cba)};Gd.kDb=function(ge,Pe){Pe.kwa?Gd.cxj():Gd.Wwc()};Gd.gwf=function(){Gd.Zyb=0};Gd.ATf=function(){var ge=Gd.BV.cac();Q(Gd.ta,null!=ge.SuspensionStartTimestamp?ge.SuspensionStartTimestamp:
0,null,function(){Gd.ZFi(ge)},null,null,Gd.ta.Xb())};Gd.tBa=function(ge,Pe){if(Pe){Pe.Gmb.MergeCount=Gd.BV.cac();var gf=Df.g(Gd.$).Osi();ge=gf.min;gf=gf.max;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Pe.Gmb.ClientRevisions=Object.assign(new ca,{Min:ge,Max:gf,MaxFromBlockCache:Df.g(Gd.$).Ca.Slf}):Pe.Gmb.ClientRevisions=Object.assign(new ca,{Min:ge,Max:gf})}};Gd.$=T;Gd.vra=Kb;Gd.xej=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1);
Gd.xej&&(Gd.Bma=new N(Gd.$));Gd.BV=Oa;Gd.BV.XBg(Gd.Txf);Gd.BV.$Xb(Gd.kDb);Gd.BV.fBg(Gd.gwf);Gd.$.qa.fra(Gd.tBa);Gd.ta=Gd.$.qa.ta;Gd.HGb=Gd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;Gd.wii=Gd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;Gd.hFe=ic;Gd.hFe?(Gd.gGe=pd||new I(Gd.ta,Gd.$,null,null,Gd.Bma),Bc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")):Td?Gd.crb=Td:gg.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(Gd.$.da,12,477,3),function(ge){var Pe=new W(Gd.ta,Gd.$);Gd.crb=
ge.result.Qpb(Pe,Pe,null,"RequestController");Bc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");2===Gd.BV.getState()&&Gd.vTf(Gd.BV.cac())},Gd.$.ma);return Gd}function N(T){var Oa=this;this.Rwc=0;this.cJ=this.Wv=null;this.jT=new ia;this.Hg=function(){Oa.aqe(!0)};this.e8a=function(){Oa.aqe(!1)};this.$=T;this.gridView=Df.g(this.$);this.gridView.Ca.np(this.Hg);this.gridView.Ca.gq(this.e8a);this.gridView.Ca.pke(this.e8a);this.gridView.Ca.nga(this.e8a);this.W7i=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5712698_ReportDivergenceInSelectionAdjust");
this.C8i=me.EwaSettings.isChangeGateEnabled("OfficeVSO:6011722_reportSelections");this.WEf=me.EwaSettings.isChangeGateEnabled("OfficeVSO:6022585_PreventBlocksCheckForNonContinuous");this.Yze=me.EwaSettings.isChangeGateEnabled("OfficeVSO:6022587_NoAdjustIsNotDivergence2");me.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&this.$.da.Za(276,function(){ng.a(Oa.$).f9(Oa.jT)})}function P(T,Oa,Kb,ic,pd){this.MF=Oa;this.T8=Kb;this.QUb=ic;this.Tfg=pd;this.JBa&&(this.v_d=
Df.g(T).Ca.l2a(this.selectedRanges[0],pd))}function ia(){this.totalRequests=this.errors=this.nonContinuous=this.divergence=this.adjusted=this.adjustedDidntChange=0}function W(T,Oa,Kb){this.tMa=null;this.ta=T;this.HGb=Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;var ic=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;this.Xu=function(){Oa.cKd(ic)};this.Pg=(void 0===Kb?null:Kb)||Le.a.Ra;this.PMb=0;return this}function R(){}function I(T,Oa,Kb,ic,pd){this.tMa=null;this.Ozd=0;this.ta=T;this.HGb=Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;
var Td=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;this.Xu=function(){Oa.cKd(Td)};this.Pg=(void 0===Kb?null:Kb)||Le.a.Ra;this.PMb=0;this.aO=void 0===ic?null:ic;this.Bma=void 0===pd?null:pd}function Q(T,Oa,Kb,ic,pd,Td,Gd){Gd=T.Oa(1,void 0===Gd?null:Gd);Gd.suspensionStartTimestamp=Oa;return Id.i(T,"KeepBlockingPendingMerges",Gd,Kb,ic,pd,Td,0)}function O(T,Oa,Kb,ic,pd,Td,Gd){Gd=T.Oa(1,void 0===Gd?null:Gd);Gd.viewportState=Oa;return Id.i(T,"DoPendingMergeWithSelectionAdjust",Gd,Kb,ic,pd,Td,0)}function ba(T,
Oa,Kb,ic,pd,Td){Td=T.Oa(1,void 0===Td?null:Td);return Id.i(T,"DoPendingMerge",Td,Oa,Kb,ic,pd,0)}function ca(){}function S(T){var Oa=Ee.call(this)||this;Oa.s1=null;Oa.zhc=0;Oa.sBa=function(Kb,ic){var pd;if(null===(pd=null===ic||void 0===ic?void 0:ic.yd)||void 0===pd?0:pd.MergeCount)He.a.equals(ic.yd.SessionId,Oa.$.fa.sessionId,!1)?Oa.WNa(ic.yd.MergeCount,S.P5c):Bc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",ic.yd.MergeCount.Current,ic.yd.MergeCount.Pending)};Oa.KAb=function(Kb,
ic){(null===ic||void 0===ic?0:ic.Cba)&&Oa.WNa(ic.Cba,S.BXd)};Oa.Jtc=function(){Oa.qPf();Oa.uHf(Oa.s1)};Oa.l8a=function(Kb,ic){ic.eye&&Oa.s1.SuspensionStartTimestamp&&Bc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",na(Oa.s1))};Oa.qPf();Oa.$=T;Oa.$.qa.us(Oa.sBa);Oa.$.fa.Sj(Oa.Jtc);Oa.$.fa.aP(Oa.Jtc);Df.g(Oa.$).Kc.hq(Oa.l8a);Oa.$.da.Za(292,function(Kb){Kb.nmb(Oa.KAb);Bc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Oa}
function Y(T,Oa,Kb){var ic=oe.call(this)||this;ic.yCb=function(pd,Td){pd=ic.getState();var Gd=ic.t5;ic.t5=Td.Cba;Td=ic.getState();ic.Lni(pd,Td,Gd);ic.raiseEvent(Y.gud);ic.NQe(pd,Td)};ic.ZNa=function(pd,Td){pd=ic.getState();ic.oH=Td.oH;Td=ic.getState();ic.NQe(pd,Td)};ic.jha=T;ic.jha.XXb(ic.ZNa);ic.s9a=Oa;ic.s9a.nmb(ic.yCb);ic.t5=Object.assign(new gc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});ic.oH=ic.n3h();ic.Ufh=Kb;ic.wwh=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMergeSuspensionCheck",
!1);return ic}function ma(T){var Oa=$c.call(this)||this;Oa.kwa=T;return Oa}function Z(T){return(null===T||void 0===T?void 0:T.SuspensionStartTimestamp)&&T.Pending>T.Current}function xa(T,Oa){return T||Oa?T&&Oa?T.Current===Oa.Current&&T.Pending===Oa.Pending&&T.SuspensionStartTimestamp===Oa.SuspensionStartTimestamp:!1:!0}function na(T){return T?String.format("{0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp):null}function pa(T,Oa){var Kb=Vb.call(this)||this;Kb.statusBarManager=null;Kb.Hvd=
!1;Kb.yCb=function(ic,pd){ic=String.format("{0}{1}",pd.Cba.Current===pd.Cba.Pending?"\u26ad":"\u26ae",pd.Cba.Current);He.a.equals(Kb.ikc,ic,!1)||(Kb.ikc=ic,Kb.gz())};Kb.ZNa=function(ic,pd){ic=pd.oH;Kb.Hvd!==ic&&(Kb.Hvd=ic,Kb.gz())};Kb.mergeSuspensionManager=Oa;Kb.mergeSuspensionManager.s9a.nmb(Kb.yCb);Kb.ikc="";aa.a.Z1(1905775613,ea.a.Jc,0,1);Kb.Ka=T.Ka;Kb.xLb=new Ia;T.da.Za(29,function(ic){Kb.mergeSuspensionManager&&(Kb.statusBarManager=ic,ic.$I(Kb),Kb.mergeSuspensionManager.jha.XXb(Kb.ZNa))});Kb.Ka.a2(Kb.xLb);
return Kb}function Ia(){return ab.call(this)||this}function Ma(T,Oa){Oa=void 0===Oa?null:Oa;var Kb=H.call(this)||this;Kb.zpa=!1;Kb.fN=function(){Kb.refresh()};Kb.ysf=function(){Kb.refresh()};Kb.$=T;Kb.l5d=Oa||ha.a(T).gQ(K.a.idle);ha.a(T).dTc(Kb.ysf);Kb.h4a.iq(Kb.fN);Kb.refresh();return Kb}function lb(){var T=pc.call(this)||this;T.Bgf=null;T.eQa=new Vf.a;return T}function zb(T,Oa){this.handler=null;this.publisher=T;this.oH=Oa}function Ya(T){var Oa=mc.call(this)||this;Oa.zpa=!1;Oa.trf=function(){Oa.refresh()};
Oa.urf=function(){Oa.refresh()};Oa.gridView=Df.g(T);Oa.gridView.Kc.wm(Oa.urf);Oa.gridView.Kc.hq(Oa.trf);Oa.refresh();return Oa}function Wb(T){return we.call(this,T)||this}function Zb(T){this.$=T}function da(T,Oa,Kb,ic,pd,Td){var Gd=Lb.call(this,null,Kb,ic)||this;Gd.Pjf=0;Gd.gIi=function(ge){$h.a(ge)?Bc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",Ec.a.Uc(ge.Errors)):(Bc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),
ge.Result?ch.a(Gd.$).zma(1,ge.Result):Bc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};Gd.fIi=function(){Bc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Gd.$=T;Gd.ee=Oa;Gd.s0=Td;Gd.Bne=Zf.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Gd.showDialog();return Gd}function za(T,Oa,Kb,ic,pd,Td){var Gd=jc.call(this)||this;Gd.efc=!1;Gd.Gva=null;Gd.jR=
null;Gd.GMa=null;Gd.Czi=function(){Gd.Lta(Gd.Unb)};Gd.Ypd=function(ge){ge.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==ge.target.id||ge.shiftKey?"KeepFocusStartDiv"===ge.target.id&&ge.shiftKey&&(ge.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(ge.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Gd.pGi=function(){Gd.Omb&&(Gd.Omb.launchUpsellExperience("stockimages"),Bc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Gd.Wn=
Td;Gd.$=T;Gd.u8e=Oa;Gd.Omb=Kb;Gd.Cza=[];Gd.jmf=ic;Gd.$$g=pd;Gd.Wme=Gd.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Gd.xf=Gd.v2g();return Gd}function hb(){}function Gb(T,Oa){return h.call(this,T,Li.a.laa(Oa))||this}function Sb(T,Oa,Kb,ic,pd,Td,Gd){T=Fb.call(this,T,Oa,Kb,ic,pd,!1)||this;T.lWd=!1;T.s0=Gd;T.Wcc=Sb.dAh(Td);if(Td=T.LWd(T.Wcc.name,T.Wcc.size))return T.F_f(Td),T.s0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),T.dispose(),T;T.Cj=new sa(T.$.domElement,Object(nc.a)(T,
T.nDb,"onUploadFrameInitialized"),Object(nc.a)(T,T.aoa,"uploadResponseReceived"),ic,!1,T.$);return T}function Fb(T,Oa,Kb,ic,pd,Td){Td=void 0===Td?!0:Td;var Gd=Lb.call(this,null,Kb,ic)||this;Gd.lr=null;Gd.L$=null;Gd.Gyb=!1;Gd.gBd=null;Gd.aoa=function(ge){Gd.AXd.stop();Gd.wZb.cancel();if(sa.pai(ge))Gd.jyc?Gd.G2e(4):(ge=new be.a(0,2,null,null,!1,null,null,null),ge.status=8,Gd.XTd(new Je.a(ge),null,"InsertPictureWebMethod")),Bc.ULS.sendTraceTag(537155796,0,50,"Http Error occurred, isTimeoutError: {0}",
Gd.jyc);else{var Pe=Fb.sNj(ge);Pe?(Bc.ULS.sendTraceTag(537155797,0,50,"Server returned error, response: {0}",ge),Gd.G2e(Pe)):Gd.MYh(ge)}Gd.Vmc();Gd.dispose()};Gd.DCi=function(ge){Gd.jBa(ge,Gd.Cj)&&Gd.finalizeUpload(Gd.Cj,null)};Gd.nDb=function(ge){Bc.ULS.sendTraceTag(537155795,0,50,"Upload frame initialized");Gd.Cj=ge;if(!Gd.m0a){if(Gd.lWd){if(Fb.xte()||Gd.C7a&&bf.a.ME){ge.m5b(Gd.DCi);return}var Pe=ge.m5b(null);if(!Gd.jBa(Pe,ge))return}Gd.finalizeUpload(ge,null)}};Gd.ILi=function(){Gd.jyc=!0};Gd.vb=
T;Gd.ee=Oa;Gd.AXd=T.Ub.Xh("WebServiceCall","InsertPictureOperation");Gd.wZb=ni.a.instance.create(Gd.ILi,1E5,yh.a.KQi,!1);Gd.jyc=!1;Gd.Ftd=Gd.$.ya.InsertPictureMaxFileSizeBytes;pd&&(Gd.Gyb="TestOnly"in pd);Td&&Gd.showDialog();return Gd}function wa(T,Oa){this.dataUri=this.sheetName=null;this.sheetName=T;this.dataUri=Oa}function va(T,Oa,Kb){var ic=Da.call(this,T,!1)||this;ic.sU=null;ic.qAa=!1;ic.YQ=function(){ic.qVd("");ic.hzc();return!1};ic.$=Oa;ic.kAc=T;ic.Iu=Dh.a.instance;ic.ga=Kb;ic.iXf();ic.aV();
ic.$.Ab.XJ=!0;return ic}function sa(T,Oa,Kb,ic,pd,Td,Gd){T=sb.call(this,T,Oa,Kb,ic,pd,"UploadFrame",Td.fa.sessionId,"image/*",!1,null,void 0===Gd?!1:Gd)||this;T.$=Td;T.Eag=!0;me.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?T.i8e():T.Wne();return T}function sb(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe,gf,kg){Pe=void 0===Pe?!0:Pe;kg=void 0===kg?!1:kg;this.UPe="FileUpload.ashx";this.Kn=null;this._initialized=!1;this.Jg=this.fhb=this.nGc=this.Wfa=this.NQb=this.Iq=this.gs=
null;this.sm=!1;this.nD=this.OQb=this.LQc=null;this._parent=T;this.Tlg=Oa;this.pqg=Kb;this.m4d=pd;this.JOc=Gd;this.hZd=ge;this.h0d=void 0===gf?null:gf;this.KQc=!1;this.kmg=ic.ra("CanaryRenewalForFileUploadIsEnabled");this.Eag=!1;(this.aqa=kg)||this.D_g(Td);Pe&&this.i8e()}function Tb(T,Oa,Kb){if(T){var ic=0;do{try{T();break}catch(pd){if(Bc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",ic,Kb,pd.message,pd.stack),ic>=Oa)break}ic++}while(1)}}
function Da(T,Oa){return Ra.call(this,T,void 0===Oa?!0:Oa)||this}function Sa(){}function Ra(T,Oa){Oa=void 0===Oa?!0:Oa;var Kb=Tg.call(this,!1,!1,Ra.gy)||this;Kb.$Va=null;Kb.I3d=!1;Kb.Vm=[];Kb.Cj=null;Kb.TVb=T;Kb.drg=Oa;Kb.qfe=!1;Kb.gu=!1;Kb.Wfa=null;Kb.oGc=!1;Kb.xf=Kb.Z$g;Kb.Me="InsertFileDialog";Kb.Cc(1,Kb.tWb);if(Ra.gy){T={};Oa={};var ic={};Kb.$Va=(ic.id=Kb.Me,ic.bodyControls=(Oa.uploadButtonProps=(T.label=CommonUIStrings.l_DialogChooseFile,T.onExecute=Object(nc.a)(Kb,Kb.mMi,"onUploadButtonClick"),
T),Oa),ic.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,ic.onFrameReady=Object(nc.a)(Kb,Kb.cDi,"onFrameReady"),ic);Kb.initializeAndShow(Kb.titleText,Object(nc.a)(Kb,Kb.zdc,"insertDialogHandler"),Kb.$Va);Kb.oQb=!0}else Kb.showDialog(Kb.titleText,Object(nc.a)(Kb,Kb.zdc,"insertDialogHandler")),Oa&&Kb.iXf(),(T=Kb.BU(1))&&Kb.Vm.push(T),(T=Kb.BU(0))&&Kb.Vm.push(T),Kb.q$f(),Kb.oQb=!1;return Kb}function Lb(T,Oa,Kb){T=Ja.call(this,T,Oa,Kb)||this;T.Oqa=null;T.wTb=null;return T}function Ja(T,Oa,Kb){this.Cj=
this.Gzd=null;this.iEa=this.sqa=0;this.PQb=null;this.mS=T;this.je=Oa;this.ub=Kb;this.m0a=!1;this.lWd=!0;this.J9i();this.C7a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function wb(T,Oa){this.filename=T;this.blob=Oa}function Mb(T){var Oa=cf.call(this)||this;Oa.bjd=null;Oa.$=T;Oa.dc();return Oa}function Eb(T){var Oa=ke.call(this)||this;Oa.$=T;Oa.dc();return Oa}function Ic(T,Oa){this.bRe=T;this.pwh=Oa}function Zc(T){this.$=T}function Pc(T){var Oa=jd.call(this)||this;Oa.$=T;Oa.dc();return Oa}function vd(T,
Oa,Kb){var ic=Dc.call(this)||this;ic.statusBarManager=null;ic.oFe=function(){ic.P4b()};ic.Gah=function(){ic.P4b()};ic.nFe=function(pd){10===pd&&ic.P4b()};ic.onKeyDown=function(pd){if(13===pd.Ea.keyCode){pd=new xf.a(237279923,1,2,6,null);var Td={};ic.$.Ka.Zb(pd,(Td[$d.a.skipClipboardAccess]=!0,Td[$d.a.lJe]=!0,Td));return!0}return!1};ic.$=T;ic.Et=Oa;ic.nk=Kb;ic.Y6c=!1;ic.EZf=me.EwaSettings.getBooleanFeatureGate(Cd.a.QOa,!1);ic.EZf&&ic.$.da.Za(29,function(pd){ic.statusBarManager=pd;pd.$I(ic)});return ic}
function Tc(T){var Oa=ei.call(this)||this;Oa.$=T;Oa.Om=Mg.a.instance;Oa.dc();return Oa}function rb(T){var Oa=this;this.F3b="";this.T1=this.Cr=null;this.zoc=!1;this.l5e=function(Kb,ic){Oa.hide(void 0===Kb?null:Kb,void 0===ic?null:ic)};this.gridView=Df.g(T);this.gridView.ha.jG(this.l5e)}function eb(){}function Ta(T,Oa){var Kb=Ng.call(this,T)||this;Kb.Jo=null;Kb.g6h=function(ic,pd){1===ic?(ic=Ta.xah[pd[Ta.wah]],Bc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",
ic?"Vertical":"Horizontal"),Kb.Jo.setResult(ic)):(Bc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),Kb.Jo.Qt())};Kb.Kh(Oa);return Kb}function fb(T){this.hDc=this.rNc=null;this.$=T}function pb(){}function rc(){}function vb(){}function E(){}function Nb(T){this.g1c=this.ssa=null;this.p9a=15;this.$=T}function ka(T,Oa){this.$=T;this.hnb=Oa}function bb(T,Oa,Kb,ic){T=mb.call(this,T)||this;T.isFromCurrentSession=!1;T.top=0;T.left=0;T.isFromCurrentSession=
Oa;T.top=Kb;T.left=ic;return T}function Ha(T,Oa,Kb,ic,pd){pd=void 0===pd?null:pd;var Td=Ca.call(this,T,"ArtCopyPasteHandler")||this;Td.CUg="XLO";Td.DUg="3";Td.eU=new ec(T);Td.T9=Oa;Td.oYa=Kb;Td.ha=Df.g(T).ha;Td.i1c=pd||new Wa(Td.T9);Td.SPi=new Ga(Kb,T);Td.hnb=ic;return Td}function Ga(T,Oa){this.GGb=new ob.a;this.oYa=T;this.$=Oa;this.wVi=function(Kb){return Promise.resolve(Kb)};this.NCb=function(Kb){return Promise.reject(Kb)}}function Ua(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){this.promise=null;this.ribbonCommandInfo=
T;this.destination=Oa;this.yEe=Kb;this.wWd=pd;this.g0=Td;this.item=Gd;this.pasteContext=ge;this.YMa=Kb||Oa.FirstRow+"_"+Oa.FirstColumn;this.mbf=!0;this.Cwe=Pe}function jb(T,Oa,Kb,ic,pd,Td,Gd){this.floatingObjectId=T;this.commandParameters=Oa;this.lr=Kb;this.f7g=ic;this.I3=void 0===Td?null:Td;this.wWd=void 0===Gd?null:Gd;this.HZg=pd}function $a(T,Oa,Kb,ic){Oa=Za.call(this,T,Oa,Kb,"AcrossSessionRangeCopyPasteHandler",void 0===ic?null:ic)||this;Oa.eU=new ec(T);return Oa}function Yb(T,Oa){Oa=void 0===
Oa?null:Oa;var Kb=hh.call(this,mh[T])||this;Kb.copyErrorName=0;Kb.ewaErrors=null;Kb.copyErrorName=T;Kb.ewaErrors=Oa;if(null===Oa||void 0===Oa?0:Oa.length)Kb.innerError=new mg.a(Oa,null);return Kb}function ec(T){this.eU=new Fg.a(!0);this.$=T}function Za(T,Oa,Kb,ic,pd){pd=void 0===pd?null:pd;ic=Ca.call(this,T,ic)||this;ic.RZg=Oa;ic.T9=Kb;ic.j1c=pd||new Wa(ic.T9);ic.gridView=Df.g(T);ic.ha=ic.gridView.ha;ic.clipboardRangeFactory=T.da.Aa(169);return ic}function Wa(T){this.clipboardItems=this.key=null;
this.T9=T}function Ca(T,Oa){this._name=Oa;this.$=T;this.Om=Mg.a.instance;this.Er=new uc(T,Df.g(T))}function db(T){return T.shadowWorkbookSizeExceedsLimit?!0:$b(T)>df.a.kjc}function $b(T){return T?T.shadowWorkbookSizeExceedsLimit&&void 0!==T.shadowWorkbookBlockedSize&&null!==T.shadowWorkbookBlockedSize?T.shadowWorkbookBlockedSize:T.shadowWorkbookBase64?T.shadowWorkbookBase64.length:0:0}function Jb(){}function Hc(T){var Oa={};this.U2f=(Oa["SourceItemType.Range"]=0,Oa["SourceItemType.Art"]=1,Oa);this.nKb=
{};Oa={};this.Q2f=(Oa["FloatingObjectType.Unknown"]=99,Oa["FloatingObjectType.CardView"]=6,Oa["FloatingObjectType.Chart"]=0,Oa["FloatingObjectType.Group"]=7,Oa["FloatingObjectType.Image"]=1,Oa["FloatingObjectType.Ink"]=8,Oa["FloatingObjectType.InteractiveReport"]=4,Oa["FloatingObjectType.ModernOfficeExtension"]=3,Oa["FloatingObjectType.Shape"]=5,Oa["FloatingObjectType.Slicer"]=2,Oa["FloatingObjectType.Unsupported"]=100,Oa);Oa={};this.qVc=(Oa["99"]="FloatingObjectType.Unknown",Oa["6"]="FloatingObjectType.CardView",
Oa["0"]="FloatingObjectType.Chart",Oa["7"]="FloatingObjectType.Group",Oa["1"]="FloatingObjectType.Image",Oa["8"]="FloatingObjectType.Ink",Oa["4"]="FloatingObjectType.InteractiveReport",Oa["3"]="FloatingObjectType.ModernOfficeExtension",Oa["5"]="FloatingObjectType.Shape",Oa["2"]="FloatingObjectType.Slicer",Oa["100"]="FloatingObjectType.Unsupported",Oa);Oa={};this.T2f=(Oa["RibbonCommand.Copy"]=-911352779,Oa["RibbonCommand.Cut"]=-1985798686,Oa);Oa={};this.jJd=(Oa["-911352779"]="RibbonCommand.Copy",Oa["-1985798686"]=
"RibbonCommand.Cut",Oa);Oa={};this.S2f=(Oa["InputManager.InputMethod.NotDefined"]=-1,Oa["InputManager.InputMethod.Unknown"]=0,Oa["InputManager.InputMethod.Keyboard"]=1,Oa["InputManager.InputMethod.Mouse"]=2,Oa["InputManager.InputMethod.Touch"]=3,Oa["InputManager.InputMethod.CrossSlide"]=9,Oa);this.Nja={};Oa={};this.R2f=(Oa["FrameMode.None"]=0,Oa["FrameMode.Reading"]=1,Oa["FrameMode.Edit"]=2,Oa);this.U1a={};Oa={};this.V2f=(Oa["UILocation.Unknown"]=0,Oa["UILocation.UpperRibbon"]=1,Oa["UILocation.Ribbon"]=
2,Oa["UILocation.QAT"]=3,Oa["UILocation.Jewel"]=4,Oa["UILocation.NavigationPane"]=5,Oa["UILocation.KeyboardShortcut"]=6,Oa["UILocation.StatusBar"]=7,Oa["UILocation.Dialog"]=8,Oa["UILocation.Floatie"]=9,Oa["UILocation.NotificationBar"]=10,Oa["UILocation.StandaloneCuiRoot"]=11,Oa["UILocation.TaskPane"]=12,Oa["UILocation.HeroDock"]=13,Oa["UILocation.SingleLineRibbon"]=14,Oa["UILocation.MultilineRibbon"]=15,Oa["UILocation.Overflow"]=16,Oa["UILocation.TellMe"]=17,Oa["UILocation.FarPeripheralControls"]=
18,Oa["UILocation.ContextMenu"]=19,Oa["UILocation.DialogMenu"]=20,Oa["UILocation.Header"]=21,Oa["UILocation.FileMenu"]=22,Oa["UILocation.Toolbar"]=26,Oa["UILocation.Canvas"]=30,Oa);this.rr={};this.$=T;this.Nja.notDefined="InputManager.InputMethod.NotDefined";this.Nja.unknown="InputManager.InputMethod.Unknown";this.Nja.keyboard="InputManager.InputMethod.Keyboard";this.Nja.mouse="InputManager.InputMethod.Mouse";this.Nja.touch="InputManager.InputMethod.Touch";this.Nja.crossSlide="InputManager.InputMethod.CrossSlide";
this.U1a.none="FrameMode.None";this.U1a.reading="FrameMode.Reading";this.U1a.edit="FrameMode.Edit";this.rr.unknown="UILocation.Unknown";this.rr.upperRibbon="UILocation.UpperRibbon";this.rr.ribbon="UILocation.Ribbon";this.rr.QAT="UILocation.QAT";this.rr.jewel="UILocation.Jewel";this.rr.navigationPane="UILocation.NavigationPane";this.rr.keyboardShortcut="UILocation.KeyboardShortcut";this.rr.statusBar="UILocation.StatusBar";this.rr.dialog="UILocation.Dialog";this.rr.floatie="UILocation.Floatie";this.rr.notificationBar=
"UILocation.NotificationBar";this.rr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.rr.taskPane="UILocation.TaskPane";this.rr.heroDock="UILocation.HeroDock";this.rr.singleLineRibbon="UILocation.SingleLineRibbon";this.rr.multilineRibbon="UILocation.MultilineRibbon";this.rr.overflow="UILocation.Overflow";this.rr.tellMe="UILocation.TellMe";this.rr.farPeripheralControls="UILocation.FarPeripheralControls";this.rr.header="UILocation.Header";this.rr.fileMenu="UILocation.FileMenu";this.rr.contextMenu=
"UILocation.ContextMenu";this.rr.dialogMenu="UILocation.DialogMenu";this.rr.toolbar="UILocation.Toolbar";this.rr.canvas="UILocation.Canvas";this.nKb.range="SourceItemType.Range";this.nKb.art="SourceItemType.Art"}function uc(T,Oa){this.shc=this.qMa=null;this.qec=me.EwaSettings.getBooleanFeatureGate(Cd.a.n3b,!1);this.ykd=me.EwaSettings.isChangeGateEnabled("OfficeVSO:6024798_AbortOutstandingCopyOperation");this.HLa=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",
!1);this.$=T;this.gridView=Oa;this.Hfc=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeHideCutCopyHighlight",!1);this.ykd&&(this.$.userOperationManager.uy(Object(nc.a)(this,this.aF,"onQueueChanged")),this.Su=new Vf.a)}function Aa(T){this.parameters=null;this.parameters=T}function mb(T){this.pasteParameters=null;this.pasteParameters=T}function dc(T,Oa){this.content=this.destinationRange=null;this.destinationRange=T;this.content=Oa}function Ac(T,Oa,Kb){this.destinationRange=this.sourceRange=
null;this.pasteFlags=0;this.sourceRange=T;this.destinationRange=Oa;this.pasteFlags=Kb}function bd(T,Oa,Kb,ic,pd,Td,Gd,ge){ge=void 0===ge?null:ge;Gd=T.Oa(1,void 0===Gd?null:Gd);Gd.pasteParameters=Oa;return Id.i(T,"Paste",Gd,Kb,ic,pd,Td,64,ge)}function Kd(T,Oa,Kb,ic,pd,Td,Gd,ge){ge=void 0===ge?null:ge;Gd=T.Oa(1,void 0===Gd?null:Gd);Gd.copyParameters=Oa;return Id.i(T,"Copy",Gd,Kb,ic,pd,Td,0,ge)}function Yd(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){Pe=void 0===Pe?null:Pe;ge=T.Oa(9,ge);ge.destinationRange=Oa;ge.source=
Kb;return Id.i(T,"PasteString",ge,ic,pd,Td,Gd,64,Pe)}function qd(T,Oa,Kb,ic,pd,Td,Gd,ge){ge=void 0===ge?null:ge;Gd=T.Oa(1,Gd);Gd.pasteHtmlParameters=Oa;return Id.i(T,"PasteHtmlContent",Gd,Kb,ic,pd,Td,64,ge)}function Ie(){this.NZa=this.Fwe=null}function cc(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){Pe=void 0===Pe?null:Pe;var gf=vc.call(this)||this;gf.pasteShortcutManager=null;gf.c$e=me.EwaSettings.gH();gf.HLa=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);gf.e5f=null;
gf.T5a=!1;gf.Jbf=me.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");gf.Iyd=function(kg){gf.yoj(kg)&&(gf.Er.Tvb(),Bc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};gf.poi=function(kg,cg){Bc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",
kg,cg);gf.gridView.focus()};gf.od=function(kg,cg){cg.WJ||cg.Qg||gf.Hv("OnWorkbookOpened",!1).catch(function(){})};gf.Yh=function(kg,cg){kg=Jf(gf.fK);var Wg=gf.Er.Gub(kg);Wg&&(cg.oa&&cg.oa.sheetName===Wg.sheetName&&Wg.isFromCurrentSession(gf.$)?gf.Er.J5e(Wg.ranges,kg.commandParameters.commandType):gf.Er.Tvb())};gf.Mlc=function(kg,cg){kg=Jf(gf.fK);(kg=gf.Er.Gub(kg))&&cg.item&&cg.item.sheetName===kg.sheetName&&kg.isFromCurrentSession(gf.$)&&gf.Hv("OnItemDeleting",!1).catch(function(){})};gf.eDb=function(kg,
cg){gf.c$e?gf.e5f(kg,cg):gf.Yzf()};gf.bR=function(kg,cg){1===cg.Wx&&cg.Sg.operation.flags&2&&gf.Hv("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};gf.$=T;gf.hi=Kb;gf.gridView=Df.g(T);gf.Er=pd;gf.f6h=Td;gf.fK=Oa;gf.t2b=ic;gf.getStringifiedError=Pe||copyPasteInfra.getStringifiedError;gf.CZf=1===ge;gf.ak();gf.copyPasteShortcutDialogFactory=gf.$.da.Aa(85);Bc.ULS.shipAssertTag(537167825,0,!!gf.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");
Gd||(Bc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Gd=cc.Y8g);gf.userHash=We.a.lu(Gd);gf.zsi="CultureTag: "+Mg.a.instance.Kqb+" HASH: ";gf.fK.addMetadataChangeListener(cc.Bmf,gf.Iyd);gf.Htd=gf.$.ya.MaxCopyPasteLength;gf.dNa=gf.HLa?me.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",gf.$.ya.CopyPasteMaxPayloadLength):df.a.dNa;gf.fo=me.EwaSettings.getBooleanFeatureGate(Cd.a.QOa,!1);gf.fo&&T.da.Za(478,function(kg){gf.pasteShortcutManager=
kg});gf.c$e&&(gf.e5f=od.a(function(){gf.Yzf()},1,gf.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",!0));return gf}function Qd(T){if(!T)return"null";var Oa=[];T=yl(T.get());for(var Kb=T.next();!Kb.done;Kb=T.next())Kb=Kb.value,Kb=String.format("{0}({1})",Kb.clipboardDataFormat,Kb.data.length),Array.add(Oa,Kb);Oa.sort();return Oa.join(",")}function Wd(T){switch(T){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function ee(T,Oa){return T?Oa&&Oa.ya?T.sessionId!==
Oa.ya.UserSessionId:(Bc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(Bc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function ne(){}function Bd(){}function Pd(){}function ze(T,Oa,Kb,ic){this.$=T;this.originalDestinations=Oa;this.p7b=Kb;this.bgg=ic;this.Vpg=this.originalDestinations;this.Sjg=this.p7b;this.jng="PasteRecoveryUI"}function Jf(T){return T&&(T=T.getCachedMetadata(),null===T||void 0===T?0:T.lastCopy)?T.lastCopy:null}function oc(T){return T.clipboardItems&&
(T=T.clipboardItems.getItem(gb.O9h))&&"1"===T?!0:!1}function hd(T){return wc(T)&&!(void 0===T.clipboardItems||null===T.clipboardItems)&&!!T.clipboardItems.getItem(gb.png)&&!T.clipboardItems.getItem(gb.UV)}function wc(T){return T.clipboardItems&&(T=T.clipboardItems.getItem(gb.fci))&&"1"===T?!0:!1}function gb(){}function kd(){}function Lc(T){return!!T&&Object.getType(T)===Cb}function Cb(T,Oa,Kb,ic,pd){ic=Hb.call(this,ic,pd)||this;Bc.ULS.shipAssertTag(537167645,0,!!Oa&&0<Oa.length,"RangeSourceItem.ctor: ranges should not be null or empty");
ic.$=T;ic.ranges=Oa;ic.sheetName=Kb;return ic}function Bb(T,Oa,Kb,ic,pd){Kb=Hb.call(this,Kb,ic)||this;Kb.activeFloatingObjectControlId=T;Kb.sheetName=Oa;Kb.type=pd;return Kb}function Hb(T,Oa){var Kb=this;this.Szh=function(){var ic={};ic.SourceItem=Kb.toString();return ic};this.sessionStateId=T;this.sessionId=Oa;this.toJSON=this.Szh}function Pb(T,Oa,Kb,ic,pd){var Td=T.Stopwatch,Gd={};Gd.a=pd;Gd.e=Td.id;Gd.c="RearrangeRowColumn";Gd.b="mouse";Gd.d=T.OperationId.toString();Gd.f=Kb.toString();Gd.g=ic.toString();
Gd.h=Oa.toString();Gd.i=T.DragDropIsShiftKeyDown;Gd.j=!0;Gd.o=Td.Ac;Gd.q=!1;Gd.r=T.CopyPasteTargetType.toString();Gd.s=T.EncounteredDeploymentErrors;return Gd}function ed(T){T=lf.call(this,T)||this;T.BUg=function(){Bc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};Bc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");T.kc=0;T.Cc(1,Mg.a.instance.ea(2184));var Oa=Mg.a.instance.ea(2182),Kb=T.LU();T.initializeAndShow(Oa,
T.BUg,Kb);return T}function Xc(){this.rb=null}function ce(){this.lhb=this.UQb=this.vv=null}function Xd(T,Oa,Kb,ic,pd){this.vv=T;this.yhb=Oa;this.uhb=Kb;this.gbe=void 0===ic?null:ic;this.Gjb=void 0===pd?null:pd}function nd(){this.rb=null}function je(T){this.hc=T}function Xe(){this.Zfe=0;this.BVa=Array(5);this.BVa[0]=10;this.BVa[1]=15;this.BVa[2]=50;this.BVa[3]=100;this.BVa[4]=200}function Ne(T,Oa,Kb,ic,pd){this.U8b=!1;this.Tqb=null;this.La=T;this.PWa=Oa;this.fUb=Kb;this.V0=ic;this.$Cc=pd}function Ig(){this.KKf=
this.DPf=this.s4f=this.Khc=this.instance=null}function Lf(T,Oa,Kb){this.La=T;this.Ie=Oa;this.vRb=Kb}function Hf(){this.completed=this.e2i=!1}function ag(){this.vee=this.J9d=this.i_d=!0;this.G7i=this.iRi=null;this.iui=!1;this.locale=null;this.X7f={}}function Bg(){}function uf(){this.DTb=this.TQb=null}function sf(T){return Ve.call(this,T)||this}function xg(){this.rb=null}function sc(T,Oa){if(void 0===T||null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.ub=T;this.Og=Oa;this.MOc=this.xe=null}function Sc(){this.zGe=this.Nag=this.ot=0;this.AGe=this.Oag=this.QGa="";this.xPc=this.aea=2}function Qc(T,Oa){this.gEc=0;this.i1b=null;this.Khb=new xd(T,Oa);this.ub=T;Oa=T.Ua("HostAuthType");this.ODa=T.ra("OcpsIsEnabled")&&T.ra("IsO365CommercialHost")&&!(void 0===Oa||null===Oa)&&"aad"===Oa.toLowerCase();this.H$d=yd.b(T.Ua("OcpsDefaultSettings")||"{}");this.Aib=this.T$b();Oa=this.ub.Dy("ServicesControlsMicrosoftControllerServicesList")?this.ub.Tv("ServicesControlsMicrosoftControllerServicesList")||
[]:[];this.MPb=new wd.a;for(var Kb=0;Kb<Oa.length;Kb++)this.MPb.add(Oa[Kb]);this.ODa&&!T.ra("IsAnonymousUser")&&T.ra("SideCarIsEnabled")?this.i1b=this.zFj():this.i1b=this.Nna(this.ODa,this.Aua("/afhs/CloudPolicySettings.ashx"),Object(nc.a)(this,this.lPi,"parseCloudPolicySettingsResponse"));this.i1b.then(function(){return null}).catch(function(ic){Bc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(ic))})}function ie(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function ue(){}
function Ce(T,Oa){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=T.PolicySettings;T=new Date;T.setMinutes(T.getMinutes()+Oa);this.ExpirationTime=T.getTime()}function Be(T,Oa,Kb,ic,pd){var Td=this;Kb=void 0===Kb?null:Kb;ic=void 0===ic?null:ic;pd=void 0===pd?null:pd;this.Pta=this.iUb=this.oce=this.Kpa=this.nVb=null;this.Khb=new xd(T,Oa);this.ub=T;this.ong=T.zd("LicensingMaxRetryAttempts",0);this.kJc=T.ra("IsO365ConsumerHost");this.jJc=T.ra("IsO365CommercialHost");this.NRb=T.ra("PremiumUpsellIsEnabled");
this.G0d=Kb;this.Ege=ic;this.La=pd;this.Jpa=T.ra("LicensingIsEnabled");this.ODa=T.ra("OcpsIsEnabled")&&this.jJc;this.PQc=T.ra("ShowPrivacyDialog")&&!!ic;this.W5d=T.ra("IsAnonymousUser");this.j9c=new Promise(function(Gd){Gd(!1)});this.NAa=new Promise(function(Gd){Gd(!0)});this.Ota=new ye.a(cb.a.Ik());this.$Vb=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.w8d=this.ILh();this.jnd()&&!this.W5d?(void 0!==ve.AFrameworkApplication.sa&&null!==
ve.AFrameworkApplication.sa&&(this.nVb=ve.AFrameworkApplication.sa.fD,void 0!==this.nVb&&null!==this.nVb&&(this.Kpa=this.nVb.Xh("WebServiceCall","ApplicationFeatureHelperService"))),this.Pta=this.pUd()):this.Pta=new Promise(function(Gd){Gd({})});this.Pta.catch(function(Gd){Bc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Gd))});this.$Vb&&(this.NRb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Gd){Td.NRb=Td.ub.ra("PremiumUpsellIsEnabled")&&Gd;return null}))}function le(T,Oa,Kb){this.featureName=
null;this.isEnabled=!1;this.tierName=0;this.featureName=T;this.isEnabled=Oa;this.tierName=Kb}function hc(T,Oa){this.VCj=3E5;if(void 0===T||null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.ub=T;this.JOb=new ye.a(cb.a.Ik());this.Khb=new xd(T,Oa);void 0!==ad.a.Dsd&&null!==ad.a.Dsd&&void 0!==ad.a.Cic&&null!==ad.a.Cic&&0<ad.a.Cic&&(T=new gd,T.Token=ad.a.Dsd,T.ExpirationTime=ad.a.Cic,this.JOb.ia("loki",T))}function gd(){this.Token=null;this.ExpirationTime=
0}function xd(T,Oa){this.ub=T;this.Og=Oa}function re(){this.message=null;this.Kcc=0}b.r(D);var Jc=b(0),Bc=b(13),ye=b(805),cb=b(574),nc=b(80),Nc=b(84),Rc;(function(T){T[T.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";T[T.cloudPolicySettings=1]="cloudPolicySettings";T[T.alternateAuthToken=2]="alternateAuthToken"})(Rc||(Rc={}));Object(Jc.b)("ApplicationFeatureHelperRequestType",Rc);Object(Jc.a)(re,"HttpRequstToPromiseRejectData",null,[]);var Wc=b(93),fe=b(233);xd.prototype.k2c=
function(T,Oa,Kb,ic,pd,Td,Gd,ge){var Pe=this;ic=void 0===ic?null:ic;pd=void 0===pd?null:pd;Td=void 0===Td?null:Td;Gd=void 0===Gd?null:Gd;ge=void 0===ge?null:ge;var gf=Rc[Kb],kg=gf+"RequestFailure";Wc.Health.instance.recordKpiUsage(kg,0,"jpittsdirects",null);return new Promise(function(cg,Wg){Bc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",gf);var tg=null!=Gd?Gd:Pe.ub.zd("ApplicationFeatureHelperRequestQueueTimeout",15E3),
Jh=null!=ge?ge:Pe.ub.zd("ApplicationFeatureHelperRequestSentTimeout",3E4);Pe.Og.g9(T,1,null,Pe.oKh(Kb,ic),Td,!1,1,function(Fh){Bc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",gf);try{if(void 0===Fh||null===Fh||void 0===Fh.data||null===Fh.data||void 0===Fh.data.fe||null===Fh.data.fe){Wc.Health.instance.recordKpiFailure(kg,"Invalid RequestSucceededEventArgs",!1,!0,null);var Xg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
gf);Wg(Pe.Hub(Xg,Fh))}else if(Fh.data.httpStatus!==fe.a.sO){Wc.Health.instance.recordKpiFailure(kg,"HttpStatusCode_"+Fh.data.httpStatus.toString(),!1,!0,null);var hi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Fh.data.httpStatus,gf);Wg(Pe.Hub(hi,Fh))}else{void 0!==pd&&null!==pd&&void 0!==Fh.data.responseHeaders&&null!==Fh.data.responseHeaders&&pd(Fh.data.responseHeaders);
var Ci=Oa(Fh.data.fe);if(Ci)Bc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",gf),cg(Ci);else{Wc.Health.instance.recordKpiFailure(kg,"Parse Failure",!1,!0,null);var Di=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",gf);Wg(Pe.Hub(Di,Fh))}}}catch(nh){Wc.Health.instance.recordKpiFailure(kg,"Unexpected Failure",!1,!0,null),Xg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
nh,gf),Wg(Pe.Hub(Xg,Fh))}},function(Fh){Bc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",gf);if(Fh.data){Wc.Health.instance.recordKpiFailure(kg,"HttpStatusCode_"+Fh.data.httpStatus.toString(),!1,!0,null);var Xg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Fh.data.httpStatus,Fh.data.fe||"No Data",gf)}else Wc.Health.instance.recordKpiFailure(kg,
"Invalid RequestFailedEventArgs",!1,!0,null),Xg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",gf);Wg(Pe.Hub(Xg,Fh))},null,void 0,void 0,tg,Jh)})};xd.prototype.Hub=function(T,Oa){var Kb=new re;Kb.message=T;Kb.Kcc=Oa&&Oa.data?Oa.data.httpStatus:-1;return Kb};xd.prototype.oKh=function(T,Oa){var Kb={};Kb["x-UserDataSignature"]=this.ub.Ua("UserDataSignature");Kb["x-LicensingIsEnabled"]=this.ub.ra("LicensingIsEnabled").toString();
Kb["x-CacheIsEnabled"]=this.ub.ra("LicensingRedisIsEnabled").toString();Kb["x-OcpsIsEnabled"]=this.ub.ra("OcpsIsEnabled").toString();Kb["x-LicensingAADIdIsEnabled"]=this.ub.ra("LicensingAadIdIsEnabled").toString();T||(Kb["x-LicenseCheckOnTenantEnabled"]=this.ub.ra("LicensingForSafeLinksIsEnabled").toString(),Kb["x-SupportUserConsentDependentFeatures"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),Kb["x-AFHUserConsentGroupValue"]=
this.ub.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Kb["x-UseShellServiceForUserConsentGroup"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Kb["x-UseSALForLicensing"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Kb["x-SMBUserLicensingEnabled"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString(),
Kb["x-UseSALForAadGraphToken"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForAadGraphAFHS",!1).toString());if(Oa){T=yl(Oa.keys);for(var ic=T.next();!ic.done;ic=T.next())ic=ic.value,Kb[ic]=Oa.na(ic)}return Kb};Object(Jc.a)(xd,"HttpRequestToPromiseUtility",null,[]);var ve=b(5),kc;(function(T){T[T.loki=0]="loki";T[T.augloopACLP=1]="augloopACLP"})(kc||(kc={}));Object(Jc.b)("AlternateAuthSupportApp",kc);var ad=b(857),yd=b(38);Object(Jc.a)(gd,"WacAlternateAuthToken",null,[]);hc.prototype.LCh=
function(){var T=null;this.JOb.wb(kc[0])&&(T=this.JOb.na(kc[0]));return void 0===T||null===T||this.$od(T)?this.Bth():Promise.resolve(T.Token)};hc.prototype.$od=function(T){return T.ExpirationTime-Date.now()<this.VCj};hc.prototype.Bth=function(){var T=this,Oa=new ye.a(cb.a.Ik());Oa.ia("X-AlternateAuthApp",kc[0]);return this.Khb.k2c(this.Aua("/afhs/AlternateAuthHelperHandler.ashx"),Object(nc.a)(this,this.hPi,"parseAlternateAuthTokenResponse"),2,Oa).then(function(Kb){Bc.ULS.sendTraceTag(545821456,3004,
50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",kc[0]);T.JOb.ia(kc[0],Kb);return Kb.Token},function(Kb){Kb=Object(Nc.a)(re,Kb);Bc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Kb.message,Kb.Kcc);return null})};hc.prototype.hPi=function(T){var Oa=yd.d(T).uu;Bc.ULS.sendTraceTag(545821457,3004,Oa?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",T);return Oa};
hc.prototype.Aua=function(T){return String.format("{0}{1}?{2}",this.ub.Ua("WebServiceBase"),T,ve.AFrameworkApplication.hj)};Object(Jc.a)(hc,"AlternateAuthHelper",null,[194]);var wd=b(456);Object(Jc.a)(le,"FeatureStateChangeArgs",null,[]);var pe=b(277),bf=b(23),Af=b(110),bg=b(179),og;(function(T){T[T.Enabled=0]="Enabled";T[T.Disabled=1]="Disabled"})(og||(og={}));Object(Jc.b)("FeatureState",og);var Zf=b(86),If=b(29),qg=b(178);Be.prototype.ILh=function(){for(var T=this.ub.Dy("AllLicensedFeatures")?this.ub.Tv("AllLicensedFeatures"):
[],Oa=new wd.a,Kb=0;Kb<T.length;Kb++)Oa.add(T[Kb]);return Oa};Be.prototype.jnd=function(){return this.jJc||this.kJc};Be.prototype.pUd=function(T,Oa){var Kb=this;T=void 0===T?0:T;Oa=void 0===Oa?!1:Oa;Bc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Oa);var ic=this.W1c();ic&&(ic.set("retryAttempt",T.toString()),ic.set("forceRefresh",Oa.toString()),ic.set("isO365ConsumerHost",this.kJc.toString()),ic.set("isO365CommercialHost",this.jJc.toString()),
ic.set("isFreemiumUpsellEnabled",this.NRb.toString()));Wc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",ic);Wc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ic);void 0!==this.Kpa&&null!==this.Kpa&&this.Kpa.start();var pd=null;Oa&&(pd=new ye.a(cb.a.Ik()),pd.ia("x-LicensingForceRefresh","true"));this.oce=new Date;return(this.Jpa?this.Khb.k2c(this.Aua("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(nc.a)(this,this.kPi,
"parseApplicationFeatureHelperResponse"),0,pd,Object(nc.a)(this,this.xUi,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(function(Td){var Gd=Object.assign(new qg.a,{durationMs:Kb.n2f()});Gd.extendedProperties=ic;Gd.extendedProperties&&Td&&(Gd.extendedProperties.set("featureCount",Af.a.count(Td).toString()),Gd.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Td).toString()),Gd.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in
Td).toString()),Kb.iUb&&Gd.extendedProperties.set("fromCache",(Kb.iUb<Kb.oce).toString()));Wc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Gd);return Td},function(Td){var Gd=Object.assign(new qg.a,{durationMs:Kb.n2f()}),ge=Object(Nc.a)(re,Td);if(!ge)return Bc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Wc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,Gd),new Promise(function(Pe,gf){gf(Td)});Gd.extendedProperties=ic;Gd.extendedProperties&&Gd.extendedProperties.set("status",ge.Kcc.toString());Wc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Gd);return 408===ge.Kcc&&++T<=Kb.ong?Kb.pUd(T):new Promise(function(Pe,gf){gf(ge)})})};Be.prototype.kPi=function(T){(T=yd.b(T))?(Bc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Bc.ULS.sendTraceTag(50938594,
3004,50,"{0}",T)):Bc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return T.Features};Be.prototype.Aua=function(T){var Oa=String.format("{0}{1}",this.ub.Ua("WebServiceBase"),T);this.ub.Dy("ApplicationFeatureHelperHttpCachingEnabled")&&this.ub.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(T=Be.T$b(this.ub))&&0<T.length&&(this.$Vb&&(T+="ucbf"),Oa=new pe.QueryStringBuilder(Oa),Oa.Ei("afhskey",T),Oa=Oa.toString());
return Oa};Be.prototype.isFeatureEnabled=function(T,Oa){var Kb=this;if(!this.ODa&&!this.PQc&&!this.Jpa)return this.NAa;Bc.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",T);if("ConnectedServices"===T){var ic=this.ODa?this.G0d.AJ("ControllerConnectedServicesEnabled"):this.NAa,pd=this.PQc?this.Ege.getSettings().then(function(ge){return 2!==ge.ot},function(){return Oa}):this.NAa;return ic.then(function(ge){return ge?pd:Kb.j9c})}ic=
null;ic=this.ODa?this.G0d.isFeatureEnabled(T):this.NAa;var Td=null;Td=this.Jpa?this.rai(T,Oa):this.NAa;var Gd=null;Gd=this.PQc?this.Ege.isFeatureEnabled(T):this.NAa;return ic.then(function(ge){return ge?Gd.then(function(Pe){return Pe?Td:Kb.j9c}):Kb.j9c}).then(function(ge){Kb.Jif(T,ge);return ge},function(ge){Kb.Jif(T,Oa,ge);return Oa})};Be.prototype.Jif=function(T,Oa,Kb){Kb=void 0===Kb?null:Kb;var ic=this.W1c();ic&&(ic.set("FeatureName",T),ic.set("IsEnabled",Oa.toString()));Kb?(T=Object.assign(new qg.a,
{extendedProperties:ic}),Wc.Health.instance.recordKpiFailure("AFHFeatureStatus","CanNotDetermineFeatureStatus",!1,!0,T)):Wc.Health.instance.recordKpiUsage("AFHFeatureStatus",0,"jpittsdirects",ic)};Be.prototype.getFeatureTier=function(T,Oa){var Kb=this;if(!this.Jpa)return new Promise(function(ic){ic(2)});Bc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",T);return this.Pta.then(function(ic){return Kb.Pac(T,ic,Oa)},function(){return Oa})};
Be.prototype.isFreemiumUpsellEnabled=function(){return this.NRb&&this.kJc&&!this.W5d};Be.prototype.launchUpsellExperience=function(T,Oa){Oa=void 0===Oa?null:Oa;Bc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",T));var Kb=this.W1c();Kb&&(Kb.set("experienceId",T),Oa&&Kb.set("campaignId",Oa));Wc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",Kb);if(Kb=Zf.a.instance.Hh("Common.IInProductMessagingUIManager")){var ic=
Object(nc.a)(this,this.MWh,"handleDimeTaskComplete");Kb.Vgf(T,ic,Oa)}else Bc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Wc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Oa={},this.La.ze(If.a.V8b,2,(Oa.experience=T,Oa))};Be.prototype.Vya=function(T,Oa){if(!this.Jpa)return null;if(!T||!Oa)return Bc.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;var Kb=bg.a.create().toString();this.Ota.wb(T)||this.Ota.ia(T,new ye.a(cb.a.Ik()));this.Ota.na(T).add(Kb,Oa);Bc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Kb,T));return Kb};Be.prototype.YFd=function(T,Oa){this.Jpa&&(T&&this.Ota.wb(T)?Oa&&bg.a.isValid(Oa)?this.Ota.na(T).wb(Oa)?(Bc.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Oa,T)),this.Ota.na(T).remove(Oa)):Bc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Oa,T)):Bc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Oa,T)):Bc.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
T)))};Be.prototype.Pac=function(T,Oa,Kb){return this.$Vb?T in Oa?Oa[T].LicenseTier:Kb:T in Oa?this.IPi(Oa[T],Kb):Kb};Be.prototype.IPi=function(T,Oa){switch(T.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Oa}};Be.prototype.MWh=function(){var T=this;Bc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Pta.then(function(Oa){T.QJf(Oa)}).catch(function(){T.QJf({})})};Be.prototype.QJf=function(T){var Oa=this;
Bc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Kb=this.pUd(0,!0);Kb.then(function(ic){Oa.Pta=Kb;Af.a.count(ic)>Af.a.count(T)?Wc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Wc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var pd=yl(Oa.Ota.keys),Td=pd.next();!Td.done;Td=pd.next())if(Td=Td.value,Td in ic){var Gd=Oa.Pac(Td,ic,0);Td in T?Oa.Pac(Td,T,0)!==Gd&&Oa.gwd(Td,
!0,Gd):Oa.gwd(Td,!0,Gd)}else Td in T&&Oa.gwd(Td,!1,Oa.Pac(Td,T,0))}).catch(function(ic){Wc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);Bc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ic))})};Be.prototype.gwd=function(T,Oa,Kb){Bc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",T,Oa,Kb);Oa=new le(T,Oa,Kb);Kb=this.Ota.na(T);Kb=yl(Kb);for(var ic=
Kb.next();!ic.done;ic=Kb.next()){ic=ic.value;try{ic.value(Oa)}catch(pd){Bc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",T,ic.key,pd.message))}}};Be.prototype.te=function(T,Oa){var Kb=this;if(this.Jpa){var ic=this.w8d.contains(T),pd=!0,Td="",Gd=!1;return this.Pta.then(function(ge){T in ge?(ge=ge[T],Td=og[ge.FeatureState],pd=1!==ge.FeatureState):pd=!ic;Kb.Rif(T,
ic,Td,Gd,Oa,pd);return pd},function(){Gd=!0;ic&&(pd=Oa);Kb.Rif(T,ic,Td,Gd,Oa,pd);return pd})}return this.NAa};Be.prototype.Rif=function(T,Oa,Kb,ic,pd,Td){Bc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",T,Oa,ic,Kb,pd,Td)};Be.prototype.rai=function(T,Oa){if(this.$Vb)return this.te(T,Oa);if(this.Jpa){if(this.w8d.contains(T))return this.Pta.then(function(Kb){return T in Kb},function(){return Oa});
Bc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",T)}return this.NAa};Be.prototype.xUi=function(T){try{T&&"Date"in T&&(this.iUb=new Date(T.Date),Bc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.iUb.toString()))}catch(Oa){Bc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Oa)}};Be.prototype.W1c=
function(){try{return new Map}catch(T){return null}};Be.prototype.n2f=function(){if(void 0!==this.Kpa&&null!==this.Kpa){var T=this.Kpa.Ac;this.Kpa.stop();return T}return null};Be.T$b=function(T){try{if(bf.a.qzj){var Oa=T.Ua("UserDataSignature").split(".");if(1<Oa.length){var Kb=window.self.atob(Oa[1]),ic=JSON.parse(Kb).LocalStorageKey;if(void 0!==ic&&null!==ic&&0<ic.length)return ic}}}catch(pd){Bc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",pd.toString())}return null};
Object(Jc.a)(Be,"ApplicationFeatureHelper",null,[195]);var Vf=b(185);Object(Jc.a)(Ce,"CloudPolicySettingsCacheData",null,[]);var Fe=b(952),zg=b(373),Yf=b(221);ue.E0f=function(){return ve.AFrameworkApplication.ga.ra("SideCarIsEnabled")?ue.Msc&&ue.Dld?new Promise(function(T){T(!0)}):new Promise(function(T,Oa){ue.Msc=Yf.a.create(ve.AFrameworkApplication.ga.Ua("SideCarUrl"));zg.a.bia(ue.Msc);ue.Msc.k9(function(Kb,ic){(ue.Dld=ic.succeeded)?T(ic.succeeded):Oa(ic.succeeded)})}):new Promise(function(T){T(!1)})};
ue.Dld=!1;ue.Msc=null;Object(Jc.a)(ue,"SideCarLoader",null,[]);Object(Jc.a)(ie,"CloudPolicySettingsData",null,[]);Qc.prototype.AJ=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(!this.ODa){var Kb=this;return new Promise(function(Gd){Gd(Kb.vub(T))})}var ic=this,pd=this,Td=this.i1b.then(function(Gd){try{var ge=null;Gd.PolicySettings&&"unknown"in Gd.PolicySettings&&(ge=Gd.PolicySettings.unknown);if(ge){if(T in ge&&void 0!==ge[T]&&null!==ge[T])return new Promise(function(gf){gf("0"!==ge[T])});var Pe=T.toLowerCase();
if(Pe in ge&&void 0!==ge[Pe]&&null!==ge[Pe])return new Promise(function(gf){gf("0"!==ge[Pe])});Bc.ULS.sendTraceTag(51512667,3004,50,"Policy"+T+" not found, using default");return new Promise(function(gf){gf(ic.vub(T))})}return new Promise(function(gf){gf(ic.vub(T))})}catch(gf){return Bc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+T+" policy value. Error Message: {0}",gf.message),ic.handleError(gf.toString(),Oa,ic.vub(T))}},function(Gd){return pd.handleError(Gd,Oa,pd.vub(T))});Td.then(function(Gd){Bc.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",T,Gd);return null});return Td};Qc.prototype.isFeatureEnabled=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.tai(T,Oa);var Kb=new Promise(function(pd){pd(!0)}),ic="";this.MPb.contains(T)&&(ic="ControllerConnectedServicesEnabled",Kb=this.AJ(ic,Oa));Kb.then(function(pd){Bc.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",T,pd,ic);return null});return Kb};Qc.prototype.tai=function(T,Oa){Oa=void 0===Oa?!0:Oa;var Kb=new Promise(function(pd){pd(!0)}),ic="";"mso_sendASmile"===T?ic="Enabled":"Survey"===T||"FloodgateSurvey"===T?ic="SurveyEnabled":this.MPb.contains(T)&&(ic="ControllerConnectedServicesEnabled");""!==ic&&(Kb=this.AJ(ic,Oa));Kb.then(function(pd){Bc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
T,pd,ic);return null});return Kb};Qc.prototype.handleError=function(T,Oa,Kb){return Oa?new Promise(function(ic){ic(Kb)}):new Promise(function(ic,pd){pd(T)})};Qc.prototype.Nna=function(T,Oa,Kb){var ic=this;if(!T)return Promise.resolve(new ie);var pd=!1,Td=null;Wc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Gd=this.F1c("GetCloudPolicySettings");return(new Promise(function(ge,Pe){if(void 0!==ic.Aib&&null!==ic.Aib&&0<ic.Aib.length){var gf=ic.jFj();if(void 0!==gf&&
null!==gf){pd=!0;ge(gf);return}}ic.Khb.k2c(Oa,Kb,1,null,Object(nc.a)(ic,ic.BUi,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],ic.ub.zd("CloudPolicySettingsRequestQueueTimeout",15E3),ic.ub.zd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(kg){Bc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");ic.YFj(kg);ge(kg);return kg},function(kg){Pe(kg);return null})})).then(function(ge){var Pe=ic.Twc(Gd);Gd=Pe.stopwatch;Td=Pe.returnValue;(Pe=ic.kq())&&
Pe.set("FromCache",pd.toString());Pe=Object.assign(new qg.a,{durationMs:Td,extendedProperties:Pe});Wc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Pe);return ge})};Qc.prototype.zFj=function(){return ue.E0f().then(function(){Bc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Qc.prototype.Aua=function(T){return String.format("{0}{1}",this.ub.Ua("WebServiceBase"),
T)};Qc.prototype.lPi=function(T){var Oa=yd.d(T).uu;Bc.ULS.sendTraceTag(50622687,3004,Oa?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",T);return Oa};Qc.prototype.BUi=function(T){try{if(void 0!==T&&null!==T&&"CheckIn-Interval"in T){var Oa=parseInt(T["CheckIn-Interval"]);void 0!==Oa&&null!==Oa&&0<Oa&&(this.gEc=Oa)}}catch(Kb){Bc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Kb)}};Qc.prototype.vub=function(T){return T in
this.H$d?"0"!==this.H$d[T]:!0};Qc.prototype.jFj=function(){try{var T=Fe.a.instance.getItem(this.Aib);if(void 0===T||null===T)return Bc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;Bc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",T);var Oa=JSON.parse(T);if(void 0===Oa||null===Oa)return Bc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===Oa.ExpirationTime||null===Oa.ExpirationTime)return Bc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Oa.ExpirationTime)).getTime()<Date.now())return Bc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Kb=new ie;Kb.PolicySettings=Oa.PolicySettings;Kb.ControllerConnectedServicesFeatureNames=new Vf.a;this.ub.Dy("ServicesControlsMicrosoftControllerServicesList")&&
this.ub.Tv("ServicesControlsMicrosoftControllerServicesList");for(var ic=yl(this.MPb),pd=ic.next();!pd.done;pd=ic.next())Kb.ControllerConnectedServicesFeatureNames.add(pd.value);Bc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Kb}catch(Td){return Bc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Td.toString()),null}};Qc.prototype.YFj=function(T){try{if(void 0===T||null===T||void 0===T.PolicySettings||
null===T.PolicySettings)Bc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.gEc)Bc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Oa=new Ce(T,this.gEc),Kb=JSON.stringify(Oa);Bc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Kb);Fe.a.instance.setItem(this.Aib,Kb);Bc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ic){Bc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ic.toString())}};Qc.prototype.T$b=function(){var T=Be.T$b(this.ub);return T&&0<T.length?"OCPS"+T:null};Qc.prototype.kq=function(){try{return new Map}catch(T){return null}};Qc.prototype.F1c=function(T){var Oa=Zf.a.instance.Hh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Oa&&null!==Oa?Oa.Fc("WebServiceCall",T):null};Qc.prototype.Twc=function(T){if(void 0!==T&&null!==T){var Oa=T.Ac;T.stop();return{returnValue:Oa,
stopwatch:null}}return{returnValue:null,stopwatch:T}};Object(Jc.a)(Qc,"CloudPolicySettingsHelper",null,[192]);Sc.prototype.clone=function(){var T=new Sc;T.ot=this.ot;T.Nag=this.Nag;T.zGe=this.zGe;T.QGa=this.QGa;T.Oag=this.Oag;T.AGe=this.AGe;T.aea=this.aea;T.xPc=this.src;return T};Sc.prototype.serialize=function(T){T=void 0===T?null:T;var Oa={};if(!T||T.contains(Sc.yNa))Oa[Sc.yNa]=this.ot;if(!T||T.contains(Sc.FBb))Oa[Sc.FBb]=this.QGa;if(!T||T.contains(Sc.GBb))Oa[Sc.GBb]=this.aea;return JSON.stringify(Oa)};
Sc.create=function(T,Oa){Oa=void 0===Oa?null:Oa;var Kb=new Sc;Kb.xPc=T;void 0!==Oa&&null!==Oa&&(Sc.yNa in Oa&&(Kb.ot=Oa[Sc.yNa]),Sc.FBb in Oa&&(Kb.QGa=Oa[Sc.FBb]),Sc.GBb in Oa&&(Kb.aea=Oa[Sc.GBb]));return Kb};Sc.deserialize=function(T,Oa){try{var Kb=JSON.parse(T);if(void 0!==Kb&&null!==Kb)return Sc.create(Oa,Kb);Bc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",T);throw Error.argument("settingsData");}catch(ic){throw Bc.ULS.sendTraceTag(50860947,
306,10,"UserPrivacySettings Deserialize Exception = {0}",ic.toString()),ic;}};tl.Object.defineProperties(Sc.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.xPc}}});Sc.yNa="CCS";Sc.FBb="CCSTime";Sc.GBb="OfficePrivacyRoamedNoticeShown";Object(Jc.a)(Sc,"UserPrivacySettings",null,[]);var jg=b(135);sc.prototype.Aua=function(T){var Oa=String.format("{0}RoamingServiceHandler.ashx?action=",this.ub.appSettings.RoamingServiceHandlerWebServiceBase||"");Oa=new Sys.StringBuilder(Oa);Oa.append(T);
Oa.append("&");Oa.append(ve.AFrameworkApplication.hj);return Oa.toString()};sc.prototype.executeRequest=function(T,Oa,Kb,ic){return this.Og.uXb(T,Oa,void 0===ic?null:ic,null,Kb,"33",!1,null,6E4)};sc.prototype.saveSettings=function(T){var Oa=this;return new Promise(function(Kb,ic){try{if(void 0===Oa.xe||null===Oa.xe||void 0===T||null===T)Bc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ic("Can't determine setting changes to save");else{var pd=
Oa.xe.ot!==T.ot;if(2===Oa.xe.src&&pd)Oa.mcj(T),Kb(!0);else{var Td=Oa.lgj(T);if(void 0===Td||null===Td||!Td.length)Bc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ic("No changes to save");else if(1===Oa.xe.src)Kb(Oa.I7f(Td));else if(!Oa.xe.src){Bc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Td);var Gd=Oa.executeRequest(Oa.Aua("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Td);Gd.continueWith(function(){if(Gd.Ch||
Gd.jg)Bc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Kb(!1);else{var ge=Gd.result;void 0!==ge.wh&&null!==ge.wh&&void 0!==ge.wh.data&&null!==ge.wh.data&&ge.wh.data.httpStatus===fe.a.sO?(Bc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Kb(!0)):(Bc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Kb(!1))}})}}}}catch(ge){Bc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",
ge.toString()),Kb(!1)}})};sc.prototype.lgj=function(T){if(void 0===this.xe||null===this.xe||void 0===T||null===T)throw Error.invalidOperation("User Privacy settings have not been initialized");var Oa=new Vf.a;T.src?1===T.src&&this.xe.ot!==T.ot&&Oa.add(Sc.yNa):(this.xe.ot!==T.ot&&(Oa.add(Sc.yNa),Oa.add(Sc.FBb)),this.xe.aea!==T.aea&&Oa.add(Sc.GBb));return Oa.count?T.serialize(Oa):(Bc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};sc.prototype.getSettings=
function(){if(!this.MOc){var T=this;this.MOc=new Promise(function(Oa){try{T.xe?Oa(T.xe.clone()):T.rFj().then(function(Kb){T.xe=Kb;Oa(T.xe.clone());return null},function(){T.pFj().then(function(Kb){T.xe=Kb;Oa(T.xe.clone());return null},function(){T.qFj().then(function(Kb){T.xe=Kb;Oa(T.xe.clone());return null},function(){Bc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");T.xe=new Sc;Oa(T.xe.clone());return null});return null});return null})}catch(Kb){Bc.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Kb.toString()),T.xe=new Sc,Oa(T.xe.clone())}})}return this.MOc};sc.prototype.rFj=function(){var T=this;return new Promise(function(Oa,Kb){try{var ic=-1!==window.location.href.indexOf("&wd_pn=2");if(T.ub.ra("PrivacyDialogShouldCheckRoaming")||ic){var pd=T.executeRequest(T.Aua("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");pd.continueWith(function(){try{if(pd.Ch||pd.jg)Bc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{var Td=pd.result;if(Td&&Td.wh&&Td.wh.data)if(Td.wh.data.httpStatus!==fe.a.sO)Bc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Td.wh.data.httpStatus);else{if(Td.wh.data.fe){Oa(sc.parse(Td.wh.data.fe,0));Bc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Td.wh.data.fe);return}Bc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Bc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Kb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Gd){Bc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Gd.toString()),Kb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else Bc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Kb("Roaming should not be used")}catch(Td){Bc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Td.toString()),Kb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};sc.prototype.pFj=function(){var T=this;return new Promise(function(Oa,Kb){try{var ic=jg.a.get("WacUPToggleState"),pd=null;void 0!==ic&&null!==ic&&0<ic.length&&(pd=decodeURIComponent(ic));if(void 0!==pd&&null!==pd&&0<pd.length){var Td=sc.parse(pd,1);Bc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Td.toString());
Oa(Td)}else{var Gd=Sc.create(1),ge=new Vf.a;ge.add(Sc.yNa);var Pe=Gd.serialize(ge);T.I7f(Pe)?(Bc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Pe),Oa(Gd)):(Bc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Pe),Kb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(gf){Bc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
gf.toString()),Kb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};sc.prototype.qFj=function(){return new Promise(function(T){try{var Oa=-1!==window.location.href.indexOf("&wdccsoff=1"),Kb=Sc.create(2);Oa?(Kb.ot=2,ve.AFrameworkApplication.gFe(),Bc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Kb.toString())):(Kb.ot=1,Bc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Kb.toString()));T(Kb)}catch(ic){Bc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ic.toString()),Oa=Sc.create(2),Oa.ot=1,T(Oa)}})};sc.prototype.mcj=function(T){Bc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===T.ot?ve.AFrameworkApplication.gFe():ve.AFrameworkApplication.Xfh();Bc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",T)};sc.prototype.I7f=function(T){try{Bc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",T);var Oa=this.ub.Ua("PrivacyCookieDomain")||"";if(!Oa||!Oa.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");Bc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",T);return jg.a.XMd("WacUPToggleState",T,jg.a.a_,"/",Oa)}catch(Kb){return Bc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Kb.toString()),!1}};sc.prototype.isFeatureEnabled=
function(T){var Oa=this;return this.getSettings().then(function(Kb){for(var ic=Oa.ub.Dy("ServicesControlsMicrosoftControllerServicesList")?Oa.ub.Tv("ServicesControlsMicrosoftControllerServicesList"):[],pd=new wd.a,Td=0;Td<ic.length;Td++)pd.add(ic[Td]);return pd.contains(T)?2!==Kb.ot:!0},function(){Bc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",T);return!0})};sc.parse=function(T,Oa){try{return Bc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
T,Oa),Sc.deserialize(T,Oa)}catch(Kb){throw Bc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Kb.toString()),Kb;}};Object(Jc.a)(sc,"UserPrivacySettingsHelper",null,[193]);var Ff=b(274);xg.prototype.di=function(T){var Oa=this;this.rb=T;this.rb.register(192,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").zc().Ic(function(){return new Qc(ve.AFrameworkApplication.ga,ve.AFrameworkApplication.Hd)});this.rb.register(193,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").zc().Ic(function(){return new sc(ve.AFrameworkApplication.ga,
ve.AFrameworkApplication.Hd)});this.rb.register(194,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").zc().Ic(function(){return new hc(ve.AFrameworkApplication.ga,ve.AFrameworkApplication.Hd)});this.rb.register(195,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").zc().Ic(function(){return new Be(ve.AFrameworkApplication.ga,ve.AFrameworkApplication.Hd,Oa.rb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Oa.rb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
ve.AFrameworkApplication.Eb)})};xg.prototype.init=function(){var T=this;ve.AFrameworkApplication.ga.$v(function(){var Oa=T.rb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");ve.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Oa.isFeatureEnabled("LicensingTestFeature",!1).then(function(Kb){Bc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Kb,ve.AFrameworkApplication.ga.Ua("IsAnonymousUser"));
return null}),Oa.getFeatureTier("LicensingTestFeature",0).then(function(Kb){Bc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Kb,ve.AFrameworkApplication.ga.Ua("IsAnonymousUser"));return null}));T.rb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");T.QAj()})};xg.prototype.dispose=function(){};xg.prototype.QAj=function(){try{ve.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&ue.E0f().then(function(T){Bc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",T);return T})}catch(T){}};xg.main=function(){Ff.a.instance.mj(new xg)};tl.Object.defineProperties(xg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(Jc.a)(xg,"ApplicationFeatureHelperPackage",null,[4,5]);var de=b(157),Tf=b(394),Ve=Tf.a;vm(sf,Ve);sf.prototype.createElement=function(){var T=document.createElement("link");T.setAttribute("rel",
"stylesheet");T.setAttribute("type","text/css");T.setAttribute("href",this.Mt);return T};sf.prototype.i2c=function(){return null};sf.prototype.cqc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.PH.Mt)};tl.Object.defineProperties(sf.prototype,{y2b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Jc.a)(sf,"CssResource",Tf.a,[]);var We=b(28),Sf=b(55);uf.prototype.bli=function(){this.TQb||(Bc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.TQb=Sf.Task.WAA(uf.hli(),uf.Zki()),this.TQb.continueWith(function(T){Bc.ULS.sendTraceTag(21030599,324,10,"{0}",We.a.pcd(T.mg))},5));return this.TQb};uf.prototype.dli=function(){if(!this.DTb)try{Bc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.DTb=Sf.Task.WAA(uf.G6c(Yf.a.create(ve.AFrameworkApplication.ga.Ua("DimeUrl"),null,null))),this.DTb.continueWith(function(T){Bc.ULS.sendTraceTag(39978391,324,10,"{0}",We.a.pcd(T.mg))},5)}catch(T){Bc.ULS.sendTraceTag(594874951,
324,10,"{0}",We.a.pcd(T))}return this.DTb};uf.hli=function(){var T=uf.Rac("inproductmessaging.js");T=Yf.a.create(T,null,null);return uf.G6c(T)};uf.Zki=function(){var T=uf.Rac("inproductmessaging.css");T=new sf(T);return uf.G6c(T)};uf.Rac=function(T){return de.a.C1b(String.format("ipm/{0}",T))};uf.G6c=function(T){zg.a.bia(T);return T.U6a};Object(Jc.a)(uf,"DependencyDownloader",null,[728]);Bg.vOi="inProductMessagingOverlayDiv";Bg.hRi="PlayButtonImage";Bg.F7i="ReplayButtonImage";Object(Jc.a)(Bg,"Constants",
null,[]);ag.prototype.mkj=function(){this.gke(Bg.hRi,this.iRi);this.gke(Bg.F7i,this.G7i)};ag.prototype.gke=function(T,Oa){Oa&&(this.X7f[T]=Oa)};tl.Object.defineProperties(ag.prototype,{BIg:{configurable:!0,enumerable:!0,get:function(){return this.i_d},set:function(T){this.i_d=T}},nti:{configurable:!0,enumerable:!0,get:function(){return this.J9d},set:function(T){this.J9d=T}},Lsj:{configurable:!0,enumerable:!0,get:function(){return this.vee},set:function(T){(this.vee=T)&&this.mkj()}}});Object(Jc.a)(ag,
"FirstRunExperienceUISettings",null,[729]);Object(Jc.a)(Hf,"FirstRunExperienceViewData",null,[727]);var vg=b(171),kh=b(108);Lf.prototype.Mg=function(){this.La.jf(If.a.qwh,kh.a.frame,Object(nc.a)(this,this.owh,"firstRunExperienceHandler"),64);this.La.$b(If.a.aRe,kh.a.frame,Object(nc.a)(this,this.V1h,"inProductMessagingTabHandler"));this.La.$b(If.a.$Qe,kh.a.frame,Object(nc.a)(this,this.U1h,"inProductMessagingShiftTabHandler"));this.La.$b(If.a.rah,kh.a.frame,Object(nc.a)(this,this.sah,"dimeLaunchHandler"));
this.La.$b(If.a.fOf,kh.a.frame,vg.ActionManager.$f);this.La.$b(If.a.e8i,kh.a.frame,vg.ActionManager.$f);this.La.$b(If.a.f8i,kh.a.frame,vg.ActionManager.$f);this.Ie&&this.Ie.updateCommandUI()};Lf.prototype.owh=function(T,Oa,Kb,ic,pd){2===Kb&&this.vRb.Dji(pd);return 32};Lf.prototype.sah=function(T,Oa,Kb,ic,pd){2===Kb&&this.vRb.Bji(pd);return 32};Lf.prototype.V1h=function(T,Oa,Kb){return 2===Kb?this.vRb.Gud():32};Lf.prototype.U1h=function(T,Oa,Kb){return 2===Kb?this.vRb.Eud():32};Object(Jc.a)(Lf,"InProductMessagingActor",
null,[]);Object(Jc.a)(Ig,"DimeExperienceUISettings",null,[]);var Pg=b(168),qf=b(588);Ne.prototype.B4h=function(T){Pg.b("getHeaderApi")?T.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Oa){var Kb=T.isFreemiumUpsellEnabled();Kb&&(appChrome.getHeaderApi().then(function(ic){ic.updatePremiumStatus(Oa,Kb);return null}),T.Vya("MsoPremiumBadge",function(ic){appChrome.getHeaderApi().then(function(pd){pd.updatePremiumStatus(ic.isEnabled,Kb);return null})}));return null}):Bc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};Ne.prototype.Dji=function(T){var Oa=this;this.fUb.bli().continueWith(function(){Oa.PWa.fuj(T)})};Ne.prototype.Bji=function(T){function Oa(){}var Kb="gopremium",ic=null;T?(T.experience&&""!==Object(Nc.a)(String,T.experience)&&(Kb=Object(Nc.a)(String,T.experience)),T.onTaskComplete&&(Oa=T.onTaskComplete),T.campaignId&&""!==Object(Nc.a)(String,T.campaignId)&&(ic=Object(Nc.a)(String,T.campaignId))):Bc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.Vgf(Kb,Oa,ic)};Ne.prototype.Vgf=function(T,Oa,Kb){var ic=this;Kb=void 0===Kb?null:Kb;if(this.U8b&&this.Tqb){var pd={};pd.experience=T||"gopremium";pd.campaignId=Kb||qf.b(this.V0,this.$Cc,Object(Nc.a)(String,pd.experience),!0);this.La.processAction(If.a.fOf,2);Bc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+pd.experience);try{var Td=Object.assign(new Ig,{instance:this.Tqb,Khc:pd,s4f:Oa||function(){},DPf:function(Gd){Bc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Gd.status)},KKf:function(){Bc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");ic.U8b=!1;ic.Tqb=null}});this.PWa.osj(Td)}catch(Gd){Bc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Gd.message),this.U8b=!1,this.Tqb=null,T={},this.La.ze(If.a.V8b,2,(T.experience=pd.experience,T))}}else Bc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),pd={},this.La.ze(If.a.V8b,2,(pd.experience=T,pd))};Ne.prototype.Khf=function(){var T=this;this.fUb.dli().continueWith(function(){try{var Oa=
We.a.Kl(ve.AFrameworkApplication.uiCulture),Kb=qf.c(T.V0);if(Kb){Oa={partnerId:Kb,language:Oa};Oa.sessionId=ve.AFrameworkApplication.userSessionId;Oa.authHint=ve.AFrameworkApplication.ga.Ua("UserPrincipalName");var ic=ve.AFrameworkApplication.ga.Ua("Puid")||"";""!==ic&&(Oa.userInfo={puid:ic});T.Tqb=new Dime(Oa);T.U8b=!0;Bc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else Bc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(pd){Bc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
pd.message)}},3)};Ne.prototype.Gud=function(){return this.PWa.Gud()};Ne.prototype.Eud=function(){return this.PWa.Eud()};Object(Jc.a)(Ne,"InProductMessagingUIManager",null,[726]);Xe.prototype.Init=function(T){this.Zfe=T};Xe.prototype.SendTrace=function(T,Oa){Bc.ULS.sendTraceTag(34182235,this.Zfe,this.BVa[T],"{0}",Oa)};Object(Jc.a)(Xe,"DefaultNetworkingManager",null,[739]);var ih=b(275),Qa=b(372),qb=b(100);je.prototype.fuj=function(T){T&&(InProductMessaging.Networking.NetworkingMgr=new Xe,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(T.Lsj,T.nti,T.BIg,T.iui,T.locale,Object(nc.a)(this,this.MBi,"onDismissFirstRunExperience"),T.X7f),this.LQa(Bg.vOi,!0))};je.prototype.osj=function(T){var Oa=this;if(T&&T.instance&&T.Khc){var Kb=document.getElementById("wacDimeContainer");Kb||(Kb=document.createElement("div"),Kb.id="wacDimeContainer",document.body.appendChild(Kb));ve.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.LQa("wacDimeContainer",!1);T.Khc.parentElementId="wacDimeContainer";T.instance.launch(T.Khc,
T.s4f).then(function(ic){Oa.RFb();document.body.removeChild(Kb);T.DPf(ic)}).catch(function(ic){Oa.RFb();document.body.removeChild(Kb);T.KKf(ic)})}else throw Error.argument("DimeExperienceUISettings");};je.prototype.LQa=function(T,Oa){if(this.hc&&T&&(T=document.getElementById(T),this.r4h(T),T=this.hc.rM("InProductMessagingFocusId"))){var Kb=this.hc.Ii;Kb&&"InProductMessagingFocusId"===Kb.name||this.hc.mR("InProductMessagingFocusId",!1);Oa&&this.SIf(T.scope)}};je.prototype.r4h=function(T){var Oa=!1;
Oa=void 0===Oa?!0:Oa;var Kb=this.hc.ii("InProductMessagingFocusId");Kb.parent=ih.AFrame.nT;var ic=new Qa.DOMFocusListing(function(){return T});ic.J$a=Oa;ic.Rn(3);ic.Rn(2);ic.Rn(4);Oa=this.hc.Jra(function(){return T},Kb,ic);Oa.LFb();Oa.XZ=!0;Oa.KGa=!0};je.prototype.SIf=function(T){T.Qk(qb.FocusManager.instance().G1);T.Qk(qb.FocusManager.instance().I1);T.bindAction(qb.FocusManager.instance().G1,If.a.aRe);T.bindAction(qb.FocusManager.instance().I1,If.a.$Qe)};je.prototype.RFb=function(){this.hc&&(this.hc.jca("InProductMessagingFocusId"),
this.hc.yPa("InProductMessagingFocusId"))};je.prototype.MBi=function(T,Oa){this.RFb();T=Object.assign(new Hf,{completed:T,e2i:Oa});ve.AFrameworkApplication.Eb.ze(If.a.nwh,2,T)};je.prototype.Gud=function(){var T=document.activeElement,Oa=this.hc.hQ();return T&&Oa&&Oa.kf&&T===Oa.kf.ho?(Oa.kf.ol(T),Oa.rxa()?32:8):4};je.prototype.Eud=function(){var T=document.activeElement,Oa=this.hc.hQ();return T&&Oa&&Oa.kf&&T===Oa.kf.firstElement?(Oa.kf.ol(T),Oa.oNa()?32:8):4};Object(Jc.a)(je,"InProductMessagingUIWrapper",
null,[712]);var tc=b(144);nd.prototype.di=function(T){T.register(uf,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").zc().Ic(function(){return new uf});T.register(je,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").zc().Ic(function(){return new je(qb.FocusManager.instance())});T.register(Ne,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").zc().Ic(function(){return new Ne(ve.AFrameworkApplication.Eb,
T.resolve("Common.IInProductMessagingUIWrapper"),T.resolve("Common.App.InProductMessaging.IDependencyDownloader"),ve.AFrameworkApplication.sa.Pa.Lj,ve.AFrameworkApplication.sa.Pa.Kba)});T.register(Lf,"Common.App.InProductMessaging.InProductMessagingActor").zc().Ic(function(){return new Lf(ve.AFrameworkApplication.Eb,ve.AFrameworkApplication.sa,T.resolve("Common.IInProductMessagingUIManager"))});T.register(ag,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").zc().Ic(function(){return new ag});
T.register(Hf,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").zc().Ic(function(){return new Hf});this.rb=T};nd.prototype.init=function(){var T=this;this.rb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Mg();ve.AFrameworkApplication.ga.$v(function(){ve.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled&&tc.a.get_instance().xl(15,function(){T.rb.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){T.rb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").B4h(Oa)})});
ve.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&qf.a()&&!bf.a.xA&&1!==ve.AFrameworkApplication.sa.Pa.Lj&&T.rb.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Kb){!Kb&&Oa.isFreemiumUpsellEnabled()&&T.rb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Khf();return null})})})};nd.prototype.dispose=function(){};nd.main=function(){Ff.a.instance.mj(new nd)};tl.Object.defineProperties(nd.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(Jc.a)(nd,"InProductMessagingPackage",null,[4,5]);Xd.prototype.J8c=function(T){var Oa=new Sys.StringBuilder(this.vv.bHb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("getFirstRunExperienceSettings");Oa.append("&");Oa.append(this.ped(T));Oa.append("&");Oa.append(ve.AFrameworkApplication.hj);ve.AFrameworkApplication.Hd.Ul(Oa.toString(),1,null,null,!0,2,Object(nc.a)(this,this.SJa,"getRequestSuccessCallback"),
Object(nc.a)(this,this.fja,"getRequestFailureCallback"),null)};Xd.prototype.K8c=function(T){var Oa=new Sys.StringBuilder(this.vv.bHb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("saveFirstRunExperienceSettings");Oa.append("&");Oa.append(ve.AFrameworkApplication.hj);Oa=Oa.toString();T=yd.c(T);ve.AFrameworkApplication.Hd.Ul(Oa,2,T,null,!0,4,Object(nc.a)(this,this.CSi,"postRequestSuccessCallback"),Object(nc.a)(this,this.JOa,"postRequestFailureCallback"),null)};Xd.prototype.SJa=function(T){var Oa=
!1,Kb=null;try{if(0<T.data.fe.length){var ic=Object(Nc.a)(Object,yd.a(T.data.fe)),pd=ic?ic[this.vv.FUc]:null;pd&&(Kb=Object(Nc.a)(Object,yd.a(pd.toString())))}Oa=!0}catch(Td){this.fja(null)}Oa&&this.yhb&&this.yhb(T.data,Kb)};Xd.prototype.fja=function(T){this.uhb&&this.uhb(T?T.data:null)};Xd.prototype.CSi=function(T){this.gbe&&this.gbe(T?T.data:null)};Xd.prototype.JOa=function(T){this.Gjb&&this.Gjb(T?T.data:null)};Xd.prototype.ped=function(T){for(var Oa=new Sys.StringBuilder("requestedsettings="),
Kb=0;Kb<T.count;Kb++)Oa.append(T.na(Kb)),Kb<T.count-1&&Oa.append(";");return Oa.toString()};Object(Jc.a)(Xd,"FirstRunExperienceRequestHandler",null,[]);ce.prototype.gPd=function(T){T?(this.vv=T,this.xci()&&(Bc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),T=new Vf.a,T.add(this.vv.FUc),this.UQb=new Xd(this.vv,Object(nc.a)(this,this.SJa,"getRequestSuccessCallback"),Object(nc.a)(this,this.fja,"getRequestFailureCallback"),null,Object(nc.a)(this,
this.JOa,"postRequestFailureCallback")),this.UQb.J8c(T)),(this.vv.Gyb||ve.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.hPd()):Bc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};ce.prototype.xci=function(){try{if(this.vv.Gyb)return!0;if(!ve.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||ve.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.vv.w$h||
this.vv.h6a||ve.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var T=ve.AFrameworkApplication.ga.Ua("FlightId");return-1!==(T?T.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Oa){Bc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Oa?Oa.toString():null)}return!1};ce.prototype.BRf=function(T){var Oa={},Kb={};Kb.FREDisplayedDate=(new Date).toUTCString();Kb.VersionDisplayed=T;Kb.RemindMeLater=!1;Oa[this.vv.FUc]=yd.c(Kb);Bc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.UQb&&this.UQb.K8c(Oa)};ce.prototype.SJa=function(T,Oa){T=T?+T.P2-+T.AE:-1;T>this.vv.tQf?Bc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",T,this.vv.tQf):Oa?this.crj(Oa)?(Bc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.vv.Jmf),this.hPd()):Bc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(Bc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.hPd())};ce.prototype.fja=function(T){Bc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};ce.prototype.JOa=function(T){Bc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};ce.prototype.hPd=function(){var T=this,Oa=Zf.a.instance.Hh("Common.ISystemInitiatedFeedback");Oa?this.s_f(Oa):(Bc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),ve.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Oa=Zf.a.instance.mc("Common.ISystemInitiatedFeedback"))?Oa.execute(function(Kb){T.s_f(Kb)}):
Bc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};ce.prototype.s_f=function(T){if(T){var Oa=this.vv.Ewh;Oa&&(ve.AFrameworkApplication.Gka(Oa),ve.AFrameworkApplication.sic(Oa));Bc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Oa);T.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.lhb=Object(nc.a)(this,this.KCi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.lhb,!0),window.addEventListener("FRELaunchedEvent",this.lhb,!0)):(Bc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.BRf(this.vv.currentVersion))}else Bc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};ce.prototype.KCi=function(T){if(T){var Oa=T.detail;T=T.type;var Kb=this.vv&&this.vv.campaignId?this.vv.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===T||Kb&&Oa&&Oa.id&&-1!==Oa.id.indexOf(Kb))Oa.success&&(Bc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.BRf(this.vv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.lhb,!0),window.removeEventListener("FRELaunchedEvent",this.lhb,!0))}};ce.prototype.crj=function(T){if("RemindMeLater"in T&&"FREDisplayedDate"in T){if("true"===T.RemindMeLater.toString()&&(+new Date-+new Date(T.FREDisplayedDate.toString()))/36E5>this.vv.Jmf)return!0}else if(ve.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in T&&T.VersionDisplayed<this.vv.currentVersion)return Bc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(Jc.a)(ce,"FirstRunExperienceLauncher",null,[692]);Xc.prototype.di=function(T){this.rb=T;this.rb.register(692,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").zc().Ic(function(){return new ce})};Xc.prototype.init=function(){};Xc.prototype.dispose=function(){};Xc.main=function(){Ff.a.instance.mj(new Xc)};
tl.Object.defineProperties(Xc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(Jc.a)(Xc,"FirstRunExperienceLauncherPackage",null,[4,5]);var fd=b(216),Rd=b(350),zd=b(308),xe=b(353),me=b(1),mf=b(36),df=b(9),rf=b(521),Mg=b(14),lf=rf.a;vm(ed,lf);ed.prototype.LU=function(){var T={};T.id=this.xc;var Oa=Mg.a.instance.ea(2183);T.DialogMessage=Oa;return T};tl.Object.defineProperties(ed.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});
Object(Jc.a)(ed,"ClipboardReadPermissionAskDialog",rf.a,[]);var $f=b(48);Hb.prototype.Y$e=function(T){return T?this.sessionStateId===T.sessionStateId&&this.sessionId===T.sessionId:!1};Hb.prototype.isFromCurrentSession=function(T){return this.sessionId===T.ya.UserSessionId};Object(Jc.a)(Hb,"SourceItem",null,[]);vm(Bb,Hb);Bb.prototype.isEqual=function(T){return T&&Object.getType(T)===Bb?this.Y$e(T)&&this.activeFloatingObjectControlId===T.activeFloatingObjectControlId&&this.sheetName===T.sheetName:!1};
Bb.prototype.toString=function(){return this.type.toString()};Object(Jc.a)(Bb,"ArtSourceItem",Hb,[]);var dg;(function(T){T[T.valid=0]="valid";T[T.notPairwiseDisjoint=1]="notPairwiseDisjoint";T[T.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";T[T.notValidForm=3]="notValidForm";T[T.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(dg||(dg={}));Object(Jc.b)("CopySourceValidationOptions",dg);var yf=b(43);vm(Cb,Hb);Cb.prototype.isEqual=function(T){return T&&Object.getType(T)===
Cb?this.Y$e(T)&&yf.Q(this.ranges,T.ranges)&&this.sheetName===T.sheetName:!1};Cb.prototype.toString=function(){return yf.i(this.ranges,",",this.$,!1)};Object(Jc.a)(Cb,"RangeSourceItem",Hb,[]);kd.BMj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(Jc.a)(kd,"ExpectedErrorNames",null,[]);gb.UV="text/plain";gb.html="text/html";gb.png="image/png";gb.SN="data/shadow-workbook";gb.fci="metadata/is-last-copy-was-external";gb.O9h="metadata/is-last-copy-was-external-XLO-source";gb.$Sg="metadata/chrome-extension-id";
gb.k1c="copyId";gb.rDg="metadata/additional-signature-data-attributes";Object(Jc.a)(gb,"ClipboardDataFormat",null,[]);var Hg=b(45),Df=b(20),xc=b(34);ze.prototype.xJa=function(){return ze.ZPi};ze.prototype.uHh=function(){return this.p7b&&1===this.p7b.length?this.vHh(this.p7b[0]):null};ze.prototype.vHh=function(T){var Oa=Df.g(this.$),Kb=Oa.$a.Kj(T),ic=Oa.Lg(T,Kb);Oa=Oa.rtl;if(!ic)return null;T=Df.g(this.$).fg(Kb);var pd=T.Cn;if(!pd.Rd(ic))return null;ic=pd.Jf(ic);var Td=ic.topLeft.y,Gd=ic.bottomRight.y,
ge=Oa?ic.bottomRight.x:ic.topLeft.x;ic=Oa?ic.topLeft.x:ic.bottomRight.x;var Pe=new Hg.a(ic+(Oa?-81:81),Gd+38+6);if(pd.o_a(Pe))return this.U2a(T,pd,Kb,ic,Gd,Oa?12:-3,66);Pe=new Hg.a(ic+(Oa?-81:81),Gd);if(pd.o_a(Pe))return this.U2a(T,pd,Kb,ic,Gd,Oa?20:3,22);Pe=new Hg.a(ic,Gd+38+6);if(pd.o_a(Pe))return this.U2a(T,pd,Kb,ic,Gd,-81+(Oa?18:0),66);ic=new Hg.a(ge+(Oa?81:-81),Gd);if(pd.o_a(ic))return this.U2a(T,pd,Kb,ge,Gd,-81+(Oa?12:-6),22);Gd=new Hg.a(ge,Td-38-6);return pd.o_a(Gd)?this.U2a(T,pd,Kb,ge,Td,
Oa?15:0,16):this.U2a(T,pd,Kb,Oa?pd.topLeft.x:pd.bottomRight.x,pd.bottomRight.y,-81+(Oa?15:-6),22)};ze.prototype.U2a=function(T,Oa,Kb,ic,pd,Td,Gd){var ge=Df.g(this.$),Pe=ge.rtl;T=Sys.UI.DomElement.getLocation(T.domElement);ic=new Sys.UI.Point(ic+(Pe?0:T.x)-Oa.topLeft.x,pd+T.y-Oa.topLeft.y);Pe&&(ge=ge.view.visibleArea,ic.x=ge.bottomRight.x-ge.topLeft.x-ic.x,2===Kb||4===Kb)&&(ic.x+=Oa.bottomRight.x);ic=xc.a(this.$).OJa(ic);return new Sys.UI.Point(ic.x+Td,ic.y+Gd)};tl.Object.defineProperties(ze.prototype,
{qDg:{configurable:!0,enumerable:!0,get:function(){return this.bgg}},Wji:{configurable:!0,enumerable:!0,get:function(){return this.jng}},v_i:{configurable:!0,enumerable:!0,get:function(){return this.Vpg}},osh:{configurable:!0,enumerable:!0,get:function(){return this.Sjg}}});ze.ZPi=["PasteRecoveryUI"];Object(Jc.a)(ze,"PasteRecoveryUI",null,[820]);var dd=b(78),Cd=b(306);Pd.hvg="ActiveSelection";Pd.SN="ShadowWorkbook";Pd.yeg="GVML";Pd.UV="PlainText";Pd.html="Html";Pd.LJg="Bitmap";Object(Jc.a)(Pd,"PayloadType",
null,[]);Bd.Quj="Slice4";Bd.Ruj="Slice5";Bd.Suj="Slice6";Object(Jc.a)(Bd,"SliceName",null,[]);ne.Uvi="NotCalled";ne.success="Success";ne.failed="Failed";Object(Jc.a)(ne,"SucceededPopulatingSystemClipboardOptions",null,[]);var Ld=b(355),Od;(function(T){T[T.valid=0]="valid";T[T.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";T[T.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";T[T.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
T[T.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";T[T.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";T[T.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";T[T.copySourceNotValid=7]="copySourceNotValid";T[T.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";T[T.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
T[T.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";T[T.unknown=100]="unknown"})(Od||(Od={}));Object(Jc.b)("PasteValidationOptions",Od);var ef=b(56),Xf=b(41),Qf=b(141),gg=b(35),Ba=b(148),Ob=b(337),Ec=b(27),od=b(459),Md=b(8),He=b(19),Qe=b(105),Bf=b(154),Uf=b(132),Ea=b(585),ob=b(101),ac=b(335),vc=mf.a;vm(cc,vc);cc.prototype.FBg=function(T){this.addHandler(cc.yzd,T)};cc.prototype.B5i=function(T){this.removeHandler(cc.yzd,T)};cc.prototype.copy=function(T){var Oa=this;T.stopwatch=this.$.Ub.Fc("UserAction",
$f.b().pi(T.ribbonCommandInfo.command)+"ClientSide");if(this.fo){var Kb=ef.GetServiceTaskFactory.Xa(this.$.da,478,479,0);gg.TaskExtensions.Ba(Kb,function(){Oa.pasteShortcutManager=Kb.result},this.ma,3)}var ic=!!Jf(this.fK);me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!bf.a.rC&&(this.T5a=!1);this.Hv("Copy/before/"+Rd.a[T.ribbonCommandInfo.method],!1,void 0,!0,T.copyPasteTargetType).catch(function(){});var pd=-1985798686===T.ribbonCommandInfo.command;
if(1===this.gridView.Te&&(pd=this.Er.p$e(this.gridView.ha.va.selectedRanges,pd))){var Td=cc.WYg(pd);this.wya(Td,dg[pd],!1);return Promise.reject(!1)}T.userHash=this.userHash;T.id=bg.a.create().toString();var Gd=this,ge=this;return this.t2b.onCopy(T).then(function(Pe){Pe.isAsyncCopy||T.stopwatch.stop();Gd.pasteIndicationManager.FGe();Bc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",Ld.d(T));Gd.wmi(Pe,ic);!T.isFormatPainter&&Gd.fo&&(Gd.pasteShortcutManager?
Gd.pasteShortcutManager.bgh():Bc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Pe){var gf=!1,kg="none",cg=cc.Iqb,Wg=!0,tg=-1,Jh=cc.copyErrorName+cc.nIa,Fh=!1,Xg=null;if(Pe){Xg=Pe.copyContext;tg=Pe.reason;Jh+=cc.DJa(Pe);Pe.message&&(cg=Pe.message);var hi=cc.VYg(Pe);if(hi)if(3===hi.copyErrorName)gf=!0,cg=kg="Async Copy canceled by the user.",Wg=!1;else if(Ec.a.Pq(hi.ewaErrors))if(cg=ge.v$b(hi.ewaErrors),Ec.a.hh(hi.ewaErrors,cc.operationSucceededWithAlert))Fh=
gf=!0;else if(Ec.a.hh(hi.ewaErrors,cc.pasteDataLimitHit)||Ec.a.hh(hi.ewaErrors,cc.copyThrottlingError))gf=!0;13===Pe.reason?(gf=!0,Wg=!1):11===Pe.reason&&(Wg=!1)}gf?Bc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Wg,kg,Pe?ge.getStringifiedError(Pe):"null",Ld.d(T)):Bc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Wg,Pe?ge.getStringifiedError(Pe):"null",Ld.d(T));Wg&&ge.Hv("Copy/fail/"+Rd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});ge.vmi(T,gf,cg,Jh,tg,Fh,Xg);return Promise.reject(Pe)})};cc.prototype.paste=function(T){var Oa=this;T.stopwatch=this.$.Ub.Fc("UserAction",$f.b().pi(T.ribbonCommandInfo.command)+"ClientSide");me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!bf.a.rC&&(Bc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.T5a=!1,T.clipboardPicklingApiDataFormatsToRead=[gb.SN]);Df.g(this.$).Ji&&Df.g(this.$).Ji.X6(this.Udd(T.ribbonCommandInfo.command),T.stopwatch.id);if(T.isPasteCommandFromRecoveryUI){var Kb=this.$.da.Aa(406);var ic=zd.a.clone(Kb.uqd);Kb=Kb.eqd;T.pasteRecoveryCachedClipboardItems=Kb?Kb[cc.TCf]:null}else ic=zd.a.clone(this.gridView.ha.va.selectedRanges);T.originalDestinations=ic;T.expandDestinations=this.IXc(T.originalDestinations,T.commandType);if(this.WXc(T.commandType,T.expandDestinations)||this.YPg())return T.userHash=
this.userHash,T.id=bg.a.create().toString(),me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!bf.a.rC&&(T.clipboardReadPermissionPromptShown=!1,T.clipboardAsyncApiDataFormatsToRead=[gb.UV+"Async"],this.t2b.shouldShowClipboardReadPermissionDialog().then(function(pd){pd&&(T.clipboardReadPermissionPromptShown=!0,new ed(Oa.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.t2b.onPaste(T).then(function(pd){return Oa.kmc(pd,T)},
function(pd){return Oa.NCb(T,pd)});this.$.Ce(927125067,dd.a.Wb,30,null);Bc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',yf.i(T.expandDestinations,",",this.$,!1),T.commandType,T.copyPasteTargetType);return Promise.resolve(!0)};cc.prototype.Udd=function(T){if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(T){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};cc.prototype.YPg=function(){return!!Df.g(this.$).ha.Qa.activeFloatingObjectControlId&&this.$.xs(null,!1,470)};cc.prototype.vzb=function(){var T=Jf(this.fK);return T&&T.commandParameters?T.commandParameters.copyPasteTargetType:0};cc.prototype.eci=function(){return!!Jf(this.fK)&&ee(Jf(this.fK),this.$)};cc.prototype.Hv=function(T,Oa,Kb,ic,pd){var Td=this;Kb=void 0===Kb?!1:Kb;ic=void 0===ic?!1:ic;pd=void 0===pd?0:pd;try{this.fo&&this.pasteShortcutManager&&
this.pasteShortcutManager.P4b();var Gd=pd,ge=this.Uii();if(!ic&&2===ge)return Bc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Oa,Kb,ic,pd,ge),Promise.reject(null);Gd||(Gd=ge);var Pe=this.$.Ub.Fc("UserAction","ClearCopyState"),gf=Pe.id;Bc.ULS.sendTraceTag(537167820,0,
50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Oa,Kb,ic,pd,ge);this.Er.Tvb();this.AXi();return this.t2b.onCancelCopy(Oa).then(function(){Oa&&me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!bf.a.rC&&(Td.T5a=!1);Pe.stop();Td.yif(T,gf,!0,Kb,Oa,"","",Pe.Ac,Gd);return Promise.resolve(!0)},function(kg){Bc.ULS.sendTraceTag(24150915,
0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",kg?Td.getStringifiedError(kg):"null");Pe.stop();var cg=cc.mQg+cc.nIa,Wg=cc.Iqb;kg&&(cg+=cc.DJa(kg),kg.message&&(Wg=kg.message));Td.yif(T,gf,!1,Kb,Oa,Wg,cg,Pe.Ac,Gd);return Promise.reject(kg)})}catch(kg){return Promise.reject(null)}};cc.prototype.T0b=function(T,Oa,Kb,ic,pd){Kb=void 0===Kb?!1:Kb;ic=void 0===ic?!1:ic;pd=void 0===pd?0:pd;return ic||!me.EwaSettings.la(686)||this.Jch()?this.Hv(T,Oa,
Kb,ic,pd):(Bc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};cc.prototype.wya=function(T,Oa,Kb){Bc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Oa);if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")){var ic=
new ob.a;ic.ia("reason",Oa);Ea.a(Bf.a.discontinuousSelectionBlocking,[Kb?Uf.a.UPi:Uf.a.NZg],!0,!0,!1,!1,ic)}T=Ec.a.jd(1,1,735,T,0,371863010,"DiscontinuousSelectionBlocking");me.EwaSettings.az()?new Ob.a(this.$,T):(T=new Ba.ErrorDialog(this.$,T),T.initialize(),T.nf())};cc.prototype.Uii=function(){var T=Jf(this.fK);return T&&T.sourceItem?Object.getType(T.sourceItem)===Bb?2:1:0};cc.prototype.dragDropCells=function(T,Oa,Kb,ic,pd){var Td=this;pd=void 0===pd?!1:pd;T.stopwatch=this.$.Ub.Fc("UserAction",
"DragDropClientSide");this.Hv("DragDrop/before/"+Rd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Gd=pd?2:1,ge=0;ge=pd?4:ic?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=T;T.userHash=this.userHash;T.id=bg.a.create().toString();return this.Er.pasteRange(T.ribbonCommandInfo,yf.q(Oa,this.$),yf.q(Kb,this.$),Gd,ge,[T.stopwatch],Pe,!1).then(function(){Bc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',
T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Trd(T,Gd,Oa,Kb,Pe);return Promise.resolve(!0)},function(gf){Bc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',gf?Td.getStringifiedError(gf):"null",T.copyPasteTargetType);return Td.Nxd(gf,T,Gd,Oa,Kb,Pe)})};cc.prototype.ddh=function(T,Oa,Kb,ic,pd){var Td=this;pd=void 0===pd?!1:pd;T.stopwatch=this.$.Ub.Fc("UserAction","DragDropReplaceClientSide");this.T0b("DragDropReplace/before/"+Rd.a[T.ribbonCommandInfo.method],
!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Gd=pd?2:1,ge=0;ge=pd?4:ic?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=T;me.EwaSettings.getBooleanFeatureGate(Cd.a.A5b,!1)&&(T.isDragInsert=!1);T.userHash=this.userHash;T.id=bg.a.create().toString();return this.Er.pasteRange(T.ribbonCommandInfo,yf.q(Oa,this.$),yf.q(Kb,this.$),Gd,ge,[T.stopwatch],Pe,!1).then(function(){Bc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',
T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Trd(T,Gd,Oa,Kb,Pe);return Promise.resolve(!0)},function(gf){Bc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',gf?Td.getStringifiedError(gf):"null",T.copyPasteTargetType);return Td.Nxd(gf,T,Gd,Oa,Kb,Pe)})};cc.prototype.cdh=function(T,Oa,Kb,ic,pd){var Td=this;pd=void 0===pd?!1:pd;T.stopwatch=this.$.Ub.Fc("UserAction","DragDropInsertClientSide");this.T0b("DragDropInsert/before/"+
Rd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Gd=pd?2:1,ge=yf.K(this.IXc([Kb],Gd)),Pe=this.$.fa.oa.sheetName,gf=this.$.fa.oa.sheetName,kg=yf.v(Oa,this.$);kg.SheetName=Pe;Pe=yf.v(ge,this.$);Pe.SheetName=gf;ic=ge.isRow||Oa.isRow||ic?1:0;var cg={encounteredDeploymentErrors:!1};T.isDragInsert=!0;cg.commandParameters=T;T.userHash=this.userHash;T.id=bg.a.create().toString();pd=this.Er.gdh(cg,kg,Pe,pd,ic,T.ribbonCommandInfo);var Wg=this;return ac.c(pd.then(function(){Bc.ULS.sendTraceTag(537167814,
0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Trd(T,Gd,Oa,Kb,cg);return Promise.resolve(!0)},function(tg){Bc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',tg?Wg.getStringifiedError(tg):"null",T.copyPasteTargetType);return Wg.Nxd(tg,T,Gd,Oa,Kb,cg)})).CWR(function(){return!0})};cc.prototype.e6h=function(T,Oa){var Kb=this,ic=Jf(this.fK);if(!ic)return Bc.ULS.sendTraceTag(537167812,
0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),Sf.Task.Ta(!1);if(!Lc(ic.sourceItem))return Bc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Sf.Task.Ta(!1);var pd=ic.sourceItem;if(!pd)return Bc.ULS.shipAssertTag(537167810,0,!!pd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Sf.Task.Ta(!1);if(!pd.isFromCurrentSession(this.$))return Bc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),
Sf.Task.Ta(!1);if(1<pd.ranges.length)return Bc.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.wya(2121,"InsertCopiedCutCells",!0),Sf.Task.Ta(!1);ic=yf.K(pd.ranges);var Td=this.gridView.ha.va.Qd.clone();T=yf.K(this.IXc([Td],T));var Gd=this.sgf();pd=pd.sheetName;Td=this.$.fa.oa.sheetName;var ge=yf.v(ic,this.$);ge.SheetName=pd;var Pe=yf.v(T,this.$);Pe.SheetName=Td;return(T.Lh||ic.Lh?Sf.Task.Ta(0):T.isRow||ic.isRow?Sf.Task.Ta(1):this.f6h.D2b(this.$,
Df.g(this.$).rtl)).CWR(function(gf){return Kb.Er.executeInsertCopiedCutCellsOperation(ge,Pe,Gd,gf.result,Oa)}).continueWith(function(){Gd?Kb.Er.Tvb():Kb.Hv("InsertCopiedCutCells/success/"+Rd.a[Oa.method],!0)})};cc.prototype.Cmd=function(){var T=Jf(this.fK),Oa=this.gridView.ha.va.Dh;return!!T&&Lc(T.sourceItem)&&Oa&&1===T.sourceItem.ranges.length};cc.prototype.sgf=function(){return this.tgf(-911352779)};cc.prototype.Bhc=function(){return this.tgf(-1985798686)};cc.prototype.WXc=function(T,Oa){var Kb=
new Qf.a(this.$.xa),ic=36===T,pd=Kb.te(4);T=2===this.vzb()&&Kb.te(1);ic=ic&&pd;Kb=!Kb.ik||!this.Bhc()||!Qf.a.o5b(Oa,Df.g(this.$));return ic||T||this.$.xs(Oa,!0)&&Kb};cc.prototype.Tec=function(T,Oa){return this.Er.Tec(T,Oa)};cc.prototype.dispose=function(){vc.prototype.dispose.call(this);this.mm();this.fK.removeMetadataChangeListener(cc.Bmf)};cc.prototype.s5c=function(T,Oa,Kb,ic,pd,Td){if(!this.mUg(T.commandParameters.ribbonCommandInfo.command))return T.cseStatus=2,!1;if(Td&&Oa.Rd(ic))return T.cseStatus=
4,!1;if(Kb!==pd)return T.cseStatus=6,!1;if(me.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&(ic.width%Oa.width||ic.height%Oa.height))return T.cseStatus=16,!1;Oa=Oa.Jf(this.gridView.Ph);ic=ic.Jf(this.gridView.Ph);if(!Oa||!ic)return T.cseStatus=7,!1;pd=yf.v(Oa,this.$);pd.SheetName=Kb;Kb=this.hi.XPi(this.gridView,pd,yf.v(ic,this.$),T.commandParameters.ribbonCommandInfo.command,T.commandParameters.stopwatch);1===Kb&&(Td&&(this.hi.KZc(Oa,!1),this.hi.KZc(Oa,!0)),-185374993===
T.commandParameters.ribbonCommandInfo.command&&Df.g(this.$).mXi(),this.pasteIndicationManager.Ahd(T.commandParameters.id),this.etc(T.commandParameters.expandDestinations,T.commandParameters.isPasteCommandFromRecoveryUI),this.swe("DoPasteClientEstimation/"+Rd.a[T.commandParameters.ribbonCommandInfo.method],T));T.cseStatus=Kb;return 1===Kb};cc.prototype.dEf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.poi)};cc.prototype.Xni=function(T,Oa,Kb,ic){T=Pb(T,Oa,Kb,
ic,this.$.ya.UserSessionId);T.k=!0;$f.b().Ne(45,T,!0)};cc.prototype.IIi=function(T,Oa,Kb,ic,pd){var Td=!1,Gd=!1,ge=cc.Iqb,Pe=cc.JGe+cc.nIa;T&&(Pe+=cc.DJa(T),Ec.a.Pq(T.ewaErrors)?(ge=this.v$b(T.ewaErrors),Ec.a.hh(T.ewaErrors,[-103190598])&&(Td=!0)):T.message&&(ge=T.message));Gd||(Gd=this.Vld(T));Oa=Pb(Oa,Kb,ic,pd,this.$.ya.UserSessionId);Oa.k=!1;Oa.l=Gd;Oa.n=ge;Oa.p=Pe;Oa.q=Td;$f.b().Ne(45,Oa,!0);return Promise.reject(T)};cc.prototype.mUg=function(T){switch(T){case 237279923:case 808159687:return Cd.a.kdi;
case -185374993:return!0;case 1804571062:return!0;default:return!1}};cc.prototype.tgf=function(T){var Oa=Jf(this.fK);if(!Oa)return!1;var Kb=Oa.sourceItem;return Kb&&!Kb.isFromCurrentSession(this.$)?(Bc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Oa.commandParameters.ribbonCommandInfo.command===T};cc.prototype.Jch=function(){var T=Jf(this.fK);return T?(T=T.sourceItem)&&!T.isFromCurrentSession(this.$)?(Bc.ULS.sendTraceTag(537167778,
0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};cc.prototype.yoj=function(T){return T&&T.lastCopy?ee(T.lastCopy,this.$):!0};cc.prototype.VVe=function(T,Oa,Kb,ic,pd){var Td={};Td.a=this.$.ya.UserSessionId;Td.e=T.stopwatch.id;Td.c=$f.b().pi(T.ribbonCommandInfo.command);Td.b=Rd.a[T.ribbonCommandInfo.method];Td.d=T.id;Td.f=Kb.toString();Td.g=ic.toString();Td.h=Oa.toString();Td.o=T.stopwatch.Ac;Td.q=!1;Td.r=T.copyPasteTargetType.toString();
Td.s=pd.encounteredDeploymentErrors;me.EwaSettings.getBooleanFeatureGate(Cd.a.A5b,!1)&&(Td.i=pd.commandParameters.dragDropIsShiftKeyDown,Td.j=pd.commandParameters.isDragInsert);return Td};cc.prototype.Trd=function(T,Oa,Kb,ic,pd){T=this.VVe(T,Oa,Kb,ic,pd);T.k=!0;$f.b().Ne(45,T,!0)};cc.prototype.Cmi=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){T=this.VVe(T,Oa,Kb,ic,Pe);T.k=!1;T.l=pd;T.n=Td;T.p=Gd;T.q=ge;$f.b().Ne(45,T,!0)};cc.prototype.yif=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){var gf={};gf.a=this.$.ya.UserSessionId;
gf.b=Oa;gf.c=T;gf.f=Kb;gf.e=ic;gf.d=pd;gf.g=Td;gf.h=Gd;gf.i=ge;gf.j=Pe.toString();$f.b().Ne(46,gf,!0)};cc.prototype.wmi=function(T,Oa){T=this.sVe(T.commandParameters,T);T.l=!0;T.j=Oa;$f.b().Ne(43,T,!0)};cc.prototype.vmi=function(T,Oa,Kb,ic,pd,Td,Gd){T=this.sVe(T,Gd);T.l=!1;T.m=Oa;T.o=Kb;T.y=ic;T.x=pd;T.z=Td;$f.b().Ne(43,T,!0);Bc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
T.y,T.x,T.m,T.z,T.o)};cc.prototype.sVe=function(T,Oa){var Kb={};Kb.a=this.$.ya.UserSessionId;Kb.f=T.stopwatch.id;Kb.g=T.id;Kb.c=$f.b().pi(T.ribbonCommandInfo.command);Kb.b=Rd.a[T.ribbonCommandInfo.method];Kb.q=T.stopwatch.Ac;Kb.bd=cc.D9b();Kb.bg=T.copyPasteHandlerName;Kb.bj=void 0===T.ribbonCommandInfo.df||null===T.ribbonCommandInfo.df?null:xe.a[T.ribbonCommandInfo.df];Kb.bq=T.uploadToClipService;Kb.br=T.floatingObjectType;Kb.s=T.copyPasteTargetType.toString();Kb.bc=Wd(T.copyPasteTargetType);Kb.z=
!1;if(Oa){Kb.bk=Oa.id;Kb.bl=Oa.serverRequestTimeInMs;Oa.requestTelemetryData&&(Kb.bm=Oa.requestTelemetryData.EcsOperationDuration,Kb.bn=Oa.requestTelemetryData.EcsRequestDuration,Kb.bo=Oa.requestTelemetryData.WfeRequestDuration);Kb.d=Oa.sourceItem?Oa.sourceItem.toString():null;Kb.e=-1;if(Lc(Oa.sourceItem)){Kb.e=0;T=yl(Oa.sourceItem.ranges);for(var ic=T.next();!ic.done;ic=T.next())Kb.e+=ic.value.DT}Kb.h=Oa.isAsyncCopy;Kb.i=Oa.isFromCache;Kb.k=Oa.isSelectionAllowed;Kb.r=Oa.plainTextPayloadSize;Kb.u=
Oa.htmlPayloadSize;Kb.v=Oa.htmlSizeExceedsLimit;Kb.w=Oa.copyTotalSizeExceedsLimit;Kb.t=Oa.shadowWorkbookPayloadSize;Kb.p=Oa.clientSideCopyTime;Kb.ba=Oa.encounteredDeploymentErrors;Kb.bb=Oa.shadowWorkbookSizeExceedsLimit;Kb.be=Oa.syncClipboardItemsKeys;Kb.bf=Oa.asyncClipboardItemsKeys;Kb.bh=this.Fze(Oa.succeededPopulatingSystemClipboardSync);Kb.bi=this.Fze(Oa.succeededPopulatingSystemClipboardAsync)}return Kb};cc.prototype.etc=function(T,Oa){Oa=void 0===Oa?!1:Oa;if(!this.gridView.isEditing&&!this.gridView.zi){var Kb=
this.gridView.ha.va,ic=!Oa&&1===T.length&&yf.Q(T,Kb.selectedRanges),pd=ic?Kb.activeCell:T[0].topLeft;T[0].contains(pd)||(Bc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Kb.selectedRanges,Kb.wA,Kb.activeCell,T,ic,pd,Oa),pd=T[0].topLeft);this.gridView.ha.bD(T,0,pd,0,void 0,Qe.a.SZg)}};cc.prototype.hZe=
function(T,Oa){var Kb={};Kb.a=this.$.ya.UserSessionId;Kb.g=T.stopwatch.id;Kb.t=T.stopwatch.Ac;Kb.bz=!1;Oa&&(Kb.bv=Oa.id,Kb.bw=Oa.serverRequestTimeInMs,Kb.n=Oa.commandParameters.clipboardFormatReadTimes,Kb.o=Oa.commandParameters.clipboardFormatReadStatus,Kb.p=Oa.commandParameters.clipboardReadPermissionPromptShown,Kb.q=Oa.commandParameters.asyncApiReadTimedOut,Oa.requestTelemetryData&&(Kb.cb=Oa.requestTelemetryData.EcsOperationDuration,Kb.cc=Oa.requestTelemetryData.EcsRequestDuration,Kb.cd=Oa.requestTelemetryData.WfeRequestDuration));
Kb.x=T.copyPasteTargetType.toString();Kb.bl=Wd(T.copyPasteTargetType);Kb.br=T.copyPasteHandlerName;Kb.i=yf.i(T.expandDestinations,",",this.$,!1);Kb.h=yf.i(T.originalDestinations,",",this.$,!1);Kb.e=T.id;Kb.d=T.commandType;Kb.c=$f.b().pi(T.ribbonCommandInfo.command);Kb.b=Rd.a[T.ribbonCommandInfo.method];Kb.bf=!1;Kb.bg=!1;Kb.bp=cc.D9b();Kb.bt=void 0===T.ribbonCommandInfo.df||null===T.ribbonCommandInfo.df?null:xe.a[T.ribbonCommandInfo.df];Kb.cj=T.isPasteCommandFromEnterShortcut;if(Kb.ca=T.isPasteCommandFromRecoveryUI)Kb.cf=
T.pasteRecoveryUndoStopwatch.id,Kb.cg=T.pasteRecoveryUndoStopwatch.Ac;if(Oa){if((T=Oa.copyContextSnapshot)&&!Oa.wasLastCopyExternal){Kb.f=T.commandParameters.id;Kb.j=T.sourceItem.toString();Kb.k=-1;if(Lc(T.sourceItem)){Kb.k=0;for(var ic=yl(T.sourceItem.ranges),pd=ic.next();!pd.done;pd=ic.next())Kb.k+=pd.value.DT}Kb.bg=1===T.commandParameters.commandType}else Oa.clipboardItems?Kb.f=Oa.clipboardItems.getItem(gb.k1c):Bc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Kb.bz=Oa.pasteRecoveryUIDisplayed;Kb.ci=Oa.cseStatus}else Bc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Kb};cc.prototype.Jni=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){T=this.hZe(T,ge);T.l=!1;T.m=Oa;T.s=Kb;T.bc=ic;T.be=pd;T.bd=Td;T.bf=Gd;ge?(T.y=wc(ge)||!ge.copyContextSnapshot,T.bi=!T.y&&ee(ge.copyContextSnapshot,this.$),T.bj=ge.shadowWorkbookSizeExceedsLimit,T.v=ge.shadowWorkbookPayloadSize,T.w=ge.htmlPayloadSize,T.bq=Qd(ge.clipboardItems),
T.bb=ge.activeSelectionType,T.bs=ge.isSameSession,T.bn=ge.payloadOrigin,T.bo=ge.payloadType,T.bu=ge.externalAppSource,T.bx=ge.indicationDisplayScheduled,T.by=ge.pasteIndicationDisplayStatus,T.ck=ge.pasteDestinationHasMergedCells):T.bi=ee(Pe,this.$);$f.b().Ne(44,T,!0);Bc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",T.be,T.bd,T.m,T.bf,T.s)};cc.prototype.Kni=function(T){var Oa=
this.hZe(T.commandParameters,T);Oa.y=T.wasLastCopyExternal;Oa.l=!0;Oa.u=T.plainTextPayloadSize;Oa.v=T.shadowWorkbookPayloadSize;Oa.w=T.htmlPayloadSize;Oa.z=T.isClipboardDataContainShadowWorkbook;Oa.ba=T.isShadowWorkbookParsedSuccessfully;Oa.bb=T.activeSelectionType;Oa.bc=T.pasteResult;Oa.bh=T.encounteredDeploymentErrors;Oa.bj=T.shadowWorkbookSizeExceedsLimit;Oa.bk=oc(T);Oa.bq=Qd(T.clipboardItems);Oa.bs=T.isSameSession;Oa.bn=T.payloadOrigin;Oa.bo=T.payloadType;Oa.bu=T.externalAppSource;Oa.bx=T.indicationDisplayScheduled;
Oa.by=T.pasteIndicationDisplayStatus;Oa.ck=T.pasteDestinationHasMergedCells;Oa.bm=T.clipboardItems?T.clipboardItems.getItem(gb.$Sg):null;Oa.bi=!T.isSameSession&&!T.wasLastCopyExternal;$f.b().Ne(44,Oa,!0)};cc.prototype.ak=function(){this.$.xa.Pf(this.Yh);this.$.xa.OAg(this.Mlc);this.$.userOperationManager.uy(this.bR);this.$.Rk(this.od);Df.g(this.$).Kc.wm(this.eDb)};cc.prototype.mm=function(){this.$&&this.$.xa&&(this.$.xa.rg(this.Yh),this.$.xa.T4i(this.Mlc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.pz(this.bR);
this.gridView&&this.gridView.Kc&&this.gridView.Kc.im(this.eDb)};cc.prototype.NCb=function(T,Oa){var Kb=null,ic=!1,pd=null,Td="UnknownFailure",Gd=-1,ge=cc.Iqb,Pe=cc.pasteErrorName+cc.nIa,gf=!1;this.pasteIndicationManager.Ahd(T.id);this.Jbf&&this.pasteDestinationHasMergedCells(T.expandDestinations)&&(Oa.pasteContext.pasteDestinationHasMergedCells=!0);var kg=Jf(this.fK);(T.clearStateOnFinish||T.clearSystemClipboard)&&this.Hv("Paste/fail/"+Rd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});
if(Oa){Gd=Oa.reason;Pe+=cc.DJa(Oa);Oa.message&&(ge=Oa.message);if(Kb=cc.jZg(Oa))if(1===Kb.pasteErrorName)ic=!0,Td="CopyPasteLengthTooLongPopup",ge=pd="The pasted content is too long. Popup a dialog to the user.",Bc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',pd,T.copyPasteTargetType),Kb=Ec.a.jd(1,0,26,674,0,1306609195,"CopyPasteOversizeError"),me.EwaSettings.az()?new Ob.a(this.$,Kb):(Kb=new Ba.ErrorDialog(this.$,Kb),Kb.initialize(),Kb.nf());
else if(7===Kb.pasteErrorName)ic=!0,Td="No-Op",ge=pd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Bc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',pd,T.copyPasteTargetType);else if(8===Kb.pasteErrorName)ic=!0,Td="UseShortcutsPopup",ge=pd="Unable to paste content from the system clipboard. Popup dialog to the user.",Bc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
pd,T.copyPasteTargetType),this.dEf();else if(18===Kb.pasteErrorName){ic=!0;Td="PasteExternalNotSupportMultipleSelectionPopup";ge="Paste external not support multiple selection.";pd="Unknown";var cg=2121;100!==Kb.validationFailureReason&&(pd=Od[Kb.validationFailureReason],cg=cc.yze(Kb.validationFailureReason));this.wya(cg,pd,!0)}else 20===Kb.pasteErrorName||19===Kb.pasteErrorName?(ic=!0,20===Kb.pasteErrorName?(Td="PasteAcrossSessionNotSupportMultipleSelectionPopup",ge="Paste across session does not support multiple selection."):
(Td="PasteInSameSessionNotSupportMultipleSelectionPopup",ge="This kind of multiple selection is not supported for same session paste."),pd="Unknown",cg=2121,100!==Kb.validationFailureReason&&(pd=Od[Kb.validationFailureReason],cg=cc.yze(Kb.validationFailureReason)),Kb=6===Kb.validationFailureReason,this.WXc(T.commandType,T.expandDestinations)&&Kb&&this.etc(T.expandDestinations),this.wya(cg,pd,!0)):6===Kb.pasteErrorName?(ic=!0,Td="No-Op",ge=pd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
Bc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',pd,T.copyPasteTargetType)):17===Kb.pasteErrorName?(ic=!0,Td="No-Op",ge=pd="Paste text on Art is not yet a supported operation",Bc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',pd,T.copyPasteTargetType)):16===Kb.pasteErrorName?(ic=!0,Td="No-Op",ge=pd="Paste has failed because the previous copy has failed",Bc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
pd,T.copyPasteTargetType,this.getStringifiedError(Kb))):Ec.a.Pq(Kb.ewaErrors)?(Ec.a.x9(Kb.ewaErrors)||Ec.a.hh(Kb.ewaErrors,Ec.a.ebc())?(ic=!0,Td="CommunicationError",pd=Ec.a.Uc(Kb.ewaErrors),Bc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',ge,T.copyPasteTargetType)):Ec.a.hh(Kb.ewaErrors,cc.zcj)?(ic=!0,Td="SavingWorkbookError",pd=Ec.a.Uc(Kb.ewaErrors),Bc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
ge,T.copyPasteTargetType)):Ec.a.hh(Kb.ewaErrors,cc.operationSucceededWithAlert)&&(gf=ic=!0,Td="OperationSucceededWithAlert",pd=Ec.a.Uc(Kb.ewaErrors),Bc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',ge,T.copyPasteTargetType)),ic||(ge=this.v$b(Kb.ewaErrors),ic=this.Vld(Oa))):11===Kb.pasteErrorName&&(ic=!0,Td="No-Op",ge="Paste has failed because user try copy cross-session oart object");15===Oa.reason&&(ic=!0,Td="No-Op",ge="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
He.a.equals(Pe,kd.BMj,!1)&&(ic=!0,Td="No-Op",ge="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}ic||Bc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Oa?this.getStringifiedError(Oa):"null",T.copyPasteTargetType);this.Jni(T,ic,ge,Td,Pe,Gd,gf,Oa.pasteContext,kg);return Promise.reject(Oa)};cc.prototype.kmc=function(T,Oa){var Kb;Bc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Oa.copyPasteTargetType);this.pasteIndicationManager.Ahd(Oa.id);if(this.bQi(Oa.copyPasteTargetType,T)){me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!bf.a.rC&&T.wasLastCopyExternal&&T.payloadType===Pd.SN&&(this.T5a=!0);var ic=null;(null===(Kb=T.pastedRange)||void 0===Kb?0:Kb.Ranges)&&0<T.pastedRange.Ranges.length?ic=yf.g(T.pastedRange.Ranges):T.wasLastCopyExternal||(ic=Oa.expandDestinations);this.mej(T,ic);if(this.tqj(T,ic)){Kb=zd.a.clone(Oa.originalDestinations);
ic=1028===Oa.commandType?zd.a.clone(Oa.expandDestinations):zd.a.clone(ic);var pd=null;T.wasLastCopyExternal&&(Oa.isKeyboardEvent||Oa.isPasteCommandFromRecoveryUI)&&(pd={},pd=(pd[cc.TCf]=T.clipboardItems,pd));this.Jbf&&this.pasteDestinationHasMergedCells(Oa.expandDestinations)&&(T.pasteDestinationHasMergedCells=!0);T.pasteRecoveryUIDisplayed=!0;var Td=new ze(this.$,Kb,ic,pd),Gd=ef.GetServiceTaskFactory.Xa(this.$.da,406,405,0);gg.TaskExtensions.Ba(Gd,function(){var ge=Gd.result;ge.KJg(Td);ge.Etj(Oa.ribbonCommandInfo.method)},
this.ma,3)}}this.swe("Paste/success/"+Rd.a[Oa.ribbonCommandInfo.method],T);this.Kni(T);this.CZf&&(!Oa.isKeyboardEvent||oc(T))&&this.$.fa.jh.get(66)&&(Bc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.CZf=!1,this.J_g());return Promise.resolve(!0)};cc.prototype.tqj=function(T,Oa){return!Oa||1!==Oa.length||T.commandParameters.clearSystemClipboard||T.commandParameters.clearStateOnFinish||T.commandParameters.skipClipboardAccess?!1:
wc(T)&&(Oa=T.clipboardItems.getItem(gb.UV),T=T.clipboardItems.getItem(gb.html),void 0===Oa||null===Oa||Oa.length>this.Htd||void 0===T||null===T||T.length>this.dNa)?(Bc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};cc.prototype.bQi=function(T,Oa){return 1===T||Oa.payloadType===Pd.UV||me.EwaSettings.la(161)&&Oa.payloadType===Pd.html||me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!bf.a.rC&&Oa.payloadType===Pd.SN};cc.prototype.pasteDestinationHasMergedCells=function(T){var Oa=Df.g(this.$).Ca.oE();if(!Oa||!Oa.length)return!1;Oa=yl(Oa);for(var Kb=Oa.next();!Kb.done;Kb=Oa.next())if(Kb.value.Uv(T[0]))return!0;return!1};cc.prototype.swe=function(T,Oa){var Kb=this,ic;(function(){var pd=Kb.N9h(Oa);ic=pd.nGa;return pd})().returnValue&&this.Hv(T,ic,void 0,void 0,Oa.commandParameters.copyPasteTargetType).catch(function(){})};cc.prototype.Nxd=function(T,Oa,Kb,ic,pd,Td){Bc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",T?this.getStringifiedError(T):"null");var Gd=!1,ge=!1,Pe=!1,gf=cc.Iqb,kg=cc.JGe+cc.nIa;T&&(kg+=cc.DJa(T),Ec.a.Pq(T.ewaErrors)?(gf=this.v$b(T.ewaErrors),Ec.a.hh(T.ewaErrors,cc.operationSucceededWithAlert)&&(Gd=!0),Ec.a.hh(T.ewaErrors,cc.dragDropNonEmptyRange)&&(ge=Pe=!0)):T.message&&(gf=T.message));Pe||(Pe=this.Vld(T));ge?this.gridView.ha.selectionType=-1:this.Er.y_i(pd);this.Cmi(Oa,Kb,ic,pd,Pe,gf,kg,Gd,Td);return Promise.reject(T)};cc.prototype.IXc=
function(T,Oa){var Kb=T,ic=this.vLh();if(null===ic||void 0===ic?0:ic.ranges)Kb=this.Er.jPg(Oa,ic.ranges,T);return Kb};cc.prototype.vLh=function(){var T=Jf(this.fK);return T&&Lc(T.sourceItem)?T.sourceItem:null};cc.prototype.AXi=function(){this.raiseEvent(cc.yzd,null)};cc.prototype.mej=function(T,Oa){var Kb=T.commandParameters.originalDestinations;Oa&&(yf.Q(this.gridView.ha.va.selectedRanges,Kb)?(this.etc(Oa),Bc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Md.HelperMethods.fnb(Oa))):T.commandParameters.isPasteCommandFromRecoveryUI?(this.etc(Oa,!0),Bc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Oa,Oa[0].topLeft)):Bc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Md.HelperMethods.fnb(Kb)))};
cc.prototype.N9h=function(T){if(T.isPlainTextPaste||T.isHtmlPaste||hd(T)||T.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,nGa:!1};var Oa=T.copyContextSnapshot;if(T.commandParameters.clearStateOnFinish)return{returnValue:!0,nGa:!0};if(Oa&&Lc(Oa.sourceItem)){var Kb=Oa.sourceItem;if(!Kb.isFromCurrentSession(this.$))return{returnValue:!1,nGa:!0};Oa=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;if(!(1<Kb.ranges.length||1<T.commandParameters.expandDestinations.length)){var ic=
yf.K(Kb.ranges);T=yf.K(T.commandParameters.expandDestinations);var pd=this.$.fa.oa.sheetName;Kb=Kb.sheetName;if(Kb===pd&&T.equals(ic))return{returnValue:!1,nGa:!0};if(Kb===pd&&T.Jf(ic))return{returnValue:!0,nGa:!1}}return{returnValue:Oa,nGa:!0}}return{returnValue:!1,nGa:!0}};cc.prototype.Yzf=function(){var T=Jf(this.fK);(T=this.Er.Gub(T))&&T.isFromCurrentSession(this.$)&&this.Hv("OnStartEdit",!1).catch(function(){})};cc.prototype.v$b=function(T){T=Ec.a.iIh(T,cc.nIa);return this.zsi+We.a.lu(T).toString()};
cc.prototype.Vld=function(T){T=cc.DJa(T);return!!T&&He.a.M0a(T,cc.ysi)};cc.prototype.J_g=function(){var T=Ec.a.jd(1,2,325,326,bf.a.Po?327:bf.a.iH?328:329,530046625,"ActivateLocalStorage"),Oa=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);gg.TaskExtensions.Ba(Oa,function(){Oa.result.hg(41,T)},this.ma,3)};cc.prototype.Fze=function(T){return void 0===T||null===T?ne.Uvi:T?ne.success:ne.failed};cc.jZg=function(T){var Oa=T.innerError;return(null===Oa||void 0===Oa?0:Oa.pasteErrorName)?T.innerError:null};cc.VYg=
function(T){var Oa=T.innerError;return(null===Oa||void 0===Oa?0:Oa.copyErrorName)?T.innerError:null};cc.DJa=function(T){var Oa="";if(!T)return cc.LDe;T.errorName&&(Oa=T.errorName,T.innerError&&(Oa+=cc.nIa+cc.DJa(T.innerError)));Oa||(Oa=T&&T.name?T.name:cc.LDe);return Oa};cc.D9b=function(){cc.cKb||(Xf.a.Xbf()?cc.cKb=Bd.Suj:Xf.a.dnd()?cc.cKb=Bd.Ruj:cc.cKb=Bd.Quj);return cc.cKb};cc.yze=function(T){switch(T){case 7:case 1:return 2128;case 5:return 2125;case 6:return 2124;case 8:case 3:case 2:case 4:case 9:case 10:return 2121;
default:return Bc.ULS.shipAssertTag(537167764,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",T),2128}};cc.WYg=function(T){switch(T){case 3:return 2122;case 1:return 2123;case 2:case 4:return 2121;default:return Bc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",T),2128}};tl.Object.defineProperties(cc.prototype,{pasteIndicationManager:{configurable:!0,
enumerable:!0,get:function(){return this.$.da.Aa(373)}}});cc.Bmf="EwaJsMetadataChangeListenerId";cc.yzd="cpiOSC";cc.Y8g="cpiDID";cc.Iqb="Unknown";cc.LDe="UnknownError";cc.nIa="_";cc.JGe="DragAndDropError";cc.pasteErrorName="PasteError";cc.mQg="CancelError";cc.copyErrorName="CopyError";cc.ysi="MergedCellOverlap";cc.TCf="PasteRecoveryCachedClipboardItems";cc.zcj=[1352631530,1679665408];cc.operationSucceededWithAlert=[-103190598];cc.pasteDataLimitHit=[1306609195];cc.copyThrottlingError=[-386183710];
cc.dragDropNonEmptyRange=[563945982];cc.cKb=null;Object(Jc.a)(cc,"CopyPasteInfrastructure",mf.a,[790,791,3]);Object(Jc.a)(Ie,"ClipboardPlatformInitializationResult",null,[]);var nb=b(686),fc=b(120),$d=b(4),Id=b(81);Object(Jc.a)(Ac,"MacroRecorderPasteRangePayload",null,[98]);dc.prototype.getContent=function(){return this.content};Object(Jc.a)(dc,"MacroRecorderPasteStringPayload",null,[98]);var Me=b(59);Object(Jc.a)(mb,"MacroRecorderPastePayload",null,[98]);var se=b(603),td=b(911),af=b(519),Fd=b(163),
wf=b(201),vf=b(126),pg=b(273),sg=b(336);Aa.prototype.getParameters=function(){return this.parameters};Object(Jc.a)(Aa,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[98]);var Ze=b(368);uc.prototype.copy=function(T,Oa,Kb,ic,pd){function Td(gf,kg,cg){var Wg={CopyPasteTargetType:1};Wg.SourceRanges=T;Wg.CopyOperationId=Oa.id;Bc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Gd.HLa,Wg.CopyOperationId);Gd.qMa=Gd.HLa?Kd(Gd.$.qa.ex,
Wg,pg.b(gf,Kb),ic?pg.a(kg,ic):kg,cg,Oa.ribbonCommandInfo,ge,pd):Kd(Gd.$.qa.ta,Wg,pg.b(gf,Kb),ic?pg.a(kg,ic):kg,cg,Oa.ribbonCommandInfo,ge,pd);return Gd.qMa}var Gd=this;ic=void 0===ic?null:ic;pd=void 0===pd?null:pd;var ge=this.$.qa.ta.Xb();this.ykd&&this.RX();this.shc=ge.ClientRequestId;var Pe=me.EwaSettings.tc()?new Fd.a(505,0,Td,80):new af.a(505,0,Td,16);Pe=this.$.userOperationManager.ic(Pe,Oa.ribbonCommandInfo);this.ykd&&this.Su.add(Pe)};uc.prototype.SCf=function(T,Oa,Kb,ic,pd,Td){var Gd=this;return new Promise(function(ge,
Pe){var gf,kg=Td.commandParameters.stopwatch.Ac,cg=2;20===Td.commandParameters.commandType&&(cg=16);36===Td.commandParameters.commandType&&(cg=32);Xf.a.dnd()&&68===Td.commandParameters.commandType&&(cg=64);Xf.a.wpd(Gd.$)&&1028===Td.commandParameters.commandType&&(cg=1024);var Wg=null;if(null===(gf=Td.copyContextSnapshot)||void 0===gf?0:gf.commandParameters)Wg=Td.copyContextSnapshot.commandParameters.id;uc.dLd(Gd.$,T,ic,Oa,Kb,null,function(tg){uc.Abc(tg,Td,ge,Pe,kg,Gd.$)},function(tg){Td.serverRequestTimeInMs=
Td.commandParameters.stopwatch.Ac-kg;tg=vf.a.yg(tg.data);Pe(new td.a(5,tg))},pd,cg,Wg,Td.commandParameters.id)})};uc.prototype.pasteRange=function(T,Oa,Kb,ic,pd,Td,Gd,ge){var Pe=this;return new Promise(function(gf,kg){var cg=Gd.commandParameters.stopwatch.Ac;uc.Bfj(Pe.$,T,Oa,Kb,ic|-5&pd,function(Wg){uc.Abc(Wg,Gd,gf,kg,cg,Pe.$)},function(Wg){Gd.serverRequestTimeInMs=Gd.commandParameters.stopwatch.Ac-cg;Wg=vf.a.yg(Wg.data);kg(new td.a(5,Wg))},Td,ge)})};uc.prototype.UUi=function(T,Oa,Kb,ic,pd,Td,Gd){var ge=
this;return new Promise(function(Pe,gf){if(Oa)if(Oa.length>ge.dNa){var kg=Gd.clipboardItems.getItem(gb.UV),cg=-1;void 0!==kg&&null!==kg&&(cg=kg.length);Bc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Oa.length,ge.dNa,cg);gf(new td.a(1))}else kg=function(Wg,tg,Jh){ge.$.Xu();var Fh=Gd.commandParameters.stopwatch.Ac;Wg=pg.b(Wg,function(Di){uc.Abc(Di,Gd,Pe,gf,Fh,ge.$,Oa)});
tg=pg.a(tg,function(Di){Gd.serverRequestTimeInMs=Gd.commandParameters.stopwatch.Ac-Fh;Di=vf.a.yg(Di.data);gf(new td.a(3,Di))});var Xg=ge.$.qa.ta.Xb(),hi=yf.v(T,ge.$),Ci={};Ci.SourceHtml=Oa;Ci.DestinationRanges=hi?yf.s(hi):null;Ci.CopyOperationId=Kb;Ci.PasteId=ic;Bc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",ge.HLa,Ci.PasteId);return ge.HLa?qd(ge.$.qa.ex,Ci,Wg,tg,Jh,null,Xg,Td):qd(ge.$.qa.ta,Ci,Wg,tg,Jh,null,Xg,Td)},kg=
me.EwaSettings.tc()?new Fd.a(204,0,kg,65):new af.a(204,0,kg,1),ge.$.userOperationManager.ic(kg,pd);else Pe("")})};uc.prototype.VUi=function(T,Oa,Kb,ic,pd){var Td=this;return new Promise(function(Gd,ge){Bc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",pd.id);Oa&&(Oa=He.a.trimEnd(Oa,"\n","\r"));Bc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",
pd.id);if(Oa){var Pe=Td.Htd;if(Oa.length>Pe)Bc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Oa.length,Pe),ge(new td.a(1));else{var gf=yf.v(T,Td.$);Bc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",pd.id);Pe=!Td.$.fa.isNamedObjectViewMode&&!Oa.includes("\n")&&!Oa.includes("\t");Bc.ULS.sendTraceTag(537167751,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",pd.id,Pe);Pe=Pe&&He.a.xbf(Oa);Bc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",pd.id,Pe);var kg=Td.$.qa.ta.Xb();if(Pe){var cg=526;Bc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",pd.id);
var Wg=wf.a.q$c(Oa);Bc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",pd.id);var tg=yf.s(gf);Pe=function(Fh,Xg,hi){var Ci=pd.commandParameters.stopwatch.Ac;Fh=pg.b(Fh,function(Di){Bc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",pd.id);pd.requestTelemetryData=Di.RequestTelemetryData;pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.Ac-
Ci;Di.Errors&&0<Di.Errors.length?ge(new td.a(2,Di.Errors)):Gd(Oa)});Xg=pg.a(Xg,function(Di){pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.Ac-Ci;Di=vf.a.yg(Di.data);ge(new td.a(2,Di))});Td.$.Xu();Bc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",pd.id);return Id.c(Td.$.qa.ta,tg,Oa,Wg,!1,!1,63,Fh,Xg,hi,T,kg,ic)};var Jh=function(){return new se.a(tg,Oa,Wg)}}else cg=180,Pe=function(Fh,Xg,hi){Td.$.Xu();var Ci=
pd.commandParameters.stopwatch.Ac;Fh=pg.b(Fh,function(Di){Bc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",pd.id);uc.Abc(Di,pd,Gd,ge,Ci,Td.$,Oa)});Xg=pg.a(Xg,function(Di){pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.Ac-Ci;Di=vf.a.yg(Di.data);ge(new td.a(4,Di))});Bc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",
pd.id);return Yd(Td.$.qa.ta,gf,Oa,Fh,Xg,hi,null,kg,ic)},Jh=function(){return new dc(gf,Oa)};Bc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",pd.id);Pe=me.EwaSettings.tc()?new Fd.a(cg,0,Pe,65,Jh):new af.a(cg,0,Pe,1,Jh);Bc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",pd.id);Td.$.userOperationManager.ic(Pe,Kb)}}else Gd("")})};
uc.prototype.J5e=function(T,Oa){Oa=[1===Oa?4:5];this.gridView.Nb.uw(sg.a.QW(Me.d(this.$.oa),T),Oa,!0);this.gridView.Nb.Yr(Oa);this.gridView.Nb.update(!0)};uc.prototype.Tvb=function(){var T=[4,5];this.gridView.Nb.kl(T,!1,!this.Hfc);this.gridView.Nb.Jl(null,T,!this.Hfc);1===this.gridView.ha.Te&&this.gridView.Yr(!1,!this.Hfc);this.Hfc&&this.gridView.Nb.update(!1,!1)};uc.prototype.jPg=function(T,Oa,Kb){var ic=[];Kb=yl(Kb);for(var pd=Kb.next();!pd.done;pd=Kb.next())Array.add(ic,this.mPg(T,Oa,pd.value));
return ic};uc.prototype.RX=function(){if(this.Su)for(var T=yl(this.Su),Oa=T.next();!Oa.done;Oa=T.next())Oa=Oa.value,this.$&&this.$.userOperationManager&&(Oa.operation&&Bc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",fc.a(Oa.operation.operationName)),this.kQg(),this.$.userOperationManager.CHa(Oa))};uc.prototype.kQg=function(){if(this.qMa){var T=this.qMa.kt;Bc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",
T);vf.a.Zt(T);this.shc&&Id.j(this.$.qa.ta,this.shc,null,null,null);this.shc=this.qMa=null}};uc.prototype.aF=function(T,Oa){2===Oa.Wx?(this.Su.clear(),this.qMa=null):1===Oa.Wx&&this.Su&&this.Su.contains(Oa.Sg)&&(Bc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",fc.a(Oa.Sg.operation.operationName),Oa.Sg.dequeueUtcTime.getTime()-Oa.Sg.enqueueUtcTime.getTime()),this.Su.remove(Oa.Sg),this.qMa=null)};uc.prototype.mPg=function(T,
Oa,Kb){Bc.ULS.shipAssertTag(537167713,0,!!Oa,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Bc.ULS.shipAssertTag(537167712,0,0<Oa.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var ic=0,pd=0,Td=new Set,Gd=new Set;Oa=yl(Oa);for(var ge=Oa.next();!ge.done;ge=Oa.next()){ge=ge.value;var Pe=String.format("{0}_{1}",ge.left,ge.right),gf=String.format("{0}_{1}",ge.top,ge.bottom);Gd.has(Pe)||(Gd.add(Pe),pd+=ge.width);Td.has(gf)||(Td.add(gf),
ic+=ge.height)}if(36===T)return Kb.isSingle?uc.IOe(pd,ic,Kb):Kb.clone();516===T&&(T=ic,ic=pd,pd=T);T=!(Kb.width%pd)&&!(Kb.height%ic);Td=Kb.Y4&&!(Kb.height%ic);Kb.bba&&!(Kb.width%pd)||Td?Kb=uc.IOe(pd,ic,Kb):T?Kb=Kb.clone():(Kb=Kb.clone(),Kb.bottom=Math.min(df.a.Fh,Kb.top+ic-1),Kb.right=Math.min(df.a.Qh,Kb.left+pd-1));return Kb};uc.prototype.EGg=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe,gf,kg){if(!ic||!ic.length)return 1;if(1<ic.length){if(!this.qec&&Td)return 3;if(gf)return 0;if(ge)return 9;if(Pe)return 8;
if(kg)return 2;if(1<Oa.length)return 4;var cg=Oa[0];if(!Gd&&!zd.a.all(ic,function(Wg){return Wg.isSingle||!(Wg.width%cg.width)&&!(Wg.height%cg.height)}))return 5;if((!this.qec||!Td)&&He.a.equals(T,Kb,!0))for(pd=yl(pd),T=pd.next();!T.done;T=pd.next())if(T=T.value,T.Rd(cg)&&!T.equals(cg))return 6}else if(Oa&&0<Oa.length){if(this.p$e(Oa,Pe))return 7;if(1<Oa.length){if(!this.qec&&Td)return 3;if((!this.qec||!Td)&&He.a.equals(T,Kb,!0))for(T=yl(Oa),Oa=T.next();!Oa.done;Oa=T.next())if(Oa=Oa.value,Kb=pd[0],
Oa.Rd(Kb)&&!Oa.equals(Kb))return 6}}return 0};uc.prototype.p$e=function(T,Oa){if(!T||1>=T.length)return 0;if(Oa)return 2;if(!yf.S(T))return 1;Oa=new nb.a(cb.a.Ik());for(var Kb=yl(T),ic=Kb.next();!ic.done;ic=Kb.next()){ic=ic.value;for(var pd=yl(T),Td=pd.next();!Td.done;Td=pd.next()){Td=Td.value;var Gd=ic.top===Td.top&&ic.bottom===Td.bottom,ge=ic.left===Td.left&&ic.right===Td.right,Pe=Math.max(ic.left,Td.left)<Math.min(ic.right,Td.right);if(Math.max(ic.top,Td.top)<Math.min(ic.bottom,Td.bottom)&&!Gd||
Pe&&!ge)return 3;Oa.add(String.format("{0}-{1}-{2}-{3}",ic.top,ic.bottom,Td.left,Td.right));Oa.add(String.format("{0}-{1}-{2}-{3}",Td.top,Td.bottom,ic.left,ic.right))}}T=yl(T);for(Kb=T.next();!Kb.done;Kb=T.next())Kb=Kb.value,Oa.remove(String.format("{0}-{1}-{2}-{3}",Kb.top,Kb.bottom,Kb.left,Kb.right));return 0<Oa.count?3:0};uc.prototype.y_i=function(T){var Oa=this.gridView.ha;Oa.updateSelection(T,T.topLeft,0);Oa.selectionType=-1};uc.prototype.Gub=function(T){if(null===T||void 0===T?0:T.sourceItem){if(!Lc(T.sourceItem))return null;
if((T=T.sourceItem)&&yf.cb(T.ranges,!0))return T}return null};uc.prototype.Tec=function(T,Oa){Bc.ULS.shipAssertTag(537167711,0,!!T,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Oa&&$d.a.bI in Oa||T.tabName?!1:1===T.method};uc.Bfj=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){function gf(){return new Ac(Kb,ic,pd)}function kg(Wg,tg,Jh){T.Xu();var Fh=T.qa.ta;Wg=pg.b(Wg,Td);tg=pg.a(tg,Gd);var Xg=ge;Xg=void 0===Xg?null:Xg;var hi=Fh.Oa(9,cg);hi.sourceRanges=Kb;hi.destinationRanges=
ic;hi.flags=pd;return Id.i(Fh,"PasteRange",hi,Wg,tg,Jh,null,64,Xg)}var cg=T.qa.ta.Xb(Pe);Pe=me.EwaSettings.tc()?new Fd.a(506,0,kg,65,gf):new af.a(506,0,kg,1,gf);T.userOperationManager.ic(Pe,Oa)};uc.Abc=function(T,Oa,Kb,ic,pd,Td,Gd){Gd=void 0===Gd?null:Gd;Bc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Oa.id);Oa.requestTelemetryData=T.RequestTelemetryData;Oa.serverRequestTimeInMs=Oa.commandParameters.stopwatch.Ac-
pd;Ec.a.ih(T.Errors)?Ec.a.v9(T.Errors)?(Oa&&(Oa.encounteredDeploymentErrors=!0),Bc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Ec.a.Uc(T.Errors))):ic(new td.a(5,T.Errors)):T.Result?(ic=!!T&&!!T.RequestTelemetryData,Df.g(Td).Ji.Pka(Oa.commandParameters.stopwatch.id,T.StateId,ic?T.RequestTelemetryData.EcsOperationDuration:0,ic?T.RequestTelemetryData.EcsRequestDuration:0,ic?
T.RequestTelemetryData.WfeRequestDuration:0),Oa.pastedRange=T.Result.SheetMultiRange,Bc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Oa.id),Kb(!0)):(Bc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Oa.id),Kb(Gd||!0))};uc.dLd=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe,gf,kg,cg){function Wg(){return new mb(Fh)}
function tg(Xg,hi,Ci){T.Xu();return bd(T.qa.ta,Fh,pg.b(Xg,Gd),pg.a(hi,ge),Ci,Td,Jh,Pe)}var Jh=T.qa.ta.Xb(),Fh=uc.M3g(Kb,ic,pd,gf,kg,cg);Kb=me.EwaSettings.tc()?new Fd.a(503,0,tg,65,Wg):new af.a(503,0,tg,1,Wg);T.userOperationManager.ic(Kb,Oa)};uc.M3g=function(T,Oa,Kb,ic,pd,Td){var Gd={};Gd.ShadowWorkbookBase64=T.shadowWorkbookBase64;Gd.SourceRanges={};Gd.SourceRanges.Ranges=Array(1);Gd.SourceRanges.Ranges[0]={};Gd.SourceRanges.Ranges[0].FirstRow=T.rangeRowStart;Gd.SourceRanges.Ranges[0].LastRow=T.rangeRowEnd;
Gd.SourceRanges.Ranges[0].FirstColumn=T.rangeColumnStart;Gd.SourceRanges.Ranges[0].LastColumn=T.rangeColumnEnd;me.EwaSettings.getBooleanFeatureGate(Cd.a.n3b,!1)?Kb?Gd.DestinationRanges=yf.u(Kb.SheetName,Kb.NamedObjectName,yf.g(Kb.Ranges)):(Bc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Gd.DestinationRanges=null):Gd.DestinationRanges=Oa?yf.s(Oa):null;Gd.CopyPasteTargetType=1;Gd.PasteType=ic;Gd.CopyOperationId=pd;Gd.PasteId=Td;Gd.SourceClientPath=
T.sourceClientPath;Gd.SourceSheetName=T.sourceSheetName;Gd.SourceWorkbookName=T.sourceWorkbookName;if(!T.originalSourceRangesCountExceedsLimit&&T.originalSourceRanges&&0<T.originalSourceRanges.length&&1024===ic){Gd.OriginalSourceMultiRange={};Oa=Array(T.originalSourceRanges.length);for(Kb=0;Kb<Oa.length;++Kb)Oa[Kb]={},Oa[Kb].FirstRow=T.originalSourceRanges[Kb][0],Oa[Kb].FirstColumn=T.originalSourceRanges[Kb][1],Oa[Kb].LastRow=T.originalSourceRanges[Kb][2],Oa[Kb].LastColumn=T.originalSourceRanges[Kb][3];
Gd.OriginalSourceMultiRange.Ranges=Oa}return Gd};uc.IOe=function(T,Oa,Kb){Kb=Kb.clone();Kb.height<Oa&&(Kb.bottom=Math.min(df.a.Fh,Kb.top+Oa-1));Kb.width<T&&(Kb.right=Math.min(df.a.Qh,Kb.left+T-1));return Kb};uc.prototype.executeInsertCopiedCutCellsOperation=function(T,Oa,Kb,ic,pd,Td,Gd){function ge(){return new Aa(Pe)}Td=void 0===Td?null:Td;Gd=void 0===Gd?null:Gd;var Pe={};Pe.InsertDirection=ic;Pe.SourceRange=T;Pe.DestRange=Oa;Pe.CopyCutOperation=Kb?0:1;var gf=this.$.qa.ta;return Ze.a(this.$.userOperationManager,
function(kg,cg,Wg){kg=Td?pg.b(kg,Td):kg;cg=Gd?pg.a(cg,Gd):cg;var tg=gf.Oa(41,null);tg.insertCopiedCutCellsParameters=Pe;return Id.i(gf,"InsertCopiedCutCells",tg,kg,cg,Wg,null,4)},function(kg){return new Fd.a(104,0,kg,void 0,ge)},pd)};uc.prototype.gdh=function(T,Oa,Kb,ic,pd,Td){var Gd=this;return new Promise(function(ge,Pe){Gd.executeInsertCopiedCutCellsOperation(Oa,Kb,ic,pd,Td,function(gf){T.requestTelemetryData=gf.RequestTelemetryData;gf.Errors&&0<gf.Errors.length?Pe(new td.a(21,gf.Errors)):ge(!0)},
function(gf){gf=vf.a.yg(gf.data);Pe(new td.a(21,gf))}).continueWith(function(){if(ic)Gd.Tvb();else{var gf=Gd.$.da.Aa(254);gf&&gf.T0b("DragDropInsert/success/"+Rd.a[Td.method],!0)}})})};tl.Object.defineProperties(uc.prototype,{Htd:{configurable:!0,enumerable:!0,get:function(){Bc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},dNa:{configurable:!0,
enumerable:!0,get:function(){return this.HLa?me.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):df.a.dNa}}});Object(Jc.a)(uc,"CopyPasteUtils",null,[789]);var Lg=b(496),hg;(function(T){T[T.range=0]="range";T[T.art=1]="art"})(hg||(hg={}));Object(Jc.b)("SourceItemType",hg);var ud=b(24),xf=b(92);Hc.prototype.serializeSourceItem=function(T){var Oa={};if(T&&Object.getType(T)===Cb)Oa.sheetName=T.sheetName,Oa.topArray=zd.a.map(T.ranges,
function(Kb){return Kb.top}),Oa.leftArray=zd.a.map(T.ranges,function(Kb){return Kb.left}),Oa.bottomArray=zd.a.map(T.ranges,function(Kb){return Kb.bottom}),Oa.rightArray=zd.a.map(T.ranges,function(Kb){return Kb.right}),Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.sourceItemType=this.QTf(0);else if(T&&Object.getType(T)===Bb)Oa.activeFloatingObjectControlId=T.activeFloatingObjectControlId,Oa.sheetName=T.sheetName,Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.floatingObjectType=
this.cgj(T.type),Oa.sourceItemType=this.QTf(1);else return Bc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Oa)};Hc.prototype.serializeCommandParameters=function(T){if(!T)return Bc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Oa={};Oa.id=T.id;Oa.commandType=T.commandType;Oa.copyPasteTargetType=T.copyPasteTargetType;T.ribbonCommandInfo&&
(Oa.ribbonCommandName=this.kgj(T.ribbonCommandInfo.command),Oa.inputMethodName=this.egj(T.ribbonCommandInfo.method),Oa.frameModeName=this.dgj(T.ribbonCommandInfo.mode),Oa.uiLocationName=this.ngj(T.ribbonCommandInfo.df),Oa.tabName=T.ribbonCommandInfo.tabName);return JSON.stringify(Oa)};Hc.prototype.deserializeSourceItem=function(T){if(!T)return null;try{var Oa=JSON.parse(T);if(!Oa)return Bc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;var Kb=null;switch(this.Y9g(Oa.sourceItemType)){case 0:Kb=new Cb(this.$,this.V9g(Oa),Oa.sheetName,Oa.sessionStateId,Oa.sessionId);break;case 1:Kb=new Bb(Oa.activeFloatingObjectControlId,Oa.sheetName,Oa.sessionStateId,Oa.sessionId,this.S9g(Oa.floatingObjectType))}return Kb}catch(ic){return Bc.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",T?T.length:0,ic),null}};Hc.prototype.deserializeCommandParameters=
function(T){if(!T)return null;try{var Oa=JSON.parse(T);if(!Oa)return Bc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var Kb=Ld.a();Kb.id=Oa.id;Kb.ribbonCommandInfo=this.X9g(Oa);Kb.commandType=Oa.commandType;Kb.copyPasteTargetType=Oa.copyPasteTargetType;return Kb}catch(ic){return Bc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",
T?T.length:0,ic),null}};Hc.prototype.V9g=function(T){var Oa=[];Bc.ULS.shipAssertTag(537167699,0,!!T.topArray&&0<T.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",T.topArray?"empty":"null");Bc.ULS.shipAssertTag(537167698,0,!!T.leftArray&&0<T.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",T.leftArray?"empty":"null");Bc.ULS.shipAssertTag(537167697,0,!!T.bottomArray&&0<T.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",
T.bottomArray?"empty":"null");Bc.ULS.shipAssertTag(537167696,0,!!T.rightArray&&0<T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",T.rightArray?"empty":"null");if(!(T.topArray&&T.leftArray&&T.bottomArray&&T.rightArray))return Oa;Bc.ULS.shipAssertTag(537167695,0,T.topArray.length===T.bottomArray.length&&T.topArray.length===T.leftArray.length&&T.topArray.length===T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",
T.topArray.length,T.bottomArray.length,T.leftArray.length,T.rightArray.length);for(var Kb=Math.min(T.topArray.length,T.bottomArray.length,T.leftArray.length,T.rightArray.length),ic=0;ic<Kb;ic++)Array.add(Oa,new ud.Range(T.topArray[ic],T.leftArray[ic],T.bottomArray[ic],T.rightArray[ic],!1,!1));return Oa};Hc.prototype.X9g=function(T){return new xf.a(this.W9g(T.ribbonCommandName),this.U9g(T.inputMethodName),this.T9g(T.frameModeName),this.Z9g(T.uiLocationName),T.tabName)};Hc.prototype.kgj=function(T){return void 0!==
T&&null!==T&&T.toString()in this.jJd?this.jJd[T.toString()]:(Bc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,T),this.jJd["-911352779"])};Hc.prototype.W9g=function(T){return T&&T in this.T2f?this.T2f[T]:(Bc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,T),-911352779)};Hc.prototype.egj=function(T){return void 0!==T&&null!==T&&Rd.a[T]in this.Nja?this.Nja[Rd.a[T]]:(Bc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",T),this.Nja.unknown)};Hc.prototype.U9g=function(T){return T&&T in this.S2f?this.S2f[T]:(Bc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",T),0)};Hc.prototype.dgj=function(T){return void 0!==
T&&null!==T&&Lg.a[T]in this.U1a?this.U1a[Lg.a[T]]:(Bc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",T),this.U1a.edit)};Hc.prototype.T9g=function(T){return T&&T in this.R2f?this.R2f[T]:(Bc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",T),2)};Hc.prototype.QTf=function(T){return void 0!==T&&null!==T&&hg[T]in this.nKb?this.nKb[hg[T]]:(Bc.ULS.shipAssertTag(537167688,0,!1,
"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",T),this.nKb.range)};Hc.prototype.Y9g=function(T){return T&&T in this.U2f?this.U2f[T]:(Bc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",T),0)};Hc.prototype.cgj=function(T){return void 0!==T&&null!==T&&T.toString()in this.qVc?this.qVc[T.toString()]:(Bc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",
T),this.qVc["99"])};Hc.prototype.S9g=function(T){return T&&T in this.Q2f?this.Q2f[T]:(Bc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",T),99)};Hc.prototype.ngj=function(T){return void 0!==T&&null!==T&&xe.a[T]in this.rr?this.rr[xe.a[T]]:(Bc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",T),this.rr.ribbon)};Hc.prototype.Z9g=function(T){return T&&T in this.V2f?this.V2f[T]:
(Bc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",T),2)};Object(Jc.a)(Hc,"EnvironmentSerializationHelper",null,[]);Jb.jRf="SameSession";Jb.CCe="CrossSession";Jb.fhf="LegacyCrossSession";Jb.external="External";Object(Jc.a)(Jb,"PayloadOrigin",null,[]);Ca.prototype.shouldWaitForCopyToComplete=function(){return!1};Ca.prototype.onDeferredPasteStarted=function(){};Ca.prototype.onDeferredPasteCompleted=function(){};Ca.prototype.beforePaste=
function(){};Ca.prototype.IFj=function(T){var Oa=null;try{var Kb=T.getItem(gb.SN);if(!Kb)return{returnValue:!1,g0:Oa};Oa=JSON.parse(Kb);return{returnValue:this.$gi(Oa),g0:Oa}}catch(ic){return Bc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+ic),{returnValue:!1,g0:Oa}}};Ca.prototype.$gi=function(T){return!!T&&(!!T.shadowWorkbookBase64||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==T.rangeRowEnd&&void 0!==T.rangeColumnStart&&
void 0!==T.rangeColumnEnd};Ca.prototype.Mnc=function(T){T.wasLastCopyExternal=!0;if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!bf.a.rC&&516!==T.commandParameters.commandType&&1028!==T.commandParameters.commandType){var Oa=this.IFj(T.clipboardItems);var Kb=Oa.g0;if(Oa.returnValue)return T.isShadowWorkbookParsedSuccessfully=!0,this.VPi(T,Kb)}return 516!==T.commandParameters.commandType&&36!==T.commandParameters.commandType?me.EwaSettings.la(161)&&
20!==T.commandParameters.commandType&&(Kb=T.clipboardItems.getItem(gb.html),void 0!==Kb&&null!==Kb&&Kb&&Kb.trim()!==this.uVc&&(Kb.startsWith("<")||bf.a.zf&&Kb.startsWith("\n<")))?(Oa=T.clipboardItems.getItem(gb.k1c),this.TPi(T,Kb,void 0===Oa?null:Oa)):this.OCf(T):Promise.reject(new td.a(6))};Ca.prototype.VPi=function(T,Oa){Bc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");T.pasteResult="SystemClipboardShadowWorkbookPaste";
T.payloadType=Pd.SN;T.payloadOrigin=Jb.external;T.shadowWorkbookPayloadSize=$b(Oa);T.shadowWorkbookSizeExceedsLimit=db(Oa);var Kb=null,ic=null,pd=T.commandParameters.originalDestinations;me.EwaSettings.getBooleanFeatureGate(Cd.a.n3b,!1)?Kb=yf.r(pd,this.$):ic=yf.v(yf.K(pd),this.$);Oa.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=Oa.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return Bc.ULS.sendTraceTag(537167833,0,15,
"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,df.a.kjc,Oa.shadowWorkbookSizeExceedsLimit),Promise.reject(new td.a(1));Bc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",T.commandParameters.id);return this.Er.SCf(T.commandParameters.ribbonCommandInfo,ic,Kb,Oa,[T.commandParameters.stopwatch],
T)};Ca.prototype.OCf=function(T){var Oa=T.clipboardItems.getItem(gb.UV);if(void 0!==Oa&&null!==Oa&&Oa.trim()===this.uVc)return Promise.reject(new td.a(7));void 0!==Oa&&null!==Oa&&(T.plainTextPayloadSize=Oa.length);T.isPlainTextPaste=!0;T.pasteResult="SystemClipboardPaste";T.payloadOrigin=oc(T)?Jb.fhf:Jb.external;T.payloadType=Pd.UV;Bc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",T.id,T.commandParameters.id);
Oa=this.Er.VUi(yf.K(T.commandParameters.originalDestinations),Oa,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],T);Bc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",T.id);return Oa};Ca.prototype.TPi=function(T,Oa,Kb){T.htmlPayloadSize=Oa.length;T.isHtmlPaste=!0;T.pasteResult="SystemClipboardHtmlPaste";T.payloadType=Pd.html;T.payloadOrigin=oc(T)?Jb.fhf:Jb.external;Bc.ULS.sendTraceTag(42071711,
0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",T.commandParameters.id);return this.Er.UUi(yf.K(T.commandParameters.originalDestinations),Oa,Kb,T.commandParameters.id,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],T)};Ca.prototype.cCe=function(T){var Oa={};T&&(Oa.shadowWorkbookBase64=T.ShadowWorkbookBase64,Oa.shadowWorkbookSizeExceedsLimit=T.ShadowWorkbookSizeExceedsLimit,Oa.originalSourceRangesCountExceedsLimit=T.OriginalSourceRangesCountExceedsLimit,
Oa.originalSourceRangesCount=T.OriginalSourceRangesCount,Oa.shadowWorkbookBlockedSize=T.ShadowWorkbookBlockedSize);return Oa};Ca.prototype.kbg=function(T,Oa){var Kb=wc(T),ic=32===(T.commandParameters.commandType&32),pd=1024===(T.commandParameters.commandType&1024),Td=!1,Gd=null,ge=null,Pe=!1;if(!Kb){Td=-1985798686===T.commandParameters.ribbonCommandInfo.command;var gf=T.copyContextSnapshot;if(Oa)Pe=!gf.sourceItem.isFromCurrentSession(this.$);else if(gf=this.Er.Gub(gf))Gd=gf.ranges,ge=gf.sheetName,
Pe=!T.isSameSession}return this.Er.EGg(ge,Gd,this.$.oa.sheetName,T.commandParameters.originalDestinations,T.commandParameters.expandDestinations,Pe,ic,pd,Td,Oa,Kb)};tl.Object.defineProperties(Ca.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},uVc:{configurable:!0,enumerable:!0,get:function(){return this.Om.Va(5)}}});Object(Jc.a)(Ca,"BaseCopyPasteHandler",null,[871,872,873]);Wa.prototype.getValue=function(T){return this.key&&this.key.isEqual(T)?this.createClipboardItems(this.clipboardItems):
null};Wa.prototype.setValue=function(T,Oa){this.key=T;this.clipboardItems=this.createClipboardItems(Oa)};Wa.prototype.createClipboardItems=function(T){var Oa=this.T9.create(),Kb=T.getItem(gb.UV);Kb&&Oa.setItem(gb.UV,Kb);(Kb=T.getItem(gb.SN))&&Oa.setItem(gb.SN,Kb);(T=T.getItem(gb.html))&&Oa.setItem(gb.html,T);return Oa};Object(Jc.a)(Wa,"CopyCache",null,[]);var Nh=b(67);vm(Za,Ca);Za.prototype.getSourceItem=function(){var T=zd.a.clone(this.gridView.ha.va.selectedRanges);return new Cb(this.$,T,this.$.fa.oa.sheetName,
this.$.fa.rf,this.$.ya.UserSessionId)};Za.prototype.beforeSerialize=function(T){var Oa=this;T.isSelectionAllowed=!1;T.isAsyncCopy=!1;T.isFromCache=!1;T.encounteredDeploymentErrors=!1;T.plainTextPayloadSize=0;T.shadowWorkbookPayloadSize=0;T.htmlPayloadSize=0;T.clientSideCopyTime=0;var Kb=new Qf.a(this.$.xa),ic=T.sourceItem;T.isSelectionAllowed=zd.a.all(ic.ranges,function(pd){return Oa.isSelectionAllowed(Kb,pd)});T.isSelectionAllowed&&this.Er.J5e(ic.ranges,T.commandParameters.commandType)};Za.prototype.ULa=
function(T){return this.gridView.Ca.cH()&&Df.i(this.gridView,T)};Za.prototype.qQi=function(T,Oa,Kb,ic){var pd=!1,Td=1===Oa.commandParameters.commandType,Gd=ic[0].DT;1===Kb.ranges.length&&1===ic.length?me.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Td&&1!==Gd&&Gd!==Kb.ranges[0].DT?T.cseStatus=17:pd=this.RZg.s5c(T,yf.K(Kb.ranges),Kb.sheetName,yf.K(T.commandParameters.expandDestinations),this.$.fa.oa.sheetName,Td):T.cseStatus=5;pd&&Df.g(this.$).Ji.m0(T.commandParameters.stopwatch.id,
Nh.BasicTelemetryCalculator.sQ);return this.$Pi(T,Kb,yf.u(this.$.oa.sheetName,null,ic),Oa.commandParameters.commandType,pd)};Za.prototype.isSelectionAllowed=function(T,Oa){return T.zyb(Oa,this.gridView)};Za.prototype.$Pi=function(T,Oa,Kb,ic,pd){Oa=yf.u(Oa.sheetName,null,Oa.ranges);T.pasteResult="SameSessionPaste";T.payloadOrigin=Jb.jRf;T.payloadType=Pd.hvg;Bc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",T.commandParameters.id);
return this.Er.pasteRange(T.commandParameters.ribbonCommandInfo,Oa,Kb,ic,T.commandParameters.commandType,[T.commandParameters.stopwatch],T,pd)};Object(Jc.a)(Za,"BaseRangeCopyPasteHandler",Ca,[]);var Fg=b(32);ec.prototype.onDeferredPasteStarted=function(T){this.eU.wb(T.id)||this.eU.add(T.id,!0);if(0<this.eU.count){var Oa=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);gg.TaskExtensions.Ba(Oa,function(){Oa.result.hg(28,null)},this.$.ma,3)}};ec.prototype.onDeferredPasteCompleted=function(T){var Oa=0<this.eU.count;
this.eU.wb(T.id)&&this.eU.remove(T.id);if(Oa&&!this.eU.count){var Kb=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);gg.TaskExtensions.Ba(Kb,function(){Kb.result.removeEntry(28)},this.$.ma,3)}};Object(Jc.a)(ec,"DeferredPasteTracker",null,[]);var mh;(function(T){T[T.none=0]="none";T[T.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";T[T.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";T[T.asyncCopyCanceled=3]="asyncCopyCanceled";T[T.loadCopiedArtDataFromServerFailed=
4]="loadCopiedArtDataFromServerFailed"})(mh||(mh={}));Object(Jc.b)("CopyErrorType",mh);var ld=b(1058),mg=b(1214),hh=ld.a;vm(Yb,hh);Object(Jc.a)(Yb,"CopyInnerError",ld.a,[]);vm($a,Za);$a.prototype.serialize=function(T){var Oa=T.sourceItem,Kb={},ic=this.j1c.getValue(Oa);if(ic)Kb.synchronousResult=ic,T.isFromCache=!0,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac;else{var pd=null,Td=yf.F(Oa.ranges);if(!Xf.a.Yaf()&&this.ULa(Td)){Bc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");
Td=this.clipboardRangeFactory.create(Td);try{pd=Td.toString(),ic=this.T9.create(),ic.setItem(gb.UV,pd),this.j1c.setValue(Oa,ic),Kb.synchronousResult=ic,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac}finally{Td&&Td.dispose()}}else T.isAsyncCopy=!0,Kb.synchronousResult=this.T9.create(),Kb.synchronousResult.setItem(gb.UV,this.uVc);Kb.asynchronousResult=this.Ubd(T,Oa,pd)}T.syncClipboardItemsKeys=Qd(Kb.synchronousResult);return Kb};$a.prototype.shouldWaitForCopyToComplete=function(T){if(!T||!T.copyContextSnapshot)return Bc.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;Bc.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(T.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return Bc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;Bc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};$a.prototype.onDeferredPasteStarted=function(T){this.eU.onDeferredPasteStarted(T)};$a.prototype.onDeferredPasteCompleted=function(T){this.eU.onDeferredPasteCompleted(T)};$a.prototype.deserialize=function(T){T.isClipboardDataContainShadowWorkbook=!(void 0===T.clipboardItems.getItem(gb.SN)||null===T.clipboardItems.getItem(gb.SN));if(Df.g(this.$).ha.Te&326)return wc(T)&&(T.wasLastCopyExternal=
!0),Promise.reject(new td.a(17));var Oa=this.kbg(T,!1);if(Oa)return Promise.reject(new td.a(wc(T)?18:T.isSameSession?19:20,void 0,void 0,void 0,Oa));var Kb=T.copyContextSnapshot,ic=this.Er.Gub(Kb);if(wc(T))return this.Mnc(T);Oa=T.commandParameters.originalDestinations;if(ic&&T.isSameSession)return this.qQi(T,Kb,ic,Oa);if(516!==T.commandParameters.commandType){ic=this.HFj(T.clipboardItems);Kb=ic.g0;if(ic.returnValue){T.isShadowWorkbookParsedSuccessfully=!0;var pd=ic=null;me.EwaSettings.getBooleanFeatureGate(Cd.a.n3b,
!1)?ic=yf.r(Oa,this.$):pd=yf.v(yf.K(Oa),this.$);return this.RPi(T,pd,ic,Kb)}if(T.isClipboardInaccessible)return Promise.reject(new td.a(8));if(36!==T.commandParameters.commandType)return this.OCf(T)}return Promise.reject(new td.a(6))};$a.prototype.beforePaste=function(T){this.$.da.Aa(373).Ucj(T);T.indicationDisplayScheduled=!0};$a.prototype.dFj=function(T){if(!(T&&T.SourceRanges&&T.SourceRanges.Ranges&&T.SourceRanges.Ranges.length&&(T.OriginalSourceRangesCountExceedsLimit||T.OriginalSourceMultiRange&&
T.OriginalSourceMultiRange.Ranges&&T.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,g0:null};var Oa=T.SourceRanges.Ranges[0];if(!T.ShadowWorkbookBase64&&!T.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,g0:null};var Kb=this.cCe(T);Kb.rangeRowStart=Oa.FirstRow;Kb.rangeRowEnd=Oa.LastRow;Kb.rangeColumnStart=Oa.FirstColumn;Kb.rangeColumnEnd=Oa.LastColumn;Kb.sourceClientPath=T.SourceClientPath;Kb.sourceSheetName=T.SourceSheetName;Kb.sourceWorkbookName=T.SourceWorkbookName;if(!T.OriginalSourceRangesCountExceedsLimit)for(T=
T.OriginalSourceMultiRange.Ranges,Kb.originalSourceRanges=Array(T.length),Oa=0;Oa<T.length;++Oa)Kb.originalSourceRanges[Oa]=[T[Oa].FirstRow,T[Oa].FirstColumn,T[Oa].LastRow,T[Oa].LastColumn];return{returnValue:!0,g0:Kb}};$a.prototype.HFj=function(T){var Oa=null;T=T.getItem(gb.SN);if(!T)return{returnValue:!1,g0:Oa};Oa=JSON.parse(T);return{returnValue:this.Zgi(Oa),g0:Oa}};$a.prototype.Zgi=function(T){return!!T&&(!!T.shadowWorkbookBase64||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==
T.rangeRowEnd&&void 0!==T.rangeColumnStart&&void 0!==T.rangeColumnEnd};$a.prototype.RPi=function(T,Oa,Kb,ic){Bc.ULS.shipAssertTag(537167903,0,!!ic,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");ve.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");T.pasteResult="CrossSessionPaste";T.payloadOrigin=Jb.CCe;T.payloadType=Pd.SN;T.shadowWorkbookPayloadSize=$b(ic);T.shadowWorkbookSizeExceedsLimit=
db(ic);ic.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=ic.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return Bc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,df.a.kjc,ic.shadowWorkbookSizeExceedsLimit),Promise.reject(new td.a(1));if(1028===
T.commandParameters.commandType&&T.originalSourceRangesCountExceedsLimit)return Bc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",ic.originalSourceRangesCount,df.a.fri,ic.originalSourceRangesCountExceedsLimit),Promise.reject(new td.a(1));Bc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",
T.commandParameters.id);return this.Er.SCf(T.commandParameters.ribbonCommandInfo,Oa,Kb,ic,[T.commandParameters.stopwatch],T)};$a.prototype.Ubd=function(T,Oa,Kb){var ic=this;Bc.ULS.shipAssertTag(537167901,0,!!T,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var pd=T.commandParameters.stopwatch.Ac;return new Promise(function(Td,Gd){Bc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",
T.id);var ge=yf.u(Oa.sheetName,null,Oa.ranges);ic.Er.copy(ge,T.commandParameters,function(Pe){T.requestTelemetryData=Pe.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-pd;if(Ec.a.ih(Pe.Errors))Ec.a.v9(Pe.Errors)?(T.encounteredDeploymentErrors=!0,Bc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe.Errors),
T.id)):(Bc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe.Errors),T.id),Gd(new Yb(2,Pe.Errors)));else if(Bc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",T.id),T.markForCancellation)Gd(new Yb(3,Pe.Errors));else{Pe=Pe.Result;var gf=Pe.PlainTextResult;void 0!==Kb&&null!==Kb&&(gf=Kb);void 0!==
gf&&null!==gf&&(T.plainTextPayloadSize=gf.length);var kg=ic.T9.create(),cg=ic.dFj(Pe);var Wg=cg.g0;cg.returnValue&&(T.shadowWorkbookPayloadSize=$b(Wg),T.shadowWorkbookSizeExceedsLimit=db(Wg),T.originalSourceRangesCountExceedsLimit=Pe.OriginalSourceRangesCountExceedsLimit,Wg=JSON.stringify(Wg),kg.setItem(gb.SN,Wg));kg.setItem(gb.UV,gf);Xf.a.Yaf()&&(gf=Pe.HtmlResult,T.htmlSizeExceedsLimit=Pe.HtmlSizeExceedsLimit,void 0!==gf&&null!==gf&&(T.htmlPayloadSize=gf.length),kg.setItem(gb.html,gf));T.copyTotalSizeExceedsLimit=
Pe.CopyTotalSizeExceedsLimit;kg.setItem(gb.k1c,T.commandParameters.id);ic.j1c.setValue(Oa,kg);T.asyncClipboardItemsKeys=Qd(kg);Td(kg)}},function(Pe){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-pd;Pe=vf.a.yg(Pe.data);Bc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe),T.id);Gd(new Yb(2,Pe))},[T.commandParameters.stopwatch])})};Object(Jc.a)($a,"AcrossSessionRangeCopyPasteHandler",
Za,[]);Object(Jc.a)(jb,"CopyArtRequest",null,[]);Object(Jc.a)(Ua,"PasteArtRequest",null,[]);Ga.prototype.sYh=function(T){if(this.ldi(T.YMa)){Bc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",T.YMa);var Oa=this.GGb.na(T.YMa);this.GGb.ia(T.YMa,T);var Kb=Oa.promise;Oa.mbf=!1;return this.Agh(T,Kb)}this.GGb.ia(T.YMa,T);return this.Oji(T)};Ga.prototype.ldi=function(T){return this.GGb.wb(T)};Ga.prototype.Oji=
function(T){var Oa=this;return new Promise(function(Kb,ic){T.promise=Oa.oYa.NCf(T).then(function(pd){Kb(null);return Oa.kmc(T,pd)},function(pd){ic(null);return Oa.NCb(pd)})})};Ga.prototype.Agh=function(T,Oa){var Kb=this;return new Promise(function(ic,pd){T.promise=Oa.then(function(Td){Kb.FKj(T,Td);return Kb.oYa.NCf(T).then(function(Gd){ic(null);return Kb.kmc(T,Gd)},function(Gd){pd(null);return Kb.NCb(Gd)})},function(Td){return Kb.NCb(Td)})})};Ga.prototype.kmc=function(T,Oa){T.mbf&&(this.LTg(T.YMa),
this.GKd(T,Oa));return this.wVi(Oa)};Ga.prototype.LTg=function(T){this.GGb.remove(T)};Ga.prototype.GKd=function(T,Oa){var Kb=this.SQh();T.YMa===Kb&&this.oYa.GKd(T.destination,Oa,T.item.type)};Ga.prototype.SQh=function(){var T=Df.g(this.$).ha.Qa.activeFloatingObjectControlId;T||(T=yf.v(Df.g(this.$).ha.va.activeCell,this.$),T=T.FirstRow+"_"+T.FirstColumn);return T};Ga.prototype.FKj=function(T,Oa){T.destination=null;T.yEe=Oa};Object(Jc.a)(Ga,"PasteArtRequestManager",null,[]);var $e=b(188),Qg=b(115),
ch=b(103);vm(Ha,Ca);Ha.prototype.getSourceItem=function(){Bc.ULS.shipAssertTag(537167896,0,!!this.ha.Qa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");Bc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Qa.activeFloatingObjectControlId);return new Bb(this.ha.Qa.activeFloatingObjectControlId,this.$.fa.oa.sheetName,this.$.fa.rf,this.$.ya.UserSessionId,this.ha.Qa.nc.floatingObject.type)};
Ha.prototype.beforeSerialize=function(T){T&&T.commandParameters?(T?(T.isAsyncCopy=!1,T.isSelectionAllowed=!1,T.isFromCache=!1,T.plainTextPayloadSize=0,T.shadowWorkbookPayloadSize=0,T.htmlPayloadSize=0,T.htmlSizeExceedsLimit=!1,T.clientSideCopyTime=0,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=!1,T.copyTotalSizeExceedsLimit=!1):Bc.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),T.commandParameters.copyPasteTargetType=
2):Bc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};Ha.prototype.serialize=function(T){var Oa=T.sourceItem,Kb={};if(!Oa)return Bc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Kb;if(!this.Tfi())return Bc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Kb;Bc.ULS.sendTraceTag(537167892,0,
50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Oa.activeFloatingObjectControlId);this.UBd();var ic=this.i1c.getValue(Oa);if(ic)Kb.synchronousResult=ic,T.isFromCache=!0,T.isAsyncCopy=!1,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac,1===T.commandParameters.commandType&&this.$.Ce(2045211913,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.df,null);else{T.isFromCache=!1;T.isAsyncCopy=!0;ic=this.T9.create();if(T.commandParameters.uploadToClipService){var pd=
{};pd["data-clipservice-ccpid"]=T.commandParameters.id;pd["data-pkey"]=T.commandParameters.pKey;pd["data-clipservice-type"]=T.commandParameters.clipServiceDataType;pd["data-clipservice-count"]=T.commandParameters.objectCount.toString();pd["data-clipservice-dc"]=T.commandParameters.clipServiceDataCenter;pd["data-clipservice-client"]=this.CUg;pd["data-TimeStamp"]=(new Date).toUTCString();pd["data-clipservice-version"]=this.DUg;ic.setItem(gb.rDg,JSON.stringify(pd))}Kb.synchronousResult=this.Nwg(ic);
Kb.asynchronousResult=this.Ubd(T,Oa,ic)}T.syncClipboardItemsKeys=Qd(Kb.synchronousResult);return Kb};Ha.prototype.Nwg=function(T){Bc.ULS.shipAssertTag(537167891,0,!!this.ha.Qa.nc,"Expecting a floating object to be currently selected for copy");T||(T=this.T9.create());var Oa=this.ha.Qa.nc.jtb();Oa&&(Oa=String.format("<img src='{0}'>",Oa),T.setItem(gb.html,Oa));return T};Ha.prototype.UBd=function(){var T=this.ha.Qa.nc;this.hnb.UBd(Qg.a.epb(T.floatingObject),Qg.a.FUg(T.qt))};Ha.prototype.shouldWaitForCopyToComplete=
function(){Bc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Ha.prototype.onDeferredPasteStarted=function(T){this.eU.onDeferredPasteStarted(T)};Ha.prototype.onDeferredPasteCompleted=function(T){this.eU.onDeferredPasteCompleted(T)};Ha.prototype.deserialize=function(T){var Oa=wc(T),Kb=null,ic=null,pd=!1;if(!Oa){Kb=T.copyContextSnapshot;ic=Kb.sourceItem;if(!ic)return Promise.reject(new td.a(10));pd=ic.isFromCurrentSession(this.$)}var Td=this.kbg(T,
!0);if(Td)return Promise.reject(new td.a(Oa?18:pd?19:20,void 0,void 0,void 0,Td));if(Oa)return this.Mnc(T);if(!pd&&!Ha.n$h(ic))return T=String.format("User attempted to paste art of type [{0}] between sessions.",ic.type),Bc.ULS.sendTraceTag(537167889,0,50,T),Promise.reject(new td.a(11,void 0,void 0,T));if(Kb.isAsyncSerializeFailed)return Promise.reject(new td.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{var Gd=T.clipboardItems.getItem(gb.SN);
var ge=JSON.parse(Gd)}catch(Pe){return Bc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(Pe)),Promise.reject(new td.a(12,void 0,Pe))}ge.floatingObjectId!==ic.activeFloatingObjectControlId?Bc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
ic.activeFloatingObjectControlId,ge.floatingObjectId):Bc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",ic.activeFloatingObjectControlId,ge.floatingObjectId);if(!ge||!ge.shadowWorkbookBase64)return Promise.reject(new td.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!ge)));T.isShadowWorkbookParsedSuccessfully=!0;T.shadowWorkbookPayloadSize=
$b(ge);T.shadowWorkbookSizeExceedsLimit=db(ge);T.payloadOrigin=pd?Jb.jRf:Jb.CCe;T.payloadType=Pd.yeg;if(db(ge))return T=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,df.a.kjc,ge.shadowWorkbookSizeExceedsLimit),Bc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",T),Promise.reject(new td.a(1,void 0,void 0,T));Kb=Oa=null;Df.g(this.$).ha.Te&326?Kb=Df.g(this.$).ha.Qa.activeFloatingObjectControlId:
Oa=this.$.oa&&this.$.oa.activeCell?yf.v(this.$.oa.activeCell,this.$):yf.v(yf.K(T.commandParameters.originalDestinations),this.$);pd=null;if(this.hnb.fZf(ic))try{pd=this.hnb.s5c()}catch(Pe){Bc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(Pe))}return this.SPi.sYh(new Ua(T.commandParameters.ribbonCommandInfo,Oa,Kb,T.commandParameters.commandType,[T.commandParameters.stopwatch],
ge,ic,T,pd))};Ha.prototype.Mnc=function(T){T.wasLastCopyExternal=!0;if(T.clipboardItems.getItem("image/png")){var Oa=T.commandParameters.stopwatch.Ac;T.payloadType=Pd.LJg;var Kb={};return ac.b(this.$.Ce(1403967063,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.df,(Kb.dataUrl=T.clipboardItems.getItem("image/png"),Kb))).then(function(ic){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-Oa;return ic?Promise.resolve(null):Promise.reject(new td.a(15))},function(){T.serverRequestTimeInMs=
T.commandParameters.stopwatch.Ac-Oa;return Promise.reject(new td.a(15))})}Bc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Ca.prototype.Mnc.call(this,T)};Ha.prototype.Tfi=function(){var T=Df.g(this.$).ha;return T.Qa.activeFloatingObjectControlId&&T.Qa.nc&&T.Qa.nc.floatingObject?T.Qa.nc.floatingObject.HRd():!1};Ha.prototype.Ubd=function(T,Oa,Kb){var ic=this;return new Promise(function(pd,Td){var Gd=T.commandParameters.stopwatch.Ac;
Bc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");ic.oYa.JZg(new jb(Oa.activeFloatingObjectControlId,T.commandParameters,function(ge){T.requestTelemetryData=ge.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-Gd;if(Ec.a.ih(ge.Errors))Ec.a.v9(ge.Errors)?(T.encounteredDeploymentErrors=!0,Bc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Ec.a.Uc(ge.Errors))):(Bc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Ec.a.Uc(ge.Errors)),Td(new Yb(4,ge.Errors)));else if(Bc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Oa.activeFloatingObjectControlId),T.markForCancellation)Td(new Yb(3,ge.Errors));else{Ec.a.Pq(ge.Errors)&&Bc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Ec.a.Uc(ge.Errors));var Pe=ge.Result;if(Pe){Pe=ic.cCe(Pe);Pe.floatingObjectId=Oa.activeFloatingObjectControlId;T.shadowWorkbookPayloadSize=$b(Pe);T.shadowWorkbookSizeExceedsLimit=db(Pe);try{var gf=JSON.stringify(Pe)}catch(kg){Td(new td.a(14,void 0,kg,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",T.shadowWorkbookPayloadSize,Pe.floatingObjectId)));return}Bc.ULS.shipAssertTag(537167881,0,!!Kb,"Expecting syncClipboardItems to be defined");
Kb.setItem(gb.SN,gf);1===T.commandParameters.commandType&&(ic.eTi(Oa.type,Oa.activeFloatingObjectControlId,ge.StateId),ic.deleteFloatingObject(Oa.activeFloatingObjectControlId,Oa.type));ic.i1c.setValue(Oa,Kb);T.asyncClipboardItemsKeys=Qd(Kb);pd(Kb)}else Bc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Oa.activeFloatingObjectControlId),pd(ic.i1c.getValue(Oa))}},T.commandParameters.commandType,Oa.type,function(ge){T.serverRequestTimeInMs=
T.commandParameters.stopwatch.Ac-Gd;ge=vf.a.yg(ge.data);1===T.commandParameters.commandType&&ic.oYa.FGj(Oa.type,Oa.activeFloatingObjectControlId);Bc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Ec.a.Uc(ge));Td(new Yb(4,ge))},[T.commandParameters.stopwatch]))})};Ha.prototype.deleteFloatingObject=function(T,Oa){T=$e.a.Jy(Oa,T);if(T=ch.a(this.$).Hp(T))ch.a(this.$).deleteFloatingObject(T,14,!0),Df.g(this.$).ha.Qa.ZB=null};Ha.prototype.eTi=
function(T,Oa,Kb){var ic=this.$.da.Aa(277);if(ic){var pd=null;T=$e.a.Jy(T,Oa);T=ch.a(this.$).Hp(T);if(null===T||void 0===T?0:T.Ti)pd=T.Ti.block;if(pd){var Td=T.floatingObject.Eg();ic.jXb(function(){return!pd.Wi.wb(Td)},Kb,"CutArt")}}};Ha.n$h=function(T){return 1===T.type||5===T.type};Object(Jc.a)(Ha,"ArtCopyPasteHandler",Ca,[]);var wg=b(52);vm(bb,mb);Object(Jc.a)(bb,"MacroRecorderPasteArtPayload",mb,[]);ka.prototype.E2h=function(T,Oa,Kb,ic,pd,Td,Gd){var ge=this;Td=void 0===Td?null:Td;Gd=void 0===
Gd?null:Gd;var Pe=this.$.qa.ta.Xb(),gf=null,kg={CopyPasteTargetType:2};kg.FloatingObjectId=T;kg.CopyOperationId=Kb.id;Kb.floatingObjectType=Oa;kg.UploadToClipService=Kb.uploadToClipService;kg.PKey=Kb.pKey;kg.ClipServiceDataCenter=Kb.clipServiceDataCenter;var cg=0;2===pd?(pd=505,cg=16,gf=function(Wg,tg,Jh){return Kd(ge.$.qa.ta,kg,pg.b(Wg,ic),Td?pg.a(tg,Td):tg,Jh,Kb.ribbonCommandInfo,Pe,Gd)}):(pd=179,gf=function(Wg,tg,Jh){ge.ich(Oa,T);ge.$.Xu();var Fh=ge.$.qa.ta;Wg=pg.b(Wg,ic);tg=Td?pg.a(tg,Td):tg;
var Xg=Kb.ribbonCommandInfo,hi=Gd;hi=void 0===hi?null:hi;var Ci=Fh.Oa(1,void 0===Pe?null:Pe);Ci.copyParameters=kg;return Id.i(Fh,"Cut",Ci,Wg,tg,Jh,Xg,0,hi)});me.EwaSettings.tc()?this.$.userOperationManager.ic(new Fd.a(pd,0,gf,cg|64),Kb.ribbonCommandInfo):this.$.userOperationManager.ic(new af.a(pd,0,gf,cg),Kb.ribbonCommandInfo)};ka.prototype.ich=function(T,Oa){var Kb=$e.a.Jy(T,Oa);(Kb=ch.a(this.$).Hp(Kb))?(Df.g(this.$).ha.Qa.wG(Kb),Kb.isVisible=!1):Bc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
T,Oa)};ka.prototype.FGj=function(T,Oa){T=$e.a.Jy(T,Oa);if(T=ch.a(this.$).Hp(T))T.isVisible=!0};ka.prototype.JZg=function(T){this.E2h(T.floatingObjectId,T.HZg,T.commandParameters,T.lr,T.f7g,T.I3,T.wWd)};ka.prototype.d3h=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){var gf=this;ge=void 0===ge?null:ge;Pe=void 0===Pe?!0:Pe;return new Promise(function(kg,cg){var Wg=Td.commandParameters.stopwatch.Ac;gf.dLd(T,pd,Oa,Kb,function(tg){Td.requestTelemetryData=tg.RequestTelemetryData;Td.serverRequestTimeInMs=Td.commandParameters.stopwatch.Ac-
Wg;if(Ec.a.v9(tg.Errors))Td&&(Td.encounteredDeploymentErrors=!0),Bc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Ec.a.Uc(tg.Errors));else if(Ec.a.ih(tg.Errors))Bc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Ec.a.Uc(tg.Errors)),cg(new td.a(9,tg.Errors));else if(tg.Result){var Jh=tg.Result;Bc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
gf.rTi(Gd,Jh.FloatingObjectId,tg.StateId);kg(ka.Sid(Jh.FloatingObjectId))}else Bc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),cg(new td.a(9,tg.Errors))},function(tg){Td.serverRequestTimeInMs=Td.commandParameters.stopwatch.Ac-Wg;tg=vf.a.yg(tg.data);Bc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Ec.a.Uc(tg));cg(new td.a(9,tg))},ic,ge,Pe)})};ka.prototype.rTi=function(T,Oa,Kb){var ic=
this,pd=this.$.da.Aa(277);if(pd){var Td=$e.a.Jy(T,ka.Sid(Oa));pd.jXb(function(){return!!ch.a(ic.$).Hp(Td)},Kb,"PasteArt")}};ka.prototype.HUd=function(T,Oa){Oa&&this.hnb.HUd(T,$e.a.Jy(T.type,Oa))};ka.prototype.NCf=function(T){var Oa=this;return this.d3h(T.ribbonCommandInfo,T.destination,T.yEe,T.wWd,T.g0,T.pasteContext,T.item.type,T.Cwe,T.item.isFromCurrentSession(this.$)).then(function(Kb){return Kb},function(Kb){Oa.HUd(T.item,T.Cwe);return Promise.reject(Kb)})};ka.prototype.GKd=function(T,Oa,Kb){T||
(T=yf.v(Df.g(this.$).ha.va.activeCell,this.$));Df.g(this.$).bgc(yf.D(T),1)?ch.a(this.$).zma(Kb,Oa,!0):Df.g(this.$).ha.Qa.kGa(T,Oa,Kb).continueWith(function(ic){ic.result?Bc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Oa):Bc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Oa)})};ka.prototype.dLd=function(T,Oa,Kb,ic,pd,Td,Gd,ge,Pe){function gf(){if(Pe){var Jh=
wg.a.li(wg.a.Hc(tg));Jh.FloatingObjectId=Oa.floatingObjectId;tg.DestinationRanges||(Jh.DestinationRanges=yf.p(cg.$.xa.oa.sheetName,"",0,0,0,0));return new bb(Jh,Pe,0,0)}return new bb(tg,Pe,0,0)}function kg(Jh,Fh,Xg){ge||cg.$.Xu();return bd(cg.$.qa.ta,tg,pg.b(Jh,pd),pg.a(Fh,Td),Xg,null,Wg,Gd)}var cg=this;Pe=void 0===Pe?!0:Pe;var Wg=this.$.qa.ta.Xb(),tg={};tg.ShadowWorkbookBase64=Oa.shadowWorkbookBase64;tg.FloatingObjectId=ic;tg.DestinationRanges=Kb?yf.s(Kb):null;tg.CopyPasteTargetType=2;tg.ClientEstimationFloatingObjectId=
ge;Kb=me.EwaSettings.tc()?new Fd.a(503,0,kg,void 0,gf):new af.a(503,0,kg,void 0,gf);Kb.flags=me.EwaSettings.tc()?65:1;this.$.userOperationManager.ic(Kb,T)};ka.Sid=function(T){return String.format("{0}.{{{1}}}",T.length+2,T.toUpperCase())};Object(Jc.a)(ka,"ArtCopyPasteUtils",null,[859]);var Gi=b(239);Nb.prototype.UBd=function(T,Oa){this.ssa=T;this.g1c=Oa};Nb.prototype.s5c=function(){if(!this.ssa||!this.g1c)return Bc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var T=Qg.a.epb(new $e.a(this.ssa));T.Id=ka.Sid(bg.a.create().toString());T.Version=-1;T.Name="";T.IsClientEstimation=!0;var Oa=this.o4h(T);if(!Oa)return null;var Kb=new $e.a(T);Oa.block.Wi.add(Kb);Kb.MGb();var ic=ch.a(this.$);ic.B2b(Kb,Oa);Oa=ic.Hp($e.a.fKh(T));!Oa||Oa.floatingObject.BLa||Oa.floatingObject.$La||Oa.HQa(this.g1c);ic.zma(T.Type,T.Id,!0);return T.Id};Nb.prototype.fZf=function(T){return me.EwaSettings.la(222)&&T.isFromCurrentSession(this.$)&&!Df.g(this.$).rtl&&!Df.g(this.$).$a.Zi};
Nb.prototype.HUd=function(T,Oa){this.fZf(T)&&(T=ch.a(this.$).Hp(Oa))&&(Bc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Oa,T.floatingObject.type),ch.a(this.$).deleteFloatingObject(T,15,!0),T.Ti&&T.K$a(T.Ti,!1))};Nb.prototype.o4h=function(T){if(!T)return Bc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),
null;if(Df.g(this.$).ha.Qa.activeFloatingObjectControlId){var Oa=Df.g(this.$).ha.Qa.ZB.floatingObject;T.OriginDeltaX=Oa.offsetX+this.p9a;T.OriginDeltaY=Oa.offsetY+this.p9a;T.AbsoluteLeft+=this.p9a;T.AbsoluteTop+=this.p9a;T.AbsoluteRight+=this.p9a;T.AbsoluteBottom+=this.p9a;T.ZOrder=Oa.hy+1;return Df.g(this.$).ha.Qa.ZB.Ti}if(!this.$.oa||!this.$.oa.activeCell)return Bc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var Kb=this.$.oa.activeCell;Oa=Df.g(this.$).L0(Kb);if(!Oa)return Bc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Kb.toString()),null;var ic=Md.HelperMethods.LJa(Oa.domElement,Oa.sj.domElement);Kb=Oa.gridView.Lg(Kb,2);if(!ic||!Kb)return Bc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!ic,!Kb),null;T.OriginDeltaX=Kb.topLeft.x-ic.x;T.OriginDeltaY=Kb.topLeft.y-ic.y;T.AbsoluteLeft=Kb.topLeft.x;T.AbsoluteTop=Kb.topLeft.y;T.AbsoluteRight=T.AbsoluteLeft+Math.abs(this.ssa.AbsoluteRight-this.ssa.AbsoluteLeft);T.AbsoluteBottom=T.AbsoluteTop+Math.abs(this.ssa.AbsoluteBottom-this.ssa.AbsoluteTop);T.ZOrder=this.ssa.ZOrder+100;return new Gi.a(Oa.gridView.Ca.jl(Oa.hashCode),Oa.hashCode)};Object(Jc.a)(Nb,"ArtPasteClientEstimation",null,[854]);E.prototype.create=function(){var T=window.clipboardPlatform;
return T?T.createClipboardItems():null};Object(Jc.a)(E,"ClipboardItemsFactory",null,[853]);vb.undefined="Undefined";Object(Jc.a)(vb,"CCPTelemetryConsts",null,[]);rc.cells="Cells";rc.floatingObject="FloatingObject";rc.unknown="Unknown";Object(Jc.a)(rc,"ActiveSelection",null,[]);pb.mbh="DisplayNotInvoked";pb.k5c="Displayed";pb.CTi="PrerequisitesNotReady";Object(Jc.a)(pb,"PasteIndicationDisplayStatus",null,[]);var mi=b(106);fb.prototype.getCopyFlowHandler=function(T){var Oa=this.cGh(Df.g(this.$).Te);
T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};fb.prototype.getPasteFlowHandler=function(T){var Oa=T.copyContextSnapshot;Oa=hd(T)?this.pVc:wc(T)?this.SDd:(null===Oa||void 0===Oa?0:Oa.sourceItem)&&Object.getType(Oa.sourceItem)===Bb?this.pVc:this.SDd;T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};fb.prototype.initializePasteContext=function(T){if(T&&(T.isSameSession=!1,T.isShadowWorkbookParsedSuccessfully=!1,T.pasteResult=vb.undefined,T.payloadOrigin=vb.undefined,T.payloadType=
vb.undefined,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=!1,T.activeSelectionType=this.bCh(),T.indicationDisplayScheduled=!1,T.pasteDestinationHasMergedCells=!1,T.pasteIndicationDisplayStatus=pb.mbh,T.copyContextSnapshot)){var Oa=T.copyContextSnapshot,Kb=Lc(Oa.sourceItem),ic=Oa.sourceItem;var pd=!!ic&&Object.getType(ic)===Bb;ic=0;var Td=!1;Kb?(Td=Oa.sourceItem,T.isSameSession=Td.isFromCurrentSession(this.$),ic=1,Td=this.mdi(Td,T)):pd&&
(T.isSameSession=Oa.sourceItem.isFromCurrentSession(this.$),ic=2);if(T.copyContextSnapshot.commandParameters){pd=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;var Gd=T.commandParameters;var ge=this.$;Oa?ge&&ge.ya?Oa=Oa.sessionId===ge.ya.UserSessionId:(Bc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Oa=!1):(Bc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Oa=!1);Gd.clearSystemClipboard=Oa&&pd&&Kb&&!Td;T.commandParameters.copyPasteTargetType=ic}}};
fb.prototype.getSessionId=function(){return this.$.ya.UserSessionId};fb.prototype.mdi=function(T,Oa){var Kb=mi.b(T.ranges,function(ic){return ic.Lh})&&mi.b(Oa.commandParameters.originalDestinations,function(ic){return 1!==ic.top});return mi.b(T.ranges,function(ic){return ic.isRow})&&mi.b(Oa.commandParameters.originalDestinations,function(ic){return 1!==ic.left})||Kb};fb.prototype.cGh=function(T){switch(T){case 1:return this.SDd;case 64:case 4:case 2:case 256:return this.pVc;default:throw Error.invalidOperation("Unsupported selection");
}};fb.prototype.bCh=function(){return Df.g(this.$).ha.Te&470?rc.floatingObject:1===Df.g(this.$).ha.Te?rc.cells:rc.unknown};tl.Object.defineProperties(fb.prototype,{SDd:{configurable:!0,enumerable:!0,get:function(){if(!this.rNc){var T=this.$.da.Aa(254,!0);T&&(this.rNc=new $a(this.$,T,new E))}return this.rNc}},pVc:{configurable:!0,enumerable:!0,get:function(){if(!this.hDc&&this.$.da.Aa(254,!0)){var T=new Nb(this.$);this.hDc=new Ha(this.$,new E,new ka(this.$,T),T)}return this.hDc}}});Object(Jc.a)(fb,
"ExcelCopyPasteApplicationHost",null,[788]);var ph=b(139),Ng=rf.a;vm(Ta,Ng);Ta.prototype.Kh=function(T){this.Jo=new ph.a;var Oa=Mg.a.instance.ea(16);T=this.LU(T);this.initializeAndShow(Oa,this.g6h,T)};Ta.prototype.LU=function(T){var Oa={};return Oa[Ta.Ly]=this.xc,Oa[Ta.Hei]=T,Oa};tl.Object.defineProperties(Ta.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Ta.wah="direction";Ta.Hei="isRtl";var ai={};Ta.xah=(ai.Vertical=1,ai.Horizontal=0,ai);Object(Jc.a)(Ta,
"InsertCopiedCutCellsDialog",rf.a,[]);eb.prototype.D2b=function(T,Oa){return(new Ta(T,Oa)).Jo.task};Object(Jc.a)(eb,"InsertCopiedCutCellsDialogFactory",null,[710]);var Zg=b(88),ni=b(44),yh=b(42);rb.prototype.FGe=function(){var T=this;this.zoc||(Bc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.rE(function(Oa){Oa.pua(0).then(function(){T.zoc=!0})}))};rb.prototype.Ucj=function(T){var Oa=this,Kb=T.commandParameters.id;
Bc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Kb,!this.Cr,this.zoc);this.FGe();this.F3b=Kb;Kb=!this.gof();if(!this.Cr||Kb)this.Mte(),this.Cr=ni.a.instance.create(function(){Oa.lbh(T)},void 0===T.timeoutToShowSpinnerInMs||null===T.timeoutToShowSpinnerInMs?100:T.timeoutToShowSpinnerInMs,yh.a.WPi);this.T1=T.commandParameters.originalDestinations};rb.prototype.lbh=function(T){this.zoc?(this.display(T.commandParameters.originalDestinations),
T.pasteIndicationDisplayStatus=pb.k5c):(Bc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),T.pasteIndicationDisplayStatus=pb.CTi)};rb.prototype.display=function(T){Bc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Nb.uw(sg.a.QW(Me.d(this.gridView.$.oa),T),rb.Nnc,!0);this.gridView.Nb.Yr(rb.Nnc)};rb.prototype.Ahd=function(T){Bc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",
T,this.F3b);T&&He.a.equals(T,this.F3b,!1)&&this.hide()};rb.prototype.hide=function(T){this.T1&&(void 0===T?0:T)&&this.gof()&&Bc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.F3b="";this.Mte();this.T1=null;this.gridView.Nb.kl(rb.Nnc);this.gridView.Nb.Jl(null,rb.Nnc)};rb.prototype.gof=function(){return yf.Q(this.gridView.ha.va.selectedRanges,this.T1)};rb.prototype.Mte=
function(){this.Cr&&(Zg.a.Fa(this.Cr),this.Cr=null)};rb.prototype.dispose=function(){this.hide();this.gridView.ha.mF(this.l5e)};rb.Nnc=[30];Object(Jc.a)(rb,"PasteIndicationManager",null,[709,3]);var fh=b(1131),yi=b(51),ei=fd.a;vm(Tc,ei);Tc.prototype.create=function(){var T=this,Oa=yi.a.TZ([51,52],4,this.tb,void 0,void 0,void 0,Tc.vQa),Kb=ef.GetServiceTaskFactory.create(this.$.da,18,this.$.ma,this.tb);gg.TaskExtensions.Ba(gg.TaskExtensions.ve([Kb,Oa],this.ma),function(){var ic=new fh.a,pd=null;T.tXg(ic).then(function(Td){pd=
Td.Fwe;var Gd=copyPasteInfra.createCopyPasteInfra(pd,new fb(T.$),ic,T.$);Bc.ULS.shipAssertTag(537167762,0,!!T.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Bc.ULS.shipAssertTag(537167761,0,!!T.$.ya&&!!T.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var ge=pd.getMetadataManager();T.Fb(new cc(T.$,ge,Kb.result,Gd,new uc(T.$,Df.g(T.$)),new eb,T.$.ya.DocumentHostInfo.UserId,
pd.getInitializationError()));Td.NZa?Bc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",cc.D9b(),Td.NZa.dataClipboardStrategyType,JSON.stringify(Td.NZa.dataClipboardCapabilities),Td.NZa.clipboardStrategiesToInitialize[0].clipboardStrategyType===Td.NZa.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):Bc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Td){Bc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",cc.D9b(),Td?copyPasteInfra.getStringifiedError(Td):
"null")})},this.ma,3)};Tc.prototype.dispose=function(){ei.prototype.dispose.call(this)};Tc.prototype.tXg=function(T){var Oa=null,Kb=window.clipboardPlatform;Kb&&(Oa=Kb.getClipboardPlatformEnvironment());if(!Oa)return Bc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Kb=this.$.ya;var ic=[Kb.OfficeOnlineChromeExtensionId,Kb.ChromeClipboardAccessExtensionId],
pd=this.Om.Va(5),Td=this.$.ig.get(57),Gd=!Td&&this.$.ig.get(5),ge=this.$.fa.lc;ge&&(ge.inWebPart||ge.inViewerFromWebPart||ge.isDivSyndicated)&&(Gd=!1);Td=this.bFh(Gd,!Td);Bc.ULS.shipAssertTag(537167758,0,!!Kb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Oa.init(this.$,T,ic,Kb.SharedClipboardHostingApp,Kb.SharedClipboardHostingApps,Kb.SharedClipboardHostingEnvironments,Kb.SharedClipboardOverrideOrigin,
Kb.SharedClipboardSchemaVersion,Kb.SharedClipboardExpirationInMinutes,Kb.ClipboardPromiseTimeoutInMinutes,pd,Kb.MachineCluster,new Hc(this.$),Td,Kb.DocumentHostInfo.UserId,Kb.ClipboardTtlInMS,me.EwaSettings.la(314),Kb.UserSessionId).then(function(Pe){return Object.assign(new Ie,{Fwe:Oa,NZa:Pe})},function(Pe){return Promise.reject(Pe)})};Tc.prototype.bFh=function(T,Oa){var Kb=[];T&&Oa&&Array.add(Kb,this.H5g());Oa&&(Array.add(Kb,this.V2c(7)),Array.add(Kb,this.V2c(0)));T&&Array.add(Kb,this.lBe());Array.add(Kb,
{clipboardStrategyType:4});Bc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",T,Oa,Kb?Kb.join(","):"[]");return Kb};Tc.prototype.lBe=function(){var T=this.$.ya,Oa={clipboardStrategyType:5};Oa.sessionId=T.UserSessionId;Oa.useSharedClipboardIframe=!0;Oa.sharedClipboardHostingApp=T.SharedClipboardHostingApp;Oa.sharedClipboardHostingApps=
T.SharedClipboardHostingApps;Oa.sharedClipboardHostingEnvironments=T.SharedClipboardHostingEnvironments;Oa.sharedClipboardOverrideOrigin=T.SharedClipboardOverrideOrigin;Oa.sharedClipboardSchemaVersion=T.SharedClipboardSchemaVersion;Oa.sharedClipboardExpirationInMinutes=T.SharedClipboardExpirationInMinutes;Oa.wacCluster=T.MachineCluster;return Oa};Tc.prototype.H5g=function(){var T={clipboardStrategyType:6};T.localStorageStrategyParameters=this.lBe();T.systemClipboardStrategyParameters=this.V2c(0);
return T};Tc.prototype.V2c=function(T){var Oa={};Oa.clipboardStrategyType=T;Oa.skipFilesIfPlainTextExists=!0;return Oa};Tc.ja=function(T){T.da.Ha(373,new rb(T));T.da.Ha(Tc.vQa,new Tc(T))};Tc.vQa=255;Object(Jc.a)(Tc,"CopyPasteInfrastructureFactory",fd.a,[]);var la=b(10),kb=b(117),Xb=b(12),Dc=mf.a;vm(vd,Dc);vd.prototype.dispose=function(){this.mm();this.nk=this.Et=this.$=null;this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null)};vd.prototype.gn=function(){return this.EZf};
vd.prototype.Jr=function(T,Oa){if("QueryPasteShortcutEnabledLabel"!==T&&!Array.contains(vd.Pxj,T))return!1;var Kb=this.fo();"QueryPasteShortcutEnabledLabel"===T?(Oa.Visible=Kb,Bc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Kb,T)):(Oa.Visible=!Kb,Bc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Kb,T));return!0};vd.prototype.bgh=function(){this.ak();this.raiseEvent("pasteShortcutStatusChanged")};
vd.prototype.P4b=function(){this.mm();this.raiseEvent("pasteShortcutStatusChanged")};vd.prototype.fo=function(){return this.Y6c};vd.prototype.iq=function(T){this.addHandler("pasteShortcutStatusChanged",T)};vd.prototype.zq=function(T){this.removeHandler("pasteShortcutStatusChanged",T)};vd.prototype.ak=function(){if(!this.fo()){this.Y6c=!0;Df.g(this.$).Jj.wm(this.oFe);this.nk.ja("blur",this.Gah);var T=this.$.da.Aa(65);T&&T.N2&&T.N2.registerForCommentEvents(this.nFe);this.Et.Vu(Xb.a.Rb,this.$.domElement,
this.onKeyDown,!0)}};vd.prototype.mm=function(){if(this.fo()){this.Y6c=!1;Df.g(this.$).Jj.im(this.oFe);this.nk.detach("blur");var T=this.$.da.Aa(65);T&&T.N2&&T.N2.unregisterForCommentEvents(this.nFe);this.Et.kv(Xb.a.Rb,this.$.domElement,this.onKeyDown,!0)}};vd.Pxj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(Jc.a)(vd,"PasteShortcutManager",mf.a,[708,143,144,3]);var xb=b(121),jd=fd.a;vm(Pc,jd);Pc.prototype.create=function(){var T=this.$;this.Fb(T.da.Aa(478)||this.$.da.Ha(478,new vd(T,
kb.KeyInputManager.instance,xb.a.instance.VD())))};Pc.ja=function(T){T.da.Ha(479,new Pc(T))};Object(Jc.a)(Pc,"PasteShortcutManagerFactory",fd.a,[]);Zc.prototype.isEnabled=function(){if(ve.AFrameworkApplication.ga?ve.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var T=ve.AFrameworkApplication.Gb?Object(Nc.a)(String,ve.AFrameworkApplication.Gb.AudienceGroup):"";return"Unknown"!==T&&"Automation"!==T};tl.Object.defineProperties(Zc.prototype,{FUc:{configurable:!0,enumerable:!0,get:function(){return"Excel"}},
campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},w$h:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(346)}},h6a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(348)}},Gyb:{configurable:!0,enumerable:!0,get:function(){return this.$.la(347)}},Ewh:{configurable:!0,
enumerable:!0,get:function(){return null}},Jmf:{configurable:!0,enumerable:!0,get:function(){return 24}},tQf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},bHb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(Jc.a)(Zc,"FirstRunExperienceLauncherSettings",null,[706]);Ic.prototype.gPd=function(){this.bRe&&this.bRe.gPd(this.pwh)};Object(Jc.a)(Ic,"FirstRunExperienceManager",null,[707]);var ke=fd.a;vm(Eb,ke);Eb.prototype.create=function(){this.Fb(this.$.da.Aa(311)||
this.G1g())};Eb.prototype.G1g=function(){var T=new Zc(this.$);T=new Ic(Zf.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),T);T.gPd();return T};Eb.ja=function(T){T.da.Ha(312,new Eb(T))};Object(Jc.a)(Eb,"FirstRunExperienceManagerFactory",fd.a,[]);var Ge=b(57),cf=fd.a;vm(Mb,cf);Mb.prototype.create=function(){this.Fb(this.$.da.Aa(361)||this.s2g())};Mb.prototype.s2g=function(){var T=this;this.bjd=Zf.a.instance.Hh("Common.IInProductMessagingUIManager");Ge.a.Qf.isReactSharedHeaderUxEnabled?
tc.a.get_instance().xl(16,function(){T.l8e()}):this.l8e();return this.bjd};Mb.prototype.l8e=function(){var T=this;Zf.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Kb){!Kb&&Oa.isFreemiumUpsellEnabled()&&T.bjd.Khf();return null})})};Mb.ja=function(T){T.da.Ha(362,new Mb(T))};Object(Jc.a)(Mb,"InProductMessagingManagerFactory",fd.a,[]);var kf=b(817),jf=b(98),Ef=b(175);Object(Jc.a)(wb,"UploadBlobParameters",
null,[]);var ya=b(109);Ja.prototype.nDb=function(T){this.Cj=T;if(!this.m0a){if(this.lWd){if(this.C7a&&bf.a.ME){this.PQb=T.m5b(Object(nc.a)(this,this.Vxd,"onFileChosen"));return}this.PQb=T.m5b(null);if(!this.jBa(this.PQb,T))return}this.finalizeUpload(T,null)}};Ja.prototype.Vxd=function(T){if(this.jBa(T,this.Cj)){if(bf.a.ME||bf.a.zf)this.PQb=T;this.finalizeUpload(this.Cj,null)}};Ja.prototype.Vmc=function(){this.Gzd&&this.Gzd()};Ja.prototype.J9i=function(){this.sqa=0;this.iEa=this.ga.zd("Box4UploadRetryDelayStart",
200);this.Cj&&(this.Cj.dispose(),this.Cj=null)};tl.Object.defineProperties(Ja.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.mS}},ga:{configurable:!0,enumerable:!0,get:function(){return this.ub}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.sqa}},dJd:{configurable:!0,enumerable:!0,get:function(){return this.iEa}}});Object(Jc.a)(Ja,"FileUploader",null,[]);var qa=b(413),ub=b(909),Dd=b(128);vm(Lb,Ja);Lb.prototype.kWe=function(T){switch(T){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Lb.prototype.ibg=function(T){return Lb.jBa(T,this.jUh())};Lb.prototype.jUh=function(){return Lb.Ige};Lb.prototype.jBa=function(T,Oa){return(T=this.ibg(T))?(Oa&&Oa.Yie(),2===T&&this.ri(0,this.kWe(T)),!1):!0};Lb.prototype.finalizeUpload=function(T,Oa){Bc.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Gzd=Oa;this.Qsj();qa.a.mark(5576);this.wTb=this.fI.Fc("LoadResource","PictureUploadTime")};Lb.prototype.ri=
function(T,Oa){var Kb=new Dd.StandardDialog;Kb.kc=0;Kb.xz(T,CommonUIStrings.l_ImageUploadFailedTitle,Oa,null)};Lb.prototype.Vmc=function(){Bc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");Ja.prototype.Vmc.call(this);this.wTb&&(this.wTb.stop(),this.wTb=null);this.RUg()};Lb.prototype.Qsj=function(){this.Oqa=(new ub.a).create();this.Oqa.message=CommonUIStrings.l_ImageUploadWait;this.Oqa.kc=5;this.Oqa.Gu=!1;this.Oqa.eAa(null,null,null)};Lb.prototype.RUg=function(){this.Oqa&&(this.Oqa.close(),
this.Oqa=null)};Lb.c_h=function(T,Oa){T=We.a.Kl(T);for(var Kb=0;Kb<Oa.length;++Kb)if(T.endsWith(Oa[Kb]))return!0;return!1};Lb.jBa=function(T,Oa){Oa=void 0===Oa?null:Oa;Oa||(Oa=Lb.Ige);return T?Lb.c_h(T,Oa)?0:2:1};tl.Object.defineProperties(Lb.prototype,{fI:{configurable:!0,enumerable:!0,get:function(){return ve.AFrameworkApplication.sa.fD}}});Lb.Ige=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(Jc.a)(Lb,"PictureUploader",Ja,[]);var be=b(681),Je=b(572),Cf=b(140),Jg=b(40),$g=b(1185),Tg=Cf.a;
vm(Ra,Tg);Ra.prototype.validate=function(){this.Cj.DG||Bc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Cj.DG.value?!0:(Ra.xz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};Ra.prototype.cDi=function(T){this.drg&&(this.Cj=this.hXf(T,this.TVb))};Ra.prototype.mMi=function(){this.Cj&&this.Cj.DG&&(this.I3d||(this.Cj.d1i(Object(nc.a)(this,this.Vxd,"onFileChosen")),this.I3d=!0),this.Cj.OPe())};Ra.prototype.Vxd=function(T){this.$Va.uploadStatusLabel=T;this.Dzc(this.titleText,
Object(nc.a)(this,this.zdc,"insertDialogHandler"),this.$Va)};Ra.prototype.zdc=function(T){1===T&&this.isEnabled()?Ra.gy&&this.Cj.DG&&!this.Cj.DG.value?(this.$Va.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.Dzc(this.titleText,Object(nc.a)(this,this.zdc,"insertDialogHandler"),this.$Va)):(this.Yvb(),this.TVb.finalizeUpload(this.Cj,Object(nc.a)(this,this.dispose,"dispose"))):T||this.hide()};Ra.prototype.iXf=function(){this.oGc=!1;this.Cj=this.hXf(document.getElementById("uploadFrameContainer"),
this.TVb);ve.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Wfa=Object(nc.a)(this,this.Hzd,"onUploadFrameLoad"),Jg.a.addHandler(this.Cj.iFrame,"load",this.Wfa));this.Cj.DG||Bc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.YFf()};Ra.prototype.Hzd=function(){this.YFf()};Ra.prototype.YFf=function(){if(this.Cj&&!this.oGc){var T=this.Cj.DG;T&&(Jg.a.addHandler(T,Xb.a.Rb,Object(nc.a)(this,this.onKeyDown,"onKeyDown")),T=[T],this.Vm=T.concat.apply(T,
this.Vm),this.q$f(),this.oGc=!0)}};Ra.prototype.dispose=function(){if(this.Cj&&!Ra.gy){var T=this.Cj.DG;T&&Jg.a.removeHandler(T,Xb.a.Rb,Object(nc.a)(this,this.onKeyDown,"onKeyDown"));this.Wfa&&Jg.a.removeHandler(this.Cj.iFrame,"load",this.Wfa)}this.Cj=null;Tg.prototype.dispose.call(this)};Ra.prototype.q$f=function(){if(0<this.Vm.length){var T=new $g.a(this.Vm),Oa=qb.FocusManager.instance().hQ();Oa&&(this.Vm[0].focus(),Oa.kf=T,Oa.XZ=!0)}};Ra.prototype.onKeyDown=function(T){4!==qb.FocusManager.instance().$Ff(T)&&
T.preventDefault()};Ra.xz=function(T){var Oa=document.getElementById("errorText");Oa.innerText=T;Oa.style.display="inline-block"};tl.Object.defineProperties(Ra.prototype,{fMj:{configurable:!0,enumerable:!0,get:function(){return this.TVb}}});tl.Object.defineProperties(Ra,{gy:{configurable:!0,enumerable:!0,get:function(){return ve.AFrameworkApplication.sa.Pa.Lu&&ve.AFrameworkApplication.sa.Pa.Tcf}}});Object(Jc.a)(Ra,"InsertFileDialog",Cf.a,[]);tl.Object.defineProperties(Sa,{xf:{configurable:!0,enumerable:!0,
get:function(){return Cf.a.jj(Sa.Tj,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});Sa.Tj="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(Jc.a)(Sa,"InsertImageDialogHtml",null,[]);vm(Da,Ra);Da.prototype.validate=function(){this.Cj.DG||Bc.ULS.sendTraceTag(25798095,
322,10,"UploadFrame.FileInputElement is null");var T=Object(Nc.a)(Lb,this.fMj),Oa=T.ibg(this.Cj.DG.value);return Oa?(Ra.xz(T.kWe(Oa)),!1):!0};tl.Object.defineProperties(Da.prototype,{tWb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},Z$g:{configurable:!0,enumerable:!0,get:function(){return Sa.xf}}});Object(Jc.a)(Da,"InsertImageDialog",Ra,[]);var Dh=
b(576),Mh=b(89),Oh=b(193),Li=b(77),Th=b(416);sb.prototype.i8e=function(){this.nD=bg.a.create().toString();this.aqa?this.M6c():this.Wne()};sb.prototype.D_g=function(T){this.Kn=document.createElement("iframe");this.Kn.className=T;this.Kn.id=T;this.m4d&&(this.Kn.style.visibility="visible",this.Kn.style.height="30px",this.Kn.setAttribute("frameborder","0"));this.Wfa=Object(nc.a)(this,this.Hzd,"onUploadFrameLoad");Jg.a.addHandler(this.Kn,"load",this.Wfa)};sb.prototype.m5b=function(T){var Oa=this;ve.AFrameworkApplication.sa.zEb();
if(!this.Iq)return Bc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Jg.a.addHandler(this.Iq,"change",function(){Oa.Wth(T)});Tb(Object(nc.a)(this,this.OPe,"fileInputClick"),1,"DoFileOpenDialog");return this.Iq.value};sb.prototype.Wth=function(T){T&&T(this.Iq.value)};sb.prototype.Xth=function(){this.NQb&&(this.NQb.innerText=this.xXe())};sb.prototype.d1i=function(T){var Oa=this;Jg.a.addHandler(this.Iq,"change",function(){T(Oa.xXe())})};sb.prototype.xXe=function(){var T=null;if(this.Iq.value){var Oa=
this.Iq.value,Kb=Oa.lastIndexOf("\\");0<Kb&&(T=Oa.substring(Kb+1,Oa.length))}return T?T:""};sb.prototype.OPe=function(){try{Bc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Iq.click()}catch(T){throw Bc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",T.message),T;}};sb.prototype.Dyj=function(){this.bfi()?this.f3f():(this.aWd(),this.gs.submit())};sb.prototype.bfi=function(){return(this.kmg||this.aqa)&&!(void 0===window.self.FormData||
null===window.self.FormData)};sb.prototype.JTf=function(T){if(T){var Oa=this.eAe();this.Jg=new XMLHttpRequest;this.Jg.open("POST",Oa);this.Jg.setRequestHeader("X-CorrelationId",this.nD);this.Qmi(T);this.Jg.onreadystatechange=Object(nc.a)(this,this.aoa,"uploadResponseReceived");this.Jg.send(T)}};sb.prototype.Qmi=function(T){if(!bf.a.xA&&T.get){var Oa=T.get("ImageId");T=window.self.navigator;var Kb={};Oa=(Kb.CorrelationId=this.nD,Kb.Canary=ve.AFrameworkApplication.canary,Kb.ImageNodeId=Oa,Kb);T&&(T=
T.connection?T.connection:T.mozConnection?T.mozConnection:T.webkitConnection?T.webkitConnection:null)&&(Oa.effectiveType=T.effectiveType,Oa.downlink=T.downlink,Oa.type=T.type,Oa.rtt=T.rtt);Bc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Oa)}};sb.prototype.f3f=function(){try{this.aWd();Bc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var T=new (Type.parse("FormData"))(this.gs);this.JTf(T)}catch(Oa){Bc.ULS.sendTraceTag(594888407,
322,10,"SubmitFormWithRequest failed to send the request with exception "+Oa.message),this.U8a(null)}};sb.prototype.e3f=function(T){try{if(this.aWd(),Bc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.oNj(T)){this.OQb=T;this.gs.contains(this.Iq)&&this.gs.removeChild(this.Iq);var Oa=new (Type.parse("FormData"))(this.gs);Oa.append("applicationfileInput",T.blob,T.filename);this.JTf(Oa)}else this.U8a(null)}catch(Kb){Bc.ULS.sendTraceTag(591267743,322,
10,"SubmitFormWithBlob failed to send the request with exception "+Kb.message),this.U8a(null)}};sb.prototype.oNj=function(T){return T&&void 0!==T.blob&&null!==T.blob&&void 0!==T.filename&&null!==T.filename&&""!==T.filename?void 0===window.self.FormData||null===window.self.FormData?(Bc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(T=T?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===T.blob||null===T.blob,void 0===T.filename||null===
T.filename||""===T.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",Bc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",T)),!1)};sb.prototype.aoa=function(){if(4===this.Jg.readyState)if(200===this.Jg.status){Bc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.nD);var T=this.Jg.getResponseHeader("X-NewKey"),Oa=this.w9h(this.Jg),Kb=!1;if(void 0!==T&&null!==T&&Oa&&(Kb=
this.eNj(T),!this.KQc&&Kb)){Bc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.nD);this.KQc=!0;void 0!==this.OQb&&null!==this.OQb?this.e3f(this.OQb):this.f3f();return}Bc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.KQc,Oa,!(void 0===T||null===T),Kb,this.nD);this.U8a(this.Jg.responseText)}else Bc.ULS.sendTraceTag(42874946,
322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Jg.status,this.Jg.responseText?!1:!0,this.nD),this.U8a(null)};sb.prototype.w9h=function(T){try{var Oa=yd.a(T.responseText).Responses;if(void 0!==Oa&&null!==Oa&&1===Oa.length){var Kb=Oa[0];if(void 0!==Kb&&null!==Kb&&2===Kb.length&&28===Kb[1].StatusCode)return!0}}catch(ic){}return!1};sb.prototype.eNj=function(T){Th.a.q9f(T);return ve.AFrameworkApplication.canary!==T?!1:!0};sb.prototype.aWd=function(){this.LQc||
(this.LQc=new Date)};sb.prototype.dispose=function(){this.sm||(this.aqa?this._parent.removeChild(this.gs):(this._parent.removeChild(this.Kn),Jg.a.removeHandler(this.Kn,"load",this.Wfa),this.Wfa=null),this.nGc&&(Jg.a.removeHandler(this.Iq,"change",this.nGc),this.nGc=null),this.PPe&&(this.fhb&&(Jg.a.removeHandler(this.Iq,"change",this.fhb),this.fhb=null),this.NQb=null),this.Iq=this.gs=this._parent=this.Kn=null,this.sm=!0,this.LQc=null,Bc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};sb.prototype.delayedDispose=
function(){this.dispose()};sb.prototype.h2g=function(T){if(this.gs){var Oa;(Oa=this.gs.querySelector("input[name=__REQUESTDIGEST]"))?Oa.value=T:(Oa=this.o2c(),Oa.type="hidden",Oa.id="__REQUESTDIGEST",Oa.name="__REQUESTDIGEST",Oa.value=T,this.gs.appendChild(Oa))}};sb.prototype.o2c=function(){return this.aqa?document.createElement("input"):this.Kn.contentWindow.document.createElement("input")};sb.prototype.Hzd=function(){try{if(!this.Kn.contentWindow.document.body)return}catch(ic){this.$Yh();return}if(!(this._initialized||
this.C7a&&bf.a.ME))this.M6c();else if(!this.C7a||!bf.a.ME||this.jci){var T=bf.a.Af?this.Kn.contentWindow.document.body.innerText:this.Eag?this.Kn.contentWindow.document.body.firstChild.innerText:this.Kn.contentWindow.document.body.firstChild.innerHTML;var Oa=this.Kn.contentWindow.document.body.innerText.toLowerCase(),Kb=0<=Oa.indexOf("responses")||0<=Oa.indexOf("wopisrc");Oa=0<=Oa.indexOf("http error");!Kb&&Oa&&Bc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+
this.Kn.contentWindow.document.body.innerText);this.U8a(T)}};sb.prototype.M6c=function(){if(!this._initialized){var T=this.ea("uploadForm"),Oa=this.ea("fileInput"),Kb=this.eAe();this.M1g();this.gs.id=T;this.gs.method="post";this.gs.encoding="multipart/form-data";this.gs.action=Kb;this.Iq.type="file";this.hZd&&(this.Iq.accept=this.hZd,this.h0d&&(this.Iq.capture=this.h0d));this.Iq.id=Oa;this.Iq.name=Oa;this.vEg&&(this.Iq.multiple=!0);!this.PPe||bf.a.Af||bf.a.iH||(this.fhb=Object(nc.a)(this,this.Xth,
"fileInputChangedHandleAccessibility"),Jg.a.addHandler(this.Iq,"change",this.fhb),this.NQb=Mh.a.Sne(this.gs,this.Iq,"InputFileDescription"));this.m4d&&(this.aqa||(T=this.Kn.contentWindow.document.body,T.style.margin="0",T.style.overflow="hidden"),T=ve.AFrameworkApplication.sa,this.Iq.style.fontFamily=T.A0,this.Iq.style.fontSize=T.Syc,this.Iq.style.margin="0");(T=document.getElementById("__REQUESTDIGEST"))&&this.h2g(T.value);this.gs.appendChild(this.Iq);this._initialized=!0;this.Tlg(this)}};sb.prototype.M1g=
function(){if(this.aqa)this.gs=document.createElement("form"),this._parent.appendChild(this.gs),this.Iq=document.createElement("input");else{this.gs=this.Kn.contentWindow.document.createElement("form");var T=this.Kn.contentWindow.document;T.body.appendChild(this.gs);this.Iq=T.createElement("input")}};sb.prototype.Wne=function(){this._parent.appendChild(this.Kn);this.C7a&&bf.a.ME&&this.M6c()};sb.prototype.eAe=function(){var T=new pe.QueryStringBuilder(this.UPe);ve.AFrameworkApplication.Qlb(T);this.Wgj(T);
T=T.toString();if(bf.a.zf||bf.a.ME||bf.a.iH)T=Li.a.Tad(T);return T};sb.prototype.Yie=function(){var T=new ya.a(2,1,0,Object(nc.a)(this,this.delayedDispose,"delayedDispose"),4);ve.AFrameworkApplication.oj.gh(T)};tl.Object.defineProperties(sb.prototype,{MPf:{configurable:!0,enumerable:!0,get:function(){return this.pqg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.JOc}},iFrame:{configurable:!0,enumerable:!0,get:function(){return this.Kn}},DG:{configurable:!0,enumerable:!0,get:function(){return this.Iq}},
C7a:{configurable:!0,enumerable:!0,get:function(){return ve.AFrameworkApplication.ga?ve.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):!1}},PPe:{configurable:!0,enumerable:!0,get:function(){return ve.AFrameworkApplication.ga?ve.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},jci:{configurable:!0,enumerable:!0,get:function(){return this.aqa?!1:Oh.a(this.Kn.contentWindow.location.pathname,this.UPe,0)}},vEg:{configurable:!0,enumerable:!0,get:function(){return!bf.a.xA&&
ve.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(Jc.a)(sb,"UploadFrame",null,[3]);vm(sa,sb);sa.prototype.ea=function(T){return T};sa.prototype.Wgj=function(T){Bc.ULS.shipAssertTag(528345168,0,!!this.sessionId,"SessionId shouldn't be null.");vf.a.KUc(T,this.$.ya);T.e9(df.a.sessionId,this.sessionId);var Oa=Df.g(this.$).ha;Oa=yf.o(Oa.va.T3,this.$);T.e9(df.a.PVi,this.$.xa.oa.name);T.e9(df.a.OVi,Oa.FirstRow.toString());T.e9(df.a.NVi,Oa.FirstColumn.toString())};sa.prototype.$Yh=
function(){this.MPf("ServerUploadError")};sa.prototype.U8a=function(T){this.MPf(T)};sa.pai=function(T){return!T||He.a.equals(T,"ServerUploadError",!1)};Object(Jc.a)(sa,"UploadFrameWrapper",sb,[]);vm(va,Da);va.prototype.hXf=function(T,Oa){return new sa(T,Object(nc.a)(Oa,Oa.nDb,"onUploadFrameInitialized"),Object(nc.a)(Oa,Oa.aoa,"uploadResponseReceived"),this.ga,!0,this.$)};va.prototype.dispose=function(){this.hzc();this.Iu=this.kAc=null;Da.prototype.dispose.call(this)};va.prototype.hide=function(){Da.prototype.hide.call(this);
this.$.Ab.XJ=!1};va.prototype.validate=function(){var T=this.kAc.LWd(this.Cj.DG.value,this.kAc.n7f(this.Cj));return T?(T=this.kAc.ncd(T).Description,this.qVd(T),this.tRd(),!1):!0};va.prototype.isEnabled=function(){return!0};va.prototype.qVd=function(T){this.sU.innerHTML=T};va.prototype.aV=function(){this.sU=document.getElementById("errorText");this.sU.style.display="inline-block";this.qAa=!1;this.qVd("");this.GHa.style.maxWidth=this.GHa.currentStyle.minWidth};va.prototype.tRd=function(){this.Iu.pa(Xb.a.click,
this.Cj.DG,this.YQ);this.Iu.pa(Xb.a.Rb,this.Cj.DG,this.YQ);this.qAa=!0};va.prototype.hzc=function(){this.qAa&&(this.Iu.za(Xb.a.click,this.Cj.DG,this.YQ),this.Iu.za(Xb.a.Rb,this.Cj.DG,this.YQ),this.qAa=!1)};Object(Jc.a)(va,"InsertImageDialogWrapper",Da,[]);wa.prototype.getSheetName=function(){return this.sheetName};Object(Jc.a)(wa,"MacroRecorderPictureInsertedPayload",null,[98]);vm(Fb,Lb);Fb.prototype.dispose=function(){Zg.a.Fa(this.wZb);this.Cj&&this.Cj.Yie();this.Cj=this.wZb=this.vb=null};Fb.prototype.finalizeUpload=
function(T,Oa){var Kb=this;Lb.prototype.finalizeUpload.call(this,T,Oa);Ze.a(this.$.userOperationManager,function(ic,pd){Kb.lr=ic;Kb.L$=pd;Kb.AXd.start();Kb.wZb.Bq();Kb.jyc=!1;Kb.K6f(T);return Kb.gZi(T)},function(ic){function pd(){return new wa(Gd,Kb.gBd?Kb.gBd:"")}var Td={};Kb.$.wj(Td);var Gd=Td.SheetName;ic=me.EwaSettings.tc()?new Fd.a(510,0,ic,72,pd):new af.a(510,0,ic,8,pd);ic.Qza(function(){return!0});ic.ee=Kb.ee;return ic},this.ee)};Fb.prototype.gZi=function(T){function Oa(){ic.zw(!0)}var Kb=
this;if(!this.$)return Bc.ULS.sendTraceTag(537155794,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Sf.Task.Ta(!0);if(!this.$.Taa)return Sf.Task.Ta(!0);var ic=new ph.a,pd=new FileReader;T=T.DG.files[0];pd.onload=function(){Kb.gBd=pd.result;ic.zw(!0)};pd.onerror=Oa;pd.onabort=Oa;pd.readAsDataURL(T);return ic.task};Fb.prototype.n7f=function(T){var Oa=-1;T=T.DG;(null===T||void 0===T?0:T.files)&&0<T.files.length&&(Oa=T.files[0].size);return Oa};Fb.prototype.LWd=function(T,Oa){var Kb=Fb.BZg(Lb.jBa(T));
Kb?6===Kb&&this.Koi(T):-1!==Oa&&(Bc.ULS.sendTraceTag(537155793,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Oa,this.Ftd,this.$.fa.xgf),Oa>this.Ftd?Kb=3:Oa>this.$.fa.xgf&&(Kb=7));Bc.ULS.sendTraceTag(537155792,0,50,"Validated file on client, validation result: {0}",Kb);return Kb};Fb.prototype.jBa=function(T,Oa){return(T=this.LWd(T,this.n7f(Oa)))?(this.m0a||1===T||this.F_f(T),!1):!0};Fb.prototype.K6f=function(T){T.Dyj()};Fb.prototype.ncd=function(T){var Oa=
0,Kb=1,ic=-1100324317,pd="InsertPictureUnknownError",Td=null;switch(T){case 1:Oa=1701;Kb=0;ic=940870981;pd="InsertPictureNoFileSelected";break;case 3:Kb=0;ic=1250467391;pd="InsertPicturePictureTooBig";Td=String.format(Mg.a.instance.Cb(171),this.Yqi.toLocaleString());break;case 6:Oa=1705;Kb=0;ic=1380041209;pd="InsertPictureUnsupportedFormat";break;case 7:Oa=1702;Kb=0;ic=-903115058;pd="InsertPictureExceedWorkbookSize";break;case 4:Oa=1703;Kb=0;ic=1218352119;pd="InsertPictureUploadTimeout";break;case 5:Oa=
1704,Kb=0,ic=1979899005,pd="InsertPictureServiceNonDeterministicError"}T=Fb.jd(Oa,Kb,ic,pd);Td&&(T.Description=Td);return T};Fb.prototype.showDialog=function(){Fb.xte()?(this.m0a=!1,this.Cj=new sa(this.$.domElement,this.nDb,this.aoa,this.ga,!1,this.$,!0)):(Bc.ULS.sendTraceTag(537155790,0,50,"Showing Insert Picture dialog"),!this.Gyb&&(bf.a.Ku||bf.a.ME&&72>bf.a.Kve)?(this.m0a=!1,this.Cj=new sa(this.$.domElement,this.nDb,this.aoa,this.ga,!1,this.$)):(this.m0a=!0,this.Cj=(new va(this,this.$,this.ga)).Cj))};
Fb.prototype.MYh=function(T){var Oa={};try{if(Oa=wg.a.li(T),$f.b().CB(this.AXd.id,Oa.ServerCorrelationId,"actions","ServerActions"),!Ec.a.ih(Oa.Errors)&&Oa.Result){this.$.fa.YW(Oa.StateId,"PictureUploaderWrapper.UploadResponseReceived");var Kb=Oa.Result;ch.a(this.$).zma(1,Kb);var ic=this.$.da.Aa(277);ic&&ic.vSc(this.$,1,Oa.Result,Oa,"InsertPicture");Bc.ULS.sendTraceTag(537155789,0,50,"Insert picture completed successfully :)")}}catch(pd){Bc.ULS.sendTraceTag(537155788,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",
T?T.length:-1,pd)}this.Hyc(Oa,null,"InsertPictureWebMethod")};Fb.prototype.G2e=function(T){T={Errors:[this.ncd(T)]};this.Hyc(T,null,"InsertPictureWebMethod")};Fb.prototype.Hyc=function(T,Oa,Kb){this.lr(T,Oa,Kb)};Fb.prototype.XTd=function(T,Oa,Kb){this.L$(T,Oa,Kb)};Fb.prototype.F_f=function(T){T=this.ncd(T);me.EwaSettings.az()?new Ob.a(this.$,T):(new Ba.ErrorDialog(this.$,T)).nf()};Fb.prototype.Koi=function(T){var Oa=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;T=We.a.Kl(T);for(var Kb=0;Kb<
Oa.length;++Kb)if(T.endsWith(Oa[Kb])){Bc.ULS.sendTraceTag(537155787,0,50,"Insert picture blocked invalid extension: {0}",Oa[Kb]);break}};Fb.sNj=function(T){return!T||He.a.equals(T,df.a.insertPictureUnknownError,!0)?2:He.a.equals(T,df.a.insertPictureNoFileSelectedError,!0)?1:He.a.equals(T,df.a.r6h,!0)?3:He.a.equals(T,df.a.s6h,!0)?5:0};Fb.jd=function(T,Oa,Kb,ic){return Ec.a.jd(1,0,0,T,Oa,Kb,ic)};Fb.BZg=function(T){switch(T){case 1:return 1;case 2:return 6}return 0};Fb.xte=function(){return me.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&
void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};tl.Object.defineProperties(Fb.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Yqi:{configurable:!0,enumerable:!0,get:function(){return this.Ftd/1024/1024}}});Object(Jc.a)(Fb,"PictureUploaderWrapper",Lb,[3]);vm(Sb,Fb);Sb.prototype.XTd=function(T,Oa,Kb){Fb.prototype.XTd.call(this,T,Oa,Kb);this.s0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};Sb.prototype.Hyc=
function(T,Oa,Kb){Fb.prototype.Hyc.call(this,T,Oa,Kb);Ec.a.ih(T.Errors)?this.s0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",Ec.a.Uc(T.Errors)))):this.s0.setResult(!0)};Sb.prototype.K6f=function(T){var Oa=new wb(this.Wcc.name,this.Wcc);T.e3f(Oa)};Sb.dAh=function(T){var Oa=T.split(",");T=Oa[0].includes("base64")?window.self.atob(Oa[1]):window.self.decodeURI(Oa[1]);Oa=Oa[0].split(":")[1].split(";")[0];for(var Kb=
new Uint8Array(T.length),ic=0;ic<T.length;ic++)Kb[ic]=T.charCodeAt(ic);T=new Blob([Kb],{type:Oa});T.name="Image.png";return T};Object(Jc.a)(Sb,"DataUrlUploaderWrapper",Fb,[]);var Rg=b(579),$h=b(302),gi=b(170),Ae=b(172),Xh=b(82),qi=b(1254),h=qi.a;vm(Gb,h);Gb.prototype.Rpc=function(T,Oa){this.isEnabled()&&this.TEa(this.targetOrigin)&&(this.Pn(T),this.Km(T,Oa))};Object(Jc.a)(Gb,"InsertMediaCrossDocumentMessenger",qi.a,[775,228,3]);Object(Jc.a)(hb,"OnlineMediaSearchResult",null,[]);var Ab=b(305),jc=Cf.a;
vm(za,jc);za.prototype.Dsj=function(T){var Oa=this;this.efc=!1;this.showDialog(this.Wn,null);this.Gva=document.getElementById(this.mi("InsertMediaFrame"));if(!this.Gva)throw this.Lta(this.Unb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Kb=document.getElementById(this.mi("WACDialogPanel"));Kb&&Kb.setAttribute(Mh.a.Sd,Mh.a.kYa);Kb=document.createElement("div");Kb.id="KeepFocusStartDiv";Kb.tabIndex=0;Kb.className="keep-focus-start";this.Gva.parentNode.insertBefore(Kb,this.Gva.parentNode.firstChild);
Kb=document.createElement("div");Kb.id="KeepFocusDiv";Kb.tabIndex=0;Kb.className="keep-focus";this.Gva.parentNode.appendChild(Kb);$addHandler(this.GHa,"keydown",this.Ypd);this.Gva.src=this.u8e;this.Gva.frameBorder="0";Kb=document.getElementById(this.mi("WACDialogButtonPanel"));if(!Kb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Kb.className="display-none";Kb=document.getElementById(this.mi("WACDialogTitleText"));if(!Kb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");
Kb.className="display-none";2===this.jmf&&(document.getElementById(this.mi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.mi("WACDialogBodyPanel")).className="padding-zero");qb.FocusManager.instance().hQ().scope.IQ=!0;this.jR=new Gb(this.Gva.contentWindow,this.u8e);this.jR.Rpc(gi.a.Twg,function(ic){Oa.xyi(ic,Object(nc.a)(T,T.aoa,"uploadResponseReceived"))});this.jR.Rpc(gi.a.insert,function(){Oa.EFi(Object(nc.a)(T,T.aoa,"uploadResponseReceived"))});this.jR.Rpc(gi.a.dYc,
this.Czi);2!==this.jmf||this.$$g||(this.jR.Rpc(gi.a.Fji,this.pGi),this.GMa=this.Omb.Vya("MsoPremiumStockImages",function(ic){Bc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(ic.isEnabled){var pd={};Oa.jR.Qj(gi.a.$Lj,(pd.LicenseTier=ic.toString(),pd))}else Bc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};za.prototype.dispose=function(){this.Cza=null;this.Omb&&this.GMa&&this.Omb.YFd("MsoPremiumStockImages",
this.GMa);this.jR&&(this.jR.dispose(),this.jR=null);jc.prototype.dispose.call(this)};za.prototype.hide=function(){jc.prototype.hide.call(this);Xh.a.juc(this.$)};za.prototype.xyi=function(T,Oa){T=T&&T.Values?(T=T.Values)?Object.assign(new hb,{Action:T.action||"",Caption:T.caption||"",ContentType:T.contentType||"",FileExtension:T.extension||"",PageUrl:T.pageUrl||"",SourceUrl:T.sourceUrl||"",ThumbnailUrl:T.thumbnailUrl||"",LicenseUrl:T.licenseUrl||"",LicenseDisplayName:T.licenseDisplayName||"",Height:T.height||
0,Width:T.width||0}):null:null;T&&(Array.add(this.Cza,T),this.efc&&(Bc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Oa(this.Cza),this.efc=!1,this.Lta(this.Unb)))};za.prototype.EFi=function(T){this.Cza&&0<this.Cza.length?this.Cza.length<=this.Wme?(T(this.Cza),this.Lta(this.Unb)):(this.xz(),Bc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.Cza)):this.efc=!0};za.prototype.v2g=function(){var T=
document.createElement("div");T.id="InsertMediaDialog";T.className=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Oa=document.createElement("div");Oa.id="InsertMediaPanel";Oa.className=me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var Kb=document.createElement("iframe");Kb.id=
"InsertMediaFrame";Kb.className="insert-media-frame";T.appendChild(Oa);Oa.appendChild(Kb);return Ab.b(T)};za.prototype.xz=function(){var T=Ec.a.jd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");T.Description=String.format(Mg.a.instance.Cb(196),this.Wme.toLocaleString());me.EwaSettings.az()?new Ob.a(this.$,T):(new Ba.ErrorDialog(this.$,T)).nf()};tl.Object.defineProperties(za.prototype,{U3:{configurable:!0,enumerable:!0,get:function(){return Ae.a.G4b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(Jc.a)(za,"InsertMediaDialog",Cf.a,[]);var Oc=b(458),sd=b(375);vm(da,Lb);da.prototype.aoa=function(T){var Oa=this;if(T){for(var Kb=Array(T.length),ic=0;ic<T.length;ic++){var pd=T[ic];Kb[ic]={};Kb[ic].SourceUrl=pd.SourceUrl;We.a.awa(pd.LicenseUrl)&&We.a.awa(pd.PageUrl)&&(Kb[ic].LicenseUrl=pd.LicenseUrl,Kb[ic].LicenseDisplayName=pd.LicenseDisplayName,Kb[ic].PageUrl=pd.PageUrl);Kb[ic].AltText=-2053056795===this.ee.command?pd.Caption:""}var Td=-2009825598===
this.ee.command?"bing":"M365";ic=Df.g(this.$);var Gd=yf.o(ic.ha.va.activeCell,this.$);Ze.a(this.$.userOperationManager,function(ge,Pe,gf){return Id.L(Oa.$.qa.ta,Gd,Kb,Td,pg.b(ge,Oa.gIi),pg.a(Pe,Oa.fIi),gf,null)},function(ge){return new Fd.a(595,0,ge)},this.ee);Md.HelperMethods.DZ?(ic=new Map,ic.set("MediaProvider",Td),ic.set("ImagesCount",T.length.toString()),ic.set("TimeTakenToOpenDialog",this.Pjf.toString()),Wc.Health.instance.recordKpiUsage(sd.a.o6h,1,Oc.a.Pxc,ic)):Bc.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Vmc()}else Bc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};da.prototype.dispose=function(){this.$=null};da.prototype.showDialog=function(){var T=this,Oa=null;Oa=this.$.Ub.Fc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.ee.command){case -2009825598:this.Orj();break;case -2053056795:this.Bne.execute(function(Kb){Kb.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(ic){return Bc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",ic)}).then(function(ic){T.Prj(ic);return null})})}Oa.stop();this.Pjf=Oa.Ac};da.prototype.Orj=function(){var T=this.$.ya.BingPictureEndpoint,Oa=Rg.a.DJ(ve.AFrameworkApplication.lcid),Kb=bg.a.create();T?(T=0<T.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(T,1,1):String.format(T,1,ve.AFrameworkApplication.lcid,
Oa?Oa.name:"en-us",ve.AFrameworkApplication.buildVersion,Kb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.D2b(T,1,-1,Mg.a.instance.ea(1707))):(Bc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.s0.setException(Error.create("Failed to access the Bing service endpoint")))};da.prototype.Prj=function(T){var Oa=this.$.ya.M365PictureEndpoint,Kb=bg.a.create();if(Oa){var ic=this.$.ya.DocumentHostInfo.UserId;
ic=ic?We.a.lu(ic).toString():"0";var pd=this.Bne.instance.isFreemiumUpsellEnabled();T=T?1:pd?0:-1;Kb=Kb.toString();pd=Rg.a.DJ(ve.AFrameworkApplication.lcid).name;Oa=String.format(Oa,ve.AFrameworkApplication.lcid,pd,ve.AFrameworkApplication.buildVersion,Kb,1,ic,T,1);this.D2b(Oa,2,T,Mg.a.instance.ea(1706))}else Bc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.s0.setException(Error.create("Failed to access the M365 service endpoint"))};
da.prototype.D2b=function(T,Oa,Kb,ic){try{(new za(this.$,T,Zf.a.instance.Hh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Oa,Kb,ic)).Dsj(this),this.s0.setResult(!0)}catch(pd){Bc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",pd,Oa,Kb),this.s0.setException(pd)}};Object(Jc.a)(da,"OnlinePictureUploaderWrapper",Lb,[3]);Zb.prototype.executeCommand=function(T,Oa,Kb){T=Oa.command;
switch(T){case 1403967063:if(Kb&&"dataUrl"in Kb)return Oa=new ph.a,new Sb(this.$,null,jf.a.instance,ve.AFrameworkApplication.ga,Kb,Kb.dataUrl,Oa),Oa.task;new Fb(this.$,Oa,jf.a.instance,ve.AFrameworkApplication.ga,Kb);return Sf.Task.Ta(!0);case -2053056795:case -2009825598:return T=new ph.a,new da(this.$,Oa,jf.a.instance,ve.AFrameworkApplication.ga,Kb,T),T.task;default:return Ef.a(T)}};Zb.prototype.Gc=function(T,Oa){if(T=this.$.isEditMode)switch(Oa.command){case 1403967063:T=!0;break;case -2053056795:T=
me.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;case -2009825598:T=(T=me.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures"))&&me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertBingPictures",!1);break;default:T=!1}return T};Zb.prototype.fd=function(){return!1};Zb.prototype.Xc=function(){return!1};Object(Jc.a)(Zb,"PictureCommandHandler",null,[147]);var we=kf.a;vm(Wb,we);Wb.prototype.Md=function(){this.Ed([new Zb(this.$)])};Wb.ja=
function(T){kf.a.de(90,new Wb(T))};Object(Jc.a)(Wb,"PictureCommandHandlerFactory",kf.a,[]);var Ue=b(514),qe=b(408),ja=b(74),Ka=b(555),qc=b(596),mc=Ka.a;vm(Ya,mc);Ya.prototype.bNd=function(T){this.zpa!==T&&(this.zpa=T,this.$Eb())};Ya.prototype.dispose=function(){this.gridView.Kc.im(this.urf);this.gridView.Kc.Rp(this.trf);this.gridView=null;mc.prototype.dispose.call(this)};Ya.prototype.$Eb=function(){this.NDd(this.zpa)};Ya.prototype.refresh=function(){this.bNd(!this.gridView.isEditing)};tl.Object.defineProperties(Ya.prototype,
{oH:{configurable:!0,enumerable:!0,get:function(){return this.zpa}},name:{configurable:!0,enumerable:!0,get:function(){return qc.a.cellEdit}}});Object(Jc.a)(Ya,"CellEditSafeStatePublisher",Ka.a,[]);Object(Jc.a)(zb,"SafeStatePublisherState",null,[]);var Ed=b(656),pc=mf.a;vm(lb,pc);lb.prototype.XXb=function(T){this.addHandler(lb.dQa,T)};lb.prototype.Vqc=function(T){this.removeHandler(lb.dQa,T)};lb.prototype.Xya=function(T,Oa){function Kb(Td,Gd){pd.oH=Gd.oH;ic.QDd()}var ic=this,pd=new zb(T,Oa);this.eQa.add(pd);
T.XXb(Kb);pd.handler=Kb;this.QDd()};lb.prototype.UUd=function(T){for(var Oa=null,Kb=yl(this.eQa),ic=Kb.next();!ic.done;ic=Kb.next())if(ic=ic.value,ic.publisher===T){this.V8f(ic);Oa=ic;break}Oa&&(this.eQa.remove(Oa),this.QDd())};lb.prototype.dispose=function(){for(var T=yl(this.eQa),Oa=T.next();!Oa.done;Oa=T.next())this.V8f(Oa.value);this.eQa.clear();pc.prototype.dispose.call(this)};lb.prototype.h_e=function(){for(var T=!0,Oa=yl(this.eQa),Kb=Oa.next();!Kb.done&&(Kb=Kb.value,T=T&&Kb.oH,T);Kb=Oa.next());
return T};lb.prototype.V8f=function(T){T.publisher.Vqc(T.handler)};lb.prototype.QDd=function(){var T=this.h_e();T!==this.Bgf&&(this.raiseEvent(lb.dQa,new Ed.a(T)),this.Bgf=T)};tl.Object.defineProperties(lb.prototype,{FHj:{configurable:!0,enumerable:!0,get:function(){return mi.f(mi.c(this.eQa.toArray(),function(T){return!T.oH}),function(T){return T.publisher.name})}}});lb.dQa="SSC";Object(Jc.a)(lb,"ClientStateMonitor",mf.a,[]);var K=b(6),ha=b(64),H=Ka.a;vm(Ma,H);Ma.prototype.bNd=function(T){T!==this.zpa&&
(this.zpa=T,this.$Eb())};Ma.prototype.dispose=function(){ha.a(this.$).Fqc(this.ysf);this.h4a.zq(this.fN);this.l5d=null;H.prototype.dispose.call(this)};Ma.prototype.$Eb=function(){this.NDd(this.oH)};Ma.prototype.refresh=function(){this.bNd(1===this.h4a.ut||ha.a(this.$).ui===this.h4a)};tl.Object.defineProperties(Ma.prototype,{oH:{configurable:!0,enumerable:!0,get:function(){return this.zpa}},name:{configurable:!0,enumerable:!0,get:function(){return qc.a.h4a}},h4a:{configurable:!0,enumerable:!0,get:function(){return this.l5d}}});
Object(Jc.a)(Ma,"IdleActivitySafeStatePublisher",Ka.a,[]);var aa=b(307),ea=b(3),ab=ja.a;vm(Ia,ab);Ia.prototype.Xc=function(){return!1};Ia.prototype.executeCommand=function(){return Sf.Task.Ta(!0)};Ia.prototype.Gc=function(T,Oa){return 1905775613===Oa.command};Ia.prototype.fd=function(){return!1};Object(Jc.a)(Ia,"ToggleMergeSuspensionSafeState",ja.a,[147]);var Vb=mf.a;vm(pa,Vb);pa.prototype.iq=function(T){this.addHandler(pa.lud,T)};pa.prototype.zq=function(T){this.removeHandler(pa.lud,T)};pa.prototype.gz=
function(){this.raiseEvent(pa.lud)};pa.prototype.gn=function(T){return T===pa.WVi&&!!this.mergeSuspensionManager};pa.prototype.Jr=function(T,Oa){if(!this.gn(T))return!1;this.mergeSuspensionManager&&(Oa.LabelText=this.ikc,Oa.On=this.Hvd);return!0};pa.prototype.dispose=function(){this.xLb&&(this.Ka.M$a(this.xLb),this.xLb.dispose(),this.xLb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.s9a.kGb(this.yCb),this.mergeSuspensionManager.jha.Vqc(this.ZNa),this.mergeSuspensionManager=null);
this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null);this.ikc=null;Vb.prototype.dispose.call(this)};pa.lud="MSMSC";pa.WVi="QueryMergeSuspensionStatus";Object(Jc.a)(pa,"MergeSuspensionIndicatorManager",mf.a,[143,144,3]);var gc=b(1025),$c=Sys.EventArgs;vm(ma,$c);Object(Jc.a)(ma,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);var Zd=b(1026),oe=mf.a;vm(Y,oe);Y.prototype.n3h=function(){return Object(qe.a)(lb,this.jha)?Object(Nc.a)(lb,this.jha).h_e():!1};Y.prototype.$Xb=
function(T){this.addHandler(Y.oTd,T)};Y.prototype.Wqc=function(T){this.removeHandler(Y.oTd,T)};Y.prototype.XBg=function(T){this.addHandler(Y.wpc,T)};Y.prototype.Q5i=function(T){this.removeHandler(Y.wpc,T)};Y.prototype.fBg=function(T){this.addHandler(Y.gud,T)};Y.prototype.k5i=function(T){this.removeHandler(Y.gud,T)};Y.prototype.BXi=function(){this.LDd(1===this.getState())};Y.prototype.dispose=function(){this.jha.Vqc(this.ZNa);this.jha=null;this.s9a.kGb(this.yCb);this.s9a=null;oe.prototype.dispose.call(this)};
Y.prototype.cac=function(){return Object.assign(new gc.a,{Current:this.t5.Current,Pending:this.t5.Pending,SuspensionStartTimestamp:this.t5.SuspensionStartTimestamp})};Y.prototype.getState=function(){return(this.wwh?Z(this.t5):this.t5.Pending!==this.t5.Current)?this.oH?2:1:0};Y.prototype.NQe=function(T,Oa){T!==Oa&&(1===Oa?this.LDd(!0):1===T&&this.LDd(!1));2===Oa?this.raiseEvent(Y.wpc,new Zd.a(this.t5)):this.Ufh&&this.raiseEvent(Y.wpc,new Zd.a(null))};Y.prototype.Lni=function(T,Oa,Kb){!T&&Oa?(T=1===
Oa,Bc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",T,T?this.jha.FHj.join(","):"",na(this.t5))):T&&!Oa&&Bc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: No pending changes. counter: {0}",na(Kb))};Y.prototype.LDd=function(T){this.raiseEvent(Y.oTd,new ma(T))};Y.oTd="TPMBBC";Y.wpc="RFPMU";Y.gud="MCC";Object(Jc.a)(Y,"MergeSuspensionState",mf.a,[]);var Ee=mf.a;
vm(S,Ee);S.prototype.nmb=function(T){this.addHandler("MCU",T)};S.prototype.kGb=function(T){this.removeHandler("MCU",T)};S.prototype.WNa=function(T,Oa){Oa=void 0===Oa?"":Oa;var Kb=this.s1.Current<T.Current||this.s1.Pending<T.Pending;if(T.SuspensionStartTimestamp&&this.zhc!==T.SuspensionStartTimestamp){if(this.zhc>T.SuspensionStartTimestamp){Kb&&Bc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",
Oa,S.JAb(T),S.JAb(this.s1));return}Kb||Bc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",S.JAb(T),S.JAb(this.s1))}else if(!Kb)return;this.s1=T;this.uHf(T)};S.prototype.dispose=function(){this.$.fa.kk(this.Jtc);this.$.fa.lW(this.Jtc);this.$.qa.Lt(this.sBa);Df.g(this.$).Kc.Rp(this.l8a);var T=this.$.da.Aa(292);T&&T.kGb(this.KAb);Ee.prototype.dispose.call(this)};S.prototype.uHf=function(T){Z(T)&&T.SuspensionStartTimestamp>
this.zhc&&(Bc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",na(T)),this.zhc=T.SuspensionStartTimestamp);this.raiseEvent("MCU",new Zd.a(T))};S.prototype.qPf=function(){Bc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",S.JAb(this.s1));this.s1=Object.assign(new gc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};S.JAb=function(T){return T?String.format("({0}/{1} @{2})",
T.Current,T.Pending,T.SuspensionStartTimestamp):"null"};tl.Object.defineProperties(S.prototype,{t5:{configurable:!0,enumerable:!0,get:function(){return this.s1}}});S.BXd="PMM.RTC";S.P5c="PMM.EwaResult";Object(Jc.a)(S,"PendingMergeMonitor",mf.a,[]);Object(Jc.a)(ca,"ClientRevisions",null,[]);var pf=b(200),Le=b(26);I.prototype.nQi=function(T){var Oa=this;if(this.lRa(T))(new ph.a).setResult(!0);else{var Kb=this.oQi(T);this.tMa=T;this.Ozd++;Kb.CWCT(function(){Oa.QBi()},pf.a.none,0,this.aO)}};I.prototype.oQi=
function(T){function Oa(){Bc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp)}var Kb=this.ta.Xb();this.Xu();this.PMb=this.Pg.z7;Bc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp);if(this.Bma){var ic=this.Bma.CMi();return O(this.ta,ic,this.RBi.bind(this),Oa,
null,null,Kb)}return ba(this.ta,null,Oa,null,null,Kb)};I.prototype.lRa=function(T){return!this.tMa||T.SuspensionStartTimestamp>this.tMa.SuspensionStartTimestamp?(this.$Ka&&Bc.ULS.sendTraceTag(528561877,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp),!1):this.$Ka?!0:xa(T,this.tMa)&&this.Pg.z7-this.PMb<this.HGb};I.prototype.QBi=function(){this.Ozd--};I.prototype.RBi=
function(T){this.Bma&&this.Bma.zyi(T.Result,T.StateId)};tl.Object.defineProperties(I.prototype,{$Ka:{configurable:!0,enumerable:!0,get:function(){return 0<this.Ozd}}});Object(Jc.a)(I,"DoPendingMergeThrottler",null,[763]);R.prototype.Dmb=function(T){return T};Object(Jc.a)(R,"ReturnNewestAggregatorStrategy",null,[404]);vm(W,R);W.prototype.ptb=function(T){return T};W.prototype.dEb=function(T){if(!T||this.lRa(T)){var Oa=new ph.a;Oa.setResult(!0);return Oa.task}Oa=this.ta.Xb();this.Xu();this.PMb=this.Pg.z7;
this.tMa=T;Bc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottlingStrategy.PerformAction: Sending DoPendingMerge {0}",na(T));return ba(this.ta,null,function(){Bc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottlingStrategy.PerformAction: request failed {0}",na(T))},null,null,Oa)};W.prototype.lRa=function(T){return xa(T,this.tMa)&&this.Pg.z7-this.PMb<this.HGb};Object(Jc.a)(W,"DoPendingMergeThrottlingStrategy",R,[405]);tl.Object.defineProperties(ia.prototype,{reportName:{configurable:!0,enumerable:!0,
get:function(){return"SelectionAdjust"}}});Object(Jc.a)(ia,"SelectionAdjustSessionEndsReport",null,[190]);P.prototype.Lbg=function(T){if(!this.v_d)return Bc.ULS.sendTraceTag(528590294,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),!1;for(var Oa=yl(this.v_d),Kb=Oa.next();!Kb.done;Kb=Oa.next())if(Kb=Kb.value,Kb.tk&&Kb.ie.Revision<T)return!1;return!0};P.prototype.ACj=function(){var T;if(this.JBa)return{SheetName:this.sheetName,ActiveCell:null===(T=this.activeCell)||void 0===
T?void 0:T.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0}};P.prototype.toString=function(){return String.format("active cell: {0} selection: {1}",this.activeCell.toString(),mi.f(this.selectedRanges,function(T){return T.toString()}).join(","))};P.prototype.equals=function(T){return T?this.activeCell.equals(T.activeCell)&&yf.Q(this.selectedRanges,T.selectedRanges)&&this.sheetName===T.sheetName:!1};tl.Object.defineProperties(P.prototype,{activeCell:{configurable:!0,enumerable:!0,
get:function(){return this.MF}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.T8}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.QUb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Tfg}},JBa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(Jc.a)(P,"Selection",null,[]);var ng=b(208);N.prototype.CMi=function(){me.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&
(this.jT.totalRequests++,this.cJ&&(this.jT.errors++,Bc.ULS.sendTraceTag(526960090,0,15,"SelectionAdjustManager.onWaitingForAdjustedSelection: About to ignore a defined Adjusted selection: {0}",this.cJ.toString())));this.cJ=null;this.Wv=this.yJa();var T=null,Oa=this.Wv.ACj(),Kb=!me.EwaSettings.isChangeGateEnabled("OfficeVSO:6011633_SelectionAdjustNonContinuousFix");if(Oa||Kb)T={ActiveSheetName:this.Wv.sheetName,SheetViewportStateChanges:[Oa]};return T};N.prototype.zyi=function(T,Oa){var Kb=this;if(this.Wv)if(T){var ic,
pd;if(function(){var Td=yf.Z(T.ActiveCell,Kb.$.xa);ic=Td.range;return Td}().returnValue)if(function(){var Td=yf.Z(T.SelectedRange,Kb.$.xa);pd=Td.range;return Td}().returnValue){if(this.cJ=new this.lTf(this.$,ic,[pd],T.SheetName,this.Wv.activeItemName),this.Rwc=Oa,this.Yze)Oa=!0,this.Wv.JBa?this.Wv.equals(this.cJ)&&(this.jT.adjustedDidntChange++,Oa=!1):(this.jT.nonContinuous++,Oa=!1),Oa||this.qwe(!1)}else this.jT.errors++,this.Wv=null,Bc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract selected range {0}",
T.SelectedRange);else this.jT.errors++,this.Wv=null,Bc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract active cell {0}",T.ActiveCell)}else this.jT.errors++,Bc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.Wv.toString());else this.jT.errors++,Bc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",
null===T||void 0===T?void 0:T.ActiveCell,null===T||void 0===T?void 0:T.SelectedRange)};N.prototype.dispose=function(){this.gridView.Ca.yq(this.Hg);this.gridView.Ca.Zo(this.e8a);this.gridView.Ca.WLf(this.e8a);this.gridView.Ca.R$a(this.e8a)};N.prototype.yJa=function(){var T=this.$.oa;return(null===T||void 0===T?0:T.activeCell)&&T.selectedRanges&&T.sheetName?new this.lTf(this.$,T.activeCell,T.selectedRanges,T.sheetName,this.$.activeItemName):null};N.prototype.aqe=function(T){if(this.cJ)if(this.Wv){if(T){if(Df.g(this.$).Ca.Slf<
this.Rwc)return;this.WEf&&!this.Wv.JBa||Bc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(this.WEf&&!this.Wv.JBa||!this.Wv.Lbg(this.Rwc)||!this.cJ.Lbg(this.Rwc))return;T=!1;try{if(this.Wv.equals(this.yJa())){if(!this.Yze){if(!this.Wv.JBa){this.jT.nonContinuous++;return}if(this.Wv.equals(this.cJ)){this.jT.adjustedDidntChange++;return}}this.jT.adjusted++;this.gridView.OU(this.cJ.selectedRanges,
0,this.cJ.sheetName,null,this.cJ.activeCell,null,null,0,Qe.a.wej)}else this.jT.divergence++,T=!0,this.V7i()}finally{this.qwe(T)}}else Bc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",this.cJ.toString())};N.prototype.qwe=function(T){this.C8i&&Bc.ULS.sendTraceTag(526792898,0,100,"SelectionAdjustManager.clearSelections: initial: {0} initialContinuous: {1} adjusted: {2}, divergence: {3}",
this.Wv.toString(),this.Wv.JBa,this.cJ.toString(),T);this.Wv=this.cJ=null};N.prototype.V7i=function(){if(this.W7i){var T=this.yJa();Bc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.Wv.toString(),T?T.toString():"",this.cJ.toString(),this.Wv.sheetName===this.cJ.sheetName,this.Wv.sheetName===(T?T.sheetName:null))}};tl.Object.defineProperties(N.prototype,
{lTf:{configurable:!0,enumerable:!0,get:function(){return P}}});Object(Jc.a)(N,"SelectionAdjustManager",null,[760,3]);var eg=mf.a;vm(U,eg);U.prototype.dispose=function(){this.$.qa.fza(this.tBa);Zg.a.Fa(this.crb);this.Wwc();this.BV.Q5i(this.Txf);this.BV.Wqc(this.kDb);this.BV.k5i(this.gwf);this.BV=null;this.Bma&&this.Bma.dispose();eg.prototype.dispose.call(this)};U.prototype.vTf=function(T){this.crb.eEb(T)};U.prototype.cxj=function(){this.Wwc();if(this.$Ee()){var T=this.BV.cac();Bc.ULS.sendTraceTag(537155414,
0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",na(T),this.Zyb)}else this.$yb=this.vra.create(this.ATf,this.HGb,yh.a.$yb),this.u6a=this.vra.XB(this.ATf,this.wii,yh.a.u6a)};U.prototype.Wwc=function(){this.u6a&&(this.$yb.cancel(),this.u6a.cancel(),this.u6a=this.$yb=null)};U.prototype.ZFi=function(T){var Oa=" fail count: "+this.Zyb;this.Zyb++;this.$Ee()&&this.Wwc();Bc.ULS.sendTraceTag(542229773,
0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",na(T),Oa)};U.prototype.$Ee=function(){return this.Zyb>U.mri};U.mri=5;Object(Jc.a)(U,"RequestController",mf.a,[]);var eh=ja.a;vm(B,eh);B.prototype.$Xb=function(T){this.jfa.$Xb(T)};B.prototype.Wqc=function(T){this.jfa&&this.jfa.Wqc(T)};B.prototype.Xya=function(T,Oa){this.iCa.Xya(T,Oa)};B.prototype.UUd=function(T){this.iCa.UUd(T)};B.prototype.WNa=function(T,Oa){this.yjb.WNa(T,void 0===Oa?"":Oa)};B.prototype.dispose=
function(){this.hdc&&(this.hdc.dispose(),this.hdc=null);this.bId&&(this.bId.dispose(),this.bId=null);this.jfa&&(this.jfa.dispose(),this.jfa=null);this.yjb.dispose();this.yjb=null;this.iCa.dispose();this.iCa=null;this.wZa&&(this.wZa.dispose(),this.wZa=null);this.i4a&&(this.i4a.dispose(),this.i4a=null);this.$=null;eh.prototype.dispose.call(this)};B.prototype.$Eb=function(){this.jfa.BXi()};B.prototype.o3h=function(T,Oa){this.iCa=new lb;Oa?Object(qe.a)(Ma,Oa)?this.Xya(Oa,Object(Nc.a)(Ma,Oa).oH):Object(qe.a)(Ya,
Oa)?this.Xya(Oa,Object(Nc.a)(Ya,Oa).oH):this.Xya(Oa,!0):(this.wZa=new Ya(T),this.i4a=new Ma(T),this.Xya(this.wZa,this.wZa.oH),this.Xya(this.i4a,this.i4a.oH))};tl.Object.defineProperties(B.prototype,{jha:{configurable:!0,enumerable:!0,get:function(){return this.iCa}},s9a:{configurable:!0,enumerable:!0,get:function(){return this.yjb}},BV:{configurable:!0,enumerable:!0,get:function(){return this.jfa}}});Object(Jc.a)(B,"MergeSuspensionManager",ja.a,[701,3]);var Yg=fd.a;vm(w,Yg);w.prototype.create=function(){Bc.ULS.sendTraceTag(537155419,
0,50,"MergeSuspensionFactory.Create");this.Fb(this.Nc.da.Aa(343)||this.Nc.da.Ha(343,new B(this.Nc,ni.a.instance)))};w.ja=function(T){Bc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");T.da.Ha(344,new w(T))};Object(Jc.a)(w,"MergeSuspensionFactory",fd.a,[]);G.Pki=3;G.connected=0;Object(Jc.a)(G,"ConnectionStateConstants",null,[]);var th=b(107),rh=b(113),nf=b(39);r.prototype.hVf=function(){this.durationMs=rh.a(Le.a.Ra,this.startTime)};r.prototype.Vyd=function(T){var Oa=this,Kb;this.hVf();
nf.a(T).Tqc(this.brf);nf.a(T).pg.Uqc(this.Vba);T.da.Za(291,function(ic){ic.U$a(Oa.HV)});if(null===(Kb=T.fa)||void 0===Kb?0:Kb.Df)T.fa.Df.jNf(this.Jzd),this.wasUserActiveOnPIEnd=T.fa.Df.Yq};r.prototype.ak=function(T){var Oa=this;nf.a(T).TXb(this.brf);this.isToastShown?this.toastRaiser="Immediate":nf.a(T).pg.ETc(this.Vba);T.da.Za(291,function(Kb){Oa.hasTabbedOut=Kb.kj;Kb.aFa(Oa.HV)});this.wasUserActiveOnPIStart&&T.fa.Df.TCg(this.Jzd)};Object(Jc.a)(r,"PartialInteractivityData",null,[]);var bh=b(1216);
vm(z,r);z.prototype.MAi=function(T,Oa){this.swappedByOffline=Oa;this.Vyd(T)};z.prototype.nij=function(T){this.errorDataDuringConnectivityIssuesMode=T};z.prototype.a_i=function(T){10>this.failedRequests.length&&(T=T+"_"+th.getElapsedSeconds(this.startTime,Le.a.Ra.Kb).toString(),this.failedRequests.push(T))};Object(Jc.a)(z,"ConnectivityIssuesData",r,[]);var xh=b(166);t.Ndh="DuringWork";t.connectivityIssues="ConnectivityIssues";t.offline="Offline";Object(Jc.a)(t,"UnavailabilityTypes",null,[]);x.prototype.dispose=
function(){this.$&&(nf.a(this.$).pg.gMf(this.nsf),this.$.uf&&this.$.uf.fMf(this.ksf));this.data&&this.$.qa.uf.kNf(this.Xo);this.$=null};x.prototype.SOg=function(T){var Oa=this.g9c-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Oa-1)+T)/Oa};Object(Jc.a)(x,"ConnectivityIssuesTelemetryManager",null,[3]);var Ag=b(992),bi=b(1262),Ti=b(1215);A.prototype.dispose=function(){this.$&&(this.sOd&&this.$.qa&&0<this.H7a.count&&this.$.qa.Lt(this.Zh),this.tOd&&(this.bRd("Dispose"),this.$.fa.Df.eza(this.Uba)))};
A.prototype.S2h=function(){me.EwaSettings.la(212)&&this.WSi();this.tOd&&this.XSi()};A.prototype.p3h=function(){this.ABb=this.BBb;this.pqd=0;var T={};if(!this.H7a){this.H7a=new Vf.a;var Oa=bi.a.Mad(this.B8i,"InitSampleMeasurement",this.$);Oa=yl(Oa);for(var Kb=Oa.next();!Kb.done;Kb=Oa.next())Kb=Kb.value,T[Kb.bid]=Kb.baseUrl,this.H7a.add(Kb)}T=Sys.Serialization.JavaScriptSerializer.serialize(T);Bc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",
this.BBb,this.ABb,T);0<this.H7a.count&&this.$.qa.us(this.Zh)};A.prototype.vxj=function(){for(var T=yl(this.H7a),Oa=T.next();!Oa.done;Oa=T.next())Oa.value.JJd()};A.prototype.KQd=function(T){this.ARa&&this.ARa.Qo||(Bc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",T),this.ARa=ni.a.instance.XB(this.afj,5E3,yh.a.uvj),this.ARa.Uja())};A.prototype.bRd=function(T){this.ARa&&this.ARa.Qo&&(Bc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",
T),this.ARa.cancel())};A.prototype.wpj=function(T){return this.ABb>=this.BBb&&T-this.pqd>this.sud};A.prototype.xSg=function(){return A.uQf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};A.prototype.WSi=function(){this.BBb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.sud=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var T=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.BBb&&0<this.sud&&(this.sOd=A.uQf(T))&&this.p3h()};A.prototype.XSi=function(){if(!this.uwc){this.uwc=new Vf.a;
var T=bi.a.Mad(this.R7i,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Ti.a.WBc]);T=yl(T);for(var Oa=T.next();!Oa.done;Oa=T.next())this.uwc.add(Oa.value);this.$.fa.Df.Yq&&this.KQd("PrepareAndInitSlowNetworkTests")}};A.uQf=function(T){return 100*Math.random()<T};Object(Jc.a)(A,"NetworkMeasurement",null,[3]);var Qi=b(913);m.prototype.SIj=function(){this.ZT&&this.ZT.hVf()};m.prototype.wxg=function(T){this.allOfflinePartialInteractivitiesDataInSession.push(T);this._count++};tl.Object.defineProperties(m.prototype,
{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},ZT:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(Jc.a)(m,"OfflinePartialInteractivitiesDataForLog",null,[]);vm(v,r);v.prototype.Qlj=function(T){this.timeFromLastOffline=T};v.prototype.oij=function(T){this._errorDataDuringOfflineMode=T};Object(Jc.a)(v,"OfflinePartialInteractivityData",r,[]);u.prototype.dispose=
function(){this.$&&nf.a(this.$)&&nf.a(this.$).pg.ZGd(this.F8a);Zg.a.Fa(this.Ksb);this.$=this.Ksb=null};u.prototype.NHi=function(T){this.ZT=new v(Le.a.Ra.Kb,this.$,!!T);this.ZT.Qlj(-1!==this.BCd?window.performance.now()-this.BCd:-1);this.zNa.wxg(this.ZT);nf.a(this.$).pg.ETc(this.Vba);this.H1a();this.Ksb=ni.a.instance.XB(this.H1a,u.axh,yh.a.H1a);xh.a(this.$).fTc(this.ARf)};u.prototype.OHi=function(){this.ZT.Vyd(this.$);this.H1a();Zg.a.Fa(this.Ksb);this.Ksb=null;this.BCd=window.performance.now();nf.a(this.$).pg.Uqc(this.Vba);
xh.a(this.$).JGd(this.ARf);this.S7i()};u.prototype.scj=function(T,Oa){var Kb=this;this.$?this.Dgf=gg.TaskExtensions.Ba(this.Dgf,function(){Kb.indexedDB.Sab(new Qi.a(T,Oa))},this.$.ma):Bc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};u.prototype.M7i=function(){var T=this.$.ma;gg.TaskExtensions.Ba(gg.TaskExtensions.Ba(this.indexedDB.CJa(u.HAd),this.s8i,T),this.z2i,T)};u.prototype.S7i=function(){if(this.ZT){var T=
Sys.Serialization.JavaScriptSerializer.serialize(this.ZT);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?$f.b().bIb(560791645,0,50,t.offline,this.ZT.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",T):Bc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",T)}me.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
this.ZT&&this.ZT.isToastShown&&Wc.Health.instance.recordQosError(Bf.a.EMj,[Uf.a.Shc],!0,!1,!1,!1,null)};u.kjd="NetworkAvailability";u.ljd="NetworkAvailabilityData";u.HAd="partialInteractivityData";u.axh=3E3;Object(Jc.a)(u,"OfflineModeTelemetryManager",null,[3]);f.prototype.dispose=function(){Zg.a.Fa(this.Zpf);Zg.a.Fa(this.uvd);Zg.a.Fa(this.Xka);Zg.a.Fa(this.PXg);this.$=null};Object(Jc.a)(f,"NetworkConnectionTelemetryManager",null,[3]);vm(l,r);l.prototype.F8a=function(){this.wasInteruptedByOfflineMode=
!0};Object(Jc.a)(l,"SilentReopenData",r,[]);n.prototype.dispose=function(){this.pg.GMf(this.bwf);this.pg.o6i(this.Lzf);this.W6=this.pg=this.$=null};n.prototype.Izf=function(T,Oa){T.ZO?this.W6=new l(Le.a.Ra.Kb,this.$,!!T.wna,Oa):(5===T.wna&&(this.W6.wasInteruptedByOfflineMode=!0),3!==T.wna&&2!==T.wna||Bc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.W6.Vyd(this.$),
2===Oa?me.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?$f.b().cIb(571289604,0,50,t.offline,this.W6.durationMs,this.W6):Bc.ULS.sendTraceTag(571289604,0,50,wg.a.Hc(this.W6)):me.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?$f.b().cIb(542782150,0,50,t.Ndh,this.W6.durationMs,this.W6):Bc.ULS.sendTraceTag(542782150,0,50,wg.a.Hc(this.W6)),this.W6=null)};Object(Jc.a)(n,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var jj=mf.a;vm(k,jj);k.prototype.dispose=function(){this.uf&&(this.jvc&&(this.uf.p5i(this.FCb),this.uf.mGb(this.Gwf)),this.uf.fMf(this.lsf),this.uf.b4i(this.msf));this.myb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.dGb(this.Nxa),this.myb=!1);this.$&&(this.Ypc&&this.ezc(),this.$.fa&&(this.$.fa.$Mf(this.Kzf),this.$.fa.Df&&this.$.fa.Df.eza(this.Uba)));me.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.w0&&(this.w0.dispose(),
this.w0=null);Zg.a.Fa(this.Xnf);this.$=null;jj.prototype.dispose.call(this)};k.prototype.Oqi=function(){this.lOd=!0};k.prototype.Fhe=function(){this.ina||(this.ina=nf.a(this.$).pg.dXa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};k.prototype.X8h=function(){if(this.lOd)return this.lOd=!1,!0;var T=this.h7>this.Gjf||this.djd>this.Gjf&&10>this.h7;Bc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.h7,this.djd,T);return T};k.prototype.E8i=function(){me.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.w0=ni.a.instance.create(function(){Wc.Health.instance.recordQosError(Bf.a.zvj,[Uf.a.Shc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};k.prototype.bvg=function(){var T=this;this.ina||this.k0?Bc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.k0=ni.a.instance.create(function(){T.$?T.ina?Bc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Df.g(T.$).isEditing?(T.F$a||(Df.g(T.$).rc.hq(T.Rh),Bc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),T.G$a=
!0,Bc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):T.Fhe():Bc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.N0f,yh.a.tuj,void 0,!0)};k.prototype.Rmf=function(T){this.x0c=this.Wse(2,T,!0);this.tme()};k.prototype.Ijc=function(T,
Oa){this.GUb=this.Wse(T,Oa,!1);this.tme()};k.prototype.Wse=function(T,Oa,Kb){Kb=Kb?this.x0c:this.GUb;return Oa?Kb|T:Kb&~T};k.prototype.nTd=function(){var T=!!this.ANa,Oa=!!this.vRa,Kb=!!this.ina,ic=!!this.R1b;this.jAb&&!T?this.$ug():!this.jAb&&T&&this.f8g();!this.Dic||Oa||Kb?this.Dic||(Oa?this.uDe():(Kb||this.k0&&this.k0.Qo)&&this.vDe()):this.QYf&&this.afa?this.Yug():!this.lJb||this.afa||me.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.k0||
this.bvg();this.Zja&&!ic?this.R5f(!0):!this.Zja&&ic&&this.R5f(!1)};k.prototype.$ug=function(){this.$?this.ANa?Bc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):Df.g(this.$).isEditing?(this.G$a||(Df.g(this.$).rc.hq(this.Rh),Bc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.F$a=!0,Bc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Ihe():Bc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};k.prototype.Ihe=function(){this.ANa||(this.ANa=nf.a(this.$).pg.dXa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};k.prototype.f8g=function(){this.ANa&&
(Zg.a.Fa(this.ANa),this.ANa=null)};k.prototype.uDe=function(){this.vRa&&(Zg.a.Fa(this.vRa),this.vRa=null);me.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.w0&&this.w0.Qo&&this.w0.cancel();this.w0=null};k.prototype.vDe=function(){this.ina&&(Zg.a.Fa(this.ina),this.ina=null);this.k0&&(Zg.a.Fa(this.k0),this.k0=null);this.G$a&&!this.F$a&&Df.g(this.$).rc.Rp(this.Rh);this.G$a=!1};k.prototype.Yug=function(){this.vRa||(this.vRa=nf.a(this.$).pg.dXa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Mg.a.instance.ea(2119)));this.E8i()};k.prototype.R5f=function(T){T?(this.R1b=nf.a(this.$).pg.dXa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.XVi()):(Zg.a.Fa(this.R1b),this.R1b=null)};k.prototype.XVi=function(){if(this.$&&this.$.qa){var T=this.$.qa.ta.Xb();Id.ib(this.$.qa.ta,null,null,null,T)}};k.prototype.ezc=function(){ha.a(this.$).gQ(K.a.kOa).zq(this.Rwf);this.$.ml(this.od);this.Ypc=!1};k.prototype.tme=function(){this.documentVisibilityObserver||Bc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.kj?this.myb||(this.documentVisibilityObserver.imb(this.Nxa),this.myb=!0,Bc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.nTd()};tl.Object.defineProperties(k.prototype,
{K$h:{configurable:!0,enumerable:!0,get:function(){return this.afa}},jAb:{configurable:!0,enumerable:!0,get:function(){return!(this.GUb&1)}},Dic:{configurable:!0,enumerable:!0,get:function(){return!(this.GUb&2)}},Zja:{configurable:!0,enumerable:!0,get:function(){return!!(this.x0c&2)}}});Object(Jc.a)(k,"NetworkConnectionStateManager",mf.a,[704,3]);var vh=fd.a;vm(c,vh);c.prototype.create=function(){var T=this;gg.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(this.$.da,395,396,this.tb),function(Oa){T.Fb(T.$.da.Aa(400)||
new k(T.$,Oa.result))},this.$.ma,3)};c.ja=function(T){T.da.Ha(401,new c(T))};Object(Jc.a)(c,"NetworkConnectionStateManagerFactory",fd.a,[]);var Bi=b(1372);d.prototype.dispose=function(){this.y8f();this.G8f();this.uqd=this.eqd=this.CK=this.nk=this.Et=this.qpc=this.$=null;this.oXd=0};d.prototype.KJg=function(T){this.CK=T;this.eqd=T.qDg;this.uqd=T.v_i};d.prototype.NHa=function(){if(this.CK){var T=yf.K(this.CK.osh);this.Hvj(T);this.hide();this.y8f();this.CK=null}};d.prototype.Hvj=function(T){if(me.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",
!1)&&T)if(null==this.A6a||1868184698!=this.A6a.command&&753331043!=this.A6a.command&&2137617149!=this.A6a.command)if(Df.g(this.$).Vb.S4(T))Bc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered.");else if(Df.g(this.$).Vb.R4(T))Bc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered.");else{var Oa=Me.d(this.$.xa.oa);T=new sg.a(T,Oa);this.IEj(T)}else this.A6a=
null,Bc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Last command was create table or create pivot table. Table hand raise is not triggered.")};d.prototype.eei=function(){return!!this.CK&&this.qpc.Eai};d.prototype.Etj=function(T){this.CK?this.show(T):Bc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};d.prototype.zLh=function(){return this.CK?this.CK.Wji:null};d.prototype.show=function(T){var Oa=this.CK.uHh();Oa?(this.qpc.showFloatie(Object.assign(new Bi.a,
{x:Oa.x,y:Oa.y}),this.CK.xJa(),T),this.ak()):Bc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};d.prototype.hide=function(){this.eei()&&this.qpc.bC();this.G8f()};d.prototype.ak=function(){if(!this.T4b){var T=Df.g(this.$);T.view.it(this.G$f);T.Jj.wm(this.EFe);this.nk.ja("blur",this.Yah);this.$.Ka.gmb(this.Jxa);this.$.xa.Pf(this.FFe);(T=this.$.da.Aa(65))&&T.N2&&T.N2.registerForCommentEvents(this.DFe);this.T4b=!0}this.icc||(this.Et.Vu(Xb.a.Rb,this.$.domElement,this.onKeyDown,
!0),this.Et.Vu(Xb.a.Vd,this.$.domElement,this.onKeyUp,!0),this.icc=!0)};d.prototype.y8f=function(){if(this.T4b){var T=Df.g(this.$);T.view.Wr(this.G$f);T.Jj.im(this.EFe);this.nk.detach("blur");this.$.Ka.T$a(this.Jxa);this.$.xa.rg(this.FFe);(T=this.$.da.Aa(65))&&T.N2&&T.N2.unregisterForCommentEvents(this.DFe);this.T4b=!1}};d.prototype.G8f=function(){this.icc&&(this.Et.kv(Xb.a.Rb,this.$.domElement,this.onKeyDown,!0),this.Et.kv(Xb.a.Vd,this.$.domElement,this.onKeyUp,!0),this.icc=this.NZ=this.q7b=!1)};
d.prototype.MKj=function(){this.CK&&250<=Le.a.Ra.se.m-this.oXd&&this.show(-1)};d.prototype.IEj=function(T){gg.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(Oa){Oa.result.Pda(T,"Paste")},this.$.ma,3)};Object(Jc.a)(d,"RecoveryUIController",null,[703,3]);var li=fd.a;vm(a,li);a.prototype.create=function(){var T=this,Oa=this.$;Oa.rE(function(Kb){Kb.vjd().then(function(ic){T.Fb(Oa.da.Aa(406)||new d(Oa,ic,kb.KeyInputManager.instance,xb.a.instance.VD()))})})};a.ja=function(T){T.da.Ha(405,
new a(T))};Object(Jc.a)(a,"RecoveryUIControllerFactory",fd.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");xg.main();Type.registerNamespace("Common.App.InProductMessaging");nd.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Xc.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
(function(){la.a.Ga(function(T){Tc.ja(T)})})();(function(){la.a.Ga(function(T){Pc.ja(T)})})();(function(){la.a.Ga(function(){la.a.Ga(Eb.ja)})})();(function(){la.a.Ga(function(){la.a.Ga(Mb.ja)})})();(function(){la.a.Ga(function(T){Wb.ja(T)})})();Ue.a.Yi(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
la.a.Ga(w.ja);la.a.Ga(c.ja);(function(){la.a.Ga(function(T){a.ja(T)})})()},992:function(y,D,b){function a(A){var x=this;this.businessBar=this.D6a=null;this.ozi=function(t,z){z.k5c?x.qzi(z):x.pzi(z)};this.Zh=function(t,z){t=z.context.methodName;x.D6a&&t===x.D6a&&(k.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',x.D6a),x.X6a(a.fIb,!0),x.D6a=null);x.ajf(!1);x.Q1b=!1};this.Xo=function(t,
z){l.a.hh(z.errors,[-1387426400])&&!x.Q1b&&(x.Q1b=!0,x.cZf()&&window.performance.mark(a.Ypf),(new d(x)).oji())};this.Rg=function(){x.ajf(!0);x.X6a(a.dBb,!1);x.X6a(a.fIb,!1)};this.Txa=function(){k.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");x.X6a(a.dBb,!0)};this.$=A;this.qa=this.$.qa;this.localStorage=new u.a;this.Q1b=!1;this.$.fa.sn(this.Rg);this.qa.uf.omb(this.Txa);this.qa.us(this.Zh);this.$.da.Za(5,
function(t){x.businessBar=t;t.qzg(x.ozi)});this.qa.FB(this.Xo)}function d(A){var x=this;this.kid=[v.a.xdg,v.a.WBc];this.zo=function(t,z){x.zN[z]=t;x.UZh()&&x.w8i("OnNetworkDownImmediatePing"===t.caller)};this.Xka=A;this.$=A.$;this.zN={}}function c(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(D);y=b(0);var k=b(13),n=b(315),l=b(27),f=b(8),u=b(304);Object(y.a)(c,"ConnectionErrorLogInfo",null,[]);var v=b(1215),m=b(1262);d.prototype.oji=function(){var A=m.a.Mad(this.zo,
"OnNetworkDownImmediatePing",this.$,this.kid);A=yl(A);for(var x=A.next();!x.done;x=A.next())x.value.JJd()};d.prototype.UZh=function(){for(var A=yl(this.kid),x=A.next();!x.done;x=A.next())if(x=x.value,void 0===this.zN[x]||null===this.zN[x])return!1;return!0};d.prototype.w8i=function(A){var x=this.$.uf.jV;A&&this.qyj(x);A=yl(this.kid);for(var t=A.next();!t.done;t=A.next())t=t.value,this.zN[t]=Sys.Serialization.JavaScriptSerializer.serialize(this.zN[t]);A=Date.now();t=this.Xka.vfd(b(992).NetworkConnectionHealthChecker.dBb).returnValue;
var z=this.Xka.vfd(b(992).NetworkConnectionHealthChecker.fIb).returnValue;this.zN.isOfflineMode=x;this.zN.networkDownBBAge=-1===t?t:A-t;this.zN.transientServerCommunicationFailuresBBAge=-1===z?z:A-z;this.Xka.businessBar?(this.zN.isNetworkDownBBShown=this.Xka.businessBar.MB(54).toString(),this.zN.isServerErrorBBShown=this.Xka.businessBar.MB(21).toString()):(this.zN.isNetworkDownBBShown="unknown",this.zN.isServerErrorBBShown="unknown");k.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.zN))};d.prototype.qyj=function(A){for(var x=b(992).NetworkConnectionHealthChecker,t={},z=yl(Object.keys(this.zN)),r=z.next();!r.done;r=z.next())r=this.zN[r.value],t[r.testName]=r.isSuccess;t.isOfflineMode=A;this.Xka.lRd(x.w0c,Sys.Serialization.JavaScriptSerializer.serialize(t))};Object(y.a)(d,"ConnectionHealthTestsRunner",null,[]);b.d(D,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.fa&&this.$.fa.hr(this.Rg),
this.qa&&(this.qa.uf.mGb(this.Txa),this.qa.VC(this.Xo),this.qa.Lt(this.Zh)))};a.prototype.qzi=function(A){var x={};x.Timestamp=Date.now().toString();switch(A.cob){case 21:this.D6a=A.data.FailedMethod;x.FailedMethod=this.D6a;this.lRd(a.fIb,JSON.stringify(x));break;case 54:this.lRd(a.dBb,JSON.stringify(x))}};a.prototype.pzi=function(A){switch(A.cob){case 21:this.X6a(a.fIb,!0);break;case 54:this.X6a(a.dBb,!0)}};a.prototype.lRd=function(A,x){try{this.localStorage.og()&&this.localStorage.setItem(A,x)}catch(t){k.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",t.message||"Unknown")}};a.prototype.vfd=function(A){if(this.localStorage.og()&&(A=this.localStorage.K2a(A))&&"null"!==A){var x=JSON.parse(A);A=parseInt(x.Timestamp);x=Sys.Serialization.JavaScriptSerializer.serialize(x);return{returnValue:A,rawData:x}}return{returnValue:-1,rawData:null}};a.prototype.ajf=function(A){if(this.localStorage.og()){var x=this.localStorage.K2a(a.w0c);if(x&&"null"!==
x){var t=-1;this.Q1b&&(t=this.LHh(a.Ypf,a.cyi));k.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(x),t,A);this.localStorage.removeItem(a.w0c)}}};a.prototype.LHh=function(A,x){if(!this.cZf())return-1;window.performance.measure(x,A);A=window.performance.getEntriesByName(x);return A.length&&A[A.length-1]?A[A.length-1].duration:(k.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",x),-1)};a.prototype.X6a=function(A,x){try{var t=this.vfd(A);var z=t.rawData;var r=t.returnValue;if(-1!==r){var G=Object.assign(new c,{timeElapsed:Date.now()-r,scenario:A,isNewSession:!x,rawData:z});k.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(G))}this.localStorage.removeItem(A)}catch(w){k.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
w.message||"Unknown")}};a.prototype.cZf=function(){return f.HelperMethods.QWc&&n.a.Tnb};a.dBb="NetworkDownBBShown";a.fIb="ServerCommunicationFailureBBShown";a.w0c="ConnectionHealthPingRsults";a.Ypf="offMoStMa";a.cyi="offMoDuMea";Object(y.a)(a,"NetworkConnectionHealthChecker",null,[3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/13ff15f2a315f707f2f8b69de7f7d2b4/EwaDS.pi.js.map