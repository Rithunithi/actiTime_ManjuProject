(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1136:function(y,D,b){function a(n,l){n=k.call(this,n,l)||this;l!==c.a.r9&&n.TEa(l);n.gga(a.iterateNext);n.gga(a.Cwa);n.gSc(d.a.gTa);n.gSc(d.a.hTa);return n}b.d(D,"a",function(){return a});y=b(0);var d=b(170);D=b(1254);var c=b(889),k=D.a;vm(a,k);a.iterateNext="IterateNext";a.Cwa="IteratePrevious";a.yLb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.gOa=
"OnVHDiffReady";Object(y.a)(a,"VersionHistoryMessenger",D.a,[])},1257:function(y,D,b){function a(O,ba,ca,S){var Y=this;this.authorColor=this.L1=this.Zda=null;this.a6a=!1;this.l6f=0;this.R_a=-1;this.s3c=0;this.BHa=100;this.wka=-1;this.VWd=null;this.Fnb=u.a.SNj;this.EDe=u.a.TNj;this.Zh=function(ma){(ma=r.a(ma)?null:ma.Result)?ma.OperationWaitingForFileDownload?20>Y.s3c?(Y.BHa*=2,Q.Task.delay(Y.BHa).continueWith(function(){Y.jUd()})):(Y.Jzc(),c.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ma.ActivityList?(Y.initialize(ma.ActivityList,ma.VersionAuthors),G.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?Y.gOa():Y.Vvc(!0),Y.VWd.stop(),c.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",Y.VWd.Ac.toString())):(Y.Jzc(),c.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(Y.BHa*=2,Q.Task.delay(Y.BHa).continueWith(function(){Y.jUd()}),
c.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.eya=function(){Y.Jzc();c.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Epd=function(ma){c.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ma.MessageId);switch(ma.MessageId){case W.a.iterateNext:Y.iterateNext();Y.wka=(Y.wka+1)%Y.JR.length;Y.WHb(W.a.setCurrentChangeCount,
Y.wka+1);break;case W.a.Cwa:Y.Cwa();Y.wka=0>Y.wka?0:Y.wka;Y.wka=(Y.wka+Y.JR.length-1)%Y.JR.length;Y.WHb(W.a.setCurrentChangeCount,Y.wka+1);break;case W.a.yLb:Y.Vvc(ma.Values.ToggleValue)}};this.SWg=function(ma,Z){return Y.D1b(ma.zm,Z.zm)};this.RWg=function(ma,Z){return Y.D1b(ma.zm,Z)};this.kd=function(){Y.v4b()};this.Wo=function(){Y.v4b()};this.Mj=function(){Y.v4b()};c.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=O;this.ariaLiveNotifier=S;this.gridView=P.g(this.$);
this.gridView.ha.jG(this.kd);this.gridView.DD(this.Wo);this.gridView.Kc.wm(this.Mj);this.OJj();ba&&(this.VWd=O.Ub.Fc("UserAction","VersionHistoryDiffManagerStopWatch"),this.jUd());if(this.Nr=ca)O=k.a.laa(this.$.ya.VersionHistoryActionUrl)||I.a.r9,O!==I.a.r9&&this.Nr.TEa(O),this.Nr.Pn(W.a.iterateNext),this.Nr.Pn(W.a.Cwa),this.Nr.Pn(W.a.yLb),this.Nr.Km(W.a.iterateNext,this.Epd),this.Nr.Km(W.a.Cwa,this.Epd),this.Nr.Km(W.a.yLb,this.Epd)}function d(O,ba,ca){this.QEa=O;this.zm=ba;this.qAc=ca}y=b(0);var c=
b(13),k=b(77),n=b(962),l=b(84),f=b(185),u=b(9),v=b(204),m=b(59),A=b(43),x=b(519),t=b(163),z=b(106),r=b(302),G=b(1),w=b(8),B=b(95),U=b(14),N=b(273);b(105);var P=b(20),ia=b(336);Object(y.a)(d,"UserActivityLocation",null,[]);var W=b(1136),R=b(81),I=b(889),Q=b(55);b.d(D,"a",function(){return a});a.prototype.dispose=function(){this.Zya();this.Zda=this.L1=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.mF(this.kd),this.gridView.lF(this.Wo),this.gridView.Kc&&this.gridView.Kc.im(this.Mj),this.Nr&&
(this.Nr.Sna(W.a.Cwa),this.Nr.Sna(W.a.iterateNext),this.Nr.Sna(W.a.yLb)))};a.prototype.initialize=function(O,ba){O?(this.Zya(),this.R_a=-1,this.Zda=[],this.a6a=!1,this.L1={},this.authorColor={},this.Cqi(ba),this.Z2c(O)):c.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.jUd=function(){function O(ca,S,Y){var ma=ba.$.qa.ta;ca=N.b(ca,ba.Zh);S=N.a(S,ba.eya);var Z=ma.Oa(1,null);return R.i(ma,"GetVersionHistoryHighlightActivitiesData",
Z,ca,S,Y,null,4)}var ba=this;c.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.s3c.toString(),this.BHa.toString());this.s3c++;G.EwaSettings.tc()?this.$.userOperationManager.ic(new t.a(537,0,O,80),null):this.$.userOperationManager.ic(new x.a(537,0,O,16),null)};a.prototype.Vvc=function(O){var ba=this.L1,ca;for(ca in ba){var S=ca,Y=ba[ca];Y?Y.MJb(O):c.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+
S+"view was Null")}};a.prototype.Zya=function(){var O=this.L1,ba;for(ba in O){var ca=ba,S=O[ba];S?S.R2i():c.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+ca+"view was Null")}this.Zda=this.L1=null};a.prototype.ZSf=function(O){var ba=this.gNh(O,this.R_a);var ca=ba.m7e;O=ba.Lag;ba.returnValue&&(c.ULS.shipAssertTag(537150402,0,!!O,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.v4b(),O.QEa.toString()in this.L1?
(this.L1[O.QEa.toString()].qej(O.zm),ba=A.D(O.zm),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(U.a.instance.Cb(157),ca+1,this.JR.length,ba.qE(!1),O.qAc.DisplayName)),this.R_a=ca):c.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",O.QEa.toString())))};a.prototype.WHb=function(O,ba){if(G.EwaSettings.la(328))if(this.Nr){var ca=
{};ca.count=ba;O=new n.a(O);O.Values=ca;this.Nr.send(O)}else c.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else c.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.gNh=function(O,ba){var ca=!1;var S=null;for(var Y=0;!ca&&Y<this.JR.length;){ba=O?this.YMh(ba):this.IOh(ba);S=this.JR[ba];var ma=Object(l.a)(B.a,this.$.xa.getItemByName(S.zm.SheetName));
if(!ma)return c.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),{returnValue:!1,m7e:ba,Lag:S};ma.visible&&(ca=!0);Y++}return{returnValue:ca,m7e:ba,Lag:S}};a.prototype.YMh=function(O){return-1===O?this.uYe():(O+1)%this.JR.length};a.prototype.IOh=function(O){-1===O&&(O=this.uYe());return O=(O+this.JR.length-1)%this.JR.length};a.prototype.Z2c=function(O){this.h6g(O);
this.E2c()};a.prototype.UTh=function(O,ba){var ca=[];if(!O.RangeList)return c.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),ca;O=yl(O.RangeList);for(var S=O.next();!S.done;S=O.next())(S=S.value)&&this.$.xa.tj(S.SheetName)?(S=new d(0,S,ba),ca.push(S)):c.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+S.SheetName);return ca};a.prototype.h6g=function(O){O=yl(O);for(var ba=O.next();!ba.done;ba=
O.next())if(ba=ba.value,!ba||z.e(ba.LocationList))c.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var ca=yl(ba.LocationList),S=ca.next();!S.done;S=ca.next())if(S=S.value)switch(S.Type){case 0:this.Zda.push.apply(this.Zda,Fl(this.UTh(S,ba.Person)));break;default:c.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else c.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};
a.prototype.E2c=function(){for(var O={},ba=new f.a,ca=[],S=yl(this.Zda),Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,ba.contains(Y.qAc)||ba.add(Y.qAc),!Y.QEa){var ma=new ia.a(A.D(Y.zm),m.d(this.$.xa.getItemByName(Y.zm.SheetName))),Z=a.Vuc(ma);Z in O||ca.push(ma);O[Z]=this.jFh(Y.qAc)}c.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.Zda.length,
ca.length,ba.count,this.l6f);this.Jzc();0<ca.length&&(O=new (b(1347).RangeVersionHistoryHighlightView)(this.$,ca,O,this.Fnb),this.L1["0"]=O)};a.prototype.Jzc=function(){var O=this.Zda?this.JR.length:0;this.WHb(W.a.setCurrentChangeCount,0);this.WHb(W.a.setTotalChangesCount,O)};a.prototype.gOa=function(){this.WHb(W.a.gOa,0)};a.prototype.Cqi=function(O){if(O){this.l6f=O.length;for(var ba=0;ba<O.length;++ba)if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!O[ba].InitialsColor)c.ULS.sendTraceTag(537150362,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var ca=O[ba].EmailAddress;var S=O[ba].UserName;var Y=null;if(O[ba].LoginName){var ma=O[ba].LoginName.split("|");3===ma.length&&(Y=ma[2])}Y?this.authorColor[Y]=O[ba].InitialsColor:ca?(c.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[ca]=O[ba].InitialsColor):S?(c.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),
this.authorColor[S]=O[ba].InitialsColor):c.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else c.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.OJj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var O=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):
null,ba=0;ba<O.length;ba++){var ca=O[ba],S=ca.key?ca.key:ca.Key?ca.Key:"";ca=ca.value?ca.value:ca.Value?ca.Value:"";"DefaultColor"===S?this.EDe=ca:"InitialTint"===S?this.Fnb=ca:c.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else c.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.jFh=function(O){if(O.Email in this.authorColor)return this.authorColor[O.Email];
if(O.DisplayName in this.authorColor)return this.authorColor[O.DisplayName];c.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.EDe};a.prototype.D1b=function(O,ba){var ca=Object(l.a)(B.a,this.$.xa.getItemByName(O.SheetName)),S=Object(l.a)(B.a,this.$.xa.getItemByName(ba.SheetName));return ca&&S?(ca=(ca=w.HelperMethods.xC(ca.index,S.index))||w.HelperMethods.xC(O.FirstRow,ba.FirstRow))||
w.HelperMethods.xC(O.FirstColumn,ba.FirstColumn):(c.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.uYe=function(){var O=A.m(this.gridView.ha.va.activeRange,this.$.xa.oa);if(!O)return c.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;O=w.HelperMethods.Tw(new v.a(this.JR),0,this.JR.length,O,this.RWg);0>O&&(O=~O);return O%this.JR.length};
a.prototype.v4b=function(){if(this.QHb){if(!(this.QHb.QEa.toString()in this.L1)){c.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.QHb.QEa.toString()));return}this.L1[this.QHb.QEa.toString()].R9g(this.QHb.zm)}this.R_a=-1};a.prototype.iterateNext=function(){this.ZSf(!0)};a.prototype.Cwa=function(){this.ZSf(!1)};a.Vuc=function(O){return String.format("{0}{1}",O.range,O.sheetId)};tl.Object.defineProperties(a.prototype,
{veb:{configurable:!0,enumerable:!0,get:function(){return this.L1}},QHb:{configurable:!0,enumerable:!0,get:function(){return-1===this.R_a?null:this.JR[this.R_a]}},JR:{configurable:!0,enumerable:!0,get:function(){this.a6a||(this.Zda.sort(this.SWg),this.a6a=!0);return this.Zda}}});Object(y.a)(a,"VersionHistoryHighlightManager",null,[219,3])},1347:function(y,D,b){function a(x,t,z,r){this.Ahb=null;this.$=x;this.irg=t;this.aRa=z;this.bRa={};this.Fnb=r;this.r5h()}function d(){}b.r(D);y=b(0);var c=b(13),
k=b(9);d.gnh="ewa-vhr-rectinnerborder";Object(y.a)(d,"CssClassNames",null,[]);var n=b(59),l=b(43),f=b(217),u=b(105),v=b(20),m=b(336),A=b(1257);b.d(D,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.MJb=function(x){x?this.Nb.Yr(this.PJ):this.Nb.kl(this.PJ)};a.prototype.R2i=function(){this.MJb(!1);this.Nb.DIb(new m.a(null,n.d(this.$.oa)),this.PJ)};a.prototype.qej=function(x){if(this.aRa){var t=new m.a(l.D(x),n.d(this.$.xa.getItemByName(x.SheetName))),z=A.a.Vuc(t);if(z in this.aRa)if(z in
this.bRa){t=f.a.Gp(this.aRa[z]);z=this.bRa[z];for(var r in z)z[r].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",t.r,t.g,t.b,k.a.UNj);v.g(this.$).ha.Qa.wG(null);v.g(this.$).T1e(x,60,!0,u.a.aYi)}else c.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+z);else c.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+z)}else c.ULS.sendTraceTag(537150428,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.R9g=function(x){x=new m.a(l.D(x),n.d(this.$.xa.getItemByName(x.SheetName)));var t=A.a.Vuc(x);if(t in this.bRa)if(t in this.aRa){x=f.a.Gp(this.aRa[t]);t=this.bRa[t];for(var z in t)t[z].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",x.r,x.g,x.b,this.Fnb)}else c.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+t);else c.ULS.sendTraceTag(537150425,
0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+t)};a.prototype.r5h=function(){var x=this;this.Nb.uw(this.irg,[a.t4],!1,function(t,z){if(t&&t.range&&t.sheetId&&z){var r=new m.a(t.range,t.sheetId);r=A.a.Vuc(r);r in x.bRa||(x.bRa[r]={});x.bRa[r][t.paneType.toString()]=z;r in x.aRa?(t=x.aRa[r],r=f.a.Gp(t),z.style.borderColor=t,z.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",r.r,r.g,r.b,x.Fnb),t=document.createElement("div"),t.className=
d.gnh,z.appendChild(t)):c.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r)}else c.ULS.shipAssertTag(537150423,0,!!t,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),c.ULS.shipAssertTag(537150422,0,!t||!!t.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),c.ULS.shipAssertTag(537150421,0,!t||!!t.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),
c.ULS.shipAssertTag(537150420,0,!!z,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};tl.Object.defineProperties(a.prototype,{PJ:{configurable:!0,enumerable:!0,get:function(){return[a.t4]}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.Ahb||(this.Ahb=v.g(this.$).Nb)}}});a.t4=23;Object(y.a)(a,"RangeVersionHistoryHighlightView",null,[252])},1385:function(y,D,b){function a(xc){var dd=Df.call(this)||this;dd.$=xc;dd.dc();return dd}function d(xc,dd,Cd,Ld){var Od=this;
Cd=void 0===Cd?null:Cd;Ld=void 0===Ld?null:Ld;this.iGa=null;this.W3e=!1;this.oBf=function(ef){Od.uZa.Lgj();Od.uZa.Vvc(!0);Rd.a.yj(ef.wywaActivities)||2===ef.wywaActivities[0].type||Od.uZa.r0h(ef.wywaActivities[0])};this.$=xc;this.uZa=new N(this.$);this.i0d=new ca($a.AFrameworkApplication.Eb,ze.EwaSettings.la(470));xc=tc.a.DCj(xg.a.instance.mc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.shf=Ld;this.tue=new v(this.$,this,xc,this.p5a());this.sue=new U(this.$,$a.AFrameworkApplication.Eb);
this.emptyCatchUpBehaviorManager=new u(this.$);this.Vki(function(ef){Od.Gzi(ef)},dd);this.Nmi();dd=null;Cd||(dd=xg.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=Cd||new n(dd);this.flyoutFocus=new l(this.$,this.flyoutRibbonButton)}function c(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=
this.activityNavigationManager=this.activityContentManager=null}function k(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function n(xc){this.buttonClickedCallback=null;this.Yhb=this.Exb=!1;this.oxh=new Date;this.pRe=xc}function l(xc,dd){this.$=
xc;this.flyoutRibbonButton=void 0===dd?null:dd;wc.a(this.$).Tg(this);this.hasFocus=!1}function f(xc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+xc)}function u(xc){this.$=xc}function v(xc,dd,Cd,Ld){Ld=void 0===Ld?!1:Ld;this.$=xc;this.catchUpActivityManager=dd;this.uue=Cd;this.bEb=xg.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.Voc=xg.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.p5a=Ld}function m(){var xc=
r.call(this)||this;xc.relationship=0;return xc}function A(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function x(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function t(){this.activityFeedItems=null}function z(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function r(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function G(xc,dd,Cd,Ld,Od,ef,Xf){Xf=xc.Oa(1,void 0===Xf?null:Xf);Xf.getRelevantActivitiesDataRequest=dd;return cb.i(xc,"GetRelevantActivitiesData",Xf,Cd,Ld,Od,ef,0)}function w(xc,dd,Cd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,"GetLineageWywaAuthors",ef,dd,Cd,Ld,Od,4)}function B(){}function U(xc,dd){this.$=xc;this.Di=dd}function N(xc){var dd=
this;this.pQa=this.n2b=this.rea=null;this.s4={};this.ICa=null;this.Rhd=!1;this.rCb=function(Cd,Ld){switch(Ld.state){case 0:case 1:3===Ld.FCd&&(dd.J_h(),dd.pQa=null);break;case 2:break;case 3:dd.H4c();dd.pQa=Ld.activityId;dd.Grj();break;default:ec.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Ld.state)}};this.Zk=function(){dd.Oqb()};this.kd=function(){dd.Oqb()};this.Wo=function(){dd.Oqb()};this.Mj=function(){dd.Oqb()};
this.QZf=function(Cd,Ld){dd.rea&&Ld.YG!==dd.Aja&&(Ld.isSticky&&dd.S4b(!0),(Cd=dd.mFj(Ld.YG))?(dd.rea.createActivityIndicatorTooltip(Object.assign(new W,{target:Ld.YG,container:Cd,activityIds:[Ld.activityId],isSticky:Ld.isSticky,dirHint:dd.gridView.rtl?12:9})),Ld.isSticky?(dd.Aja=Ld.YG,ec.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(dd.wcc=Ld.YG,ec.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
dd.Rec||(dd.gridView.view.it(dd.nzc),dd.gridView.Nq(dd.nzc),dd.Rec=!0)):ec.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.xFe=function(Cd,Ld){dd.S4b(Ld.$ah)};this.nzc=function(){dd.rea?(dd.Aja&&dd.rea.updateActivityIndicatorTooltip(Object.assign(new P,{target:dd.Aja,isSticky:!0})),dd.wcc&&dd.rea.updateActivityIndicatorTooltip(Object.assign(new P,{target:dd.Aja,isSticky:!1}))):ec.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
this.$=xc;this.gridView=Bc.g(this.$);this.ha=this.gridView.ha;this.qb=this.gridView.Kc;this.ha.GXb(this.Zk);this.ha.jG(this.kd);this.gridView.DD(this.Wo);this.qb.wm(this.Mj);this.Aja=this.wcc=null;this.Rec=!1;this.x$c={}}function P(){this.target=null;this.isSticky=!1}function ia(){this.clearSticky=!1}function W(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function R(){this.m0c=[];this.cJb={};this.die={}}function I(xc,dd,Cd,Ld,Od){xc=Q.call(this,xc,dd,Cd,Ld)||
this;xc.ranges=Od;xc.a6a=!1;return xc}function Q(xc,dd,Cd,Ld){var Od=lf.call(this)||this;Od.$=xc;Od.xZd=dd;Od.Vfg=Cd;Od.AB=Ld;Od.state=0;return Od}function O(xc,dd,Cd){Cd=rf.call(this,xc,dd,Cd)||this;Cd.gridView=Bc.g(xc);Cd.Vla=dd;return Cd}function ba(xc){var dd=this;this.rCb=function(){switch(dd.Hu.model.state){case 1:dd.U_f(!0);break;case 0:dd.MJb(!1);break;case 2:case 3:dd.MJb(!0);break;default:ec.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
dd.Hu.model.state)}};this.wlg=xc;this.Hu.qke(this.rCb);this.yaa=[]}function ca(xc){this.Di=xc}function S(xc){return fd.call(this,xc)||this}function Y(xc,dd){this.$=xc;this.catchUpActivityManager=dd}function ma(){this.rb=null}function Z(xc){this.NI=xc}function xa(xc){this.dpg=xc}function na(xc){this.AWa=xc;this.P8d=new Pg.a}function pa(xc,dd,Cd){this.hog=xc;this.QTa=dd;this.dUa=Cd}function Ia(xc,dd,Cd){xc=vg.call(this,xc,dd)||this;xc.DocumentId=null;xc.DocumentId=Cd;return xc}function Ma(xc,dd){this.Og=
xc;this.NI=dd}function lb(xc,dd,Cd,Ld,Od,ef,Xf){this.B8=this.SLc=this.RLc=this.lfa=this.Ejb=this.MDa=this.uPb=this.ZF=null;this.n$d=0;this.NTb=null;this.eib=!1;this.BMc=this.h_d=null;this.D4d=this.A4d=!1;this.O_d=null;this.X4d=!1;this.Vg=xc;this.hc=dd;this.TF=Cd;this.Ie=Ld;this.La=void 0===Od?null:Od;this.eCa=void 0===ef?null:ef;this.xD=void 0===Xf?null:Xf;this.La.$b(Tf.a.eie,de.a.frame,qg.ActionManager.$f)}function zb(xc){var dd=Zf.call(this)||this;dd.$=xc;dd.dc();return dd}function Ya(xc,dd){var Cd=
this;this.Vnd=!1;this.Kf=function(){Cd.Q6f()};this.$=xc;ze.EwaSettings.la(641)&&this.$.fa.P6a&&!Ya.Bvb&&(dd&&!dd.ocb||this.KNj(),Ya.Y3e?ec.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):dd&&!dd.ocb||this.QNj());ec.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Wb(xc){var dd=og.call(this)||this;dd.ti=null;dd.ah=null;dd.$=xc;dd.dc();return dd}function Zb(xc,
dd,Cd){var Ld=bg.call(this,xc)||this;Ld.ke=null;Ld.Vwe=null;Ld.vCb=null;Ld.snd=!0;Ld.nr=0;Ld.ep=!1;Ld.qd=function(Od,ef){ef.Qg||Ld.p_c()};Ld.Zj=function(){Ld.p_c();return!0};Ld.$=dd;Ld.taskPaneManager=Cd;Ld.$.Vl(Ld.qd);wc.a(Ld.$).Tg(Ld);sf.a.Gd(Ld.$)&&(Ld.isVisible=!1);return Ld}function da(xc){var dd=Rc.call(this)||this;dd.lineageTaskPane=null;dd.R6=null;dd.$=xc;dd.dc();return dd}function za(xc,dd,Cd,Ld){var Od=this;this.ssb=this.QE=null;this.zD=this.prd=0;this.vCb=function(){Od.R6&&(Od.R6.stop(),
Od.R6=null);Od.CJb.start();Od.QE.createLineagePane(Od.krd,Od.ssb)};this.lineageOpenPaneOrChangeFilterRequest=function(ef,Xf){function Qf(Ec,od,Md){var He=Od.$.qa.ta,Qe=Ob;Ec=re.b(Ec,Od.vdd("LineageOpenPaneOrChangeFilter"));od=re.a(od,gg);var Bf=He.Oa(1,null);Bf.clientParams=Ba;Bf.lineageFilter=Qe;return cb.i(He,"LineageOpenPaneOrChangeFilter",Bf,Ec,od,Md,null,0)}function gg(Ec){Ec=hc.a.yg(Ec.data);ec.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",
Pd.a.Uc(Ec))}Od.CJb.stop();ye.b(Od.$).ae(ue.a.tGi,{});Od.Ytj();var Ba=Object.assign(new Lb,{ClientViewCapacity:ef.clientViewCapacity}),Ob=null;Xf&&(Ob=Object.assign(new Ra,{FilterSheetMultiRange:Od.gEj(Xf.filterSheetMultiRange)}));ze.EwaSettings.tc()?Od.$.userOperationManager.ic(new le.a(1010,0,Qf,80),null):Od.$.userOperationManager.ic(new Be.a(1010,0,Qf,16),null)};this.lineageLoadMoreRequest=function(ef){function Xf(gg,Ba,Ob){var Ec=Od.$.qa.ta;gg=re.b(gg,Od.vdd("LineageLoadMore"));Ba=re.a(Ba,Qf);
var od=Ec.Oa(1,null);od.fetchFromBelow=ef;return cb.i(Ec,"LineageLoadMore",od,gg,Ba,Ob,null,0)}function Qf(gg){gg=hc.a.yg(gg.data);ec.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Pd.a.Uc(gg))}ye.b(Od.$).ae(ue.a.sGi,{});ze.EwaSettings.tc()?Od.$.userOperationManager.ic(new le.a(1011,0,Xf,80),null):Od.$.userOperationManager.ic(new Be.a(1011,0,Xf,16),null)};this.lineageRefreshViewRequest=function(){function ef(Qf,gg,Ba){var Ob=Od.$.qa.ta;Qf=re.b(Qf,
Od.vdd("LineageRefreshView"));gg=re.a(gg,Xf);var Ec=Ob.Oa(1,null);return cb.i(Ob,"LineageRefreshView",Ec,Qf,gg,Ba,null,0)}function Xf(Qf){Qf=hc.a.yg(Qf.data);ec.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Pd.a.Uc(Qf))}ye.b(Od.$).ae(ue.a.uGi,{});ze.EwaSettings.tc()?Od.$.userOperationManager.ic(new le.a(1012,0,ef,80),null):Od.$.userOperationManager.ic(new Be.a(1012,0,ef,16),null)};this.lineageUpdateViewRequest=function(){Sa(Od.$.qa.ta,function(ef){if(ef=
xd.a(ef)?null:ef.Result){var Xf={};Xf=(Xf.CountOfUpdatedActivities=ef.LineageActivitiesResponse.ActivityList.length,Xf);ye.b(Od.$).ae(ue.a.vGi,Xf);ef=Object.assign(new sb,{activityList:Od.YCd(ef.LineageActivitiesResponse.ActivityList),latestActivityId:ef.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:ef.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:ef.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(ef.LineageActivitiesResponse.EcmaLastSearchedDate),
hasNewActivities:ef.HasNewActivities,filterSheetMultiRange:Od.XDj(ef.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:ef.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:ef.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:ef.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:ef.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(ef.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:Od.yub(ef.LineageActivitiesResponse.EolPersonHideHistory)});
Od.QE.onLineageActivitiesUpdateResponse(ef)}else ec.ULS.shipAssertTag(537155475,0,!!ef,"LineageManager.LineageUpdateView returned null response.")},function(ef){ef=hc.a.yg(ef.data);ec.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Pd.a.Uc(ef))},null,null)};this.onCardSelected=function(ef,Xf){if(ef=ef.rangeHighlightLocation){if(Xf){var Qf=Ce.Z(Xf,null);var gg=Qf.range;if(Qf.returnValue){Od.K5e(ef.sheetName,Od.Eub([Ce.j(gg)]));return}ec.ULS.shipAssertTag(537155472,
0,!1,"The produced subCellLocation string "+Xf+" is not valid.")}ef.rangeList.length?Od.K5e(ef.sheetName,ef.rangeList):Od.s0h(ef.sheetName)}};this.onLearnMoreLinkClicked=function(){if(ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var ef=new Bd.a(-859308420,ie.a.Wb,Od.$.ed,12,null),Xf={};Xf=(Xf[ie.a.Kg]="HelpID=XLO_LineageTS",Xf.InputMethod=ie.a.Wb,Xf[ie.a.hd]=je.a.WU,Xf.ShouldCanvasTakeFocus=!0,Xf);Od.$.Ka.Zb(ef,Xf)}};this.onVersionHistoryButtonClicked=function(ef){Od.$.Ka.Zb(new Bd.a(-1112508866,
ef,Od.$.ed,12,null))};this.isFeatureEnabled=function(){return!1};this.Kf=function(){var ef=Od.$.fa.yn.LineageVersion;ef!==Od.prd&&(ec.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",ef,Od.prd),Od.prd=ef,Od.Q_i())};this.Zc=function(ef,Xf){Od.QE&&!Od.lineageTaskPane.lfc&&Xf.aH&&(ec.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),Od.onStaleActivitiesDetected())};this.vq=function(){Od.QE&&!Od.lineageTaskPane.lfc&&
(ec.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Od.onStaleActivitiesDetected())};this.AC=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.aya=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.Imc=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.onPaneClosed=function(){Od.QE.onPaneClosed();Da(Od.$.qa.ta,null,function(ef){ef=hc.a.yg(ef.data);ec.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",
Pd.a.Uc(ef))},null,null)};this.onRangeFilterInputEnabled=function(ef){ef?Od.gridView.ha.j2(Od.kd):Od.gridView.ha.Nca(Od.kd)};this.kd=function(){var ef=Ce.q(Od.gridView.ha.va.activeRange,Od.$);ef=Object.assign(new Sb,{rangeList:Od.Eub(ef.Ranges),sheetName:ef.SheetName});Od.QE.onSelectedRangeUpdated(ef)};this.tryParseRangeInfo=function(ef){var Xf=Ce.Z(ef,Od.$.xa);var Qf=Xf.sheetName;ef=Xf.range;return Xf.returnValue?(Qf||(Qf=Od.$.xa.oa.sheetName),Xf=[],Xf.push(ef),ef=Ce.u(Qf,null,Xf),Object.assign(new Sb,
{rangeList:Od.Eub(ef.Ranges),sheetName:ef.SheetName})):null};this.kz=function(){var ef=Od.zD!==Od.$.fa.rf;Od.QE&&Od.lineageTaskPane.isVisible&&ef&&(Od.zD=Od.$.fa.rf,Od.QE.onRefreshRequired())};this.$=xc;dd.Ha(366,this);this.gridView=Bc.g(this.$);this.lineageTaskPane=Cd;this.krd=this.lineageTaskPane.ZL();this.batchSize=50;this.R6=Ld;this.CJb=this.$.Ub.Xh("UserAction","LineagePaneLoadingShimmerStopWatch");this.Voc=xg.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Q4h();this.uwg()}
function hb(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Gb(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function Sb(){this.sheetName=this.rangeList=null}function Fb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function wa(){this.logger=
this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function va(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function sa(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=
null}function sb(){var xc=Tb.call(this)||this;xc.hasNewActivities=!1;xc.filterSheetMultiRange=null;return xc}function Tb(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Da(xc,dd,Cd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,
"LineageClosePane",ef,dd,Cd,Ld,Od,0)}function Sa(xc,dd,Cd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,"LineageUpdateView",ef,dd,Cd,Ld,Od,0)}function Ra(){}function Lb(){}function Ja(xc){var dd=Bg.call(this)||this;dd.$=xc;dd.dc();return dd}function wb(xc){this.ocb=!0;wb.V9e()?wb.a$e()?this.ocb=xc:this.ocb=!1:this.ocb=!0}function Mb(xc){return ag.call(this,xc)||this}function Eb(xc,dd){this.$=xc;this.lineageManager=dd;xc=[new Lf.a($b.a.mrd,1038647878,0,0,2168),new Lf.a($b.a.idle,1038647878,
0,1)];Bb.a(this.$).kFd(new Hf.a($b.a.lrd,$b.a.idle,xc),new Ic($b.a.mrd,$b.a.idle,dd))}function Ic(xc,dd,Cd){xc=Ig.call(this,xc,dd)||this;xc.lineageManager=Cd;return xc}function Zc(xc){var dd=Xd.call(this)||this;dd.$=xc;dd.dc();return dd}function Pc(xc){return Xc.call(this,xc)||this}function vd(xc){var dd=this;this.baseVersionInfo=this.b3=this.boa=this.nm=this.ewaAccessibilityManager=this.ULb=null;this.GFd=this.sof=!1;this.SCe=!0;this.dialog=this.jB=this.fRe=this.ZC=this.YWd=this.WWd=this.XWd=null;
this.lyf=function(Cd){ec.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(dd.Qqj()){var Ld=function(ef){Wa.c(2138207060,!1);dd.nm.setRestoreFailedAtServer(ef)};dd.ZC&&dd.ZC.startTimer(vd.v5f);var Od=function(){dd.ZC.endTimer(vd.v5f);dd.mue(dd.ZC)};dd.nm.setRestoreInProgress();Jf.a(dd.$).Rs(new oc.a($b.a.Qy,5,function(){var ef=Bb.a(dd.$).nd.activityState;ef[Cb.a.Kq]=$b.a.exe;ef[Lc.a.WX]=!0;ef[Lc.a.$S]=0;ef[Ga.Dbg]=Cd;ef[Ga.cpc]=$a.AFrameworkApplication.hj;
ef[Ga.wsd]=Od;ef[bb.m0f]=Ld}))}else Wa.c(2138207060,!1)};this.XAf=function(Cd){dd.ULb.then(function(Ld){Ld.enterFocusTrapZone();return null});ec.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");dd.ZC.endTimer(vd.RSd);dd.ZC.incrementCounter(vd.e_g);ec.ULS.sendTraceTag(537150348,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",dd.ZC.getTimerDuration(vd.RSd));dd.j9i(Cd.containerDiv);Cd.versions&&0<Cd.versions.length&&(dd.fRe=
vd.tE(Cd.versions[Cd.versions.length-1]));dd.b3&&dd.boa&&dd.JKd(dd.b3);ec.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(Cd){ec.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",vd.tE(Cd.currentVersion),vd.tE(dd.b3));dd.ZC.incrementCounter(vd.d_g);dd.b3=Cd.currentVersion;dd.baseVersionInfo=Cd.baseVersion;dd.sof=Cd.noBaseToCompareTo;dd.boa&&dd.mNj()&&(dd.JKd(Cd.currentVersion),
ec.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Tsf=function(Cd){ec.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===Cd||void 0===Cd?0:Cd.versionSelected)?vd.tE(Cd.versionSelected.currentVersion):null,(null===Cd||void 0===Cd?0:Cd.updatedVersions)?Cd.updatedVersions.length:0,vd.tE(dd.b3));dd.ZC.incrementCounter(vd.c_g);if(dd.baseVersionInfo){if((null===
Cd||void 0===Cd?0:Cd.updatedVersions)&&2<=Cd.updatedVersions.length){var Ld=null,Od=null,ef=vd.tE(dd.b3),Xf=vd.tE(dd.baseVersionInfo);Cd=yl(Cd.updatedVersions);for(var Qf=Cd.next();!Qf.done;Qf=Cd.next()){Qf=Qf.value;var gg=vd.tE(Qf);ef===gg?Ld=Qf:Xf===gg&&(Od=Qf);if(Ld&&Od)break}Ld&&Od?(dd.b3=Ld,dd.baseVersionInfo=Od,ec.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",vd.tE(dd.b3),
vd.tE(dd.baseVersionInfo)),dd.JKd(dd.b3)):ec.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",ef,Xf)}else ec.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");ec.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else ec.ULS.sendTraceTag(537150336,
0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Vrf=function(){ec.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");dd.aVg();var Cd=new Bd.a(1470556788,0,dd.$.ed,0,null);dd.$.Ka.Zb(Cd)};this.Cyf=function(Cd){ec.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var Ld=new Bd.a(-1244760097,0,dd.$.ed,0,null);dd.$.ig.get(51)&&(ec.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),
Ld=new Bd.a(-309686558,0,dd.$.ed,0,null));Wa.c(1604651619,!0);var Od={};dd.$.Ka.Zb(Ld,(Od.FileDownloadUrl=Cd,Od))};this.Usf=function(Cd){ec.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");Cd=new qd.QueryStringBuilder(Cd);Cd.Ei("fn",$a.AFrameworkApplication.fileName);ec.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Cd.toString().length);8===dd.$.frame.E7a(Cd.toString(),!0)?(ec.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),
Wa.c(1316171850,!1)):Wa.c(1316171850,!0)};this.xqf=function(Cd){dd.nm.setFullAppErrorCode(Cd)};this.fuf=function(Cd){switch(Cd){case 101:Cd="VHFailedToGetDownloadToken";break;case 100:Cd="VHFailedToLoadVersionList";break;case 104:Cd="VHVersioningNotEnabled";break;case 105:Cd="VHFileNotFound";break;case 106:Cd="VHVersionTooOld";break;default:Cd="None"}dd.ZC.addEvent("OnFullAppError",Cd);ec.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",Cd)};this.tzd=function(Cd){dd.SCe=Cd;ec.ULS.sendTraceTag(537150290,
0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",Cd.toString());var Ld={};dd.fLd(hd.a.yLb,(Ld.ToggleValue=Cd,Ld))};this.wvf=function(Cd){ec.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",Cd);Wa.c(1488635506,!0);var Ld={};Cd?dd.fLd(hd.a.iterateNext,Ld):dd.fLd(hd.a.Cwa,Ld)};this.oFb=function(Cd){switch(Cd.MessageId){case Ie.a.gTa:ec.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");ze.EwaSettings.la(436)&&
dd.nm.setVersionLoadComplete();break;case Ie.a.hTa:ec.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case hd.a.setCurrentChangeCount:Cd=Cd.Values.count;ec.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",Cd);dd.nm.setCurrentChangeCount(Cd);break;case hd.a.setTotalChangesCount:Cd=Cd.Values.count;ec.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",
Cd);dd.nm.setTotalChangesCount(Cd);break;case hd.a.gOa:dd.tzd(dd.SCe);break;default:ec.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",Cd.MessageId)}};this.$=xc;this.f7b=this.$.Ib+vd.Hrh;this.FFd=!1;ze.EwaSettings.la(396)&&this.l6g();this.Azb="";this.Cqd=0;this.perfTelemetryInfos=[]}function Tc(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function rb(){this.appName=0;
this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.wdEnableDownloadVersion=this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=
null}function eb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function Ta(){this.rootDiv=this.appBootSettings=null}function fb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function pb(xc){this.jw=xc}function rc(xc){this.jw=xc}function vb(xc){this.jw=xc}function E(){}function Nb(xc,dd){this.$=xc;this.XNj=dd}function ka(xc,dd){var Cd=uc.call(this)||this;Cd.activityName=xc;Cd.$L=dd;Cd.dc();return Cd}function bb(xc,dd){return Hc.call(this,
xc,dd)||this}function Ha(xc,dd,Cd){var Ld=Jb.call(this)||this;Ld.activityName=xc;Ld.$L=dd;Ld.vJ=Cd;Ld.dc();return Ld}function Ga(xc,dd,Cd,Ld,Od){var ef=db.call(this,xc,dd)||this;ef.vi=null;ef.retryCount=0;ef.gJi=function(Xf){var Qf=ef.oFj(Xf);Xf=Qf.UId;Qf.returnValue?Xf.Success?(Wa.c(2138207060,!0),ec.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Wa.c(2138207060,!1),ec.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",
Xf.Output),ef.ph(ef.vJ)):(Wa.c(2138207060,!1),ef.ph(ef.vJ));(Xf=ef.vi.activityState[Ga.wsd])&&Xf();ef.Uo();ef.vi.kJ()};ef.eJi=function(){if(0<ef.retryCount)ec.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",ef.retryCount),ef.retryCount--,ef.XPf();else{ec.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Wa.c(2138207060,!1);ef.ph(ef.vJ);var Xf=ef.vi.activityState[Ga.wsd];
Xf&&Xf();ef.Uo();ef.vi.kJ()}};ef.vJ=Cd;ef.G2=Ld;ef.baseUrl=Od;return ef}b.r(D);var Ua=b(10),jb=b(0),$a=b(5),Yb=b(216),ec=b(13),Za=b(111),Wa=b(176),Ca=b(38),db=Za.a;vm(Ga,db);Ga.prototype.execute=function(xc){this.vi=xc;this.retryCount=3;this.XPf();return 1};Ga.prototype.XPf=function(){var xc=this.vi.activityState[Ga.cpc],dd=this.vi.activityState[Ga.Dbg],Cd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");xc=Ca.c({VersionId:dd,QuerySignature:xc});this.G2.Ul(Cd,2,xc,{"Content-Type":"application/json; charset=utf-8"},
!1,2,this.gJi,this.eJi,null)};Ga.prototype.oFj=function(xc){var dd=null;xc=xc?xc.data?xc.data.fe:null:null;if(!xc||!xc.length)return ec.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,UId:dd};xc=Ca.d(xc);dd=xc.uu;return xc.returnValue?{returnValue:!0,UId:dd}:(ec.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),
{returnValue:!1,UId:dd})};Ga.Dbg="RVAvi";Ga.cpc="RVAqs";Ga.wsd="RVlvrt";Object(jb.a)(Ga,"RestoreVersionActivity",Za.a,[]);var $b=b(6),Jb=Yb.a;vm(Ha,Jb);Ha.prototype.create=function(){this.Fb(new Ga(this.activityName,this.$L,this.vJ,$a.AFrameworkApplication.Hd,$a.AFrameworkApplication.sa.Pa.g_))};Ha.ja=function(xc){xc.da.Ha(320,new Ha($b.a.XId,$b.a.lj,$b.a.YId))};Object(jb.a)(Ha,"RestoreVersionActivityFactory",Yb.a,[]);var Hc=Za.a;vm(bb,Hc);bb.prototype.execute=function(xc){var dd=this;(0,xc.activityState[bb.m0f])(function(){dd.Uo();
xc.kJ()});return 1};bb.m0f="RVEAssea";Object(jb.a)(bb,"RestoreVersionErrorActivity",Za.a,[]);var uc=Yb.a;vm(ka,uc);ka.prototype.create=function(){this.Fb(new bb(this.activityName,this.$L))};ka.ja=function(xc){xc.da.Ha(321,new ka($b.a.YId,$b.a.lj))};Object(jb.a)(ka,"RestoreVersionErrorActivityFactory",Yb.a,[]);var Aa=b(77),mb=b(817),dc=b(56),Ac=b(35),bd=b(175),Kd=b(370),Yd=b(55);Nb.prototype.Xc=function(){return $a.AFrameworkApplication.ga.ra("IsAnonymousUser")?(ec.ULS.sendTraceTag(537150415,0,15,
"Verison History Command Handler: Anonymous user."),!0):!1};Nb.prototype.executeCommand=function(xc,dd){ec.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");xc=!1;switch(dd.command){case -1112508866:Kd.a(this.$)&&this.$.da.Aa(423).Wvc(!1),xc=this.XNj.luj()}ec.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",xc);return xc?Yd.Task.Ta(xc):bd.a(dd.command)};Nb.prototype.Gc=function(xc,dd){return-1112508866===dd.command&&this.$.isVersionHistoryEnabled()};
Nb.prototype.fd=function(){return!1};Object(jb.a)(Nb,"VersionHistoryCommandHandler",null,[147]);var qd=b(277),Ie=b(170),cc=b(384),Qd=b(23);E.addAppPLTEventToLog=function(xc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(xc)}catch(dd){}};E.setIsPageLoadForFirstTime=function(xc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(xc)}catch(dd){}};Object(jb.a)(E,"VersionHistoryLogConnector",null,[]);var Wd=b(962),ee=b(1254),ne=b(148),Bd=b(92),Pd=
b(27),ze=b(1),Jf=b(39),oc=b(246),hd=b(1136),wc=b(256),gb=b(245),kd=b(11);vb.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};vb.prototype.s7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};vb.prototype.Ah=function(xc){return kd.DOMElementExtensions.Ye(this.Jb,xc)};vb.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};vb.prototype.Vh=function(){};vb.prototype.Qe=function(xc,dd){dd||this.jw.ULb.then(function(Cd){Cd.enterHeaderFocusTrapZone();
return null});return!dd};tl.Object.defineProperties(vb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Abg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(jb.a)(vb,"VersionHistoryHeader",null,[107]);rc.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};rc.prototype.s7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};
rc.prototype.Ah=function(xc){return kd.DOMElementExtensions.Ye(this.Jb,xc)};rc.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};rc.prototype.Vh=function(){};rc.prototype.Qe=function(xc,dd){dd||this.jw.ULb.then(function(Cd){Cd.enterFocusTrapZone();return null});return!dd};tl.Object.defineProperties(rc.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Bbg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(jb.a)(rc,"VersionHistoryPane",null,[107]);pb.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};pb.prototype.s7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};pb.prototype.Ah=function(xc){return kd.DOMElementExtensions.Ye(this.Jb,xc)};pb.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};pb.prototype.Vh=function(){};pb.prototype.Qe=function(xc,dd){dd||
this.jw.ULb.then(function(Cd){Cd.enterViewerFocusTrapZone();return null});return!dd};tl.Object.defineProperties(pb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Cbg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(jb.a)(pb,"VersionHistoryViewer",null,[107]);var Lc=b(133),Cb=b(248),Bb=b(64),Hb=b(414),Pb=b(889);Object(jb.a)(fb,"AppBootSettings",
null,[]);Object(jb.a)(Ta,"AppVersionControllerFactoryParameters",null,[]);Object(jb.a)(eb,"OnVersionSelectedParams",null,[]);Object(jb.a)(rb,"AppSettings",null,[]);Object(jb.a)(Tc,"ControllerFactoryParameters",null,[]);vd.prototype.dispose=function(){this.Vve()};vd.prototype.cSi=function(){var xc=this;this.$.da.Za(15,function(dd){xc.ewaAccessibilityManager=dd;xc.ewaAccessibilityManager.mode=2})};vd.prototype.l6g=function(){this.XWd=new rc(this);this.WWd=new vb(this);this.YWd=new pb(this)};vd.prototype.luj=
function(){var xc=this;ec.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.ZC=excelVersionHistory.FactoryGlobal.getTelemetryCollector();
this.perfTelemetryInfos=[];this.ZC.startTimer(vd.u5f);if(!this.nm&&(Hb.a(function(){xc.nm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Tc,{ulsLogger:new cc.a,docId:$a.AFrameworkApplication.hj,appSettings:Object.assign(new rb,{appName:120,userSessionId:$a.AFrameworkApplication.userSessionId,wdEnableSaveACopy:ze.EwaSettings.la(364),wdEnableDownloadTokens:ze.EwaSettings.la(359),wacCluster:$a.AFrameworkApplication.Hd.bS,uiLocale:$a.AFrameworkApplication.uiCulture||
"en-us",wdEnableRestore:ze.EwaSettings.la(330)&&xc.$.isEditMode,wdEnableIterator:ze.EwaSettings.la(327)&&ze.EwaSettings.la(328),useXhr:Qd.a.EM,wdEnableHiddenButtonsUntilVersionLoadComplete:ze.EwaSettings.la(436),disableSaveACopy:xc.LYf(),wdEnableShowVersionChanges:ze.EwaSettings.la(327)&&ze.EwaSettings.la(329),disabledChangeGates:xc.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:ze.EwaSettings.la(567),isRtl:$a.AFrameworkApplication.isRtl}),perfTelemetryInfos:xc.perfTelemetryInfos}))}),
!this.nm))return ec.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Wa.c(429638140,!1),!1;this.muj();this.ZC.endTimer(vd.u5f);this.ZC.startTimer(vd.x5f);ec.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Wa.c(429638140,!0);return!0};vd.prototype.muj=function(){this.ak();if(!document.getElementById(this.f7b)){var xc=document.createElement("div");xc.id=this.f7b;
xc.style.width="100%";xc.style.height="100%";xc.style.zIndex="998";xc.style.display="block";xc.style.position="absolute";this.$.Oq.insertBefore(xc,this.$.Oq.firstChild);this.ULb=this.nm.createVersionHistoryDialog(xc)}document.getElementById(this.f7b).style.display="block";this.xFd();this.ZC.startTimer(vd.RSd);this.nm.getVersions("")};vd.prototype.xFd=function(){ze.EwaSettings.la(396)&&(this.XWd.Tg(),this.WWd.Tg(),this.YWd.Tg(),this.cSi())};vd.prototype.SUd=function(){ze.EwaSettings.la(396)&&(this.XWd.s7(),
this.WWd.s7(),this.YWd.s7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};vd.prototype.ak=function(){this.nm.getVersionsReadyEvent().addListener(this.XAf);this.nm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.nm.getCloseSelectedEvent().addListener(this.Vrf);this.nm.getFullAppErrorEvent().addListener(this.fuf);this.nm.getIteratorSelectedEvent().addListener(this.wvf);this.nm.getShowVersionChangesToggledEvent().addListener(this.tzd);ze.EwaSettings.la(359)&&
(this.nm.getDownloadTokenReadyEvent().addListener(this.Tsf),this.FFd=!0);ze.EwaSettings.la(364)&&(this.nm.getSaveACopySelectedEvent().addListener(this.Cyf),this.nm.getDownloadVersionSelectedEvent().addListener(this.Usf));ze.EwaSettings.la(330)&&this.$.isEditMode&&(this.nm.getRestoreVersionSelectedEvent().addListener(this.lyf),this.GFd=!0);this.boa&&this.boa.getAppErrorEvent().addListener(this.xqf)};vd.prototype.mm=function(){this.nm.getVersionsReadyEvent().removeListener(this.XAf);this.nm.getVersionSelectedEvent().removeListener(this.onVersionSelected);
this.nm.getCloseSelectedEvent().removeListener(this.Vrf);this.nm.getFullAppErrorEvent().removeListener(this.fuf);this.nm.getIteratorSelectedEvent().removeListener(this.wvf);this.nm.getShowVersionChangesToggledEvent().removeListener(this.tzd);ze.EwaSettings.la(364)&&(this.nm.getSaveACopySelectedEvent().removeListener(this.Cyf),this.nm.getDownloadVersionSelectedEvent().removeListener(this.Usf));this.FFd&&(this.nm.getDownloadTokenReadyEvent().removeListener(this.Tsf),this.FFd=!1);this.GFd&&(this.nm.getRestoreVersionSelectedEvent().removeListener(this.lyf),
this.GFd=!1);this.boa&&this.boa.getAppErrorEvent().removeListener(this.xqf)};vd.prototype.Qqj=function(){var xc=!0;if(ze.EwaSettings.la(635)&&!this.$.tQ)return ec.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.fa.amIAlone.toString()),!0;if(!this.$.fa.amIAlone&&!ze.EwaSettings.la(326)){this.lmi();this.nm.setCoauthRestoreError();xc=!1;var dd=new Bd.a(-729359593,0,this.$.ed,0,null);this.$.Ka.Zb(dd)}this.$.tQ&&(ec.ULS.sendTraceTag(42522439,
0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),xc&&(xc=!1,this.huj()));return xc};vd.prototype.huj=function(){var xc=Pd.a.jd(1,0,1844,1843,0,-1603358883,"RestoreVersionUnsavedChangesError");xc=this.dialog||new ne.ErrorDialog(this.$,xc);xc.initialize();xc.nf()};vd.prototype.mNj=function(){ec.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?vd.tE(this.baseVersionInfo):"");
if(vd.tE(this.b3)===this.fRe)return ec.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.sof)return ec.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return ec.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),
!1;var xc=vd.FHh(this.baseVersionInfo);ec.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",xc?xc.length:0);return xc?!0:(ec.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};vd.prototype.LYf=function(){return!this.$.Yja};vd.prototype.aVg=function(){document.getElementById(this.f7b).style.display="none";var xc=new Bd.a(-1423792966,0,this.$.ed,0,null);this.$.Ka.Zb(xc);this.Vve()};vd.prototype.Vve=function(){this.ZC&&(this.ZC.endTimer(vd.x5f),
this.mue(this.ZC),this.ZC=null);this.mm();this.SUd();this.perfTelemetryInfos&&(ec.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.jB&&(this.jB.Sna(Ie.a.gTa),this.jB.Sna(Ie.a.hTa),this.jB.Sna(hd.a.setCurrentChangeCount),this.jB.Sna(hd.a.setTotalChangesCount),ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Sna(hd.a.gOa),this.jB.dispose(),this.jB=null)};vd.prototype.j9i=function(xc){var dd=
this;try{this.boa?E.setIsPageLoadForFirstTime(!1):(E.setIsPageLoadForFirstTime(!0),Hb.a(function(){var Cd=new fb;Cd.ulsLogger=new cc.a;Cd.actionUrl=dd.$.ya.VersionHistoryActionUrl;Cd.hideEmbedFooter=!0;Cd.useFetch=ze.EwaSettings.la(428)&&!Qd.a.Ku;dd.boa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new Ta,{appBootSettings:Cd,rootDiv:xc}))}))}catch(Cd){ec.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",
Cd)}};vd.prototype.JKd=function(xc){ec.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",vd.tE(xc),this.Azb);if(xc)if(vd.tE(xc).length){var dd=(new Date).getTime();if(vd.tE(xc)===this.Azb&&1E3>dd-this.Cqd)ec.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{vd.tE(xc)!==this.Azb&&(ec.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),
this.nm.setTotalChangesCount(-1),this.nm.setCurrentChangeCount(-1));var Cd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();Cd.addEvent("SelectVersion",vd.tE(xc));try{this.UPj(Cd);this.Cqd=dd;this.Azb=vd.tE(xc);var Ld=new eb;Ld.selectedVersionInfo=this.b3;Ld.baseVersionInfo=this.baseVersionInfo;Ld.telemetryCollector=Cd;this.boa.onVersionSelectedWithParams(Ld);this.nm&&ze.EwaSettings.la(364)&&this.nm.setDisableSaveACopy(this.LYf());var Od=document.getElementById(vd.Grh);Od&&!this.jB&&(ec.ULS.sendTraceTag(537150293,
0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.jB=new hd.a(Od.contentWindow,Aa.a.laa(this.$.ya.VersionHistoryActionUrl)||Pb.a.r9),this.jB.Km(Ie.a.gTa,this.oFb),this.jB.Km(Ie.a.hTa,this.oFb),this.jB.Pn(hd.a.setCurrentChangeCount),this.jB.Pn(hd.a.setTotalChangesCount),ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Pn(hd.a.gOa),this.jB.Km(hd.a.setCurrentChangeCount,this.oFb),this.jB.Km(hd.a.setTotalChangesCount,
this.oFb),ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Km(hd.a.gOa,this.oFb))}catch(ef){this.Cqd=0,this.Azb="",Cd.addEvent("Exception",ef.toString()),ec.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",ef)}finally{ec.ULS.sendTraceTag(537150292,0,50,Cd?Cd.getJsonForLogging():"")}}}else ec.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");
else ec.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};vd.prototype.UPj=function(xc){for(var dd=yl(this.perfTelemetryInfos),Cd=dd.next();!Cd.done;Cd=dd.next()){var Ld=Cd.value;Cd=Ld.TelemetryEventKey?Ld.TelemetryEventKey:Ld.telemetryEventKey?Ld.telemetryEventKey:"";Ld=Ld.TelemetryEventData?Ld.TelemetryEventData:Ld.telemetryEventData?Ld.telemetryEventData:"";Cd&&Ld&&xc.addEvent(Cd,Ld)}Array.clear(this.perfTelemetryInfos)};vd.prototype.mue=function(xc){ec.ULS.sendTraceTag(42553886,
0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",xc?xc.getJsonForLogging():"")};vd.prototype.lmi=function(){for(var xc=this.$.fa.Em,dd={},Cd=null,Ld=yl(xc),Od=Ld.next();!Od.done;Od=Ld.next())Od=Od.value,Od.UserEmail&&(dd[Od.UserEmail]=Od.UserEmail in dd?dd[Od.UserEmail]+1:1),Od.User.UserID===this.$.fa.clientId&&(Cd=Od.UserEmail);ec.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",xc.length,Cd?
dd[Cd]:-1)};vd.prototype.fLd=function(xc,dd){ec.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",xc);if(this.jB){xc=new Wd.a(xc);xc.Values[ee.a.p3c]=this.$.ya.UserSessionId;if(dd)for(var Cd in dd)xc.Values[Cd]=dd[Cd];this.jB.send(xc)}else ec.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};vd.tE=function(xc){return xc?xc.RevisionID?xc.RevisionID:xc.revisionID?xc.revisionID:
"":""};vd.FHh=function(xc){return xc?xc.DownloadUrl?xc.DownloadUrl:xc.downloadUrl?xc.downloadUrl:"":""};vd.Hrh="_excelVersionHistoryOverlay";vd.Grh="vhs_frame";vd.u5f="TimeTakenShowVersionHistoryDialogAction";vd.x5f="TimeTillVersionHistoryDialogWasOpenMs";vd.RSd="TimeTakenGetVersionsToOnVersionsReady";vd.d_g="CountOnVersionSelectedCalledinOneVHSession";vd.e_g="CountOnVersionsReadyCalledinOneVHSession";vd.c_g="CountOnDownloadTokenReadyCalledinOneVHSession";vd.v5f="TimeTakenVersionRestore";Object(jb.a)(vd,
"VersionHistoryPaneActor",null,[3]);var ed=b(335),Xc=mb.a;vm(Pc,Xc);Pc.prototype.Md=function(){var xc=this,dd=this.zli(),Cd=dc.GetServiceTaskFactory.Xa(this.$.da,21,137,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([dd,Cd],this.ma,3),function(){var Ld=Cd.result,Od=Aa.a.laa(xc.$.ya.VersionHistoryActionUrl);Od!==Pb.a.r9&&Ld.TEa(Od);Ld=new vd(xc.$);xc.Ed([new Nb(xc.$,Ld)])},this.ma,3)};Pc.prototype.zli=function(){var xc=dc.GetServiceTaskFactory.nac(this.$.da,283,284,this.tb).then(function(dd){return dd.wo.loadScript("excelVersionHistory")},
function(dd){ec.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",dd);return Promise.reject(dd)});return ed.c(xc)};Pc.ja=function(xc){mb.a.de(304,new Pc(xc))};Object(jb.a)(Pc,"VersionHistoryCommandHandlerFactory",mb.a,[]);var ce=b(1257),Xd=Yb.a;vm(Zc,Xd);Zc.prototype.create=function(){var xc=this,dd=dc.GetServiceTaskFactory.Xa(this.$.da,211,212,this.tb),Cd=dc.GetServiceTaskFactory.Xa(this.$.da,21,137,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([dd,
Cd],this.$.ma),function(){xc.Fb(xc.$.da.Aa(305)||new ce.a(xc.$,!0,Cd.result,dd.result))},this.$.ma,3)};Zc.ja=function(xc){xc.da.Ha(306,new Zc(xc))};Object(jb.a)(Zc,"VersionHistoryHighlightManagerFactory",Yb.a,[]);var nd=b(514),je=b(4),Xe=b(164),Ne=b(14),Ig=Za.a;vm(Ic,Ig);Ic.prototype.execute=function(xc){this.lineageManager.lineageHidePreviousHistory();return Ig.prototype.execute.call(this,xc)};Object(jb.a)(Ic,"LineageClearHistoryConfirmedActivity",Za.a,[]);var Lf=b(15),Hf=b(130);Eb.prototype.Xc=
function(){return!1};Eb.prototype.executeCommand=function(xc,dd,Cd){xc=!1;switch(dd.command){case 1834994092:9===dd.df&&this.Ezj();this.Crj(dd,Cd);xc=!0;break;case -409942531:this.Frj(),xc=!0}return xc?Yd.Task.Ta(!0):bd.a(dd.command)};Eb.prototype.Gc=function(xc,dd){return 1834994092===dd.command||-409942531===dd.command};Eb.prototype.fd=function(){return!1};Eb.prototype.Crj=function(xc,dd){ec.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",dd.MenuItemId||
xc.df);this.lineageManager.H_f(19===xc.df&&!!dd.MenuItemId,dd.MenuItemId,xc.df)};Eb.prototype.Ezj=function(){var xc=je.a.rpc;xc!==Xe.a(this.$).Lm.qo&&Xe.a(this.$).Lm.activateRibbonTab(xc)};Eb.prototype.Frj=function(){var xc=this;Jf.a(this.$).Rs(new oc.a($b.a.lrd,5,function(){var dd=Bb.a(xc.$).nd,Cd=Pd.a.jd(3,1,2165,2166,2167,1038647878,"LineageConfirmClearHistory");Cd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";Cd.HelpDescription=Ne.a.instance.ea(1273);dd.ft([Cd])}))};Object(jb.a)(Eb,"LineageActivityCommandHandler",
null,[147]);var ag=mb.a;vm(Mb,ag);Mb.prototype.Md=function(){var xc=this;Ac.TaskExtensions.Ba(dc.GetServiceTaskFactory.Xa(this.$.da,366,367,this.tb),function(dd){xc.Ed([new Eb(xc.$,dd.result)])},this.ma,3)};Mb.ja=function(xc){mb.a.de(363,new Mb(xc))};Object(jb.a)(Mb,"LineageActivityCommandHandlerFactory",mb.a,[]);wb.prototype.p5a=function(){return!this.ocb};wb.a$e=function(){return wb.V9e()&&ze.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};wb.V9e=function(){return ze.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(jb.a)(wb,"LineageCatchUpExperimentManager",null,[433]);var Bg=Yb.a;vm(Ja,Bg);Ja.prototype.create=function(){var xc=this;wb.a$e()?Ac.TaskExtensions.Ba(dc.GetServiceTaskFactory.Xa(this.$.da,456,457,this.tb),function(dd){Ac.TaskExtensions.Ba(dd.result.hqj(),function(Cd){xc.TAe(Cd.result)},xc.$.ma,3)},this.$.ma,3):this.TAe(!0)};Ja.prototype.TAe=function(xc){this.Fb(this.$.da.Aa(458)||
this.$.da.Ha(458,new wb(xc)))};Ja.ja=function(xc){xc.da.Ha(459,new Ja(xc))};Object(jb.a)(Ja,"LineageCatchUpExperimentManagerFactory",Yb.a,[]);var uf=b(409),sf=b(41),xg=b(86),sc=b(143),Sc=b(116);Object(jb.a)(Lb,"LineageClientParams",null,[]);Object(jb.a)(Ra,"LineageFilter",null,[]);var Qc=b(59),ie=b(78),ue=b(125),Ce=b(43),Be=b(519),le=b(163),hc=b(126),gd=b(106),xd=b(302),re=b(273),Jc=b(105),Bc=b(20),ye=b(127),cb=b(81),nc=b(48),Nc=b(338);Object(jb.a)(Tb,"LineageActivitiesResponseDTO",null,[]);vm(sb,
Tb);Object(jb.a)(sb,"LineageActivitiesUpdateResponseDTO",Tb,[]);Object(jb.a)(sa,"LineageAppCallbacks",null,[]);Object(jb.a)(va,"LineageAuthorDTO",null,[]);Object(jb.a)(wa,"LineageControllerFactoryParams",null,[]);Object(jb.a)(Fb,"LineageSharedRangeDTO",null,[]);Object(jb.a)(Sb,"LineageSheetMultiRangeDTO",null,[]);Object(jb.a)(Gb,"LineageUserActivityDTO",null,[]);Object(jb.a)(hb,"LineageValueChangeDTO",null,[]);za.prototype.dispose=function(){this.G2i();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.xN(this.onPaneClosed),
this.lineageTaskPane.UC(this.kz),this.lineageTaskPane=null);this.CJb=this.Voc=this.ssb=this.krd=this.QE=null};za.prototype.H_f=function(xc,dd,Cd){if(this.lineageTaskPane.isVisible){if(9===Cd){ec.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!xc&&16!==Cd&&18!==Cd){this.lineageTaskPane.p_c();return}}sf.a.Gd(this.$)||(this.CJb.start(),this.R6&&(nc.b().CB(this.CJb.id,this.R6.id,"actions","actions"),this.R6.stop(),this.R6=
null));this.lineageTaskPane.lfc||ec.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",xc?dd:Cd);this.zD=this.$.fa.rf;this.ssb=null;xc&&(xc=Ce.r(this.gridView.ha.va.selectedRanges,this.$),this.ssb=Object.assign(new Sb,{rangeList:dd.toString()===je.a.b_f?this.Eub(xc.Ranges):null,sheetName:xc.SheetName}));sf.a.Gd(this.$)&&this.lineageTaskPane.lfc?this.lineageTaskPane.yjj(this.vCb):this.QE.createLineagePane(this.krd,this.ssb);this.lineageTaskPane.Lf(!0);
this.$.Ce(-71295319,-1,0,null)};za.prototype.lineageHidePreviousHistory=function(){function xc(Ld,Od,ef){var Xf=dd.$.qa.ta,Qf=Xf.Oa(1,null);return cb.i(Xf,"LineageHidePreviousHistory",Qf,Ld,Od,ef,null,0)}var dd=this,Cd={};Cd=(Cd.paneVisible=this.lineageTaskPane.isVisible,Cd);sc.a.sendTelemetryEvent(Object.assign(new Nc.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:Sc.a.Fk(Cd)}));ze.EwaSettings.tc()?this.$.userOperationManager.ic(new le.a(1018,0,xc,64),null):this.$.userOperationManager.ic(new Be.a(1018,
0,xc,0),null);this.lineageTaskPane.isVisible||this.H_f(!1,null,4)};za.prototype.Q4h=function(){var xc=this,dd=Object.assign(new sa,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});Hb.a(function(){xc.QE=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new wa,{clientBatchSize:xc.batchSize,filterableSheetList:xc.f3a(),uiCulture:xc.$.ya.UICultureTag,dataCulture:xc.$.ya.DataCultureTag,logger:new cc.a,lineageAppCallbacks:dd}))})};za.prototype.vdd=function(xc){var dd=this;return function(Cd){if(Cd=xd.a(Cd)?null:Cd.Result){var Ld=
{};Ld=(Ld.CountOfActivities=Cd.ActivityList.length,Ld);Ld.WebRequestName=xc;ye.b(dd.$).ae(ue.a.WDi,Ld);Cd=Object.assign(new Tb,{activityList:dd.YCd(Cd.ActivityList),latestActivityId:Cd.LastSearchedActivityId,oldestActivityId:Cd.FirstSearchedActivityId,serverMessageCode:Cd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Cd.EcmaLastSearchedDate),serverFirstActivityId:Cd.ServerFirstActivityId,serverLastActivityId:Cd.ServerLastActivityId,showLoadPrevious:Cd.ShowLoadPrevious,eolCorrelationId:Cd.EolCorrelationId,
eolDateHideHistory:new Date(Cd.EolDateHideHistory),eolPersonHideHistory:dd.yub(Cd.EolPersonHideHistory)});dd.QE.onLineageActivitiesResponse(Cd)}else ec.ULS.shipAssertTag(537155477,0,!!Cd,"LineageManager."+xc+" returned null response.")}};za.prototype.XDj=function(xc){return gd.e(xc.Ranges)&&!xc.SheetName?null:Object.assign(new Sb,{rangeList:this.Eub(xc.Ranges),sheetName:xc.SheetName})};za.prototype.Eub=function(xc){var dd=[];xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())Cd=Cd.value,Cd=Object.assign(new Fb,
{firstCol:Cd.FirstColumn,firstRow:Cd.FirstRow,lastRow:Cd.LastRow,lastCol:Cd.LastColumn}),dd.push(Cd);return dd};za.prototype.gEj=function(xc){if(!xc)return null;var dd={};dd.Ranges=this.ved(xc.rangeList);dd.SheetName=xc.sheetName;return dd};za.prototype.ved=function(xc){var dd=[];if(gd.e(xc))return dd;xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next()){Cd=Cd.value;var Ld={};Ld.FirstColumn=Cd.firstCol;Ld.FirstRow=Cd.firstRow;Ld.LastRow=Cd.lastRow;Ld.LastColumn=Cd.lastCol;dd.push(Ld)}return dd};za.prototype.s0h=
function(xc){(xc=this.$.xa.getItemByName(xc))&&xc.visible&&xc.activate(!0)};za.prototype.K5e=function(xc,dd){var Cd=[];dd=yl(dd);for(var Ld=dd.next();!Ld.done;Ld=dd.next()){Ld=Ld.value;var Od={};Od.FirstColumn=Ld.firstCol;Od.FirstRow=Ld.firstRow;Od.LastRow=Ld.lastRow;Od.LastColumn=Ld.lastCol;Cd.push(Ce.D(Od))}dd=Cd.length-1;Ld=Cd[dd].topLeft;Bc.g(this.$).OU(Cd,dd,xc,null,Ld,null,null,3,Jc.a.Eki,void 0,void 0,void 0,!0)};za.prototype.Q_i=function(){this.QE&&this.lineageTaskPane.isVisible&&(this.zD=
this.$.fa.rf,this.QE.onRefreshRequired())};za.prototype.uwg=function(){this.lineageTaskPane.CL(this.onPaneClosed);this.lineageTaskPane.EB(this.kz);this.$.fa.jt(this.Kf);this.$.fa.Sj(this.Zc);this.$.fa.aP(this.vq);var xc=this.$.xa;xc.YX(this.AC);xc.pga(this.Imc);xc.bFa(this.aya);xc.EXa(this.Imc)};za.prototype.G2i=function(){this.$.fa.mw(this.Kf);this.gridView.ha.Nca(this.kd);this.$.fa.kk(this.Zc);this.$.fa.lW(this.vq);var xc=this.$.xa;xc.w6(this.AC);xc.dma(this.Imc);xc.APa(this.aya);xc.iGb(this.Imc)};
za.prototype.onStaleActivitiesDetected=function(){this.QE.onStaleActivitiesDetected()};za.prototype.f3a=function(){for(var xc=[],dd=yl(this.$.xa.items),Cd=dd.next();!Cd.done;Cd=dd.next())Cd=Cd.value,Cd.visible&&!Qc.e(Cd)&&xc.push(Cd.sheetName);return xc};za.prototype.Ytj=function(){if(ze.EwaSettings.la(641)){var xc=this.$.da.Aa(403);xc&&xc.disable();xc=new Bd.a(-847286761,ie.a.Wb,this.$.ed,0,je.a.cW);var dd={};dd=(dd.InputMethod=ie.a.Wb,dd);dd.CalloutName=5;this.$.Ka.Zb(xc,dd)}};za.prototype.YCd=
function(xc){var dd=[];xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())Cd=Cd.value,Cd=Object.assign(new Gb,{activityId:Number.parseLocale(Cd.UserActivity.Id),activityGuid:Cd.Uid,activityType:Cd.UserActivity.Type,author:this.yub(Cd.UserActivity.Person),sheetName:Cd.SheetName,displayTimestamp:new Date(Cd.UserActivity.DisplayTimestamp),gridLocation:Cd.DisplayLocation,valueChanges:this.hVi(Cd.LineageValueChangeList),isBulkEditOverflow:Cd.IsBulkEditOverFlow,rangeHighlightLocation:this.WUi(Cd.UserActivity.LocationList,
Cd.UserActivity.Type),nestedActivityList:this.PUi(Cd.NestedActivityList),degradedCardTypeBits:Cd.DegradedCardTypeBits}),dd.push(Cd);return dd};za.prototype.WUi=function(xc,dd){if(!xc)return ec.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!xc.length)return ec.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var Cd=[],Ld=[],Od="";21===dd?Ld.push(xc[0]):Ld=xc;xc=yl(Ld);for(Ld=
xc.next();!Ld.done;Ld=xc.next())switch(Ld=Ld.value,Ld.Type){case 1:break;case 2:Od=Ld.SheetName;break;case 0:if(!Ld.RangeList){ec.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Od=Ld.RangeList[0].SheetName;var ef=[];21===dd?ef.push(Ld.RangeList[0]):ef=Ld.RangeList;Ld=yl(ef);for(ef=Ld.next();!ef.done;ef=Ld.next())ef=ef.value,ef=Object.assign(new Fb,{firstCol:ef.FirstColumn,firstRow:ef.FirstRow,lastRow:ef.LastRow,lastCol:ef.LastColumn}),
Cd.push(ef);break;default:ec.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Ld.Type)}return Object.assign(new Sb,{sheetName:Od,rangeList:Cd})};za.prototype.hVi=function(xc){var dd=[];xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())Cd=Cd.value,Cd=Object.assign(new hb,{hasNewValue:Cd.HasNewValue,hasOldValue:Cd.HasOldValue,newValue:Cd.HasNewValue?Cd.NewValue:null,oldValue:Cd.HasOldValue?Cd.OldValue:null,cellLocation:Cd.CellLocation}),
dd.push(Cd);return dd};za.prototype.PUi=function(xc){return xc?this.YCd(xc):null};za.prototype.yub=function(xc){if(!xc)return null;var dd=null;ze.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&$a.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(dd=this.Voc.dHa(xc.Email,xc.Provider,$a.AFrameworkApplication.hj,0));return Object.assign(new va,{id:xc.Id,provider:xc.Provider,displayName:xc.DisplayName,email:xc.Email,imageUrl:dd})};
Object(jb.a)(za,"LineageManager",null,[431,3]);var Rc=Yb.a;vm(da,Rc);da.prototype.jli=function(xc){var dd=this;Ac.TaskExtensions.Ba(xc,function(){dd.Fb(dd.$.da.Aa(366)||new za(dd.$,dd.$.da,dd.lineageTaskPane,dd.R6))},this.$.ma,3)};da.prototype.create=function(){var xc=this;this.R6=this.$.Ub.Fc("UserAction","LineagePaneSeenStopwatch");this.R6.start();var dd=dc.GetServiceTaskFactory.Xa(this.$.da,365,364,this.tb),Cd=uf.a(this.$),Ld=dc.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([dd,
Cd,Ld],this.$.ma),function(){xc.lineageTaskPane=dd.result;sf.a.Gd(xc.$)||Cd.result.rQ(xc.lineageTaskPane);xc.jli(ed.c(Ld.result.wo.loadScript("cellLineage")))},this.$.ma,3)};da.ja=function(xc){xc.da.Ha(367,new da(xc))};Object(jb.a)(da,"LineageManagerFactory",Yb.a,[]);var Wc=b(922),fe=b(276),ve=b(12),kc=b(117),ad=b(275),yd=b(91),wd=b(232),pe=b(16),bf=b(826),Af=b(63),bg=wd.a;vm(Zb,bg);Zb.prototype.hG=function(xc){this.get_events().addHandler("LineageTaskPaneRemove",xc)};Zb.prototype.MH=function(xc){this.get_events().removeHandler("LineageTaskPaneRemove",
xc)};Zb.prototype.EB=function(xc){this.addHandler("LineageTaskPaneVisibilityChanged",xc)};Zb.prototype.UC=function(xc){this.removeHandler("LineageTaskPaneVisibilityChanged",xc)};Zb.prototype.CL=function(xc){this.get_events().addHandler("LineageTaskPaneClose",xc)};Zb.prototype.xN=function(xc){this.get_events().removeHandler("LineageTaskPaneClose",xc)};Zb.prototype.Xv=function(){};Zb.prototype.$B=function(){};Zb.prototype.fn=function(){return this.ep};Zb.prototype.Jp=function(){return this.ep};Zb.prototype.bF=
function(){};Zb.prototype.VG=function(){return!1};Zb.prototype.ji=function(){};Zb.prototype.Vh=function(){};Zb.prototype.dispose=function(){this.$&&(this.$.En(this.qd),wc.a(this.$).XA(this));this.ke&&(fe.a.instance.za(ve.a.click,this.ke,this.Zj),kc.KeyInputManager.instance.jv(this.ke,this.Vwe));this.ke=this.taskPaneManager=this.$=null;bg.prototype.dispose.call(this)};Zb.prototype.Qe=function(xc,dd){if(!dd){xc=kd.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!xc)return!1;
kd.DOMElementExtensions.setFocus(xc)}return!dd};Zb.prototype.Ah=function(xc){return kd.DOMElementExtensions.Ye(this.Jb,xc)};Zb.prototype.Lf=function(xc){this.ep=xc;var dd=this.taskPaneManager;if(this.isVisible=xc)this.$.frame.Re.Pj("LineagePane"),this.snd=!1;if(sf.a.Gd(this.$))xc?dd.eR("LineageTaskPane",this.hI):dd.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.ap();var Cd=!!this.taskPaneManager.xg&&15===this.taskPaneManager.xg.taskPane.tg;xc&&0<dd.zz.length&&(!Cd||dd.isCollapsed)&&dd.WC(this,
!0)}this.$.Gf()};Zb.prototype.ZL=function(){var xc=this.$.Ib;xc=sf.a.Gd(this.$)?this.domElement:document.getElementById(xc+je.a.ord);var dd=this.sG();xc.appendChild(dd);dd=bf.b("div","LineagePaneBodyId","LineageActivityBody");xc.appendChild(dd);this.zjj();return dd};Zb.prototype.p_c=function(){this.$.frame.Re.Pj(this.$.frame.Re.cE||ad.AFrame.nT);this.snd=!0;this.Lf(!1);this.raiseEvent("LineageTaskPaneClose")};Zb.prototype.yjj=function(xc){this.vCb=xc};Zb.prototype.zjj=function(){this.$.frame.Re.dk("LineagePane");
var xc=this.$.frame.Re.ii("LineagePane");xc.parent=ad.AFrame.nT;xc.IQ=!0};Zb.prototype.sG=function(){var xc=bf.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),dd=bf.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");dd.innerText=this.titleText;this.ke=Wc.a.yb("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",Ne.a.instance.ea(10),"ClosePaneGlyph_16x16x32",!1);this.ke.classList.add($a.AFrameworkApplication.isRtl?je.a.W$:je.a.X$);fe.a.instance.pa(ve.a.click,
this.ke,this.Zj);this.Vwe=kc.KeyInputManager.instance.Ur(this.ke,this.Zj,yd.a.$h);xc.appendChild(dd);xc.appendChild(this.ke);return xc};Zb.ja=function(xc,dd){var Cd=xc.Ib,Ld=document.getElementById(Cd+je.a.ord);Ld||(Ld=document.createElement("div"),Ld.id=xc.Ib+je.a.ord,Ld.classList.add("LineageActivityPane"),sf.a.Gd(xc)||document.getElementById(Cd+je.a.XQ).appendChild(Ld));return xc.da.Aa(365)||xc.da.Ha(365,new Zb(Ld,xc,dd))};tl.Object.defineProperties(Zb.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(Af.a)(Zb.prototype,this,"isVisible")},set:function(xc){Object(Af.a)(Zb.prototype,this,"isVisible")!==xc&&(Object(Af.b)(Zb.prototype,this,"isVisible",xc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},lfc:{configurable:!0,enumerable:!0,get:function(){return this.snd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},tg:{configurable:!0,enumerable:!0,get:function(){return 15}},Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Fki}},
Vj:{configurable:!0,enumerable:!0,get:function(){return pe.a.Yoh}},oC:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.ea(1027)}},El:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.YK.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.ea(1248)}},
hI:{configurable:!0,enumerable:!0,get:function(){var xc=this;return this.taskPaneManager.lua(this.Jb,this.titleText,this.El,this.isResizable,function(){xc.isVisible=!0;xc.vCb?xc.vCb():ec.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){xc.isVisible=!1},function(){xc.isVisible=!0},function(){xc.isVisible=!1},this.El)}}});Object(jb.a)(Zb,"LineageTaskPane",wd.a,[432,3,200,107]);var og=Yb.a;vm(Wb,og);Wb.prototype.create=function(){var xc=this,dd=dc.GetServiceTaskFactory.create(this.$.da,
203,this.ma,this.tb),Cd=dc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ts(Ac.TaskExtensions.ve([dd,Cd],this.ma),function(){return xc.GC},this.ma),function(){xc.Fb(xc.ah)},this.ma,3)};Wb.prototype.dispose=function(){this.ah=this.ti=this.$=null;og.prototype.dispose.call(this)};Wb.ja=function(xc){xc.da.Ha(364,new Wb(xc))};tl.Object.defineProperties(Wb.prototype,{GC:{configurable:!0,enumerable:!0,get:function(){var xc=this;this.ti||(this.ti=Ac.TaskExtensions.Ba(uf.a(this.$),
function(dd){xc.ah=Zb.ja(xc.$,dd.result)},this.ma,3));return this.ti}}});Object(jb.a)(Wb,"LineageTaskPaneFactory",Yb.a,[]);Ya.prototype.dispose=function(){this.hGd();this.$=null;ec.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};Ya.prototype.disable=function(){Ya.Bvb||(Ya.Bvb=!0,ec.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.hGd()};Ya.prototype.QNj=function(){var xc=this;ze.EwaSettings.la(637)&&
!this.$.isAnonymousUser()&&cb.l(this.$.qa.ta,function(dd){xc.$?(dd=dd.Result,ec.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",dd),Ya.Y3e=!0,dd&&xc.G6f(0)):ec.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){ec.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};Ya.prototype.KNj=function(){ze.EwaSettings.la(636)&&
!this.Q6f()&&(this.$.fa.jt(this.Kf),this.Vnd=!0)};Ya.prototype.Q6f=function(){return this.$.fa&&this.$.fa.yn&&this.$.fa.yn.ShouldTriggerLineageCalloutOnMerge?(ec.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.G6f(1),!0):!1};Ya.prototype.G6f=function(xc){if(Ya.Bvb)ec.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(Ya.Bvb=!0,ec.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",xc),this.hGd(),ze.EwaSettings.la(501)){xc=new Bd.a(-847286761,ie.a.Wb,this.$.ed,0,je.a.cW);var dd={};dd=(dd.CalloutName=4,dd);this.$.Ka.Zb(xc,dd)}};Ya.prototype.hGd=function(){this.Vnd&&(this.Vnd=!1,this.$.fa.mw(this.Kf))};Ya.Bvb=!1;Ya.Y3e=!1;Object(jb.a)(Ya,"LineageTeachingCalloutTriggerManager",null,[430,3]);var Zf=Yb.a;vm(zb,Zf);zb.prototype.create=function(){var xc=this;Ac.TaskExtensions.Ba(dc.GetServiceTaskFactory.Xa(this.$.da,
458,459,this.tb),function(dd){dd=new Ya(xc.$,dd.result);xc.Fb(dd)},this.$.ma,3)};zb.ja=function(xc){xc.da.Ha(402,new zb(xc))};Object(jb.a)(zb,"LineageTeachingCalloutTriggerManagerFactory",Yb.a,[]);var If=b(80),qg=b(171),Vf=b(369),Fe=b(595),zg=b(582),Yf=b(187),jg=b(89),Ff=b(87),de=b(108),Tf=b(29);lb.prototype.show=function(xc,dd,Cd,Ld,Od,ef,Xf){var Qf=this;this.eib||(this.h_d=void 0===xc?null:xc,this.BMc=void 0===dd?null:dd,this.A4d=void 0===Ld?!1:Ld,this.D4d=void 0===Od?!1:Od,this.O_d=void 0===ef?
null:ef,this.Ejb=void 0===Cd?null:Cd,this.X4d=void 0===Xf?!1:Xf,$a.AFrameworkApplication.sa.Pa.nH?Yf.UISurfaces.pM().then(function(gg){var Ba=Object.assign(new zg.a,{onShow:function(){Qf.$Cb()},expirationOptions:Object.assign(new Fe.a,{onExpire:function(){Qf.dismiss()},displayTimeoutSeconds:10})}),Ob=gg.externalNotification();Qf.NTb=gg.addNotification(Ob,Ba);return null},function(gg){ec.ULS.sendTraceTag(593352347,383,15,"Failed to GetNotificationsAPIAsync: {0}",gg);return null}):this.eCa?this.eCa.whh(this,
Object(If.a)(this,this.$Cb,"onShowApproved")):this.$Cb())};lb.prototype.$Cb=function(){if(!this.eib&&(this.MDa=this.BMc?this.BMc:document.getElementById("WACDocumentPanel"))){this.Ie.zEb();this.ZF=document.createElement("Div");this.ZF.className="CatchUpActivityNotificationContainer CatchUpActivityNotificationContainerBorder";this.ZF.id=ad.AFrame.Dob;this.MDa.appendChild(this.ZF);this.A4d&&this.Ejb&&(this.SLc=document.createElement("Div"),this.SLc.className="CatchUpActivityNotificationBeakBorder CatchUpActivityNotificationBeak",
this.ZF.appendChild(this.SLc),this.RLc=document.createElement("Div"),this.RLc.className="CatchUpActivityNotificationBeak",this.ZF.appendChild(this.RLc));this.w_a(this.h_d,this.D4d,this.O_d,this.X4d);this.ak();if(this.Ejb){var xc=Sys.UI.DomElement.getBounds(this.Ejb),dd=Sys.UI.DomElement.getBounds(this.MDa);this.ZF.style.top=xc.y-dd.y+this.Ejb.clientHeight+12+"px"}else this.ZF.style.bottom="-"+(this.ZF.clientHeight+10)+"px";this.Vma();this.eib=!0;$a.AFrameworkApplication.sa.Pa.nH||(this.n$d=window.setTimeout(Object(If.a)(this,
this.dismiss,"dismiss"),1E4));this.DHi()}};lb.prototype.ak=function(){this.Vg.pa(ve.a.click,this.ZF,Object(If.a)(this,this.qsf,"onContainerInput"));this.Vg.pa(ve.a.click,this.uPb,Object(If.a)(this,this.Prf,"onClickClose"));this.B8&&this.Vg.pa(ve.a.click,this.B8,Object(If.a)(this,this.Orf,"onClickButton"))};lb.prototype.mm=function(){this.Vg.za(ve.a.click,this.ZF,Object(If.a)(this,this.qsf,"onContainerInput"));this.Vg.za(ve.a.click,this.uPb,Object(If.a)(this,this.Prf,"onClickClose"));this.B8&&this.Vg.za(ve.a.click,
this.B8,Object(If.a)(this,this.Orf,"onClickButton"))};lb.prototype.w_a=function(xc,dd,Cd,Ld){xc=void 0===xc?null:xc;dd=void 0===dd?!1:dd;Cd=void 0===Cd?null:Cd;Ld=void 0===Ld?!1:Ld;this.uPb=this.q0g();this.ZF.appendChild(this.uPb);this.lfa=document.createElement("Div");this.lfa.className="CatchUpActivityNotificationMessageContainer";this.lfa.setAttribute(jg.a.Cga,jg.a.FFa);this.lfa.setAttribute(jg.a.gpe,jg.a.rj);this.lfa.setAttribute(jg.a.Sd,jg.a.Bga);this.ZF.appendChild(this.lfa);this.lfa.appendChild(this.V2g());
this.lfa.appendChild(this.U2g(xc,Ld));dd&&(this.B8=document.createElement("button"),this.B8.className="CatchUpActvitiyNotificationButton",this.B8.innerText=Cd?Cd:CommonUIStrings.l_CatchUpChangeNotificationButtonLabel,this.lfa.appendChild(this.B8))};lb.prototype.V2g=function(){var xc=document.createElement("Div");xc.className="CatchUpActivityNotificationTitle";xc.innerText=CommonUIStrings.l_CatchUpChangeNotificationMessage;return xc};lb.prototype.U2g=function(xc,dd){xc=void 0===xc?null:xc;dd=void 0===
dd?!1:dd;var Cd=document.createElement("Div");Cd.className="CatchUpActivityNotificationMessage";if(!dd){dd=document.createElement("Div");dd.className="CatchUpActivityNotificationDotContainer";var Ld=document.createElement("Div");Ld.className="CatchUpActivityNotificationDot";dd.appendChild(Ld);Cd.appendChild(dd);dd=document.createElement("span");dd.className="CatchUpActivityNotificationNewText";dd.innerText=CommonUIStrings.l_CatchUpChangeNotificationNew;Cd.appendChild(dd)}dd=document.createElement("span");
dd.className="CatchUpActivityNotificationMessageText";if(!xc||1>xc.length)dd.innerText=CommonUIStrings.l_CatchUpChangeNotificationText;else{switch(xc.length){case 1:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextOneName;break;case 2:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextTwoNames;break;case 3:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextThreeNames;break;case 4:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextFourNames;break;default:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextMoreNames}Ff.a.AVf(dd,
Ld,xc,function(Od){var ef=document.createElement("span");ef.setAttribute("dir","auto");ef.style.fontFamily="'Segoe UI Semibold', 'Segoe UI Web', Arial, Verdana, sans-serif";ef.setAttribute("unselectable","on");ef.innerText=Od;return ef})}dd.setAttribute("dir","auto");Cd.appendChild(dd);return Cd};lb.prototype.q0g=function(){var xc=document.createElement("a");xc.className="CatchUpActivityNotificationCloseAnchor";xc.href="#";var dd=Vf.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","CatchUpActivityNotificationCloseIcon",
!0,CommonUIStrings.l_DialogClose);xc.appendChild(dd);return xc};lb.prototype.Prf=function(){ec.ULS.sendTraceTag(50643481,207,50,"Close button was clicked on Catch-Up Activity Notification callout.");this.La.processAction(Tf.a.eie,2);this.dismiss();return!0};lb.prototype.dismiss=function(){var xc=this;this.eib&&($a.AFrameworkApplication.sa.Pa.nH?this.NTb&&Yf.UISurfaces.pM().then(function(dd){dd.removeNotification(xc.NTb);xc.NTb=null;xc.cC(!0);return null},function(dd){ec.ULS.sendTraceTag(593352346,
383,15,"Failed to GetNotificationsAPIAsync: {0}",dd);return null}):this.cC(!1))};lb.prototype.cC=function(xc){this.MDa&&this.ZF&&this.MDa.contains(this.ZF)&&(this.mm(),this.MDa.removeChild(this.ZF),xc||window.clearTimeout(this.n$d));this.eib=!1;!xc&&this.eCa&&this.eCa.gsh(this)};lb.prototype.qsf=function(){return!0};lb.prototype.Orf=function(){ec.ULS.sendTraceTag(50643482,207,50,"Primary Button was clicked on Catch-Up Activity Notification callout.");Wa.c(Tf.a.SQg);this.La.processAction(Tf.a.ovg,
2);this.dismiss();return!0};lb.prototype.Vma=function(){var xc=this,dd=this.hc.ii(ad.AFrame.Dob);dd.parent=ad.AFrame.gxa;this.Vg.nXa(ad.AFrame.Dob,this.ZF);dd.FSc(function(){xc.GQa()});this.TF.mXa(ad.AFrame.Dob);this.TF.ylb(ad.AFrame.Dob)};lb.prototype.GQa=function(){this.B8&&(ec.ULS.sendTraceTag(50643483,207,50,"Focus was set to the Button on the Activity Notification Callout."),this.B8.focus())};lb.prototype.DHi=function(){var xc=this;ec.ULS.sendTraceTag(37552158,207,50,"The Catch-Up Activity Notification callout was shown in the UI.");
this.xD?this.xD.continueWith(function(){window.setTimeout(function(){xc.xD.result.logActivity("CatchUpChangesFeedback",null)},2E4)}):ec.ULS.sendTraceTag(50656925,207,15,"CatchUpActivityNotification ISystemInitiatedFeedback was null")};Object(jb.a)(lb,"CatchUpActivityNotification",null,[403]);var Ve=b(1023),We=b(72);Ma.prototype.yW=function(xc,dd,Cd,Ld){var Od=this;return this.xch(xc,void 0===Ld?null:Ld,function(ef){return Od.Og.uXb(ef,2,Cd,dd,void 0,void 0,void 0,void 0,void 0,"2")})};Ma.prototype.xch=
function(xc,dd,Cd){var Ld=this,Od=!!dd&&""!==dd,ef=xc;Od&&(ef=Aa.a.eT(xc,"perfTag",dd));var Xf=new Date;return Ve.a.then(Cd(ef),function(Qf){var gg=+new Date-+Xf;if(!Qf||!Qf.wh||!Qf.wh.data)return Qf;Od&&Qf.wh.data.request&&Ld.Dfj(Qf.wh.data.request.getResolvedUrl(),dd,gg);return Qf})};Ma.prototype.Dfj=function(xc,dd,Cd){xc=this.NI.eQh(xc);if(xc.count&&(xc=We.last(xc))){var Ld={Message:"Request durations for activities calls."};Ld.PerfTag=dd;Ld.CustomDuration=Cd;Ld.PerformanceDuration=xc.duration;
ec.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ld))}};Object(jb.a)(Ma,"CatchUpNetworkingWrapper",null,[38]);var Sf=b(243),vg=Sf.a;vm(Ia,vg);Ia.prototype.Mia=function(){return 6};Object(jb.a)(Ia,"GetActivityFeedRequest",Sf.a,[]);var kh=b(385);pa.prototype.hCh=function(xc){var dd=this;return Ve.a.then(this.dUa.execute(new Ia(this.QTa(),null,xc),function(Cd,Ld,Od){return dd.hog.yW(Cd,Ld,Od,"ActivityFeed")}),function(Cd){if(!Cd)return ec.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeedEntries: Response is null"),
null;if(!Cd.wh)return ec.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeedEntries: Response.Args is null"),null;if(!Cd.wh.data)return ec.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeedEntries: Response.Args.Data is null"),null;if(!Cd.wh.data.fe)return ec.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeedEntries: Response.Args.Data.ResponseData is null"),null;Cd=kh.a.DHa(Cd.wh.data.fe);return Cd?Cd:(ec.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeedEntries: Deserialized response is null"),
null)})};Object(jb.a)(pa,"CatchUpRequestHandler",null,[41]);var Pg=b(473);na.prototype.jmi=function(){this.Tmi()};na.prototype.Tmi=function(){var xc=this;this.AWa?this.AWa.execute(function(dd){window.setTimeout(function(){xc.P8d.contains("CatchUpChangesFeedback")||(xc.P8d.add("CatchUpChangesFeedback"),dd.logActivity("CatchUpChangesFeedback",null))},2E4)}):ec.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(jb.a)(na,"FloodgateEventLogger",
null,[]);var qf=b(185);tl.Object.defineProperties(xa.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.dpg.duration}}});Object(jb.a)(xa,"PerformanceResourceTimingWrapper",null,[]);Z.prototype.eQh=function(xc){var dd=new qf.a;if(!this.NI)return dd;xc=this.NI.getEntriesByName(xc,"resource");if(!xc)return dd;xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())dd.add(new xa(Cd.value));return dd};Object(jb.a)(Z,"PerformanceWrapper",null,[]);var ih=b(894),Qa=b(100),qb=b(274),
tc=b(524);ma.prototype.di=function(xc){var dd=this;this.rb=xc;this.rb.register(403,"Common.App.CatchUpActivity.ICatchUpActivityNotification").zc().Ic(function(){return new lb(fe.a.instance,Qa.FocusManager.instance(),ih.a.instance,$a.AFrameworkApplication.sa,$a.AFrameworkApplication.Eb,dd.rb.resolve("CommonUI.ICalloutManager"),tc.a.Fq(dd.rb.mc("Common.ISystemInitiatedFeedback")))});this.rb.register(Ma,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").zc().Ic(function(){return new Ma($a.AFrameworkApplication.Hd,
new Z(window.performance))});this.rb.register(pa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").zc().Ic(function(){return new pa(dd.rb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return $a.AFrameworkApplication.hj},new kh.a)});this.rb.register(na,"Common.App.CatchUpActivity.FloodgateEventLogger").zc().Ic(function(){return new na(dd.rb.mc("Common.ISystemInitiatedFeedback"))})};ma.prototype.init=function(){this.rb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.rb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ma.prototype.dispose=function(){};ma.main=function(){qb.a.instance.mj(new ma)};tl.Object.defineProperties(ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(jb.a)(ma,"CatchUpActivityPackage",null,[4,5]);Y.prototype.Xc=function(xc,dd){return this.catchUpActivityManager?-876699925===dd?!this.catchUpActivityManager.U9e:!1:!0};Y.prototype.executeCommand=function(xc,dd){xc=
!1;switch(dd.command){case -876699925:xc=this.catchUpActivityManager.PLi()}return xc?Yd.Task.Ta(!0):bd.a(dd.command)};Y.prototype.Gc=function(xc,dd){return ze.EwaSettings.la(452)&&-876699925===dd.command?!0:!1};Y.prototype.fd=function(){return!1};Object(jb.a)(Y,"CatchUpActivityCommandHandler",null,[147]);var fd=mb.a;vm(S,fd);S.prototype.Md=function(){var xc=this;this.$.da.Za(286,function(dd){xc.Ed([new Y(xc.$,dd)])})};S.ja=function(xc){mb.a.de(285,new S(xc))};Object(jb.a)(S,"CatchUpActivityCommandHandlerFactory",
mb.a,[]);var Rd=b(308),zd=b(88),xe=b(84);ca.prototype.doesContentExist=function(xc){if(!xc)return ec.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(xc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!xc.navigationId)return ec.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var dd={};dd.NavigationId=atob(xc.navigationId);return 32===this.Di.ze(Tf.a.VHa,2,dd);default:return!1}};
Object(jb.a)(ca,"CatchUpActivityContentManager",null,[461]);var me=b(963),mf=b(1252);ba.prototype.dispose=function(){this.Hu.YLf(this.rCb);this.yaa=null};ba.prototype.Zij=function(xc){this.yaa.push(xc)};ba.prototype.dUg=function(){Array.clear(this.yaa)};ba.prototype.U_f=function(xc){for(var dd=yl(this.yaa),Cd=dd.next();!Cd.done;Cd=dd.next())Cd=Cd.value,Cd.className=me.a.VQg,Cd=document.getElementById(String.format("{0}-{1}",Cd.id,je.a.rue)),kd.DOMElementExtensions.setVisible(Cd,xc)};ba.prototype.MJb=
function(xc){for(var dd=yl(this.yaa),Cd=dd.next();!Cd.done;Cd=dd.next())if(Cd=Cd.value)xc?Cd.className=2===this.Hu.model.state?me.a.RXi:me.a.SXi:this.U_f(!1)};tl.Object.defineProperties(ba.prototype,{Hu:{configurable:!0,enumerable:!0,get:function(){return this.wlg}}});Object(jb.a)(ba,"RangeCatchUpActivityView",null,[526,3]);var df=b(19),rf=mf.a;vm(O,rf);O.prototype.dispose=function(){this.gridView=null;rf.prototype.dispose.call(this)};O.prototype.Pyg=function(xc){var dd=this.veb[0];dd?dd.Zij(xc):
ec.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Vla.activityId)};O.prototype.X9i=function(){var xc=this.veb[0];xc&&xc.dUg()};O.prototype.exg=function(xc){this.Vla.addRange(xc)};O.prototype.yFh=function(){if(3!==this.Vla.activityType)return null;ec.ULS.shipAssertTag(537168003,0,1===this.Vla.mKb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return Ce.D(this.Vla.mKb[0])};O.prototype.MHb=function(xc){if(xc){if(!this.Vla)return;this.fvd(this.baj())}rf.prototype.MHb.call(this,xc)};O.prototype.Z2c=function(){var xc=this.E2c();Array.add(this.veb,xc)};O.prototype.E2c=function(){return new ba(this)};O.prototype.fvd=function(xc){xc?xc.SheetName?(this.gridView.ha.Qa.wG(null),this.gridView.focus(),this.gridView.T1e(xc,3,!1,Jc.a.QXi)):ec.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
ec.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};O.prototype.baj=function(){if(gd.e(this.Vla.mKb))return ec.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var xc=this.$.xa.oa;ec.ULS.shipAssertTag(537167970,0,!!xc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
xc=this.aFj(xc.sheetName,this.Vla.mKb);if(!xc&&(xc=this.yUh(this.Vla.mKb),!xc))return null;var dd={};dd.SheetName=xc.SheetName;dd.FirstColumn=xc.FirstColumn;dd.FirstRow=xc.FirstRow;dd.LastColumn=xc.FirstColumn;dd.LastRow=xc.FirstRow;return dd};O.prototype.yUh=function(xc){if(gd.e(xc))return null;for(var dd=null,Cd=0;Cd<xc.length;Cd++){var Ld=xc[Cd].SheetName;if(!df.a.equals(Ld,dd,!1)&&(dd=Ld,Ld=this.$.xa.getItemByName(Ld),null===Ld||void 0===Ld?0:Ld.visible))return xc[Cd]}return null};O.prototype.aFj=
function(xc,dd){if(dd){dd=yl(dd);for(var Cd=dd.next();!Cd.done;Cd=dd.next())if(Cd=Cd.value,df.a.equals(Cd.SheetName,xc,!1))return Cd}return null};Object(jb.a)(O,"RangeCatchUpActivityHighlightController",mf.a,[]);var Mg=b(74),lf=Mg.a;vm(Q,lf);Q.prototype.dispose=function(){this.xZd=null;lf.prototype.dispose.call(this)};tl.Object.defineProperties(Q.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.AB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.xZd}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.Vfg}}});Object(jb.a)(Q,"CatchUpActivityHighlightModelBase",Mg.a,[]);vm(I,Q);I.prototype.addRange=function(xc){xc=yl(xc);for(var dd=xc.next();!dd.done;dd=xc.next())this.ranges.push(dd.value)};I.prototype.dispose=function(){this.ranges=null;Q.prototype.dispose.call(this)};I.D1b=function(xc,dd){if(!xc.SheetName||!dd.SheetName)return ec.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var Cd=xc.SheetName.localeCompare(dd.SheetName);return Cd?Cd:xc.FirstColumn<dd.FirstColumn||xc.FirstColumn===dd.FirstColumn&&xc.FirstRow<dd.FirstRow?-1:xc.FirstColumn===dd.FirstColumn&&xc.FirstRow===dd.FirstRow?0:1};tl.Object.defineProperties(I.prototype,{mKb:{configurable:!0,enumerable:!0,get:function(){this.a6a||(this.ranges.sort(I.D1b),this.a6a=!0);return this.ranges}}});Object(jb.a)(I,"RangeCatchUpActivityHighlightModel",Q,[]);var $f=b(336);R.prototype.dispose=function(){this.die=this.cJb=this.m0c=
null};R.prototype.S6i=function(xc){Bc.g(xc).Nb.Yr([24])};R.prototype.N0g=function(xc,dd,Cd){var Ld={};dd=yl(dd);for(var Od=dd.next();!Od.done;Od=dd.next())if((Od=Od.value)&&!gd.e(Od.LocationList)){for(var ef=[],Xf={},Qf=[],gg=yl(Od.LocationList),Ba=gg.next();!Ba.done;Ba=gg.next()){Ba=Ba.value;if(!Ba){ec.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Od.Id);break}switch(Ba.Type){case 0:var Ob=Ba;"0"in Xf?
(Ba=Xf["0"],Ba.exg(Ob.RangeList)):(Ba=new O(xc,new I(xc,Od.Id,Od.Type,0,Ob.RangeList),Cd),ef.push(Ba),Xf["0"]=Ba);Ob=yl(Ob.RangeList);for(var Ec=Ob.next();!Ec.done;Ec=Ob.next()){Ec=Ec.value;Ec=new $f.a(Ce.D(Ec),Qc.d(xc.xa.getItemByName(Ec.SheetName)));if(this.Uuc(Ec)in this.cJb)this.cJb[this.Uuc(Ec)].push(Ba);else{var od=[];od.push(Ba);this.cJb[this.Uuc(Ec)]=od}Qf.push(Ec);this.m0c.push(Ec)}break;default:ec.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}ec.ULS.shipAssertTag(537168011,
0,!(Od.Id in Ld),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Od.Id);this.die[Od.Id]=Qf;Ld[Od.Id]=ef}this.j2g(xc,this.m0c,this.cJb);return Ld};R.prototype.XTg=function(xc){for(var dd in xc)for(var Cd=yl(xc[dd]),Ld=Cd.next();!Ld.done;Ld=Cd.next())Ld.value.X9i()};R.prototype.Uuc=function(xc){return String.format("{0}-{1}",xc.range,xc.sheetId)};R.prototype.j2g=function(xc,dd,Cd){var Ld=this;this.XTg(Cd);Bc.g(xc).Nb.uw(dd,[24],!0,function(Od,
ef){var Xf=new $f.a(Od.range,Od.sheetId);Xf=Ld.Uuc(Xf);var Qf=Cd[Xf];if(Qf)for(Xf=yl(Qf),Qf=Xf.next();!Qf.done;Qf=Xf.next())Qf=Qf.value,Qf.Pyg(ef),Od.metadata=Qf;else ec.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+Xf)})};Object(jb.a)(R,"CatchUpHighlightControllersCreator",null,[]);Object(jb.a)(W,"CreateIndicatorTooltipParameters",null,[]);Object(jb.a)(ia,"DismissIndicatorTooltipParameters",null,
[]);Object(jb.a)(P,"UpdateIndicatorTooltipParameters",null,[]);N.prototype.dispose=function(){this.ha.Dqc(this.Zk);this.ha.mF(this.kd);this.gridView.lF(this.Wo);this.qb.im(this.Mj);this.CEe();this.x$c=this.Aja=this.wcc=this.pQa=this.qb=this.ha=this.gridView=null};N.prototype.Lgj=function(){var xc=[];this.CEe();if(!gd.e(xc)){ec.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.s4=this.m2b.N0g(this.$,xc,this)){xc=this.s4;for(var dd in xc)for(var Cd=
yl(xc[dd]),Ld=Cd.next();!Ld.done;Ld=Cd.next())this.tHg(Ld.value)}this.m2b.S6i(this.$)}};N.prototype.Vvc=function(xc){if(xc&&this.Rhd)ec.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(xc||this.Oqb(),this.s4){var dd=this.s4,Cd;for(Cd in dd)for(var Ld=yl(dd[Cd]),Od=Ld.next();!Od.done;Od=Ld.next())Od.value.ftj(xc)}};N.prototype.r0h=function(xc){this.Aja&&this.S4b(!0);this.H4c();if(xc=this.s4[xc.activityId]){xc=
yl(xc);for(var dd=xc.next();!dd.done;dd=xc.next())dd.value.MHb(!0)}else ec.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};N.prototype.CEe=function(){if(this.s4){var xc=this.s4,dd;for(dd in xc)for(var Cd=yl(xc[dd]),Ld=Cd.next();!Ld.done;Ld=Cd.next())Ld=Ld.value,this.H2i(Ld),Ld.dispose()}this.s4={};this.m2b.dispose();this.m2b=null};N.prototype.Grj=function(){if(this.excelCommentManager){var xc=this.s4[this.pQa];xc&&0<xc.length&&
3===xc[0].model.activityType&&((xc=xc[0])?this.excelCommentManager.hsj(xc.yFh()):ec.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};N.prototype.J_h=function(){this.excelCommentManager&&this.excelCommentManager.Nrb()};N.prototype.H4c=function(){if(this.pQa){var xc=this.s4[this.pQa];if(xc){xc=yl(xc);for(var dd=xc.next();!dd.done;dd=xc.next())dd.value.MHb(!1);this.pQa=null}else ec.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};N.prototype.Oqb=function(){this.H4c();this.S4b(!0)};N.prototype.mFj=function(xc){if(!xc)return ec.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;xc=String.format("{0}-{1}",xc.id,je.a.TQg);var dd=this.x$c[xc];if(!dd){if(!this.gridView.domElement)return ec.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;dd=document.createElement("Div");dd.className=me.a.UQg;dd.id=xc;this.gridView.domElement.appendChild(dd);this.x$c[xc]=dd}return dd};N.prototype.S4b=function(xc){this.rea&&(this.rea.dismissActivityIndicatorTooltips(Object.assign(new ia,{clearSticky:xc})),this.wcc=null,xc&&(this.Aja=null),this.Rec&&!this.Aja&&(this.gridView.view.Wr(this.nzc),this.gridView.Us(this.nzc),this.Rec=!1))};N.prototype.tHg=function(xc){xc.qke(this.rCb);xc.vzg(this.QZf);xc.uzg(this.xFe)};N.prototype.H2i=function(xc){xc.YLf(this.rCb);
xc.P3i(this.QZf);xc.O3i(this.xFe)};tl.Object.defineProperties(N.prototype,{nvg:{configurable:!0,enumerable:!0,get:function(){return this.rea},set:function(xc){this.rea=xc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.ICa||(this.ICa=this.$.da.Aa(65));return this.ICa}},m2b:{configurable:!0,enumerable:!0,get:function(){this.n2b||(this.n2b=new R);return this.n2b},set:function(xc){this.n2b=xc}}});Object(jb.a)(N,"CatchUpActivityHighlightManager",null,[484,3]);U.prototype.navigateToActivity=
function(xc){if(xc.fromSummaryString){var dd=new Bd.a(1834994092,ie.a.Wb,this.$.ed,18,null);this.$.Ka.Zb(dd);return this.nTa(1)}xc=xc.activity;if(!this.u8h(xc))return this.nTa(4);if(!this.Rfi(xc))return this.nTa(7);var Cd={};try{dd=window.self.atob(xc.navigationId);if(!dd)return this.nTa(5);Cd.NavigationId=dd}catch(Ld){return ec.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Ld),this.nTa(5)}if(8===this.Di.ze(Tf.a.VHa,2,Cd))return this.Di.processAction(Tf.a.Q7a,
2),this.nTa(2);dd=32===this.Di.ze(Tf.a.b_a,2,Cd)?1:6;return this.nTa(dd)};U.prototype.u8h=function(xc){return xc&&xc.navigationId?!0:!1};U.prototype.Rfi=function(xc){switch(xc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};U.prototype.nTa=function(xc){return Promise.resolve(xc)};Object(jb.a)(U,"CatchUpActivityNavigationManager",null,[462]);var dg=b(441);Object(jb.a)(B,"GetRelevantActivitiesDataRequest",null,[]);Object(jb.a)(r,"Activity",null,[]);Object(jb.a)(z,"ActivityFeedItem",
null,[]);Object(jb.a)(t,"ActivityFeedPayload",null,[]);Object(jb.a)(x,"ActivityRequestPayload",null,[]);Object(jb.a)(A,"Person",null,[]);vm(m,r);Object(jb.a)(m,"TaskActivity",r,[]);v.prototype.requestWYWAActivities=function(){var xc=this;return this.p5a?new Promise(function(dd,Cd){w(xc.$.qa.ta,function(Ld){Ld=xd.a(Ld)?null:Ld.Result;Ld=Object.assign(new x,{activities:[],actors:Ld?xc.ged(Ld.WywaAuthors):null,hasMore:!1,highWaterline:v.b0a,lowWaterline:v.b0a,wywaWaterline:v.b0a});dd(Ld)},function(){ec.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");Cd(null)},null,null)}):Promise.resolve(v.h4b)};v.prototype.requestActivities=function(){return Promise.resolve(v.h4b)};v.prototype.requestRelevantActivities=function(){var xc=this;if(!this.$.fa.oc||this.$.fa.L3a)return ec.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.fa.oc,this.$.fa.L3a),
Promise.resolve(v.h4b);var dd=Object.assign(new B,{SetDaysBack:$a.AFrameworkApplication.ga.zd("AppWaterlineOverrideDaysValue",0),SetTimestamp:$a.AFrameworkApplication.ga.zd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(Cd,Ld){G(xc.$.qa.ta,dd,function(Od){var ef=v.h4b;Od?xd.a(Od)?ec.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Pd.a.Uc(Od.Errors)):ef=xc.OPh(Od.Result):ec.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");Cd(ef)},function(Od){Od=hc.a.yg(Od.data);ec.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Pd.a.Uc(Od));Ld(null)},null,null)})};v.prototype.requestActivityFeed=function(){var xc=this;return ed.b(this.getActivityFeed()).then(function(dd){return Object.assign(new t,{activityFeedItems:xc.VDj(dd)})})};v.prototype.getActivityFeed=
function(){var xc=this;return this.uue?Ve.a.MSd(this.uue,function(dd){return dd.hCh(xc.DHh())}):Yd.Task.Ta([])};v.prototype.DHh=function(){var xc=RegExp("^(([^:/?#]+):)?(\\\\/\\\\/([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?").exec(decodeURIComponent(Aa.a.tA(window.location.href,"WOPISrc",!0)))[5].split("/");return xc[xc.length-1]};v.prototype.OPh=function(xc){if(!xc)return ec.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new x,
{activities:[]});var dd=this.B6f(xc.NewActivities,2);xc=this.B6f(xc.OutstandingActivities,3);xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())dd.push(Cd.value);return Object.assign(new x,{activities:dd})};v.prototype.B6f=function(xc,dd){dd=void 0===dd?1:dd;var Cd=[];if(!xc||!xc.length)return Cd;xc=yl(xc);for(var Ld=xc.next();!Ld.done;Ld=xc.next())if(Ld=Ld.value){var Od=v.bEj(Ld.Type);6===Od||7===Od||9===Od||8===Od?Cd.push(Object.assign(new m,{activityId:Ld.Id,type:Od,displayTimestamp:new Date(Ld.DisplayTimestamp),
navigationId:Ld.NavigationId,actors:this.ged(Ld.People),relevancy:dd,relationship:this.aEj(Ld.Relationship)})):Cd.push(Object.assign(new r,{activityId:Ld.Id,type:Od,displayTimestamp:new Date(Ld.DisplayTimestamp),navigationId:Ld.NavigationId,actors:this.ged(Ld.People),relevancy:dd}))}else ec.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return Cd};v.prototype.aEj=function(xc){switch(xc){case 1:return 1;case 2:return 2;
case 3:return 3}ec.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};v.prototype.VDj=function(xc){var dd=[];xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=xc.next())Cd=Cd.value,Cd=Object.assign(new z,{id:Cd.id,type:Cd.type,collectionId:Cd.collectionId,activityState:Cd.activityState,activityFeedItemPayload:Cd.activityFeedItemPayload,timestamp:Cd.timestamp}),dd.push(Cd);return dd};v.prototype.ged=function(xc){var dd=[];if(!xc||!xc.length)return dd;xc=yl(xc);for(var Cd=xc.next();!Cd.done;Cd=
xc.next())(Cd=Cd.value)&&dd.push(this.yub(Cd));return dd};v.prototype.yub=function(xc){return Object.assign(new A,{id:xc.Id,provider:xc.Provider,displayName:xc.DisplayName,email:xc.Email,imageUrl:this.Voc.dHa(xc.Email,xc.Provider,$a.AFrameworkApplication.hj,0),color:this.bEb.Gfd(new dg.a(null,void 0,xc.DisplayName),6)})};v.bEj=function(xc){switch(xc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return ec.ULS.shipAssertTag(537168015,
3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};v.h4b=Object.assign(new x,{activities:[],actors:[],hasMore:!1,highWaterline:v.b0a,lowWaterline:v.b0a,wywaWaterline:v.b0a});Object.assign(new x,{activities:[Object.assign(new r,{activityId:"activityId1",type:3,actors:[Object.assign(new A,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),
Object.assign(new r,{activityId:"activityId2",type:4,actors:[Object.assign(new A,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});v.b0a="<WywaWaterline>DefaultWaterline</WywaWaterline>";Object(jb.a)(v,"CatchUpActivityRequestManager",null,[463]);u.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.fa.P6a)return!1;if(!ze.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var xc=
this.$.da.Aa(365);return!xc||!xc.isVisible}return!0};u.prototype.onButtonClick=function(){var xc={};xc=(xc.InputMethod=ie.a.Wb,xc);this.$.Ka.Zb(new Bd.a(1834994092,ie.a.Wb,this.$.ed,16,null),xc)};u.prototype.getExplanationText=function(){var xc=this.$.da.Aa(365);return Ne.a.instance.Va(xc&&xc.isVisible?644:643)};u.prototype.getCommandName=function(){return Ne.a.instance.ea(433)};Object(jb.a)(u,"CatchUpEmptyExperienceBehaviorManager",null,[464]);l.prototype.dispose=function(){wc.a(this.$).XA(this)};
l.prototype.Qe=function(xc,dd){if(dd)return!1;xc=document.getElementById("flyoutItem0");if(!xc)return ec.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;xc.focus();this.ebh(xc);return!0};l.prototype.Ah=function(xc){return this.Jb?kd.DOMElementExtensions.Ye(this.Jb,xc):!1};l.prototype.ji=function(){this.hasFocus=!0};l.prototype.Vh=function(){this.hasFocus=!1};l.prototype.ebh=function(xc){if(Sys.Browser.agent===Sys.Browser.Firefox){var dd=document.createEvent("KeyboardEvent");
dd.initKeyEvent(ve.a.Rb,!0,!0,window.self,!1,!1,!1,!1,yd.a.yAc,0);xc.dispatchEvent(dd)}else dd=document.createEvent("Events"),dd.initEvent(ve.a.Rb,!0,!0),dd.keyCode=yd.a.yAc,dd.which=yd.a.yAc,xc.dispatchEvent(dd)};tl.Object.defineProperties(l.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.xaf&&!this.hasFocus}},Zd:{configurable:!0,enumerable:!0,
get:function(){return gb.a.FYc}}});Object(jb.a)(l,"FlyoutFocus",null,[107,3]);var yf=b(374);n.prototype.dispose=function(){this.Yhb=this.Exb=!1};n.prototype.registerButtonClickedEvent=function(xc){this.buttonClickedCallback&&ec.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=xc.buttonClickedCallback};n.prototype.onFlyoutInitialized=function(){this.Exb&&ec.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
var xc=(new Date).getTime()-this.oxh.getTime();ec.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",xc);Wa.c(Tf.a.XQg,!0,Wa.e,0,0,xc);this.Exb=!0;yf.a.sy&&yf.a.sy.updateCommandUI(!0)};n.prototype.logFlightTriggers=function(){};n.prototype.toggleCatchUpFlyout=function(){this.Exb?this.buttonClickedCallback?this.buttonClickedCallback():ec.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
ec.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};n.prototype.onFlyoutVisibilityChanged=function(xc){this.Yhb!==xc.flyoutIsVisible&&(this.Yhb=xc.flyoutIsVisible,yf.a.sy&&yf.a.sy.updateCommandUI(!0),this.Yhb||this.pRe&&this.pRe.jmi())};tl.Object.defineProperties(n.prototype,{xaf:{configurable:!0,enumerable:!0,get:function(){return this.Yhb}}});Object(jb.a)(n,"FlyoutRibbonButton",null,[483]);var Hg=b(528);Object(jb.a)(k,"CatchUpConfiguration",
null,[]);Object(jb.a)(c,"SharedControllerFactoryParameters",null,[]);d.prototype.dispose=function(){this.iGa&&this.iGa.getWywaEvent().removeListener(this.oBf);this.iGa=this.$=null;zd.a.Fa(this.uZa);this.flyoutRibbonButton=this.flyoutFocus=this.i0d=this.sue=this.tue=this.uZa=null};d.prototype.PLi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};d.prototype.Nmi=function(){ec.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");ec.ULS.sendTraceTag(594401288,
3012,50,"Tasks and outstanding data is enabled")};d.prototype.Vki=function(xc,dd){f("ScriptDownload");Ac.TaskExtensions.Ba(dc.GetServiceTaskFactory.Xa(this.$.da,283,284,dd),function(Cd){xc(ed.c(Cd.result.wo.loadScript("catchUpActivity")))},this.$.da.ma,3)};d.prototype.p5a=function(){return!!this.shf&&this.shf.p5a()&&this.$.fa.P6a};d.prototype.Gzi=function(xc){var dd=this;Ac.TaskExtensions.Ba(xc,function(){Hb.a(function(){dd.iGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new c,
{activityContentManager:Object(xe.a)(461,dd.i0d),activityNavigationManager:Object(xe.a)(462,dd.sue),activityRequestManager:Object(xe.a)(463,dd.tue),dataCulture:dd.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(xe.a)(n,dd.flyoutRibbonButton),uiCulture:dd.$.ya.UICultureTag,ulsLogger:new cc.a,emptyCatchUpBehaviorManager:Object(xe.a)(464,dd.emptyCatchUpBehaviorManager)}))});dd.uZa.nvg=dd.iGa.getActivityIndicatorTooltipManager();Hg.a(dd.$);dd.iGa.getWywaEvent().addListener(dd.oBf);f("InitializeCatchUpApp");
dd.iGa.initialize(Object.assign(new k,{featuredActivityGroupsEnabled:!1,flyoutEnabled:!0,summaryStringEnabled:dd.p5a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:ze.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel")}))},this.$.ma,3)};tl.Object.defineProperties(d.prototype,{U9e:{configurable:!0,enumerable:!0,get:function(){var xc=this.flyoutRibbonButton.Exb;xc&&!this.W3e&&(ec.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),
this.W3e=!0);return xc}},x9h:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.xaf}}});Object(jb.a)(d,"CatchUpActivityManager",null,[465,3]);var Df=Yb.a;vm(a,Df);a.prototype.create=function(){var xc=this;Ac.TaskExtensions.Ba(dc.GetServiceTaskFactory.Xa(this.$.da,458,459,this.tb),function(dd){dd=dd.result;xc.Fb(xc.$.da.Aa(286)||new d(xc.$,xc.tb,null,dd))},this.$.ma,3)};a.ja=function(xc){xc.da.Ha(287,new a(xc))};Object(jb.a)(a,"CatchUpActivityManagerFactory",Yb.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");Ua.a.Ga(Pc.ja);Ua.a.Ga(Zc.ja);Ua.a.Ga(ka.ja);Ua.a.Ga(Ha.ja);nd.a.Yi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){Ua.a.Ga(function(xc){Wb.ja(xc);da.ja(xc);Ja.ja(xc);zb.ja(xc);Mb.ja(xc)})})();Type.registerNamespace("Common.App.CatchUpActivity");ma.main();(function(){Ua.a.Ga(function(xc){f("Begin");a.ja(xc);S.ja(xc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/6e30a3023f612a1c48c73be2ae669623/EwaDS.catchup.js.map