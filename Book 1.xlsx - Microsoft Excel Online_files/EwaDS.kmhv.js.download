(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1087:function(y,D,b){function a(t,z){var r=this;this.Zc=function(){f.a.ug(v.a(r.$).nd.activityState,x.a.Kwd)||r.Q$.reset()};this.$=z;this.Nic=t;this.fa=z.fa;this.fa.Sj(this.Zc);this.Q$=A.a.Ppe(this.$)}function d(t){var z=this;this.ej=this.CBc=null;this._state=0;this.moveNext=function(){try{for(z._state=1;1===z._state;)z.hu=z.hu()}catch(r){z.dispose(),z._state=3}};this.wf=t;this.hu=this.fL;this.moveNext()}b.r(D);y=b(0);var c=
b(13),k=b(35),n=b(201),l=b(126),f=b(32),u=b(1),v=b(64),m=b(55);d.prototype.fL=function(){this.CBc=this.wf.$.Ub.Fc("LoadResource","DownloadACopyOperation");return this.lYd};d.prototype.lYd=function(){var t=b(1087).DownloadACopyOperation;if(this.wf.Q$.H6e||!(this.CBc.Ac<t.ljc))return this.idg;this.ej=m.Task.delay(t.IGe).g();this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext));return this.Feb};d.prototype.idg=function(){var t=b(1087).DownloadACopyOperation;this.CBc.Ac>=t.ljc&&c.ULS.sendTraceTag(537154819,
0,15,"Download did not complete after 10 seconds.");v.a(this.wf.$).nd.kJ();this._state=3};d.prototype.Feb=function(){this.ej.Sy();return this.lYd};d.prototype.dispose=function(){};Object(y.a)(d,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var A=b(1181),x=b(133);b.d(D,"DownloadACopyOperation",function(){return a});a.prototype.Ych=function(){var t=this,z=this.FNg(this.$),r=this.$.userOperationManager.operationCount;0<r&&c.ULS.sendTraceTag(537154822,
0,15,"flushing queue in downloadcopy. Queue is {0}",r);this.$.userOperationManager.Z$("DownloadACopyOperation.DownloadForkedFile");this.Nic&&c.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.Q$.downloadFile(z,-21742208);u.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?k.TaskExtensions.Ba(m.Task.delay(1),function(){t.G6e()},this.Q$.ma,3):k.TaskExtensions.Ba(m.Task.delay(1),function(){t.w1h()},
this.Q$.ma,3)};a.prototype.dispose=function(){this.fa&&this.fa.kk(this.Zc);this.$=this.fa=null};a.prototype.G6e=function(t){var z=this;(t=void 0===t?null:t)||(t=this.$.Ub.Fc("LoadResource","DownloadACopyOperation"));!this.Q$.H6e&&t.Ac<a.ljc?window.setTimeout(function(){z.G6e(t)},a.IGe):(t.Ac>=a.ljc&&c.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),v.a(this.$).nd.kJ())};a.prototype.w1h=function(){new d(this)};a.prototype.FNg=function(t){var z=new Sys.StringBuilder,r=
t.workbookContext,G=t.ya;z.append(t.hda);z.append(G.FileHandlerRelativeUri);z.append("?id=");z.append(encodeURIComponent(n.a.YFb(r.WorkbookUri,"sc")));t.fa.oc&&(z.append("&sessionId="),z.append(encodeURIComponent(t.fa.sessionId)));z.append("&workbookType=FullForkedWorkbook");z.append("&dataloss=");z.append(this.Nic?"true":"false");l.a.yFa(z,G);return z.toString()};a.ljc=1E5;a.IGe=100;Object(y.a)(a,"DownloadACopyOperation",null,[3])},1173:function(y,D,b){function a(l,f){l=n.call(this,l,f)||this;d.ULS.sendTraceTag(537170201,
0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");l.title="";l.message=a.bxa;l.nKa=!0;return l}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(47),k=b(77);b=b(831);var n=b.a;vm(a,n);a.prototype.ula=function(l){n.prototype.ula.call(this,l);c.a.openWindow(4,k.a.NG(a.Jkf))};a.prototype.XE=function(l){n.prototype.XE.call(this,l);a.Xsd&&a.Xsd(null)};a.initialize=function(l,f,u,v){d.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.bxa=
l;a.Kkf=f;a.Jkf=u;a.Xsd=v};tl.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Kkf}}});a.bxa=null;a.Kkf=null;a.Jkf=null;a.Xsd=null;Object(y.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1174:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.iih="ewa-bb";a.kih="ewa-bb-entry";a.lih="ewa-bb-entry-body";a.rih="ewa-bb-icon";a.nih="ewa-bb-entry-icon";a.qih="ewa-bb-entry-title";a.pih="ewa-bb-entry-message";a.UJe="ewa-bb-entry-button";
a.oih="ewa-bb-entry-link";a.mih="ewa-bb-entry-close";a.VJe="ewa-bb-entry-button-holder";a.G7c="ewa-nov2-ltr";a.jih="ewa-bb-content";a.I7c="ewa-nov2-rtl";Object(y.a)(a,"CssClassNames",null,[])},1175:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=a.roa)&&c(null)};a.initialize=function(c,k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=
l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1176:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=a.roa)&&c(null)};a.initialize=function(c,
k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1177:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=
a.roa)&&c(null)};a.initialize=function(c,k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1178:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.tAb;c.message=a.bxa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,
c);a.dxa&&a.dxa(null)};a.initialize=function(c,k,n,l){a.tAb=c;a.bxa=k;a.e7a=n;a.dxa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.e7a}}});a.tAb=null;a.bxa=null;a.e7a=null;a.dxa=null;Object(y.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1179:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;a.e7a&&a.dxa&&(c.Vy=!0);c.title=a.tAb;c.message=a.bxa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);
var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);a.dxa&&a.dxa(null)};a.initialize=function(c,k,n,l){a.tAb=c;a.bxa=k;a.e7a=n;a.dxa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.e7a}}});a.tAb=null;a.bxa=null;a.e7a=null;a.dxa=null;Object(y.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1180:function(y,D,b){function a(l,f,u,v,m,A){this.EX=l;this.FX=f;this.UHc=u;this.lD=v;this.iQb=m;this.NTa=A}
b.d(D,"a",function(){return a});y=b(0);var d=b(1238),c=b(5),k=b(49),n=b(86);a.prototype.zYi=function(l){this.bqf(l)};a.prototype.mki=function(l){this.bqf(l)};a.prototype.bqf=function(l){var f=10;1===l?(n.a.instance.resolve("Common.IOfficeTrialExperience").Mhc(this.NTa),f=3):2===l&&((!this.UHc||this.UHc(this.lD))&&this.FX&&d.a.instance.w3g(this.FX,this.EX,this.lD),f=5);l&&1!==l||this.EX&&this.EX(this.lD);c.AFrameworkApplication.trc(k.a.DBf,this.iQb,f);this.dispose()};a.prototype.dispose=function(){this.lD=
this.FX=this.EX=null};tl.Object.defineProperties(a.prototype,{A_f:{configurable:!0,enumerable:!0,get:function(){return!this.FX&&!this.UHc}},Jpf:{configurable:!0,enumerable:!0,get:function(){return 2===this.NTa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},vJe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},v6e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},h5e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},tWb:{configurable:!0,enumerable:!0,get:function(){return 2===this.NTa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Wn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(a,"AOICErrorDialogWithTrial",null,[3])},1181:function(y,D,b){function a(A,x){var t=m.call(this,A)||this;t.gMj=["id","sessionId","workbookType","workbookFileType","dataloss"];t.command=0;t.lCb=function(){var z=t.kIh();if(z){t.$.KH(!0);if(-2028960985!==t.command&&1461300262!==t.command){var r=u.a(t.$).nd.activityState;r[f.a.kXa]=l.a.download;r[v.a.VRc]=t.command}n.a(t.$).St(z.Errors)}};t.iframe=A;t.$=x;t.wc.ja("load",t.lCb);return t}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(47);
D=b(232);var k=b(201),n=b(39),l=b(6),f=b(33),u=b(64),v=b(607),m=D.a;vm(a,m);a.prototype.downloadFile=function(A,x){var t={};(A=this.Tsh(A,t))&&c.a.qoc("dlfr",A,t);this.command=x};a.prototype.Tsh=function(A,x){var t=A.split("?");if(2!==t.length)return A=null,d.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),A;t=t[1].split("&");t=yl(t);for(var z=t.next();!z.done;z=t.next()){var r=z.value.split("=",2);if(2!==r.length){A=null;d.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}z=r[0];Array.contains(this.gMj,z)&&(r=decodeURIComponent(r[1]),x[z]=r,A=k.a.YFb(A,z))}return A};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.kIh=function(){try{return this.iframe.contentWindow.ewaResult}catch(x){if(!this.$.fa.lc.isDivSyndicated){var A=window.document.referrer.match(RegExp("://(.[^/]+)/"));d.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<A.length?A[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Tva);throw x;}return null}};a.Ppe=function(A){var x=document.createElement("iframe");x.id="ewaFileLoader";x.style.cssText="height:0;width:0;display:none";x.src="about:blank";x.setAttribute("name","dlfr");x=A.domElement.appendChild(x);return new a(x,A)};tl.Object.defineProperties(a.prototype,
{H6e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(y.a)(a,"FileLoader",D.a,[])},1182:function(y,D,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(D,"a",function(){return a});y=b(0);var d=b(1341),c=b(5),k=b(38),n=b(77);a.prototype.mLd=function(){return k.c([this.Mia(),this])};a.prototype.execute=function(l,f,u){var v="RoamingAppsHandler.ashx";d.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=n.a.gl(v,"wdEnableRoaming","1"));c.AFrameworkApplication.Hd.Ul(v,2,this.mLd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.X2a(),l,f,u,void 0,void 0,void 0,void 0,"6")};Object(y.a)(a,"ARoamingAppsRequest",null,[])},1186:function(y,D,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"PrintPreviewPaneProps",null,[])},1231:function(y,D,b){function a(rb,eb){var Ta=Tc.call(this,eb)||this;Ta.Hxh=I.DOMElementExtensions.Ep+",div";Ta.BY=Array(65);Ta.sm=!1;Ta.JV=function(fb){if(fb.Ea.keyCode===U.a.hD){var pb=Ta.Jb.querySelectorAll(Ta.Hxh),rc=I.DOMElementExtensions.zl(pb);pb=I.DOMElementExtensions.Ry(pb);return I.DOMElementExtensions.jda(fb.Ea,rc,pb)}return!1};Ta.vb=rb;Ta.set_visible(!1);Ta.addCssClass(O.a.iih);
N.KeyInputManager.instance.pa(P.a.Rb,Ta.Jb,Ta.JV);ca.a(rb).Tg(Ta);return Ta}function d(rb,eb,Ta,fb){rb=vd.call(this,rb,eb)||this;rb.automateCommandManager=Ta.da.Aa(352);B.ULS.shipAssertTag(526787654,0,!!rb.automateCommandManager);rb.id=Ic.a.create();rb.$=Ta;rb.message="";rb.update(fb);return rb}function c(rb,eb){rb=Ra.call(this,rb,eb)||this;rb.wBa=Sa.a.i3b();rb.Vy=!0;rb.l4=rb.wBa.qMj;rb.title=rb.wBa.title;rb.message=rb.wBa.message;return rb}function k(rb,eb){rb=Tb.call(this,rb,eb)||this;rb.Vy=!0;
rb.title="";return rb}function n(rb,eb){eb=Sb.call(this,rb,eb)||this;eb.policyManager=rb.$.da.Aa(274);if(!eb.policyManager)return B.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),eb;eb.message=eb.policyManager.eoc;eb.title=eb.policyManager.title;eb.nKa=!0;return eb}function l(rb,eb){rb=hb.call(this,rb,eb)||this;rb.Vy=!0;rb.l4=!0;return rb}function f(rb,eb,Ta,fb){rb=za.call(this,rb,eb)||this;rb.Pvb=Ta;rb.command=fb;rb.nKa=
!0;rb.Vy=!0;return rb}function u(rb,eb,Ta){rb=Zb.call(this,rb,eb)||this;rb.Pvb=Ta;rb.nKa=!0;return rb}function v(rb,eb,Ta){rb=Wb.call(this,rb,eb)||this;rb.Pvb=Ta;rb.Vy=!0;return rb}function m(rb,eb){rb=zb.call(this,rb,eb)||this;rb.Vy=!0;rb.l4=!1;return rb}function A(rb,eb){rb=lb.call(this,rb,eb)||this;rb.Vy=!0;rb.l4=!0;return rb}function x(rb,eb,Ta,fb,pb,rc,vb){return t.call(this,rb,0,eb,Ta,fb,pb,rc,vb)||this}function t(rb,eb,Ta,fb,pb,rc,vb,E){this.JI=this.J7=this.hX=0;this.shg=rb;this.tCj=eb;this.HO=
Ta;this.Dlg=vb;this.Ehb=R.a.lu(E);this.Hjg=E;fb&&(this.hX=fb);pb&&(this.J7=pb);rc&&(this.JI=rc)}function z(rb,eb,Ta,fb,pb){rb=r.call(this,rb,eb,Ta,fb)||this;rb.command=pb;rb.l4=!0;return rb}function r(rb,eb,Ta,fb){rb=pa.call(this,rb,eb)||this;rb.error=Ta;rb.options=fb;rb.error&&rb.options&2&&(rb.message=rb.error.Description);rb.error&&rb.options&1&&(rb.title=rb.error.Caption);rb.Vy=!(fb&4);return rb}function G(rb,eb,Ta){return w.call(this,rb,eb,Ta)||this}function w(rb,eb,Ta){rb=xa.call(this,rb,eb)||
this;rb.Vy=!0;rb.command=Ta;return rb}b.r(D);y=b(0);var B=b(13),U=b(91),N=b(117),P=b(12),ia=b(88),W=b(49),R=b(28),I=b(11),Q=b(232),O=b(1174),ba=b(4),ca=b(256),S=b(1175),Y=b(831),ma=b(1258),Z=b(92),xa=Y.a;vm(w,xa);w.prototype.Vo=function(rb){xa.prototype.Vo.call(this,rb);this.businessBar.$.Ka.Zb(new Z.a(this.command,rb,this.businessBar.$.ed,10,null))};Object(y.a)(w,"CommandActionBusinessBarEntry",Y.a,[]);vm(G,w);G.prototype.XE=function(rb){w.prototype.XE.call(this,rb)};Object(y.a)(G,"EditAttemptReadOnlyBusinessBarEntry",
w,[]);var na=b(39),pa=Y.a;vm(r,pa);r.prototype.Vo=function(rb){pa.prototype.Vo.call(this,rb);this.error.Appearance&=-33;na.a(this.businessBar.$).St([this.error])};Object(y.a)(r,"ErrorBusinessBarEntry",Y.a,[]);vm(z,r);z.prototype.H5=function(rb){r.prototype.H5.call(this,rb);this.businessBar.$.Ka.Zb(new Z.a(this.command,rb,this.businessBar.$.ed,10,null))};Object(y.a)(z,"ErrorAndCommandBusinessBarEntry",r,[]);var Ia=b(14);t.ea=function(rb){return Ia.a.instance.ea(rb)};tl.Object.defineProperties(t.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.tCj)}},message:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.HO)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.HO}},cob:{configurable:!0,enumerable:!0,get:function(){return this.shg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.hX)}},aYa:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.J7)}},link:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.JI)}},
Vj:{configurable:!0,enumerable:!0,get:function(){return this.Dlg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Ehb}},alt:{configurable:!0,enumerable:!0,get:function(){var rb=b(1231).BusinessBarControl;switch(this.Vj){case rb.mIa:return t.ea(26);case rb.KF:return t.ea(25);case rb.Xj:return t.ea(24);default:return t.ea(0)}}},a7c:{configurable:!0,enumerable:!0,get:function(){return this.Hjg}}});Object(y.a)(t,"EwaBusinessBarEntry",null,[]);vm(x,t);tl.Object.defineProperties(x.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(y.a)(x,"EwaNoTitleBusinessBarEntry",t,[]);var Ma=b(69),lb=Y.a;vm(A,lb);A.prototype.Vo=function(rb){lb.prototype.Vo.call(this,rb);this.set_visible(!1);this.businessBar.$.OH();this.businessBar.$.Ka.Zb(new Z.a(1038998010,rb,this.businessBar.$.ed,10,null))};A.prototype.H5=function(rb){lb.prototype.H5.call(this,rb);this.businessBar.$.Ka.Zb(new Z.a(-722953877,rb,this.businessBar.$.ed,10,null))};A.prototype.XE=function(rb){this.businessBar.removeEntry(53);
Ma.g(rb)};Object(y.a)(A,"ExternalLinksEnableContentBusinessBarEntry",Y.a,[]);var zb=Y.a;vm(m,zb);m.prototype.Vo=function(rb){zb.prototype.Vo.call(this,rb);this.businessBar.$.Ka.Zb(new Z.a(-722953877,rb,this.businessBar.$.ed,10,null))};m.prototype.XE=function(rb){this.businessBar.removeEntry(5);Ma.g(rb)};Object(y.a)(m,"ExternalLinksShowErrorBusinessBarEntry",Y.a,[]);var Ya=b(8),Wb=Y.a;vm(v,Wb);v.prototype.Vo=function(rb){Wb.prototype.Vo.call(this,rb);Ya.HelperMethods.Xba(this.businessBar.$.pI,this.Pvb,
this.businessBar.$.$W)};Object(y.a)(v,"HelpButtonBusinessBarEntry",Y.a,[]);var Zb=Y.a;vm(u,Zb);u.prototype.ula=function(rb){Zb.prototype.ula.call(this,rb);Ya.HelperMethods.Xba(this.businessBar.$.pI,this.Pvb,this.businessBar.$.$W)};Object(y.a)(u,"HelpTextBusinessBarEntry",Y.a,[]);var da=b(78),za=Y.a;vm(f,za);f.prototype.Vo=function(rb){za.prototype.Vo.call(this,rb);this.businessBar.$.Ka.Zb(new Z.a(this.command,rb,this.businessBar.$.ed,10,null))};f.prototype.ula=function(rb){za.prototype.ula.call(this,
rb);var eb=new Z.a(-859308420,rb,this.businessBar.$.ed,12,null),Ta={};rb=(Ta[da.a.Kg]="HelpID="+this.Pvb,Ta.InputMethod=rb,Ta[da.a.hd]=ba.a.WU,Ta[ba.a.Ana]=!0,Ta);this.businessBar.$.Ka.Zb(eb,rb)};Object(y.a)(f,"HelpTextTaskPaneAndCommandBusinessBarEntry",Y.a,[]);var hb=Y.a;vm(l,hb);l.prototype.Vo=function(rb){hb.prototype.Vo.call(this,rb);this.set_visible(!1);this.businessBar.$.OH();this.businessBar.$.Ka.Zb(new Z.a(-1081442996,rb,this.businessBar.$.ed,10,null))};l.prototype.H5=function(rb){hb.prototype.H5.call(this,
rb);this.businessBar.$.Ka.Zb(new Z.a(1702917262,rb,this.businessBar.$.ed,10,null))};l.prototype.XE=function(rb){this.businessBar.removeEntry(57);Ma.g(rb)};Object(y.a)(l,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",Y.a,[]);var Gb=b(1177),Sb=Y.a;vm(n,Sb);n.prototype.ula=function(rb){Sb.prototype.ula.call(this,rb);(rb=this.policyManager.wGi)&&rb(null)};tl.Object.defineProperties(n.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(y.a)(n,
"PolicyBusinessBarEntry",Y.a,[]);var Fb=b(1176),wa=b(1179),va=b(1178);b(410);var sa=b(176),sb=b(29),Tb=Y.a;vm(k,Tb);k.prototype.Vo=function(rb){Tb.prototype.Vo.call(this,rb);sa.c(sb.a.hvi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(y.a)(k,"UnsupportedBrowserBusinessBarEntry",Y.a,[]);var Da=b(1173),Sa=b(1273),Ra=Y.a;vm(c,Ra);c.prototype.Vo=function(rb){Ra.prototype.Vo.call(this,rb);this.wBa.hrf(null)};c.prototype.H5=function(rb){Ra.prototype.H5.call(this,
rb);this.wBa.krf(null)};c.prototype.XE=function(rb){Ra.prototype.XE.call(this,rb);this.wBa.yFe(null)};tl.Object.defineProperties(c.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.wBa.Cse}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.wBa.Ese}}});Object(y.a)(c,"WildFireMobileAppBusinessBarEntry",Y.a,[]);var Lb=b(245),Ja=b(19),wb=b(240),Mb=b(166),Eb=b(46),Ic=b(179),Zc=b(75),Pc=b(125),vd=Y.a;vm(d,vd);d.prototype.update=function(rb){this.yza=rb.yza;this.Zca=
rb.Zca;this.cmi(rb.Z0b);this.n9i();"preparing"===this.Zca?this.title="Preparing script to run.":"running"===this.Zca?(this.title="Script is running.",this.Vy=!0,this.sWb="Stop",this.l_c=this.slb=this.aAf):"succeeded"===this.Zca?(this.title="Script run succeeded.",this.Vy=!0,this.sWb="View logs",this.slb=this.ZAf,this.l4=!0,this.sUc="View script",this.tUc=this.yMi):"runFailed"===this.Zca?(this.title="Script run failed.",this.Vy=!0,this.sWb="View logs",this.slb=this.ZAf,this.l4=!0,this.sUc="Contact owner",
this.tUc=this.QAi):"fetchFailed"===this.Zca?this.title="Script is unshared. Contact onwer to share it again":"canceled"===this.Zca&&(this.title="Script run is canceled.")};d.prototype.Vo=function(rb){vd.prototype.Vo.call(this,rb);this.slb&&this.slb()};d.prototype.H5=function(rb){vd.prototype.H5.call(this,rb);this.aYa&&this.tUc()};d.prototype.XE=function(rb){vd.prototype.XE.call(this,rb);this.l_c&&this.l_c()};d.prototype.n9i=function(){this.message=this.title="";this.Vy=!1;this.sWb="";this.slb=void 0;
this.l4=!1;this.sUc="";this.tUc=void 0;this.Svb=!1;this.l_c=void 0};d.prototype.aAf=function(){var rb=Ic.a.create().toString();this.automateCommandManager.xWh(rb);this.nic(-2186799,rb)};d.prototype.ZAf=function(){var rb=Ic.a.create().toString();this.automateCommandManager.wWh(rb);this.nic(1036446140,rb)};d.prototype.yMi=function(){var rb=Ic.a.create();this.yza&&this.automateCommandManager.z3e(this.id.toString(),JSON.stringify({cD:this.yza}),rb);this.nic(-585097204,rb.toString())};d.prototype.QAi=
function(){var rb=Ic.a.create().toString();this.automateCommandManager.vWh(rb);this.nic(-639858579,rb)};d.prototype.cmi=function(rb){var eb=[];eb.push(Object.assign(new Zc.a,{name:"id",string:this.id.toString()}));eb.push(Object.assign(new Zc.a,{name:"hasScriptLink",bool:!!this.yza}));eb.push(Object.assign(new Zc.a,{name:"runStatus",string:this.Zca}));eb.push(Object.assign(new Zc.a,{name:"clickId",string:rb}));sa.a(Pc.a.Sxi,void 0,void 0,eb)};d.prototype.nic=function(rb,eb){var Ta=[];Ta.push(Object.assign(new Zc.a,
{name:"id",string:this.id.toString()}));Ta.push(Object.assign(new Zc.a,{name:"hasScriptLink",bool:!!this.yza}));Ta.push(Object.assign(new Zc.a,{name:"runStatus",string:this.Zca}));Ta.push(Object.assign(new Zc.a,{name:"clickId",string:eb}));sa.d(rb,void 0,void 0,void 0,void 0,void 0,Ta)};tl.Object.defineProperties(d.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.sWb}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.sUc}}});Object(y.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",
Y.a,[]);b.d(D,"BusinessBarControl",function(){return a});var Tc=Q.a;vm(a,Tc);a.prototype.Qe=function(rb,eb){eb||I.DOMElementExtensions.setFocus(this.domElement.firstChild);return!eb};a.prototype.Ah=function(rb){return I.DOMElementExtensions.Ye(this.Jb,rb)};a.prototype.ji=function(){};a.prototype.Vh=function(){};a.prototype.dispose=function(){this.sm||(N.KeyInputManager.instance.za(P.a.Rb,this.Jb,this.JV),ia.a.pc(this.BY),this.BY=Array(65),this.vb=null,Tc.prototype.dispose.call(this),this.sm=!0)};
a.prototype.Y4a=function(rb){if(!this.get_visible())return!1;rb=this.BY[rb];return!!rb&&rb.isVisible};a.prototype.MB=function(rb){return!!this.BY[rb]};a.prototype.lMb=function(rb,eb){if(rb=this.BY[rb])rb.update(eb),rb.qIj()};a.prototype.BD=function(rb,eb,Ta,fb){Ta=void 0===Ta?null:Ta;fb=void 0===fb?null:fb;var pb=!1;if(this.MB(rb))Ta=this.BY[rb].get_visible();else{this.set_visible(!0);var rc=a.q1e()[rb];this.BY[rb]=this.k$(rb,eb,Ta,fb);Ta=!1;pb=!0;fb="";var vb=0;eb&&(fb=eb.MessageIdName,vb=eb.MessageId);
var E=rc.a7c;B.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",rb,Eb.PageLoadTrackingInfo.instance.naa(new Date));Mb.a(this.$).LHd(rc.hash,fb,vb,W.a.Yyc,!0,1,eb,E)}Ta||!Array.contains(ma.a.$ac(),rb)&&!pb||(this.BY[rb].set_visible(!0),this.$.OH())};a.prototype.removeEntry=function(rb){return this.F2i(rb)};a.prototype.PFd=function(){ia.a.pc(this.BY);this.BY=Array(65);this.set_visible(!1)};a.prototype.F2i=function(rb){if(!this.MB(rb))return!1;
ia.a.Fa(this.BY[rb]);this.BY[rb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.OH();return!0};a.prototype.k$=function(rb,eb,Ta,fb){Ta=void 0===Ta?null:Ta;fb=void 0===fb?null:fb;var pb=a.q1e()[rb],rc=!!(this.$.Fd&64);switch(rb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:rb=new Y.a(this,pb);break;case 12:case 29:case 30:case 31:case 32:case 55:rb=rc?new w(this,pb,-8805455):new Y.a(this,pb);break;case 22:rb=new G(this,pb,-8805455);break;case 44:case 43:rb=rc?new z(this,
pb,eb,0,-8805455):new r(this,pb,eb,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:rb=new r(this,pb,eb,0);break;case 19:rb=new Y.a(this,pb);break;case 45:rb=new r(this,pb,eb,0);break;case 6:case 14:rb=new v(this,pb,eb.HelpTopicId);break;case 64:rb=new u(this,pb,eb.HelpTopicId);break;case 36:rb=new u(this,pb,ba.a.D7g);break;case 16:rb=new Y.a(this,pb);rb.title=R.a.If(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);rb.message=R.a.If(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:rb=new w(this,pb,-1762562205);rb.Svb=!0;break;case 20:rb=new c(this,pb);break;case 21:case 54:rb=new Y.a(this,pb);break;case 28:rb=new Y.a(this,pb);break;case 24:rb=new k(this,pb);break;case 27:rb=new n(this,pb);break;case 37:rb=new Da.a(this,pb);break;case 38:rb=new S.a(this,pb);break;case 39:rb=new Fb.a(this,pb);break;case 40:rb=new Gb.a(this,pb);break;case 46:rb=new Y.a(this,pb);break;case 47:rb=new Y.a(this,pb);break;case 48:rb=new Y.a(this,pb);break;case 49:rb=new Y.a(this,pb);
break;case 50:rb=new Y.a(this,pb);break;case 51:rb=new va.a(this,pb);break;case 52:rb=new wa.a(this,pb);break;case 53:rb=new A(this,pb);break;case 5:rb=new m(this,pb);break;case 56:rb=new w(this,pb,-1753056834);eb?(eb=eb.Directive,Ja.a.wn(eb)||"&nbsp;"===eb||(rb.message=eb)):Ta&&(rb.message=Ta);break;case 57:rb=new l(this,pb);break;case 58:rb=new Y.a(this,pb);break;case 59:case 62:rb=new u(this,pb,ba.a.Twi);break;case 60:rb=new f(this,pb,ba.a.$Ig,-8805455);break;case 61:rb=new w(this,pb,515196233);
break;case 63:rb=new d(this,pb,this.$,fb);break;default:rb=new r(this,pb,eb,7)}rb.I1c();return rb};a.q1e=function(){var rb=wb.a.h5a()?259:258;return a.rse||(a.rse=[new t(0,274,275,276,0,0,a.mIa,"BB_UnableToRefreshLock"),new t(1,274,275,276,0,0,a.mIa,"BB_UnableToRefreshLockExpected"),new t(2,266,267,0,0,0,a.KF,"BB_WorkbookAlmostTooLarge"),new t(3,268,269,270,0,0,a.mIa,"BB_WorkbookTooLarge"),new t(4,257,rb,0,0,0,a.KF,"BB_ExternalWorkbookLinksDisabled"),new t(5,261,260,262,0,0,a.mIa,"BB_ExternalWorkbookLinksShowError"),
new t(6,263,264,265,0,0,a.Xj,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new t(7,249,250,251,0,0,a.Xj,"BB_UnsupportedFeatures"),new t(8,0,0,0,0,0,a.Xj,"BB_CollabDataAndDataStringsLocaleMismatch"),new t(9,0,0,0,0,0,a.Xj,"BB_CollabDataStringsLocaleMismatch"),new t(10,0,0,0,0,0,a.Xj,"BB_CollabDataLocaleMismatch"),new t(11,277,278,279,0,0,a.mIa,"BB_LastGenericStatusError"),new t(12,280,281,282,0,0,a.KF,"BB_ScratchPadWarning"),new t(13,283,284,285,0,0,a.mIa,"BB_AuthenticationLost"),new t(14,286,287,288,
0,0,a.KF,"BB_OdfCompatibilityIssues"),new t(15,0,565,0,0,0,a.KF,"BB_PivotChartInteractivityMissingWarning"),new t(16,0,0,0,0,0,a.Xj,"BB_WorkbookIsIrmProtected"),new t(17,0,0,0,0,0,a.Xj,"BB_BIFeatureNotAvailable"),new t(18,289,290,285,0,0,a.KF,"BB_AnonymousCreateMode"),new t(19,252,253,0,0,0,a.KF,"BB_UnsupportedInteractiveReportEditing"),new t(20,0,0,0,0,0,a.Xj,"BB_MobileAppCampaignBizBar"),new t(21,295,296,0,0,0,a.Xj,"BB_TransientServerCommunicationFailures"),new t(22,1591,1602,1603,0,0,a.Xj,"BB_EditAttemptInReadOnly"),
new t(23,1591,1602,0,0,0,a.Xj,"BB_EditAttemptInReadOnlyNoEditPermissions"),new t(24,0,Ya.HelperMethods.RHj(),1580,0,0,a.Xj,"BB_UnsupportedBrowser"),new t(25,298,299,0,0,0,a.Xj,"BB_ReadOnlyPermissions"),new t(26,300,301,0,0,0,a.Xj,"BB_DocumentIsIrmProtectedWarning"),new t(27,0,0,0,0,0,a.KF,"BB_PolicyWarningMessage"),new t(28,1239,297,0,0,0,a.Xj,"BB_WorkingOnIt"),new t(29,1591,1589,1590,0,0,a.Xj,"BB_PasswordProtectedWorkbookLockedForEdit"),new t(30,1604,1605,1606,0,0,a.Xj,"BB_WorkbookIsReadOnlyRecommended"),
new t(31,1591,1607,1608,0,0,a.Xj,"BB_WorkbookHasPasswordToModify"),new t(32,1591,1609,1612,0,0,a.Xj,"BB_LegacySharedWorkbookEditWarning"),new t(33,1599,1610,251,0,0,a.Xj,"BB_LegacyConnectionsWarning"),new t(34,1600,1601,0,0,0,a.Xj,"BB_GroupedSlicers"),new t(35,311,312,0,0,0,a.KF,"BB_ThirdPartyAddinDisabled"),new t(36,1732,1733,0,0,1734,a.Xj,"BB_FinanceLinkedEntityDisclaimerBar"),new t(37,0,0,0,0,0,a.Xj,"BB_WacGdprNotice"),new t(38,0,0,0,0,0,a.Xj,"BB_AutomaticSensitivityLabel"),new t(39,0,0,0,0,0,
a.Xj,"BB_RecommendedSensitivityLabel"),new t(40,0,0,0,0,0,a.Xj,"BB_MandatorySensitivityLabel"),new t(41,313,314,315,0,0,a.Xj,"BB_LocalStorageDisabled"),new t(42,622,623,0,0,0,a.Xj,"BB_AutoRefreshDisabled"),new t(43,980,978,982,1268,0,a.Xj,"BB_CorruptedFileRepaired"),new t(44,981,979,982,1268,0,a.Xj,"CorruptedOdsFileRepaired"),new t(45,271,272,273,0,0,a.KF,"BB_MinorVersionLimitReached"),new t(46,302,303,0,0,0,a.KF,"BB_SensitivityApplicationGenericError"),new t(47,304,306,0,0,0,a.KF,"BB_SensitivityApplicationTooLargeFileError"),
new t(48,305,306,0,0,0,a.KF,"BB_SensitivityApplicationLabelNotSupportedError"),new t(49,307,308,0,0,0,a.KF,"BB_SensitivityApplicationLabelDisabledError"),new t(50,309,310,0,0,0,a.KF,"BB_SensitivityApplicationMandatoryConflictError"),new t(51,0,0,0,0,0,a.KF,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new t(52,0,0,0,0,0,a.KF,"BB_SensitivityApplicationSetLabelError"),new t(53,2052,2053,2054,2057,0,a.Xj,"BB_ExternalWorkbookLinksPromptEnableContent"),new t(54,295,296,0,0,0,a.Xj,"BB_NetworkDown"),
new t(55,316,317,318,0,0,a.Xj,"BB_DefaultToViewDueToCogs"),new t(56,1758,1759,1760,0,0,a.Xj,"BB_RefreshLinkedEntityErrorBar"),new t(57,1735,1736,1737,1738,0,a.Xj,"BB_LinkedEntitiesUntrustedImagesDisabled"),new x(58,248,0,0,0,a.Xj,"BB_CanvasHealth"),new t(59,319,320,0,0,321,a.Xj,"BB_NovModeDepreciation"),new t(60,983,984,1268,0,985,a.Xj,"BB_MismatchedFileFormatConverted"),new t(61,2162,2163,2164,0,0,a.Xj,"BB_OptimizeWorkbook"),new t(62,322,323,0,0,324,a.Xj,"BB_NovModePostDepreciation"),new t(63,2200,
0,0,0,0,a.Xj,"BB_OfficeScriptsRunning"),new t(64,2141,2142,0,0,2143,a.Xj,"BB_PowerQueryRefreshDataSourceNotSupported")])};tl.Object.defineProperties(a.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return Lb.a.hXc}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.mIa="ewa-mb-error";a.KF="ewa-mb-warning";
a.Xj="ewa-mb-info";a.rse=null;Object(y.a)(a,"BusinessBarControl",Q.a,[107])},1238:function(y,D,b){function a(){this.bib=!!m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Lu}function d(w,B,U){var N=n.call(this,w,B,U)||this;w={};w=(w.errorMessage=N.wJe,w.errorFileDownloadOffer=N.Urb,w);B={};w.helpLink=(B.type="AppLinkProps",B.id="helpLink",B.text=N.nva,B.onExecute=function(P){N.CNa(P)},B);B=new G.a(!1,!1,!0);B.kc=1;B.Cc(1,N.Vrb);B.Me=N.id;U={};w=(U.id=N.id,U.dialogIcon=N.icon,U.bodyControls=
w,U);B.initializeAndShow(N.Wn,Object(u.a)(N,N.gEd,"reactOICErrorDialogHandler"),w);return N}function c(w,B,U,N){var P=f.call(this,w,B,U,N)||this;w={};w=(w.errorMessage=P.errorMessage,w);B={};w.helpLink=(B.type="AppLinkProps",B.id="helpLink",B.text=P.nva,B.onExecute=function(ia){P.CNa(ia)},B);P.nvc?(w.macOfficePreLinkText=P.flf,B={},w.macOfficeLink=(B.type="AppLinkProps",B.id="macOfficeLink",B.text=P.clf,B.onExecute=function(ia){P.Lwd(ia)},B),w.macOfficePostText=P.elf):P.W1b&&(w.errorFileDownloadOffer=
P.Urb);B=new G.a(!1,!1,!0);P.W1b?(B.kc=1,B.Cc(1,P.Vrb)):B.kc=0;B.Me=P.id;U={};w=(U.id=P.id,U.dialogIcon=P.icon,U.bodyControls=w,U);B.initializeAndShow(P.Wn,Object(u.a)(P,P.gEd,"reactOICErrorDialogHandler"),w);return P}function k(w,B,U){w=n.call(this,w,B,U)||this;w.Ql=null;B=document.createElement("span");B.id="errorMessageText";B.innerText=w.wJe;B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));w.Ql=document.createElement("a");w.Ql.href="#";w.Ql.innerText=w.nva;
B.appendChild(w.Ql);z.a.addHandler(w.Ql,"click",Object(u.a)(w,w.CNa,"oicErrorHelpLinkHandler"));B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));U=document.createElement("span");U.innerText=w.Urb;B.appendChild(U);U=new r.StandardDialog;U.Me=w.id;U.kc=1;U.Cc(1,w.Vrb);U.Kk(w.Wn,null,w.icon,Object(u.a)(w,w.frd,"legacyOICErrorDialogHandler"),B);U.zW("errorMessageText");return w}function n(w,B,U){this.EX=B;this.FX=w;this.lD=U}function l(w,B,U,N){w=f.call(this,w,B,
U,N)||this;w.Ql=null;w.Qpa=null;B=document.createElement("span");B.id="errorMessageText";B.innerText=w.errorMessage;B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));w.Ql=document.createElement("a");w.Ql.href="#";w.Ql.innerText=w.nva;B.appendChild(w.Ql);z.a.addHandler(w.Ql,"click",Object(u.a)(w,w.CNa,"oicErrorHelpLinkHandler"));U=new r.StandardDialog;U.Me=w.id;if(w.nvc){N=document.createElement("span");var P=document.createElement("span");N.innerText=w.flf;P.innerText=
w.elf;w.Qpa=document.createElement("a");w.Qpa.href="#";w.Qpa.innerText=w.clf;B.appendChild(document.createElement("br"));B.appendChild(N);B.appendChild(w.Qpa);B.appendChild(P);z.a.addHandler(w.Qpa,"click",Object(u.a)(w,w.Lwd,"oicErrorMacOfferLinkHandler"))}else w.W1b&&(B.appendChild(document.createElement("br")),B.appendChild(document.createElement("br")),N=document.createElement("span"),N.innerText=w.Urb,B.appendChild(N));w.W1b?(U.kc=1,U.Cc(1,w.Vrb)):U.kc=0;U.Kk(w.Wn,null,w.icon,Object(u.a)(w,w.frd,
"legacyOICErrorDialogHandler"),B);U.zW("errorMessageText");return w}function f(w,B,U,N){this.aLc=null;this.iQb=N;this.EX=w;this.FX=B;this.lD=U;this.lee=this.dlf.Bpj;w=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Jng=w[0];this.Ing=w[1]}y=b(0);var u=b(80),v=b(13),m=b(5),A=b(49),x=b(410),t=b(86);f.prototype.gEd=function(w){this.JBb(w)};f.prototype.frd=function(w){this.JBb(w)};f.prototype.JBb=function(w){var B=10;this.FX&&1===w&&(this.FX(this.lD),B=1);this.EX&&this.EX(this.lD);this.nF(B)};
f.prototype.CNa=function(){x.Redirect.showHelp("OICFailure");this.nF(2)};f.prototype.Lwd=function(){this.dlf.Zgf();this.nF(4)};f.prototype.nF=function(w){v.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.iQb,w);m.AFrameworkApplication.trc(A.a.BBf,this.iQb,w)};f.prototype.dispose=function(){this.lD=this.EX=this.FX=null};tl.Object.defineProperties(f.prototype,{dlf:{configurable:!0,enumerable:!0,get:function(){return this.aLc||(this.aLc=t.a.instance.resolve("Common.IMacOfficeOffer"))}},
id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},nvc:{configurable:!0,enumerable:!0,get:function(){return this.lee}},flf:{configurable:!0,enumerable:!0,get:function(){return this.Jng}},elf:{configurable:!0,enumerable:!0,get:function(){return this.Ing}},clf:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.lee?3:2}},Urb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},W1b:{configurable:!0,enumerable:!0,get:function(){return!!this.FX}},Vrb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Wn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(f,"AOICErrorDialog",null,[3]);var z=b(40),r=b(128);vm(l,f);l.prototype.dispose=function(){this.Ql&&(z.a.removeHandler(this.Ql,"click",Object(u.a)(this,this.CNa,"oicErrorHelpLinkHandler")),this.Ql=null);this.Qpa&&(z.a.removeHandler(this.Qpa,"click",Object(u.a)(this,this.Lwd,"oicErrorMacOfferLinkHandler")),this.Qpa=null);f.prototype.dispose.call(this)};Object(y.a)(l,"OICErrorDialog",f,[]);n.prototype.gEd=function(w){this.JBb(w)};n.prototype.frd=function(w){this.JBb(w)};n.prototype.JBb=function(w){var B=
10;1===w&&(this.FX(this.lD),B=1);this.EX&&this.EX(this.lD);this.nF(B)};n.prototype.CNa=function(){x.Redirect.showHelp("OICFailure");this.nF(2)};n.prototype.nF=function(w){m.AFrameworkApplication.trc(A.a.CBf,3,w)};n.prototype.dispose=function(){this.lD=this.FX=this.EX=null};tl.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},wJe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},
nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Urb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Vrb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Wn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(n,"AOICErrorDialogWithDownload",
null,[3]);vm(k,n);k.prototype.dispose=function(){this.Ql&&(z.a.removeHandler(this.Ql,"click",Object(u.a)(this,this.CNa,"oicErrorHelpLinkHandler")),this.Ql=null);n.prototype.dispose.call(this)};Object(y.a)(k,"OICErrorDialogWithDownload",n,[]);var G=b(140);vm(c,f);Object(y.a)(c,"ReactOICErrorDialog",f,[]);vm(d,n);Object(y.a)(d,"ReactOICErrorDialogWithDownload",n,[]);b.d(D,"a",function(){return a});a.prototype.v3g=function(w,B,U){this.bib?new c(w,B,null,U):new l(w,B,null,U)};a.prototype.w3g=function(w,
B,U){this.bib?new d(w,B,U):new k(w,B,U)};a.prototype.x3g=function(w,B,U,N,P){var ia=b(1315).ReactOICErrorDialogWithTrial,W=b(1316).OICErrorDialogWithTrial;this.bib?new ia(w,B,U,null,N,P):new W(w,B,U,null,N,P)};tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Na||(a.Na=new a)}}});a.Na=null;Object(y.a)(a,"OICErrorDialogFactory",null,[795])},1258:function(y,D,b){function a(Z,xa){var na=ma.call(this)||this;na.Ma=new u.a;na.wT=null;na.QFc=[];na.Skc=function(){na.$.qa.hLa?
na.removeEntry(13):na.hg(13,null)};na.Txa=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");na.removeEntry(21);na.MB(54)&&(c.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),na.removeEntry(54));na.XNf("OnNetworkResumed")};na.Zh=function(Ia,Ma){Ia=0;for(var lb=a.$ac().length;Ia<lb;Ia++){var zb=a.$ac()[Ia];na.removeEntry(zb)}Ma.context&&
0<Ma.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),na.removeEntry(21));na.XNf("OnWebMethodSuccess")};na.Xo=function(Ia,Ma){var lb;Ia=na.Euh(Ma.errors);for(var zb=[],Ya=0,Wb=Ia.length;Ya<Wb;++Ya){var Zb=Ia[Ya];if(1===Zb.Type&&Zb.Appearance&32)zb=na.BYh(Zb,zb);else if(Ma.rgj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var da=(null===(lb=Ma.context)||void 0===lb?0:lb.stopwatch)?Ma.context.stopwatch.Ac:-1;5E3>da?c.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",da):k.AFrameworkApplication.Lod()||na.Lyg(Zb,Ma.context.methodName)}da=[].concat(Fl(a.$ac()));for(var za=0,hb=zb.length;za<hb;++za){var Gb=zb[za];na.hg(Gb,Zb);Array.remove(da,Gb)}Zb=0;for(za=da.length;Zb<za;++Zb)na.removeEntry(da[Zb])}};
na.FCb=function(Ia,Ma){Ia=0;for(var lb=Ma.errors.length;Ia<lb;++Ia){var zb=Ma.errors[Ia];k.AFrameworkApplication.Lod()||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),na.hg(54,zb))}};na.Zc=function(Ia,Ma){na.qd(Ia,Ma)};na.qd=function(){var Ia=na.$.fa;Ia.oc||Ia.Qg()||(na.PFd(),Array.clear(na.QFc))};na.od=function(Ia,Ma){na.$.fa.Qg()&&!Ma.CQ||na.t7e(Ma.CQ)};na.rDb=function(){var Ia=
na.$.userOperationManager.Mac();Ia&&Ia.operation.flags&1&&na.z_f()};na.Ouf=function(){na.z_f()};na.Kf=function(){na.hve();na.I_f()};na.hN=function(){if(na.$.T4&&na.$.fa.Qg()&&na.$.fa.oc)if(na.$.fa.isEditMode)na.removeEntry(43),na.removeEntry(12),na.removeEntry(29),na.removeEntry(30),na.removeEntry(31),na.removeEntry(32),na.removeEntry(22),na.removeEntry(55);else{var Ia=na.$.da.Aa(331);Ia&&Ia.HIa||na.removeEntry(53);na.removeEntry(5)}};na.$=Z;na.XXa=xa;na.mHg();k.AFrameworkApplication.Hd&&k.AFrameworkApplication.Hd.ASc(na);
na.Flb=Array(65);for(var pa=0;65>pa;pa++)na.Flb[pa]=null;na.Pg=W.EcmaDateClock.instance;na.Sff=na.Pg.Kb.getTime();xa&&(xa=Z.qa,pa=xa.uf,xa.FB(na.Xo),xa.us(na.Zh),xa.cmb(na.Skc),xa.zXa(na.Skc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(pa.mBg(na.FCb),pa.omb(na.Txa)),Z.fa.Sj(na.Zc),Z.fa.jt(na.Kf),Z.Rk(na.od),Z.Vl(na.qd),Z.fa.i9(na.hN),Z.userOperationManager.uy(na.rDb),I.EwaSettings.la(169)&&Z.fa.jh.get(45)&&k.AFrameworkApplication.ga.ra("SupportsPolicies")||na.l3e(),
na.t7e(ba.c(Z)));Z.da.Ha(5,na);return na}function d(Z,xa,na){na=void 0===na?null:na;var pa=t.call(this)||this;pa.cob=Z;pa.k5c=xa;pa.data=na;return pa}y=b(0);var c=b(13),k=b(5),n=b(88),l=b(23),f=b(135),u=b(36),v=b(74),m;(function(Z){Z[Z.unableToRefreshLock=0]="unableToRefreshLock";Z[Z.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";Z[Z.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";Z[Z.workbookTooLarge=3]="workbookTooLarge";Z[Z.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";
Z[Z.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";Z[Z.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";Z[Z.unsupportedFeatures=7]="unsupportedFeatures";Z[Z.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";Z[Z.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";Z[Z.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";Z[Z.lastGenericStatusError=11]="lastGenericStatusError";Z[Z.scratchPadWarning=
12]="scratchPadWarning";Z[Z.authenticationLost=13]="authenticationLost";Z[Z.odfCompatibilityIssues=14]="odfCompatibilityIssues";Z[Z.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";Z[Z.workbookIsIrmProtected=16]="workbookIsIrmProtected";Z[Z.biFeatureNotAvailable=17]="biFeatureNotAvailable";Z[Z.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";Z[Z.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";Z[Z.mobileAppCampaignBizBar=20]=
"mobileAppCampaignBizBar";Z[Z.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";Z[Z.editAttemptInReadOnly=22]="editAttemptInReadOnly";Z[Z.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";Z[Z.unsupportedBrowser=24]="unsupportedBrowser";Z[Z.readOnlyPermissions=25]="readOnlyPermissions";Z[Z.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";Z[Z.policyWarningMessage=27]="policyWarningMessage";Z[Z.workingOnIt=28]="workingOnIt";
Z[Z.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";Z[Z.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";Z[Z.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";Z[Z.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";Z[Z.legacyConnectionsBB=33]="legacyConnectionsBB";Z[Z.groupedSlicersBB=34]="groupedSlicersBB";Z[Z.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";Z[Z.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";
Z[Z.wacGdprNotice=37]="wacGdprNotice";Z[Z.automaticSensitivityLabel=38]="automaticSensitivityLabel";Z[Z.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";Z[Z.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";Z[Z.localStorageDisabled=41]="localStorageDisabled";Z[Z.autoRefreshDisabled=42]="autoRefreshDisabled";Z[Z.corruptedFileRepaired=43]="corruptedFileRepaired";Z[Z.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";Z[Z.minorVersionLimitReached=45]="minorVersionLimitReached";
Z[Z.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";Z[Z.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";Z[Z.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";Z[Z.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";Z[Z.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";Z[Z.sensitivityApplicationMinorVersionLimitReachedError=
51]="sensitivityApplicationMinorVersionLimitReachedError";Z[Z.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";Z[Z.promptEnableExternalLinks=53]="promptEnableExternalLinks";Z[Z.networkDown=54]="networkDown";Z[Z.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";Z[Z.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";Z[Z.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";Z[Z.canvasHealth=58]="canvasHealth";Z[Z.novModeDepreciation=
59]="novModeDepreciation";Z[Z.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";Z[Z.optimizeWorkbook=61]="optimizeWorkbook";Z[Z.novModePostDepreciation=62]="novModePostDepreciation";Z[Z.officeScriptsRunning=63]="officeScriptsRunning";Z[Z.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";Z[Z.count=65]="count"})(m||(m={}));Object(y.b)("EwaBusinessBarEntryType",m);var A=b(4),x=b(1175),t=Sys.EventArgs;vm(d,t);Object(y.a)(d,"BusinessBarEntryDisplayChangedEventArgs",
Sys.EventArgs,[]);var z=b(1177),r=b(1176),G=b(1179),w=b(1178),B=b(1173),U=b(476),N=b(56),P=b(218),ia=b(35),W=b(691),R=b(27),I=b(1),Q=b(8),O=b(20),ba=b(53),ca=b(64),S=b(975),Y=b(176);b.d(D,"a",function(){return a});var ma=v.a;vm(a,ma);a.prototype.l3e=function(){R.a.Pq(this.$.fa.dF)&&this.Xo(this,new U.a(this.$.fa.dF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.qzg=function(Z){this.Ma.addHandler("bBarAttachedOrDetached",Z)};a.prototype.dispose=function(){if(this.$){var Z=this.$,xa=Z.qa,na=xa.uf;xa.VC(this.Xo);
xa.Lt(this.Zh);xa.zqc(this.Skc);xa.$Fb(this.Skc);na.mGb(this.Txa);na.q5i(this.FCb);Z.fa.kk(this.Zc);Z.fa.mw(this.Kf);Z.ml(this.od);Z.En(this.qd);Z.fa.v6(this.hN);Z.userOperationManager.pz(this.rDb);O.g(Z).Kc.im(this.Ouf)}n.a.Fa(this.wT);this.$=this.wT=null;ma.prototype.dispose.call(this)};a.prototype.o9h=function(Z){switch(Z){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return I.EwaSettings.la(682);default:return!1}};a.prototype.hg=function(Z,xa,na,pa,Ia){na=void 0===na?null:na;pa=
void 0===pa?null:pa;Ia=void 0===Ia?null:Ia;if(!this.$.isMobileMode||this.o9h(Z))this.XXa&&!this.MB(Z)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(m,Z)),this.Flb[Z]=this.Pg.z7,this.wT.BD(Z,xa,pa,Ia),this.Ma.raiseEvent("bBarAttachedOrDetached",new d(Z,!0,na))),xa&&32===xa.Appearance&&ca.a(this.$).nd.Oka(xa)};a.prototype.psj=function(Z,xa,na,pa){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
B.a.initialize(Z,xa,na,pa);this.hg(37,null)};a.prototype.rrj=function(Z,xa,na,pa){x.a.initialize(Z,xa,na,pa);this.hg(38,null)};a.prototype.Dtj=function(Z,xa,na,pa){r.a.initialize(Z,xa,na,pa);this.hg(39,null)};a.prototype.Ssj=function(Z,xa,na,pa){z.a.initialize(Z,xa,na,pa);this.hg(40,null)};a.prototype.Ntj=function(Z,xa,na,pa){w.a.initialize(Z,xa,na,pa);this.hg(51,null)};a.prototype.Mtj=function(Z,xa,na,pa){G.a.initialize(Z,xa,na,pa);this.hg(52,null)};a.prototype.removeEntry=function(Z){this.XXa&&
(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(m,Z)),this.Flb[Z]=null,this.wT.removeEntry(Z)&&this.Ma.raiseEvent("bBarAttachedOrDetached",new d(Z,!1)))};a.prototype.Y4a=function(Z){return this.XXa?this.wT.Y4a(Z):!1};a.prototype.MB=function(Z){return this.XXa?this.wT.MB(Z):!1};a.prototype.eBb=function(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};
a.prototype.gkc=function(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.mHg=function(){var Z=b(1231).BusinessBarControl;if(this.XXa&&!this.wT){O.g(this.$).Kc.wm(this.Ouf);var xa=document.getElementById(this.$.Ib+A.a.tse);this.wT=new Z(this.$,xa)}};a.prototype.PFd=function(){this.XXa&&this.wT.PFd()};a.prototype.XNf=function(Z){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var xa=
this.Pg.z7;if(3E5<=xa-this.Sff){this.Sff=xa;for(var na=0;65>na;na++){var pa=this.Flb[na];pa&&(pa=xa-pa,3E5<=pa&&c.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",Z,Enum.toString(m,na),pa))}}}};a.prototype.Euh=function(Z){for(var xa=[],na=yl(Z),pa=na.next();!pa.done;pa=na.next())switch(pa.value.MessageId){case -113742550:pa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.fa.isNamedObjectViewMode||R.a.hh(Z,
pa))&&Array.add(xa,-113742550)}return R.a.jF(Z,xa)};a.prototype.BYh=function(Z,xa){switch(Z.MessageId){case 2113407564:for(var na=R.a.XYa([1821390342,-943219229,-502303485,1437034227]),pa=0;pa<na.length;pa++)na[pa].HelpTopicId=Z.HelpTopicId,na[pa].HelpDescription=Z.HelpDescription,Array.add(this.QFc,na[pa])}switch(Z.MessageId){case -395951567:this.hg(6,Z);break;case 1643490758:this.hg(4,Z);break;case -907264831:this.hg(5,Z);break;case 757111532:case 2113407564:this.hg(7,Z);break;case 2010656511:this.hg(15,
Z);break;case 1321660996:this.$.M3c=!0;this.hg(8,Z);break;case 526339737:this.$.M3c=!0;this.hg(9,Z);break;case -407088521:this.hg(10,Z);break;case 1756116017:this.hg(14,Z);break;case -1703455218:this.hg(17,Z);break;case 1393475740:this.hg(25,Z);break;case -949523941:this.hg(26,Z);break;case 1779381952:this.hg(42,Z);break;case 1421575100:this.hg(43,Z);break;case 613676060:this.hg(44,Z);break;case 1233668252:this.hg(60,Z);break;case 1911608588:Z=!!(this.$.Fd&64);!this.$.fa.Qg()&&Z&&Array.add(xa,29);
break;case 1544494907:break;case -655555355:Array.add(xa,this.$od()?1:0);break;case -1221382671:Array.add(xa,2);break;case 1662282929:Array.add(xa,3);break;case 104919273:this.$.fa.Qg()||Array.add(xa,30);break;case -689453604:Z=!!(this.$.Fd&64);this.$.fa.A4e=!0;!this.$.fa.Qg()&&Z&&Array.add(xa,31);break;case 157762400:this.$.fa.kfc=!0;!this.$.fa.Qg()&&this.$.Fd&64&&!this.$.isEditMode&&Array.add(xa,32);break;case -73730134:I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableEditingOfFilesWithLegacyConnections",
!1)&&!this.$.fa.Qg()&&this.$.Fd&64&&Array.add(xa,33);break;case -293349236:Array.add(xa,64);break;case -37299333:break;case 136737622:Array.add(xa,45);break;case -1780327030:this.hg(53,Z);break;case -113742550:this.hg(55,Z);break;default:this.hg(11,Z)}return xa};a.prototype.D3h=function(){var Z=this;if(k.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!S.a.Rmd(S.a.pbd(1))&&(l.a.Ip||l.a.Yg)){var xa=N.GetServiceTaskFactory.create(this.$.da,155,this.$.ma,1);ia.TaskExtensions.Ba(xa,function(){Z.hg(20,
null)},this.ma,3)}};a.prototype.A3h=function(){var Z=I.EwaSettings.la(73),xa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",!1),na=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);Q.HelperMethods.JOd(na||xa,Z)&&(Y.a("NewBrowserSuggestionShown"),na||f.a.vw("NewBrowserSuggestionShown","true",7),this.hg(24,null))};a.prototype.W2h=function(Z){!Z&&P.g(this.$)&&this.hg(59,null)};a.prototype.X2h=function(Z){!Z&&
P.h(this.$)&&this.hg(62,null)};a.prototype.t7e=function(Z){(!Z&&!this.$.printingEnabled||this.$.ig.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.hg(16,null));this.D3h();this.A3h();this.hve();this.I_f();this.W2h(Z);this.X2h(Z)};a.prototype.hve=function(){this.$.workbookContext.Options&32768&&this.dsj()};a.prototype.dsj=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:5776164_DoNotShowFinanceBizBarOnColumnResize")&&
this.Flb[36]||this.hg(36,null)};a.prototype.I_f=function(){I.EwaSettings.la(682)&&this.$.workbookContext.Options&524288&&this.hg(57,null)};a.prototype.f0f=function(Z,xa){this.hg(56,Z,null,xa)};a.prototype.zje=function(Z,xa){var na=null,pa=null;na=void 0===na?null:na;pa=void 0===pa?null:pa;xa=void 0===xa?null:xa;this.wT.MB(Z)?this.wT.lMb(Z,xa):this.hg(Z,null,na,pa,xa)};a.prototype.z_f=function(){this.$.Fd&8&&this.hg(12,null)};a.prototype.$od=function(){var Z=this.$.da.Aa(38);return Z?Z.tokenExpired:
!1};a.prototype.Lyg=function(Z,xa){if(!this.MB(21)&&-1387426400!==Z.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var na={};na.FailedMethod=xa;this.hg(21,Z,na)}};a.$ac=function(){return a.Ome||(a.Ome=[0,1,2,3])};tl.Object.defineProperties(a.prototype,{n6c:{configurable:!0,enumerable:!0,get:function(){return this.QFc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.wT?this.wT.domElement:null}}});a.Ome=null;
Object(y.a)(a,"BusinessBarManager",v.a,[571,3,117])},1273:function(y,D,b){function a(A,x,t,z,r,G){this.nMc=null;this._id=A;this.VMc=x;this.Vkg=void 0===r?null:r;this.Whb=z;this.jkb=void 0===G?null:G;this.Coa=null;this.RWa=t;this.Ikb=d.instance.kSh(x,A)}function d(){this.VCc=new f.a;this.TCc=new f.a;this.SCc=new f.a;this.nLg(this.VCc);this.mLg(this.TCc);this.lLg(this.SCc);this.XHc=new f.a;this.WHc=new f.a;this.VHc=new f.a;this.INg(this.XHc);this.HNg(this.WHc);this.GNg(this.VHc);this.jEc=new f.a;this.GLg(this.jEc);
this.UEa(this.jEc);this.UEa(this.SCc);this.UEa(this.TCc);this.UEa(this.VCc);this.UEa(this.WHc);this.UEa(this.XHc);this.UEa(this.VHc)}y=b(0);var c=b(13),k=b(80),n=b(991),l=b(975),f=b(1253);d.prototype.kSh=function(A,x){switch(A){case 1:return this.pVh(x);case 2:return this.NCh(x)}return l.a.Avc?this.jEc:null};d.prototype.nLg=function(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};
d.prototype.mLg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};d.prototype.lLg=function(A){A.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};d.prototype.INg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);A.add("OverlayBig","Get the Word app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1",
"Discover Word");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.GLg=function(A){A.add("Headline","Get the Office Online extension for Chrome");A.add("UseAppButton","Get the extension");A.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};d.prototype.HNg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);A.add("OverlayBig","Get the PowerPoint app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover PowerPoint");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.GNg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};d.prototype.UEa=function(A){A.add("Corporation","Microsoft Corporation")};d.prototype.pVh=function(A){switch(A){case 3:return this.XHc;case 2:return this.WHc;case 1:return this.VHc}return null};
d.prototype.NCh=function(A){switch(A){case 3:return this.VCc;case 2:return this.TCc;case 1:return this.SCc}return null};tl.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){d.Na||(d.Na=new d);return d.Na}}});d.Na=null;Object(y.a)(d,"WildFireStringFactory",null,[]);var u=b(5),v=b(47),m=b(23);b.d(D,"a",function(){return a});a.prototype.I1c=function(){this.Coa=new n.a(this.title,this.message,null);this.Coa.addButton(this.Cse,Object(k.a)(this,this.hrf,"onButtonOneClick"),
"");this.RWa&&this.Coa.Yxg(this.Ese,Object(k.a)(this,this.krf,"onButtonTwoClick"));this.Coa.U9=Object(k.a)(this,this.yFe,"dismissBar");this.Coa.image=3;this.Coa.id=16;this.Coa.closeable=!0};a.prototype.hrf=function(){this.RWa?this.B6h():this.hMj()};a.prototype.krf=function(){this.RWa&&this.iNi()};a.prototype.B6h=function(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Whb&&this.jkb&&this.jkb();l.a.zJf(this._id,this.VMc)};a.prototype.iNi=function(){this.openUrl&&
(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Whb&&this.jkb&&this.jkb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(l.a.Jne(this._id),this.openUrl,0,!1))};a.prototype.hMj=function(){l.a.Avc?this.PNg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),l.a.SMd("BizBarClicked"),1!==this.VMc&&2!==this.VMc||l.a.qUg(this.openUrl,this.Whb,this._id,this.jkb))};a.prototype.PNg=function(){this.Whb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):
c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");v.a.wU(u.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Tah=function(){this.Whb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");l.a.SMd(l.a.Ive)};a.prototype.yFe=function(){l.a.Avc?this.Tah():(l.a.SMd(l.a.pbd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.i3b=function(){var A=u.AFrameworkApplication.sa.Pa,
x=new a(A.Lj,l.a.Yac(),8<m.a.f4a,1===A.Kba,function(){return A.NB},A.pRf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return x};tl.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Ikb.na("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Ikb.na("CallToAction")}},qMj:{configurable:!0,enumerable:!0,get:function(){return this.RWa}},Cse:{configurable:!0,enumerable:!0,get:function(){return this.RWa?this.Ikb.na("InstallButton"):
this.Ikb.na("UseAppButton")}},Ese:{configurable:!0,enumerable:!0,get:function(){return this.RWa?this.Ikb.na("OpenAppButton"):""}},MNg:{configurable:!0,enumerable:!0,get:function(){return this.Coa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.nMc||(this.nMc=this.Vkg());return this.nMc}}});Object(y.a)(a,"WildFireBusinessBar",null,[])},1315:function(y,D,b){function a(l,f,u,v,m,A){var x=n.call(this,l,f,u,v,m,A)||this;l={};f=(l.errorMessage=x.vJe,l.offerString=x.Jpf,l);l=new k.a(!1,!1,!0);
x.A_f?(l.kc=1,u={},f.helpLink=(u.type="AppLinkProps",u.id="helpLink",u.text=x.nva,u.onExecute=function(){c.Redirect.showHelp(x.h5e)},u)):(l.kc=4,l.Cc(2,x.v6e));l.Cc(1,x.tWb);l.Me=x.id;u={};f=(u.id=x.id,u.dialogIcon=x.icon,u.bodyControls=f,u);l.initializeAndShow(x.Wn,Object(d.a)(x,x.zYi,"reactOICErrorDialogWithTrialHandler"),f);return x}b.r(D);b.d(D,"ReactOICErrorDialogWithTrial",function(){return a});y=b(0);var d=b(80);D=b(1180);var c=b(410),k=b(140),n=D.a;vm(a,n);Object(y.a)(a,"ReactOICErrorDialogWithTrial",
D.a,[])},1316:function(y,D,b){function a(n,l,f,u,v,m){n=k.call(this,n,l,f,u,v,m)||this;l=document.createElement("span");l.innerText=n.vJe;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));f=document.createElement("span");f.innerText=n.Jpf;l.appendChild(f);f=new c.StandardDialog;n.A_f?(f.kc=1,f.mje(n.nva,n.h5e)):(f.kc=4,f.Cc(2,n.v6e));f.Cc(1,n.tWb);f.Me=n.id;f.Kk(n.Wn,null,n.icon,Object(d.a)(n,n.mki,"legacyOICErrorDialogWithTrialHandler"),l);return n}b.r(D);b.d(D,
"OICErrorDialogWithTrial",function(){return a});y=b(0);var d=b(80);D=b(1180);var c=b(128),k=D.a;vm(a,k);Object(y.a)(a,"OICErrorDialogWithTrial",D.a,[])},1317:function(y,D,b){function a(){return d.call(this)||this}b.r(D);b.d(D,"CheckRoamingRightsRequest",function(){return a});y=b(0);b=b(1182);var d=b.a;vm(a,d);a.prototype.X2a=function(){return 2};a.prototype.Mia=function(){return 1};Object(y.a)(a,"CheckRoamingRightsRequest",b.a,[])},1318:function(y,D,b){function a(){return d.call(this)||this}b.r(D);
b.d(D,"GetRoamingLauncherRequest",function(){return a});y=b(0);b=b(1182);var d=b.a;vm(a,d);a.prototype.X2a=function(){return 0};a.prototype.Mia=function(){return 2};Object(y.a)(a,"GetRoamingLauncherRequest",b.a,[])},1341:function(y,D,b){function a(u){this.hEc=!1;this.hWa=a.ndc;this.YNc=this.aMc=0;this.platform=null;this.Aqg=u;this.zge=this.ZNc=!1}function d(){this.state=this.callback=null;this.bmd=!1}function c(){this.classId=0}y=b(0);var k=b(80),n=b(38);c.DHa=function(u){try{return n.a(u)}catch(v){}return null};
Object(y.a)(c,"ARoamingAppsResponse",null,[]);Object(y.a)(d,"GetRoamingAppsLauncherContext",null,[]);var l=b(5),f=b(109);b.d(D,"a",function(){return a});a.prototype.OSg=function(){l.AFrameworkApplication.Ffc&&this.roamingAppsAreEnabled&&!this.ZNc&&!this.hEc&&(this.YNc=1,this.hEc=!0,this.K9i(),this.lOe())};a.prototype.K9i=function(){this.hWa=a.ndc;this.aMc=0};a.prototype.getRoamingAppsLauncher=function(u,v,m){this.AMj?(u=new d,u.callback=v,u.state=m,u.bmd=!0,this.qOe(u)):v(!1,"",m)};a.prototype.lOe=
function(){var u=new (b(1317).CheckRoamingRightsRequest);u.RoamingApp=this.YNc;u.BaseDocQuerySignature=l.AFrameworkApplication.hj;u.execute(Object(k.a)(this,this.QSg,"checkUserRoamingRightsSucceeded"),Object(k.a)(this,this.PSg,"checkUserRoamingRightsFailed"),null)};a.prototype.QSg=function(u){l.AFrameworkApplication.Gg||((u=c.DHa(u.data.fe))?this.UMd(u.HasRights):this.UMd(!1))};a.prototype.PSg=function(){if(!l.AFrameworkApplication.Gg)if(this.aMc>=a.tri)this.UMd(!1);else{var u=new f.a(2,1,this.hWa,
Object(k.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);l.AFrameworkApplication.oj.gh(u);this.aMc++;this.hWa*=a.caj;this.hWa>a.Rlf&&(this.hWa=a.Rlf)}};a.prototype.UMd=function(u){this.zge=u;this.ZNc=!0;this.hEc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.lOe()};a.prototype.qOe=function(u){var v=new (b(1318).GetRoamingLauncherRequest);v.RoamingApp=this.YNc;v.BaseDocQuerySignature=l.AFrameworkApplication.hj;v.execute(Object(k.a)(this,this.uQh,"getRoamingAppsLauncherSucceeded"),
Object(k.a)(this,this.tQh,"getRoamingAppsLauncherFailed"),u)};a.prototype.uQh=function(u){if(!l.AFrameworkApplication.Gg){var v=c.DHa(u.data.fe);u=u.data.state;v?(this.platform=v.Platform,u.callback(!0,v.Launcher,u.state)):u.callback(!1,"",u.state)}};a.prototype.tQh=function(u){if(!l.AFrameworkApplication.Gg){var v=u.data.state;5===u.data.status&&v.bmd?(v.bmd=!1,this.qOe(v)):v.callback(!1,"",v.state)}};tl.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Aqg}},
AMj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.ZNc?this.zge:!1}}});tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.wB||(a.wB=new a(l.AFrameworkApplication.FGg))}}});a.ndc=1E3;a.caj=5;a.Rlf=12E5;a.tri=5;a.wB=null;Object(y.a)(a,"RoamingAppsManager",null,[])},1376:function(y,D,b){function a(J){return wj.call(this,J)||this}function d(J,oa,Va){var Ub=this;this.ignorePrintArea=!1;this.iEj=function(){var e=Oa.g(Ub.$).Ca;
Ub.WOc=!0;e.jwd()};this.XHi=function(){Ub.Jgd()};this.WHi=function(e,C,M){ud.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",M);Ub.Jgd()};this.$=J;this.fa=J.fa;this.Sha=oa;this.qN=new I(1,this.ignorePrintArea);this.NC=oa=new c(J,oa,ld.AFrameworkApplication.Hd,Va);this.$.da.Ha(418,oa);this.tFf=new G(J);this.$.da.Ha(384,this);this.WOc=!1}function c(J,oa,Va,Ub){var e=this;this.activeCell=this.selectedRange=this.qg=this.graphServiceEndpoint=
null;this.w_=0;this.Im=this.Tu=null;this.ZG=new r;this.sk=new r;this.oba=0;this.B6a=null;this.MKb=!1;this.Y1a=this.MDb=null;this.Jnd=!1;this.z5a=this.dyb=this.Kfc=!0;this.Ela=this.kya=this.uMa=null;this.nxb=!1;this.y6a=null;this.S4a=this.nJc=!1;this.Xxd=function(C){if(!(C&&C.data&&C.data.fe&&C.data.responseHeaders&&C.data.fe.length)){var M=C?C.data?C.data.fe?C.data.responseHeaders?C.data.fe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":
"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";e.qg&&(C=e.sza(nf.a.instance.ea(1165)),e.hna(C,0));ud.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",M);e.SHd&&(C=Object.assign(new Oh.a,{extendedProperties:new Map}),C.extendedProperties.set("InvalidParameterName",M),mg.Health.instance.recordQosError(Yj.a.vFf,[zh.a.wFf],!1,!0,!0,!1,C))}else if(0<e.oba&&C.data.id===e.oba){if(C.data.responseHeaders["Content-Type"]&&
(Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){ud.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ra=null;Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ra=e.g0g(C));M={};e.ZBb(M,null,null,ra);C.data.responseHeaders["Total-Pdf-PageCount"]?(ra=parseInt(C.data.responseHeaders["Total-Pdf-PageCount"].toString()),
e.nxb||(e.LCd>=ra?e.Ela=ra:e.nxb=!0),e.z5a&&e.qg&&e.qg.setPageRangeSettings(ra,e.LCd,e.nxb,e.kya,e.Ela)):ud.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else M=Gj.a.li(C.data.fe),vh.a.x9(M.Errors)||Xg.a(e.$).nd.AD(M.Errors[0].MessageId),e.l_i(M.Errors),e.qg&&(ra=e.sza(M.Errors[0].Description),-1831476778===M.Errors[0].MessageId?(ud.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),
e.hna(ra,0,nf.a.instance.ea(1168))):e.hna(ra,0)),297284985===M.Errors[0].MessageId?ud.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",M.Errors[0].MessageId):ud.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",M.Errors[0].MessageId);C=C.data.state;C.L7c(M,C.userContext,C.methodName)}};this.Wxd=function(C){if(0<e.oba&&C.data.id===e.oba){var M=wi.a.yg(C.data);
e.qg&&e.hna(e.sza(M[0].Description),1);ud.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",vh.a.Uc(M));M=C.data.state;M.L$(C,M.userContext,M.methodName);e.$.userOperationManager.Aka.operation.Qza(function(){return e.MKb})}};this.hBi=function(C,M,ra){C.Errors&&0<C.Errors.length&&e.qg?(vh.a.x9(C.Errors)||Xg.a(e.$).nd.AD(C.Errors[0].MessageId),e.hna(e.sza(C.Errors[0].Description),0),ud.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
C.Errors[0].MessageId)):(ud.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),e.ZBb(C,M,ra,null))};this.gBi=function(C){C=wi.a.yg(C.data);e.qg&&e.hna(e.sza(C[0].Description),1);ud.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",vh.a.Uc(C));e.$.userOperationManager.Aka.operation.Qza(function(){return e.MKb})};this.Kwf=function(C,M){if(M)switch(M.fUi){case 1:if(e.sk&&
e.Y1a)switch(C=e.Y1a.Ac,e.Y1a.stop(),e.Y1a=null,e.sk.lv){case 1:e.eZc(C,4800,"ActiveSheet");break;case 0:e.eZc(C,6100,"CurrentSelection");break;case 2:e.eZc(C,7500,"EntireWorkbook")}break;case 0:e.MDb&&(C=e.MDb.Ac,e.MDb.stop(),2400<C&&(M=Object.assign(new Oh.a,{extendedProperties:new Map}),M.extendedProperties.set("PaneLoadTime",C.toString()),mg.Health.instance.recordQosError(Yj.a.xvj,[zh.a.h1f],!1,!0,!0,!1,M)),e.Tu.L7h(function(ra){e.ttj(ra)}))}};this.aF=function(C,M){(1===M.Wx&&e.uMa===M.Sg||2===
M.Wx)&&e.zId()};this.$=J;this.Sha=oa;this.G2=Va;this.Awd=Ub;this.SHd=li.HelperMethods.DZ;this.Ma=new Bh.a;this.LCd=this.$.ya.PrintPreviewerPaginationRange;this.jwa=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.pfc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);this.useMSPdfViewer=this.arj();this.K4h();this.a9h=this.kSg();this.Ind=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",
!1);if(this.isUniversalPrintEnabled=!!Ub&&Ub.gLa()&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.ig.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}function k(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function n(){this.onBackToSheet=null}function l(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=
null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function u(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function v(J,oa,Va,Ub,e,C){var M=A.call(this,e)||
this;M.Ld=!1;M.$0f=!1;M.$yd=function(ra){M.NC.$yd(ra)};M.hzd=function(ra){M.NC.hzd(ra)};M.CJi=function(){ud.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};M.BJi=function(ra){ra=wi.a.yg(ra.data);ud.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",vh.a.Uc(ra))};M.aF=function(ra,Na){2===Na.Wx?M.Su.clear():1===Na.Wx&&M.Su&&M.Su.contains(Na.Sg)&&
(ud.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",$k.a(Na.Sg.operation.operationName),Na.Sg.dequeueUtcTime.getTime()-Na.Sg.enqueueUtcTime.getTime()),M.Su.remove(Na.Sg))};M.NC=J;M.qN=Va;M.$=oa;M.sheetName=Ub;M.locale=window.navigator.browserLanguage||window.navigator.language||M.$.ya.UICultureTag;M.SOi=M.iZg();M.$.userOperationManager.uy(M.aF);M.Su=new Dh.a;M.jwa=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",
!1);M.isUniversalPrintEnabled=C;return M}function m(J,oa){this.sheetPrintOptions=this.sheetName=null;this.sheetName=J;this.sheetPrintOptions=oa}function A(J){this.Pvi=[.75,.75,.7,.7,.3,.3];this.Fui=[.75,.75,.25,.25,.3,.3];this.iPj=[1,1,1,1,.5,.5];this.f9d=this.mde=this.Bae=this.kae=this.Zge=this.c6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Om=J;this.Y4h();this.e5h()}function x(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function t(){this.footer=this.header=
this.bottom=this.top=this.right=this.left=0}function z(){this.marginValue=this.printSettingOption=null}function r(){this.margin=this.V_=this.$ba=this.orientation=this.lv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.y0a=!1;this.NoColor=null}function G(J){var oa=this;this.ribbonCommandInfo=this.zDb=null;this.oEj=function(Va,Ub,e){Ub=!!Va&&!!Va.RequestTelemetryData;Oa.g(oa.$).Ji&&Oa.g(oa.$).Ji.Pka(oa.eKa.na(oa.ribbonCommandInfo.command),Va.StateId,Ub?Va.RequestTelemetryData.EcsOperationDuration:
0,Ub?Va.RequestTelemetryData.EcsRequestDuration:0,Ub?Va.RequestTelemetryData.WfeRequestDuration:0);oa.uOf&&oa.eSg(e)};this.$=J;this.uOf=li.HelperMethods.DZ&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5140883_ReportPrintAreaPageBreaksQosError");this.eKa=new Tk.a;this.$ua=new Tk.a;this.$ua.add(78661008,12);this.$ua.add(275604654,13);this.$ua.add(-13332329,14);this.$ua.add(-837651977,9);this.$ua.add(-1778266776,10);this.$ua.add(845325699,11);this.Ind=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",
!1)}function w(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function B(){this.Max=this.Min=this.Index=0}function U(){this.Col=this.Row=null}function N(J){this.sheetName=null;this.sheetName=J}function P(J){this.sheetName=null;this.sheetName=J}function ia(J){this.sharedSheetCell=null;this.sharedSheetCell=J}function W(J){this.sharedSheetCell=null;this.sharedSheetCell=J}function R(J,oa){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=J;this.addToPrintArea=oa}function I(J,
oa){this.e6=0;this.p5d=!1;this.lv=J;this.ignorePrintArea=oa}function Q(J,oa,Va,Ub,e,C,M,ra){var Na=Z.call(this,J,oa,Va,Ub,e,Ag.EwaSettings.la(406))||this;Na.pca=null;Na.C$=null;Na.Ucc=null;Na.gQd=!1;Na.Hwa=null;Na.H9a=null;Na.mya=null;Na.vza=null;Na.k4a=null;Na.Dya=1;Na.Sla=1;Na.v_=0;Na.e6=1;Na.MEb=!1;Na.Tr=null;Na.AHb=0;Na.zHb=0;Na.nya=null;Na.wza=null;Na.selectedRange=null;Na.w_=0;Na.f8a=function(){Na.w_++;Na.e6=Na.GXc();Na.u6c(Na.C$.checked?!0:!1);Na.U6&&(Na.Ucc.disabled=Na.Mv.checked);Na.TLd(Na.C$.checked?
!0:!1);ud.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Na.e6.toString());return!0};Na.vrf=function(){Na.w_++;Na.MEb=Na.k4a.checked;ud.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Na.MEb.toString())};Na.Zkc=function(){Na.w_++;Na.Dya=Na.fte();ud.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Na.Dya.toString());return!0};
Na.wrf=function(){Na.w_++;var Ib=Na.Sla;Na.Sla=Q.paperSizeOptions[Na.mya.selectedIndex];ud.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Ib.toString(),Na.Sla.toString());return!0};Na.xrf=function(){Na.w_++;var Ib=Na.v_;Na.v_=Q.scalingOptions[Na.vza.selectedIndex];2===Na.v_?(Na.AHb=1,Na.zHb=0):3===Na.v_?(Na.AHb=0,Na.zHb=1):1===Na.v_&&(Na.AHb=1,Na.zHb=1);ud.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",
Ib.toString(),Na.v_.toString());return!0};Na.Xxd=function(Ib){if(Ib&&Ib.data&&Ib.data.fe&&Ib.data.responseHeaders&&Ib.data.fe.length){if(Ib.data.responseHeaders["Content-Type"]&&Fc.a.contains(Ib.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ud.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");var Gc={};Na.ZBb(Gc,null,null)}else Gc=Gj.a.li(Ib.data.fe),ud.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",
Gc.Errors[0].MessageId);Ib=Ib.data.state;Ib.L7c(Gc,Ib.userContext,Ib.methodName)}else ud.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Ib?Ib.data?Ib.data.fe?Ib.data.responseHeaders?Ib.data.fe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Na.Wxd=function(Ib){var Gc=wi.a.yg(Ib.data);
ud.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",vh.a.Uc(Gc));Gc=Ib.data.state;Gc.L$(Ib,Gc.userContext,Gc.methodName)};Na.ZBb=function(Ib){Ib.Errors&&0<Ib.Errors.length?ud.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",Ib.Errors[0].MessageId):(6===Na.ee.df&&ld.AFrameworkApplication.sa.Re.dk(Oa.g(Na.$).uSf),ud.ULS.shipAssertTag(537154309,0,!!Na.$.xa.oa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),
Na.$.xa.oa&&Na.Sha.b0f(Na.WGa()))};Na.Sha=C;Na.activeCell=Na.$.oa.activeCell.toString();Na.Im.SelectedRanges&&Na.Im.SelectedRanges.Ranges&&0<Na.Im.SelectedRanges.Ranges.length&&Na.Im.SelectedRanges.Ranges[0]&&(Na.selectedRange=nh.B(Na.Im.SelectedRanges.Ranges[0]).toString());Na.sheetName=M;Na.qN=ra;Na.xAd={};J=0;for(oa=Q.paperSizeOptions.length;J<oa;++J)Na.xAd[Q.paperSizeOptions[J].toString()]=J;Na.locale=window.navigator.browserLanguage||window.navigator.language||Na.$.ya.UICultureTag;Na.U6=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");
return Na}function O(J,oa){this.printSettings=this.sheetName=null;this.sheetName=J;this.printSettings=oa}function ba(){}function ca(J,oa,Va,Ub,e){J=Z.call(this,J,oa,Va,Ub,e)||this;J.Prb=null;return J}function S(J,oa,Va,Ub,e,C,M,ra){ra=J.Oa(1,void 0===ra?null:ra);ra.sheetName=oa;ra.locale=Va;return Le.i(J,"GetPrintSettings",ra,Ub,e,C,M,4)}function Y(J,oa,Va,Ub,e,C,M){M=J.Oa(1,void 0===M?null:M);M.ConvertInParameters=oa;return Le.i(J,"ConvertWorkbookToPrintPdf",M,Va,Ub,e,C,4)}function ma(J,oa,Va,Ub,
e,C,M,ra){ra=J.Oa(9,void 0===ra?null:ra);ra.sheetName=oa;ra.printSettings=Va;return Le.i(J,"SetSheetPrintSettings",ra,Ub,e,C,M,0)}function Z(J,oa,Va,Ub,e,C){J=sk.call(this,J,oa,Va,void 0===C?!1:C)||this;J.Mv=null;J.Im=Ub;J.yPb=e;return J}function xa(){this.r2d=this.rb=null}function na(J,oa,Va,Ub,e,C,M,ra,Na,Ib){this.XVb=null;this.jjg=J;this.$ib=oa;this.KLc=Va;this.pmg=Ub;this.Smg=e;this.gNc=new hg.a(Object(xf.a)(this,this.XOh,"getProbeResults"));this.rUa=C;this.u8d=Na;this.fsg=M;this.Tmg=ra;this.Zmg=
Ib}function pa(J,oa){this.B3f=J;this.WRa=oa}function Ia(J){this.isEnabled=Boolean.parse(J.DirectPrintIsEnabled||"false");Boolean.parse(J.DirectPrintProbeIsEnabled||"false");this.Qbi=Boolean.parse(J.DirectPrintEnabledForInternetExplorer||"false");this.VRa=(J.DirectPrintSupportedMimeTypes||"").split(Ia.Z4c);this.WRa=(J.DirectPrintSupportedPlugins||"").split(Ia.Z4c);this.Q1h=(J.DirectPrintImmersivePreviewPlugins||"").split(Ia.Z4c);this.U$e=Boolean.parse(J.DirectPrintEnabledForEdge||"false");this.L9h=
Boolean.parse(J.ChromePrintLayoutFixIsEnabled||"false");this.aTg=parseInt(J.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.pud=14;this.Imf=14394;if(J=J.DirectPrintMinimalSupportedEdgeVersion){var oa=J.split(".");2===oa.length?(this.pud=parseInt(oa[0]),this.Imf=parseInt(oa[1])):ud.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",J)}else ud.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
function Ma(J,oa,Va,Ub,e){Va=void 0===Va?null:Va;Ub=void 0===Ub?!0:Ub;e=void 0===e?!1:e;oa=qg.call(this,J,!0,!(Ma.PSa&&Ub),new Vf(J,oa),Va,e)||this;Ma.PSa=Ma.PSa&&Ub;if(Ma.PSa){Ub=document.createElement("iframe");e=null;var C=oa.dah;Ub.name="pdfObjectFrame";Ub.id="pdfObjectIFrame";if(Va&&0<Va.count){var M=ub.a.ced(J,Va);J=ub.a.mGd(J,Va);e=document.createElement("form");e.id="printPreviewPostForm";e.method="POST";e.target=Ub.name;e.action=J;J=yl(M);for(Va=J.next();!Va.done;Va=J.next())Va=Va.value,
M=document.createElement("input"),M.type="hidden",M.name=Va.key,M.value=Va.value,e.appendChild(M)}else Ub.src=J;C.appendChild(Ub);e&&(C.appendChild(e),e.submit());Sys.UI.DomElement.addCssClass(Ub,"DirectPrintPdfObjectHidden");Jg.a.oh(Ub,Jg.a.GB,Jg.a.rj)}return oa}function lb(J){this.IO=J}function zb(J,oa,Va,Ub){Ub=void 0===Ub?null:Ub;var e=nk.call(this)||this;e.kpa=null;e.Rl=null;e.PO=null;e.Vm=[];e.nTb=oa;e.IO=J;e.plg=Va;e.DUb=Ub;e.Hkb=new Oj.a("LoadResource","LoadPrintablePdf");return e}function Ya(J){var oa=
Lh.call(this)||this;oa.$=J;oa.dc();return oa}function Wb(J){this.stopwatch=this.MYb=this.Nxc=this.wSd=null;this.B4f=0;this.$=J;(this.$Uc=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||J.da.Ha(322,this)}function Zb(J){this.Ffe=0;this.C4f=J}function da(J,oa,Va,Ub,e,C,M){this.title=J;this.body=oa;this.ZTi=Va;this.primaryButtonAction=Ub;this.secondaryButtonAction=C;this.SSf=e;this.targetObject=M}function za(J){var oa=ri.call(this)||this;oa.$=J;oa.dc();return oa}function hb(J){this.$=
J;J.da.Ha(309,this)}function Gb(J){var oa=Ui.call(this,J)||this;oa.Jo=null;oa.stopwatch=null;oa.Aui=function(Va){if(1===Va)oa.$.Ka.Zb(new Hj.a(-2050946363,$c.a.Wb,2,8,null)).continueWith(function(e){oa.Jo.setResult(!Ci.a(e)&&e.result)}),Va="Yes";else{var Ub=2===Va;oa.Jo.setResult(Ub);Va=2===Va?"No":"Close";Ub&&oa.PTi()}oa.Bni(Va);oa.hide()};return oa}function Sb(){}function Fb(J){return vi.call(this,J)||this}function wa(J){this.Di=J}function va(J){var oa=pi.call(this)||this;oa.$=J;oa.dc();return oa}
function sa(J){J.da.Ha(446,this)}function sb(J){return wh.call(this,J)||this}function Tb(J,oa){var Va=this;this.sortOptions=this.zwc=this.selectedRange=null;this.o$e=!1;this.activeCell=this.Yf=this.Bb=this.Wc=null;this.QKi=function(Ub,e){Vg.b(Ub,-901005882)?(Xg.a(Va.$).nd.AD(-901005882),Va.kDd(e)):Va.w4e(Ub)?Va.h3e(Ub.Errors[0]):!Vg.a(Ub)&&Ub.Result&&(Va.sortOptions=e,Va.zwc=nh.D(Ub.Result.ActualSortRange),Va.Igf=Va.ha().Lha,Va.o$e||(Va.selectedRange=Va.ha().va.Qd,Va.selectedRange.equals(Va.zwc)||
Va.Vtj()),Va.sortOptions&&Va.sortOptions.ActiveCell&&(Ub=Va.sortOptions.ActiveCell,Ub=new Oi.Range(Ub.FirstRow+1,Ub.FirstColumn+1,Ub.FirstRow+1,Ub.FirstColumn+1,!0,!1),Va.ZK(Ub),Va.aUd(Ub)))};this.onContentReady=function(){Va.fKf(!1);var Ub=Va.ha();Ub.va.Dh&&Ub.va.Qd.equals(Va.zwc)&&Ub.updateSelection(Va.selectedRange,Ub.va.activeCell,0,void 0,void 0,void 0,!0)};this.nEi=function(Ub,e){Ub&&!vh.a.ih(Ub.Errors)&&Va.Wc&&(Va.Wc.Do=Ub.Result,Va.oIb(),Va.applyPivotSort(e))};this.mEi=function(){};this.$=
J;this.Igf="";this.namedSheetViewPublic=oa;this.gridView=Oa.g(this.$);this.$.Ub.Xh("LoadResource","LoadDialogControlsStopwatch")}function Da(J,oa,Va,Ub,e,C,M){M=J.Oa(41,void 0===M?null:M);M.options=oa;return Le.i(J,"Sort",M,Va,Ub,e,C,0)}function Sa(J){this.filterRange=null;this.filterRange=J}function Ra(J){this.selection=null;this.selection=J}function Lb(J,oa,Va,Ub){var e=Fi.call(this,J)||this;e.yOd=!1;e.yec=!1;e.Z5=[];e.O7h=function(C,M){var ra=e.V1g(C);e.C4a(214,function(Na,Ib,Gc){return Le.G(e.$.qa.ta,
ra,e.AZa(Na,e.iAh(M)),e.JT(Ib),Gc,null)},16,!0)};e.N7h=function(C,M,ra){C=Le.F(e.$.qa.ta,M,e.TAh(M,ra),e.FEi,null,C);Array.add(e.Z5,C)};e.FEi=function(){ud.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");e.W4b(Lb.Ypb())};e.T4c=function(C,M){if(1===C){C=M.sortRangeType;var ra={};ra.SortOptions=M.sortOptions;ra.ShouldRestoreSelection=e.yOd;ra.SelectedRange=e.selectedRange;ra.OriginalActiveCell=e.hnc;ra.TopCellAddress=
e.qSa;if(e.Mpj(C)){var Na=e.$;e.namedSheetViewPublic.dAa().continueWith(function(Ib){Ib.result&&Lb.AHf(Na,ra)})}else Lb.AHf(e.$,ra)}else e.yOd&&e.Yna(e.selectedRange,e.hnc)};e.t0h=function(C,M){e.yOd=!0;e.Yna(C,M)};e.getColorName=function(C){return Nf.a.JJa(Kf.a.GG(C))};ud.ULS.shipAssertTag(529105669,0,!!oa.ActiveCell);ud.ULS.shipAssertTag(529105668,0,!!oa.SelectedRange);ud.ULS.shipAssertTag(529105667,0,nh.D(oa.SelectedRange).contains(nh.C(oa.ActiveCell)));ud.ULS.shipAssertTag(529105666,0,Fc.a.equals(oa.SelectedRange.SheetName,
oa.ActiveCell.SheetName,!0));Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(e.Pab=new Yh.a(J,Eh.a.d7g,function(){return e.yec}));e.selectedRange=oa.SelectedRange;e.hnc=oa.ActiveCell;e.GPg=oa.ExpandSelection;e.namedSheetViewPublic=Va;e.qSa=Ub;e.initializeAndShow(nf.a.instance.ea(182),e.T4c,e.xsa(oa));return e}function Ja(J,oa){J=qh.call(this,J,oa)||this;J.MAb=J.Nad();J.jr();return J}function wb(J,oa){var Va=J.SortRange;J=J.SortTopToBottom?Va.LastColumn-Va.FirstColumn:
Va.LastRow-Va.FirstRow;return 0<=oa&&oa<=J}function Mb(J,oa){if(!J.SortColumnInfoItems)return ud.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Va=new Dh.a,Ub=yl(J.SortColumnInfoItems),e=Ub.next();!e.done;e=Ub.next()){e=e.value;if(!wb(J,e.ColumnOffset))return ud.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",e.ColumnOffset,J.SortRange),!1;if(!e.Name)return ud.ULS.sendTraceTag(537151616,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",e.ColumnOffset),!1;if(e.CellColors&&!e.CellColors.length)return ud.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",e.CellColors.length),!1;if(e.TextColors&&!e.TextColors.length)return ud.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",e.TextColors.length),
!1;if(e.Icons&&!e.Icons.length)return ud.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",e.Icons.length),!1;Va.add(e.ColumnOffset)}if(J.SortConditions)for(Ub=yl(J.SortConditions),e=Ub.next();!e.done;e=Ub.next())if(e=e.value,!Va.contains(e.RowColOffset))return ud.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",e.RowColOffset),!1;if(J.HeaderColumnInfoItems){if(J.HeaderColumnInfoItems.length!==
J.SortColumnInfoItems.length)return ud.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Va=0;Va<J.HeaderColumnInfoItems.length;++Va){Ub=J.HeaderColumnInfoItems[Va];if(oa&&Ub.ColumnOffset!==J.SortColumnInfoItems[Va].ColumnOffset)return ud.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(Ub.CellColors&&1<Ub.CellColors.length)return ud.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Ub.TextColors&&1<Ub.TextColors.length)return ud.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Ub.Icons&&1<Ub.Icons.length)return ud.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0}function Eb(J){if(!J.SortConditions)return!0;for(var oa=yl(J.SortConditions),Va=oa.next();!Va.done;Va=oa.next()){Va=Va.value;if(!wb(J,Va.RowColOffset))return ud.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Va.RowColOffset,J.SortRange),!1;if(1===Va.SortConditionType&&Va.FillGradient&&!Zc.isValid(Va.FillGradient))return ud.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),
!1}return!0}function Ic(J){return J.SortRange?4===J.SortRangeType?(ud.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",J.SortRangeType),!1):2===J.SortRangeType&&J.SortTopToBottom&&(null==J.HeaderRowSize||0>J.HeaderRowSize)?(ud.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(ud.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),
!1)}function Zc(){}function Pc(J,oa,Va,Ub){new Sys.UI.Point(J,oa);new Sys.UI.Point(Va,Ub)}function vd(){}function Tc(J,oa,Va,Ub){J=J.HeaderColumnInfo;return Ub||J?2===oa&&Va?J.CellColors&&1!==J.CellColors.length?(ud.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):J.TextColors&&1!==J.TextColors.length?(ud.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):J.Icons&&1!==J.Icons.length?(ud.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:J?(ud.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Va),!1):!0:!0}function rb(J,oa){J=J.ColumnInfo;switch(oa){case 1:return J.CellColors&&
J.CellColors.length?!0:(ud.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return J.TextColors&&J.TextColors.length?!0:(ud.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return J.Icons&&J.Icons.length?
!0:(ud.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return ud.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function eb(J){var oa=this;this.Ov=function(Va){switch(Va){case 0:oa.VMa("Cancel");break;case 1:oa.VMa("Expand and sort");oa.zOe(!0);break;case 2:oa.VMa("Just sort"),
oa.zOe(!1)}};this.zOe=J}function Ta(J,oa,Va,Ub,e,C,M){M=J.Oa(41,void 0===M?null:M);M.filterRange=oa;return Le.i(J,"ReapplyAutoFilter",M,Va,Ub,e,C,0)}function fb(J){this.options=null;this.options=J}function pb(J){return Nd.call(this,J)||this}function rc(J,oa,Va){var Ub=md.call(this)||this;Ub.ute=!1;Ub.tte=!1;Ub.Azi=function(){Ub.ute=!0;Ub.f_f()};Ub.$=J;Ub.Sa=oa;Ub.FJ=Va;Xg.a(Ub.$).kFd(new cd.a(ge.a.Z8f,ge.a.idle,rc.DRg),new Fk.a(ge.a.Uwe,ge.a.e_,null,ge.a.kO,ge.a.idle));return Ub}function vb(J){var oa=
bc.call(this,J,nf.a.instance.ea(1225))||this;oa.textBox=null;oa.oQa=null;oa.BSa=null;oa.RAf=function(){var Va=oa.$;oa.ou();var Ub=new E(Va,1228,1229,1230,function(e,C,M){var ra=Va.qa.ta.Xb(),Na=Va.qa.ta;ra=Na.Oa(1,ra);return Le.i(Na,"UnshareForm",ra,e,C,M,null,0)},16);Ub.initialize();Ub.nf()};return oa}function E(J,oa,Va,Ub,e,C){C=void 0===C?0:C;J=ib.call(this,J,nf.a.instance.ea(oa),!1)||this;J.message=Va;J.hyi=Ub;J.wXd=e;J.operationFlags=C;return J}function Nb(J,oa,Va){var Ub=Ga.call(this,J,new Sys.UI.Point(Nb.$8g,
Nb.B8g),nf.a.instance.ea(oa?1223:1222))||this;Ub.G_a=null;Ub.fJc=!1;Ub.Umc=function(e){function C(Ib,Gc,id){return Le.E(M.qa.ta,T.b(Ib,Ub.aKi),Gc,id,ra)}var M=Ub.$,ra=new ka;ra.TG=e.Values[bb.TG];var Na=!1;switch(e.MessageId){case bb.UXf:Ub.ou();Na=!0;ra.JBd=1334518759;break;case bb.view:Ub.FAa=nf.a.instance.ea(1223);Ub.aag(!0);break;case bb.Mwe:Ub.ou(),Na=!0}Ag.EwaSettings.tc()?(e=new Ee.a(140,0,C),e.flags=Na?16:80):(e=Na?new Ee.a(140,0,C):new sj.a(140,0,C),e.flags=16);M.userOperationManager.ic(e,
Ub.ee)};Ub.gCi=function(){var e=Ub.$;e.ya.SurveyRedirectUrl?(Ub.ou(),e.Ce(1305810481,0,8,null)):(Ub.FAa=nf.a.instance.ea(1222),Ub.aag(!1))};Ub.oKi=function(){var e=Ub.$;Ub.ou();e.Ce(1334518759,0,8,null)};Ub.Urf=function(e){var C=Ub.$;Ub.ou();e.MessageId===bb.Wwe&&C.fa.X$c()};Ub.GIi=function(){Ub.fJc=!0;Ub.raiseEvent(Nb.grd)};Ub.aKi=function(e,C){if(!Vg.a(e)){e=Ub.$;if(C.TG){var M=e.fa.xa;if(M.contains(C.TG.SheetName))Ub.Nlc(C);else{var ra=null;ra=function(){M.dma(ra);Ub.Nlc(C)};M.pga(ra)}}1461300262!==
C.JBd&&e.Ce(C.JBd,0,8,null)}};Ub.Y6d=oa;Ub.ee=Va;return Ub}function ka(){this.TG=null;this.JBd=1461300262}function bb(){}function Ha(J){J=Ga.call(this,J,new Sys.UI.Point(960,680),nf.a.instance.ea(1218))||this;J.name=ab.a.ZHe;return J}function Ga(J,oa,Va,Ub){var e=yk.call(this,J,Va,2,void 0===Ub?null:Ub)||this;e.SHc=null;e.onResize=function(){var C=e.xKh();e.GKa.setAttribute("width",C.x.toString());e.GKa.setAttribute("height",C.y.toString());e.XIj(C);e.nyd()};e.Ngh=function(){var C=e.Zw.parentNode.style,
M=C.top;C.top="2px";C.top=M};e.XDe=oa;e.$.Yz(e.onResize);e.hcc();return e}function Ua(J){return Gg.call(this,J)||this}function jb(J){this.$=J}function $a(J,oa,Va,Ub,e,C,M,ra){ra=J.Oa(9,void 0===ra?null:ra);ra.sheetName=oa;ra.directionRtl=Va;return Le.i(J,"ChangeSheetDirection",ra,Ub,e,C,M,0)}function Yb(J,oa,Va,Ub,e,C,M,ra){ra=J.Oa(9,void 0===ra?null:ra);ra.sheetName=oa;ra.show=Va;return Le.i(J,"ShowHeadings",ra,Ub,e,C,M,0)}function ec(J,oa,Va,Ub,e,C,M,ra){ra=J.Oa(9,void 0===ra?null:ra);ra.sheetName=
oa;ra.show=Va;return Le.i(J,"ShowGridlines",ra,Ub,e,C,M,0)}function Za(J,oa){this.sheetName=null;this.value=!1;this.sheetName=J;this.value=oa}function Wa(J,oa){var Va=Gk.call(this)||this;Va.activityName=J;Va.$L=oa;Va.dc();return Va}function Ca(J,oa,Va,Ub,e){J=oj.call(this,J,oa)||this;Ca.ntd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Ca.mtd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Ca.Ykf=[-1468309555,611268539,-1750576502,61029505];
Ca.Xkf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];J.gwc=Va;J.suj=Ub;J.xDj=e;return J}function db(){var J=lk.call(this)||this;J.dc();return J}function $b(J,oa){return Pk.call(this,J,oa)||this}function Jb(J){var oa=wk.call(this)||this;oa.$=J;oa.dc();return oa}function Hc(J,oa){this.$=J;this.Di=oa;this.$.da.Ha(393,this)}function uc(J){var oa=Ok.call(this,J)||this;oa.Oxh=function(Va,Ub,e,C,M){return 1===e?32:Va===Ng.a.hQa&&2===e?(Va=oa.$.qa.ta.Xb(),Le.Z(oa.$.qa.ta,
M[0],M[1],null,null,Va),32):8};return oa}function Aa(J,oa){this.$=J;this.Di=oa}function mb(J){return Rh.call(this,J)||this}function dc(J,oa){var Va=this;this.aJi=function(Ub,e){if(!Vg.a(Ub)&&e){var C=!!Ub&&!!Ub.RequestTelemetryData;Oa.g(Va.$).Ji.Pka(e,Ub.StateId,C?Ub.RequestTelemetryData.EcsOperationDuration:0,C?Ub.RequestTelemetryData.EcsRequestDuration:0,C?Ub.RequestTelemetryData.WfeRequestDuration:0)}};this.$=J;this.hi=oa}function Ac(J,oa){var Va=Zi.call(this,J)||this;Va.iub=function(Ub){Ub=Va.mdd(Ub);
return Va.Jad(Ub)};Va.c$i=function(Ub,e){var C=Va.Ayb=e[Ac.B$h];1===Ub?(Ub=e[Ac.zuj],C=Va.S0e(Ub,C),ud.ULS.shipAssertTag(537153996,0,C!==Ac.Laa,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Ub),Ub=C!==Va.Cjd,ud.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Va.isRow,Va.Ayb,C,Ub),Ub&&Va.G_g(C)):ud.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Va.isRow)};
Va.isRow=2040891415===oa.command;Va.gridView=Oa.g(Va.$);Va.Prc=new Ie(Va.$.workbookContext.DxDigitNormal);Va.Cjd=Va.dPg();J=Va.tZg(Va.Cjd);oa=Va.vZg(Va.Cjd);Va.Wn=nf.a.instance.ea(Va.isRow?467:468);J=Va.LU(J,oa);Va.initializeAndShow(Va.Wn,Va.c$i,J);ud.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Va.isRow);return Va}function bd(J){this.resizeParameters=null;this.resizeParameters=J}function Kd(J,oa){this.isRow=!1;this.autoFitRange=null;this.isRow=J;this.autoFitRange=
oa}function Yd(){var J=Ek.call(this)||this;J.dc();return J}function qd(J,oa){var Va=Dk.call(this,oa.domElement)||this;Va.CPf=!1;Va.Zaa=!1;Va.uKb=null;Va.gzb=null;Va.Dr=null;Va.offset=0;Va.$l=0;Va.yHb=0;Va.r0=null;Va.x6=null;Va.wM=null;Va.s_h="headerResizeTooltip";Va.nsd=null;Va.EF=null;Va.zab=!1;Va.nVa=!1;Va.SVc=!1;Va.iN=function(Ub){Ub=Jj.a(Va.grid.$).Fe(Ub);if(3===Ub.zb&&!Va.Def(Ub.Ea)||!Va.FEf(Ub,!1))return!1;ud.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");
var e=Va.DPd();Va.pTe(Ub,e,!0);Va.zab||(bj.a.instance.pa(Je.a.lh,Va.domElement.ownerDocument.body,Va.Mxa),hj.a.instance.pa(Je.a.Ig,Va.domElement.ownerDocument.body,Va.Mxa),Va.zab=!0);Va.Naf()&&Va.Zaa&&Va.N6e(Ub);return!1};Va.nlc=function(Ub){Ub=Jj.a(Va.grid.$).Fe(Ub);Va.Naf()&&Va.SVc&&Va.N6e(Ub);if(Ub.Ea.button||!Va.Zaa)return!1;fk.g(Ub.Ea);Va.zIe();Ub=Pf.a.z4a;Va.Dr&&(Ub=Va.nVa?Va.kcd():Va.Dr.Fua());var e=Ub!==Va.$l;if(Va.uKb&&e&&Ub!==Pf.a.z4a){Ub=Va.grid;e=Va.$Ze(Ub);var C={};C.SheetMultiRange=
nh.r(e,Ub.$);qd.CMd(C,Va.isRow,Va.$l);Va.Bgh(C);Ub.Mzj=!0}else Va.Sh(null,null),Va.rqc();return Va.nVa=!1};Va.Nba=function(Ub){Ub=Ni.a.create(Ub.eventName,Ub.Sb,Ub.Ea,Ub.zb);Ub=Jj.a(Va.grid.$).Fe(Ub);if(!Va.FEf(Ub,!0))return!1;Ub=Va.grid;var e=Va.$Ze(Ub);e=nh.r(e,Ub.$);Ub.Nb.kl([Va.isRow?13:14]);Ub.Nb.ncb();Va.rqc();var C={};Ub.$.Ce(Va.isRow?146338636:1391094586,$c.a.Wb,30,(C.autoFitRanges=e,C));return!1};Va.Mxa=function(Ub){Ub=Jj.a(Va.grid.$).Fe(Ub);if(!Va.Zaa)return!1;fk.g(Ub.Ea);var e=Va.isRow;
if(!Va.r0){Va.r0=document.createElement("div");Va.r0.style.cssText="position: relative; width: inherit; height: inherit;"+(e?"top: 0px; ":Va.rtl?"right: 0px:":"left: 0px:");for(var C=Va.Dr.EJ();C.nextSibling;)Va.r0.appendChild(C.nextSibling);C.parentNode.appendChild(Va.r0)}C=e?Ub.clientPoint.y-Va.gzb.y:(Va.rtl?-1:1)*(Ub.clientPoint.x-Va.gzb.x);var M=e?Ub.clientPoint.y-Va.uKb.y:(Va.rtl?-1:1)*(Ub.clientPoint.x-Va.uKb.x),ra=Va.Dr.Fua();if(ra===Pf.a.z4a)return!1;C&&(0<Va.$l||0<ra+M)&&ra+M<=Va.Elf&&(Va.$l=
Va.DPd(M),Va.pTe(Ub,Va.$l,!1),De.DOMElementExtensions.KSa(Va.Dr.EJ(),!e,Math.max(Va.yHb+M,0)),Va.r0.style[e?"top":Va.rtl?"right":"left"]=Math.max(M,-Va.yHb)+"px",De.DOMElementExtensions.KSa(Va.Dr.hf.domElement,!e,(e?Va.Dr.hf.kP:Va.Dr.hf.lP)+Math.max(M,-Va.yHb)),Va.gzb=new Sys.UI.Point(Ub.clientPoint.x,Ub.clientPoint.y),De.DOMElementExtensions.setVisible(Va.EF,!1));return!0};Va.aR=function(Ub){Ub=Jj.a(Va.grid.$).Fe(Ub);var e;if(!Va.hdf||-1!==Va.grid.ha.selectionType)return Kb.a(Va.grid.$).sq()&&(e=
Va.Ycd(Ub))&&(e.jva.style.cursor=""),!1;if(Va.Zaa)return Va.j5h(),!1;e=Va.Ycd(Ub);if(!e)return!1;e.jva.style.cursor=!Va.grid.isEditing&&Va.ypd(e)?Va.isRow?"row-resize":"col-resize":"";fk.g(Ub.Ea);return!0};Va.dr=function(){Va.rqc()};Va.Sh=function(){if((3===$c.a.Wb||Rg.a.Pr)&&Va.grid.ha.va.Dh){var Ub=Va.grid.ha.va.Qd;if(!(!Ub.isRow&&!Ub.Lh||!Va.domElement||Ub.isRow&&Va.isRow&&!Array.contains(Va.hf.No,Ub.top)||Ub.Lh&&!Va.isRow&&!Array.contains(Va.hf.No,Ub.left))){var e=Va.grid.Lg(Ub,Va.hf.sj.paneType);
e&&(Va.EF||Va.Z5g(),Ub.isRow&&Va.isRow?(De.DOMElementExtensions.setVisible(Va.EF,!0),Va.EF.style.top=e.bottomRight.y-Va.EF.offsetHeight/2+"px"):Ub.isRow||Va.isRow||(De.DOMElementExtensions.setVisible(Va.EF,!0),Zk.c(Va.EF.style,Va.grid.rtl,e.bottomRight.x-Va.EF.offsetWidth/2+"px")))}}};Va.$E=function(Ub,e){e.ZO&&Va.Aob()};Va.hf=oa;Va.isRow=oa.isRow;Va.rtl=oa.sj.rtl;Va.grid=J;Va.Elf=Va.isRow?Pf.a.Mtd:Pf.a.ijc;Va.o_h=nf.a.instance.ea(426);Va.x_h=nf.a.instance.ea(425);Va.r_h=nf.a.instance.ea(427);Cg.a(Va.grid.$,
function(Ub){Va.nsd=Ub.IP(yc.a.k$i,!1)});Ph.a.instance.pa(Je.a.Ij,Va.domElement,Va.Nba);bj.a.instance.pa(Je.a.Wd,Va.domElement.ownerDocument.body,Va.nlc);hj.a.instance.pa(Je.a.De,Va.domElement.ownerDocument.body,Va.nlc);Rg.a.Pr||(bj.a.instance.pa(Je.a.pointerDown,Va.domElement,Va.iN),bj.a.instance.pa(Je.a.lh,Va.domElement,Va.aR));Va.grid.ha.j2(Va.Sh);Va.grid.ha.l9(Va.dr);Va.grid.Nq(Va.Sh);Kb.a(Va.grid.$).pg.qga(Va.$E);return Va}function Ie(J){this.S5c=J}function cc(J,oa,Va,Ub,e,C,M){this.jva=J;this.SAb=
oa;this.BNa=Va;this.qhd=Ub;this.Bab=e;this.Cef=C;this.wZh=M}function Qd(){}function Wd(J){var oa=nj.call(this)||this;oa.$=J;oa.dc();return oa}function ee(J){var oa=this;this.Lna=this.uSe=this.CEb=this.e1a=this.Doc=this.mca=this.NOa=null;this.pod=this.nMb=this.hJd=!1;this.wJb=!0;this.Eec=!1;this.xPd=!0;this.mMb=this.O_a=this.cze=0;this.jtc={};this.tnc={};this.snc={};this.SEf=0;this.W5a=this.X6d=!1;this.s3i=function(){De.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-transition",!1);$removeHandler(oa.e1a,
"transitionend",oa.Lna)};this.aj=function(){parseInt(oa.$.Ey.style.right)!==oa.cze&&window.requestAnimationFrame(function(){oa.yzc(0);oa.$.Kya(Qb.a.jZ("PresentModeManager.OnContentAreaResized"))})};this.$xa=function(){var Va=Object(Ug.a)(tf.a,oa.$.oa);if(Va&&oa.$y){oa.gridView.qmd=!1;Va=Va.headersVisible;var Ub=Oa.g(oa.$).rtl;De.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on-headers-off",!Va);De.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on-rtl",Ub);(12!==oa.O_a&&
!Va||32!==oa.O_a&&Va&&!Ub||0!==oa.O_a&&Va&&Ub)&&window.requestAnimationFrame(function(){oa.yzc(2)})}};this.od=function(){oa.l9e();oa.mh("OnWorkbookOpened");ud.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.dr=function(){oa.pod=!0;oa.Vda("OnSelectionStarted")};this.Sh=function(){oa.pod=!1;oa.Vda("OnSelectionEnded");oa.JRf()};this.Mj=function(){oa.Vda("OnEditStarted")};this.Rh=function(){oa.Vda("OnEditEnded")};this.iw=function(){if(!oa.Eec){var Va=
Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");oa.Vda("OnVisibleAreaChanged",!0,Va)}};this.Hxa=function(){oa.Eec=!0};this.Wo=function(){oa.Vda("OnCurrentSelectionModeChanged");oa.JRf();oa.mh("OnCurrentSelectionModeChanged")};this.Hm=function(){oa.Vda("OnBlockCacheItemEvicted")};this.Pe=function(){oa.Vda("OnBlockCacheItemChanged")};this.Lba=function(){oa.Eec||oa.Vda("OnActiveItemPanesChanged")};this.Yh=function(){oa.Eec=!1;oa.mca.mh("ActiveSheetChanged");oa.$xa()};
this.ZCb=function(Va,Ub){if(Va=Object(Ug.a)(tf.a,Ub.item))Va.Iob(16,!0),Va.vmb(oa.$xa)};this.dDi=function(){ne.Yai||(oa.Doc&&oa.Doc.Ks&&oa.Doc.hide(),Oa.g(oa.$).isEditing&&Oa.g(oa.$).Dq(!0),oa.Wvc(!1),ud.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.eDi=function(){ud.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=J;this.gridView=Oa.g(this.$);
this.Zcj=J.ya.PresentModeRenderUpdateTimeout;this.initialize(J)}function ne(){}function Bd(J,oa){var Va=zi.call(this,J)||this;Va.HTi=function(){Va.mca.sPd(!0)};Va.mca=oa;Va.domElement.classList.add("ewr-presentMode-on");J={};J=(J[Bd.Ly]=Va.xc,J);Va.kc=0;Va.initializeAndShow("",Va.HTi,J);return Va}function Pd(J){this.gZa=this.kCd=null;this.$=J;this.gridView=Oa.g(this.$)}function ze(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function Jf(){this.height=this.width=0}function oc(){this.angle=
this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function hd(J){var oa=this;this.Gpe=this.LOa=this.iCd=this.jCd=this.lca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.ioc={};this.hoc={};this.HOa=null;this.LDf=0;this.onKeyDown=function(Va){Va=Va.Ea;if(9===Va.keyCode){var Ub=oa.lca.querySelectorAll(De.DOMElementExtensions.Ep),e=De.DOMElementExtensions.zl(Ub);Ub=De.DOMElementExtensions.Ry(Ub);De.DOMElementExtensions.jda(Va,e,Ub);return!0}return!1};this.Fl=function(){var Va=
[];oa.$.da.Za(337,function(Ub){oa.LOa.getPresentModeFloatieControlsMap().then(function(e){for(var C={},M=0;M<e.length;M++)C[e[M].controlId]=e[M].modelType;Va.push.apply(Va,Ub.rca.g3a(C));0<Va.length&&appChrome.api.dispatch(Va);oa.ocj()})})};this.$=J}function wc(){}function gb(J){return Ij.call(this,J)||this}function kd(J,oa){this.$=J;this.presentModeManager=oa}function Lc(J,oa,Va,Ub){var e=Hh.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=Ub;e.dc();return e}function Cb(J,oa,Va){var Ub=ji.call(this,
J,oa)||this;Ub.vi=null;Ub.qki=function(e){var C=Ub.es.nd,M=Object(Ug.a)(6,C.Ge);var ra=e.Rqb;Ub.unsubscribe(function(Gc){e.remove_disposing(Gc)});for(var Na=0,Ib=C.errors.length;Na<Ib;Na++)-573864504===C.errors[Na].MessageId&&C.Oka(C.errors[Na]);switch(ra){case 1:M.fa.Qyc=!0;ud.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Ub.ph(M.isEditMode?ge.a.ILb:Ub.K8g);Ub.Uo();break;case 2:Ub.ph(ge.a.openInExcelClient);
Ub.Uo();break;case 0:C.activityState[cg.a.rs]=!1,Ub.ph(Ub.vJ),Ub.Uo()}};Ub.K8g=oa;Ub.vJ=Va;return Ub}function Bb(J,oa){J=Vh.call(this,J,oa)||this;J.Yoa=0;J.jr();return J}function Hb(J,oa,Va,Ub){var e=Ck.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=Ub;e.dc();return e}function Pb(J,oa,Va){return je.call(this,J,oa,Va)||this}function ed(J,oa){J=nd.call(this,J)||this;J.password=null;J.$ef=oa;J.Kh();return J}function Xc(J,oa,Va,Ub){var e=Wj.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=
Ub;e.dc();return e}function ce(J,oa,Va){return je.call(this,J,oa,Va)||this}function Xd(J){var oa=nd.call(this,J)||this;oa.$Id=5;oa.V6d=!1;oa.passwordToModify=null;oa.MCf=function(){oa.$.isEditMode&&oa.Jfc&&(Gd.b().E6c("PasswordToModifyPasswordVerifiedTillInteractive"),oa.$.ml(oa.MCf))};oa.Kh();oa.$.Rk(oa.MCf);return oa}function nd(J){var oa=Se.call(this,J)||this;oa.Yoa=0;oa.KYi=function(Va,Ub){oa.p$a(Va,Ub)};return oa}function je(J,oa,Va){var Ub=Mi.call(this,J,oa)||this;Ub.vi=null;Ub.JAd=null;Ub.QPi=
function(e,C){Ub.WDb(e,C)};Ub.vJ=Va;return Ub}function Xe(J){var oa=Aj.call(this)||this;oa.$=J;J.da.Ha(56,new Ig(J));oa.dc();return oa}function Ne(J,oa){return Qj.call(this,J,oa)||this}function Ig(J){var oa=Yi.call(this)||this;oa.$=J;oa.dc();Ig.wXg();return oa}function Lf(J,oa,Va){var Ub=Hf.call(this,!0)||this;Ub.Ma=new Bh.a;Ub.RRe=!1;Ub.C5c=!1;Ub.fxe=null;Ub.xm=null;Ub.G1b=null;Ub.Zc=function(){rj.a.ug(Xg.a(Ub.$).nd.activityState,Pe.a.Kwd)||Ub.Q$.reset()};Ub.fCi=function(e){Ub.aOf(e)};Ub.eCi=function(){Ub.Yrj()};
Ub.$=J;Ub.fa=J.fa;Ub.FJ=oa;Ub.businessBar=Va;Ub.fa.Sj(Ub.Zc);Ub.Q$=Nk.a.Ppe(Ub.$);Ub.xXg();J.da.Ha(55,Ub);return Ub}function Hf(J){this.rfa=this.G2d=this.aUa=null;this.phb=!1;this.aLc=this.L$d=null;this.sPb=this.nD=this.LUb="";this.application=this.qB=0;this.szj=this.NRd=!1;this.kMj=J&&ld.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");ld.AFrameworkApplication.Eb.V3(Ng.a.TPa)||ld.AFrameworkApplication.Eb.$b(Ng.a.TPa,ph.a.frame,Object(xf.a)(this,this.gaj,"retryOpenInClientAction"));ld.AFrameworkApplication.Eb.kkc&&
(J=ld.AFrameworkApplication.Eb.nZ(3588168074))&&(this.LUb=J.sessionOrigin?J.sessionOrigin:"",this.nD=J.correlationId?J.correlationId:"",this.sPb=J.TriggerTime?J.TriggerTime:"");this.M0f=!!ld.AFrameworkApplication.ga&&ld.AFrameworkApplication.ga.ra("SilentExternalHandler")}function ag(){}function Bg(){}function uf(J){var oa=ti.call(this)||this;oa.Yp=J;oa.Me="ProtocolLaunchingDialog";ld.AFrameworkApplication.oj.N3a&&ld.AFrameworkApplication.oj.Urc();ld.AFrameworkApplication.sa.Pa.$fd&&oa.fje(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,
Object(xf.a)(oa,oa.zlc,"onGiveFeedbackClick"));uf.Z3e?(oa.kc=12,oa.Cc(1,CommonUIStrings.l_CloseFile),oa.Cc(2,CommonUIStrings.l_OICDialogContinueHere),oa.Cc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(oa.kc=4,oa.Cc(1,CommonUIStrings.l_OICDialogContinueHere),oa.Cc(2,CommonUIStrings.l_OICDialogLaunchAgain));oa.NAb(CommonUIStrings.l_OICDialog2ndTitle,5===oa.Yp.yBf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(xf.a)(oa,oa.nDd,"protocolLaunchingDialogResultHandler"),
null);return oa}function sf(J){var oa=zj.call(this)||this;oa.wea=null;oa.UTa=null;oa.$oa=!1;oa.Goa=null;oa.Yp=J;oa.xf=xg.xf;oa.TVc=!0;oa.kc=5;oa.Me="ProtocolLaunchingDialog";oa.hFc="OICRetryDialog";ld.AFrameworkApplication.oj.N3a&&ld.AFrameworkApplication.oj.Urc();ld.AFrameworkApplication.oj.gh(new $e.a(2,1,5E3,function(){oa.switchToBackupMode()},101));oa.showDialog("",Object(xf.a)(oa,oa.nDd,"protocolLaunchingDialogResultHandler"));oa.$Vf();oa.zW("Issues");oa.DRe();ud.ULS.sendTraceTag(19239262,211,
50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function xg(){}function sc(J){var oa=ah.call(this)||this;oa.$Ba=null;oa.VTa=null;oa.$oa=!1;oa.Yp=J;oa.xf=Sc.xf;oa.TVc=!0;oa.kc=5;oa.Me="OICLaunchDialog";oa.showDialog("",Object(xf.a)(oa,oa.fyi,"oicLaunchDialogResultHandler"));oa.$Vf();oa.zW("ProtocolLaunchingDialogTitle");4!==ld.AFrameworkApplication.sa.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);
oa.uz(oa.$Ba);ud.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function Sc(){}function Qc(J,oa,Va,Ub,e){var C=document.createElement("img");C.alt=J;C.className=Ti.getImageClassWithCluster(Va,Ub);C.src=oa;C.setAttribute(Jg.a.Sd,Jg.a.vs);J=document.createElement("span");J.className="ProtocolLaunchingDialogImg32Container";J.appendChild(C);C=document.createElement("span");C.className="ProtocolLaunchingDialogIconContainer";
C.appendChild(J);e.appendChild(C)}function ie(J,oa,Va,Ub,e,C,M){var ra=document.createElement("a");ra.className="ProtocolLaunchingDialogButtonAnchor";ra.className+=" OICDialog";ra.id=J;ra.setAttribute(Jg.a.Sd,Jg.a.zr);ra.style.padding="0";ra.style.margin="0";Ub&&Qc(e,oa,Va,Ub,ra);J=document.createElement("span");J.className="ProtocolLaunchingDialogButtonLabel";J.innerText=e;ra.appendChild(J);ra.tabIndex=0;C&&Ph.a.instance.pa(Je.a.click,ra,C);M&&xh.KeyInputManager.instance.pa(Je.a.Vd,ra,M);return ra}
function ue(J){return J.Ea.keyCode===Cf.a.$h||J.Ea.keyCode===Cf.a.iBa?(J.Sb.click(),!0):!1}function Ce(J){for(var oa=0;oa<J.children.length;oa++){var Va=J.children[oa];Va.style.position="relative";Va.style.top=(Va.parentNode.offsetHeight-Va.offsetHeight)/2+"px"}}function Be(){}function le(J,oa,Va){var Ub=this;this.La=J;this.Bmg=oa;this.eDc=null;(this.UVb=ld.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&ei.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(e){Ub.eDc=
e});this.r1=Va}function hc(J,oa,Va){this.La=J;this.ymg=oa;this.r1=Va}function gd(J){var oa=Dj.call(this)||this;oa.$=J;oa.dc();return oa}function xd(J){var oa=fg.call(this)||this;oa.$=J;oa.dc();return oa}function re(J,oa,Va){Va=void 0===Va?!1:Va;var Ub=yj.call(this,J,oa)||this;Ub.oAb=null;Ub.azd=function(e){Ub.unsubscribe(function(C){e.remove_disposing(C)});Ub.ph(ge.a.Ck);Ub.Uo()};Ub.Nic=Va;return Ub}function Jc(J){return yg.call(this,J)||this}function Bc(J,oa){this.Di=oa;this.$=J}function ye(J){var oa=
Te.call(this)||this;oa.$=J;oa.dc();return oa}function cb(J){return he.call(this,J)||this}function nc(J){this.Yn="Excel";this.$=J;this.xU=lc.a.current}function Nc(J,oa,Va,Ub,e,C,M){M=J.Oa(9,void 0===M?null:M);M.sheetName=oa;M.confirmationChoice=!0;return Le.i(J,"DeleteSheet",M,Va,Ub,e,C,0)}function Rc(){}function Wc(J){var oa=Jd.call(this)||this;oa.mYd=null;oa.oYd=0;oa.ej=null;oa._state=0;oa.moveNext=function(){try{for(oa._state=1;1===oa._state;)oa.hu=oa.hu()}catch(Va){oa.dispose(),oa.mda(Va),oa._state=
3}};oa.wf=J;oa.hu=oa.fL;oa.moveNext();return oa}function fe(){}function ve(J){return Rb.call(this,J)||this}function kc(J,oa){this.$=J;this.gridView=oa}function ad(J,oa,Va){var Ub=tb.call(this,J)||this;Ub.Glb=0;Ub.vxb=!1;Ub.r0a=null;Ub.jFe=!1;Ub.Kpb=!0;Ub.NRc=null;Ub.Wn=null;Ub.zvd=0;Ub.Avd=null;Ub.yvd=null;Ub.removeHyperLink=!1;Ub.cellValue=null;Ub.location=null;Ub.W0h=function(e,C){1===e||2===e?(ud.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===e?"OK":"Remove"),Ub.Avd=C[ad.Hki],Ub.zvd=
C[ad.rej],Ub.yvd=C[ad.sbh],2===e&&(Ub.removeHyperLink=!0),Ub.commit()):ud.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Ub.pNj=function(e,C){return C&&e.length?1===C?Ub.lWe(nh.y(e,Ub.fa.xa)||Ub.rui(e),744):Ub.lWe(Fg.a.Mld(e),746):null};Ub.selectedRange=oa;Ub.yL=Va;Ub.fa=J.fa;Ub.sheetName=oa.SheetName;Ub.QKa();Ub.lm();Ub.kc=Ub.vxb?9:1;Ub.Cc(1,nf.a.instance.ea(4));Ub.vxb&&Ub.Cc(2,nf.a.instance.ea(747));J={};J=(J[ad.Dah]=Ub.jFe,J[ad.tbh]=Ub.r0a,J[ad.evg]=Ub.Glb,J[ad.fvg]=Ub.NRc,J[ad.PZg]=
Ub.Kpb,J);oa={};J=(oa[ad.Ly]=Ub.xc,oa[ad.qNj]=Ub.pNj,oa[ad.jKg]=J,oa);Ub.initializeAndShow(Ub.Wn,Ub.W0h,J);return Ub}function yd(J){return Di.call(this,J)||this}function wd(J,oa,Va,Ub){var e=hi.call(this)||this;e.$=J;e.businessBar=Ub;e.openInExcelOperation=oa;e.FJ=Va;return e}function pe(){}function bf(J){var oa=Qi.call(this,J)||this;oa.uH=null;oa.TBb=function(){ud.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(oa.$.ya.IsMeetingLiveSession)return oa.Yeg(),!0;Rg.a.Ip?
(ud.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),oa.NB&&oa.NB.length||ud.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),oa.openUrl("intent:"+oa.NB+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+oa.Eq+";end","_top")):9<=Rg.a.Aid?(ud.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),oa.openUrl(oa.DNa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Eq,
"_blank")},9E3)):(ud.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),oa.openUrl(oa.DNa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Eq,"_blank")},500));return!0};oa.tla=function(Va){return Va.Ea.keyCode===Cf.a.$h||Va.Ea.keyCode===Cf.a.iBa?(ud.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Va.Sb.click(),!0):!1};if(1!==ld.AFrameworkApplication.sa.Pa.Lj)return oa;oa.NB=
oa.$.workbookContext.ClientUrl;oa.DNa="ms-excel:ofe|u|"+oa.NB;oa.Eq=ld.AFrameworkApplication.ga.Ua("AppUrl");Rg.a.dka?oa.Eq="itms-apps://"+ld.AFrameworkApplication.ga.Ua("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Rg.a.Ip&&(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&oa.$.ya.IsMeetingLiveSession?(ud.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),oa.Eq=ld.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):
Rg.a.nfc?oa.Eq=ld.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Rg.a.gne.wAb&&(oa.Eq=ld.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return oa}function Af(){}function bg(J){this.calculateType=0;this.calculateType=J}function og(J){this.calculationMode=0;this.calculationMode=J}function Zf(J,oa){var Va=this;this.dialog=null;this.Ssf=function(){Va.dialog&&Va.dialog.hide()};this.gyi=J;this.Ab=oa;this.Ab.hmb(this.Ssf)}
function If(J,oa){return qg.call(this,J,void 0,void 0,oa)||this}function qg(J,oa,Va,Ub,e,C){oa=void 0===oa?!0:oa;Va=void 0===Va?!1:Va;Ub=void 0===Ub?null:Ub;e=void 0===e?null:e;C=void 0===C?!1:C;var M=Yg.call(this)||this;M.CX=null;M.Rl=null;M.PUa=null;M.QUa=null;var ra=M.eTd?M.eTd:CommonUIStrings.l_DefaultDialogTitle;qg.Uvb=C;M.pQb=Ub||new Vf(J,!0);M.pQb.Mpe(M);var Na=[],Ib=[];qg.gy&&(M.$Tc&&M.$Tc.forEach(function(Vd){Array.add(Na,Vd)}),M.hme&&M.hme.forEach(function(Vd){Array.add(Ib,Vd)}));oa?Va?
(M.kc=4,M.Cc(1,M.buttonText),M.Cc(2,CommonUIStrings.l_DialogClose)):(M.kc=6,M.Cc(0,CommonUIStrings.l_DialogClose)):M.kc=5;C=document.createElement("span");M.b3c&&(C.className=M.b3c);Ub=document.createElement("a");Ub.innerText=M.Vhc;Ub.href=J;Ub.target="_blank";Ub.id=M.Uhc;Ub.className=eh.AFrame.Pme;var Gc=!Rg.a.rC&&!!e&&0<e.count;if(Gc){var id=ub.a.ced(J,e);e=ub.a.mGd(J,e);Ub.href="#";Ub.target="_self";M.Rl=document.createElement("form");M.Rl.id="printPreviewPostForm1";M.Rl.method="post";M.Rl.target=
"_blank";M.Rl.action=e;e=yl(id);for(id=e.next();!id.done;id=e.next()){id=id.value;var Uc=document.createElement("input");Uc.type="hidden";Uc.name=id.key;Uc.value=id.value;M.Rl.appendChild(Uc)}}else M.Rl=null;M.Rl||qg.Uvb?qg.Uvb||(J={},Array.add(Ib,(J.type="AppLinkProps",J.id=M.Uhc,J.text=M.Vhc,J.onExecute=function(){M.kIf()},J))):(e={},id={},Array.add(Ib,(id.type="AppLinkProps",id.id=M.Uhc,id.text=M.Vhc,id.handler=(e.href=Gc?"#":J,e.target=Gc?"_self":"_blank",e),id)));M.iNa&&Array.add(Na,M.iNa);Va?
(J=document.createElement("span"),J.innerText=M.iNa.replace("{0}",""),C.appendChild(J)):M.Amf?(J=document.createElement("span"),J.id=M.mi("message"),Gc=document.createElement("span"),e=document.createElement("span"),id=M.iNa.split("{0}"),Gc.innerText=id[0],e.innerText=id[1],J.appendChild(Gc),J.appendChild(Ub),J.appendChild(e),C.appendChild(J)):(J=document.createElement("span"),J.innerText=M.iNa,C.appendChild(J),C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),
C.appendChild(Ub),qg.Uvb||Array.add(Na,"{0}"));M.Rl&&C.appendChild(M.Rl);qg.gy&&(M.N6a&&(M.Izb?M.eje(M.N6a,M.Izb):(Array.add(Na,"{0}"),J={},Array.add(Ib,(J.type="AppLinkProps",J.id="LearnMoreLinkId",J.text=M.N6a,J.onExecute=function(){M.Ohc()},J)))),M.Yqa(Na,Ib));M.NAb(ra,null,M.C6e,null,Object(xf.a)(M,M.Ov,"dialogHandler"),qg.gy?null:C);M.zW(M.mi("message"));!qg.gy&&M.Izb&&M.N6a&&(ra=document.createElement("div"),ra.className="WACDialogLearnMoreLinkContainer",M.CX=document.createElement("a"),M.CX.innerText=
M.N6a,M.CX.href=M.Izb,M.CX.target="_blank",M.CX.id=M.mi("LearnMoreLinkId"),M.CX.className=eh.AFrame.Pme,ra.appendChild(M.CX),oa?M.Lb.insertBefore(ra,M.Lb.lastChild):M.Lb.appendChild(ra),M.zW(String.format("{0} {1}",M.mi("message"),M.mi("LearnMoreLinkId"))));M.Lgb=Ub;Va?M.uz(M.kB):M.uz(M.Lgb);M.Bif();ld.AFrameworkApplication.sa.MW.pa(Je.a.click,M.Lgb,Object(xf.a)(M,M.CGe,"downloadLinkClicked"),null);M.CX&&ld.AFrameworkApplication.sa.MW.pa(Je.a.click,M.CX,Object(xf.a)(M,M.Ohc,"learnMoreLinkClicked"),
null);M.oQb=!1;return M}function Vf(J,oa){this._url=J;this.Jog=oa}function Fe(J){return pc.call(this,J)||this}function zg(J){this.Di=J}function Yf(J){var oa=Ue.call(this)||this;oa.$=J;oa.dc();return oa}function jg(){}function Ff(){this.rb=null}function de(J){this.DKa=this.b$a=null;this._initialized=!1;this.gid=J}function Tf(){this.rb=null}function Ve(J,oa,Va,Ub,e,C){oa=Qa.call(this,oa,Va,Ub,e,C)||this;oa.La=J;return oa}function We(J,oa,Va,Ub,e,C,M){oa=xe.call(this,oa,Va,Ub,e,C,M)||this;oa.dkg=J;return oa}
function Sf(J,oa,Va,Ub){J=zd.call(this,J,oa,Va,Ub)||this;J.Eog=oa;return J}function vg(J){var oa=h.call(this)||this;oa.kc=1;oa.Cc(1,CommonUIStrings.l_RetryButtonLabel);oa.Cc(0,CommonUIStrings.l_DialogClose);oa.La=J;return oa}function kh(J,oa,Va){this.La=J;this.kX=oa;this.elb=Va}function Pg(J,oa,Va,Ub){var e=qi.call(this)||this;e.i8=null;e.YQb=null;e.La=J;e.kX=oa;e.elb=Va;e.Cc(1,CommonUIStrings.l_SaveButtonLabel);e.xf=qf.xf;e.Me="FileNameDialog-SaveACopy";e.zh=Ub;return e}function qf(){}function ih(){this.rb=
null}function Qa(J,oa,Va,Ub,e){this.i8=this.um=this.dCa=null;this.MCa=!1;this.zh=this.Xfa=null;this.JQc=J;this.Ljb=oa;this.fs=Va;this.Ie=Ub;this.vh=e}function qb(J){this.ub=J;this.IEa=J.appSettings.SkyDriveUploadWebServiceBase;this.Oz=J.appSettings.FileName;this.Wea=J.Ua("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function tc(J,oa,Va,Ub,e,C,M){this.HEa=J;this.Oz=oa;this.JUa=Va;this.YQb=Ub;this.oNc=e;this.Wea=C;this.zh=M}function fd(J,oa,Va){this.La=J;this.C1=oa;this.kX=Va}function Rd(J,
oa,Va){var Ub=Xh.call(this)||this;Ub.La=J;Ub.C1=oa;Ub.kX=Va;Ub.gu=!1;Ub.kc=1;Ub.Kma(1);Ub.Cc(1,CommonUIStrings.l_SignIn);Ub.Cc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Ub}function zd(J,oa,Va,Ub){this.jUb=null;this.Nqg=J;this.ub=Va;this.cae=oa;this.D8d=new xb.a;this.vh=Ub}function xe(J,oa,Va,Ub,e,C){this.zh=null;this.Krg=J;this.C1=oa;this.elb=Va;this.ub=Ub;this.NOb=e;this.fs=C}function me(){}function mf(){var J=gi.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}
function df(){this.Kfa=this.KSb=this.ISb=this.rb=null}function rf(J,oa,Va,Ub,e){this.um=this.dCa=null;this.NCc=!1;this.pOc=this.i8=null;this.JQc=oa;this.Ljb=Va;this.fs=Ub;this.Ie=e;this.La=J}function Mg(J){this.IEa=J.appSettings.SaveAsToHostWebServiceBase;this.Oz=J.appSettings.FileName;this.Wea=J.Ua("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function lf(J,oa,Va,Ub,e,C,M,ra){this.HEa=J;this.Oz=oa;this.JUa=Ub;this.oNc=C;this.i8=Va;this.Rrg=e;this.Wea=M;this.zh=ra}function $f(J,oa,Va,
Ub){this.zh=this.d$d=null;this.BEa=J;this.fs=oa;this.lMc=Va;this.Ie=Ub}function dg(J,oa,Va,Ub,e,C,M){this.ub=J;this.pGc=Va;this.La=oa;this.mkb=Ub;this.hhb=e;this.lMc=C;this.Ihg=M}function yf(){return Li.call(this)||this}function Hg(J,oa,Va,Ub){var e=this;this.uo=this.jjb=null;this.hhb=J;this.Ie=Va;this.gpg=Ub;this.YCa=new hg.a(function(){return new Nh.a(oa.value,Object(xf.a)(e,e.pub,"getMoreInfoEventReceived"))})}function Df(J,oa,Va,Ub,e,C,M,ra,Na,Ib){this.La=oa;this.ub=J;this.kX=Ub;this.Yfa=C;this.fs=
e;this.Ie=Va;this.hde=M;this.mng=void 0===ra?null:ra;this.BEa=void 0===Na?null:Na;this.xWa=void 0===Ib?null:Ib}function xc(J,oa,Va,Ub,e,C,M,ra,Na){this.xKc=null;this.Oz="";this.mkb=J;this.fs=oa;this.zh=Na;this.Yfa=Va;this.Ie=e;this.rv=Ub;this.BEa=M;this.xWa=ra;C&&(this.xKc=new hg.a(function(){return new Nh.a(C.value,null)}))}function dd(){this.properties=this.friendlyPath=this.folderName=null}function Cd(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=
null}function Ld(J,oa,Va,Ub,e,C,M,ra){J=od.call(this,J,oa,Va,Ub,e,C,ra)||this;J.qy=null;J.tOc=null;J.tpa=null;J.bOg=CommonUIStrings.l_SaveToAnotherFolder;J.xf=Od.xf;J.Me="FileNameDialog-SaveToSharePoint";J.mkb=M;J.Log=ra;return J}function Od(){}function ef(){var J=be.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}function Xf(){this.rb=null}function Qf(J,oa,Va,Ub,e,C,M,ra){this.um=null;this.RVa=this.MCa=!1;this.Xfa=this.zh=this.Oz=null;this.ub=oa;this.HEa=this.ub.appSettings.SaveAsToHostWebServiceBase;
this.$5d=Ub;this.Ljb=e;this.Og=Va;this.fs=C;this.vh=ra;this.Ie=M;this.La=J;this.Wea=oa.Ua("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function gg(J,oa,Va){this.Yfa=Va;this.pGc=oa;this.ub=J}function Ba(J,oa,Va,Ub,e,C){this.La=oa;this.ub=J;this.kX=Ub;this.Yfa=C;this.fs=e;this.Ie=Va}function Ob(J,oa,Va,Ub,e,C){J=od.call(this,J,oa,Va,Ub,e,C)||this;J.xf=Ec.xf;J.Me="FileNameDialog-SaveAsToHost";return J}function Ec(){}function od(J,oa,Va,Ub,e,C,M){M=void 0===M?null:M;var ra=ya.call(this)||this;
ra.CI=null;ra.La=oa;ra.kX=Ub;ra.Yfa=C;ra.ub=J;ra.fs=e;ra.Ie=Va;ra.bhb=ra.ub.ra("SaveToHostWithExtraCharsInFileName");ra.zh=M;ra.Cc(1,CommonUIStrings.l_SaveButtonLabel);return ra}function Md(J,oa){this.ub=J;this.La=oa;this.bhb=this.ub.ra("SaveToHostWithExtraCharsInFileName")}function He(J,oa){var Va=kf.call(this)||this;Va.RVa=!1;Va.Oz=null;Va.La=J;Va.bhb=oa;Va.rRa=!1;return Va}function Qe(){this.rb=null}function Bf(J){this.Sl=null;this.Og=J;this.QNc=3}function Uf(J,oa,Va,Ub){oa=ob.call(this,J,oa,Va,
Ub)||this;oa.options.advanced.filter=J.Ua("OneDriveApiV72Filter")||"folder,photo";oa.options.advanced.linkType="download";oa.options.multiSelect=ld.AFrameworkApplication.Hne;J.ra("OneDriveApiV72CommandModeEnabled")&&(oa.options.commandMode=J.Ua("OneDriveApiV72CommandMode")||"none");J.ra("OneDriveApiV72QosExtraDataEnabled")&&(oa.options.qosExtradata=new Ea(ld.AFrameworkApplication.userSessionId));return oa}function Ea(J){this.olsSessionId=this.value=this.key=null;this.olsSessionId=J}function ob(J,
oa,Va,Ub){oa=nb.call(this,J,oa,Va,Ub)||this;oa.xgg=J;oa.options={};oa.options.advanced={};oa.options.action="query";oa.options.clientId=oa.ga.Ua("OneDriveApiV72ClientId");oa.options.advanced.trapFocus=!0;return oa}function ac(J,oa,Va,Ub,e){J=nb.call(this,J,oa,Va,Ub)||this;J.bae=null;J.kRb=null;J.Ejg=e;J.options={};J.options.clientId=J.ga.Ua("OneDriveApiV7ClientId");J.options.cancel=Object(xf.a)(J,J.oyc,"toggleHostDivVisibility");return J}function vc(J,oa,Va,Ub,e,C){oa=nb.call(this,oa,Va,Ub,C)||this;
oa.zh=null;oa.C1=J;oa.Erg=e;return oa}function nb(J,oa,Va,Ub){this.PDa=this.O5=null;this.LOc=this.NOc=!1;this.QVa=null;this.ub=J;this.NOb=oa;this.uDa=Va;this.fs=Ub}function fc(){}function $d(){var J=Dc.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}function Id(){}function Me(J,oa,Va,Ub){this.ghb=J;this.Ypa=oa;this.v1=Va;this.Qkg=Ub}function se(J,oa,Va,Ub,e,C,M){var ra=this;this.uo=null;this.ude=!1;this.mpa=this.V_d=0;this.iog=J;this.OVa=oa;this.OSb=Va;this.ghb=Ub;this.Ypa=
e;this.v1=C;this.YCa=new hg.a(function(){return new Nh.a(M.value,Object(xf.a)(ra,ra.pub,"getMoreInfoEventReceived"))})}function td(J,oa,Va,Ub,e,C,M,ra){var Na=this;this.RDc=null;this.aRc=!0;this.ePb="";this.ftg=0;this.yVa=null;this.hKc=3;this.ub=ra;this.v1=J;this.gj=oa;this.ekg=Va;this.lhg=Ub;this.khg=e;this.YCa=new hg.a(function(){return new Nh.a(C.value,null)});this.Rkg=new hg.a(function(){return new Nh.a(M.value,Object(xf.a)(Na,Na.Zti,"mruEventResultReceived"))});this.ub.ra("WacInTabOpenMRUIsEnabledForUiHost");
this.ub.ra("UiHostSupportsDocRebootFeatures")}function af(){return Zg.call(this)||this}function Fd(J,oa,Va,Ub,e,C){var M=this;this.cQc=this.uo=this.fPb=null;this.cVb=this.iPc=!1;this.s9d=0;this.XOc=this.oJc=!1;this.v1=J;this.ghb=oa;this.YCa=new hg.a(function(){return new Nh.a(Va.value,Object(xf.a)(M,M.pub,"getMoreInfoEventReceived"))});this.$ng=Ub;this.Ypa=e;this.vrg=C;this.wkb=this.yvc;2===this.mK.Dba&&(this.XOc=!0)}function wf(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function vf(){}
function pg(){}b.r(D);var sg=b(514),Ze=b(0),Lg=b(274);pg.prototype.di=function(){};pg.prototype.init=function(){};pg.prototype.dispose=function(){};pg.main=function(){Lg.a.instance.mj(new pg)};tl.Object.defineProperties(pg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(Ze.a)(pg,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var hg=b(685),ud=b(13),xf=b(80),Nh=b(941),Fg=b(28),mh=b(124);vf.egh=function(J){return vf.nse("New",
J)};vf.fgh=function(J){return vf.nse("Open",J)};vf.Vre=function(J,oa){return vf.Tga("LoadingMenuSection",vf.Fli,J,vf.$nb("lblLoading",oa))};vf.aob=function(J,oa,Va,Ub){return vf.Tga("MessageMenuSection",vf.lnf,oa,vf.$nb("lblMessage",J,void 0===Va?null:Va,void 0===Ub?null:Ub))};vf.zMg=function(J){return vf.Vre(J,CommonUIStrings.l_VoicedLoadingText)};vf.AMg=function(J,oa){return vf.aob(CommonUIStrings.l_NewCreationLocationMessage,J.Bi,oa.hR,oa.sna)};vf.yMg=function(J,oa){return vf.aob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,
oa.sna,"\n\n"),J.Bi)};vf.Xre=function(J){return vf.aob(CommonUIStrings.l_NewGenericErrorMessage,J.Bi)};vf.wMg=function(J,oa,Va){return vf.Tga("menuNewBlank",vf.l_h,Va?J.Bi:null,vf.Vnb(J.T4e,J.U4e,J.V4e,null,J.Dja,J.hwb,oa,"blank"))};vf.uNg=function(){return vf.$nb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};vf.ise=function(){return vf.$nb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};vf.vNg=function(J,oa){return vf.Tga("menuNewTemplates",J,null,oa)};vf.uMg=function(J,
oa){return vf.Tga("menuNewMoreTemplates",vf.PRe,null,vf.Vnb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,J,oa))};vf.yLg=function(J,oa,Va){var Ub="";Va&&oa&&(Ub=vf.Tga("BrowseMoreMenuSection",vf.PRe,null,vf.Vnb("btnBrowseMore",oa,oa,null,null,null,J||"1959943459",Va)));return Ub};vf.$nb=function(J,oa,Va,Ub){Va=void 0===Va?null:Va;var e=Ub=void 0===Ub?null:Ub;oa&&0<oa.length&&(e=vf.eof.Vnc(oa).trimEnd(),e=0<=e.indexOf("{0}")?String.format(e,
Ub):String.format("{0} {1}",e,Ub));Va=Va&&Ub?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Fg.a.Mf(Va),Fg.a.Mf(Ub),Fg.a.Mf(e)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Fg.a.Mf(J||""),vf.eof.Vnc(Fg.a.Mf(oa||"")),Va)};vf.Vnb=function(J,oa,Va,Ub,e,C,M,ra){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
Fg.a.Mf(J||""),Fg.a.Mf(oa||""),Fg.a.Mf(Va||""),Ub||"32by32",Fg.a.Mf(e||""),Fg.a.Mf(C||""),M,Fg.a.Mf(ra||""))};vf.nse=function(J,oa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',J,oa)};vf.Tga=function(J,oa,Va,Ub){Va=Va?String.format('Title="{0}"',Fg.a.Mf(Va)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Fg.a.Mf(J||""),Fg.a.Mf(oa||""),Va,Ub)};vf.lnf="MenuMru";vf.Fli="MenuLoading";vf.l_h="MenuHeader";vf.PRe="MenuFooter";vf.eof=mh.a.gx("\n","&#10;");Object(Ze.a)(vf,"NewAndOpenXmlUtilities",null,[]);var ld=b(5),mg=b(93),hh=b(168);Object(Ze.a)(wf,"HostInformation",null,[]);var $e=b(109),Qg=b(47),ch=b(371),wg=b(170),Gi=b(689),mi=b(597),ph=b(108),Ng=b(29);Fd.prototype.Mg=function(){var J=this.mK.I7a;J.$b(Ng.a.newDocument,ph.a.frame,Object(xf.a)(this,this.newDocument,"newDocument"));J.jf(Ng.a.loc,ph.a.frame,
Object(xf.a)(this,this.loc,"populateNewMenu"),96)};Fd.prototype.newDocument=function(J,oa,Va,Ub,e){return 1===Va?32:2===Va&&e&&e.MenuItemId&&e.SourceControlId?this.y_a(e.MenuItemId,e.SourceControlId):8};Fd.prototype.y_a=function(J,oa){var Va=this.jkc.x2c;if(null===Va)return 8;var Ub=ld.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(ld.AFrameworkApplication.ska&&Ub){ud.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var e={};e[ch.a.Xcb]=J;e[ch.a.bP]=this.bP;e[ch.a.lcid]=ld.AFrameworkApplication.lcid.toString();e[ch.a.reason]=Gi.a.createNew;ld.AFrameworkApplication.NU().execute(function(C){C.Qj(wg.a.y_a,e)})}else Ub=(new Date).getTime(),oa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Va,Fg.a.qf(this.Zka),Fg.a.qf(J),Fg.a.qf(this.bP),Fg.a.qf(ld.AFrameworkApplication.lcid.toString()),Fg.a.qf(Ub.toString()),Fg.a.qf(oa),Fg.a.qf(ld.AFrameworkApplication.canary),
ld.AFrameworkApplication.hj),(Va=ld.AFrameworkApplication.ga.Ua("ScenarioId"))&&""!==Va&&(oa+="&wdscenarioid="+Fg.a.qf(Va)),oa+="&"+ld.AFrameworkApplication.Dac(),ld.AFrameworkApplication.bwa&&(oa+="&"+ld.AFrameworkApplication.V$b()),(Va=this.uo?this.uo.hR:null)&&(oa+="&DestinationUrl="+Fg.a.qf(Va)),Qg.a.sf(oa,"_blank",void 0,"CreateNewDocument");2===this.mK.Dba&&(oa={},ud.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(oa.AppType=mi.a[this.mK.Dba],oa.Template=J,oa)));return 32};
Fd.prototype.Coi=function(J){var oa=Number.MAX_VALUE,Va=Number.MIN_VALUE,Ub=window.performance;if(Ub&&"undefined"!==typeof Ub.getEntriesByName){for(var e=0;e<J.length;e++){var C=Ub.getEntriesByName(J[e]);C&&0<C.length&&(C=C[0],oa=Math.min(parseInt(String(C.fetchStart)),oa),Va=Math.max(parseInt(String(C.responseEnd)),Va))}Va>oa&&(J={},ud.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(J.TotalElapsedMs=Va-oa,J.MinFetchStart=oa,J.MaxResponseEnd=Va,J)))}};Fd.prototype.loc=
function(J,oa,Va,Ub,e){if(1===Va)return this.XOc&&(ld.AFrameworkApplication.bK("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.XOc=!1),32;2!==Va||this.oJc||(this.s9d=(new Date).getTime(),J={},ud.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(J.ShouldShowTemplates=this.yvc,J.CachedNewMenuXmlExists=!!this.fPb,J.ShouldCallGetMoreInfo=this.mK.supportsGetMoreInfoForPersonalStorage,J)));return this.SRi(e)};Fd.prototype.SRi=function(J){J&&(this.fPb?
J.PopulationXML=this.fPb:(this.mK.supportsGetMoreInfoForPersonalStorage&&!this.uo&&this.qvi.Sy("Opened New menu",!0),J.PopulationXML=this.IBh(this.getTemplateListJson())));return 32};Fd.prototype.Ycf=function(){return!this.mK.supportsGetMoreInfoForPersonalStorage||!!this.uo&&3===this.uo.state&&!!this.uo.sna&&!!this.uo.hR};Fd.prototype.$di=function(){return ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.HZ?!0:this.Ycf()};Fd.prototype.getTemplateListJson=function(){var J=this;if(!this.yvc||
!this.$di())return null;if(this.wkb&&!this.cVb){var oa="9",Va=ld.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Va&&(oa=Va.NumberOfTemplatesInBackstage);var Ub=this.bP;"TemplateCollectionId"in Va&&(Ub=Va.TemplateCollectionId);oa=String.format(this.mK.g_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Fg.a.qf(ld.AFrameworkApplication.lcid.toString()),Fg.a.qf(Ub),oa);Boolean.parse(Va.AppendOriginQueryParam||"false")&&(oa+="&org=backstage");oa+="&"+ld.AFrameworkApplication.Dac();
ld.AFrameworkApplication.bwa&&(oa+="&"+ld.AFrameworkApplication.V$b());this.mK.fBb.Ul(oa,1,null,null,!1,2,function(e){J.mK.SMa("CreateNewActor.GetTemplateListJson",e.data);J.PAj(e.data.fe)},function(e){J.mK.SMa("CreateNewActor.GetTemplateListJson",e.data);J.OAj()},null,void 0,void 0,void 0,void 0,"5");this.wkb=!1}return this.cQc};Fd.prototype.PAj=function(J){this.cQc=J;this.wkb=!1;this.yFb();if(ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.HZ&&hh.c()){J=ld.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var oa=ld.AFrameworkApplication.ska;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.cQc,!0,J&&oa))}};Fd.prototype.OAj=function(){this.cVb=this.wkb=!0;this.yFb();ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.HZ&&hh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));mg.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Fd.prototype.bTh=function(J){for(var oa=0,Va=0;Va<J.length;Va++)if("ST"===
J[Va].ImageType){oa=Va;break}var Ub=J.length?J[oa]:null;J=Ub?Ub.Url||"":"";var e,C=Va=oa=!1;if(Ub&&(e=Ub.AspectRatio))e=parseFloat(e),1>e?oa=!0:1.5<e?Va=!0:1===e&&(C=!0);else switch(e={},ud.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(e.Url=J,e)),this.mK.Dba){case 3:oa=!0;break;case 2:Va=!0;break;case 5:C=!0}return{returnValue:J,K1h:oa?"95by123":Va?"123by69":C?"100by100":"123by95"}};Fd.prototype.IBh=function(J){var oa=this.xMg(J,this.jkc,this.jkc.UFa||"1056925771");J=oa.returnValue;
if(oa.$uc){this.fPb=J;oa=(new Date).getTime()-this.s9d;var Va={};ud.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Va.ElapsedMsSinceMenuOpened=oa,Va))}return J};Fd.prototype.pub=function(J,oa){ud.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.uo||3!==J.state?2===J.state&&(ud.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.iPc=!0,this.yFb()):(this.uo=J,oa||this.yFb(),ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.HZ&&
hh.c()&&hh.d("setFileMenuHostInformation")&&(J=Object.assign(new wf,{hostUrl:this.uo.hR,hostName:this.uo.sna,folderUrl:ld.AFrameworkApplication.breadcrumbFolderUrl,folderName:ld.AFrameworkApplication.breadcrumbFolderName}),ud.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(J))))};Fd.prototype.xMg=function(J,oa,Va){var Ub=!1;var e=this.Ycf(),C="";if(this.mK.supportsGetMoreInfoForPersonalStorage)if(this.iPc)C=
vf.Xre(oa),this.iPc=!1,ud.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.uo)if(e)C=vf.AMg(oa,this.uo);else if(this.uo.M6h)Ub=!0,this.wkb=!1,C=vf.yMg(oa,this.uo),ud.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Ub=!0;C=vf.Xre(oa);var M={};ud.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(M.PersonalFileStorageUrlIsSet=
!!this.uo.hR,M.StorageServiceDisplayNameIsSet=!!this.uo.sna,M))}else C=vf.zMg(oa.Bi),ud.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");e&&(e=C,oa=vf.wMg(oa,Va,!C),J=this.tNg(J,Va),Ub=J.$uc,C=e+(oa+J.returnValue));return{returnValue:vf.egh(C),$uc:Ub}};Fd.prototype.tNg=function(J,oa){var Va=!1;if(!this.yvc)return Va=!0,ud.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",$uc:Va};var Ub="",e="",C="MenuTemplate";if(this.cVb)Ub=
vf.ise(),this.cVb=!1,ud.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(J){try{var M=Sys.Serialization.JavaScriptSerializer.deserialize(J,!0);Ub=this.sNg(M,oa);ud.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");ld.AFrameworkApplication.fof&&"OneDrive"===this.Zka&&(e=vf.uMg(this.rvi,ld.AFrameworkApplication.fof))}catch(ra){oa={},ud.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(oa.JsonToConvert=
J,oa)),Ub=vf.ise()}Va=!0}else C="MenuLoading",Ub=vf.uNg(),ud.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:vf.vNg(C,Ub)+e,$uc:Va}};Fd.prototype.sNg=function(J,oa){for(var Va=this,Ub="",e=[],C=0;C<J.length;C++){var M=J[C],ra="";if(M){var Na=M.Title,Ib=M.AssetId,Gc=M.Thumbnails;Ib&&Na&&Gc&&(M=void 0,ra=this.bTh(Gc),M=ra.K1h,ra=ra.returnValue,Ub+=vf.Vnb("jbtnNewTemplate"+C,Na,null,M,null,ra,oa,Ib))}e[C]=ra}J=new $e.a(4,1,5E3,function(){Va.Coi(e)},
106);this.mK.hkc.gh(J);return Ub};Fd.prototype.yFb=function(){this.oJc=!0;this.mK.Ynf.Aw(this.jkc.Msb);this.oJc=!1};tl.Object.defineProperties(Fd.prototype,{bP:{configurable:!0,enumerable:!0,get:function(){switch(this.mK.Dba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},mK:{configurable:!0,enumerable:!0,get:function(){return this.v1.value}},jkc:{configurable:!0,enumerable:!0,get:function(){return this.ghb.value}},qvi:{configurable:!0,
enumerable:!0,get:function(){return this.YCa.value}},rvi:{configurable:!0,enumerable:!0,get:function(){return this.$ng.value}},Zka:{configurable:!0,enumerable:!0,get:function(){return this.Ypa.value}},yvc:{configurable:!0,enumerable:!0,get:function(){return this.vrg.value}}});Object(Ze.a)(Fd,"CreateNewActor",null,[]);var ai=b(1314),Zg=ai.a;vm(af,Zg);af.prototype.Wje=function(){this.fT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.fT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.fT(2,CommonUIStrings.l_Open);
this.fT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.fT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.fT(5,CommonUIStrings.l_VoicedLoadingText)};af.GNi=function(J){return af.instance.ea(J)};tl.Object.defineProperties(af,{instance:{configurable:!0,enumerable:!0,get:function(){return af.Na||(af.Na=new af)}}});af.Na=null;Object(Ze.a)(af,"MruActorIntlHelper",ai.a,[]);var ni;(function(J){J[J.success=0]="success";J[J.failure=1]="failure";J[J.spinner=2]="spinner";J[J.none=3]="none"})(ni||(ni={}));Object(Ze.b)("DisplayState",
ni);var yh=b(38);td.prototype.Zti=function(J,oa){this.yVa=J;oa||this.SJf()};td.prototype.q1i=function(){this.DC.I7a.jf(Ng.a.koc,ph.a.frame,Object(xf.a)(this,this.koc,"populateMruMenu"),96)};td.prototype.koc=function(J,oa,Va,Ub,e){return 1!==Va&&e?this.PRi(e):32};td.prototype.PRi=function(J){this.Kgh();this.Jgh();J.PopulationXML=vf.fgh(this.ePb+this.RDc);return 32};td.prototype.Kgh=function(){var J=3,oa=!1;if(this.ePb&&this.ftg===this.yVa.qCj)J={},ud.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
(J.CacheRefresh="Not Dirty",J)),J=this.hKc;else{var Va={};ud.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Va.CacheRefresh="Starting",Va));Va=this.DC.Sv();this.yVa=this.Yti.Sy("File Open opened",!0);if(this.ePb&&2!==this.hKc&&3!==this.yVa.state)oa=!0;else{J=this.bRh(this.yVa);ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.HZ&&hh.c()&&J&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(J,!0));var Ub=this.JBh(this.yVa);J=Ub.ivi;this.ePb=
Ub.returnValue}Va=this.DC.Sv()-Va;Ub={};ud.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Ub.CacheRefresh="Complete",Ub.ElapsedMs=Va,Ub))}2!==J&&(Va={},Va=(Va.DisplayState=ni[J],Va),1!==J&&(Va.IsStale=oa),ud.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Va));this.hKc=J};td.prototype.bRh=function(J){try{var oa=yh.c(J.Nud)}catch(Va){oa=null,ud.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Va)}return oa};td.prototype.Jgh=function(){if(this.aRc){ud.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var J=this.Ypi();this.aRc=J.ROj;this.RDc=J.returnValue}else ud.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");J={};ud.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(J.WaitingOnLinkInfo=this.aRc,J.NotDisplayingLink=!this.RDc,J))};td.prototype.JBh=function(J){if(1!==J.state&&J.state)if(3===J.state&&J.Nud){var oa=
this.vMg(J.Nud);J=0}else J={},ud.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(J.Display="Server Error",J)),oa=vf.aob(this.kja(1),this.kja(2)),J=1;else J={},ud.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(J.Display="Spinner",J)),J=2,oa=vf.Vre(this.kja(2),this.kja(5));return{returnValue:oa,ivi:J}};td.prototype.vMg=function(J){var oa=this.IAb.UFa||"2155708348";if(J.length){var Va=vf.$nb("lblRecentDocuments",this.kja(3));for(var Ub=0,e=0;e<J.length;e++){var C=J[e];"FileName"in
C&&"DocumentUrl"in C&&"Path"in C&&(Va+=vf.Vnb("MruButton"+e,C.FileName.toString(),C.Path.toString(),null,this.IAb.Dja,this.IAb.hwb,oa,C.DocumentUrl.toString()),C.IsPinned&&Ub++)}Va=vf.Tga("RecentDocumentsMenuSection",vf.lnf,this.kja(2),Va);oa={};ud.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(oa.Display="MRU List",oa.TotalDocuments=J.length,oa.NumPinnedDocuments=Ub,oa))}else Va=vf.aob(this.kja(0),this.kja(2)),J={},ud.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(J.Display=
"Empty MRU",J));return Va};td.prototype.Ypi=function(){var J=!0;var oa=this.RKg,Va=this.QKg;if(oa&&Va||!this.DC.supportsGetMoreInfoForPersonalStorage)J=!1;else{var Ub=this.eac.Sy("File Open",!1);3===Ub.state&&(oa=Ub.hR,Va=Ub.sna,J=!1)}Va=Va?String.format(this.kja(4),Va):null;return{returnValue:vf.yLg(this.IAb.UFa,Va,oa),ROj:J}};td.prototype.SJf=function(){this.DC.Ynf.Aw(this.IAb.Msb)};tl.Object.defineProperties(td.prototype,{DC:{configurable:!0,enumerable:!0,get:function(){return this.v1.value}},
kja:{configurable:!0,enumerable:!0,get:function(){return this.gj.value}},IAb:{configurable:!0,enumerable:!0,get:function(){return this.ekg.value}},RKg:{configurable:!0,enumerable:!0,get:function(){return this.lhg.value}},QKg:{configurable:!0,enumerable:!0,get:function(){return this.khg.value}},eac:{configurable:!0,enumerable:!0,get:function(){return this.YCa.value}},Yti:{configurable:!0,enumerable:!0,get:function(){return this.Rkg.value}}});Object(Ze.a)(td,"MruRenderer",null,[]);var fh=b(233),yi=
b(896);se.prototype.y_a=function(){!this.uo&&this.wvd.supportsGetMoreInfoForPersonalStorage?this.eac.Sy("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};se.prototype.pub=function(J){if(!this.uo&&3===J.state)this.uo=J;else if(2===J.state){this.ude?ud.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.eac.Sy("NewDocumentFromStream",!0),this.ude=!0);return}this.createNewDocumentFromStream()};se.prototype.createNewDocumentFromStream=function(){this.V_d=
(new Date).getTime();var J=this.$th.x2c;if(null===J)this.OVa(null);else{var oa=this.OSb.menuItemId,Va=this.OSb.bI,Ub=this.OSb.uyj,e=this.OSb.duh;this.mpa="streamBase64"===Ub?e.length/1024:0;ud.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.bP,this.mpa);var C=(new Date).getTime();J=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",J,Fg.a.qf(this.Zka),Fg.a.qf(oa),Fg.a.qf(this.bP),Fg.a.qf(ld.AFrameworkApplication.lcid.toString()),
Fg.a.qf(C.toString()),Fg.a.qf(Va),Fg.a.qf(ld.AFrameworkApplication.canary),ld.AFrameworkApplication.hj,Fg.a.qf(Ub));J+="&"+ld.AFrameworkApplication.Dac();ld.AFrameworkApplication.bwa&&(J+="&"+ld.AFrameworkApplication.V$b());(oa=this.uo?this.uo.hR:null)&&(J+="&DestinationUrl="+Fg.a.qf(oa));this.wvd.fBb.Ul(J,2,e,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(xf.a)(this,this.lvi,"newDocumentFromStreamSuccessHandler"),Object(xf.a)(this,this.kvi,"newDocumentFromStreamFailureHandler"),null,
void 0,void 0,void 0,void 0,"31")}};se.prototype.lvi=function(J){if(J&&J.data&&J.data.fe){var oa=yh.d(J.data.fe);var Va=oa.uu;oa.returnValue?Va.StatusCode!==fh.a.sO&&Va.StatusCode!==fh.a.oqb?(ud.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.bP,this.mpa,Va.StatusCode),this.OVa(null)):Va.NewDocumentUrl&&""!==Va.NewDocumentUrl?(J=(new Date).getTime()-this.V_d,ud.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.bP,this.mpa,J),this.iog(Va.NewDocumentUrl)):(ud.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.bP,this.mpa),this.OVa(null)):(Va={},ud.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.bP,this.mpa,(Va.ResponseData=yi.a.Bdb(J.data.fe),Va)),this.OVa(null))}else ud.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.bP,this.mpa),this.OVa(null)};se.prototype.kvi=function(J){J&&J.data&&ud.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.bP,this.mpa,J.data.status);this.OVa(null)};tl.Object.defineProperties(se.prototype,{bP:{configurable:!0,enumerable:!0,get:function(){switch(this.wvd.Dba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},$th:{configurable:!0,enumerable:!0,
get:function(){return this.ghb.value}},Zka:{configurable:!0,enumerable:!0,get:function(){return this.Ypa.value}},wvd:{configurable:!0,enumerable:!0,get:function(){return this.v1.value}},eac:{configurable:!0,enumerable:!0,get:function(){return this.YCa.value}}});Object(Ze.a)(se,"NewDocumentFromStreamOperation",null,[]);Me.prototype.create=function(J,oa,Va){return new se(J,oa,Va,this.ghb,this.Ypa,this.v1,this.Qkg)};Object(Ze.a)(Me,"NewDocumentFromStreamOperationFactory",null,[602]);var ei=b(86),la=
b(524),kb=b(55);Id.prototype.di=function(J){J.register(Me,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").zc().Ic(function(){return new Me(new hg.a(function(){return ld.AFrameworkApplication.sa.Pa.vcd()}),new hg.a(function(){return ld.AFrameworkApplication.Zka}),new hg.a(function(){return J.Hh("Common.INewAndOpenCommonHelpers")}),new hg.a(function(){return J.Hh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Id.prototype.init=function(){var J=this;ld.AFrameworkApplication.ga.$v(function(){J.Awb()})};Id.prototype.Awb=function(){var J=la.a.Fq(ei.a.instance.mc("Common.INewAndOpenCommonHelpers")),oa=la.a.Fq(ei.a.instance.mc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));ld.AFrameworkApplication.Zka&&kb.Task.WAA.call(null,J,oa).continueWith(function(){var Ub=new Fd(new hg.a(function(){return J.result}),new hg.a(function(){return ld.AFrameworkApplication.sa.Pa.vcd()}),new hg.a(function(){return oa.result}),
new hg.a(function(){return ld.AFrameworkApplication.sa.Pa.wcd().UFa||"1959943459"}),new hg.a(function(){return ld.AFrameworkApplication.Zka}),new hg.a(function(){return ld.AFrameworkApplication.Oci}));Ub.Mg();Ub.yFb()});if(ld.AFrameworkApplication.FIf){var Va=la.a.Fq(ei.a.instance.mc("Common.IEventEmitter<Common.IMruResult>"));kb.Task.WAA.call(null,J,oa,Va).continueWith(function(){var Ub=new td(new hg.a(function(){return J.result}),new hg.a(function(){return af.GNi}),new hg.a(function(){return ld.AFrameworkApplication.sa.Pa.wcd()}),
new hg.a(function(){return ld.AFrameworkApplication.FNi}),new hg.a(function(){return ld.AFrameworkApplication.ENi}),new hg.a(function(){return oa.result}),new hg.a(function(){return Va.result}),ld.AFrameworkApplication.ga);Ub.q1i();Ub.SJf()})}};Id.prototype.dispose=function(){};tl.Object.defineProperties(Id.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(Ze.a)(Id,"UXPackageManager",null,[4,5,3]);var Xb=b(128),Dc=Xb.StandardDialog;vm($d,Dc);
$d.prototype.displayError=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};$d.prototype.j5c=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(Ze.a)($d,"ErrorDialog",Xb.StandardDialog,[579]);var xb=b(139);fc.prototype.STe=function(){ud.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var J=new xb.a;J.setResult("api.onedrive.com");return J.task};Object(Ze.a)(fc,"OneDriveConsumerEndpointHelper",
null,[558]);var jd=b(49),ke=b(373),Ge=b(221);nb.prototype.P2a=function(){this.QVa||(this.QVa=this.Y8a?Ge.a.create(this.Y8a,null,null,null,!1):null);return this.QVa};nb.prototype.setup=function(J){var oa=this;this.PDa=J;this.NOc||this.LOc?this.NOc&&this.PDa&&this.PDa(!0):(J=this.P2a())?(this.LOc=!0,J.U6a.continueWith(function(Va){oa.RHi(Va)}),ke.a.bia(J)):(ud.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.PDa(!1))};nb.prototype.yyd=
function(J){ud.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",J.mg?J.mg.toString():"No error detail.")};nb.prototype.RHi=function(J){this.LOc=!1;if(J.jg)this.yyd(J),this.PDa(!1);else try{this.NOc=!0,ud.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Hjd(),ud.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.PDa(!0)}catch(oa){ud.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",oa.toString()),this.PDa(!1)}};
nb.prototype.startPicker=function(J){this.O5=J;this.uDa?ud.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(xf.a)(this,this.Xwd,"onApiReady")))};nb.prototype.Xwd=function(J){J?this.Lhc():this.ri()};nb.prototype.ri=function(){this.fs().displayError(jd.a.cNi)};nb.prototype.onSuccess=function(J){ud.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.O5&&this.O5(!0,J)};nb.prototype.dispose=function(){this.QVa&&this.QVa.dispose()};tl.Object.defineProperties(nb.prototype,{Ane:{configurable:!0,enumerable:!0,get:function(){return this.NOb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});Object(Ze.a)(nb,"AOneDriveFilePickerApiManager",null,[608,3]);vm(vc,nb);vc.prototype.start=function(J,oa){this.zh=J;this.startPicker(oa)};vc.prototype.Hjd=function(){var J={},oa={};J=1===this.Ane||2===this.Ane?(J.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
J):(oa.client_id=this.ga.appSettings.UploadToSkyDriveClientId,oa.env="INT",oa);WL.init(J)};vc.prototype.startPicker=function(J){this.O5=J;!this.uDa&&this.C1.hLa?(ud.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(xf.a)(this,this.Xwd,"onApiReady"))):(ud.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Erg())};vc.prototype.Lhc=function(){try{ud.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.zh).then(Object(xf.a)(this,
this.onSuccess,"onSuccess"),Object(xf.a)(this,this.N5,"onFailure"))}catch(J){ud.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",J,J.stack),this.ri()}};vc.prototype.N5=function(J){if(J&&J.error){if("user_canceled"===J.error.code){ud.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}ud.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else ud.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.O5&&this.O5(!1,J);this.ri()};tl.Object.defineProperties(vc.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiUrl")}}});Object(Ze.a)(vc,"OneDriveFilePickerApiManagerV5",nb,[]);vm(ac,nb);ac.prototype.start=function(J,oa){var Va=this;this.kRb=oa;var Ub=this.Ejg.STe();Ub.continueWith(function(){ud.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Va.bae=Ub.result;
Va.startPicker(function(e,C){Va.oyc();J(e,C)})},3);Ub.continueWith(function(){ud.ULS.sendTraceTag(24134242,352,15,Ub.mg.message);Va.oyc()},5)};ac.prototype.Hjd=function(){var J=this;this.options.success=function(oa){var Va={};Va.data=oa;J.onSuccess(Va)};this.options.error=function(oa){var Va={};Va.error=oa;J.N5(Va)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.bae;this.options.advanced.iframeParentDiv=this.kRb};ac.prototype.Lhc=function(){try{ud.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.oyc(),OneDrive.open(this.options)}catch(J){ud.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",J.message),this.ri()}};ac.prototype.N5=function(J){this.O5&&this.O5(!1,J);this.ri()};ac.prototype.oyc=function(){this.kRb.style.visibility="hidden"===this.kRb.style.visibility?"":"hidden"};tl.Object.defineProperties(ac.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});
Object(Ze.a)(ac,"OneDriveFilePickerApiManagerV7",nb,[]);vm(ob,nb);ob.prototype.start=function(J,oa,Va,Ub){this.options.advanced.iframeParentDiv=Va;this.options.advanced.endpointHint=Ub;this.options.cancel=oa;this.xgg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(J)};ob.prototype.startPicker=
function(J){this.O5=J;this.uDa?ud.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(xf.a)(this,this.Xwd,"onApiReady")))};ob.prototype.Hjd=function(){var J=this;this.options.success=function(oa){var Va={};Va.data=oa;J.onSuccess(Va)};this.options.error=function(oa){var Va={};Va.error=oa;J.N5(Va)}};ob.prototype.Lhc=function(){try{ud.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(J){ud.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.ri()}};ob.prototype.yyd=function(J){ud.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",J.mg?J.mg.toString():"No error detail.");ke.a.k3i(this.Y8a);this.QVa=null};ob.prototype.ri=function(){this.fs().j5c(jd.a.Tbj)};ob.prototype.N5=function(J){this.O5&&this.O5(!1,J)};
tl.Object.defineProperties(ob.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(Ze.a)(ob,"OneDriveFilePickerApiManagerV72",nb,[]);Object(Ze.a)(Ea,"IExtraData",null,[]);vm(Uf,ob);Uf.prototype.Lhc=function(){try{ud.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",ld.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(J){ud.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.ri()}};tl.Object.defineProperties(Uf.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(Ze.a)(Uf,"OneDriveFilePickerApiOpenManagerV72",ob,[]);Bf.prototype.STe=function(){this.Sl=new xb.a;ud.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.$Kd();return this.Sl.task};Bf.prototype.$Kd=function(J){J=void 0===J?null:J;var oa=String.format("GetMoreInfoHandler.ashx?{0}",ld.AFrameworkApplication.gHa);this.Og.g9(oa,1,null,J,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(xf.a)(this,this.DMh,"getMoreInfoSucceeded"),Object(xf.a)(this,this.BMh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Bf.prototype.BMh=function(J){if(J.data.httpStatus===fh.a.xEb&&"X-NewKey"in
J.data.responseHeaders){ud.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var oa={};oa["X-Key"]=J.data.responseHeaders["X-NewKey"];this.$Kd(oa)}else 0<this.QNc?(ud.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.QNc),this.QNc--,this.$Kd()):(ud.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Sl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
Bf.prototype.DMh=function(J){"PersonalFileStorageUrl"in J.data.responseHeaders&&""!==J.data.responseHeaders.PersonalFileStorageUrl?(ud.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Sl.setResult(J.data.responseHeaders.PersonalFileStorageUrl)):(ud.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Sl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(Ze.a)(Bf,"OneDriveForBusinessEndpointHelper",
null,[558]);var cf=b(581);Qe.prototype.init=function(){};Qe.prototype.dispose=function(){};Qe.prototype.di=function(J){var oa=this;this.rb=J;this.rb.register(vc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").zc().Ic(function(){return new vc(cf.a.instance,ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,ld.AFrameworkApplication.limitedEdit,ld.AFrameworkApplication.i0f,function(){return new $d})});ld.AFrameworkApplication.Udf?
this.rb.register(558,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").zc().Ic(function(){return new fc}):this.rb.register(558,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").zc().Ic(function(){return new Bf(ld.AFrameworkApplication.Hd)});this.rb.register(ac,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").zc().Ic(function(){return new ac(ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,ld.AFrameworkApplication.limitedEdit,function(){return new $d},
oa.rb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.rb.register(ob,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").zc().Ic(function(){return new ob(ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,ld.AFrameworkApplication.limitedEdit,function(){return new $d})});this.rb.register(Uf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").zc().Ic(function(){return new Uf(ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,
ld.AFrameworkApplication.limitedEdit,function(){return new $d})})};Qe.main=function(){Lg.a.instance.mj(new Qe)};tl.Object.defineProperties(Qe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(Ze.a)(Qe,"PackageManager",null,[4,5]);var kf=Xb.StandardDialog;vm(He,kf);He.prototype.displayError=function(J,oa,Va){this.Oz=oa;this.RVa=Va;ud.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",J,Va);(J=this.hZc(J))?
(this.kc=0,this.Cc(1,CommonUIStrings.l_DialogClose)):(this.kc=6,this.Cc(0,CommonUIStrings.l_DialogClose));J||ud.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.xz(jd.a.Sbj,this.dcd(J),this.kHh(J,oa),Object(xf.a)(this,this.eJd,"retryDialogHandler"),!0)};He.prototype.eJd=function(J){1===J?(ud.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.Oz?this.La.ze(Ng.a.sHb,2,[this.Oz,this.RVa]):this.La.processAction(Ng.a.sHb,2)):ud.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};He.prototype.hZc=function(J){return 0>J||6<J?(ud.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",J),0):J};He.prototype.kHh=function(J,oa){J=this.hZc(J);return this.bhb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][J]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][J]};He.prototype.dcd=function(J){J=this.hZc(J);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][J]};Object(Ze.a)(He,"ErrorRetryDialog",Xb.StandardDialog,[613]);Md.prototype.create=function(){return new He(this.La,this.bhb)};Object(Ze.a)(Md,"ErrorRetryDialogFactory",null,[583]);var jf=b(140),Ef=b(40),ya=jf.a;vm(od,ya);od.prototype.qFe=function(J,oa){this.RK(1,!!J&&J!==oa);this.CI=document.getElementById(od.RPe);Ef.a.addHandler(this.CI,"change",Object(xf.a)(this,this.tlc,"onFileNameChange"));Ef.a.addHandler(this.CI,"input",
Object(xf.a)(this,this.tlc,"onFileNameChange"));this.CI.focus()};od.prototype.Q7b=function(J){return this.bhb?(new RegExp("["+this.A6b('\\/:*?"<>|')+"]")).test(J):(new RegExp("["+this.A6b('\\/:*?"<>|#{}%~&')+"]")).test(J)};od.prototype.A6b=function(J){return J.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};od.prototype.zgd=function(){var J=Fg.a.Vq(ld.AFrameworkApplication.Zl.tn);this.RK(1,!!this.CI&&""!==this.CI.value&&this.CI.value!==J)};od.prototype.tlc=function(){var J=this;this.CI&&window.setTimeout(function(){J.zgd()},
0)};od.prototype.P7b=function(J,oa){if(1!==J)ud.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{J=oa[od.RPe];oa=od.ZBf in oa?oa[od.ZBf]:!1;ud.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Fg.a.Gpc(J),oa);var Va=Fg.a.W3(ld.AFrameworkApplication.fileName);(J=J?J.trim():null)&&""!==J&&""!==Va||1===this.sa.state?this.Q7b(J)?this.fs.create().displayError(1,J,oa):this.Yfa.pna(J+Va,oa,
this.zh):this.fs.create().displayError(2,J,oa)}};od.prototype.dispose=function(){this.CI&&(Ef.a.removeHandler(this.CI,"change",Object(xf.a)(this,this.tlc,"onFileNameChange")),Ef.a.removeHandler(this.CI,"input",Object(xf.a)(this,this.tlc,"onFileNameChange")),this.CI=null);ya.prototype.dispose.call(this)};tl.Object.defineProperties(od.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.Ie}}});od.RPe="txtFileName";od.ZBf="chkOverwrite";Object(Ze.a)(od,"FileNameDialogBase",jf.a,[]);
tl.Object.defineProperties(Ec,{xf:{configurable:!0,enumerable:!0,get:function(){return jf.a.jj(Ec.Tj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Ec.Tj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(Ze.a)(Ec,"FileNameDialogHtml",null,[]);vm(Ob,od);Ob.prototype.RP=function(J,oa){var Va=Fg.a.Vq(ld.AFrameworkApplication.Zl.tn),Ub={};oa=(Ub.txtFileName=J||Va,Ub.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Ub.chkOverwrite=oa,Ub);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(xf.a)(this,this.P7b,"fileNameDialogHandler"),oa);this.qFe(J,Va)};Object(Ze.a)(Ob,"FileNameDialog",od,[612]);Ba.prototype.create=function(){return new Ob(this.ub,this.La,this.Ie,this.kX,this.fs,this.Yfa)};Object(Ze.a)(Ba,
"FileNameDialogFactory",null,[582]);var qa=b(688);gg.prototype.Mg=function(){2===ld.AFrameworkApplication.sa.Pa.Lj?ld.AFrameworkApplication.Eb.jf(Ng.a.sHb,ph.a.frame,Object(xf.a)(this,this.xRf,"saveAsToHostActionDispatcher"),4):ld.AFrameworkApplication.Eb.$b(Ng.a.sHb,ph.a.frame,Object(xf.a)(this,this.xRf,"saveAsToHostActionDispatcher"))};gg.prototype.xRf=function(J,oa,Va,Ub,e){return oa.contextId!==ph.a.frame||J!==Ng.a.sHb?2:this.ub.ra("SaveAsToHostBrsIsEnabled")?1===Va?qa.SessionStatusManager.instance.tvb||
ld.AFrameworkApplication.N4?8:32:2===Va?(ud.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),J=this.pGc.create(),e&&Object.getType(e)===Array&&2===e.length?J.RP(e[0],!!e[1]):J.RP(null,!1),32):8:8};Object(Ze.a)(gg,"SaveAsToHostActor",null,[]);var ub=b(77);Qf.prototype.VJb=function(){1!==this.Ie.state&&(this.um=this.Ljb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,
null))};Qf.prototype.IR=function(J){J=void 0===J?0:J;1!==this.Ie.state&&this.fs.create().displayError(J,Fg.a.Vq(this.Oz),this.RVa)};Qf.prototype.nPa=function(){var J=this.ub.appSettings.BreadcrumbFolderUrl;ud.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Qg.a.sf(J,Qg.a.bX(3),void 0,"UploadToHostManager.RedirectToFolder")};Qf.prototype.mPa=function(J){var oa=!1,Va=!1;this.ub&&(oa=this.ub.ra("SaveACopyIsEnabledForUiHost"),Va=this.ub.ra("UiHostSupportsDocRebootFeatures"));
ud.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",J,oa,Va);if(oa&&Va){ud.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[ch.a.iPa]="1";Ub[ch.a.documentUrl]=J;Ub[ch.a.reason]=Gi.a.saveAs;ld.AFrameworkApplication.NU().execute(function(e){e.Qj(wg.a.dta,Ub)})}else oa&&!Va&&ld.AFrameworkApplication.ewa?Qg.a.sf(J,Qg.a.bX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
Qg.a.sf(J,Qg.a.bX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};Qf.prototype.pna=function(J,oa,Va){Va=void 0===Va?null:Va;ud.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.$5d&&!this.$5d()&&this.Og&&(this.vh&&(this.Xfa=this.vh.Fc("DialogShown","SaveAsToHostUploadTime")),this.VJb(),this.RVa=oa,this.Oz=J,(this.zh=Va)&&"true"===this.zh.SkipSaveToHost?this.g7b():this.$P())};Qf.prototype.$P=function(){var J=this;32!==this.La.processAction(Ng.a.hQa,1)?(ud.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.g7b()):this.La.ze(Ng.a.hQa,2,[function(){ud.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");J.g7b()},function(oa,Va){ud.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");J.IR(Va)}])};Qf.prototype.pMi=function(J){this.PHa();this.MCa=!1;if(J&&J.data&&J.data.fe){var oa=yh.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==
fh.a.sO&&Va.StatusCode!==fh.a.oqb)ud.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),J={},J.FailureReason=Va.StatusCode.toString(),J.ExtraInfo=Va.ExtraInfo,this.Rca(J),this.IR(parseInt(Va.ExtraInfo));else{ud.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.ZHd();try{Va.NewDocumentUrl&&""!==Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){ud.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Ub.toString())}this.cEb()}else Va=
{},ud.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Bdb(J.data.fe),Va)),J={},this.Rca((J.FailureReason="Failed to deserialize response",J)),this.IR()}else ud.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),J={},this.Rca((J.FailureReason="null response",J)),this.IR()};Qf.prototype.oMi=function(J){if(5!==J.data.status&&12!==J.data.status||this.MCa){var oa={};ud.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(oa.Status=J.data.status,oa.HttpStatus=J.data.httpStatus,oa));oa={};this.Rca((oa.FailureReason=J.data.httpStatus.toString(),oa));this.PHa();this.IR();this.cEb()}else ud.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.MCa=!0,this.zh&&"true"===this.zh.SkipSaveToHost?this.g7b():this.$P()};Qf.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};Qf.prototype.cEb=function(){this.Xfa&&(this.Xfa.stop(),this.Xfa=null)};Qf.prototype.ZHd=function(){this.zh&&
"VersionHistory"===this.zh.SaveEntryPoint&&this.La.processAction(Ng.a.Crc,2)};Qf.prototype.Rca=function(J){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.La.ze(Ng.a.$Hd,2,J)};Qf.prototype.g7b=function(){var J=this.HEa+this.Wea;J=ub.a.gl(J,"qs",Fg.a.qf(ld.AFrameworkApplication.hj));J=ub.a.gl(J,"n",Fg.a.qf((new Date).getTime().toString()));J=ub.a.gl(J,"ov",Fg.a.qf(this.RVa.toString()));J=ub.a.gl(J,"fn",Fg.a.qf(this.Oz));this.zh&&this.zh.FileDownloadUrl&&(J=ub.a.gl(J,"furl",Fg.a.qf(this.zh.FileDownloadUrl)));
this.Og.Ul(J,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(xf.a)(this,this.pMi,"onUploadFinished"),Object(xf.a)(this,this.oMi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(Ze.a)(Qf,"UploadToHostManager",null,[574]);var Dd=b(909);Xf.prototype.init=function(){ld.AFrameworkApplication.ga.$v(Object(xf.a)(this,this.QA,"onFullAppSettingsReady"))};Xf.prototype.QA=function(){ld.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.rb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Mg()};
Xf.prototype.di=function(J){this.rb=J;this.rb.register(Md,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ic(function(){return new Md(ld.AFrameworkApplication.ga,ld.AFrameworkApplication.Eb)}).zc();this.rb.register(Qf,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ic(function(){return new Qf(ld.AFrameworkApplication.Eb,ld.AFrameworkApplication.ga,ld.AFrameworkApplication.Hd,function(){return ld.AFrameworkApplication.Gg},
function(){return(new Dd.a).create()},J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),ld.AFrameworkApplication.sa,ld.AFrameworkApplication.sa.fD)}).zc();this.rb.register(Ba,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ic(function(){return new Ba(ld.AFrameworkApplication.ga,ld.AFrameworkApplication.Eb,ld.AFrameworkApplication.sa,ld.AFrameworkApplication.sa.Pa,J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).zc();
this.rb.register(gg,"Common.App.SaveAsToHost.SaveAsToHostActor").Ic(function(){return new gg(ld.AFrameworkApplication.ga,J.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).zc()};Xf.prototype.dispose=function(){};Xf.main=function(){Lg.a.instance.mj(new Xf)};tl.Object.defineProperties(Xf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(Ze.a)(Xf,"SaveAsToHostPackage",null,[4,5]);
var be=Xb.StandardDialog;vm(ef,be);ef.prototype.displayError=function(J,oa){this.KFe(J,oa,jd.a.Ubj)};ef.prototype.KFe=function(J,oa,Va){ud.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Va);this.xz(Va,J,oa,null)};ef.prototype.j5c=function(J,oa){ud.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.xz(jd.a.Wbj,J,oa,null,!0)};Object(Ze.a)(ef,"ErrorDialog",Xb.StandardDialog,[43]);tl.Object.defineProperties(Od,{xf:{configurable:!0,enumerable:!0,
get:function(){return jf.a.jj(Od.Tj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});Od.Tj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(Ze.a)(Od,"FileNameDialogHtml",null,[]);var Je=b(12),Cf=b(91),Jg=b(89);vm(Ld,od);Ld.prototype.RP=function(J){var oa=Fg.a.Vq(ld.AFrameworkApplication.Zl.tn),Va=ld.AFrameworkApplication.breadcrumbFolderName,Ub=ld.AFrameworkApplication.breadcrumbBrandName,e={};e=(e.txtFileName=J||oa,e);var C=CommonUIStrings.L_SaveAs;2===ld.AFrameworkApplication.sa.Pa.Lj&&(C=CommonUIStrings.L_SaveACopy);this.initializeAndShow(C,Object(xf.a)(this,this.P7b,"fileNameDialogHandler"),e);this.qFe(J,oa);this.GHa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");ld.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.qy=document.getElementById("anotherFolder"),J=document.getElementById("folderLocation"),this.tOc=Jg.a.Sne(J,this.qy,"anotherFolderDescribedBy"),this.qy.className="WACButton WACDialogButtonNormal",J=!1,Va&&Va.length?(this.Mie(this.qy,this.tOc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ub,Va)),
J=this.Pvg(Ub,Va)):this.Mie(this.qy,this.tOc,CommonUIStrings.l_CurrentOnlineFolder),this.Lwg(this.qy),this.Rvg(this.qy),J?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.qy,"SaveToAnotherLocationTwo"),ud.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.qy,"SaveToAnotherLocationOne"),Ef.a.addHandler(this.qy,Je.a.click,Object(xf.a)(this,this.izd,"onSaveToAnotherLocationClick")),
Ef.a.addHandler(this.qy,Je.a.Rb,Object(xf.a)(this,this.Eyf,"onSaveToAnotherLocationKeyDown")))};Ld.prototype.Pvg=function(J,oa){var Va=!1;var Ub=document.getElementById("currentLocation");Ub.innerText="";var e=this.mYe(Ub,J),C=this.mYe(Ub,oa),M=255,ra=255;255<e+C&&(M=Math.max(238,408-e),ra=Math.max(170,408-C),Va=!0);this.gyg(Ub,J,ra,oa,M);return Va};Ld.prototype.mYe=function(J,oa){var Va=document.createElement("div");Va.innerText=oa;Va.style.visibility="hidden";J.appendChild(Va);oa=Va.clientWidth;
J.removeChild(Va);return oa};Ld.prototype.gyg=function(J,oa,Va,Ub,e){oa&&(this.Kie(J,oa,Va),this.$xg(J));Ub&&this.Kie(J,Ub,e)};Ld.prototype.Kie=function(J,oa,Va){var Ub=document.createElement("div");Ub.innerText=oa;Ub.title=oa;Ub.className="SaveToAnotherFolderBreadcrumb";Ub.style.maxWidth=Va.toString()+"px";J.appendChild(Ub)};Ld.prototype.$xg=function(J){var oa=document.createElement("span");oa.id="FolderSeparator";var Va=document.createElementNS("http://www.w3.org/2000/svg","svg");Va.setAttribute("class",
"SeparatorCaret");var Ub=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ub.setAttribute("points","1 4 1 11 5 7.5");Va.appendChild(Ub);oa.appendChild(Va);J.appendChild(oa)};Ld.prototype.Mie=function(J,oa,Va){Va=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Va);oa&&(oa.innerText=Va);J.tabIndex=0;J.setAttribute(Jg.a.Sd,Jg.a.zr)};Ld.prototype.Rvg=function(J){var oa=document.createElement("span");oa.id="anotherFolderText";oa.innerText=this.bOg;oa.className="AnotherFolderTextSpan";
J.appendChild(oa)};Ld.prototype.Lwg=function(J){var oa=document.createElement("span");oa.className="cui-img-cont-float cui-img-16by16 ";this.tpa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.tpa.setAttribute("class","FolderIconSVG");var Va=document.createElementNS("http://www.w3.org/2000/svg","path");Va.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.tpa.appendChild(Va);oa.appendChild(this.tpa);
J.appendChild(oa)};Ld.prototype.Eyf=function(J){!J||J.keyCode!==Cf.a.$h&&J.keyCode!==Cf.a.K0||this.izd(J)};Ld.prototype.izd=function(){if(this.CI){var J=Fg.a.W3(ld.AFrameworkApplication.fileName),oa=this.CI.value;this.hide();oa&&""!==oa&&""!==J||1===this.sa.state?(""!==J&&(oa+=J),this.Q7b(oa)?this.fs.create().displayError(1,oa,!1):this.mkb.start(oa,this.Log)):this.fs.create().displayError(2,oa,!1)}};Ld.prototype.LRg=function(J){this.qy&&this.tpa&&(J?(this.qy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.qy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.tpa,"DisabledFolderIconSVG")):(this.qy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.qy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.tpa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.qy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.tpa,"DisabledFolderIconSVG"))))};Ld.prototype.zgd=function(){od.prototype.zgd.call(this);this.LRg(!!this.CI&&""!==this.CI.value)};Ld.prototype.dispose=function(){this.qy&&
(Ef.a.removeHandler(this.qy,Je.a.click,Object(xf.a)(this,this.izd,"onSaveToAnotherLocationClick")),Ef.a.removeHandler(this.qy,Je.a.Rb,Object(xf.a)(this,this.Eyf,"onSaveToAnotherLocationKeyDown")),this.qy=null);od.prototype.dispose.call(this)};Object(Ze.a)(Ld,"FileNameDialog",od,[70]);var $g=b(805),Tg=b(574),Dh=b(185),Mh=b(1043);Object(Ze.a)(Cd,"SaveAsDialogInput",null,[]);Object(Ze.a)(dd,"SaveLocation",null,[]);var Oh=b(178);xc.prototype.rGh=function(){var J=new $g.a(Tg.a.Ik());J.ia("type","currentHost");
return Object.assign(new dd,{folderName:this.rv.breadcrumbFolderName,friendlyPath:this.rv.breadcrumbBrandName,properties:J})};xc.prototype.pfi=function(J){return!!J&&"ClassicMru"===J.type&&!!J.service_info&&!!J.service_info.service_id&&-1!==J.service_info.service_id.indexOf("SHAREPOINT")};xc.prototype.tRh=function(){if(!this.xKc||!this.BEa)return null;var J=this.xKc.value.Sy("SaveAsToSharePointDialog",!1);if(!J||3!==J.state||!J.mnf)return null;J=J.mnf;for(var oa=new Dh.a,Va=0,Ub=0,e=0;e<J.length;e++){var C=
J[e];if(this.pfi(C)&&(Va++,C.sharepoint_info)){var M=C.url,ra=C.sharepoint_info.site_url,Na=C.title;C=Mh.b(C,ld.AFrameworkApplication.isRtl);if(M&&ra&&Na&&C){Ub++;var Ib=new $g.a(Tg.a.Ik());Ib.ia("type","SharePoint");Ib.ia("siteUrl",ra);Ib.ia("folderUrl",M);Ub++;oa.add(Object.assign(new dd,{folderName:Na,friendlyPath:C,properties:Ib}))}}}e=new Map;e.set("NumPlaces",J.length.toString());e.set("NumSharepointPlaces",Va.toString());e.set("placesWithMetadata",Ub.toString());mg.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",
0,"smartfio",e);0<Va&&(Ub?.5>1*Ub/Va&&mg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):mg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return oa};xc.prototype.jHh=function(){var J=new Dh.a;J.add(this.rGh());var oa=this.tRh();oa&&J.addRange(oa);return Object.assign(new Cd,{enableMoreLocations:!ld.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.Oz,extension:Fg.a.W3(this.rv.tn),
saveLocations:J.toArray(),scenario:"SaveToSharePoint"})};xc.prototype.gHh=function(){return{inputPropsCallback:Object(xf.a)(this,this.jHh,"getDialogInput")}};xc.prototype.RP=function(J){this.Oz=J;this.Oz||(this.Oz=String.format(CommonUIStrings.l_SaveACopy_Filename,Fg.a.Vq(this.rv.tn)));J={};J=(J.id="SaveAsDialog",J.bodyControls=this.gHh(),J);var oa=CommonUIStrings.L_SaveAs;2===this.Ie.Pa.Lj&&(oa=CommonUIStrings.L_SaveACopy);var Va=new jf.a(!1,!1,!0);Va.kc=1;Va.Me="SaveAsDialog";Va.Cc(1,CommonUIStrings.l_SaveButtonLabel);
Va.initializeAndShow(oa,Object(xf.a)(this,this.Qbj,"saveAsDialogHandler"),J)};xc.prototype.Vsj=function(J,oa){J&&""!==J&&""!==oa||1===this.Ie.state?this.ofi()?this.wli(J,oa):(""!==oa&&(J+=oa),this.mkb.start(J,this.zh)):(ud.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.fs.create().displayError(2,J,!1))};xc.prototype.wli=function(J,oa){var Va=this;mg.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);var Ub=this.xWa.c2c(CommonUIStrings.l_PickerSaveACopyOkButton,
CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.xWa.y$b(Ub).then(function(e){if(e&&0<e.length){var C=e[0][ch.a.GQi];e=e[0][ch.a.fBd];if(""!==C&&""!==e)Va.BEa.pna(e,J+oa,C,Va.zh),mg.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Va.fs.create().displayError(0,J,!1);var M=Va.kq();M&&(M.set("SiteUrlAvailable",""===C?"false":"true"),M.set("FolderUrlAvailable",""===e?"false":"true"));mg.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",
!1,!1,Object.assign(new Oh.a,{extendedProperties:M}))}}else Va.fs.create().displayError(0,J,!1),mg.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(e){"Canceled"===e?((e=Va.kq())&&e.set("IsCanceled","true"),mg.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Oh.a,{extendedProperties:e}))):mg.Health.instance.recordKpiFailure("SaveACopySFP",e,!1,!1,null)})};xc.prototype.ofi=function(){return this.xWa?this.xWa.vod()&&(ld.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)||"SharePointOnlineConsumer"===ld.AFrameworkApplication.ga.Ua("FileSource")):(ud.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};xc.prototype.kq=function(){try{return new Map}catch(J){return null}};xc.prototype.Qbj=function(J,oa){if(oa&&1===J){J=oa.fileName;var Va=Fg.a.W3(this.rv.tn);oa.moreLocationsSelected&&this.Vsj(J,Va);if(oa.locationCallback){var Ub=oa.locationCallback();Ub?Ub.properties&&"currentHost"===Ub.properties.na("type")?this.Yfa.pna(J+Va,!1,this.zh):Ub.properties&&
"SharePoint"===Ub.properties.na("type")?(oa=Ub.properties.na("siteUrl"),Ub=Ub.properties.na("folderUrl"),this.BEa.pna(Ub,J+Va,oa,this.zh)):ud.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ud.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ud.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(Ze.a)(xc,"ReactSaveAsDialog",null,[70]);Df.prototype.create=function(J){return this.Ie&&this.Ie.Pa.Lu?new xc(this.hde,this.fs,this.Yfa,ld.AFrameworkApplication.Zl,
this.Ie,this.mng,this.BEa,this.xWa,J):new Ld(this.ub,this.La,this.Ie,this.kX,this.fs,this.Yfa,this.hde,J)};Object(Ze.a)(Df,"FileNameDialogFactory",null,[45]);Hg.prototype.start=function(J){var oa=this;if(!this.pBf)if(ld.AFrameworkApplication.breadcrumbFolderUrl&&ld.AFrameworkApplication.breadcrumbFolderUrl.length)this.jjb=ld.AFrameworkApplication.breadcrumbFolderUrl;else return ud.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.uo),!1;var Va=this.gpg();Va.otj();var Ub=Va.eOh();if(!Ub)return ud.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.hhb.start(function(e,C){Va.hide();J(e,C)},function(){oa.mxd(Va)},Ub,this.jjb);return!0};Hg.prototype.mxd=function(J){J.hide();ud.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Hg.prototype.zNh=function(J){J=J.toLowerCase();J.endsWith("/")||(J+="/");var oa=J.indexOf("/documents/");return-1!==oa?J.substring(0,
oa+1)+"_layouts/15/onedrive.aspx":""};Hg.prototype.pub=function(J){this.uo||3!==J.state||(this.uo=J)};tl.Object.defineProperties(Hg.prototype,{pBf:{configurable:!0,enumerable:!0,get:function(){this.jjb||(this.YCa.value.Sy("Save As",!0),this.uo&&this.uo.hR&&this.uo.hR.length&&(this.jjb=this.zNh(this.uo.hR)));return this.jjb}}});Object(Ze.a)(Hg,"OneDriveFilePickerHelper",null,[44]);var Li=jf.a;vm(yf,Li);yf.prototype.otj=function(){this.hFc="FilePickerDialog";this.xf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Me="PickerDialog-MsoSp";this.showDialog("",null)};yf.prototype.eOh=function(){return document.getElementById("FilePickerDiv")};yf.prototype.WN=function(){};yf.prototype.bPa=function(){};Object(Ze.a)(yf,"PickerDialog",jf.a,[42]);var Th=b(974),Rg=b(23);dg.prototype.Mg=function(){var J=this,oa=this.hhb.P2a();oa?Rg.a.xA||this.ub.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.jf(Ng.a.saveToSharePoint,ph.a.frame,Object(xf.a)(this,this.RRf,"saveToSharePointActionDispatcher"),64):(oa.U6a.continueWith(function(Va){Va.jg&&
J.hhb.yyd(Va)}),this.N_b()):ud.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};dg.prototype.N_b=function(){ke.a.oFd(Object(xf.a)(this,this.RRf,"saveToSharePointActionDispatcher"));ke.a.H6c([new Th.a(Ng.a.saveToSharePoint,ph.a.frame,0)],this.hhb.P2a())};dg.prototype.RRf=function(J,oa,Va,Ub,e){return oa.contextId!==ph.a.frame||J!==Ng.a.saveToSharePoint?2:this.h6a&&(this.lMc.pBf||this.Hte)?1===Va?qa.SessionStatusManager.instance.tvb||ld.AFrameworkApplication.N4?
8:this.Ihg()?32:8:2===Va?(ud.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(e&&e.SaveEntryPoint&&"VersionHistory"===e.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Hte?(ud.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.pGc.create(e).RP(null)):(ud.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.mkb.start(null,e)),32):8:8};tl.Object.defineProperties(dg.prototype,
{h6a:{configurable:!0,enumerable:!0,get:function(){return this.ub.ra("SaveToAnotherFolderBrsIsEnabled")}},Hte:{configurable:!0,enumerable:!0,get:function(){return this.ub.ra("UserCanWriteRelative")}}});Object(Ze.a)(dg,"SaveToSharePointActor",null,[]);$f.prototype.start=function(J,oa){var Va=this;ud.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.d$d=J;this.zh=oa;this.lMc.start(function(Ub,e){Va.ZUi(Ub,e)})||this.tPd()};$f.prototype.ZUi=function(J,oa){if(J)this.onSuccess(oa);else this.N5(oa)};
$f.prototype.tPd=function(){1!==this.Ie.state&&this.fs().j5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};$f.prototype.onSuccess=function(J){ud.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(J&&J.data&&J.data.value&&J.data.value.length&&J.data.value[0].sharePoint){var oa=J.data.value[0].sharePoint.url;J=J.data.value[0].sharePoint.listUrl;var Va=null;if(oa&&(Va=J?this.NRh(J):this.MRh(oa))){this.BEa.pna(oa,
this.d$d,Va,this.zh);return}ud.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!oa,!Va)}ud.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.tPd()};$f.prototype.MRh=function(J){J.endsWith("/")||(J+="/");for(var oa=0,Va=0;Va<J.length;Va++)if("/"===J.charAt(Va)&&5===++oa)return J.substr(0,Va);return null};$f.prototype.NRh=function(J){J.endsWith("/")&&(J=J.substring(0,J.length-1));var oa=J.lastIndexOf("/");
return-1!==oa?J.substring(0,oa):null};$f.prototype.N5=function(J){ud.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");J&&J.error?ud.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",J.error.errorCode,J.error.message):ud.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.tPd()};Object(Ze.a)($f,"SaveToSharePointManager",null,[581]);lf.prototype.execute=function(J,oa){if(!ld.AFrameworkApplication.Gg&&ld.AFrameworkApplication.Hd){var Va=
this.HEa+this.Wea;Va=ub.a.gl(Va,"fu",Fg.a.qf(this.i8));Va=ub.a.gl(Va,"su",Fg.a.qf(this.Rrg));Va=ub.a.gl(Va,"fn",Fg.a.qf(this.Oz));Va=ub.a.gl(Va,"n",Fg.a.qf((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(Va=ub.a.gl(Va,"furl",Fg.a.qf(this.zh.FileDownloadUrl)));Va=Va+"&"+this.oNc;this.JUa&&this.JUa.length?Va=ub.a.gl(Va,"fnn",Fg.a.qf(this.JUa)):ud.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ud.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
ld.AFrameworkApplication.Hd.Ul(Va,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,oa,null,void 0,void 0,void 0,void 0,"9")}};Object(Ze.a)(lf,"SharePointSaveAsCaller",null,[610]);Mg.prototype.create=function(J,oa,Va,Ub){return new lf(this.IEa,this.Oz,J,oa,Va,ld.AFrameworkApplication.hj,this.Wea,Ub)};Object(Ze.a)(Mg,"SharePointUploadCallerFactory",null,[580]);var $h=b(807);rf.prototype.pna=function(J,oa,Va,Ub){this.NCc=!1;ud.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.VJb();this.i8=J;Ub&&Ub.SaveEntryPoint&&(this.pOc=Ub.SaveEntryPoint);this.dCa=this.JQc.create(J,oa,Va,Ub);Ub&&"true"===Ub.SkipSaveToHost?this.$P():this.Pxh()};rf.prototype.Pxh=function(){function J(){ud.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");oa.$P()}var oa=this;32!==this.La.ze(Ng.a.hQa,2,[function(){ud.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");oa.$P()},J])&&J()};rf.prototype.$P=
function(){ud.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.dCa.execute(Object(xf.a)(this,this.GJi,"onSaveToSharePointUploadFinished"),Object(xf.a)(this,this.FJi,"onSaveToSharePointUploadFailed"))};rf.prototype.GJi=function(J){if(J&&J.data&&J.data.fe){var oa=yh.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==fh.a.sO&&Va.StatusCode!==fh.a.oqb)ud.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
J.data.status,Va.StatusCode),Va.StatusCode!==fh.a.POf&&this.jGe(J.data.status)||(this.Rca(Va.StatusCode.toString()),this.Wrj(Va.StatusCode));else{ud.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.ZHd();try{Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){ud.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Ub.toString())}}else Va={},ud.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Bdb(J.data.fe),
Va)),this.q5b()||(this.Rca("Failed to deserialize response"),this.TJb())}else ud.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.q5b()||(this.Rca("Unknown"),this.TJb())};rf.prototype.FJi=function(J){J&&J.data?this.jGe(J.data.status)||(ud.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Rca($h.a[J.data.status]),this.TJb()):(ud.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.q5b()||(this.Rca("Unknown"),this.TJb()))};rf.prototype.q5b=
function(){if(!this.NCc)return ud.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.NCc=!0,this.$P(),!0;ud.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};rf.prototype.jGe=function(J){ud.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",J);return this.q5b()};rf.prototype.nPa=function(){ud.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Qg.a.sf(this.i8,Qg.a.bX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
rf.prototype.mPa=function(J){var oa=!1,Va=!1;ld.AFrameworkApplication.ga&&(oa=ld.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Va=ld.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,oa);if(oa&&Va){ud.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[ch.a.iPa]="1";Ub[ch.a.documentUrl]=J;Ub[ch.a.reason]=
Gi.a.saveAs;ld.AFrameworkApplication.NU().execute(function(e){e.Qj(wg.a.dta,Ub)})}else Qg.a.sf(J,Qg.a.bX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};rf.prototype.VJb=function(){this.Ie&&1===this.Ie.state||(this.um=this.Ljb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};rf.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};rf.prototype.TJb=function(){this.ri(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};rf.prototype.Zsj=function(){this.ri(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};rf.prototype.bsj=function(){var J=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.ri(CommonUIStrings.l_SaveAsFileTooLargeTitle,J,jd.a.Rbj)};rf.prototype.ri=function(J,oa,Va){Va=void 0===Va?jd.a.Vbj:Va;ud.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",J,oa);this.PHa();1!==this.Ie.state&&
this.fs().KFe(J,oa,Va)};rf.prototype.Wrj=function(J){ud.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",J);switch(J){case fh.a.c8f:this.Zsj();break;case fh.a.POf:this.bsj();break;default:this.TJb()}};rf.prototype.ZHd=function(){"VersionHistory"===this.pOc&&this.La.processAction(Ng.a.Crc,2)};rf.prototype.Rca=function(J){if("VersionHistory"===this.pOc){var oa={};this.La.ze(Ng.a.$Hd,2,(oa.FailureReason=J,oa))}};Object(Ze.a)(rf,"UploadToSharePointManager",null,[575]);df.prototype.init=
function(){};df.prototype.dispose=function(){};df.prototype.di=function(J){var oa=this;this.rb=J;this.ISb=la.a.Fq(J.mc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.KSb=la.a.Fq(J.mc("Common.IEventEmitter<Common.IMruResult>"));ld.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)||"SharePointOnlineConsumer"===ld.AFrameworkApplication.ga.Ua("FileSource")?(this.Kfa=la.a.Fq(J.mc("Common.App.SharedFilePicker.ISharedFilePicker")),kb.Task.WAA.call(null,
this.ISb,this.KSb,this.Kfa).continueWith(function(){oa.cKf()})):(this.Kfa=null,kb.Task.WAA.call(null,this.ISb,this.KSb).continueWith(function(){oa.cKf()}))};df.prototype.cKf=function(){var J=this;this.rb.register(Mg,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ic(function(){return new Mg(ld.AFrameworkApplication.ga)}).zc();this.rb.register(rf,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ic(function(){return new rf(ld.AFrameworkApplication.Eb,
J.rb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Dd.a).create()},function(){return new ef},ld.AFrameworkApplication.sa)}).zc();this.rb.register($f,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ic(function(){return new $f(J.rb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),function(){return new ef},J.rb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),
ld.AFrameworkApplication.sa)}).zc();this.rb.register(Hg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ic(function(){return new Hg(J.rb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new hg.a(function(){return J.ISb.result}),ld.AFrameworkApplication.sa,function(){return new yf})}).zc();this.rb.register(Df,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ic(function(){return new Df(ld.AFrameworkApplication.ga,
ld.AFrameworkApplication.Eb,ld.AFrameworkApplication.sa,ld.AFrameworkApplication.sa.Pa,J.rb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.rb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),J.rb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new hg.a(function(){return J.KSb.result}),J.rb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),J.Kfa?J.Kfa.result:null)}).zc();this.rb.register(dg,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ic(function(){return new dg(ld.AFrameworkApplication.ga,
ld.AFrameworkApplication.Eb,J.rb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),J.rb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),J.rb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),J.rb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return ld.AFrameworkApplication.sa.aQg})}).zc();ld.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.rb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Mg()};
df.main=function(){Lg.a.instance.mj(new df)};tl.Object.defineProperties(df.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(Ze.a)(df,"PackageManager",null,[4,5]);var gi=Xb.StandardDialog;vm(mf,gi);mf.prototype.displayError=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(Ze.a)(mf,"ErrorDialog",Xb.StandardDialog,[667]);me.default=0;Object(Ze.a)(me,"SaveToCloudErrorCodes",null,
[]);xe.prototype.start=function(J){this.zh=J;if("SharePointOnlineConsumer"===this.ub.Ua("FileSource")){var oa=ei.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(oa){oa.start(null,J);return}}this.C1.hLa?(ud.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.xPg()):(ud.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};xe.prototype.showSignInDialog=function(){this.Krg.create().RP()};
xe.prototype.ri=function(){this.fs().displayError(me.default)};xe.prototype.xPg=function(){try{ud.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var J={},oa=(J.client_id=this.ub.appSettings.UploadToSkyDriveClientId,J.env="INT",J);if(1===this.NOb||2===this.NOb)J={},oa=(J.client_id=this.ub.appSettings.UploadToSkyDriveClientId,J);J={};var Va=(J.mode="save",J.lightbox="grey",J);WL.init(oa);ud.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Va).then(Object(xf.a)(this,
this.onSuccess,"onSuccess"),Object(xf.a)(this,this.N5,"onFailure"))}catch(Ub){ud.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Ub,Ub.stack),this.ri()}};xe.prototype.onSuccess=function(J){ud.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");J&&J.data&&J.data.folders&&this.elb.pna(J.data.folders[0].id,J.data.folders[0].urls.viewInBrowser,null,this.zh)};xe.prototype.N5=function(J){if(J&&J.error){if("user_canceled"===
J.error.code){ud.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ud.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else ud.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.ri()};Object(Ze.a)(xe,"SaveToCloudManager",null,[666]);zd.prototype.h6a=function(){return this.ub.ra("SaveToCloudStorageUIIsEnabled")};zd.prototype.yTe=function(){return Ng.a.saveToCloudStorage};
zd.prototype.N_b=function(){ke.a.oFd(Object(xf.a)(this,this.PRf,"saveToCloudActionDispatcher"));ke.a.H6c([new Th.a(Ng.a.saveToCloudStorage,ph.a.frame,0)],this.cae.P2a())};zd.prototype.Mg=function(){var J=this,oa=this.cae.P2a();oa?(oa.k9(function(){J.D8d.setResult(!0)}),this.N_b()):ud.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};zd.prototype.oJf=function(){ud.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};zd.prototype.PRf=
function(J,oa,Va,Ub,e){var C=this;return oa.contextId!==ph.a.frame||J!==this.yTe()?2:this.h6a()?1===Va?qa.SessionStatusManager.instance.tvb||ld.AFrameworkApplication.N4?8:32:2===Va?(this.oJf(),e&&e.FileDownloadUrl&&ud.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.vh&&(this.jUb=this.vh.Fc("DialogShown","SaveToOneDriveReponseTime")),this.D8d.task.continueWith(function(){C.jUb&&(C.jUb.stop(),C.jUb=null);C.Nqg.start(e)}),32):8:8};Object(Ze.a)(zd,"SaveToCloudStorageActor",
null,[665]);var Ae=b(277),Xh=Xb.StandardDialog;vm(Rd,Xh);Rd.prototype.RP=function(){this.C1.zXa(Object(xf.a)(this,this.Fzf,"onSignIn"));this.Kk(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(xf.a)(this,this.$5h,"inputHandler"))};Rd.prototype.$5h=function(J){J?this.a6():(ud.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())};Rd.prototype.iSg=function(){var J="2";if(this.kX)switch(this.kX.Lj){case 3:J="0";break;case 2:J="3";break;
case 1:J="1"}return J};Rd.prototype.hide=function(){this.C1.$Fb(Object(xf.a)(this,this.Fzf,"onSignIn"));Xh.prototype.hide.call(this)};Rd.prototype.a6=function(){var J=new Ae.QueryStringBuilder("Signin.aspx");J.Ei("prompt","1");J.Ei("cbcxt",this.iSg());ld.AFrameworkApplication.Qlb(J);Qg.a.sf(J.toString(),"LoginWindow",void 0,"SignInDialog")};Rd.prototype.Fzf=function(){this.Ks&&this.hide();ud.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.La.processAction(Ng.a.saveToCloudStorage,2)};Object(Ze.a)(Rd,"SignInDialog",Xb.StandardDialog,[678]);fd.prototype.create=function(){return new Rd(this.La,this.C1,this.kX)};Object(Ze.a)(fd,"SignInDialogFactory",null,[664]);tc.prototype.execute=function(J,oa){if(!ld.AFrameworkApplication.Gg&&ld.AFrameworkApplication.Hd){var Va=this.HEa+this.Wea;Va=ub.a.gl(Va,"fo",Fg.a.qf(this.YQb));Va=ub.a.gl(Va,"fn",Fg.a.qf(this.Oz));Va=ub.a.gl(Va,"qs",Fg.a.qf(this.oNc));Va=ub.a.gl(Va,"n",Fg.a.qf((new Date).getTime().toString()));
this.zh&&this.zh.FileDownloadUrl&&(Va=ub.a.gl(Va,"furl",Fg.a.qf(this.zh.FileDownloadUrl)));this.JUa&&(Va=ub.a.gl(Va,"fnn",Fg.a.qf(this.JUa)));ld.AFrameworkApplication.Hd.Ul(Va,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,oa,null)}};Object(Ze.a)(tc,"SkyDriveUploadCaller",null,[614]);qb.prototype.create=function(J,oa,Va){return new tc(this.IEa,this.Oz,oa,J,ld.AFrameworkApplication.hj,this.Wea,Va)};Object(Ze.a)(qb,"SkydriveUploadCallerFactory",null,[585]);Qa.prototype.VJb=function(){this.Ie&&
1===this.Ie.state||(this.um=this.Ljb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Qa.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};Qa.prototype.IR=function(){1!==ld.AFrameworkApplication.sa.state&&this.fs().displayError(me.default)};Qa.prototype.nPa=function(){ud.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Qg.a.sf(this.i8,Qg.a.bX(3),void 0,"UploadToCloudManager.RedirectToFolder")};
Qa.prototype.mPa=function(J){var oa=!1,Va=!1;ld.AFrameworkApplication.ga&&(oa=ld.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Va=ld.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,oa);if(oa&&Va){ud.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[ch.a.iPa]="1";Ub[ch.a.documentUrl]=J;ld.AFrameworkApplication.NU().execute(function(e){e.Qj(wg.a.dta,
Ub)})}else Qg.a.sf(J,Qg.a.bX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};Qa.prototype.pna=function(J,oa,Va,Ub){Va=void 0===Va?null:Va;Ub=void 0===Ub?null:Ub;ud.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.vh&&(this.Xfa=this.vh.Fc("DialogShown","SaveToOneDriveUploadTime"));this.VJb();this.i8=oa;this.dCa=this.JQc.create(J,Va,Ub);this.zh=Ub;this.$P()};Qa.prototype.$P=function(){ud.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.dCa.execute(Object(xf.a)(this,
this.EJi,"onSaveToCloudUploadFinished"),Object(xf.a)(this,this.DJi,"onSaveToCloudUploadFailed"))};Qa.prototype.EJi=function(J){this.PHa();this.MCa=!1;if(J&&J.data&&J.data.fe){var oa=yh.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==fh.a.sO&&Va.StatusCode!==fh.a.oqb)ud.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.IR();else{ud.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Va.NewDocumentUrl&&""!==
Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){ud.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Ub.toString())}this.cEb()}else Va={},ud.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Bdb(J.data.fe),Va)),this.IR()}else ud.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.IR()};Qa.prototype.DJi=function(J){5!==J.data.status&&12!==J.data.status||this.MCa?(ud.ULS.sendTraceTag(6590605,
216,10,"UploadToCloudManager HTTP failure with code: {0}",J.data.status),this.PHa(),this.IR(),this.cEb()):(ud.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.MCa=!0,this.$P())};Qa.prototype.cEb=function(){this.Xfa&&(this.Xfa.stop(),this.Xfa=null)};Object(Ze.a)(Qa,"UploadToCloudManager",null,[584]);ih.prototype.init=function(){ld.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&this.rb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Mg()};
ih.prototype.dispose=function(){};ih.prototype.di=function(J){this.rb=J;this.rb.register(fd,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ic(function(){return new fd(ld.AFrameworkApplication.Eb,cf.a.instance,ld.AFrameworkApplication.sa.Pa)}).zc();this.rb.register(qb,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ic(function(){return new qb(ld.AFrameworkApplication.ga)}).zc();
this.rb.register(zd,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ic(function(){return new zd(J.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),ld.AFrameworkApplication.ga,ld.AFrameworkApplication.sa.fD)}).zc();this.rb.register(Qa,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ic(function(){return new Qa(J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Dd.a).create()},
function(){return new mf},ld.AFrameworkApplication.sa,ld.AFrameworkApplication.sa.fD)}).zc();this.rb.register(xe,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ic(function(){return new xe(J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),cf.a.instance,J.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,function(){return new mf})}).zc()};ih.main=function(){Lg.a.instance.mj(new ih)};tl.Object.defineProperties(ih.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(Ze.a)(ih,"PackageManager",null,[4,5]);tl.Object.defineProperties(qf,{xf:{configurable:!0,enumerable:!0,get:function(){return jf.a.jj(qf.Tj,CommonUIStrings.l_SaveACopyFileName)}}});qf.Tj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(Ze.a)(qf,"FileNameDialogHtml",null,[]);var qi=jf.a;vm(Pg,qi);Pg.prototype.RP=function(J,oa,Va){this.YQb=J;this.i8=Va;J={};oa=(J.txtFileName=Fg.a.Vq(ld.AFrameworkApplication.Zl.tn),J.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,oa),J);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(xf.a)(this,this.P7b,"fileNameDialogHandler"),oa);ud.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
Pg.prototype.P7b=function(J,oa){1!==J?ud.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(J=oa.txtFileName.trim(),ud.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),oa=Fg.a.W3(ld.AFrameworkApplication.fileName),J&&""!==J&&""!==oa&&(J+=oa),this.elb.pna(this.YQb,this.i8,J,this.zh))};Object(Ze.a)(Pg,"FileNameDialog",jf.a,[680]);kh.prototype.create=function(J){return new Pg(this.La,this.kX,this.elb,J)};Object(Ze.a)(kh,"FileNameDialogFactory",
null,[668]);var h=Xb.StandardDialog;vm(vg,h);vg.prototype.displayError=function(J){ud.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",J);this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(xf.a)(this,this.eJd,"retryDialogHandler"))};vg.prototype.eJd=function(J){1===J?(ud.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Ng.a.saveACopy,2)):ud.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(Ze.a)(vg,"RetryDialog",Xb.StandardDialog,[667]);vm(Sf,zd);Sf.prototype.h6a=function(){return this.ub.ra("SaveACopyBrsIsEnabled")};Sf.prototype.yTe=function(){return Ng.a.saveACopy};Sf.prototype.N_b=function(){ke.a.oFd(Object(xf.a)(this,this.PRf,"saveToCloudActionDispatcher"));ke.a.H6c([new Th.a(Ng.a.saveACopy,ph.a.frame,0)],this.Eog.P2a())};Sf.prototype.oJf=function(){ud.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(Ze.a)(Sf,"SaveACopyActor",zd,
[]);vm(We,xe);We.prototype.onSuccess=function(J){J&&J.data&&J.data.folders?(ud.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.dkg.create(this.zh).RP(J.data.folders[0].id,J.data.folders[0].name,J.data.folders[0].urls.viewInBrowser)):(ud.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ri())};We.prototype.N5=function(J){J&&J.error&&"user_canceled"===J.error.code&&ud.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
xe.prototype.N5.call(this,J)};We.prototype.ri=function(){ud.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");xe.prototype.ri.call(this)};Object(Ze.a)(We,"SaveACopyManager",xe,[]);vm(Ve,Qa);Ve.prototype.hod=function(){return!!this.zh&&!!this.zh.SaveEntryPoint&&"VersionHistory"===this.zh.SaveEntryPoint.toString()};Ve.prototype.IR=function(){ud.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.hod()){var J={};this.La.ze(Ng.a.$Hd,2,(J.FailureReason="Unknown",
J))}Qa.prototype.IR.call(this)};Ve.prototype.nPa=function(){ud.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.hod()&&this.La.processAction(Ng.a.Crc,2);Qa.prototype.nPa.call(this)};Ve.prototype.mPa=function(J){ud.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",J);this.hod()&&this.La.processAction(Ng.a.Crc,2);Qa.prototype.mPa.call(this,J)};Ve.prototype.$P=function(){var J=this;this.zh&&"true"===this.zh.SkipSaveToHost?Qa.prototype.$P.call(this):
32!==this.La.processAction(Ng.a.hQa,1)?(ud.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Qa.prototype.$P.call(this)):this.La.ze(Ng.a.hQa,2,[function(){ud.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Qa.prototype.$P.call(J)},function(){ud.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");J.IR()}])};Object(Ze.a)(Ve,"SaveACopyUploadToCloudManager",
Qa,[]);Tf.prototype.init=function(){ld.AFrameworkApplication.ga.$v(Object(xf.a)(this,this.QA,"onFullAppSettingsReady"))};Tf.prototype.QA=function(){ld.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.rb.resolve("Common.App.SaveACopy.SaveACopyActor").Mg()};Tf.prototype.dispose=function(){};Tf.prototype.di=function(J){this.rb=J;this.rb.register(Ve,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ic(function(){return new Ve(ld.AFrameworkApplication.Eb,J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Dd.a).create()},function(){return new vg(ld.AFrameworkApplication.Eb)},ld.AFrameworkApplication.sa,ld.AFrameworkApplication.sa.fD)}).zc();this.rb.register(kh,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ic(function(){return new kh(ld.AFrameworkApplication.Eb,ld.AFrameworkApplication.sa.Pa,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).zc();this.rb.register(Sf,"Common.App.SaveACopy.SaveACopyActor").Ic(function(){return new Sf(J.resolve("Common.App.SaveACopy.SaveACopyManager"),
J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),ld.AFrameworkApplication.ga,ld.AFrameworkApplication.sa.fD)}).zc();this.rb.register(We,"Common.App.SaveACopy.SaveACopyManager").Ic(function(){return new We(J.resolve("Common.App.SaveACopy.FileNameDialogFactory"),J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),cf.a.instance,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),ld.AFrameworkApplication.ga,ld.AFrameworkApplication.V0a,function(){return new vg(ld.AFrameworkApplication.Eb)})}).zc()};
Tf.main=function(){Lg.a.instance.mj(new Tf)};tl.Object.defineProperties(Tf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(Ze.a)(Tf,"PackageManager",null,[4,5]);var Ab;(function(J){J[J.myFiles=0]="myFiles";J[J.recent=1]="recent";J[J.currentFolder=2]="currentFolder";J[J.yourPhone=3]="yourPhone"})(Ab||(Ab={}));Object(Ze.b)("SharedFilePickerLandingLocation",Ab);de.prototype.R0a=function(J){this._initialized||(J.Pn(wg.a.WIf),J.Km(wg.a.WIf,Object(xf.a)(this,
this.LIi,"onReceivedPickerResponse")),this._initialized=!0)};de.prototype.y$b=function(J){var oa=this;return this.DKa=new Promise(function(Va,Ub){var e={};e[ch.a.FQi]=J;oa.b$a=function(C,M){""===M?(ud.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Va(C)):("Canceled"===M?ud.ULS.sendTraceTag(572548164,306,50,M):ud.ULS.sendTraceTag(556901065,306,10,M),Ub(M))};oa.gid.execute(function(C){oa.R0a(C);C.Qj(wg.a.JNi,e)})})};de.prototype.LIi=function(J){this.b$a(J.Values[ch.a.tej],void 0===
J.Values[ch.a.eBd]||null===J.Values[ch.a.eBd]?"":J.Values[ch.a.eBd])};de.prototype.vod=function(){return ld.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};de.prototype.c2c=function(J,oa,Va,Ub,e,C,M){var ra=void 0===ra?null:ra;var Na={};Na[ch.a.fej]=J;Na[ch.a.titleText]=oa;Na[ch.a.sEg]=Va;Na[ch.a.tEg]=Ub;Na[ch.a.uEg]=!1;Na[ch.a.ibh]=!0;Na[ch.a.kuh]=e;Na[ch.a.IQi]=C;Na[ch.a.HQi]=Ab[M];hh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Na[ch.a.JQi]="Dark");ra&&(null!=ra.rUc&&
(Na[ch.a.rUc]=ra.rUc),null!=ra.fjd&&(Na[ch.a.fjd]=ra.fjd));return Na};Object(Ze.a)(de,"SharedFilePickerManager",null,[573]);Ff.prototype.di=function(J){this.rb=J;J.register(de,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").zc().Ic(function(){return new de(J.mc("Postmessage.IHostPostmessenger"))})};Ff.prototype.init=function(){var J=this;ld.AFrameworkApplication.ga.$v(function(){J.Awb()})};Ff.prototype.Awb=function(){this.rb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
Ff.prototype.dispose=function(){};Ff.main=function(){Lg.a.instance.mj(new Ff)};tl.Object.defineProperties(Ff.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(Ze.a)(Ff,"SharedFilePickerPackage",null,[4,5]);var jc=b(1273),Oc=b(975);jg.prototype.Lie=function(J){var oa=!1;J&&(J.I1c(),J.MNg&&(oa=!1));return oa};jg.prototype.m0g=function(){var J=ld.AFrameworkApplication.sa.Pa;J=new jc.a(J.Lj,Oc.a.Yac(),!1,1===J.Kba);this.Lie(J)&&ud.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};jg.prototype.i3b=function(J,oa,Va,Ub,e,C){J=new jc.a(J,Va,Ub,oa,e,C);this.Lie(J)&&ud.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};jg.prototype.s6g=function(){var J=ld.AFrameworkApplication.sa.Pa,oa=ld.AFrameworkApplication.ga,Va=J.Lj,Ub=1===J.Kba;if(oa.ra(Oc.a.GUh(Va))){var e=Oc.a.Yac(),C=8<Rg.a.f4a;if(2!==Va||2!==e||!Ub){oa=oa.ra(Oc.a.HUh(Va));var M=J.pRf(),ra=function(){return J.NB};oa&&!Oc.a.Rmd(Oc.a.pbd(Va))&&this.i3b(Va,Ub,e,C,ra,M)}}};jg.prototype.init=
function(){var J=ld.AFrameworkApplication.ga,oa=J.ra("WildFireChromeExtensionEnabled");J=J.ra("WildFireChromeExtensionBar")&&oa;Oc.a.Avc&&J&&!Oc.a.Rmd(Oc.a.Ive)?this.m0g():(document.body&&Oc.a.Bqj&&this.s6g(),ld.AFrameworkApplication.Eb.$b(Ng.a.Yqd,ph.a.frame,Object(xf.a)(this,this.Yqd,"launchWildFireBusinessBar")))};jg.prototype.Yqd=function(J,oa,Va,Ub,e){if(1===Va)return 32;if(!e)return 8;this.i3b(e.app,e.mode,e.platform,e.useTwoButton,null,null);return 32};jg.prototype.dispose=function(){};jg.prototype.di=
function(){};jg.main=function(){Lg.a.instance.mj(new jg)};tl.Object.defineProperties(jg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(Ze.a)(jg,"PackageManager",null,[4,5]);var sd=b(216),we=b(1258),Ue=sd.a;vm(Yf,Ue);Yf.prototype.create=function(){this.Fb(this.$.da.Aa(5)||new we.a(this.$,!this.$.Caa))};Yf.ja=function(J){J.da.Ha(4,new Yf(J))};Object(Ze.a)(Yf,"BusinessBarManagerFactory",sd.a,[]);var qe=b(10),ja;"undefined"==typeof ja&&(ja={});window.MSOJS=
ja;ja.hfb=function(){function J(){return M()&&(Ye()||3<=(id()?Gf("version/"):0))}function oa(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Va(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Ub(){pl||(pl=!0,nl=e("Windows Phone"))}function e(Wf){Wf=(new RegExp(Wf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var oh=-1;return null!=Wf&&2<=Wf.length&&(oh=parseFloat(Wf[1]),isNaN(oh)&&(oh=-1)),oh}function C(){return"function"==typeof navigator.msLaunchUri&&
!Va()&&!Vd()&&!ra()}function M(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function ra(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Na(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Ib(){return Na()?8==window.document.documentMode:!1}function Gc(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function id(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Uc(){return 0<=
window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Vd(){var Wf=window.navigator.userAgent.toLowerCase();return 0<=Wf.indexOf("android")&&0<=Wf.indexOf("chrome")}function Ye(){return 3<=(Gc()?Gf("firefox/"):0)}function Gf(Wf){var oh=window.navigator.userAgent.toLowerCase(),Zh=oh.indexOf(Wf),Kh,Ei;return 0<=Zh?(Kh=Zh+Wf.length,Ei=oh.length,parseInt(oh.substring(Kh,Ei))):0}function rg(Wf,oh,Zh,Kh,Ei){if(Kh&&null!=oh)oh();else if(C())navigator.msLaunchUri(Wf,oh,Zh);else if(!(Uc()||0<=
window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&M())||ra())Eg(Wf,oh,Zh);else if(Uc()&&Ei)a:{try{window.open(Wf,"_self")}catch(Si){null!=Zh&&Zh();break a}null!=oh&&oh()}else Dg(Wf,oh,Zh)}function Dg(Wf,oh,Zh){var Kh=document.getElementById("OICLinkTag"),Ei;null==Kh&&(Kh=document.createElement("a"),Kh.id="OICLinkTag",Kh.style.visibility="hidden",Kh.href="",Kh.target=0==(aj.Options&qk.SupportsTopTargetNavigation)||aj.NoBrowserModalDialogs?
"_blank":"_top",document.body.appendChild(Kh),null!=Kh.addEventListener&&Kh.addEventListener("click",function(Si){null!=Si.stopPropagation&&Si.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Ei=function(Si){var Ki=document.createEvent("MouseEvent");return Ki.initMouseEvent(Si,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ki},Ei.prototype=Event.prototype,window.MouseEvent=Ei),Kh.href=Wf,Kh.dispatchEvent(new MouseEvent("click"))}catch(Si){null!=Zh&&Zh();return}null!=oh&&oh()}function Eg(Wf,
oh,Zh){var Kh=document.getElementById("OICFrame");null==Kh&&(Kh=document.createElement("iframe"),Kh.className="ObjectInDialog",Kh.style.visibility="hidden",Kh.src="about:blank",document.body.appendChild(Kh),Kh.id="OICFrame");try{Kh.contentWindow.location.href=Wf}catch(Ei){null!=Zh&&Zh();return}null!=oh&&oh()}function Ch(Wf){return 0!=(Wf.Options&qk.SkipProtocolHandler)||Ib()}function kj(Wf){return Wf===Yk.ReadOnly||Wf===Yk.ReadWrite}function Lj(Wf,oh,Zh,Kh){var Ei,Si;try{if(Ei=new ActiveXObject(Cc),
Ei)return Si=Ei.ViewDocument3(window.self,Wf,oh,Kh),Si?(Vk(Lk.O14ActiveX),fj.None):fj.Failed}catch(Ki){}if(qk.O14Only===(Zh&qk.O14Only))return aj.DescriptiveUnattemptedEnums?fj.O14AttemptFailure:fj.Unattempted;try{if(Ei=new ActiveXObject(Vc),Ei)return Si=Ei.ViewDocument3(window.self,Wf,oh,Kh),Si?(Vk(Lk.O12ActiveX),fj.None):fj.Failed}catch(Ki){}if(qk.O12UpOnly===(Zh&qk.O12UpOnly))return aj.DescriptiveUnattemptedEnums?fj.O12UpOnlyFail:fj.Unattempted;try{if(Ei=new ActiveXObject(rd),Ei)return Si=kj(oh)?
Ei.ViewDocument2(window.self,Wf,Kh):Ei.EditDocument2(window.self,Wf,Kh),Si?(Vk(Lk.O11ActiveX),fj.None):fj.Failed}catch(Ki){}return aj.DescriptiveUnattemptedEnums?fj.ActiveXUnattempted:fj.Unattempted}function Rj(Wf,oh,Zh,Kh,Ei){var Si,Ki,Vj;Wf==qj.Visio&&Zh==Yk.ReadWrite&&(Zh=Yk.WriteOnly);Wf=Ei;(Kh=Kh||Va()&&!(Ub(),8<=nl))||(Si="",Si+=kj(Zh)?Ah+Uh:ii,Si+=ij,Wf+=Sk(Si));Wf+=Sk(oh);aj.NewTelemetryDataIsEnabled&&(Ki=-1!==Wf.indexOf("?")?"&":"?",Ki+=aj.SessionOrigin?"OR=wac-"+aj.SessionOrigin+"&":"",
Ki+=aj.ClickTime?"CT="+aj.ClickTime+"&":"",Ki+=aj.CorrelationId?"CID="+aj.CorrelationId:"",Ki="?"!=Ki?Ki:"",Ki="&"!=Ki.slice(-1)?Ki:Ki.slice(0,-1),Wf+=Sk(Ki));oh=window.location.href;Zh=tk;Kh=oh.toLowerCase().indexOf("&"+Zh+"=");var xj;Zh=-1==Kh?void 0:(Vj=Kh+(Zh.length+2),xj=oh.indexOf("&",Vj),-1==xj)?oh.substr(Vj):oh.substring(Vj,xj);if(null!=Zh&&"undefined"!=typeof Zh){Vj="";try{Vj=decodeURIComponent(Zh)}catch(Mk){}0<Vj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Vj)&&
(Wf+=Ji,Wf+=Vj)}return Wf}function Jk(Wf,oh,Zh,Kh,Ei,Si){var Ki=ll(Wf),Vj;return null==Ki?(F(aj.DescriptiveUnattemptedEnums?fj.ProtocolHandlerIsNull:fj.Unattempted,aj.Application),!1):(Vj=Rj(Wf,oh,Zh,Kh,Ki),rg(Vj,al,fl,Ei,Si),!0)}function Sk(Wf){if(M()&&Uc()){var oh="";try{oh=decodeURI(Wf)}catch(Zh){}if(oh==Wf)return encodeURI(Wf)}return Wf}function al(){Vk(Lk.ProtocolHandler)}function fl(){aj.Options|=qk.SkipProtocolHandler;ml(aj,ik,Kk)}function gl(){null!=Wk&&Wk(Lk.RoamingProtocolHandler)}function bl(){null!=
Xk&&Xk(fj.ControlNeeded)}function kl(){var Wf=document.getElementById(Og),oh;if(null==Wf){if(oh=Hd,M()&&3<=(id()?Gf("version/"):0)&&Uk(te,!0)&&(oh=te),!Uk(oh,!0))if(M()&&Uk(lg,!0))oh=lg;else return null;Wf=document.createElement("object");Wf.id=Og;Wf.type=oh;Wf.style.width="0px";Wf.style.height="0px";Wf.style.setProperty("visibility","hidden","");document.body.appendChild(Wf);Wf=document.getElementById(Og)}return Wf}function Uk(Wf,oh){var Zh=window.navigator.mimeTypes,Kh;return null==Zh?!1:(Kh=Zh[Wf],
Kh)?oh&&!Kh.enabledPlugin?!1:!0:!1}function hl(Wf){try{if(null!=new ActiveXObject(Wf))return!0}catch(oh){}return!1}function jl(Wf){switch(Wf){case qj.OneNote:return Ih;default:return""}}function ll(Wf){if(Wf!=qj.OneNote&&Va()&&!(Ub(),8<=nl))return"office:";switch(Wf){case qj.Excel:return"ms-excel:";case qj.OneNote:return"onenote:";case qj.PowerPoint:return"ms-powerpoint:";case qj.Visio:return"ms-visio:";case qj.Word:return"ms-word:";case qj.Project:return"ms-project:";case qj.Publisher:return"ms-publisher:";
case qj.Infopath:return"ms-infopath:";case qj.Access:return"ms-access:";default:return""}}function ol(Wf){switch(Wf){case qj.Excel:return"root\\office15\\excel.exe";case qj.PowerPoint:return"root\\office15\\powerpnt.exe";case qj.Visio:return"root\\office15\\visio.exe";case qj.Word:return"root\\office15\\winword.exe";case qj.Project:return"root\\office15\\winproj.exe";case qj.Publisher:return"root\\office15\\mspub.exe";case qj.Infopath:return"root\\office15\\infopath.exe";case qj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function ml(Wf,oh,Zh){if(aj=Wf,ik=oh,Kk=Zh,Wf.DocumentUrl){var Kh=Zh=oh=Wf.DocumentUrl;try{Kh=decodeURIComponent(Wf.DocumentUrl)}catch(Mk){}try{Zh=encodeURI(Wf.DocumentUrl)}catch(Mk){}oh=oh+""+Wf.CorrelationIdForWinClient;Kh+=Wf.CorrelationIdForWinClient;Zh+=Wf.CorrelationIdForWinClient;Wf.Mode===Yk.ReadWrite&&qk.CheckoutRequired===(Wf.Options&qk.CheckoutRequired)&&(Wf.Mode=Yk.ForceCheckout);qk.HostIsEditOnly===(Wf.Options&qk.HostIsEditOnly)&&(Wf.Mode=Yk.WriteOnly);if(Ch(Wf)?
0:M()&&(Wf.Application==qj.OneNote||Uk(hf,!1)||Uk(ff,!1))||C()||Vd()||!(J()||Ye()||"ActiveXObject"in window&&!Va()||Uc())||15<=fa())Jk(Wf.Application,Wf.EncodeUrl?Zh:oh,Wf.Mode,Wf.Application==qj.OneNote,Wf.SilentExternalHandler,Wf.NavigateUsingWindowOpen);else{var Ei;if(Ei=Ib())a:{var Si=Wf.EncodeUrl?oh:Kh,Ki=Wf.Mode,Vj=jl(Wf.Application);try{Ei=(new ActiveXObject(yb)).ViewDocument3(window.self,Si,Ki,Vj);break a}catch(Mk){}Ei=!1}if(Ei)Vk(Lk.O15ActiveX);else{if(J()||Ye()){var xj=Wf.EncodeUrl?oh:Kh;
Kh=Wf.Mode;Ei=jl(Wf.Application);Si=kl();if(null==Si)xj=aj.DescriptiveUnattemptedEnums?fj.PluginIsNull:fj.Unattempted;else{Ki=!1;try{Ki=Si.ViewDocument3(window.self,xj,Kh,Ei)}catch(Mk){}if(!Ki)try{Ki=kj(Kh)?Si.ViewDocument2(window.self,xj,Ei):Si.EditDocument2(window.self,xj,Ei)}catch(Mk){}xj=Ki?(Vk(Lk.NpapiPlugin),fj.None):fj.Failed}}else{try{xj=new ActiveXObject(lh),null!=xj&&xj.SaveSSOCreds()}catch(Mk){}xj=Lj(Wf.EncodeUrl?oh:Kh,Wf.Mode,Wf.Options,jl(Wf.Application))}if(xj!=fj.None){if(Kh=Wf.CouldUseRoamingApps)ql||
(ql=!0,rl=e("Windows NT")),Kh=6.1<=rl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Na()||Ye()||Uc());if(Kh&&Wf.Application!=qj.OneNote){if(!ja.hfb.zQj()){F(fj.ControlNeeded,aj.Application);return}if(Wf.RoamingAppsLauncher){"undefined"==typeof Wf.RoamingAppsLauncher||null==Wf.RoamingAppsLauncher?F(aj.DescriptiveUnattemptedEnums?fj.RoamingLauncherIsNull:fj.Unattempted,aj.Application):"undefined"==typeof Wf.RoamingBitsUrl||null==Wf.RoamingBitsUrl?ja.hfb.HQj(Wf.DocumentUrl,Wf.RoamingAppsLauncher,
Wf.Application,Wf.ApplicationParameters,ik,Kk):ja.hfb.Meg(Wf.DocumentUrl,Wf.RoamingAppsLauncher,Wf.RoamingApplicationExe,Wf.ApplicationParameters,Wf.RoamingPlatform,Wf.RoamingBitsUrl,ik,Kk);return}if(!Wf.ContinueIfLauncherIsNull){F(fj.LauncherNeeded,aj.Application);return}}qk.NoProtocolHandlerFallback==(Wf.Options&qk.NoProtocolHandlerFallback)||Ch(Wf)||Na()||M()&&!(aj.DescriptiveUnattemptedEnums?xj>=fj.O14Unattempted&&xj<=fj.DocumentUrlIsNull:xj==fj.Unattempted)?F(xj,aj.Application):Jk(Wf.Application,
Wf.EncodeUrl?Zh:oh,Wf.Mode,Wf.Application==qj.OneNote,Wf.SilentExternalHandler,Wf.NavigateUsingWindowOpen)}}}}else F(aj.DescriptiveUnattemptedEnums?fj.DocumentUrlIsNull:fj.Unattempted,aj.Application)}function Vk(Wf){null!=ik&&ik(Wf)}function F(Wf,oh){"undefined"==typeof oh&&(oh=null);null!=Kk&&Kk(Wf,oh)}function fa(){var Wf=0;if(J()||Ye()||Uc()){var oh=kl();try{null!=oh&&(Wf=oh.GetOfficeVersion())}catch(Zh){}}else hl(yb)?Wf=15:hl(Cc)?Wf=14:hl(Vc)?Wf=12:hl(rd)&&(Wf=11);return Wf}function Pa(){return M()&&
(Uk(Hd,!0)||Uk(te,!0))}var yb="SharePoint.OpenDocuments.5",Cc="SharePoint.OpenDocuments.4",Vc="SharePoint.OpenDocuments.3",rd="SharePoint.OpenDocuments.2",Hd="application/x-sharepoint",te="application/x-sharepoint-webkit",hf="application/x-sharepoint-protocolhandler",ff="application/x-sharepoint-webkit-protocolhandler",lg="application/officelive",Og="npSharePointPlugin",lh="IDBHO.IDBHOCtrl",Ih="OneNote.Notebook",Ah="ofv|",Uh="ofc|",ii="ofe|",ij="u|",Ji="|f|",tk="wdlor",Tj="",kk="",Uj="",ik,Kk,Wk,
Xk,aj,ql,rl,pl,nl,Yk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},qk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},fj={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,
DocumentUrlIsNull:13},Lk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},qj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Yk,OpenDocumentOptions:qk,OpenDocumentFailureType:fj,OpenDocumentControl:Lk,OfficeApplication:qj,EditDocumentInClient:ml,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=qj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},
OfficeVersionInstalled:fa,IsO14MacPluginInstalled:Pa,OfferOfficeInDialog:function(){return oa()&&11>=fa()},OfferOfficeNoIntrusive:function(){return oa()&&15>fa()},OfferMacOffice:function(){return M()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Pa()},InstallRoamingControl:function(){Gc()?window.InstallTrigger.install({Office:{URL:kk}}):Eg(Uj,null,null)},CanUseRoamingControl:function(){var Wf,oh,Zh;if(C())return!0;if(Uc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Gc())return Wf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Wf),oh=document.createEvent("Events"),oh.initEvent("RoamingOfficeInstalled",!0,!1),Wf.dispatchEvent(oh),!!Wf.getAttribute("installed");if(Na())try{return Zh=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Zh.HrExists()}catch(Kh){}return!1},InitUrls:function(Wf,oh,Zh){Tj=Wf;kk=Zh;Uj=oh},LaunchRoamingApps:function(Wf,oh,Zh,Kh,Ei,Si){ja.hfb.Meg(Wf,
oh,ol(Zh),Kh,"x86",Tj,Ei,Si)},LaunchRoamingApps2:function(Wf,oh,Zh,Kh,Ei,Si,Ki,Vj){var xj="",Mk;if(null!=Kh&&(xj+=" "+Kh),null!=Wf&&(xj+=' "'+Wf+'"'),C()||Uc())Wk=Ki,Xk=Vj,Ki='office: "'+(Si+'" "')+(Zh+'" "ROAMING"'),Ki+=' "'+oh+'"',Ki+=' "'+Ei+'"',Ki+=" "+xj,rg(Ki,gl,bl,!1,!1);else if(Gc())Wf=document.createElement("RoamingExtensionElement"),Wf.setAttribute("cabUrl",Si),Wf.setAttribute("app",Zh),Wf.setAttribute("licensingEntitlements",oh),Wf.setAttribute("platform",Ei),Wf.setAttribute("args",xj),
document.documentElement.appendChild(Wf),oh=document.createEvent("Events"),oh.initEvent("RoamingOfficeLaunch",!0,!1),Wf.dispatchEvent(oh),null!=Ki&&Ki(Lk.RoamingFFExtension);else if(Na()){if(Mk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Mk)try{Mk.HrConfigureSingle(Si,Zh,oh,Ei,xj),null!=Ki&&Ki(Lk.RoamingActiveX)}catch(sl){}}else null!=Vj&&Vj(fj.Failed)},ShouldShowDialog:function(){return!Va()},NavigateToUrlUsingClickingOnATag:Dg,OpenDocumentWithProtocolHandler:Jk,OpenDocumentWithProtocolHandlerNoCallBack:function(Wf,
oh,Zh,Kh){var Ei=ll(Wf),Si;return null==Ei?(F(aj.DescriptiveUnattemptedEnums?fj.ProtocolHandlerNoCallbackIsNull:fj.Unattempted,aj.Application),!1):(Si=Rj(Wf,oh,Zh,Kh,Ei),rg(Si,null,null,!1,!1),!0)}}}();ja.ClientUtils=ja.hfb;var Ka=b(817),qc=b(56),mc=b(35),Ed=b(175);zg.prototype.Xc=function(){return!1};zg.prototype.executeCommand=function(J,oa,Va){return 2!==this.Di.ze(Ng.a.newDocument,2,Va)?kb.Task.Ta(!0):Ed.a(oa.command)};zg.prototype.Gc=function(J,oa){return 1056925771===oa.command};zg.prototype.fd=
function(J,oa,Va){J=!0;switch(oa){case "PopulateNewMenu":this.Di&&this.Di.ze(Ng.a.loc,2,Va);break;default:J=!1}return J};Object(Ze.a)(zg,"CreateNewCommandHandler",null,[147]);var pc=Ka.a;vm(Fe,pc);Fe.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb);mc.TaskExtensions.Ba(mc.TaskExtensions.ve([oa,Va],this.ma),function(){J.Ed([new zg(ld.AFrameworkApplication.Eb)])},this.ma,3)};Fe.ja=function(J){Ka.a.de(87,
new Fe(J))};Object(Ze.a)(Fe,"CreateNewCommandHandlerFactory",Ka.a,[]);var K=b(1254),ha=b(878),H=b(308),aa=b(195),ea=b(281),ab=b(4),Vb=b(150),gc=b(96),$c=b(78),Zd=b(73),oe=b(368),Ee=b(163),pf=b(57),Le=b(81),ng=b(317),eg=b(605);Vf.prototype.Mpe=function(){};Vf.prototype.q5c=function(){this.Jog?Qg.a.downloadFile(this._url):Qg.a.sf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};Vf.prototype.dispose=function(){};Object(Ze.a)(Vf,"OpenUrlInTabDialogDownloadBehavior",null,[299,
3]);var eh=b(275),Yg=Xb.StandardDialog;vm(qg,Yg);qg.prototype.AVc=function(){this.Rl&&(this.PUa||(this.PUa=Object(xf.a)(this,this.pyi,"onActionButtonClicked"),this.jy.pa(Je.a.click,this.kB,this.PUa)),this.QUa||(this.QUa=Object(xf.a)(this,this.qyi,"onActionButtonKeyUp"),this.he.pa(Je.a.Vd,this.kB,this.QUa)));Yg.prototype.AVc.call(this)};qg.prototype.pyi=function(J){this.oOe(J);return!0};qg.prototype.qyi=function(J){return this.Jff(J,Object(xf.a)(this,this.oOe,"executeDismissActionButtonFromArgs"))};
qg.prototype.oOe=function(J){this.Rl&&this.Rl.submit();this.Lta(J.Sb)};qg.prototype.Srd=function(){};qg.prototype.CGe=function(){this.Dif();this.Rl?this.Rl.submit():this.pQb.q5c();return!0};qg.prototype.Ohc=function(){return!1};qg.prototype.dispose=function(){this.pQb.dispose();this.Lgb&&(ld.AFrameworkApplication.sa.MW.za(Je.a.click,this.Lgb,Object(xf.a)(this,this.CGe,"downloadLinkClicked")),this.Lgb=null);this.CX&&(ld.AFrameworkApplication.sa.MW.za(Je.a.click,this.CX,Object(xf.a)(this,this.Ohc,"learnMoreLinkClicked")),
this.CX=null);this.jy&&this.PUa&&(this.jy.za(Je.a.click,this.kB,this.PUa),this.PUa=null);this.he&&this.QUa&&(this.he.za(Je.a.Vd,this.kB,this.QUa),this.QUa=null);Yg.prototype.dispose.call(this)};qg.prototype.kIf=function(){this.Rl&&(document.body.appendChild(this.Rl),this.Rl.submit(),document.body.removeChild(this.Rl))};qg.prototype.Ov=function(J){1===J&&(this.Srd(),this.Rl?qg.gy&&this.kIf():this.pQb.q5c());this.dispose()};tl.Object.defineProperties(qg.prototype,{C6e:{configurable:!0,enumerable:!0,
get:function(){return null}},eTd:{configurable:!0,enumerable:!0,get:function(){return null}},iNa:{configurable:!0,enumerable:!0,get:function(){return null}},Izb:{configurable:!0,enumerable:!0,get:function(){return null}},N6a:{configurable:!0,enumerable:!0,get:function(){return null}},Amf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},b3c:{configurable:!0,enumerable:!0,get:function(){return null}},$Tc:{configurable:!0,
enumerable:!0,get:function(){return null}},hme:{configurable:!0,enumerable:!0,get:function(){return null}}});tl.Object.defineProperties(qg,{gy:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.sa.Pa.Lu&&ld.AFrameworkApplication.sa.Pa.Scf}},Uvb:{configurable:!0,enumerable:!0,get:function(){return qg.W4d},set:function(J){qg.W4d=J}}});qg.W4d=!1;Object(Ze.a)(qg,"ADialogWithLinkToResource",Xb.StandardDialog,[]);var th=b(410),rh=b(312),nf=b(14);vm(If,qg);If.prototype.Bif=function(){ud.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};If.prototype.Dif=function(){ud.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};If.prototype.Ohc=function(){th.Redirect.showHelp(rh.a.Lxi);return!0};tl.Object.defineProperties(If.prototype,{iNa:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(410)}},Vhc:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(411)}},
Uhc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},Izb:{configurable:!0,enumerable:!0,get:function(){return"#"}},N6a:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(412)}},Amf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Ze.a)(If,"DownloadACopyAsOdsDialog",qg,[]);Zf.prototype.Mpe=function(J){this.dialog=J};Zf.prototype.q5c=function(){this.gyi.uBf(-1059172980)};Zf.prototype.dispose=function(){this.Ab.cGb(this.Ssf)};Object(Ze.a)(Zf,
"DownloadACopyAsOdsDialogDownloadBehavior",null,[299,3]);Object(Ze.a)(og,"MacroRecorderWorkbookCalculationModeSetPayload",null,[98]);Object(Ze.a)(bg,"MacroRecorderWorkbookRecalculatedPayload",null,[98]);var bh=b(207),xh=b(117),Ag=b(1),bi=b(303);tl.Object.defineProperties(Af,{rNi:{configurable:!0,enumerable:!0,get:function(){return Af.qNi}}});Af.qNi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(Ze.a)(Af,"OpenInAppDialogCopyHtml",null,[]);var Ti=b(369),Qi=bi.a;vm(bf,Qi);bf.prototype.openUrl=function(J,oa){var Va=document.getElementById("link");Va||(Va=document.createElement("a"),Va.id="link",Va.style.visibility="hidden",Va.href="",document.body.appendChild(Va));Va.target=oa;Va.href=J;Va.click()};bf.prototype.Yeg=function(){var J=this;ud.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,21,137,1),function(oa){var Va=
{};Va.OpenInAppUrl=J.DNa;Va.StoreUrl=J.Eq;oa.result.Qj("UI_OpenInMobileApp",Va)},this.$.ma)};bf.prototype.sNi=function(){ud.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};bf.prototype.Kh=function(){this.xf=jf.a.jj(Af.rNi,nf.a.instance.ea(652),nf.a.instance.ea(653),ld.AFrameworkApplication.pC,Ti.getImageClass(ld.AFrameworkApplication.ga.Ua("AppIcon")),nf.a.instance.ea(654));this.Me="OpenInAppDialog";this.kc=5;this.initializeAndShow("",this.sNi.bind(this),null);this.uz(this.uH)};
bf.prototype.$u=function(J){Qi.prototype.$u.call(this,J);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.uH=document.getElementById("LinkToInstall");bh.a.instance.pa(Je.a.click,this.uH,this.TBb);xh.KeyInputManager.instance.pa(Je.a.Vd,this.uH,this.tla)};bf.prototype.dispose=function(){this.uH&&(bh.a.instance.za(Je.a.click,this.uH,this.TBb),xh.KeyInputManager.instance.za(Je.a.Vd,this.uH,this.tla),this.uH=null);Qi.prototype.dispose.call(this)};tl.Object.defineProperties(bf.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(Ze.a)(bf,"OpenInAppDialogCopy",bi.a,[]);var jj=b(26),vh=b(27),Bi=b(352),li=b(8),T=b(273),Oa=b(20),Kb=b(39),ic=b(246),pd=b(458),Td=b(375),Gd=b(48),ge=b(6),Pe=b(133),gf=b(1123),kg=b(79),cg=b(33),Wg=b(358),tg=b(248);pe.prototype.iQ=function(J,oa){J=vh.a.jd(12,1,655,0,0,0,"Blank");J.Description=String.format(nf.a.instance.ea(656),oa);return J};pe.prototype.n9b=function(J){switch(J){case 1:case 2:return 0;default:return 2}};
Object(Ze.a)(pe,"ReloadCloseConfirmation",null,[158]);var Jh=b(145),Fh=b(606),Xg=b(64),hi=aa.a;vm(wd,hi);wd.prototype.Xc=function(){return!1};wd.prototype.executeCommand=function(J,oa,Va,Ub){var e=this,C=this.s5b,M=this.$,ra=oa.command,Na=this.openInExcelOperation,Ib=this.$.Ib,Gc=Va.SourceControlId;M.Mk.Jje(ra);J=null;switch(ra){case 1455037301:this.$.T4?Na.jze():Na.Q0c();break;case -2044628748:case 2004484710:this.$.T4?Na.jze():Na.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===
Gc?(this.gAb("CellLongPress"),ud.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.gAb("PencilIcon"),ud.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Na.K1f();break;case -1059172980:new If(Na.mse(ra),new Zf(Na,M.Ab));break;case -1285148982:this.clientWorkflow.nd.activityState[cg.a.XRc]=
!0;this.Gyc(!1);break;case -75280711:this.Gyc(!1);break;case -455164169:this.Gyc(!0);break;case -1388494670:this.$.da.Za(400,function(Dg){Dg.Oqi();e.Gyc(!1)});break;case 810888577:ld.AFrameworkApplication.qk=(new Date).getTime();ud.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",ld.AFrameworkApplication.qk);break;case -1804063550:case -974518828:oa=0;ab.a.Rzd in Va&&(oa=Va[ab.a.Rzd]);Na.uBf(ra,oa);break;case -1339961039:oa=!1;Va&&ab.a.XGb in
Va&&(oa=Va[ab.a.XGb]);this.reloadWorkbook(!1,oa);break;case -8805455:var id=this.workbookContext;M.isEditMode||(wd.Qwe(M),J=mc.TaskExtensions.Ba(this.FJ.value,function(Dg){Dg=Dg.result;var Eg=Dg.isEnabled();Eg&&eg.a(Dg,wg.a.copyAndEdit,pf.a.Qf.rVe(),e.$.fa.jh.get(2))?ud.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Eg&&ld.AFrameworkApplication.Aag?(Eg={},Eg[K.a.ECd]=ld.AFrameworkApplication.userSessionId,
Eg[ld.AFrameworkApplication.jti]=jj.a.Ra.Kb.getTime().toString(),ud.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Dg.Qj(wg.a.editMode,Eg)):C.CopyAndEditUrl?e.IZg():(e.lc.supportsEditing||id.EditUrl)&&e.reloadWorkbookInEditMode()},this.ma,3));break;case -723527778:M.isEditMode&&(wd.Qwe(M),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Uc=M.qa.ta.Xb(),Vd=
-1355155015===ra?1:0,Ye=function(){return new bg(Vd)};J=oe.a(this.$.userOperationManager,function(Dg,Eg,Ch){return Le.U(M.qa.ta,Vd,null,Dg,Eg,Ch,null,Uc)},function(Dg){return new Ee.a(128,0,Dg,void 0,Ye)},oa);Oa.g(M).Bh.qG(!1);break;case -1158102843:J=Oa.g(M).Bh.recalcSheet(oa);Oa.g(M).Bh.qG(!1);break;case -988468372:if(Ag.EwaSettings.la(305))if(Ub=parseInt(Va[$c.a.hd]),0<=Ub&&3>Ub)this.setCalculationMode(oa,Ub);else return ud.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",
Va[$c.a.hd]),Ed.a(ra);break;case 257398710:Vb.a.ntw(C.ReportAbuseUrl,M);break;case 1800405051:this.Xbj();break;case -48469327:this.saveACopy();break;case 214430355:oa=!1;Va&&ab.a.b6c in Va&&(oa=Va[ab.a.b6c]);if(!this.Kpj(oa,Va))break;ld.AFrameworkApplication.N4?this.businessBar.hg(40,null):this.businessBar.hg(oa?22:23,null);break;case 1389557314:J=mc.TaskExtensions.Ba(this.FJ.value,function(Dg){eg.a(Dg.result,wg.a.luh,null,e.$.fa.jh.get(6))||Vb.a.ntw(C.FileVersionUrl,M)},this.ma,3);break;case 2145659238:this.closeWorkbook();
break;case 1773624819:Gc===Ib+ab.a.Aff?Na.Kji():Na.Jji();break;case 512141517:Gc===Ib+ab.a.zff?Na.Uji():Na.Tji();break;case -1224038235:var Gf=ha.a.On in Va?!Va[ha.a.On]:gc.j(M.fa.workbookContext.Options);Va[ha.a.Description]=Gf?nf.a.instance.ea(561):nf.a.instance.ea(562);J=oe.a(this.$.userOperationManager,function(Dg,Eg,Ch){var kj=e.$.qa.ta,Lj=kj.Oa(9,null);Lj.isReadOnlyRecommended=!Gf;return Le.i(kj,"SetReadOnlyRecommended",Lj,Dg,Eg,Ch,null,0)},function(Dg){return new Ee.a(129,0,Dg)},oa);break;
case 1118926154:if(this.$.isEditMode){var rg=new xb.a;this.$.da.Za(53,function(Dg){Dg?(Dg.Lm.Eji(e.$.Ib+ab.a.Jpd),rg.setResult(!0)):ud.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});J=rg.task}break;case -1698025133:Na.openInBrowser();break;case 520859864:J=mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,393,394,Ub.gja()),function(Dg){Dg.result||ud.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},
this.$.ma,3);break;default:J=Ed.a(ra)}return J||kb.Task.Ta(!0)};wd.prototype.gAb=function(J){if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(li.HelperMethods.DZ){var oa=new Map;oa.set("EntryPoint",J);mg.Health.instance.recordKpiUsage(Td.a.pNi,0,pd.a.Tsi,oa)}else ud.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};wd.prototype.showOpenInAppDialog=function(){ld.AFrameworkApplication.isMobileMode&&
(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(ud.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new bf(this.$)).Kh()):(ud.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),ld.AFrameworkApplication.showOpenInAppDialog()))};wd.prototype.Kpj=function(J,oa){var Va=this;return ld.AFrameworkApplication.isMobileMode&&
!Zd.a(this.$.ya,30)?(this.showOpenInAppDialog(),ud.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.gAb("CellDoubleTap"),ud.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):ld.AFrameworkApplication.Bfc&&(J&&Bi.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?
(ud.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",Bi.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):H.a.any([25,26,30,31,55,32],function(Ub){return Va.businessBar.Y4a(Ub)})?(ud.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),
!1):oa&&ab.a.sVi in oa&&!J?!1:!0};wd.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:J=!0;break;case 520859864:J=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?
!0:!1;break;case -1285148982:case -75280711:case -455164169:J=Ag.EwaSettings.la(108);break;case -1388494670:J=Ag.EwaSettings.la(108);break;case 810888577:J=Ag.EwaSettings.la(272);break;case -1224038235:J=this.$.fa.amIAlone;break;case -988468372:J=Ag.EwaSettings.la(305);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:J=!0,ud.ULS.shipAssertTag(537162642,0,this.$.Yja,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return J};wd.prototype.fd=
function(){return!1};wd.prototype.Xbj=function(){var J=this;if(this.oc){var oa=this.$;Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!1,!0);var Va=J.clientWorkflow.nd.activityState;Va[tg.a.Kq]=ge.a.$ca;Va[Pe.a.$S]=2;Va[cg.a.rs]=oa.isEditMode;Va[Pe.a.dga]=!1}))}};wd.prototype.saveACopy=function(){var J=this;if(this.oc){var oa=this.$;Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!1,!1);var Va=J.clientWorkflow.nd,Ub=Va.activityState;Ub[tg.a.Kq]=ge.a.nRf;Ub[Fh.a.aXb]=J.lc.hasUnsupportedFeaturesForEdit;
Ub[Pe.a.dga]=!1;Va.ft(vh.a.K$(J.businessBar.n6c,[-502303485]))}))}};wd.prototype.Gyc=function(J){var oa=this;Kb.a(this.$).Rs(new ic.a(ge.a.Hma,2,function(){oa.$.KH(!0,!0);var Va=Xg.a(oa.$).nd,Ub=oa.$.isEditMode;Ub=vh.a.jd(1,1,0,0,0,Ub?-315732528:-2087635043,Ub?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ub.ForceVersionUpgrade=J;Va.ft([Ub]);Va=Xg.a(oa.$).nd.activityState;Va[tg.a.Kq]=ge.a.Hma;Va[cg.a.rs]=oa.$.isEditMode;Va[Pe.a.dga]=!1}))};wd.prototype.closeWorkbook=function(){var J=
this;if(this.oc){var oa=this.$;pf.a.Qf.bvc("2145659238")?mc.TaskExtensions.Ba(this.FJ.value,function(Va){Va.result.Qj(wg.a.MPe,{})},this.ma,3):Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!0,!1);var Va=J.clientWorkflow.nd.activityState;Va[Pe.a.WX]=!1;Va[Pe.a.dga]=!1;J.lc.inViewerFromWebPart?(ng.a.rDd(oa,J.clientWorkflow.nd),oa.Mk.ty("InViewerFromWebPart"),Va[tg.a.Kq]=ge.a.e_):(Va[tg.a.Kq]=ge.a.Ck,oa.Fd&32?Va[Pe.a.$S]=0:(Va[Pe.a.$S]=1,Va[Pe.a.QWb]=new gf.a),Va[Jh.a.gie]=!0)}))}};wd.prototype.IZg=
function(){var J=this,oa=this.lc.vbaRemovedDuringConversion;ud.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",oa);var Va=this.$;oa?Kb.a(Va).Rs(new ic.a(ge.a.Qy,5,function(){var Ub=vh.a.jd(3,0,0,1219,0,1069271157,"XLSMacroFailure");J.clientWorkflow.nd.ft([Ub]);J.clientWorkflow.nd.activityState[tg.a.Kq]=ge.a.qdb})):ld.AFrameworkApplication.hideHeader?li.HelperMethods.sf(this.s5b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):
Vb.a.ntw(this.s5b.CopyAndEditUrl,Va)};wd.prototype.reloadWorkbookInEditMode=function(){var J=this;if(this.oc)if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&pf.a.Qf.mV&&pf.a.Qf.eFd(),ld.AFrameworkApplication.Bfc&&!ld.AFrameworkApplication.ska)li.HelperMethods.sf(this.$.Znb(!0),ea.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var oa=this.$,Va=!1,Ub=this.lc.hasUnsupportedFeaturesForEdit,e=this.workbookContext.FileWasRepaired;Bi.d(this.workbookContext.WorkbookFileName)?
(Va=!0,ud.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Ub)):Bi.a(this.workbookContext.WorkbookFileName)&&(Va=!0,ud.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var C=oa.ig.get(59);C=!(oa.fa.lc.supportsEditing&&C);if(Va&&!Ub||C&&(Va||Ub)){var M=C?Ub?-2066104278:816071846:Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&
Zd.a(this.$.ya,25)&&!this.$.uyb?765011943:-213064907;Va=function(){var ra=vh.a.XYa([M]);J.clientWorkflow.nd.ft(ra);J.clientWorkflow.nd.activityState[tg.a.Kq]=ge.a.qdb}}else Va=function(){oa.KH(!0,!1);var ra=J.clientWorkflow.nd,Na=ra.activityState;Na[Pe.a.$S]=1;Na[Wg.a.VWb]=Gi.a.Gjc;Na[cg.a.rs]=!0;Na[Fh.a.aXb]=J.lc.hasUnsupportedFeaturesForEdit;Na[Pe.a.dga]=!!J.workbookContext.EditUrl;Na[kg.a.U1]=J.workbookContext.EditUrl;if(!J.s5b.CopyAndEditUrl){var Ib=[Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&
Zd.a(J.$.ya,25)&&!J.$.uyb?-943219229:1821390342];ra.ft(vh.a.K$(J.businessBar.n6c,Ib))}e&&!Ub?(Bi.b(J.workbookContext.WorkbookFileName)&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(ra=vh.a.XYa([-425642652]),ud.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):ra=vh.a.XYa([108482388]),J.clientWorkflow.nd.ft(ra),Na[tg.a.Kq]=ge.a.CRf):J.$.fa.A4e?(ud.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),
Gd.b().TQd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Na[tg.a.Kq]=ge.a.VDb):Na[tg.a.Kq]=J.$.fa.kfc?ge.a.Mzb:ge.a.qdb};Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,Va))}};wd.prototype.reloadWorkbookInViewMode=function(){var J=this;if(this.oc){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&pf.a.Qf.mV&&pf.a.Qf.eFd();var oa=this.$;Rg.a.Yg&&Oa.g(oa).Kc.textBox.blur();
Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!oa.fa.isNamedObjectViewMode,!1);var Va=J.clientWorkflow.nd.activityState;Va[tg.a.Kq]=ge.a.oha;Va[Pe.a.$S]=1;Va[Pe.a.WX]=!0;Va[cg.a.rs]=!1;Va[cg.a.Klb]=!0;Va[Wg.a.VWb]=Gi.a.Gjc}))}};wd.prototype.reloadWorkbook=function(J,oa){var Va=this;if(this.oc){var Ub=this.$;Ub.gM&65536&&Kb.a(Ub).Rs(new ic.a(ge.a.Qy,5,function(){Ub.KH(J,!0);var e=Va.clientWorkflow.nd.activityState;e[tg.a.Kq]=ge.a.Dk;e[cg.a.$Rc]=Va.workbookContext.NovMode;oa||(e[Pe.a.$S]=1,e[Pe.a.QWb]=
new pe)}))}};wd.prototype.setCalculationMode=function(J,oa){function Va(){return new og(oa)}var Ub=this;ud.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",oa);var e=this.$.fa.workbookContext.CalcMode;this.$.fa.workbookContext.CalcMode=oa;return oe.a(this.$.userOperationManager,function(C,M,ra){var Na=Ub.$.qa.ta;C=T.b(C,wd.cKi(Ub.$,e));M=T.a(M,wd.bKi(Ub.$,e));var Ib=Na.Oa(9,null);Ib.calc_type=oa;return Le.i(Na,"SetCalculationOptions",Ib,C,M,ra,null,0)},function(C){return new Ee.a(197,
0,C,void 0,Va)},J)};wd.Qwe=function(J){J.Ab&&0<J.Ab.dR&&J.Ab.I8c(function(oa){oa.ou()})};wd.cKi=function(J,oa){return function(Va){vh.a.ih(Va.Errors)&&(J.fa.workbookContext.CalcMode=oa,ud.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",oa,vh.a.Uc(Va.Errors)))}};wd.bKi=function(J,oa){return function(){J.fa.workbookContext.CalcMode=oa;ud.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",
oa)}};tl.Object.defineProperties(wd.prototype,{oc:{configurable:!0,enumerable:!0,get:function(){return this.$.fa.oc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},s5b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return Xg.a(this.$)}},lc:{configurable:!0,enumerable:!0,get:function(){return this.$.lc}}});Object(Ze.a)(wd,"FileOperationsCommandHandler",
aa.a,[147]);var Ci=b(147),Di=Ka.a;vm(yd,Di);yd.prototype.Md=function(){var J=this,oa=this.$,Va=[],Ub=qc.GetServiceTaskFactory.create(oa.da,56,this.ma,this.tb);Va.push(Ub);var e=qc.GetServiceTaskFactory.Xa(oa.da,5,4,this.tb);Va.push(e);mc.TaskExtensions.Ba(kb.Task.WAA.apply(null,Va),function(){Ci.b(Ub)&&J.Ed([new wd(oa,Ub.result,new hg.a(function(){return qc.GetServiceTaskFactory.create(oa.da,137,J.ma,J.tb)}),e.result)])},this.ma,0)};yd.ja=function(J){Ka.a.de(94,new yd(J))};Object(Ze.a)(yd,"FileOperationsCommandHandlerFactory",
Ka.a,[]);var nh=b(43),Sd;(function(J){J[J.url=0]="url";J[J.ref=1]="ref";J[J.mailto=2]="mailto"})(Sd||(Sd={}));Object(Ze.b)("HyperlinkSelectionState",Sd);var Cj=b(900),Pf=b(9),X=b(603),ta=b(82),tb=Cj.a;vm(ad,tb);ad.prototype.PXe=function(J,oa){switch(oa){case 2:return J.startsWith("mailto:")?J:"mailto:"+J;case 1:return String.format("{0}{1}",Pf.a.pEf,this.JLh(J));default:return J}};ad.prototype.Uw=function(){var J=this,oa=this.$;this.location=this.PXe(this.Avd,this.zvd);try{this.location=ta.a.ym(this.location)}catch(e){ud.ULS.sendTraceTag(537157643,
0,15,"Decoding link text failed")}ud.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Sd[this.zvd]);this.cellValue=this.yvd.length?this.yvd:this.Avd;oa.Xu();var Va=oa.qa.ta.Xb(),Ub=nh.s(this.selectedRange);return function(e,C,M){return Le.c(oa.qa.ta,Ub,J.cellValue,J.location,J.removeHyperLink,!1,123,e,C,M,J.yL.range,Va)}};ad.prototype.Wl=function(){var J=this,oa=nh.s(this.selectedRange);return function(){return new X.a(oa,J.cellValue,J.location)}};ad.prototype.Ssh=function(){var J=this.yL.cell.e4a;
this.yL.cell.uvb?J&&J.startsWith("mailto:")?(this.Glb=2,J=J.substr(7)):this.Glb=0:this.Glb=1;return J};ad.prototype.QKa=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.vxb=this.yL.vaa:this.vxb=!!this.yL.GJa(64)||!!this.yL.GJa(128)};ad.prototype.lm=function(){if(this.vxb){this.r0a=this.yL.text;var J=this.Ssh();J&&(this.NRc=J);this.Wn=nf.a.instance.ea(807);this.Kpb=this.NRc===this.r0a}else this.yL.text?(this.r0a=this.yL.text,this.Kpb=!1):(this.r0a="",this.Kpb=!0),
this.Glb=0,this.Wn=nf.a.instance.ea(806);this.yL.MJ&&(this.Kpb=!1,this.jFe=!0,Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.r0a=this.yL.formulaBarText))};ad.prototype.rui=function(J){return this.fa.xb.tj(J)};ad.prototype.lWe=function(J,oa){return J?null:nf.a.instance.ea(oa)};ad.prototype.JLh=function(J){var oa=nh.Z(J,this.fa.xa);var Va=oa.sheetName;var Ub=oa.range;oa.returnValue&&Ub&&(J=nh.x(Ub,Va||this.sheetName,!1));return J};tl.Object.defineProperties(ad.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Cw:{configurable:!0,enumerable:!0,get:function(){return 526}}});ad.qNj="validateLinkValues";ad.jKg="bodyProps";ad.Dah="disableDisplayText";ad.tbh="displayTextValue";ad.evg="activeLinkOption";ad.fvg="activeLinkValue";ad.PZg="copyLinkValueToDisplay";ad.Hki="linkValue";ad.rej="selectedLink";ad.sbh="displayText";Object(Ze.a)(ad,"HyperlinkDialog",Cj.a,[]);kc.prototype.Xc=function(){return!1};kc.prototype.Gc=function(J,oa){return 1===
J&&-1583422759===oa.command};kc.prototype.fd=function(){return!1};kc.prototype.executeCommand=function(){this.Bsj();return kb.Task.Ta(!0)};kc.prototype.Bsj=function(){var J=nh.v(this.gridView.ha.va.Qd,this.$),oa=Oa.e(this.gridView);(!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.xs([this.gridView.ha.va.Qd],!0))&&oa&&new ad(this.$,J,oa)};Object(Ze.a)(kc,"ShowHyperlinkCommandHandler",null,[147]);var Rb=Ka.a;vm(ve,Rb);ve.prototype.Md=
function(){this.Ed([new kc(this.$,Oa.g(this.$))])};ve.ja=function(J){Ka.a.de(105,new ve(J))};Object(Ze.a)(ve,"ShowHyperlinkCommandHandlerFactory",Ka.a,[]);var Fc=b(19),lc=b(1143);fe.create="Create";fe.activate="Activate";fe.close="Close";fe.remove="Delete";fe.duplicate="Duplicate";Object(Ze.a)(fe,"Actions",null,[]);var Jd=kb.Task;vm(Wc,Jd);Wc.prototype.fL=function(){this.mYd=vh.a.jd(3,2,0,1615,0,-1244327602,"MsFormDeleteConfirmation");this.ej=Kb.a(this.wf.$).ri(this.mYd).G();this.ej.isCompleted||
(this._state=2,this.ej.cN(this.moveNext));return this.zBc};Wc.prototype.zBc=function(){this.oYd=this.ej.Sy();this.oYd||(this.wf.$.workbookContext.Options=li.HelperMethods.QN(!1,this.wf.$.workbookContext.Options,2048),this.wf.deleteMsFormMetaDataSheet());this._state=3;this.DQa(!0)};Wc.prototype.dispose=function(){};Object(Ze.a)(Wc,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",kb.Task,[3]);Rc.action="Action";Rc.Cwh="FlexPane";Rc.M8b="formId";Rc.id="id";Rc.title=
"Title";Rc.vNb="XlWorkbookId";Rc.Cyh="Fragment";Rc.host="Host";Rc.vDj="TopView";Rc.P1="auth_pvr";Object(Ze.a)(Rc,"Parameters",null,[]);nc.prototype.Xc=function(J,oa){switch(oa){case -105284469:return!gc.i(this.$.kg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};nc.prototype.executeCommand=function(J,oa){J=mc.TaskExtensions.om();oa=oa.command;switch(oa){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();
break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:J=this.deleteMsForm();break;default:J=Ed.a(oa)}return J};nc.prototype.Gc=function(J,oa){if(!this.$.fa.jh.get(61))return!1;J=!1;switch(oa.command){case -105284469:J=gc.i(this.$.kg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:J=this.hasMsForm}return J};nc.prototype.fd=function(){return!1};nc.prototype.insertMsForm=function(){var J=Fg.a.Vq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),
oa={},Va={};oa[Rc.action]=fe.create;oa[Rc.P1]=this.P1;Va[Rc.action]=fe.create;Va[Rc.vNb]=encodeURIComponent(this.rNb);Va[Rc.host]=this.Yn;Va[Rc.title]=encodeURIComponent(J);this.zAb(oa,Va);this.$.workbookContext.Options=li.HelperMethods.QN(!1,this.$.workbookContext.Options,2048)};nc.prototype.editMsForm=function(){var J={},oa={};J[Rc.P1]=this.P1;oa[Rc.M8b]=this.Tjc;oa[Rc.vNb]=encodeURIComponent(this.rNb);oa[Rc.host]=this.Yn;this.zAb(J,oa)};nc.prototype.previewMsForm=function(){var J={},oa={};J[Rc.P1]=
this.P1;oa[Rc.M8b]=this.Tjc;oa[Rc.vNb]=encodeURIComponent(this.rNb);oa[Rc.host]=this.Yn;oa[Rc.vDj]="Preview";this.zAb(J,oa)};nc.prototype.sendMsForm=function(){var J={},oa={};J[Rc.P1]=this.P1;oa[Rc.M8b]=this.Tjc;oa[Rc.Cwh]="SendForm";oa[Rc.vNb]=encodeURIComponent(this.rNb);oa[Rc.host]=this.Yn;this.zAb(J,oa)};nc.prototype.deleteMsForm=function(){return new Wc(this)};nc.prototype.deleteMsFormMetaDataSheet=function(){var J=this;this.$.userOperationManager.tt(new Ee.a(158,0,function(oa,Va,Ub){return Nc(J.$.qa.gw,
J.xU.Vsb,T.b(oa,function(){J.A9g()}),Va,Ub,null)}))};nc.prototype.A9g=function(){var J={},oa={};J[Rc.action]=fe.remove;J[Rc.P1]=this.P1;oa[Rc.action]=fe.remove;oa[Rc.host]=this.Yn;oa[Rc.M8b]=encodeURIComponent(this.Tjc);oa[Rc.vNb]=encodeURIComponent(this.rNb);this.zAb(J,oa)};nc.prototype.zAb=function(J,oa){var Va=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Ub="",e="";if(oa){for(var C in oa){var M=C,ra=oa[C];e+=e.length?"&":"";e+=M+"="+ra}J||(J={});J[Rc.Cyh]=encodeURIComponent(e)}if(J)for(var Na in J)oa=
Na,e=J[Na],Ub+=Ub.length?"&":"?",Ub+=oa+"="+e;window.open(Va+Ub,"_blank")};tl.Object.defineProperties(nc.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return gc.c(this.$.kg)}},Tjc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},rNb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},P1:{configurable:!0,enumerable:!0,get:function(){return Fc.a.contains(this.$.ku.DocumentHostInfo.FileSource,"onedrive",
!0)?"MSA":"OrgId"}}});Object(Ze.a)(nc,"MsFormCommandHandler",null,[147]);var he=Ka.a;vm(cb,he);cb.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.tb);mc.TaskExtensions.Ba(mc.TaskExtensions.ve([oa],this.ma),function(){J.Ed([new nc(J.$)])},this.ma,3)};cb.ja=function(J){J.fa.jh.get(61)&&Ka.a.de(215,new cb(J))};Object(Ze.a)(cb,"MsFormCommandHandlerFactory",Ka.a,[]);var Te=sd.a;vm(ye,Te);ye.prototype.create=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,
164,this.ma,this.tb),function(){J.Fb(new Id)},this.ma,3)};Object(Ze.a)(ye,"NewAndOpenUXFactory",sd.a,[]);Bc.prototype.executeCommand=function(J,oa,Va){J=2;switch(oa.command){case Ng.a.openUrlInNewTab:J=this.Di.ze(Ng.a.openUrlInNewTab,2,Va);break;case Ng.a.jOa:J=this.Di.ze(Ng.a.jOa,2,Va)}return 2!==J?kb.Task.Ta(!0):Ed.a(oa.command)};Bc.prototype.Gc=function(J,oa){return oa.command===Ng.a.openUrlInNewTab||oa.command===Ng.a.jOa};Bc.prototype.fd=function(J,oa,Va){return"PopulateMruMenu"===oa?(this.Di.ze(Ng.a.koc,
2,Va),!0):!1};Bc.prototype.Xc=function(){return!1};Object(Ze.a)(Bc,"OpenFromMruCommandHandler",null,[147]);var yg=Ka.a;vm(Jc,yg);Jc.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb);mc.TaskExtensions.Ba(mc.TaskExtensions.ve([oa,Va],this.ma),function(){J.Ed([new Bc(J.$,ld.AFrameworkApplication.Eb)])},this.ma,3)};Jc.ja=function(J){Ka.a.de(88,new Jc(J))};Object(Ze.a)(Jc,"OpenFromMruCommandHandlerFactory",
Ka.a,[]);var Kg=b(88),Ug=b(84),ae=b(242),Re=b(667),Ri=b(1087),yj=ae.a;vm(re,yj);re.prototype.execute=function(J){var oa=Object(Ug.a)(6,J.Ge);if(!oa.Yja)return ud.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.wkd(J),this.ph(ge.a.idle),1;this.oAb||(this.oAb=new Ri.DownloadACopyOperation(this.Nic,oa));this.oAb.Ych();ud.ULS.shipAssertTag(537154817,0,3!==Xg.a(oa).ui.ut,"The current activity should not be closed.");return 1};
re.prototype.wkd=function(J){var oa=Object(Ug.a)(6,J.Ge),Va=new Re.a(oa);this.subscribe(J,this.azd,function(Ub){Va.add_disposing(Ub)});ud.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Va.initialize();Va.nf()};re.prototype.dispose=function(){Kg.a.Fa(this.oAb);this.oAb=null;yj.prototype.dispose.call(this)};Object(Ze.a)(re,"DownloadAForkedCopyActivity",ae.a,[]);var fg=sd.a;vm(xd,fg);xd.prototype.create=function(){var J=this;
mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new re(ge.a.x0a,ge.a.Ck,!0))},this.ma)};Object(Ze.a)(xd,"DownloadACopyPreDatalossActivityFactory",sd.a,[]);var Dj=sd.a;vm(gd,Dj);gd.prototype.create=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new re(ge.a.unmergeableDownloadCopy,ge.a.Rna))},this.ma)};Object(Ze.a)(gd,"DownloadAForkedCopyActivityFactory",sd.a,[]);hc.prototype.Mg=
function(){this.La.$b(Ng.a.tryMacOffice,ph.a.frame,Object(xf.a)(this,this.WLi,"onTryMacOffice"));this.La.$b(Ng.a.z7f,ph.a.frame,Object(xf.a)(this,this.NAf,"onTryMacOfficeFromViewer"));this.La.$b(Ng.a.y7f,ph.a.frame,Object(xf.a)(this,this.NAf,"onTryMacOfficeFromViewer"))};hc.prototype.WLi=function(J,oa,Va,Ub,e){if(1===Va)return 32;e?(J=e.SourceControlId,"btnjTryMacOfficeForWordEditor"===J?Qg.a.sf(ub.a.iZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===J&&
Qg.a.sf(ub.a.iZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Zgf();return 32};hc.prototype.NAf=function(J,oa,Va){if(1===Va)return 32;switch(J){case Ng.a.z7f:Qg.a.sf(ub.a.iZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Ng.a.y7f:Qg.a.sf(ub.a.iZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};hc.prototype.Zgf=function(){var J=void 0===J?null:J;var oa=0;J&&(oa=J);Qg.a.sf(2===oa?"https://go.microsoft.com/fwlink/?LinkId=331579":hc.Opi,
"_blank",void 0,"LaunchMacTrialWindow")};tl.Object.defineProperties(hc.prototype,{nvc:{configurable:!0,enumerable:!0,get:function(){return this.ymg&&Rg.a.isMac&&!Rg.a.wdi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Bpj:{configurable:!0,enumerable:!0,get:function(){return this.nvc}}});tl.Object.defineProperties(hc,{Opi:{configurable:!0,enumerable:!0,get:function(){return ub.a.NG("522401")}}});Object(Ze.a)(hc,"MacOfficeOffer",null,[705]);le.prototype.Mg=function(){this.La.$b(Ng.a.tryOffice,ph.a.frame,
Object(xf.a)(this,this.XLi,"onTryOffice"));this.La.$b(Ng.a.tryOfficeThroughTellMe,ph.a.frame,Object(xf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.$b(Ng.a.C7f,ph.a.frame,Object(xf.a)(this,this.D7f,"tryOfficeThroughViewer"));this.La.$b(Ng.a.B7f,ph.a.frame,Object(xf.a)(this,this.D7f,"tryOfficeThroughViewer"))};le.prototype.XLi=function(J,oa,Va,Ub,e){if(this.UVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.pJb?32:8;2===Va&&(e?(J=e.SourceControlId,"btnjTryOfficeForWordEditor"===
J?Qg.a.sf(ub.a.iZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===J?Qg.a.sf(ub.a.iZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Mhc()):this.Mhc());return 32};le.prototype.tryOfficeThroughTellMe=function(J,oa,Va,Ub,e){if(this.UVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.pJb?32:8;2===Va&&(e?(J=e.SourceControlId,Qg.a.sf(ub.a.NG("862405")+this.XNh(J),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Qg.a.sf(ub.a.NG("522402"),
"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};le.prototype.D7f=function(J,oa,Va){if(this.UVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.pJb?32:8;if(2===Va)switch(J){case Ng.a.C7f:Qg.a.sf(ub.a.iZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Ng.a.B7f:Qg.a.sf(ub.a.iZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};le.prototype.Mhc=function(J){J=void 0===J?null:J;var oa=0;J&&(oa=J);Qg.a.sf(le.KLh(oa),"_blank",void 0,"LaunchOfficeOffer")};le.prototype.XNh=
function(J){var oa=0;switch(J){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":oa=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":oa=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":oa=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":oa=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":oa=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":oa=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":oa=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":oa=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":oa=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":oa=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":oa=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":oa=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":oa=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":oa=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":oa=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":oa=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":oa=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":oa=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":oa=29}return oa?String.format("&pc={0:D}",oa):""};le.KLh=function(J){if(Rg.a.Yg)switch(J){case 1:return ub.a.NG("393806");case 2:return ub.a.NG("393810");case 3:return ub.a.NG("393809");case 5:return ub.a.NG("393805")}else if(Rg.a.Ip)switch(J){case 1:return ub.a.NG("521979");case 3:return ub.a.NG("521980");case 5:return ub.a.NG("521978");
case 2:return ub.a.NG("522490")}else{if(2===J)return ub.a.NG("517778");if(1===J)return ub.a.iZ(30)}return ub.a.NG("522402")};tl.Object.defineProperties(le.prototype,{Ipf:{configurable:!0,enumerable:!0,get:function(){return this.pJb}},Nxi:{configurable:!0,enumerable:!0,get:function(){return this.pJb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},pJb:{configurable:!0,enumerable:!0,get:function(){return this.Bmg&&!Rg.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var J=!1;
this.eDc&&(J=this.eDc.isFreemiumUpsellEnabled());return J}}});Object(Ze.a)(le,"OfficeTrialExperience",null,[702]);Be.prototype.di=function(J){J.register(le,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").zc().Ic(function(){return new le(ld.AFrameworkApplication.Eb,ld.AFrameworkApplication.ayb,ld.AFrameworkApplication.lcid)});J.register(hc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").zc().Ic(function(){return new hc(ld.AFrameworkApplication.Eb,
ld.AFrameworkApplication.qfc,ld.AFrameworkApplication.lcid)})};Object(Ze.a)(Be,"OpenInClientConfiguration",null,[5]);var tj=b(1341),Bh=b(36),uh=b(1238),Ph=b(276);tl.Object.defineProperties(Sc,{xf:{configurable:!0,enumerable:!0,get:function(){return jf.a.jj(Sc.Tj,CommonUIStrings.l_OICLaunchDialogTitle)}}});Sc.Tj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Ze.a)(Sc,"OICLaunchDialogHtml",null,[]);var ah=jf.a;vm(sc,ah);sc.prototype.q8a=function(){this.$Ba=ie("BtnRichClient",this.Yp.arb,this.Yp.pwb,this.Yp.Vid,CommonUIStrings.l_OICLaunchRichClient,Object(xf.a)(this,this.xyf,"onRichClientButtonClick"),ue);document.getElementById("OICLaunchRichClient").appendChild(this.$Ba);Ce(this.$Ba);this.VTa=ie("BtnReturn",this.Yp.arb,this.Yp.pwb,this.Yp.V6e,CommonUIStrings.l_OICReturnToOnlineClient,Object(xf.a)(this,this.uyf,"onReturnButtonClick"),ue);document.getElementById("OICReturnToApp").appendChild(this.VTa);
Ce(this.VTa)};sc.prototype.uyf=function(){this.hide();this.Yp.Eab();return!0};sc.prototype.xyf=function(){ud.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();ld.AFrameworkApplication.Eb.processAction(Ng.a.TPa,2);return!0};sc.prototype.fyi=function(){this.Yp.Eab()};sc.prototype.dispose=function(){this.$oa||(this.$Ba&&(Ph.a.instance.za(Je.a.click,this.$Ba,Object(xf.a)(this,this.xyf,"onRichClientButtonClick")),xh.KeyInputManager.instance.za(Je.a.Vd,this.$Ba,ue)),this.VTa&&
(Ph.a.instance.za(Je.a.click,this.VTa,Object(xf.a)(this,this.uyf,"onReturnButtonClick")),xh.KeyInputManager.instance.za(Je.a.Vd,this.VTa,ue)),ah.prototype.dispose.call(this),this.$oa=!0)};Object(Ze.a)(sc,"OICLaunchDialog",jf.a,[]);tl.Object.defineProperties(xg,{xf:{configurable:!0,enumerable:!0,get:function(){return jf.a.jj(xg.Tj,CommonUIStrings.l_OICDialogTitle)}}});xg.Tj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Ze.a)(xg,"ProtocolLaunchingDialogV2Html",null,[]);var zj=jf.a;vm(sf,zj);sf.prototype.q8a=function(){var J=document.getElementById("Issues");if(J){Qc("",this.Yp.arb,this.Yp.pwb,this.Yp.Vid,J);var oa=document.createElement("span");oa.className="WACDialogSectionTitle";oa.innerText=5===this.Yp.yBf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;J.appendChild(oa);Ce(J);J.style.display="none"}ld.AFrameworkApplication.sa.Pa.$fd?(this.UTa=ie("GiveFeedback",this.Yp.arb,
this.Yp.pwb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(xf.a)(this,this.zlc,"onGiveFeedbackClick"),Object(xf.a)(this,this.Huf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.UTa),Ce(this.UTa)):document.getElementById("ButtonGiveFeedback").style.display="none";ld.AFrameworkApplication.sa.Pa.editMode&&!ld.AFrameworkApplication.Eah?(this.wea=ie("Edit",this.Yp.arb,this.Yp.pwb,"",2===ld.AFrameworkApplication.sa.Pa.Lj?4===ld.AFrameworkApplication.sa.Pa.editMode?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===ld.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(xf.a)(this,this.itf,"onEditClick"),Object(xf.a)(this,this.ntf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.wea),Ce(this.wea)):document.getElementById("ButtonEdit").style.display="none";ld.AFrameworkApplication.sa.Pa.editMode||ld.AFrameworkApplication.ayb||
!J||(J.style.display="none")};sf.prototype.FRe=function(){return this.Goa?(this.uz(this.Goa),!0):!1};sf.prototype.DRe=function(){return this.wea?(this.uz(this.wea),!0):!1};sf.prototype.ntf=function(J){return this.ixd(J,0)};sf.prototype.Huf=function(J){return this.ixd(J,2)};sf.prototype.syf=function(J){return this.ixd(J,1)};sf.prototype.ixd=function(J,oa){var Va=!1;if(J.Ea.keyCode===Cf.a.$h||J.Ea.keyCode===Cf.a.iBa)J.Sb.click(),Va=!0;else if(J.Ea.keyCode===Sys.UI.Key.down||J.Ea.keyCode===Sys.UI.Key.up)switch(oa){case 1:Va=
this.DRe();break;case 0:Va=this.FRe()}return Va};sf.prototype.itf=function(){this.hide();4===ld.AFrameworkApplication.sa.Pa.editMode?(ud.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Yp.Eab()):(ud.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Yp.xgd());return!0};sf.prototype.zlc=function(){ud.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Yp.Z2e();return!0};sf.prototype.wmc=function(){ud.ULS.sendTraceTag(19239263,211,50,
"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";ld.AFrameworkApplication.Eb.processAction(Ng.a.TPa,2);return!0};sf.prototype.nDd=function(){this.Yp.Eab()};sf.prototype.switchToBackupMode=function(){var J=document.getElementById("ProtocolLaunchingDialogTitle");if(J){J.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(J=document.getElementById("Issues"))J.style.display="block";(J=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!J.children.length&&(this.Goa=
ie("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(xf.a)(this,this.wmc,"onRetryOICClick"),Object(xf.a)(this,this.syf,"onRetryOICKeyUp")),J.appendChild(this.Goa),Ce(this.Goa),this.wea||this.FRe())}};sf.prototype.dispose=function(){this.$oa||(this.wea&&(Ph.a.instance.za(Je.a.click,this.wea,Object(xf.a)(this,this.itf,"onEditClick")),xh.KeyInputManager.instance.za(Je.a.Vd,this.wea,Object(xf.a)(this,this.ntf,"onEditKeyUp"))),this.UTa&&(Ph.a.instance.za(Je.a.click,this.UTa,Object(xf.a)(this,
this.zlc,"onGiveFeedbackClick")),xh.KeyInputManager.instance.za(Je.a.Vd,this.UTa,Object(xf.a)(this,this.Huf,"onGiveFeedbackKeyUp"))),this.Goa&&(Ph.a.instance.za(Je.a.click,this.Goa,Object(xf.a)(this,this.wmc,"onRetryOICClick")),xh.KeyInputManager.instance.za(Je.a.Vd,this.Goa,Object(xf.a)(this,this.syf,"onRetryOICKeyUp"))),zj.prototype.dispose.call(this),this.$oa=!0)};Object(Ze.a)(sf,"ProtocolLaunchingDialog",jf.a,[]);var Rf=b(426),ti=Xb.StandardDialog;vm(uf,ti);uf.prototype.zlc=function(J){ud.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.Dtf(J)};uf.prototype.wmc=function(){ud.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");ld.AFrameworkApplication.Eb.processAction(Ng.a.TPa,2)};uf.prototype.nDd=function(J){uf.Z3e?3===J?this.ZPf():2!==J&&J?1===J&&this.OUg():this.continueEditing():2===J?this.ZPf():1!==J&&J||this.continueEditing()};uf.prototype.OUg=function(){ud.ULS.sendTraceTag(577783557,211,50,"Closing the document");ld.AFrameworkApplication.Eb.ze(Ng.a.close,2,Rf.a)};uf.prototype.ZPf=function(){ud.ULS.sendTraceTag(593602691,
211,50,"OIC dialog retry");window.setTimeout(Object(xf.a)(this,this.wmc,"onRetryOICClick"),0)};uf.prototype.continueEditing=function(){4===ld.AFrameworkApplication.sa.Pa.editMode||ld.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===ld.AFrameworkApplication.sa.mode?(ud.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Yp.Eab()):(ud.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Yp.xgd())};tl.Object.defineProperties(uf,
{Z3e:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===ld.AFrameworkApplication.Eb.processAction(Ng.a.close,1)}}});Object(Ze.a)(uf,"StandardProtocolLaunchingDialog",Xb.StandardDialog,[]);Object(Ze.a)(Bg,"EditDocumentInClientParams",null,[]);ag.e6c=function(J,oa,Va,Ub,e,C,M,ra,Na,Ib,Gc,id,Uc,Vd,Ye,Gf){M=void 0===M?!1:M;ra=void 0===ra?!1:ra;Na=void 0===Na?"":Na;Ib=void 0===Ib?!1:Ib;Gc=void 0===Gc?!1:Gc;id=void 0===id?!1:id;Uc=void 0===
Uc?"":Uc;Vd=void 0===Vd?"":Vd;Ye=void 0===Ye?"":Ye;Gf=void 0===Gf?!1:Gf;var rg=new Bg;rg.DocumentUrl=J;rg.Mode=oa;rg.Options=Va;rg.Application=Ub;rg.SilentExternalHandler=M;rg.EncodeUrl=ra;rg.CorrelationIdForWinClient=Na;rg.NavigateUsingWindowOpen=Ib;rg.DescriptiveUnattemptedEnums=Gc;rg.NoBrowserModalDialogs=id;rg.SessionOrigin=Uc;rg.CorrelationId=Vd;rg.ClickTime=Ye;rg.NewTelemetryDataIsEnabled=Gf;MSOJS.ClientUtils.EditDocumentInClient(rg,e,C)};Object(Ze.a)(ag,"ClientUtils",null,[]);var Zj=b(176),
uj=b(962),lj=b(75);Hf.prototype.gaj=function(J,oa,Va){return oa.contextId!==ph.a.frame?2:1===Va?32:this.TPa()};Hf.prototype.pzj=function(){return!(2===this.application&&ld.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};Hf.prototype.closeApplication=function(){this.NRd||this.Nrh()};Hf.prototype.Eab=function(){this.szj||this.ash()};Hf.prototype.RIf=function(J){this.kMj&&Rg.a.Yg?new sc(this):this.F1b(J)};Hf.prototype.F1b=function(J){J=this.nji(J);var oa=J.returnValue;ud.ULS.sendTraceTag(34198736,
211,50,"OICLaunchClient,{0},{1}",32===oa,J.MAa);return oa};Hf.prototype.NFa=function(J,oa,Va,Ub,e,C){this.aUa=J;this.G2d=oa;this.rfa=C;this.application=Va;this.qB=Ub;ld.AFrameworkApplication.downloadCopyOnOpenInClient?this.Wgf():ld.AFrameworkApplication.limitedEdit&&!ld.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?ld.AFrameworkApplication.i0f():this.lJg(e)};Hf.prototype.TPa=function(){return this.F1b(this.phb)};Hf.prototype.FTf=function(){var J=new uj.a(wg.a.openInClient);J.Values["ui-language"]=
ld.AFrameworkApplication.lcid.toString();J.Values[K.a.p3c]=ld.AFrameworkApplication.userSessionId;return this.rfa.value.send(J)?32:8};Hf.prototype.Lfj=function(J){var oa=new uj.a(wg.a.AOj);oa.Values["ui-language"]=ld.AFrameworkApplication.lcid.toString();oa.Values[K.a.p3c]=ld.AFrameworkApplication.userSessionId;oa.Values[ch.a.zOj]=J;this.rfa.value.send(oa)};Hf.prototype.nji=function(J){this.phb=J;this.Lfj(5===this.qB?Hf.wNi:Hf.yNi);return 5===this.qB?this.mji():this.rji()};Hf.prototype.mji=function(){this.bhf();
return{returnValue:32,MAa:"HostEditUrl,"}};Hf.prototype.rji=function(){var J,oa=J="";ld.AFrameworkApplication.Tje&&(oa="|f|"+ld.AFrameworkApplication.userSessionId);var Va=ld.AFrameworkApplication.ga.ra("IsAssignmentMode")&&ld.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||ld.AFrameworkApplication.isUnifiedHostMode||Rg.a.qka,Ub=ld.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),e=ld.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(ld.AFrameworkApplication.vEf){J+=
"NewOrder,";var C=8;this.rfa&&this.rfa.value&&this.rfa.value.isEnabled()&&ld.AFrameworkApplication.oWd&&(J+="Post,",C=this.FTf());if(32===C)return{returnValue:C,MAa:J};ud.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return ld.AFrameworkApplication.Zl.Z8a?(ud.ULS.shipAssertTag(5566816,211,!!ld.AFrameworkApplication.Zl.Z8a),J+="HostUrl,",{returnValue:ld.AFrameworkApplication.sa.E7a(ld.AFrameworkApplication.Zl.Z8a),MAa:J}):this.aUa?(ud.ULS.sendTraceTag(18715405,
211,15,"Try to open doc in rich client, SessionId {0}",ld.AFrameworkApplication.userSessionId),J+="DocUrl,",ag.e6c(this.aUa,this.qB,this.options,this.application,Object(xf.a)(this,this.mtf,"onEditInClientSuccess"),Object(xf.a)(this,this.ltf,"onEditInClientFailure"),this.M0f,ld.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Va,Ub,e,this.LUb,this.nD,this.sPb,ld.AFrameworkApplication.Eb.kkc),{returnValue:32,MAa:J}):{returnValue:8,MAa:J}}J+="OldOrder,";if(!this.aUa&&ld.AFrameworkApplication.Zl.Z8a)return this.rfa&&
this.rfa.value&&this.rfa.value.isEnabled()&&ld.AFrameworkApplication.oWd?(J+="Post,",oa=this.FTf()):(ud.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),oa=8),32!==oa?(ud.ULS.shipAssertTag(22595484,211,!!ld.AFrameworkApplication.Zl.Z8a),J+="HostUrl,",{returnValue:ld.AFrameworkApplication.sa.E7a(ld.AFrameworkApplication.Zl.Z8a),MAa:J}):{returnValue:oa,MAa:J};ud.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",ld.AFrameworkApplication.userSessionId);
J+="DocUrl,";ag.e6c(this.aUa,this.qB,this.options,this.application,Object(xf.a)(this,this.mtf,"onEditInClientSuccess"),Object(xf.a)(this,this.ltf,"onEditInClientFailure"),this.M0f,ld.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Va,Ub,e,this.LUb,this.nD,this.sPb,ld.AFrameworkApplication.Eb.kkc);return{returnValue:32,MAa:J}};Hf.prototype.aOf=function(J){ld.AFrameworkApplication.Pm.setDw(8981,J)};Hf.prototype.mtf=function(J){this.aOf(J);ud.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");
6===J&&MSOJS.ClientUtils.ShouldShowDialog()?(this.K3f||this.bhf(),this.Dni()):this.NRd||this.closeApplication()};Hf.prototype.ltf=function(J,oa){oa=void 0===oa?0:oa;ud.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",J,oa);if(5===J)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Va=!!this.G2d&&!this.phb,Ub=0;1===J&&(Ub=2);6<=J&&13>=J&&(Ub=1,1===oa&&(this.NRd=!0));this.Xxc.Nxi?(ud.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
Ub),uh.a.instance.x3g(this.phb?Object(xf.a)(this,this.$pf,"oicErrorDialogHandlerCloseForced"):Object(xf.a)(this,this.aqf,"oicErrorDialogHandlerNoCloseForced"),Va?Object(xf.a)(this,this.Jvf,"onLaunchDownload"):null,this.cFe(!1)?Object(xf.a)(this,this.a1h,"iHaveOfficeButtonHandler"):null,Ub,oa)):(ud.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Ub),uh.a.instance.v3g(this.phb?Object(xf.a)(this,this.$pf,"oicErrorDialogHandlerCloseForced"):Object(xf.a)(this,this.aqf,"oicErrorDialogHandlerNoCloseForced"),
Va?Object(xf.a)(this,this.Jvf,"onLaunchDownload"):null,Ub))}};Hf.prototype.Dni=function(){try{var J=[Object.assign(new lj.a,{name:"CorrelationId",string:this.nD}),Object.assign(new lj.a,{name:"SessionOrigin",string:this.LUb}),Object.assign(new lj.a,{name:"ClickTime",string:this.sPb}),Object.assign(new lj.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Zj.a("OpenInClientCompleted",!0,0,J)}catch(oa){ud.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+oa.toString())}};
Hf.prototype.bhf=function(){ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.Lu&&ld.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new uf(this):new sf(this)};Hf.prototype.$pf=function(){this.closeApplication()};Hf.prototype.aqf=function(){this.Eab()};Hf.prototype.Jvf=function(){this.Wgf()};Hf.prototype.a1h=function(){return this.cFe(!0)};Hf.prototype.cFe=function(J){var oa=(Rg.a.EM||Rg.a.iH)&&!!ld.AFrameworkApplication.M4b;oa&&J&&(Qg.a.sf(ld.AFrameworkApplication.M4b,"_blank",
void 0,"OpenInClient"),this.closeApplication());return oa};tl.Object.defineProperties(Hf.prototype,{yBf:{configurable:!0,enumerable:!0,get:function(){return this.qB}},options:{configurable:!0,enumerable:!0,get:function(){var J=0;ld.AFrameworkApplication.f9i&&(J|=1);ld.AFrameworkApplication.openInClientEditOnly&&(J|=4);this.pzj()&&(J|=64);return J}},arb:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.pC}},pwb:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.jwb}},
V6e:{configurable:!0,enumerable:!0,get:function(){return""}},Vid:{configurable:!0,enumerable:!0,get:function(){return""}},K3f:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},Xxc:{configurable:!0,enumerable:!0,get:function(){return this.L$d||(this.L$d=ei.a.instance.resolve("Common.IOfficeTrialExperience"))}}});Hf.yNi="OpenInDesktop";Hf.wNi="OpenInBrowser";Object(Ze.a)(Hf,"AOpenInClientOperation",null,[]);var Gh=b(197),fi=b(201),
wi=b(126),ej=b(44),gj=b(42),ig=b(180),Hj=b(92),rj=b(32),Wi=b(477),Nk=b(1181),ek=b(607);vm(Lf,Hf);Lf.prototype.VWg=function(){this.RIf(this.RRe)};Lf.prototype.JYg=function(){var J=this,oa=this.$;mc.TaskExtensions.Ba(this.FJ.value,function(Va){J.NFa(oa.workbookContext.ClientUrl,ld.AFrameworkApplication.p3,1,oa.isEditMode?2:0,!0,new hg.a(function(){return Va.result}))},this.ma,3)};Lf.prototype.xgd=function(){pf.a.Qf.editMode&&(this.$.Ab.XJ=!1)};Lf.prototype.Z2e=function(){var J={};J[ab.a.F7b]=!1;J[ab.a.N$]=
"OpenInExcel";this.$.Ce(802602464,$c.a.Wb,8,J)};Lf.prototype.Q0c=function(){var J=this;if(this.fa.oc){var oa=this.$;oa.isEditMode&&mc.TaskExtensions.Ba(this.FJ.value,function(Va){J.NFa(oa.workbookContext.ClientUrl,ld.AFrameworkApplication.p3,1,2,!1,new hg.a(function(){return Va.result}))},this.ma,3)}};Lf.prototype.jze=function(){var J=this;this.fa.oc&&mc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,ld.AFrameworkApplication.p3,1,J.$.isEditMode?2:0,!1,new hg.a(function(){return oa.result}))},
this.ma,3)};Lf.prototype.openInExcelClient=function(){var J=this;this.fa.oc&&(this.$.isEditMode||mc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,ld.AFrameworkApplication.p3,1,0,!1,new hg.a(function(){return oa.result}))},this.ma,3))};Lf.prototype.openInBrowser=function(){var J=this;this.fa.oc&&mc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,ld.AFrameworkApplication.p3,1,5,!1,new hg.a(function(){return oa.result}))},this.ma,3)};
Lf.prototype.downloadFile=function(J){var oa=this.mse(J);this.Q$.downloadFile(oa,J)};Lf.prototype.uBf=function(J,oa){oa=void 0===oa?0:oa;if(this.fa.oc){var Va=this.$;Xg.a(Va).iLa?this.vBf(J,Va):0<oa?this.lxj(J,Va,oa):this.VZf(Va)}};Lf.prototype.NFa=function(J,oa,Va,Ub,e,C){this.$.Ab.XJ=!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.lc.inWebPart;this.RRe=e;this.G1b=null;this.C5c=!1;this.qJg(J,oa,Ub,e,C)};Lf.prototype.F1b=function(J){var oa=this.$.lc;ud.ULS.sendTraceTag(537154775,
0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Gh.a.edit:Gh.a.view);return Lf.Ubf()?(this.f1b(),ag.e6c(this.aUa,this.qB,this.options,1,this.fCi,this.eCi,!1,ld.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):Hf.prototype.F1b.call(this,J)};Lf.prototype.Nrh=function(){this.bPf();var J=this.$;if(!this.fa.lc.inWebPart&&this.fa.oc&&!J.isEditMode){var oa=new Hj.a(2145659238,
$c.a.Wb,this.$.ed,0,null);this.fxe=ej.a.instance.create(function(){J.Ka.Zb(oa)},0,gj.a.zNi)}};Lf.prototype.dispose=function(){this.fa&&this.fa.kk(this.Zc);Kg.a.pc([this.Ma,this.fxe,this.xm]);this.$=this.fa=null};Lf.prototype.ash=function(){this.bPf()};Lf.prototype.Wgf=function(){var J=this;ej.a.instance.create(function(){J.$.Ka.Zb(new Hj.a(-2028960985,$c.a.Wb,0,30,null))},0,gj.a.ANi,!0,!0)};Lf.prototype.lJg=function(J){var oa=this.$,Va=Xg.a(this.$).nd.activityState;Va[Wi.a.hie]=!0;oa.isEditMode&&
this.fa.oc?(this.f1b(),Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!1);Va[tg.a.Kq]=ge.a.h1b;Va[Wi.a.qvg]=J;Va[Pe.a.l$c]=!0;oa.isEditMode&&(Va[Pe.a.$S]=1,Va[Pe.a.WX]=!0,Va[Jh.a.ZWb]=!0,Va[Jh.a.aSc]=!0);Va[Wi.a.kie]=1455037301}))):this.RIf(J)};Lf.prototype.K1f=function(){var J=ld.AFrameworkApplication.p3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.E7a(J,!0)){var oa=this.$.fa.lc;ud.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",
J,oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Gh.a.edit:Gh.a.view)}}else this.Q$.downloadFile(J,-2028960985);this.C5c=!0;this.f1b()};Lf.prototype.Jji=function(){this.Xxc.Ipf&&this.Xxc.Mhc(1)};Lf.prototype.Kji=function(){this.Xxc.Ipf&&li.HelperMethods.sf(ub.a.iZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};Lf.prototype.Tji=function(){li.HelperMethods.sf(ub.a.iZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};Lf.prototype.Uji=function(){li.HelperMethods.sf(ub.a.iZ(34),
"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};Lf.prototype.mse=function(J){var oa=new Sys.StringBuilder,Va=this.$.workbookContext,Ub=this.$.ya;oa.append(this.$.hda);oa.append(Ub.FileHandlerRelativeUri);oa.append("?id=");oa.append(encodeURIComponent(fi.a.YFb(Va.WorkbookUri,"sc")));this.$.fa.oc&&(oa.append("&sessionId="),oa.append(encodeURIComponent(this.$.fa.sessionId)));switch(J){case -974518828:oa.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:oa.append("&workbookType=FullWorkbook");
break;case -1059172980:oa.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:oa.clear()}wi.a.yFa(oa,Ub);return oa.toString()};Lf.prototype.xXg=function(){tj.a.instance.OSg();var J=this.$.ya;MSOJS.ClientUtils.InitUrls(J.RoamingAppsX86RootUrl,J.RoamingAppsControlInstallerUrl,J.RoamingAppsFirefoxExtensionUrl)};Lf.prototype.bPf=function(){var J=this.$;this.fa.oc||ng.a.rDd(J,Xg.a(J).nd);this.f1b();this.G1b&&this.G1b(this,this.C5c);J.frame.hv.Yl(this.$.frame.haa());J.frame.MW.Yl(this.$.frame.haa());
J.Ab.XJ=!1;Oa.g(J).focus()};Lf.prototype.qJg=function(J,oa,Va,Ub,e){var C=this.$;ld.AFrameworkApplication.sa&&!Lf.Ubf()&&(C.frame.hv.dn(C.frame.haa()),C.frame.MW.dn(C.frame.haa()));Hf.prototype.NFa.call(this,J,oa,1,Va,Ub,e)};Lf.prototype.f1b=function(){var J=this.$;Xg.a(J).ui.activityName===ge.a.openInExcelClient&&Xg.a(J).nd.kJ()};Lf.prototype.Yrj=function(){var J=vh.a.jd(1,0,665,666,0,1341525452,"OpenInExcelActiveXError");Kb.a(this.$).St([J])};Lf.prototype.lxj=function(J,oa,Va){var Ub=this,e=null,
C=window.setTimeout(function(){Xg.a(oa).Fqc(e);Ub.VZf(oa)},Va);e=function(){Xg.a(oa).iLa&&(Xg.a(oa).Fqc(e),window.clearTimeout(C),Ub.vBf(J,oa))};Xg.a(oa).dTc(e)};Lf.prototype.VZf=function(J){var oa=vh.a.jd(1,1,0,680,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Kb.a(J).St([oa])};Lf.prototype.vBf=function(J,oa){var Va=this;Kb.a(oa).Rs(new ic.a(ge.a.Qy,5,function(){oa.KH(!1);var Ub=Xg.a(oa).nd,e=Ub.activityState;e[tg.a.Kq]=ge.a.BGe;e[Fh.a.aXb]=oa.fa.lc.hasUnsupportedFeaturesForEdit;e[ek.a.VRc]=
J;Ub.ft(vh.a.K$(Va.businessBar.n6c,[1437034227]))}))};Lf.Ubf=function(){return 1<pf.a.getRegisteredEwaInstances().length};tl.Object.defineProperties(Lf.prototype,{V6e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=this.xm||new ig.a;return this.xm.token}},Vid:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},K3f:{configurable:!0,enumerable:!0,get:function(){return this.fa.lc.inWebPart}}});Object(Ze.a)(Lf,
"OpenInExcelOperation",Hf,[679,3]);var Yi=sd.a;vm(Ig,Yi);Ig.prototype.create=function(){var J=this;if(this.$.da.Aa(55))this.Fb(this.$.da.Aa(55));else{var oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.Xa(this.$.da,5,4,this.tb);mc.TaskExtensions.Ba(kb.Task.WAA(oa,Va),function(){J.Fb(new Lf(J.$,new hg.a(function(){return qc.GetServiceTaskFactory.create(J.$.da,137,J.ma,J.tb)}),Va.result))},this.ma,3)}};Ig.wXg=function(){Ig.cqf||(Ig.cqf=!0,(new Be).di(ei.a.instance),
ei.a.instance.resolve("Common.IOfficeTrialExperience").Mg(),ei.a.instance.resolve("Common.IMacOfficeOffer").Mg())};Ig.cqf=!1;Object(Ze.a)(Ig,"OpenInClientFactory",sd.a,[]);var Mj=b(111),vj=b(387),Qj=Mj.a;vm(Ne,Qj);Ne.prototype.execute=function(J){var oa=Object(Ug.a)(6,J.Ge);mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(oa.da,56,oa.ma,0),function(Va){oa.downloadCopyOnOpenInClient?(J.activityState[vj.a.iie]=!0,Va.result.K1f()):Va.result.JYg()},oa.ma,3);return 1};Object(Ze.a)(Ne,"OpenInExcelClientActivity",
Mj.a,[]);var Aj=sd.a;vm(Xe,Aj);Xe.prototype.create=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new Ne(ge.a.openInExcelClient,ge.a.idle))},this.ma)};Object(Ze.a)(Xe,"OpenInExcelClientActivityFactory",sd.a,[]);var Mi=ae.a;vm(je,Mi);je.prototype.initialize=function(J){Mi.prototype.initialize.call(this,J)};je.prototype.execute=function(J){this.vi=J;J=Object(Ug.a)(6,this.vi.Ge);this.eqb(J);return 1};je.prototype.qI=function(J){Mi.prototype.qI.call(this,
J)};je.prototype.eqb=function(){var J=this;this.subscribe(this.vi,this.QPi,function(oa){J.JAd.add_disposing(oa)})};je.prototype.WDb=function(J){this.unsubscribe(function(oa){J.remove_disposing(oa)});this.vi.activityState[cg.a.W1]=0};Object(Ze.a)(je,"PasswordProtectedFileActivity",ae.a,[]);var Ad=b(521),Se=Ad.a;vm(nd,Se);nd.prototype.p$a=function(J){this.Yoa=J};nd.prototype.V2=function(){var J={};J[Ad.a.description]=nf.a.instance.ea(1916);J[Ad.a.Jla]=nf.a.instance.ea(1912);J[Ad.a.LCf]=nf.a.instance.ea(1934);
J[Ad.a.JCf]=nf.a.instance.ea(1935);J[Ad.a.KCf]=nf.a.instance.ea(1913);J[Ad.a.hjd]=nf.a.instance.ea(1919);J[Ad.a.cqe]=nf.a.instance.ea(1614);J[Ad.a.MNj]=nf.a.instance.Va(25);J[Ad.a.vbg]=Object(xf.a)(this,this.aTa,"verifySubmittedPassword");return J};nd.prototype.xsa=function(){var J={};J[bi.a.Ly]=this.xc;J[Ad.a.lre]=this.V2();return J};nd.prototype.Kh=function(){this.kc=1;this.initializeAndShow(this.Wn,this.KYi,this.xsa())};tl.Object.defineProperties(nd.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"PasswordDialog"}},Rqb:{configurable:!0,enumerable:!0,get:function(){return this.Yoa}},Wn:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.ea(1915)}}});Object(Ze.a)(nd,"PasswordProtectedFilePasswordInputDialog",Ad.a,[]);var Vg=b(302);vm(Xd,nd);Xd.prototype.p$a=function(J,oa){nd.prototype.p$a.call(this,J,oa);ud.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",J)};
Xd.prototype.aTa=function(J,oa){this.passwordToModify=J;var Va={};Va.FileModifyPassword=Fg.a.qf(J);Le.nb(this.$.qa.ta,Va,this.sMi(oa),this.rMi(oa),null,null)};Xd.prototype.V2=function(){var J=nd.prototype.V2.call(this);J[Ad.a.hjd]=nf.a.instance.ea(1920);J[Ad.a.description]=nf.a.instance.Va(24);return J};Xd.prototype.Kh=function(){Gd.b().E6c("PasswordToModifyDialogShown");ud.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");
nd.prototype.Kh.call(this)};Xd.prototype.sMi=function(J){var oa=this;return function(Va){vh.a.hh(Va.Errors,[-2019873242])&&oa.W4b(oa.Ypb());if(!Va||Vg.a(Va))if(0<oa.$Id)oa.dIf(J);else{ud.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",vh.a.Uc(Va.Errors));oa.$.fa.Yo(Va.Errors);oa.hide();return}oa.V6d=Va.Result;oa.Jfc&&(Gd.b().TQd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password",
"PasswordToModifyPasswordVerifiedTillInteractive"),ud.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));J(oa.Jfc?0:1)}};Xd.prototype.rMi=function(J){var oa=this;return function(){0<oa.$Id?oa.dIf(J):(ud.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),J(3))}};Xd.prototype.dIf=function(J){--this.$Id;
this.aTa(this.passwordToModify,J)};Xd.prototype.Ypb=function(){return vh.a.jd(1,0,1613,1614,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};tl.Object.defineProperties(Xd.prototype,{Jfc:{configurable:!0,enumerable:!0,get:function(){return this.V6d}},Wn:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.ea(1917)}}});Object(Ze.a)(Xd,"PasswordProtectedFileModifyPasswordInputDialog",nd,[]);vm(ce,je);ce.prototype.eqb=function(J){this.JAd=new Xd(J);je.prototype.eqb.call(this,
J)};ce.prototype.WDb=function(J,oa){var Va=J.Rqb,Ub=J.Jfc,e=J.passwordToModify;je.prototype.WDb.call(this,J,oa);this.vi.kxa([2001366804]);switch(Va){case 1:Ub?(oa=Object(Ug.a)(6,this.vi.Ge),this.vi.activityState[cg.a.zie]=Fg.a.qf(e),this.vi.activityState[cg.a.jXa]=!0,J.passwordToModify="",this.ph(oa.isEditMode?ge.a.Oj:this.$L)):ud.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Uo();break;case 0:this.vi.activityState[cg.a.rs]=!1;this.ph(this.vJ);this.Uo();break;default:ud.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Va)}};Object(Ze.a)(ce,"PasswordProtectedFileModifyActivity",je,[]);var Wj=sd.a;vm(Xc,Wj);Xc.prototype.create=function(){this.Fb(new ce(this.activityName,this.$L,this.vJ))};Xc.ja=function(J){J.da.Ha(434,new Xc(ge.a.VDb,ge.a.qdb,ge.a.rGa,J))};Object(Ze.a)(Xc,"PasswordProtectedFileModifyActivityFactory",
sd.a,[]);vm(ed,nd);ed.prototype.aTa=function(J,oa){this.password=J;oa(0)};ed.prototype.V2=function(){var J=nd.prototype.V2.call(this);this.$ef&&(J[Ad.a.Bhh]=1);return J};ed.prototype.Kh=function(){ud.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.$ef);nd.prototype.Kh.call(this);Kb.a(this.$).zme()};Object(Ze.a)(ed,"PasswordProtectedFileOpenPasswordInputDialog",nd,[]);vm(Pb,je);Pb.prototype.eqb=function(J){var oa=
vh.a.hh(this.vi.errors,[1217361942]);this.JAd=new ed(J,oa);J.Vdc||J.WEe();je.prototype.eqb.call(this,J)};Pb.prototype.WDb=function(J,oa){var Va=J.password;J.password="";var Ub=J.Rqb;je.prototype.WDb.call(this,J,oa);this.vi.activityState[cg.a.eSc]=Fg.a.qf(Va);this.vi.activityState[cg.a.jXa]=!0;this.vi.kxa([110414285,1217361942]);ud.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Ub);switch(Ub){case 1:this.ph(this.$L);
this.Uo();break;case 0:this.ph(this.vJ),this.Uo()}};Object(Ze.a)(Pb,"PasswordProtectedFileOpenActivity",je,[]);var Ck=sd.a;vm(Hb,Ck);Hb.prototype.create=function(){this.Fb(new Pb(this.activityName,this.$L,this.vJ))};Hb.ja=function(J){J.da.Ha(386,new Hb(ge.a.Lnc,ge.a.Oj,ge.a.Ck,J))};Object(Ze.a)(Hb,"PasswordProtectedFileOpenActivityFactory",sd.a,[]);var zf=b(378),Vh=zf.a;vm(Bb,Vh);Bb.prototype.YN=function(J,oa){this.Yoa=J;Vh.prototype.YN.call(this,J,oa)};Bb.prototype.jr=function(){Vh.prototype.jr.call(this);
this.kc=9;var J=this.BLh();this.Cc(1,nf.a.instance.ea(1612));this.Cc(2,nf.a.instance.ea(960));this.Kk(nf.a.instance.ea(686),ta.a.ym(J),this.icon,this.ZN)};Bb.prototype.BLh=function(){return String.format(nf.a.instance.ea(687))};tl.Object.defineProperties(Bb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Rqb:{configurable:!0,enumerable:!0,get:function(){return this.Yoa}}});Object(Ze.a)(Bb,"LegacySharedWorkbookDialog",zf.a,[]);var ji=ae.a;vm(Cb,ji);Cb.prototype.initialize=
function(J){ji.prototype.initialize.call(this,J)};Cb.prototype.execute=function(J){this.vi=J;this.a1g();return 1};Cb.prototype.qI=function(J){ji.prototype.qI.call(this,J)};Cb.prototype.a1g=function(){var J=Object(Ug.a)(6,this.vi.Ge),oa=vh.a.XYa([-573864504]);oa[0].HelpDescription=nf.a.instance.ea(689);oa[0].HelpTopicId=rh.a.rki;var Va=new Bb(J,oa[0]);this.subscribe(this.vi,this.qki,function(Ub){Va.add_disposing(Ub)})};Object(Ze.a)(Cb,"LegacySharedWorkbookActivity",ae.a,[]);var Hh=sd.a;vm(Lc,Hh);Lc.prototype.create=
function(){this.Fb(new Cb(this.activityName,this.$L,this.vJ))};Lc.ja=function(J){J.da.Ha(460,new Lc(ge.a.Mzb,ge.a.qdb,ge.a.rGa,J))};Object(Ze.a)(Lc,"LegacySharedWorkbookActivityFactory",sd.a,[]);kd.prototype.Xc=function(){return!1};kd.prototype.Gc=function(J,oa){if(!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(oa.command){case 642419866:return!0;case 588342182:return this.presentModeManager.$y;default:return!1}};kd.prototype.executeCommand=function(J,
oa){J=mc.TaskExtensions.om();oa=oa.command;switch(oa){case 642419866:this.presentModeManager.Wvc(!this.presentModeManager.$y);this.presentModeManager.mh("TogglePresentMode");break;case 588342182:this.presentModeManager.W5a=!this.presentModeManager.W5a;this.presentModeManager.W_f(this.presentModeManager.W5a,"TogglePresentModeOverlay");this.presentModeManager.mh("TogglePresentModeOverlay");break;default:J=Ed.a(oa)}return J};kd.prototype.fd=function(){return!1};Object(Ze.a)(kd,"PresentModeCommandHandler",
null,[147]);var Ij=Ka.a;vm(gb,Ij);gb.prototype.Md=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,423,424,this.tb),function(oa){J.Ed([new kd(J.$,oa.result)])},this.ma,3)};gb.ja=function(J){Ka.a.de(420,new gb(J))};Object(Ze.a)(gb,"PresentModeCommandHandlerFactory",Ka.a,[]);var ci=b(135),Ej=b(110);wc.bmh="ewa-presentMode-overlay";wc.cmh="ewa-presentMode-panel-container";wc.dmh="ewa-presentMode-rowHdrParent-container";Object(Ze.a)(wc,"CssClassNames",null,[]);var L=b(16),
Fa=b(142),Qb=b(283),yc=b(125),Yc=b(119),Ke=b(433),De=b(11),tf=b(95),Mf=b(339),Cg=b(127),sh=b(412),Of=b(256),dh=b(245),xi=b(186);hd.prototype.dispose=function(){this.$=this.iCd=this.jCd=this.lca=this.LOa=null};hd.prototype.n4h=function(){var J=this;window.requestAnimationFrame(function(){J.lca=document.createElement("div");J.$.Ey.insertBefore(J.lca,J.$.Ey.lastChild);J.lca.id=J.$.Ib+ab.a.t8b;J.lca.classList.add(wc.cmh);J.jCd=document.getElementById(J.$.Ib+ab.a.Y3c);J.iCd=[J.$.Ay];J.isInitialized=!0});
this.LOa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.LOa.initializePresentModeFloatie()};hd.prototype.NSh=function(){var J={};J.PollingCountPerCaller=Ej.a.toJSON(this.hoc);J.PollingDurationPerCaller=Ej.a.toJSON(this.ioc);return J};hd.prototype.sPd=function(J){this.isInitialized?J?(this.LOa.showPresentModeFloatie(this.lca,this.jCd,this.iCd),this.mh("ShowOrHideFloatiePanel"),this.W0i()):(this.LOa.hidePresentModeFloatie(),this.nHj()):ud.ULS.sendTraceTag(537154326,
0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};hd.prototype.mh=function(J){this.LDf=li.HelperMethods.jc();this.HOa=J;this.Gpe=xi.AsyncMethodContext.Ky(this.Fl,100,gj.a.GTi+J,this.Gpe)};hd.prototype.Qe=function(J,oa){if(oa)return!1;J=De.DOMElementExtensions.zl(this.lca.querySelectorAll(De.DOMElementExtensions.Ep));if(!J)return ud.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),
!1;J.focus();return!0};hd.prototype.Ah=function(J){return De.DOMElementExtensions.Ye(this.Jb,J)};hd.prototype.ji=function(){};hd.prototype.Vh=function(){};hd.prototype.W0i=function(){var J=this;Of.a(this.$).Tg(this);this.$.da.Za(15,function(oa){J.ewaAccessibilityManager=oa;J.ewaAccessibilityManager.mode=5});xh.KeyInputManager.instance.pa(Je.a.Rb,this.Jb,this.onKeyDown)};hd.prototype.nHj=function(){Of.a(this.$).XA(this);Oa.g(this.$).e0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0);xh.KeyInputManager.instance.za(Je.a.Rb,this.Jb,this.onKeyDown)};hd.prototype.ocj=function(){var J=li.HelperMethods.jc()-this.LDf,oa=this.ioc[this.HOa]?this.ioc[this.HOa]:0;this.ioc[this.HOa]=oa>J?oa:J;this.hoc[this.HOa]=this.hoc[this.HOa]?this.hoc[this.HOa]+1:1};tl.Object.defineProperties(hd.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.lca}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.LOa.updatePresentModeFloatieShyState(2);return!!this.lca}},Zd:{configurable:!0,
enumerable:!0,get:function(){return dh.a.TEf}}});Object(Ze.a)(hd,"PresentModeFloatieManager",null,[661,107,3]);var ui=b(58);Object(Ze.a)(oc,"OverlayCavityInfo",null,[]);Object(Ze.a)(Jf,"OverlayContainerInfo",null,[]);Object(Ze.a)(ze,"PresentModeOverlayProps",null,[]);Pd.prototype.X4h=function(){var J=this;this.kCd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){J.gZa=Array(5);for(var oa,Va,Ub=1;4>=Ub;Ub++)oa=document.createElement("div"),
De.DOMElementExtensions.setVisible(oa,!1),oa.id=String.format("{0}-{1}","PresentModeOverlay",Ub),De.DOMElementExtensions.toggleCssClass(oa,wc.bmh,!0),Va=J.gridView.fg(Ub).domElement,Va.insertBefore(oa,Va.firstChild),J.gZa[Ub]=oa})};Pd.prototype.V_f=function(J){J&&this.AKj();for(var oa=1;4>=oa;oa++)this.pcf(oa)&&De.DOMElementExtensions.setVisible(this.gZa[oa],J);De.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-overlay",J)};Pd.prototype.AKj=function(){for(var J=this.iPg(),oa,Va=1;4>=
Va;Va++)oa=Va,J[oa]&&this.kCd.showOverlayWithCavity(this.gZa[oa],J[oa])};Pd.prototype.dispose=function(){this.kCd=this.gZa=this.gridView=this.$=null};Pd.prototype.iPg=function(){for(var J,oa,Va=Oa.g(this.$).rtl,Ub,e=Array(5),C=1;4>=C;C++)oa=C,this.pcf(C)&&(J=this.gridView.fg(C),Ub=this.gridView.ha.Qa.Qaa?this.eJh(C,J,Va):this.WJh(C,J,Va),J=this.H3g(J),e[oa]=this.$3g(this.gZa[oa].id,J,Ub));return e};Pd.prototype.pcf=function(J){return this.gridView.$a.NJ(J)};Pd.prototype.H3g=function(J){return Object.assign(new Jf,
{width:J.Cn.width,height:J.Cn.height})};Pd.prototype.$3g=function(J,oa,Va){return Object.assign(new ze,{containerId:J,overlayContainerInfo:oa,overlayCavityInfos:Va?[Va]:null})};Pd.prototype.eJh=function(J,oa,Va){var Ub=Oa.g(this.$).ha.Qa.nc;if(!Ub)return ud.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var e=Ub.extension.hJh(J);J=e.pBa;Ub=e.rotation;var C=e.translateX;var M=e.translateY;return e.returnValue?
(e=J.x-oa.Cn.x,Object.assign(new oc,{left:(Va?oa.Cn.width-(e+J.width):e)-3+1,top:J.y-oa.Cn.y-3+1,width:J.width+5,height:J.height+5,angle:Ub,translateX:C,translateY:M})):null};Pd.prototype.WJh=function(J,oa,Va){J=this.gridView.Nb.ztb(this.gridView.ha.va.activeRange,J)||ui.a.y3;if(!J.Jf(oa.Cn))return null;var Ub=J.x-oa.Cn.x;return Object.assign(new oc,{left:Va?oa.Cn.width-(Ub+J.width)-2:Ub-3,top:J.y-oa.Cn.y-3,width:J.width+5,height:J.height+5})};Object(Ze.a)(Pd,"PresentModeOverlayRenderer",null,[587,
3]);var zi=Ad.a;vm(Bd,zi);Bd.prototype.hide=function(){zi.prototype.hide.call(this);ci.a.vw(ab.a.$_f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};tl.Object.defineProperties(Bd.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(Ze.a)(Bd,"PresentModeWelcomeDialog",Ad.a,[]);ne.requestFullscreen=function(J){J.webkitRequestFullscreen?J.webkitRequestFullscreen():J.msRequestFullscreen?J.msRequestFullscreen():J.mozRequestFullScreen?
J.mozRequestFullScreen():J.requestFullscreen?J.requestFullscreen():ud.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};ne.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ud.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};tl.Object.defineProperties(ne,
{czh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},dzh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?
"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},Yai:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(Ze.a)(ne,"FullscreenUtils",null,[]);ee.prototype.Wvc=function(J){var oa=this;this.$y!==J&&(this.X6d=J,this.W5a=this.$y,this.l9e(),this.wJb=this.GZf(),window.requestAnimationFrame(function(){De.DOMElementExtensions.toggleCssClass(oa.$.Oq,
"ewr-presentMode-transition",!0);$addHandler(oa.e1a,"transitionend",oa.Lna);oa.etj(!J);oa.COi();De.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on",J);oa.dtj(J);Fa.b(oa.$).T_f(oa.$y);Fa.c(oa.$).T_f(oa.$y);oa.$.lma();oa.NOa.V_f(oa.wJb);if(oa.$y){oa.sYa();ci.a.get(ab.a.$_f)?oa.mca.sPd(oa.$y):oa.Doc=new Bd(oa.$,oa.mca);var Va=sh.b(oa.$);Va&&(oa.hJd=Va.v6c(!1));oa.SEf=li.HelperMethods.jc()}else oa.mca.sPd(J),oa.hJd&&(Va=sh.b(oa.$))&&(Va.v6c(!0),oa.hJd=!1),oa.A4b(),oa.Sni()}))};ee.prototype.W_f=
function(J,oa){this.xPd=J;this.Vda(oa)};ee.prototype.mh=function(J){this.mca.mh(J)};ee.prototype.dispose=function(){this.A4b();this.NOa&&(this.NOa.dispose(),this.NOa=null);this.gridView=this.$=null};ee.prototype.etj=function(J){var oa=this.$.da.Aa(25);void 0===oa||null===oa?ud.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):J?oa.Qvc():oa.kcc()};ee.prototype.COi=function(){var J=this;De.DOMElementExtensions.toggleCssClass(document.getElementById(ld.AFrameworkApplication.n1a),
L.a.yu,this.$y);De.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on",this.$y);this.htj(this.$y);this.gridView.qmd=!this.$y;this.QKj();this.$.da.Za(32,function(oa){oa.jLj(J.$y)});Yc.b(this.$,function(oa){oa.Y9f(J.$y)})};ee.prototype.htj=function(J){if(this.CEb)if(J){if(J=Object(Ug.a)(tf.a,this.$.oa))De.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on-headers-off",!J.headersVisible),De.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on-rtl",Oa.g(this.$).rtl);
this.yzc(0)}else this.$.Oq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Oq.classList.remove("ewr-presentMode-on-rtl"),this.yzc(1)};ee.prototype.yzc=function(J){var oa=Object(Ug.a)(tf.a,this.$.oa);if(oa){var Va=parseInt(this.$.Ey.style.right);if(1===J||2===J){if(isNaN(Va)||Va<this.O_a)return;Va-=this.O_a}J&&2!==J||(J=oa.headersVisible,oa=Oa.g(this.$).rtl,J=J?oa?0:32:12,Va=isNaN(Va)?J:Va+J,this.O_a=J);this.$.Ey.style.right=li.HelperMethods.Qb(Va);this.cze=Va}};ee.prototype.QKj=function(){var J=
document.getElementById(this.$.Ib+ab.a.$3b).parentNode;De.DOMElementExtensions.toggleCssClass(J,wc.dmh,this.$y)};ee.prototype.initialize=function(J){this.NOa=new Pd(J);this.NOa.X4h();this.mca=new hd(J);this.mca.n4h();this.e1a=document.getElementById("MainApp");this.uSe=this.dDi;$addHandler(this.e1a,ne.czh,this.uSe);$addHandler(this.e1a,ne.dzh,this.eDi);this.CEb||(this.CEb=document.createElement("div"),this.CEb.className="ewa-presentMode-right-frame",this.$.Ay.appendChild(this.CEb));this.Lna=this.s3i};
ee.prototype.sYa=function(){this.gridView.ha.l9(this.dr);this.gridView.ha.i2(this.Sh);this.gridView.rc.wm(this.Mj);this.gridView.rc.hq(this.Rh);this.gridView.DD(this.Wo);this.gridView.view.it(this.iw);this.gridView.AXb(this.Hxa);this.gridView.Ca.gG(this.Hm);this.gridView.Ca.gq(this.Pe);this.$.xa.Pf(this.Yh);this.$.xa.yXa(this.Lba);this.$.xa.pga(this.ZCb);this.$.Yz(this.aj);this.$.Rk(this.od);var J=Object(Ug.a)(Mf.a,this.$.xa);J=yl(J.items);for(var oa=J.next();!oa.done;oa=J.next())oa.value.vmb(this.$xa)};
ee.prototype.A4b=function(){this.gridView&&(this.gridView.ha.Oca(this.dr),this.gridView.ha.K_(this.Sh),this.gridView.rc.im(this.Mj),this.gridView.rc.Rp(this.Rh),this.gridView.lF(this.Wo),this.gridView.view.Wr(this.iw),this.gridView.Aqc(this.Hxa),this.gridView.Ca.LH(this.Hm),this.gridView.Ca.Zo(this.Pe));if(this.$){this.$.xa.rg(this.Yh);this.$.xa.Q$a(this.Lba);this.$.xa.dma(this.ZCb);this.$.RC(this.aj);this.$.ml(this.od);var J=Object(Ug.a)(Mf.a,this.$.xa);J=yl(J.items);for(var oa=J.next();!oa.done;oa=
J.next())oa.value.mHd(this.$xa)}};ee.prototype.GZf=function(){if(!this.$y||!this.W5a)return!1;if(1===this.gridView.ha.Te){var J=this.$.oa.activeRange.isSingle,oa=1===this.$.oa.selectedRanges.length&&!J,Va=this.gridView.isEditing,Ub=this.pod;oa||ud.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",J);return this.xPd&&oa&&!Va&&!Ub}return this.xPd};ee.prototype.dtj=function(J){J?ne.requestFullscreen(this.e1a):
ne.exitFullscreen()};ee.prototype.Vda=function(J,oa,Va){var Ub=this;Va=void 0===Va?!1:Va;void 0!==oa&&oa||(this.wJb=this.GZf());ud.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",J,this.wJb,Va);if(this.nMb&&Va)ud.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.mMb),window.cancelAnimationFrame(this.mMb),this.mMb=0;else if(this.nMb){ud.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",J);return}Va?this.CVd(li.HelperMethods.jc(),J):(this.mMb=window.requestAnimationFrame(function(e){Ub.CVd(e,J)}),this.nMb=!0)};ee.prototype.CVd=function(J,oa){var Va=this,Ub=li.HelperMethods.jc();if(Ub-J>this.Zcj)this.mMb=window.requestAnimationFrame(function(C){Va.CVd(C,oa)}),this.nMb=!1,ud.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Ub-J);else{this.NOa.V_f(this.wJb);
this.nMb=!1;var e=li.HelperMethods.jc();J=li.HelperMethods.jc()-J;Ub=e-Ub;this.ccj(J,oa);ud.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Ub,J)}};ee.prototype.l9e=function(){var J=this;oe.a(this.$.userOperationManager,function(oa,Va,Ub){var e=J.$.qa.ta,C=J.$y,M=e.Oa(41,null);M.shouldEnablePresentMode=C;return Le.i(e,"SetPresentMode",M,oa,Va,Ub,null,0)},function(oa){return new Ee.a(252,0,oa)},null)};ee.prototype.JRf=
function(){var J=Ke.a(this.gridView.Te);1!==this.gridView.Te||this.$.oa.activeRange.isSingle||(J="Range");this.jtc[J]=this.jtc[J]?this.jtc[J]+1:1};ee.prototype.ccj=function(J,oa){var Va=this.tnc[oa]?this.tnc[oa]:0;this.tnc[oa]=Va>J?Va:J;this.snc[oa]=this.snc[oa]?this.snc[oa]+1:1};ee.prototype.Sni=function(){var J={},oa=li.HelperMethods.jc()-this.SEf;J.PresentModeDuration=oa;J.SelectionCountPerObject=Ej.a.toJSON(this.jtc);J.OverlayCountPerCaller=Ej.a.toJSON(this.snc);J.OverlayDurationPerCaller=Ej.a.toJSON(this.tnc);
oa=this.mca.NSh();for(var Va in oa)J[Va]=oa[Va];Cg.b(this.$).ae(yc.a.FTi,J,void 0,!0)};tl.Object.defineProperties(ee.prototype,{$y:{configurable:!0,enumerable:!0,get:function(){return this.X6d}}});Object(Ze.a)(ee,"PresentModeManager",null,[566,3]);var mj=b(335),nj=sd.a;vm(Wd,nj);Wd.prototype.create=function(){var J=this,oa=qc.GetServiceTaskFactory.Xa(this.$.da,283,284,1);mc.TaskExtensions.Ba(oa,function(){mc.TaskExtensions.Ba(mj.c(oa.result.wo.loadScript("presentMode")),function(){var Va=J.$.da.Aa(423);
Va||(Va=new ee(J.$),J.$.da.Ha(423,Va));J.Fb(Va)},J.$.ma,3)},this.$.ma,3)};Wd.ja=function(J){J.da.Ha(424,new Wd(J))};Object(Ze.a)(Wd,"PresentModeManagerFactory",sd.a,[]);var bj=b(169),hj=b(158),Ni=b(675),Sj=b(83),Bj=b(30);Qd.qmh="ewa-resizehdr-row-hidden";Qd.pmh="ewa-resizehdr-col-hidden";Object(Ze.a)(Qd,"CssClassNames",null,[]);var rk=b(61),Oi=b(24),oi=b(141),Qk=b(51),fk=b(69),Zk=b(247),uk=b(370);Object(Ze.a)(cc,"HeaderEventCachedInfo",null,[]);Ie.prototype.Aze=function(J){return Math.max(0,Math.min(Ie.Ulf,
li.HelperMethods.kBd(J)))};Ie.prototype.rze=function(J){return this.dRi(J)};Ie.prototype.wVg=function(J){return Math.round(this.S5c*J+2*this.ZVe()+1)};Ie.prototype.dRi=function(J){return Math.max(0,Math.min(Ie.Clf,(Math.max(0,Math.min(Pf.a.ijc,J))-2*this.ZVe()-1)/this.S5c))};Ie.prototype.ZVe=function(){return Math.floor(Math.max((this.S5c+3)/4,2))};Ie.prototype.aac=function(J,oa){return oa?J?Ie.Ulf:Pf.a.Mtd:J?Ie.Clf:Pf.a.ijc};Ie.Ulf=409;Ie.Clf=255;Object(Ze.a)(Ie,"ResizeHeadersConverter",null,[]);
var Jj=b(34),Dk=Sj.a;vm(qd,Dk);qd.prototype.dispose=function(){this.MZc();this.grid.ha&&(this.grid.ha.Nca(this.Sh),this.grid.ha.Oca(this.dr));this.grid.Us(this.Sh);Kb.a(this.grid.$)&&Kb.a(this.grid.$).pg.ema(this.$E);Ph.a.instance.za(Je.a.Ij,this.domElement,this.Nba);bj.a.instance.za(Je.a.Wd,this.domElement.ownerDocument.body,this.nlc);hj.a.instance.za(Je.a.De,this.domElement.ownerDocument.body,this.nlc);Rg.a.Pr||(bj.a.instance.za(Je.a.pointerDown,this.domElement,this.iN),bj.a.instance.za(Je.a.lh,
this.domElement,this.aR));this.zab&&(bj.a.instance.za(Je.a.lh,this.domElement.ownerDocument.body,this.Mxa),hj.a.instance.za(Je.a.Ig,this.domElement.ownerDocument.body,this.Mxa),this.zab=!1);this.EF&&(bj.a.instance.za(Je.a.pointerDown,this.EF,this.iN),Ph.a.instance.za(Je.a.Ij,this.EF,this.Nba),this.MZc(),this.EF=null);this.CPf&&(De.DOMElementExtensions.Sf(qd.Cab),qd.Cab=null);this.hf=null;Dk.prototype.dispose.call(this)};qd.prototype.jhh=function(){if(!qd.Cab){document.getElementById(qd.BPf);this.CPf=
!0;var J=qd.Cab=document.createElement("div");this.grid.$.frame.haa().appendChild(J);J.id=qd.BPf;J.className=Bj.a.rmh;De.DOMElementExtensions.setVisible(J,!1)}};qd.prototype.zIe=function(){this.zab&&(bj.a.instance.za(Je.a.lh,this.domElement.ownerDocument.body,this.Mxa),hj.a.instance.za(Je.a.Ig,this.domElement.ownerDocument.body,this.Mxa),this.zab=!1);this.Zaa=!1;this.kaj();this.sGd();uk.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};qd.prototype.kaj=function(){this.grid.Nb.kl([this.isRow?
13:14]);this.grid.Nb.ncb()};qd.prototype.pTe=function(J,oa,Va){this.wM&&Va&&(ud.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.sGd());this.wM||Va||ud.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.nsd&&this.nsd(function(){var Ub={};return Ub.Location="canvas",Ub});this.wM?this.uTe(oa):
(this.wM=document.createElement("div"),this.wM.id=this.s_h,this.uTe(oa),this.wM.className=Bj.a.flh,oa=document.getElementById(this.grid.$.Ib+ab.a.vnf),oa.insertBefore(this.wM,oa.firstChild),J=Jj.a(this.grid.$).OJa(J.clientPoint),this.wM.style.left=(this.rtl?Math.max(J.x-this.wM.offsetWidth,0):J.x-Math.max(J.x+this.wM.offsetWidth-oa.offsetWidth,0)).toString()+"px",oa=document.getElementById(ab.a.xFa),this.wM.style.top=(J.y-oa.offsetHeight-this.wM.offsetHeight).toString()+"px")};qd.prototype.sGd=function(){De.DOMElementExtensions.Sf(this.wM);
this.wM=null};qd.prototype.uTe=function(J){var oa=new Ie(this.grid.$.workbookContext.DxDigitNormal);this.wM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.o_h:this.x_h,this.isRow?oa.Aze(J).toFixed(2):oa.rze(J).toFixed(2),J.toString(),this.r_h)};qd.prototype.FEf=function(J,oa){var Va;if(-1!==this.grid.ha.selectionType||2===J.zb&&J.Ea.button||!this.ypd(Va=this.Ycd(J))||!this.hdf)return!1;fk.g(J.Ea);this.uKb=this.gzb=new Sys.UI.Point(J.clientPoint.x,J.clientPoint.y);this.EOg(Va,oa);if(!this.Dr)return!1;
this.Zaa=!0;this.pei(this.Dr,Va)&&this.k3h();J={};Cg.b(this.grid.$).ae(yc.a.b$i,(J.IsResizingHiddenHeader=this.nVa,J.IsAutoFitting=oa,J.NumberOfSelectedRanges=this.grid.ha.va.nK,J.Location="canvas",J));this.yHb=this.kcd();this.offset=this.Dr.lja();this.$l=this.Dr.Fua();if(this.$l===Pf.a.z4a)return!1;uk.c(this.grid.$,!1,"HeaderResizeBehavior:PrepareResizeOperation");return!0};qd.prototype.pei=function(J,oa){var Va=this.Dr.EJ();if(!Va)return ud.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;Va=Va.nextSibling;if(!Va)return!1;J=J.getRange();Va=this.hf.uua(Va).getRange();if((!J||!Va)&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4307391_ColumnResizeOnSnappingHeaders_IsResizingHidden"))return ud.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var Ub=J.right===Va.right;return J.right+1!==Va.right&&!Ub&&this.ypd(oa,!0)};qd.prototype.k3h=function(){var J=this.Dr.EJ(),oa=this.hf.uua(J.nextSibling);qd.qei(oa,this.isRow)?(this.Dr=oa,this.x6=this.Dr.getRange()):(this.Iwg(J),
this.Dr=oa,J=this.Dr.getRange(),this.x6=this.isRow?new Oi.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Oi.Range(J.top,J.left-1,J.bottom,J.left-1,!1,!0),this.nVa=!0)};qd.prototype.Iwg=function(J){var oa=this.hf.uua(J.nextSibling),Va=qd.f2g(oa,this.isRow,this.rtl);Va&&J.parentNode.insertBefore(Va,oa.EJ())};qd.prototype.$Ze=function(J){var oa=this.x6,Va=J.ha.va.selectedRanges;if(J.ha.va.grb(oa))if(this.isRow){if(H.a.all(Va,function(Ub){return Ub.isRow}))return Va}else if(H.a.all(Va,function(Ub){return Ub.Lh}))return Va;
return[oa]};qd.prototype.kcd=function(){var J=this.Dr.EJ().style;return Math.max(0,Math.min(this.Elf,0|parseInt(this.isRow?J.height:J.width)))};qd.prototype.DPd=function(J){J=void 0===J?0:J;var oa=this.grid,Va=this.hf.sj.paneType;Va=this.isRow?3===Va?[3,2]:[1,4]:4===Va?[2,4]:[1,3];var Ub=oa.view.visibleArea.bottomRight,e=this.Dr.Fua();e===Pf.a.z4a&&(e=0);J=this.nVa?Math.max(this.kcd(),0):Math.max(e+J,0);Ub=this.isRow?new ui.a(0,this.offset,Ub.x,J):new ui.a(this.offset,0,J,Ub.y);e=[this.isRow?13:14];
oa.Nb.Jl(Oi.Range.ld(1,1),e,!1);oa.Nb.Yr(e,Ub,Va);return J};qd.prototype.MZc=function(){this.x6=this.uKb=this.gzb=null;if(this.r0){var J=this.r0.parentNode;if(J)for(J.removeChild(this.r0);this.r0.firstChild;)J.appendChild(this.r0.firstChild);this.r0=null}this.Dr=null;De.DOMElementExtensions.setVisible(qd.Cab,!1);this.Zaa=!1;this.sGd();De.DOMElementExtensions.setVisible(this.EF,!1)};qd.prototype.Ycd=function(J){if(De.DOMElementExtensions.Yy(J.Sb,"a"))return null;var oa=this.Def(J.Ea);if(oa&&this.grid.ha.va.Dh){var Va=
this.grid.ha.va.Qd;Va=this.hf.Ds(Oi.Range.ld(Va.bottom,Va.right))}else Va=this.hf.uua(J.Sb);if(!Va)return null;var Ub=Va.EJ(),e=new Sys.UI.Bounds(Ub.offsetLeft,Ub.offsetTop,Ub.offsetWidth,Ub.offsetHeight),C=De.DOMElementExtensions.getBoundingClientRect(J.Sb);C=new Sys.UI.Point(J.clientPoint.x-C.x,J.clientPoint.y-C.y);this.isRow&&!oa&&(C.y+=li.HelperMethods.sA(J.Sb,Ub,this.rtl).y);return new cc(Ub,C,e,Va.getRange(),Math.max(qd.Qsi,Math.min(qd.Bri,(this.isRow?e.height:e.width)*qd.l$i)),oa,!this.isRow&&
0<Ub.getElementsByTagName("input").length)};qd.prototype.ypd=function(J,oa){oa=void 0===oa?!1:oa;if(!J||this.grid.isEditing)return!1;if(J.Cef)return!0;var Va=J.BNa,Ub=J.Bab,e=this.hf.sj.paneType,C=this.grid.fg(e).Ph,M=!!C&&C.top===J.qhd.top,ra=!!C&&C.left===J.qhd.left;e=!!C&&C.bottom===J.qhd.bottom&&(3===e||2===e);this.isRow?(ra=J.SAb.y,J=ra<=Ub&&!M,Va=ra>=Va.height-Ub-(e?qd.Wyh:0),oa=oa?J:Va||J):(e=J.wZh,M=this.rtl,C=J.SAb.x,J=C<=Ub&&(!ra||M)&&(!e||!M),Va=C>=Va.width-Ub&&(!M||!ra)&&(!e||M),oa=oa?
M?Va:J:J||Va);return oa};qd.prototype.EOg=function(J,oa){var Va=this.isRow;if(J.Cef)this.Dr=this.hf.uua(J.jva);else if(Va&&J.SAb.y<=J.Bab&&J.BNa.height>J.Bab||!Va&&J.BNa.width>J.Bab&&(!this.rtl&&J.SAb.x<=J.Bab||this.rtl&&J.SAb.x>=J.BNa.width-J.Bab)){if(this.Dr=J.jva.previousSibling?this.hf.uua(J.jva.previousSibling):this.sLh(),oa&&J.jva.classList.contains(Va?Bj.a.XNe:Bj.a.WNe)&&(J=this.hf.uua(J.jva)))J=J.getRange(),this.x6=Va?new Oi.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Oi.Range(J.top,J.left-
1,J.bottom,J.left-1,!1,!0)}else this.Dr=this.hf.uua(J.jva);!this.x6&&this.Dr&&(this.x6=this.Dr.getRange())};qd.prototype.sLh=function(){var J=this.isRow?1:0;return(J=this.hf.sj.JF(this.hf.sj.Ca.Eg(this.grid.$.oa,rk.a.YL(this.hf.position.X+J-1,this.hf.position.Y-J,this.hf.position.PaneType))))?J.rLh():null};qd.prototype.j5h=function(){var J=this.m$i;De.DOMElementExtensions.setVisible(J,!0);J.style.cursor=this.isRow?Bj.a.iLe:Bj.a.aKe;this.DPd()};qd.prototype.Bgh=function(J){var oa={};this.grid.$.Ce(this.isRow?
745189930:-445963340,$c.a.Wb,30,(oa.resizeRowColumnParameters=J,oa))};qd.prototype.Z5g=function(){var J=document.createElement("div");J.className=Bj.a.dnh;var oa=document.createElement("div");oa.className=L.a.OB;J.appendChild(oa);var Va=document.createElement("img");Va.src=Qk.a.Be(0);Va.className=this.isRow?L.a.omh:L.a.lmh;oa.appendChild(Va);this.hf.HB.domElement.parentNode.insertBefore(J,this.hf.HB.domElement);bj.a.instance.pa(Je.a.pointerDown,J,this.iN);Ph.a.instance.pa(Je.a.Ij,J,this.Nba);De.DOMElementExtensions.setVisible(J,
!1);this.EF=J};qd.prototype.rqc=function(){this.MZc();this.EF&&(this.hf.HB.domElement.parentNode.removeChild(this.EF),this.EF=null)};qd.prototype.Def=function(J){return De.DOMElementExtensions.Ye(this.EF,J.target)};qd.prototype.Aob=function(){this.Zaa&&(this.zIe(),De.DOMElementExtensions.KSa(this.Dr.EJ(),!this.isRow,this.yHb),this.rqc(),this.nVa=!1)};qd.prototype.Naf=function(){return Ag.EwaSettings.la(709)};qd.prototype.N6e=function(J){(J=J.Ea.rawEvent)&&J.detail===qd.Pdj&&(J.type===Je.a.Mp?(this.Zaa=
!1,this.SVc=!0):J.type===Je.a.AH&&(this.Zaa=!0,this.SVc=!1))};qd.b2g=function(J,oa){return new qd(J,oa)};qd.qei=function(J,oa){if(!J||!J.EJ())return ud.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Va=J.getRange();J=J.EJ().style;if(!Va||!J)return ud.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;J=oa?J.height:J.width;return(oa?Va.top:Va.left)===(oa?Pf.a.Fh:Pf.a.Qh)&&J===qd.Pcg};qd.f2g=function(J,oa,Va){if(!J)return ud.ULS.shipAssertTag(537154012,
2,!1,"header after hidden is null"),null;var Ub=J.EJ();if(!Ub||!Ub.style)return ud.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;J=document.createElement("div");var e=Ub.style;J.style.top=oa?e.top:qd.Pcg;oa||(Va?J.style.right=e.right:J.style.left=e.left);J.classList.add(oa?Qd.qmh:Qd.pmh);J.classList.add(oa?Bj.a.ksb:Bj.a.jsb);Va=document.createElement("div");Va.classList.add(oa?Bj.a.LNe:Bj.a.t8c);Ub=oa?Number.parseInvariant(Ub.innerText):Oi.Range.WZa(Ub.innerText);
Va.innerText=oa?(Ub-1).toString():Oi.Range.rY(Ub-1);J.appendChild(Va);return J};qd.CMd=function(J,oa,Va){if(oa)for(J.ColumnWidth=-1,J.RowHeight=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(J.RowHeight=-1,J.ColumnWidth=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};tl.Object.defineProperties(qd.prototype,{hdf:{configurable:!0,enumerable:!0,get:function(){var J=(new oi.a(this.grid.$.xa)).te(this.isRow?
16:8),oa=this.grid.$.Ab.XJ,Va=this.grid.zi,Ub=Kb.a(this.grid.$).sq();return J&&!oa&&!Va&&!Ub}},m$i:{configurable:!0,enumerable:!0,get:function(){this.jhh();return qd.Cab}}});qd.Qsi=0;qd.Bri=5;qd.Wyh=3;qd.l$i=.1;qd.BPf="ewa-rszrbg";qd.Pcg="0px";qd.Pdj=2;qd.Cab=null;Object(Ze.a)(qd,"HeaderResizeBehavior",Sj.a,[]);var Ek=sd.a;vm(Yd,Ek);Yd.prototype.create=function(){this.Fb(qd.b2g)};Yd.ja=function(J){J.da.Ha(136,new Yd)};Object(Ze.a)(Yd,"HeaderResizeBehaviorFactory",sd.a,[]);var vk=b(179),Fj=b(415),
sj=b(519),Kj=b(67);Object(Ze.a)(Kd,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[98]);Object(Ze.a)(bd,"MacroRecorderSheetRowsColumnsResizedPayload",null,[98]);var Zi=Ad.a;vm(Ac,Zi);Ac.prototype.LU=function(J,oa){var Va={};return Va[Ac.w4]=this.xc,Va[Ac.Cei]=this.isRow,Va[Ac.I3h]=J,Va[Ac.H3h]=oa,Va[Ac.Ibi]=this.Ayb,Va[Ac.ldd]=this.iub,Va};Ac.prototype.dPg=function(){var J=this.aCh();try{return this.uGh(J)}finally{J&&J.dispose()}};Ac.prototype.G_g=function(J){var oa={};oa.SheetMultiRange=nh.r(this.gridView.ha.va.selectedRanges,
this.$);Ac.CMd(oa,this.isRow,J);J={};this.$.Ce(this.isRow?745189930:-445963340,$c.a.Wb,8,(J.resizeRowColumnParameters=oa,J))};Ac.prototype.S0e=function(J,oa){return Fc.a.iV(J)?oa?this.sZg(J):this.uZg(J):Ac.Laa};Ac.prototype.uZg=function(J){return Math.floor(parseFloat(J))};Ac.prototype.sZg=function(J){J=parseFloat(J);return 0>J?Ac.Laa:J?this.isRow?li.HelperMethods.lRi(J):this.Prc.wVg(J):0};Ac.prototype.vZg=function(J){return J===Ac.Laa?"":this.isRow?this.Prc.Aze(J).toString():this.Prc.rze(J).toFixed(2)};
Ac.prototype.tZg=function(J){return J===Ac.Laa?"":J.toString()};Ac.prototype.uGh=function(J){if(!J||!J.$$mn()||!J.Vn)return Ac.Laa;var oa=Object(Ug.a)(660,J.Vn);if(!oa)return Ac.Laa;for(oa=this.isRow?oa.Fwb:oa.Ajd;J.$$mn();){var Va=Object(Ug.a)(660,J.Vn);if(Va&&(this.isRow?Va.Fwb:Va.Ajd)!==oa)return Ac.Laa}return oa};Ac.prototype.aCh=function(){for(var J=[],oa=yl(this.gridView.ha.va.selectedRanges),Va=oa.next();!Va.done;Va=oa.next()){Va=Va.value.clone();var Ub=this.gridView.fg(this.gridView.$a.Kj(Va));
Ub=Va.Jf(Ub.Ph);if(!Ub)return null;this.isRow?Va.right=Va.left=Ub.left:Va.top=Va.bottom=Ub.top;Array.add(J,Va)}return J.length?this.gridView.l$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",J):null};Ac.prototype.mdd=function(J){if(!Fc.a.iV(J))return 1;J=this.S0e(J,this.Ayb);return!J&&this.oei()?3:this.bhi(J)?0:2};Ac.prototype.oei=function(){var J=this.gridView.ha.va.selectedRanges;return this.isRow&&nh.P(J)||!this.isRow&&nh.O(J)};Ac.prototype.Jad=function(J){var oa="";switch(J){case 0:oa=
"";break;case 1:oa=nf.a.instance.ea(751);break;case 2:J=this.Ayb;oa=String.format(nf.a.instance.Cb(98),0,this.aac(J));break;case 3:oa=nf.a.instance.ea(752)}return oa};Ac.prototype.bhi=function(J){return 0<=J&&J<=this.aac(!1)};Ac.prototype.aac=function(J){return this.Prc.aac(J,this.isRow)};Ac.CMd=function(J,oa,Va){if(oa)for(J.ColumnWidth=Ac.Laa,J.RowHeight=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(J.RowHeight=Ac.Laa,J.ColumnWidth=
Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};tl.Object.defineProperties(Ac.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},Ayb:{configurable:!0,enumerable:!0,get:function(){return Ac.i7d},set:function(J){Ac.i7d=J}}});Ac.w4="id";Ac.Cei="isRow";Ac.I3h="initialSizeInPx";Ac.H3h="initialSizeInDefaultUnits";Ac.Ibi="isInitialUnitsDefaultUnits";Ac.ldd="getInputErrorIfInvalid";Ac.zuj="size";Ac.B$h="isDefaultUnits";
Ac.Laa=-1;Ac.i7d=!0;Object(Ze.a)(Ac,"ResizeHeadersDialog",Ad.a,[]);var gk=b(586);dc.prototype.Xc=function(J,oa){J=!0;switch(oa){case -445963340:case 1391094586:J=this.te(8);break;case 745189930:case 146338636:J=this.te(16)}return!J};dc.prototype.executeCommand=function(J,oa,Va){var Ub=mc.TaskExtensions.om();var e=Oa.g(this.$);J=vk.a.create().toString();var C=oa.command;switch(C){case 1391094586:case 146338636:var M=1391094586===C;(J=Va.autoFitRanges)&&J.Ranges&&J.Ranges.length||(J=nh.r(e.ha.va.selectedRanges,
this.$));Ub=this.dch(M?1:0,J,oa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:M=-445963340===C||-706918724===C||369708605===C;if(-445963340===C||745189930===C)M=Fj.a(oa.command),e.Ji.X6(16,J,M),Va=Va.resizeRowColumnParameters;else{var ra=e.ha.va.selectedRanges;if(-706918724===C&&6===oa.df&&nh.O(ra)){ud.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===
C&&6===oa.df&&nh.P(ra)){ud.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}e=369708605===C||1542466017===C?-2:0;Va={};Va.SheetMultiRange=nh.r(ra,this.$);if(M)for(Ub=yl(Va.SheetMultiRange.Ranges),C=Ub.next();!C.done;C=Ub.next())C=C.value,C.FirstRow=0,C.LastRow=0;else for(Ub=yl(Va.SheetMultiRange.Ranges),C=Ub.next();!C.done;C=Ub.next())C=C.value,C.FirstColumn=0,C.LastColumn=0;Va.RowHeight=M?-1:e;Va.ColumnWidth=
M?e:-1}Ub=this.ych(Va,oa,J);break;case 957527587:case 2040891415:new Ac(this.$,oa)}return Ub};dc.prototype.Gc=function(J,oa,Va,Ub){if(J=!!Va&&!!Ub&&1===Ub.eA)switch(oa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:J=!1}return J};dc.prototype.fd=function(){return!1};dc.prototype.kni=function(J){ud.ULS.sendTraceTag(537154004,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",
J.success,Object(gk.c)(J)?void 0:J.reason)};dc.prototype.te=function(J){return(new oi.a(this.$.xa)).te(J)};dc.prototype.dch=function(J,oa,Va){function Ub(){return new Kd(M,oa)}var e=this,C=this.$.qa.ta.Xb(),M=!J;return oe.a(this.$.userOperationManager,function(ra,Na,Ib){var Gc=e.$.qa.ta,id=Gc.Oa(41,C);id.isRow=M;id.autoFitRanges=oa;return Le.i(Gc,"AutoFit",id,ra,Na,Ib,null,0)},function(ra){return new Ee.a(135,0,ra,void 0,Ub)},Va)};dc.prototype.ych=function(J,oa,Va){function Ub(){return new bd(J)}
var e=this,C=nh.g(J.SheetMultiRange.Ranges),M=oa.command;if(745189930===M||-445963340===M){ud.ULS.shipAssertTag(537154002,0,this.$.activeItemName===J.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var ra=Oa.g(this.$);M=745189930===M;ra=this.hi.Isj(ra,C,M?J.RowHeight:J.ColumnWidth,M);this.kni(ra);Object(gk.c)(ra)&&Oa.g(this.$).Ji.m0(Va,Kj.BasicTelemetryCalculator.sQ)}var Na=this.$.qa.ta.Xb(!0);return oe.a(this.$.userOperationManager,function(Ib,Gc,
id){e.$.Xu();nh.i(C,",",e.$,!1);var Uc=e.$.qa.ta;Ib=T.b(Ib,e.aJi);var Vd=Uc.Oa(41,void 0===Na?null:Na);Vd.resizeRowColumnParameters=J;return Le.i(Uc,"ResizeRowsColumns",Vd,Ib,Gc,id,Va,0)},function(Ib){return new Ee.a(136,0,Ib,void 0,Ub)},oa)};Object(Ze.a)(dc,"ResizeCommandHandler",null,[147]);var Rh=Ka.a;vm(mb,Rh);mb.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb);mc.TaskExtensions.Ba(oa,function(){J.Ed([new dc(J.$,oa.result)])},this.ma,3)};mb.ja=
function(J){Ka.a.de(113,new mb(J))};Object(Ze.a)(mb,"ResizeCommandHandlerFactory",Ka.a,[]);Aa.prototype.Xc=function(){return!1};Aa.prototype.executeCommand=function(J,oa,Va){J=2;switch(oa.command){case -309686558:J=this.Di.ze(Ng.a.saveACopy,2,Va);break;case 617689800:J=this.Di.ze(Ng.a.saveToCloudStorage,2,Va);break;case -1244760097:J=this.Di.ze(Ng.a.saveToSharePoint,2,Va)}return 2===J&&oa?Ed.a(oa.command):kb.Task.Ta(!0)};Aa.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case -1244760097:case -309686558:case 617689800:J=
!0,ud.ULS.shipAssertTag(537153984,0,this.$.Yja,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return J};Aa.prototype.fd=function(){return!1};Object(Ze.a)(Aa,"SaveToHostCommandHandler",null,[147]);var Ok=Ka.a;vm(uc,Ok);uc.prototype.Md=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Ed([new Aa(J.$,ld.AFrameworkApplication.Eb)])},this.ma,3);ld.AFrameworkApplication.Eb.$b(Ng.a.hQa,ph.a.frame,
this.Oxh)};uc.ja=function(J){Ka.a.de(267,new uc(J))};Object(Ze.a)(uc,"SaveToHostCommandHandlerFactory",Ka.a,[]);Hc.prototype.Xc=function(J){switch(J){case -309686558:return 8===this.Di.processAction(Ng.a.saveACopy,1,null);case 617689800:return 8===this.Di.ze(Ng.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Di.ze(Ng.a.saveToSharePoint,1,null)}return!1};Hc.prototype.dispose=function(){this.$=null};Object(Ze.a)(Hc,"SaveToHostManager",null,[567,3]);var wk=sd.a;vm(Jb,wk);Jb.prototype.create=
function(){this.Fb(this.$.da.Aa(393)||new Hc(this.$,ld.AFrameworkApplication.Eb))};Jb.ja=function(J){J.da.Ha(394,new Jb(J))};Object(Ze.a)(Jb,"SaveToHostManagerFactory",sd.a,[]);var Pk=Mj.a;vm($b,Pk);$b.prototype.execute=function(J){var oa=Object(Ug.a)(6,J.Ge);ud.ULS.shipAssertTag(537153921,0,vh.a.Zmb(J.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");oa.KH(!0,!0);J.activityState[cg.a.UWb]=oa.fa.sessionId;J.activityState[cg.a.Jlb]=!0;J.activityState[cg.a.$Wb]=
!0;ud.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(Ze.a)($b,"SessionReloadActivity",Mj.a,[]);var lk=sd.a;vm(db,lk);db.prototype.create=function(){this.Fb(new $b(ge.a.ibb,ge.a.Dk))};db.ja=function(J){J.da.Ha(142,new db)};Object(Ze.a)(db,"SessionReloadActivityFactory",sd.a,[]);var Gj=b(52),Xj=b(260),xk=b(106),ak=b(46),Fk=b(244),hk=b(112),oj=Mj.a;vm(Ca,oj);Ca.prototype.execute=function(J){var oa=Object(Ug.a)(6,J.Ge);J.activityState[cg.a.Xqa]=
!0;var Va=Ca.JRh(J);if(Ca.voj(J,Va))return Ca.Qqi(J),Va=50,0<J.errors.length&&(Va=15),ud.ULS.sendTraceTag(537153891,0,Va,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",vh.a.Uc(J.errors)),J.activityState[cg.a.Xqa]=!1,this.ph(ge.a.idle),3;switch(Va){case 1:case 3:this.S5h(J,Va);break;case 2:this.R5h(J);break;case 0:J.activityState[cg.a.kXa]=null}ud.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",
Va,this.activityName,this.i_,oa.fa.i7);var Ub=rj.a.ug(J.activityState,hk.a.udb);ud.ULS.shipAssertTag(40502925,0,!Ub||Ub&&(1===Va||3===Va),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",Ub,Va);oa=oa.Mk.reloadCount;return Va&&0<oa?(Ub=Xj.a.Qua(oa,200),ud.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Va,oa,Ub,this.activityName),ej.a.instance.create(function(){Ca.kJ(J)},Ub,gj.a.Dgj),
1):3};Ca.prototype.S5h=function(J,oa){ud.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Va=Object(Ug.a)(6,J.Ge);J.activityState[cg.a.Jlb]=!0;Va.Vdc||ak.PageLoadTrackingInfo.instance.Fj("ReopenOnLoad");!Ca.isEditMode(J)&&vh.a.Zmb(J.errors)&&(ud.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),J.activityState[cg.a.UWb]=Va.fa.sessionId,J.activityState[cg.a.$Wb]=
!0);J.ztd();3===oa?(Va.fa.Qg()||Va.fa.zwi(),Va.KH(!0,!0),this.ph(this.xDj),J.activityState[cg.a.oie]=Va.workbookContext.CalcMode):(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===oa&&Va.KH(!0,!0),J.activityState[cg.a.XRc]=!1,this.ph(this.gwc))};Ca.prototype.R5h=function(J){ud.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");J.activityState[cg.a.kXa]=null;J.ztd();this.ph(this.suj);J=Object(Ug.a)(6,
J.Ge);J.Vdc||(ak.PageLoadTrackingInfo.instance.Fj("RefreshOnLoad"),J.AGb())};Ca.kJ=function(J){J.kJ()};Ca.JRh=function(J){var oa=Object(Ug.a)(6,J.Ge),Va=oa.fa,Ub=Ca.isEditMode(J),e=vh.a.hh(J.errors,Ub?Ca.mtd:Ca.ntd),C=vh.a.hh(J.errors,Ub?Ca.Xkf:Ca.Ykf),M=oa.tQ,ra=oa.Mk.reloadCount,Na=oa.ya.MaxConsecutiveSilentReloadAllowed,Ib=oa.Mk.v4e(),Gc=vh.a.Uc(J.errors),id=vh.a.Uc(J.Fya),Uc=0<vh.a.hM(function(Gf){return!Gf.triggerSilentReopenOnly},J.errors).length,Vd=e,Ye=rj.a.ug(J.activityState,hk.a.udb);Ye&&
(Vd=!0);e={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Ub,isSilentReopenError:e,isSilentRefreshError:C};e.reloadSequenceCount=oa.Mk.uPa;e.reloadCount=ra;e.maxReloads=Na;e.stopSilentReloads=Ib;e.errorNames=Gc;e.processedErrorNames=id;e.isClientDirty=M;e.errorsForSilentReopenOnly=Uc;e.triggerSilentReloadAfterTokenRefresh=Ye;e.IsReopenDisabled=oa.WLa;M=Gj.a.Hc(e);ud.ULS.sendTraceTag(21837004,0,50,M);if(!Ib){if(Vd&&(Ub?Ca.loj(J):Ca.noj(J)))return Fk.a.EYf(J,oa)?3:oa.WLa?2:1;if(C&&
(Ub||!Va.t$a))return 2}return 0};Ca.voj=function(J,oa){for(var Va=yl(J.errors),Ub=Va.next();!Ub.done;Ub=Va.next())if(Ub=Ub.value,-1337545025===Ub.MessageId||-238814601===Ub.MessageId)return!1;return vh.a.hM(function(e){return!e.triggerSilentReopenOnly},J.errors).length?3!==oa:!1};Ca.Qqi=function(J){var oa=vh.a.hM(function(Ub){return!Ub.triggerSilentReopenOnly},J.errors);oa=yl(oa);for(var Va=oa.next();!Va.done;Va=oa.next())J.Oka(Va.value)};Ca.isEditMode=function(J){var oa=Object(Ug.a)(6,J.Ge);return oa.fa.oc?
oa.Ju&&!!(oa.Fd&64):rj.a.ug(J.activityState,cg.a.rs)};Ca.noj=function(J){var oa=Object(Ug.a)(6,J.Ge),Va=vh.a.K$(J.errors,Ca.ntd);if(xk.b(Va,function(Ub){return Ub.ForceVersionUpgrade}))return!1;J=vh.a.Zmb(J.errors);return!oa.fa.t$a||J?!0:!1};Ca.loj=function(J){J=vh.a.K$(J.errors,Ca.mtd);return!xk.b(J,function(oa){return oa.ForceVersionUpgrade})};Ca.ntd=null;Ca.mtd=null;Ca.Ykf=null;Ca.Xkf=null;Object(Ze.a)(Ca,"SessionReloadSilentActivity",Mj.a,[]);var Gk=sd.a;vm(Wa,Gk);Wa.prototype.create=function(){this.Fb(new Ca(this.activityName,
this.$L,ge.a.Dk,ge.a.lj,ge.a.ILb))};Wa.ja=function(J){J.da.Ha(143,new Wa(ge.a.Hma,ge.a.LZb));J.da.Ha(144,new Wa(ge.a.Ktc,ge.a.kOa));J.da.Ha(145,new Wa(ge.a.Ltc,ge.a.Tzd));J.da.Ha(154,new Wa(ge.a.jbb,ge.a.kO))};Object(Ze.a)(Wa,"SessionReloadSilentActivityFactory",sd.a,[]);Za.prototype.getSheetName=function(){return this.sheetName};Za.prototype.getValue=function(){return this.value};Object(Ze.a)(Za,"MacroRecorderSheetOptionToggledPayload",null,[98]);jb.prototype.Xc=function(){return!1};jb.prototype.executeCommand=
function(J,oa){function Va(){return new Za(Ub.SheetName,Ib)}var Ub={};this.$.wj(Ub);J=oa.command;var e=Object(Ug.a)(tf.a,this.$.xa.getItemByName(Ub.SheetName));if(!e)return Ed.a(J);switch(J){case 705559150:case -1411193626:var C=16;var M=!e.hideGridLines;var ra=ec;var Na=183;var Ib=e.hideGridLines;break;case -2052321504:case 515737500:C=4;M=!e.headersVisible;ra=Yb;Na=184;Ib=!e.headersVisible;break;case -1478455630:C=2;M=!e.displayRtl;ra=$a;Na=185;Ib=!e.displayRtl;Oa.g(this.$).Ca.nIj(M);break;default:return Ed.a(J)}e.Iob(C,
M);var Gc=this.$.qa.ta;return oe.a(this.$.userOperationManager,function(id,Uc,Vd){return ra(Gc,Ub.SheetName,Ib,T.b(id,function(Ye){jb.fDb(Ye,e,C,M)}),T.a(Uc,function(){jb.iCb(e,C,M)}),Vd,null)},function(id){return new Ee.a(Na,0,id,void 0,Va)},oa)};jb.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case -1411193626:case 515737500:case -1478455630:J=!0;break;case 705559150:case -2052321504:J=uk.a(this.$)}return J};jb.prototype.fd=function(){return!1};jb.fDb=function(J,oa,Va,Ub){vh.a.Pq(J.Errors)&&
oa.Iob(Va,!Ub)};jb.iCb=function(J,oa,Va){J.Iob(oa,!Va)};Object(Ze.a)(jb,"SheetOptionsToggleCommandHandler",null,[147]);var Gg=Ka.a;vm(Ua,Gg);Ua.prototype.Md=function(){this.Ed([new jb(this.$)])};Ua.ja=function(J){Ka.a.de(100,new Ua(J))};Object(Ze.a)(Ua,"SheetOptionsToggleCommandHandlerFactory",Ka.a,[]);var Hk=b(59),Ik=b(203),yk=Ik.a;vm(Ga,yk);Ga.prototype.initialize=function(){var J=this.$.Ib+"iframeDialog_frame",oa=this.$.Ib+"iframeDialog";var Va=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',
J,this.QWe(oa));this.Ob.style.margin=li.HelperMethods.Qb(0);this.Ob.style.marginBottom=li.HelperMethods.Qb(-2);this.Ob.innerHTML=Va;this.SHc=document.getElementById(J);this.domElement.id=oa;this.onResize(null,Sys.EventArgs.Empty);Rg.a.hfc&&ej.a.instance.create(this.Ngh,50,gj.a.Z0h,!0,!0);yk.prototype.initialize.call(this)};Ga.prototype.dispose=function(){this.$&&this.$.RC(this.onResize);yk.prototype.dispose.call(this)};Ga.prototype.setFocus=function(){De.DOMElementExtensions.setFocus(this.GKa)};Ga.prototype.onHide=
function(){this.GKa.contentWindow.close();De.DOMElementExtensions.Sf(this.GKa);this.SHc=null;yk.prototype.onHide.call(this)};Ga.prototype.XIj=function(J){var oa=this.domElement.style;oa.width=li.HelperMethods.Qb(J.x);oa.marginLeft=li.HelperMethods.Qb(-J.x/2)};Ga.prototype.xKh=function(){var J=De.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*J.width),this.XDe.x),Math.min(Math.floor(.9*J.height),this.XDe.y))};tl.Object.defineProperties(Ga.prototype,{GKa:{configurable:!0,
enumerable:!0,get:function(){return this.SHc}}});Object(Ze.a)(Ga,"IFrameDialog",Ik.a,[]);vm(Ha,Ga);Ha.prototype.QWe=function(J){var oa=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);fi.a.Vf(oa,ab.a.Sih,J);Zd.a(this.$.ya,34)&&fi.a.Vf(oa,ab.a.bKe,"1");Zd.a(this.$.ya,35)&&fi.a.Vf(oa,ab.a.cKe,"1");return oa.toString()};Ha.prototype.onShow=function(){ud.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");Ga.prototype.onShow.call(this)};tl.Object.defineProperties(Ha.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(Ze.a)(Ha,"EmbeddingDialog",Ga,[]);bb.UXf="FrameDialog_ShareFromEdit";bb.view="FrameDialog_View";bb.Mwe="FrameDialog_CloseAndRefresh";bb.wnj="FrameDialog_ShareFromView";bb.edit="FrameDialog_Edit";bb.M_i="FrameDialog_RefreshGrid";bb.SUg="FrameDialog_CloseMe";bb.Wwe="FrameDialog_CloseMeError";bb.ready="FrameDialog_Ready";bb.kRi="FrameDialog_PleaseClose";bb.TG="GotoRange";Object(Ze.a)(bb,"PostMessageConstants",null,[]);
var bk=b(105);Object(Ze.a)(ka,"SessionUpdateContext",null,[]);vm(Nb,Ga);Nb.prototype.XAg=function(J){this.addHandler(Nb.grd,J)};Nb.prototype.b5i=function(J){this.removeHandler(Nb.grd,J)};Nb.prototype.dispose=function(){Kg.a.Fa(this.G_a);this.G_a=null;Ga.prototype.dispose.call(this)};Nb.prototype.initialize=function(){Ga.prototype.initialize.call(this);var J=ub.a.laa(this.$.ya.FormLightBoxUrl),oa=this.G_a=new K.a(this.GKa.contentWindow,J);oa.isEnabled()&&oa.TEa(J)&&(this.Zla(bb.UXf,this.Umc),this.Zla(bb.view,
this.Umc),this.Zla(bb.Mwe,this.Umc),this.Zla(bb.wnj,this.oKi),this.Zla(bb.edit,this.gCi),this.Zla(bb.M_i,this.Umc),this.Zla(bb.ready,this.GIi),this.Zla(bb.SUg,this.Urf),this.Zla(bb.Wwe,this.Urf))};Nb.prototype.close=function(J){J===this.closeAction&&this.vbf&&this.G_a.send(new uj.a(bb.kRi))||Ga.prototype.close.call(this,J)};Nb.prototype.QWe=function(){return this.YAe(this.Xfc)};Nb.prototype.YAe=function(J){var oa=this.$.ya,Va=new Sys.StringBuilder(oa.FormLightBoxUrl);fi.a.Vf(Va,ab.a.kyh,this.$.fa.sessionId);
fi.a.Vf(Va,ab.a.iyh,J?ab.a.jyh:ab.a.hyh);wi.a.yFa(Va,oa);return Va.toString()};Nb.prototype.aag=function(J){this.fJc=!1;this.GKa.src=this.YAe(J);this.Y6d=J};Nb.prototype.Zla=function(J,oa){this.G_a.Pn(J);this.G_a.Km(J,oa)};Nb.prototype.Nlc=function(J){var oa=this.$.fa.xa.getItemByName(J.TG.SheetName);oa&&!oa.ey&&Oa.g(this.$).yi(J.TG,null,null,null,20,bk.a.Sxh)};tl.Object.defineProperties(Nb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},vbf:{configurable:!0,enumerable:!0,
get:function(){return this.fJc}},Xfc:{configurable:!0,enumerable:!0,get:function(){return this.Y6d}}});Nb.$8g=900;Nb.B8g=1200;Nb.grd="lightBoxReady";Object(Ze.a)(Nb,"FormDialog",Ga,[181]);var Sg;(function(J){J[J.comment=10]="comment";J[J.range=12]="range";J[J.table=13]="table";J[J.chart=14]="chart"})(Sg||(Sg={}));Object(Ze.b)("NavigationType",Sg);var zk=b(1018),Nj=b(114),cj=b(580),ck=b(1077),V=b(278),ua=b(852),ib=ua.a;vm(E,ib);E.prototype.initialize=function(){var J="<div class='"+Nj.a.xu+"'>\r\n\t<div class='"+
Nj.a.oKe+"'>\r\n\t\t<div class='"+L.a.c_c+"'>\r\n\t\t\t<img src='{0}' class='"+L.a.gNe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Nj.a.rKe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";J=String.format(J,Qk.a.Be(13),nf.a.instance.ea(25),nf.a.instance.ea(this.message));this.Ob.innerHTML=J;this.addButton(0,this.hyi);this.addButton(1);ib.prototype.initialize.call(this)};E.prototype.Uw=function(){return this.wXd};tl.Object.defineProperties(E.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"WebMethodConfirmationDialog"}},Cw:{configurable:!0,enumerable:!0,get:function(){return 1005}},fsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(Ze.a)(E,"WebMethodConfirmationDialog",ua.a,[]);var bc=zk.a;vm(vb,bc);vb.prototype.dispose=function(){this.BSa&&this.BSa.Jca(this.RAf);Kg.a.pc([this.textBox,this.oQa,this.BSa]);this.BSa=this.oQa=this.textBox=null;bc.prototype.dispose.call(this)};vb.prototype.initialize=function(){var J="<div class='"+
Nj.a.xu+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Nj.a.asb+"'>\r\n\t<input type='text' id='{1}' class='"+Nj.a.uU+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";J=String.format(J,nf.a.instance.ea(1226),"sfd_input","sfd_unshare",L.a.yu,nf.a.instance.ea(1227));this.Ob.innerHTML=J;this.textBox=new V.a(this.getElementById("sfd_input"));this.oQa=new ck.a(this.textBox.domElement);this.BSa=cj.a.create(this.getElementById("sfd_unshare"));
this.BSa.f2(this.RAf);this.textBox.text=nf.a.instance.ea(720);this.textBox.enabled=!1;this.textBox.readOnly=!Rg.a.Yg;this.addButton(1,10);bc.prototype.initialize.call(this)};vb.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){var e=J.$.qa.ta.Xb(),C=J.$.qa.ta;oa=J.Lia(oa);Va=J.daa(Va);e=C.Oa(1,e);return Le.i(C,"ShareForm",e,oa,Va,Ub,null,0)}};vb.prototype.Lx=function(J,oa,Va){this.textBox.text=J.Result;this.textBox.enabled=!0;De.DOMElementExtensions.setVisible(this.BSa.domElement,!0);
bc.prototype.Lx.call(this,J,oa,Va)};vb.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(J){}bc.prototype.setFocus.call(this)};tl.Object.defineProperties(vb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(Ze.a)(vb,"ShareFormDialog",zk.a,[]);var Kc=b(668),cd=b(130),zc=b(251),Mc=b(15),md=aa.a;vm(rc,md);rc.prototype.Xc=function(J,oa){J=this.$.workbookContext.FullDocumentInfo;switch(oa){case 353606613:case -1099009678:case 192430811:return!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.fa.isNamedObjectViewMode;case 869186573:return oa=zc.a()&&this.$.fa.jh.get(5),!J.FileSharingUrl&&!oa;case -1570751769:case 1986648902:return 131072!==(this.$.gM&131072);case 330035228:return!(this.Q1a(!0)&&this.jBc);case -509039657:return!(this.Q1a()&&this.jBc);case 1334518759:return!(this.Q1a()&&this.jBc&&this.Dte())}return!1};rc.prototype.executeCommand=function(J,oa,Va){J=this.$.workbookContext.FullDocumentInfo;var Ub=Ng.a.workflow,e=mc.TaskExtensions.om(),C=oa.command;if(C===Ub||-266099===
C)return this.eZh(oa,Ub,J);switch(C){case 1986648902:this.gXf();break;case -1570751769:this.QWh(oa);break;case 869186573:oa=Ng.a.vnj;e=ld.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Ub=null;(Ag.EwaSettings.la(581)||e)&&Va&&"CopyLink"===Va.SourceControlId?(Ub={},Ub[ch.a.YIb]="copy",oa=Ng.a.TXf):e&&Va&&"ManageAccess"===Va.SourceControlId?(Ub={},Ub[ch.a.YIb]="manageAccess",oa=Ng.a.xnj):Va&&"LinkToComment"===Va.SourceControlId&&(Ub={},Ub[ch.a.YIb]="copy",Ub[ch.a.VXf]=Va.navId,oa=Ng.a.TXf);e=this.o0f(J,
Ub);Zj.c(oa);break;case -1099009678:e=this.mNd(12,J);break;case 192430811:e=this.mNd(13,J);break;case 353606613:e=this.mNd(14,J);break;case -59906385:case 1197060601:this.rYh(oa,J);break;case 1305810481:this.V2e(!1,oa);break;case 330035228:this.V2e(!0,oa);break;case -509039657:this.deleteForm();break;case 1334518759:oa.uxb=!0;this.shareForm();break;case 710925581:pf.a.Qf.bvc("710925581")&&(e=mc.TaskExtensions.Ba(this.FJ.value,function(M){M.result.Qj(wg.a.conversation,{})},this.ma,3));break;case 327119921:this.HWh();
break;default:e=Ed.a(C)}return e};rc.prototype.Gc=function(J,oa){J=!1;oa=oa.command;if(oa===Ng.a.workflow)return!0;switch(oa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:J=!0;break;case 353606613:case -1099009678:case 192430811:J=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode}return J};rc.prototype.fd=
function(J,oa,Va){if("PopulateFormMenu"===oa){oa=this.jBc?this.Dte()?rc.esh:rc.fsh:rc.pvi;J=this.Sa.Lc();for(var Ub=0;Ub<oa.length;Ub++)Array.add(J.buttons,this.Sa.yb(oa[Ub]));oa=this.Sa.zp("Forms.Flyout");Array.add(oa.yc,J);Va.MenuItems=oa.JB();return!0}return!1};rc.prototype.eZh=function(J,oa,Va){return this.SJd&&J.command===oa?(this.QJd(J,-266099),mc.TaskExtensions.f4()):mc.TaskExtensions.Ba(this.FJ.value,function(Ub){eg.a(Ub.result,wg.a.workflow,null,Va.WorkflowPostMessage)||li.HelperMethods.sf(Va.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ma,3)};rc.prototype.Dte=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.fa.jh.get(26)};rc.prototype.HWh=function(){var J=vk.a.create().toString();ud.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+J);var oa=this.$.frame,Va=oa.E7a,Ub=this.$,e=new Ae.QueryStringBuilder(ld.AFrameworkApplication.ga.Ua("TeamsMeetingShareEndpoint"));e.Ei("deeplinkId",J);e.Ei("lm","deeplink");
J=e.Ei;var C={};var M=new Ae.QueryStringBuilder(ld.AFrameworkApplication.ga.Ua("TeamsAppSharingUrl"));M.Ei("auth","2");M.Ei("flight","officeunihost");M.Ei("source","TEAMS-ELECTRON.meetingStage.deeplink");var ra={};ra.fileType=Fg.a.W3(Ub.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);ra.objectUrl=Ub.workbookContext.FullDocumentInfo.WorkbookPath;ra.baseUrl=Ub.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Ub=Ub.workbookContext.WorkbookFileVersionId;for(var Na=decodeURIComponent(Ub);Ub!=
Na;)Ub=Na,Na=decodeURIComponent(Ub);0>Ub.indexOf("{")||0>Ub.indexOf("}")?(ud.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+Ub),Ub=""):Ub=Ub.substring(Ub.indexOf("{")+1,Ub.indexOf("}")).toLowerCase();ra.fileId=Ub;ra=yh.c(yh.c(ra));M.Ei("subEntityId",ra.substring(1,ra.length-1));C.appSharingUrl=M.toString();C.appId=ld.AFrameworkApplication.ga.Ua("TeamsAppId");C=JSON.stringify(C);J.call(e,"appContext",C);Va.call(oa,e.toString(),!0)};rc.prototype.QWh=
function(J){this.SJd?this.QJd(J,1986648902):this.gXf()};rc.prototype.V2e=function(J,oa){!J&&this.$.ya.SurveyRedirectUrl?this.tVi():(J=new Nb(this.$,J,oa),J.initialize(),J.nf())};rc.prototype.rYh=function(J,oa){var Va=this;this.SJd&&1197060601===J.command?this.QJd(J,-59906385):mc.TaskExtensions.Ba(this.FJ.value,function(Ub){Ub=Ub.result;Ub&&eg.a(Ub,wg.a.replyWithChanges,null,Va.$.fa.jh.get(8))||(Ub=new Sys.StringBuilder(oa.ReplyWithChangesUrl),fi.a.Vf(Ub,Rf.e,Rf.d),Vb.a.ntw(Ub.toString(),Va.$))},this.ma,
3)};rc.prototype.QJd=function(J,oa){var Va=this,Ub=Xg.a(this.$).nd.activityState,e=new Hj.a(oa,J.method,J.mode,J.df,J.tabName);Kb.a(this.$).Rs(new ic.a(ge.a.Qy,5,function(){Ub[tg.a.Kq]=ge.a.rRf;Ub[Kc.a.TRc]=e;Va.$.Mk.ty("SocialSharingSaveBeforeCommand");Va.$.Mk.Jje(e.command)}))};rc.prototype.gXf=function(){var J=this,oa=this.$.ya.DocumentHostInfo;oa.HostEmbeddedViewUrl||this.ute?this.f_f():this.$.ig.get(53)&&mc.TaskExtensions.Ba(this.FJ.value,function(Va){J.WFj(Va.result)||Vb.a.ntw(oa.FileEmbedCommandUrl,
J.$)},this.ma,3)};rc.prototype.WFj=function(J){return J.isEnabled()&&(this.tte||(this.tte=J.Km(wg.a.ste,this.Azi)))?J.Qj(wg.a.Pth,null):!1};rc.prototype.f_f=function(){if(Rg.a.Pr)Vb.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var J=new Ha(this.$);J.initialize();J.nf()}};rc.prototype.deleteForm=function(){var J=this.$,oa=new E(J,1231,1232,1224,function(Va,Ub,e){var C=J.qa.ta.Xb(),M=J.qa.ta;C=M.Oa(9,C);C.surveyId=null;return Le.i(M,"DeleteSurvey",C,Va,Ub,e,null,0)});oa.initialize();oa.nf()};rc.prototype.shareForm=
function(){var J=this,oa=this.$.workbookContext.FullDocumentInfo;if(this.$.fa.jh.get(26)){var Va=new vb(this.$);Va.initialize();Va.nf()}else mc.TaskExtensions.Ba(this.FJ.value,function(Ub){var e={};eg.a(Ub.result,wg.a.shareForm,(e[ch.a.wzj]=J.$.workbookContext.SurveyTitle,e),J.$.fa.jh.get(10))||Vb.a.ntw(oa.ShareFormCommandUrl,J.$)},this.ma,3)};rc.prototype.tVi=function(){var J=this.$;J.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var oa=new Sys.StringBuilder(J.ya.SurveyRedirectUrl);
fi.a.Vf(oa,"startupDialog","FormEdit");var Va=Xg.a(this.$),Ub=Va.nd.activityState;Ub[kg.a.U1]=oa.toString();Ub[kg.a.zL]=kg.a.gvd;this.$.Mk.ty("SocialSharingEnvironmentChange");Kb.a(J).Rs(new ic.a(ge.a.Qy,5,function(){var e=vh.a.jd(3,2,1276,1277,1278,554412057,"FossEnvironmentUnsupported");Va.nd.ft([e]);Ub[tg.a.Kq]=ge.a.Z8f}))};rc.prototype.Q1a=function(J){return(this.$.fa.isEditMode||(void 0===J?!1:J))&&this.$.fa.jh.get(25)&&zc.a()};rc.prototype.uRh=function(J){var oa=void 0===oa?null:oa;var Va=Oa.g(this.$).ha;
var Ub=this.$.xa.oa?Hk.d(this.$.xa.oa):null;if(!Ub)return ud.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Sg[J]),null;14===J?oa=this.TQh(Va):12===J?(oa=Va.Lha,oa=Fc.a.contains(oa,"!",!0)?oa.split("!")[1]:oa):13===J&&(Va=Va.va.selectedRanges,Va[0]&&(Va=Oa.g(this.$).Vb.vk(Va[0])))&&(oa=Va.pj);if(!oa)return ud.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",
Sg[J]),null;Va={};Va[ch.a.YIb]="copy";Va[ch.a.VXf]=this.aIh(J,oa,Ub);ud.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Sg[J],oa,Ub);return Va};rc.prototype.TQh=function(J){if(J.Qa.Qaa&&(J=J.Qa.nc.floatingObject)&&!J.type){var oa=J.id.split(".");if(1<oa.length)return oa[1];ud.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",
J.id)}return null};rc.prototype.aIh=function(J,oa,Va){J=btoa(J+"_"+oa+"_"+Va);J=J.replace(RegExp("\\+","g"),"-");J=J.replace(RegExp("\\/","g"),"_");return J=J.replace(RegExp("\\=+$","g"),"")};rc.prototype.o0f=function(J,oa){var Va=this;return mc.TaskExtensions.Ba(this.FJ.value,function(Ub){eg.a(Ub.result,wg.a.sharing,oa,Va.$.fa.jh.get(5))?ud.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",oa?oa[ch.a.YIb]:""):li.HelperMethods.sf(J.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)};rc.prototype.mNd=function(J,oa){if(!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1))return null;var Va=this.uRh(J);if(Va)return this.o0f(oa,Va);ud.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Sg[J]);return null};tl.Object.defineProperties(rc.prototype,{jBc:{configurable:!0,enumerable:!0,get:function(){return gc.b(this.$.kg)}},
SJd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.fa.teh||this.$.tQ)}}});rc.pvi=[103];rc.esh=[107,104,105,106];rc.fsh=[104,105];rc.DRg=[new Mc.a(ge.a.Uwe,554412057,0,0,1279),new Mc.a(ge.a.idle,554412057,0,1)];Object(Ze.a)(rc,"SocialSharingCommandHandler",aa.a,[147]);var Nd=Ka.a;vm(pb,Nd);pb.prototype.Md=function(){var J=this,oa=new hg.a(function(){return qc.GetServiceTaskFactory.create(J.$.da,137,J.ma,J.tb)});mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.tb),function(Va){J.Ed([new rc(J.$,Va.result,oa)])},this.ma,3)};pb.ja=function(J){Ka.a.de(114,new pb(J))};Object(Ze.a)(pb,"SocialSharingCommandHandlerFactory",Ka.a,[]);Object(Ze.a)(fb,"MacroRecorderRangeCustomSortedPayload",null,[98]);var Ud=b(1094),Oe=b(1095),of=b(973),Nf=b(876),Kf=b(202);eb.prototype.show=function(){var J=new Xb.StandardDialog;J.kc=11;J.Cc(1,nf.a.instance.ea(2059));J.Cc(2,nf.a.instance.ea(2060));J.d0f(nf.a.instance.ea(2058),nf.a.instance.Va(645),this.Ov)};eb.prototype.VMa=
function(J){ud.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",J)};Object(Ze.a)(eb,"ExpandSortSelectionDialog",null,[]);vd.isValid=function(J){return Array.contains(vd.ssh,J.Position)?!0:(ud.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",J.Position),!1)};vd.ssh=[0,.5,1];Object(Ze.a)(vd,"FillGradientStopExtension",null,[]);Object(Ze.a)(Pc,"GradientLine",null,[]);Zc.isValid=function(J){if(!(J.Degree.toString()in
Zc.qsh))return ud.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",J.Degree),!1;if(!J.GradientStops)return ud.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(J.GradientStops.length<Zc.Lsi||J.GradientStops.length>Zc.jri)return ud.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",J.GradientStops.length),!1;J=yl(J.GradientStops);for(var oa=J.next();!oa.done;oa=
J.next())if(!vd.isValid(oa.value))return!1;return!0};Zc.Lsi=2;Zc.jri=3;var ug={};Zc.qsh=(ug["0"]=new Pc(0,0,1,0),ug["180"]=new Pc(1,0,0,0),ug["90"]=new Pc(0,0,0,1),ug["270"]=new Pc(0,1,0,0),ug["45"]=new Pc(0,0,1,1),ug["225"]=new Pc(1,1,0,0),ug["135"]=new Pc(1,0,0,1),ug["315"]=new Pc(0,1,1,0),ug);Object(Ze.a)(Zc,"FillGradientExtension",null,[]);var qh=zf.a;vm(Ja,qh);Ja.prototype.YN=function(J,oa){if(1===J){var Va=nh.v(this.MAb,this.$);Oa.g(this.$).yi(Va,null,null,null,0,bk.a.Nvj)}Va={};Va=(Va.DialogButton=
J,Va.Location="dialog",Va);Cg.b(this.$).ae(yc.a.Pvj,Va,null,!0);qh.prototype.YN.call(this,J,oa)};Ja.prototype.jr=function(){qh.prototype.jr.call(this);var J=this.Mvj();this.kc=1;this.Cc(1,nf.a.instance.ea(2169));this.Kk(nf.a.instance.ea(2170),ta.a.ym(J),1,this.ZN)};Ja.prototype.Mvj=function(){return String.format(nf.a.instance.Cb(165),this.MAb.toString())};Ja.prototype.Nad=function(){var J=this.error.Description.split("_");return new Oi.Range(Number.parseInvariant(J[1])+1,Number.parseInvariant(J[2])+
1,Number.parseInvariant(J[3])+1,Number.parseInvariant(J[4])+1,!0,!1)};tl.Object.defineProperties(Ja.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(Ze.a)(Ja,"SortMergedCellsErrorDialog",zf.a,[]);var Eh=b(596),Yh=b(655),Fi=of.a;vm(Lb,Fi);Lb.prototype.dispose=function(){this.yec||(this.yec=!0,this.Z_b(),this.Z5=null,Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Pab.dispose(),this.Pab=null));Fi.prototype.dispose.call(this)};
Lb.prototype.iAh=function(J){var oa=this;return function(Va){if(Vg.b(Va,-901005882))Xg.a(oa.$).nd.AD(-901005882),oa.kDd();else if(Vg.b(Va,-569193796))Xg.a(oa.$).nd.AD(-569193796),oa.hide(),new Ja(oa.$,Va.Errors[0]);else if(Vg.a(Va))ud.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),oa.hide();else{Va=Va.Result;oa.$.wj(Va.SortRange);var Ub=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Va&&Ic(Va)&&Eb(Va)&&Mb(Va,Ub)?J(Va):oa.W4b(Lb.Ypb())}}};Lb.prototype.TAh=function(J,oa){var Va=this;return function(Ub,e){if(Va.yec)ud.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Ub||Vg.a(Ub))ud.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",vh.a.Uc(Ub.Errors)),Va.$.fa.Yo(Ub.Errors),Va.hide();else{Ub=
Ub.Result;var C=J.RangeType,M=J.HeaderRowSize,ra=J.SortTopToBottom;Ub&&rb(Ub,J.ConditionType)&&Tc(Ub,C,M,ra)?(Ub.ColumnInfo.ColumnOffset=e,void 0!==Ub.HeaderColumnInfo&&null!==Ub.HeaderColumnInfo&&(Ub.HeaderColumnInfo.ColumnOffset=e),oa(Ub,J.ConditionType,J.SortTopToBottom)):(ud.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Va.W4b(Lb.Ypb()))}}};Lb.prototype.Mpj=function(J){return!!this.namedSheetViewPublic&&
(!J||3===J)};Lb.prototype.V1g=function(J){var oa={};oa.SelectedRange=this.selectedRange;oa.ActiveCell=this.hnc;oa.SortInfoMode=J;oa.ExpandSortSelection=this.GPg;oa.ExpandSortSelectionSupported=!0;return oa};Lb.prototype.xsa=function(J){var oa={};oa[bi.a.Ly]=this.xc;oa.fromAutoFilter=J.FromAutoFilter;oa.gridRTL=Oa.g(this.$).rtl;oa.activeCell=J.ActiveCell;oa.selectedRange=J.SelectedRange;oa.invokeGetSortInfo=this.O7h;oa.invokeGetSortConditionColorsOrIcons=this.N7h;oa.highlightSortRange=this.t0h;oa.getColorName=
this.getColorName;return oa};Lb.prototype.Yna=function(J,oa){J=nh.D(J);this.ha.va.Qd.equals(J)||this.ha.updateSelection(J,nh.C(oa),0,void 0,void 0,void 0,!0)};Lb.prototype.kDd=function(){var J=this;(new eb(function(oa){var Va={};Va.ActiveCell=J.hnc;Va.SelectedRange=J.selectedRange;Va.ExpandSelection=oa;Va.FromAutoFilter=!1;oa={};J.$.Ce(-207540907,$c.a.Wb,8,(oa.SortCommandData=Va,oa))})).show()};Lb.prototype.Z_b=function(){if(void 0!==this.Z5&&null!==this.Z5)for(var J=yl(this.Z5),oa=J.next();!oa.done;oa=
J.next())this.$.qa.ta.Cdb(oa.value.kt)};Lb.AHf=function(J,oa){var Va={};J.Ce(1659552324,$c.a.Wb,8,(Va.CustomSortCommandData=oa,Va))};Lb.Ypb=function(){return vh.a.jd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};tl.Object.defineProperties(Lb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return Oa.g(this.$).ha}}});Object(Ze.a)(Lb,"CustomSortDialog",of.a,[]);var Qh=b(1183);Ra.prototype.getSelection=function(){return this.selection};
Object(Ze.a)(Ra,"MacroRecorderRangeAutoFilterClearedPayload",null,[98]);Object(Ze.a)(Sa,"MacroRecorderRangeFilterReappliedPayload",null,[98]);var Wh=b(901),gh=b(902),zh=b(132);Tb.prototype.Xc=function(J,oa){return!this.cod(J,oa)};Tb.prototype.executeCommand=function(J,oa,Va){J=null;var Ub=oa.command;switch(Ub){case -864298118:J=this.kch(oa,Va);break;case -1010737776:J=this.v5c(!0,oa,Va);break;case 2123420468:J=this.v5c(!1,oa,Va);break;case -207540907:case -1677817820:J=this.gridView.Vb.R4(this.gridView.ha.va.activeCell)?
this.uVi():this.rVi(oa,Va);break;case 1659552324:J=this.hch(oa,Va);break;case 368460465:J=this.Ach(oa);break;case 529856798:J=this.ech(oa);break;case 644342024:J=this.vch(oa)}return J||Ed.a(Ub)};Tb.prototype.Gc=function(J,oa){if(J=1===J)switch(oa.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;default:J=!1}return J};Tb.prototype.fd=function(){return!1};Tb.prototype.ha=function(){return this.$&&
this.gridView?this.gridView.ha:null};Tb.prototype.fKf=function(J){J?this.gridView.Nq(this.onContentReady):this.gridView.Us(this.onContentReady);this.o$e=J};Tb.prototype.Oqj=function(J){return!!this.sortOptions&&Fc.a.equals(this.Igf,J.Lha,!0)};Tb.prototype.cod=function(J,oa){var Va=Oa.g(this.$).ha.va.selectedRanges;return(new oi.a(this.$.xa)).xn(J,oa,Va,this.gridView)};Tb.prototype.v5c=function(J,oa,Va){var Ub={OperationType:0};Ub.IsAscending=J;Ub.HasHeader=!0;Ub.GuessHeader=!0;Ub.SortTopToBottom=
!0;Ub.ExpandSortSelectionSupported=!0;Va&&void 0!==Va[Tb.DRa]&&null!==Va[Tb.DRa]?(Va=Va[Tb.DRa],Ub.ActiveCell=Va.ActiveCell,Ub.SelectedRange=Va.SelectedRange,Ub.ExpandSortSelection=Va.ExpandSelection):(Ub.ActiveCell=nh.o(this.ha().va.activeCell,this.$),Ub.SelectedRange=nh.v(this.ha().va.Qd,this.$),Ub.ExpandSortSelection=null);return this.Jod([nh.D(Ub.SelectedRange)])?this.gridView.Vb.R4(nh.D(Ub.SelectedRange))?this.sch(J):this.o9e(Ub,oa):mc.TaskExtensions.om()};Tb.prototype.kch=function(J,oa){var Va=
null,Ub=this.ha();Ub&&(this.Oqj(Ub)?this.Jod(Ub.va.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Va=this.o9e(this.sortOptions,J)):Va=this.v5c(!0,J,oa));return Va};Tb.prototype.Jod=function(J){return Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.xs(J,!0,1):this.$.bVc(J,!0,1):!0};Tb.prototype.sch=
function(J){this.jOh(J);return kb.Task.Ta(!0)};Tb.prototype.qMg=function(J){if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var oa=this.gridView.Vb.vk(this.ha().va.Qd,!1);if(oa){var Va=oa.name;oa=oa.usedRange;oa=this.ha().va.activeCell.left-oa.left;return new Oe.a(Va,oa,J.IsAscending)}}return new Ud.a(J)};Tb.prototype.o9e=function(J,oa){function Va(){return Ub.qMg(J)}var Ub=this;this.gridView.Bh.qG(!1);return this.IIe(function(e,C,M){return Da(Ub.$.qa.ta,
J,T.b(e,Ub.QKi),C,M,J)},function(e){return new Ee.a(141,0,e,void 0,Va)},oa,this.Lpj(J))};Tb.prototype.Lpj=function(J){if(!this.namedSheetViewPublic)return!1;var oa=this.ha().va.Qd,Va=nh.v(this.ha().va.Qd,this.$),Ub=this.gridView.Vb.TLa(oa,!0),e=this.ha().va.wwa()&&this.gridView.Vb.Ocf(Va),C=this.gridView.Vb.Ldi(Va);J=!oa.bba&&!oa.Y4||oa.isSingle||null!=J.ExpandSortSelection?J.ExpandSortSelection&&this.gridView.Vb.Ocf(Va):!1;return Ub||e||C||J};Tb.prototype.uVi=function(){return this.$.Ce(-1556797033,
$c.a.Wb,8,null)};Tb.prototype.rVi=function(J,oa){J=8===J.df&&oa&&void 0!==oa[Tb.DRa]&&null!==oa[Tb.DRa]?oa[Tb.DRa]:19===J.df&&oa&&void 0!==oa[$c.a.Kg]&&null!==oa[$c.a.Kg]?Gj.a.li(oa[$c.a.Kg]):this.X0g();if(!this.Jod([nh.D(J.SelectedRange)]))return mc.TaskExtensions.om();Oa.g(this.$).Bh.qG(!1);var Va=null;(oa=oa.TopCellAddress)&&(Va=nh.o(oa,this.$));new Lb(this.$,J,this.namedSheetViewPublic,Va);return kb.Task.Ta(!0)};Tb.prototype.hch=function(J,oa){function Va(){return new fb(M.SortOptions)}function Ub(){M.ShouldRestoreSelection&&
C.Yna(M.SelectedRange,M.OriginalActiveCell);ud.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",J.df)}function e(ra){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&C.w4e(ra)?C.h3e(ra.Errors[0]):(M.ShouldRestoreSelection&&C.Yna(M.SelectedRange,M.OriginalActiveCell),ud.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",
J.df),M.TopCellAddress?ra=nh.C(M.TopCellAddress):(ra=M.OriginalActiveCell,ra=new Oi.Range(ra.FirstRow+1,ra.FirstColumn+1,ra.FirstRow+1,ra.FirstColumn+1,!0,!1)),C.ZK(ra))}var C=this,M=oa[Tb.c7g];return oe.a(this.$.userOperationManager,function(ra,Na,Ib){return Da(C.$.qa.ta,M.SortOptions,T.b(ra,e),T.a(Na,Ub),Ib,C.sortOptions)},function(ra){return new Ee.a(187,0,ra,void 0,Va)},null)};Tb.prototype.Yna=function(J,oa){J=nh.D(J);Oa.g(this.$).ha.va.Qd.equals(J)||Oa.g(this.$).ha.updateSelection(J,nh.C(oa),
0,void 0,void 0,void 0,!0)};Tb.prototype.X0g=function(){var J={};J.ActiveCell=nh.o(this.ha().va.activeCell,this.$);J.SelectedRange=nh.v(this.ha().va.Qd,this.$);J.FromAutoFilter=!1;J.ExpandSelection=null;return J};Tb.prototype.Ach=function(J){function oa(){return new Qh.a(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return kb.Task.Ta(!1);var e=this.$.qa.ta.Xb();return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,function(C,M,ra){return Le.jb(Va.$.qa.ta,Ub,Wh.a.Tua(zh.a.BYa,gh.a.toggleAutoFilter,C),
M,ra,null,e)},function(C){return new Ee.a(516,0,C,64,oa)},J):oe.a(this.$.userOperationManager,function(C,M,ra){return Le.jb(Va.$.qa.ta,Ub,Wh.a.Tua(zh.a.BYa,gh.a.toggleAutoFilter,C),M,ra,null,e)},function(C){return new sj.a(516,0,C,void 0,oa)},J)};Tb.prototype.ech=function(J){function oa(){return new Ra(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return kb.Task.Ta(!1);var e=this.gridView.Vb.vk(this.ha().va.Qd,!0);e&&ud.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",e.type.toString());
var C=this.$.qa.ta.Xb();e=Ag.EwaSettings.tc()?function(M){return new Ee.a(517,0,M,64,oa)}:function(M){return new sj.a(517,0,M,void 0,oa)};return this.IIe(function(M,ra,Na){var Ib=Va.$.qa.ta;M=Wh.a.Tua(zh.a.Ara,gh.a.clearAutoFilter,M);var Gc=Ib.Oa(41,void 0===C?null:C);Gc.selectedRange=Ub;return Le.i(Ib,"ClearAutoFilter",Gc,M,ra,Na,null,0)},e,J,!!this.namedSheetViewPublic)};Tb.prototype.IIe=function(J,oa,Va,Ub){var e=this;return Ub?this.namedSheetViewPublic.dAa().continueWith(function(C){C.result&&
oe.a(e.$.userOperationManager,J,oa,Va)}):oe.a(this.$.userOperationManager,J,oa,Va)};Tb.prototype.vch=function(J){function oa(){return new Sa(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return kb.Task.Ta(!1);var e=this.$.qa.ta.Xb();return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,function(C,M,ra){return Ta(Va.$.qa.ta,Ub,Wh.a.Tua(zh.a.Ara,gh.a.$Hf,C),M,ra,null,e)},function(C){return new Ee.a(518,0,C,64,oa)},J):oe.a(this.$.userOperationManager,function(C,M,ra){return Ta(Va.$.qa.ta,Ub,Wh.a.Tua(zh.a.Ara,
gh.a.$Hf,C),M,ra,null,e)},function(C){return new sj.a(518,0,C,void 0,oa)},J)};Tb.prototype.w4e=function(J){return Vg.b(J,-569193796)};Tb.prototype.h3e=function(J){Xg.a(this.$).nd.AD(-569193796);new Ja(this.$,J)};Tb.prototype.kDd=function(J){var oa=this;(new eb(function(Va){var Ub={};Ub.ActiveCell=J.ActiveCell;Ub.SelectedRange=J.SelectedRange;Ub.ExpandSelection=Va;Va={};oa.$.Ce(J.IsAscending?-1010737776:2123420468,$c.a.Wb,8,(Va[Tb.DRa]=Ub,Va))})).show()};Tb.prototype.Vtj=function(){var J=this.ha();
J.updateSelection(this.zwc,J.va.activeCell,0,void 0,void 0,void 0,!0);this.fKf(!0)};Tb.prototype.yJa=function(){var J=this.ha();if(!J)return ud.ULS.shipAssertTag(537151573,0,!!J,"SelectionManger is null"),null;this.gridView.Bh.qG(!1);return nh.v(J.va.Qd,this.$)};Tb.prototype.oIb=function(){this.Wc&&this.Wc.Do&&(this.Yf=this.Wc.Do,this.Bb=this.Wc.f$b())};Tb.prototype.jOh=function(J){var oa=this;if(this.$.isEditMode&&(this.Wc=this.gridView.Vb.nq(this.gridView.ha.va.activeCell))){this.activeCell=nh.o(this.gridView.ha.va.activeCell,
this.$);if(this.Wc&&this.Wc.Do){var Va=this.Wc.Do.CurrentCol;if(this.Wc.Do.CurrentRow===this.activeCell.FirstRow&&Va===this.activeCell.FirstColumn){this.oIb();this.applyPivotSort(J);return}}this.$.qa.ta.Xb();Va=new Ee.a(228,0,function(Ub,e,C){return Le.B(oa.$.qa.ta,oa.activeCell,T.b(Ub,oa.nEi),T.a(e,oa.mEi),C,J)},16);this.$.userOperationManager.ic(Va,null)}};Tb.prototype.applyPivotSort=function(J){var oa=this;if(this.Wc&&this.Bb&&this.activeCell&&this.Yf){var Va=8===this.Yf.CellArea,Ub=1===this.Yf.CellArea||
2===this.Yf.CellArea;(Va||Ub)&&8!==this.Yf.CellType&&4!==this.Yf.CellType&&(Va?oe.a(this.$.userOperationManager,function(e,C,M){return Le.e(oa.$.qa.ta,oa.activeCell,J?1:2,oa.Bb.Caption,e,C,M,null)},function(e){return new Ee.a(1015,0,e,void 0,null)},null):(Va=1===this.Yf.CellArea?1:2,this.$.la(726)?Vb.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Wc.isOlap?"":this.Bb.Caption,Va,J):Vb.a.aps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),J)))}};Tb.prototype.ZK=function(J){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(oa){oa.result.Pda(J);ud.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};Tb.prototype.aUd=function(J){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,476,475,0),function(oa){oa.result.aUd(J,0);ud.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.ma,3)};Tb.c7g="CustomSortCommandData";Tb.DRa="SortCommandData";Object(Ze.a)(Tb,"SortCommandHandler",null,[147]);var wh=Ka.a;vm(sb,wh);sb.prototype.Md=function(){var J=this;mc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,309,310,this.tb),function(oa){J.Ed([new Tb(J.$,
oa.result)])},this.$.ma,3)};sb.ja=function(J){Ka.a.de(160,new sb(J))};Object(Ze.a)(sb,"SortCommandHandlerFactory",Ka.a,[]);sa.prototype.t5g=function(J,oa){new Ja(J,oa)};Object(Ze.a)(sa,"SortUtil",null,[568]);var pi=sd.a;vm(va,pi);va.prototype.create=function(){var J=this.$.da.Aa(446);J||(J=new sa(this.$),this.$.da.Ha(446,J));this.Fb(J)};va.ja=function(J){J.da.Ha(447,new va(J))};Object(Ze.a)(va,"SortUtilFactory",sd.a,[]);wa.prototype.executeCommand=function(J,oa,Va){return 2!==this.Di.ze(Ng.a.tryOfficeThroughTellMe,
2,Va)?kb.Task.Ta(!0):Ed.a(oa.command)};wa.prototype.Gc=function(J,oa){return 215809929===oa.command};wa.prototype.fd=function(){return!1};wa.prototype.Xc=function(){return!1};Object(Ze.a)(wa,"TryOfficeThroughTellMeCommandHandler",null,[147]);var vi=Ka.a;vm(Fb,vi);Fb.prototype.Md=function(){this.Ed([new wa(ld.AFrameworkApplication.Eb)])};Fb.ja=function(J){Ka.a.de(207,new Fb(J))};Object(Ze.a)(Fb,"TryOfficeThroughTellMeCommandHandlerFactory",Ka.a,[]);var $i=b(156);Sb.nM=function(){return jf.a.jj(Sb.Tj,
$i.a.Va(433))};Sb.Tj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(Ze.a)(Sb,"NamedSheetViewTeachingDialogHtml",null,[]);var Ui=bi.a;vm(Gb,Ui);Gb.prototype.Kh=function(){this.kc=4;this.stopwatch=this.$.Ub.Fc("UserAction",
this.xc);var J=nf.a.instance.ea(1854);this.xf=Sb.nM();this.Jo=new xb.a;this.initializeAndShow(J,this.Aui,{});return this.Jo.task};Gb.prototype.$u=function(J){Ui.prototype.$u.call(this,J);this.Cc(1,nf.a.instance.ea(1856));this.Cc(2,nf.a.instance.Va(446))};Gb.prototype.PTi=function(){this.$.fa.dkc=!1};Gb.prototype.Bni=function(J){var oa={};oa.a=this.$.ya.UserSessionId;oa.b="NamedSheetViewTeachingDialogClose";oa.c=J;oa.e=!0;this.stopwatch&&(this.stopwatch.stop(),oa.d=this.stopwatch.Ac);Gd.b().Ne(53,
oa,!0)};tl.Object.defineProperties(Gb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(Ze.a)(Gb,"NamedSheetViewTeachingDialog",bi.a,[]);var di=b(189);hb.prototype.dAa=function(){if(this.lqj()){if(Ag.EwaSettings.la(608)){this.$.xa.oa.ye.BOd=!0;var J=new xb.a;this.$.Ka.Zb(new Hj.a(-2050946363,$c.a.Wb,2,0,null)).continueWith(function(oa){J.setResult(!Ci.a(oa)&&oa.result)});return J.task}return(new Gb(this.$)).Kh()}return kb.Task.Ta(!0)};
hb.prototype.lqj=function(){var J=this.$.xa.oa;return this.$.fa.R7a&&this.$.fa.dkc&&!J.ye.sC&&this.$.fa.cM&&!di.c(this.$)};Object(Ze.a)(hb,"NamedSheetViewPublic",null,[570]);var ri=sd.a;vm(za,ri);za.prototype.create=function(){this.Fb(this.$.da.Aa(309)||new hb(this.$))};za.ja=function(J){J.da.Ha(310,new za(J))};Object(Ze.a)(za,"NamedSheetViewPublicFactory",sd.a,[]);var Hi=b(1313),Ii=b(1002),Sh=b(582);Object(Ze.a)(da,"NamedSheetViewTeachingCalloutContent",null,[]);tl.Object.defineProperties(Zb.prototype,
{A4f:{configurable:!0,enumerable:!0,get:function(){return this.Ffe}},BVi:{configurable:!0,enumerable:!0,get:function(){return this.A4f<this.C4f.count?this.C4f.na(this.Ffe++):null}}});Object(Ze.a)(Zb,"NamedSheetViewTeachingCalloutList",null,[]);var si=b(1184);Wb.prototype.w3h=function(J){var oa=this;this.B4f=J;var Va=Object.assign(new Dh.a,{});Wb.Bai(J)?(Va.add(new da(nf.a.instance.Va(435),nf.a.instance.Va(436),nf.a.instance.ea(1884),function(){oa.vH(2,"Continue");oa.cC(!0)},nf.a.instance.ea(1885),
function(){oa.cC();oa.vH(1,"ExitGuide")},si.a())),1===J&&Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1884),function(){oa.vH(2,"FirstEnterTempViewContinueSecond");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"FirstEnterTempViewExitGuideSecond")},si.a())),Va.add(new da(nf.a.instance.Va(439),nf.a.instance.Va(440),nf.a.instance.ea(1884),function(){oa.vH(2,"FirstEnterExitCalloutContinue");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"FirstEnterExitCalloutGuide")},
Wb.rYe())),Va.add(new da(nf.a.instance.ea(1887),nf.a.instance.Va(437),nf.a.instance.ea(1888),function(){oa.O_f();oa.cC();oa.vH(1,"LearnMore")},nf.a.instance.ea(1889),function(){oa.cC();oa.vH(1,"Done")},Wb.qYe()))):2===J?Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1883),function(){oa.cC();oa.vH(1,"EnterTempViewAfterPersistedView")},null,null,si.a())):3===J&&(Va.add(new da(nf.a.instance.Va(435),nf.a.instance.ea(1895),nf.a.instance.ea(1884),function(){oa.vH(2,"AutoOptInExitCalloutContinue");
oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"AutoOptInExitGuide")},Wb.rYe())),Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1884),function(){oa.vH(2,"Continue");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"ExitGuide")},si.a())),Va.add(new da(nf.a.instance.ea(1887),nf.a.instance.Va(437),nf.a.instance.ea(1888),function(){oa.O_f();oa.cC();oa.vH(1,"LearnMore")},nf.a.instance.ea(1889),function(){oa.cC();oa.vH(1,"Done")},Wb.qYe())));this.wSd=
new Zb(Va)};Wb.prototype.O_f=function(){var J=new Hj.a(-859308420,$c.a.Wb,this.$.ed,9,null),oa={};oa=(oa[$c.a.Kg]="HelpID=SheetViews",oa.InputMethod=$c.a.Wb,oa[$c.a.hd]=ab.a.WU,oa.ShouldCanvasTakeFocus=!0,oa);this.$.Ka.Zb(J,oa)};Wb.prototype.show=function(J){this.w3h(J);this.hcb()};Wb.prototype.Ojj=function(J){this.MYb=J};Wb.prototype.hcb=function(){var J=this,oa=this.wSd.BVi;if(oa){var Va=Object.assign(new Hi.a,{label:oa.ZTi,onExecute:oa.primaryButtonAction}),Ub=null;oa.SSf&&(Ub=Object.assign(new Hi.a,
{label:oa.SSf,onExecute:oa.secondaryButtonAction}));oa=Object.assign(new Ii.a,{target:oa.targetObject,content:oa.body,title:oa.title,showCloseIcon:!0,primaryButtonProps:Va,secondaryButtonProps:Ub,useTeachingStyles:!0});oa=this.MYb.callout(oa);Va=Object.assign(new Sh.a,{onShow:function(){J.vH(0)}});this.Nxc=this.MYb.addNotification(oa,Va);this.$Uc||(this.$.zod=!0)}};Wb.prototype.dismiss=function(){this.cC();this.vH(1,"DismissedByOthers")};Wb.prototype.cC=function(J){J=void 0===J?!1:J;this.Nxc&&(this.$Uc||
(this.$.zod=!1),this.MYb.removeNotification(this.Nxc),this.Nxc=null);J&&this.hcb()};Wb.prototype.vH=function(J,oa){var Va={};Va.a=this.$.ya.UserSessionId;Va.b=this.B4f;Va.c=this.wSd.A4f;Va.d=J;Va.e=void 0===oa?null:oa;J?(this.stopwatch&&(this.stopwatch.stop(),Va.f=this.stopwatch.Ac,this.stopwatch=null),2===J&&(this.stopwatch=this.$.Ub.Fc("UserAction","ShowNamedSheetViewTeachingCalloutNext"))):this.stopwatch=this.$.Ub.Fc("UserAction","ShowNamedSheetViewTeachingCallout");Gd.b().Ne(52,Va,!0)};Wb.qYe=
function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Wb.rYe=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};Wb.Bai=function(J){return!J||1===J};Object(Ze.a)(Wb,"NamedSheetViewTeachingCallout",null,[569]);var Lh=sd.a;vm(Ya,Lh);Ya.prototype.create=function(){var J=this.$.da.Aa(322);J||(J=new Wb(this.$),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ha(322,J));this.Fb(J)};Ya.ja=function(J){J.da.Ha(323,
new Ya(J))};Object(Ze.a)(Ya,"NamedSheetViewTeachingCalloutFactory",sd.a,[]);var jh=b(100),dj=b(172),dk=b(1185),mk=b(87),Oj=b(1073),nk=Xb.StandardDialog;vm(zb,nk);zb.prototype.RP=function(){this.kc=5;this.width=40;var J=document.createElement("span");J.id=this.mi("DirectPrintHeaderContent");var oa=document.createElement("span");oa.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(oa,"DirectPrintHeader");this.PO=document.createElement("iframe");this.PO.name="pdfObjectFrame";
this.PO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.PO.onload=Object(xf.a)(this,this.kUi,"printablePdfLoaded");if(this.DUb&&0<this.DUb.count){var Va=ub.a.ced(this.nTb,this.DUb),Ub=ub.a.mGd(this.nTb,this.DUb);this.Rl=document.createElement("form");this.Rl.id="printPreviewPostForm";this.Rl.method="POST";this.Rl.target=this.PO.name;this.Rl.action=Ub;Va=yl(Va);for(Ub=Va.next();!Ub.done;Ub=Va.next()){Ub=Ub.value;var e=document.createElement("input");e.type="hidden";e.name=Ub.key;e.value=Ub.value;
this.Rl.appendChild(e)}}else this.PO.setAttribute("src",this.nTb);Sys.UI.DomElement.addCssClass(this.PO,dj.a.F$d);this.plg?(Sys.UI.DomElement.addCssClass(this.PO,"DirectPrintPdfObjectHidden"),oa.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Jg.a.oh(this.PO,Jg.a.GB,Jg.a.rj)):(Sys.UI.DomElement.addCssClass(this.PO,"DirectPrintPdfObject"),this.Vm.push(this.PO));J.appendChild(oa);J.appendChild(document.createElement("br"));J.appendChild(this.PO);this.Rl&&J.appendChild(this.Rl);J.appendChild(document.createElement("br"));
J.appendChild(this.UXg(this.Rl?"#":this.nTb));this.Hkb.start();this.NAb(CommonUIStrings.l_AppTitle,null,null,null,null,J);this.zW(this.mi("DirectPrintHeaderContent"));this.Rl&&this.Rl.submit();this.K1g();ud.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};zb.prototype.UXg=function(J){var oa=document.createElement("span"),Va=document.createElement("span");Va.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;oa.appendChild(Va);ld.AFrameworkApplication.ga&&(2===ld.AFrameworkApplication.sa.Pa.Lj&&
ld.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===ld.AFrameworkApplication.sa.Pa.Lj&&ld.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(J=document.createElement("span"),2===ld.AFrameworkApplication.sa.Pa.Lj?J.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===ld.AFrameworkApplication.sa.Pa.Lj&&(J.innerText=CommonUIStrings.l_InternalError_Directive,ud.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.kpa=J,oa.appendChild(document.createElement("br")),oa.appendChild(J)):(Va=document.createElement("a"),Va.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Va.href=J,Va.target="_blank",Va.id="PrintPDFLink",Va.className="AllowBrowserClick",this.kpa=Va,oa.appendChild(document.createElement("br")),oa.appendChild(Va),this.Rl&&Ef.a.addHandler(Va,"click",Object(xf.a)(this,this.Mmc,"onSubmit")),this.IO.pa(Je.a.click,this.kpa,Object(xf.a)(this,this.EGe,"downloadPDFLinkClicked"),null));this.Vm.push(this.kpa);
return oa};zb.prototype.Mmc=function(J){this.Rl&&(this.Rl.target="_blank",this.Rl.submit());J.preventDefault()};zb.prototype.K1g=function(){if(0<this.Vm.length){var J=new dk.a(this.Vm),oa=jh.FocusManager.instance().hQ();oa&&(this.kpa.focus(),oa.kf=J,oa.XZ=!0)}};zb.prototype.EGe=function(){ud.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};zb.prototype.Srd=function(){ud.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};
zb.prototype.kUi=function(){ud.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Hkb&&this.Hkb.stop()};zb.prototype.dispose=function(){this.kpa&&(this.IO.za(Je.a.click,this.kpa,Object(xf.a)(this,this.EGe,"downloadPDFLinkClicked")),this.kpa=null);mk.a.J_(this.PO);this.PO=null;nk.prototype.dispose.call(this)};Object(Ze.a)(zb,"DirectPrintDialog",Xb.StandardDialog,[343]);lb.prototype.qHh=function(J,oa,Va){return new zb(this.IO,J,oa,void 0===Va?null:Va)};Object(Ze.a)(lb,"DirectPrintDialogFactory",
null,[320]);vm(Ma,qg);Ma.prototype.Bif=function(){ud.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Ma.prototype.Dif=function(){ld.AFrameworkApplication.Pm.wwb(9540);ud.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Ma.prototype.Srd=function(){ud.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};tl.Object.defineProperties(Ma.prototype,{C6e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},eTd:{configurable:!0,enumerable:!0,
get:function(){return Ma.PSa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},iNa:{configurable:!0,enumerable:!0,get:function(){return Ma.PSa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},$Tc:{configurable:!0,enumerable:!0,get:function(){var J=[];Array.add(J,CommonUIStrings.l_PrintDialogCanCloseDocument);if(qg.Uvb){var oa=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==ld.AFrameworkApplication.sa.Pa.VCe&&(oa=ld.AFrameworkApplication.sa.Pa.VCe);Array.add(J,oa)}return Ma.PSa?
J:null}},Vhc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Uhc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},b3c:{configurable:!0,enumerable:!0,get:function(){return ld.AFrameworkApplication.OEe?"UIFontDialogTextLarge":null}}});tl.Object.defineProperties(Ma,{PSa:{configurable:!0,enumerable:!0,get:function(){return!!ld.AFrameworkApplication.sa&&
ld.AFrameworkApplication.sa.Pa.Lu&&ld.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Rg.a.rC||Rg.a.Af||Rg.a.zf||Rg.a.N5a)&&!ld.AFrameworkApplication.isUnifiedHostMode&&ld.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(Ze.a)(Ma,"PrintDialogWithLinkToPdf",qg,[]);Ia.Z4c=",";Object(Ze.a)(Ia,"DirectPrintBrsSettings",null,[]);Object(Ze.a)(pa,"DirectPrintProbeResults",null,[]);na.prototype.start=function(){};na.prototype.kWi=
function(){var J=Array(this.aC.VRa.length);if(void 0!==this.$ib&&null!==this.$ib)for(var oa=0;oa<this.aC.VRa.length;oa++)J[oa]=this.aC.VRa[oa]in this.$ib&&this.pmg(this.$ib[this.aC.VRa[oa]]);return J};na.prototype.lWi=function(){for(var J=Array(this.aC.WRa.length),oa=!(void 0===this.KLc||null===this.KLc),Va=0;Va<this.aC.WRa.length;Va++){var Ub=this.aC.WRa[Va];J[Va]=oa&&Ub in this.KLc?!0:this.Smg(Ub)}return J};na.prototype.ySh=function(){for(var J=this.kWi(),oa=Array(J.length),Va=0;Va<J.length;Va++)oa[Va]=
J[Va]?this.Vsh(this.$ib[this.aC.VRa[Va]]):null;return oa};na.prototype.Vsh=function(J){if(void 0===J||null===J)return null;J=J.enabledPlugin;return void 0===J||null===J?null:J.name};na.prototype.XOh=function(){for(var J=this.ySh(),oa=this.lWi(),Va={},Ub={},e=0;e<this.aC.VRa.length;e++)Va[this.aC.VRa[e]]=J[e];for(J=0;J<this.aC.WRa.length;J++)Ub[this.aC.WRa[J]]=oa[J];return new pa(Va,Ub)};na.prototype.Zqj=function(){return this.Zmg||!this.aC.isEnabled||ld.AFrameworkApplication.isUnifiedHostMode?!1:
this.ezj()};na.prototype.Cvc=function(){if(null!=this.XVb)return this.XVb;var J=na.T$e(this.aC);return this.XVb=this.aC.U$e&&J||this.K9h()};na.prototype.K9h=function(){return Rg.a.Po&&this.aC.L9h&&Rg.a.Kve>=this.aC.aTg?!0:!1};na.prototype.ezj=function(){if(!this.Tmg(this.aC))return!1;var J=Ej.a.Mfd(this.gNc.value.B3f);J=yl(J);for(var oa=J.next();!oa.done;oa=J.next())if(oa=oa.value,void 0!==oa&&null!==oa)return!0;J=Ej.a.Mfd(this.gNc.value.WRa);J=yl(J);for(oa=J.next();!oa.done;oa=J.next())if(oa.value)return!0;
return!1};na.prototype.GZh=function(){var J=Ej.a.Mfd(this.gNc.value.B3f);J=yl(J);for(var oa=J.next();!oa.done;oa=J.next())if(H.a.contains(this.aC.Q1h,oa.value))return!0;return!1};na.prototype.b0f=function(J){var oa=void 0===oa?!1:oa;var Va=void 0===Va?null:Va;ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?this.u8d(J,Va):this.Zqj()?this.kbh(J,this.GZh()&&!oa,Va):this.u8d(J,Va)};na.prototype.kbh=function(J,oa,Va){Va=void 0===Va?null:Va;var Ub=
this.fsg.Fc("UserAction","OpenDirectPrintDialog");this.rUa.qHh(J,oa,Va).RP();Ub.stop()};na.bef=function(J){try{return new ActiveXObject(J),!0}catch(oa){ud.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",J)}return!1};na.V$e=function(J){return void 0===J||null===J?!1:!(void 0===J.enabledPlugin||null===J.enabledPlugin)};na.create=function(J){var oa=new Ia(ld.AFrameworkApplication.ga.appSettings),Va=null;try{Va=window.navigator.mimeTypes}catch(Ib){ud.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}var Ub=null;try{Ub=window.navigator.plugins}catch(Ib){ud.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var e=na.V$e,C=na.bef;J=J.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var M=ld.AFrameworkApplication.sa.fD,ra=na.cef,Na=!!ld.AFrameworkApplication.sa&&ld.AFrameworkApplication.sa.Pa.Lu&&!ld.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new na(oa,Va,Ub,e,C,J,M,ra,function(Ib,Gc){return new Ma(Ib,
!1,Gc,!0,Na)},ld.AFrameworkApplication.vLa)};na.cef=function(J){return Rg.a.Po||Rg.a.Af&&J.Qbi||J.U$e&&na.T$e(J)?!0:!1};na.T$e=function(J){var oa=Rg.a.yrb;if(oa){var Va=oa.split(".");if(2===Va.length)return oa=parseInt(Va[0]),Va=parseInt(Va[1]),oa>J.pud||oa===J.pud&&Va>=J.Imf}return!1};tl.Object.defineProperties(na.prototype,{aC:{configurable:!0,enumerable:!0,get:function(){return this.jjg}}});Object(Ze.a)(na,"DirectPrintManager",null,[226]);xa.prototype.di=function(J){var oa=this;this.rb=J;J.register(lb,
"Common.App.DirectPrint.DirectPrintDialogFactory").zc().Ic(function(){return new lb(ld.AFrameworkApplication.sa.MW)});J.register(226,"Common.App.DirectPrint.IDirectPrintManager").zc().Ic(function(){return na.create(oa.rb)})};xa.prototype.init=function(){this.r2d=this.rb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.r2d.start()};xa.prototype.dispose=function(){};tl.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});
Object(Ze.a)(xa,"PackageManager",null,[4,5]);var Ak=b(594),sk=zk.a;vm(Z,sk);Z.prototype.setFocus=function(){this.Mv.checked?De.DOMElementExtensions.setFocus(this.Mv):De.DOMElementExtensions.setFocus(this.getButton(0).get_element())};tl.Object.defineProperties(Z.prototype,{ee:{configurable:!0,enumerable:!0,get:function(){return this.yPb}}});Z.J3b="printCurrentSelection";Object(Ze.a)(Z,"BasePrintDialog",zk.a,[]);var Pi=b(226);vm(ca,Z);ca.prototype.initialize=function(){ud.ULS.sendTraceTag(537154316,
0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.u4h();this.rXa(1172);this.addButton(1);Z.prototype.initialize.call(this)};ca.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){var e=J.$.qa.ta,C=J.Im;oa=J.Lia(oa);Va=J.daa(Va);var M=J.ee,ra=e.Oa(1,null);ra.printOptions=C;return Le.i(e,"ValidatePrint",ra,oa,Va,Ub,M,0)}};ca.prototype.commit=function(){this.wWg();return!0};ca.prototype.Lx=function(J,oa,Va){var Ub,e=J.Result;if(e&&oa){var C=0,M=0;(null===(Ub=
e.SelectedRanges)||void 0===Ub?0:Ub.Ranges)&&0<e.SelectedRanges.Ranges.length&&e.SelectedRanges.Ranges[0]&&(C=Math.min(ca.gYf(e.SelectedRanges.Ranges[0]),65535));e.UsedRange&&(M=Math.min(ca.gYf(nh.j(nh.D(e.UsedRange))),65535));Pi.h(oa,C);Pi.i(oa,M)}this.Im=e;Z.prototype.Lx.call(this,J,oa,Va)};ca.prototype.setFocus=function(){this.Prb.checked?De.DOMElementExtensions.setFocus(this.Prb):Z.prototype.setFocus.call(this)};ca.prototype.u4h=function(){this.Ob.innerHTML=ca.gTi(this.$.fa.isNamedObjectViewMode);
this.Mv=De.DOMElementExtensions.getElementById(this.Ob,Z.J3b);this.Prb=De.DOMElementExtensions.getElementById(this.Ob,"printEntireItem");this.Im.Type&&this.Im.UseSelection?(this.Mv.checked=!0,this.Prb.disabled=!this.Im.SheetName):(this.Prb.checked=!0,this.Mv.disabled=!this.Im.Type||!Oa.g(this.$).ha.va.Dh)};ca.prototype.wWg=function(){ud.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var J=new Sys.StringBuilder;this.cBh(J);var oa=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",
Rg.a.zf?0:1);li.HelperMethods.sf(J.toString(),"",oa,"PrintDialog.PrintViewUrl")||ud.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};ca.prototype.cBh=function(J){var oa=this.$.ya;J.append(this.$.hda+oa.LayoutsRelativeUri+"/xlprintview.aspx?");fi.a.Vf(J,ab.a.GVi,this.Im.SessionId);fi.a.Vf(J,ab.a.IVi,this.Mv.checked?"1":"0");if(this.Im.Type){if(!this.Im.UsedRangeTooBig){var Va=nh.D(this.Im.UsedRange);(Va=nh.x(Va,this.Im.SheetName))&&
fi.a.Vf(J,ab.a.JVi,Va)}1===this.Im.Type?fi.a.Vf(J,ab.a.EVi,this.Im.ObjectId):(Va=nh.B(this.Im.SelectedRanges.Ranges[0]),Va=nh.x(Va,this.Im.SheetName),fi.a.Vf(J,ab.a.FVi,Va))}else fi.a.Vf(J,ab.a.DVi,this.Im.ObjectId);wi.a.yFa(J,oa);fi.a.Vf(J,ab.a.HVi,this.Im.Title)};ca.gTi=function(J){return String.format("<div class='"+Nj.a.xu+"'>{0}</div>\r\n\t<div class='"+Nj.a.v7c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
nf.a.instance.ea(1173),Z.J3b,nf.a.instance.ea(1176),"printEntireItem",J?nf.a.instance.ea(1175):nf.a.instance.ea(1174))};ca.gYf=function(J){return(J.LastColumn-J.FirstColumn+1)*(J.LastRow-J.FirstRow+1)};tl.Object.defineProperties(ca.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(Ze.a)(ca,"HtmlPrintDialog",Z,[]);var Vi=b(576),ki=b(66);ba.bUi="PrintDialogBody";ba.printDialogTitle="PrintDialogTitle";ba.H6b="ewa-dlg-elements-container-rtl";ba.cUi="PrintDialogLeftContainer";
ba.dUi="PrintDialogRightContainer";ba.X9a="PrintDialogRadioButtonContainer";ba.BFf="PrintRadioButtonElementInnerDiv";ba.iUi="PrintRadioButtonElementOuterDiv";ba.Y9a="PrintDialogTitleSection";ba.ICd="PrintDialogComboBoxContainer";ba.jUi="PrintRadioButtonIcon";ba.aUi="PrintButtonArea";ba.Vx="PrintPreviewerContainer";Object(Ze.a)(ba,"CssClassNames",null,[]);var Ai=b(898),pj=b(285),Pj=b(1015),jk=b(853);O.prototype.getSheetName=function(){return this.sheetName};O.prototype.getPrintSettings=function(){return this.printSettings};
Object(Ze.a)(O,"MacroRecorderSheetPrintSettingsSavedPayload",null,[98]);vm(Q,Z);Q.prototype.initialize=function(){this.U6&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&Q.u2g(this.Ob);this.Le?this.Iye(987,null):(this.Vk(),this.rXa(987));Z.prototype.initialize.call(this)};Q.prototype.dispose=function(){this.vGj();Z.prototype.dispose.call(this)};Q.prototype.close=function(J){ud.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.w_,J?"without":"with");this.pcj();if(this.Tr){var oa=this.sGh();!this.gQd&&!this.C$.checked&&this.$.isEditMode&&this.jhd(oa)&&this.gcj(oa)}Z.prototype.close.call(this,J)};Q.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){return S(J.$.qa.ta,J.$.xa.oa.name,J.locale,J.Lia(oa),J.daa(Va),Ub,null)}};Q.prototype.Lx=function(J,oa,Va){this.Tr=J.Result;this.AHb=this.Tr.ScalingWidth;this.zHb=this.Tr.ScalingHeight;this.o$c();this.c4h();Z.prototype.Lx.call(this,J,oa,Va)};Q.prototype.Vk=function(){ud.ULS.sendTraceTag(537154315,
0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.v4h();Z.prototype.Vk.call(this)};Q.prototype.commit=function(){this.vWg();return!0};Q.prototype.setFocus=function(){this.Le?Ik.a.Pyc(this.pca):this.pca.checked?De.DOMElementExtensions.setFocus(this.pca):Z.prototype.setFocus.call(this)};Q.prototype.K5h=function(){switch(this.qN.lv){case 1:this.pca.checked=!0;break;case 0:this.Mv.disabled?this.pca.checked=!0:this.Mv.checked=!0;break;case 2:this.C$.checked=!0;break;
default:ud.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.qN.lv),this.qN.lv=1,this.pca.checked=!0}};Q.prototype.pcj=function(){this.qN.lv=this.GXc();this.U6&&(this.qN.ignorePrintArea=this.k4a.checked)};Q.prototype.o$c=function(){if(100!==this.Tr.ScalingPercent||this.Tr.FitToPage&&(1<this.Tr.ScalingWidth||1<this.Tr.ScalingHeight))this.gQd=!0,this.Tr.ScalingWidth=Q.u4c,this.Tr.ScalingHeight=Q.t4c,this.Tr.ScalingPercent=Q.j4b,this.Tr.FitToPage=Q.n4c;this.Tr.PaperSize.toString()in
this.xAd||(this.gQd=!0,this.Tr.PaperSize=this.Tr.PaperSize===Q.UIg?34:Q.Jqb)};Q.prototype.c4h=function(){this.Dya=this.Tr.IsLandscape?2:1;this.v_=this.Tr.FitToPage?1===this.Tr.ScalingWidth&&1===this.Tr.ScalingHeight?1:this.Tr.ScalingWidth||1!==this.Tr.ScalingHeight?2:3:0;this.Sla=this.Tr.PaperSize;this.u6c(this.C$.checked?!0:!1);this.TLd(this.C$.checked?!0:!1)};Q.prototype.J4h=function(){this.Ucc.disabled=this.Mv.checked;this.MEb=this.k4a.checked=this.qN.ignorePrintArea};Q.prototype.W4g=function(J){this.wza=
document.createElement("select");this.wza.style.width=224+ki.a.lf;this.wza.style.height=32+ki.a.lf;this.wza.setAttribute(ab.a.JD,"scalingElementId");this.vza=new jk.a(this.wza,!0);for(var oa=0,Va=Q.scalingOptions.length;oa<Va;++oa){var Ub=nf.a.instance.ea(Q.Pcj[oa]);this.vza.AL(Ub,Q.scalingOptions[oa].toString(),!1)}J.appendChild(this.wza)};Q.prototype.NBe=function(J){this.nya=document.createElement("select");this.nya.style.width=224+ki.a.lf;this.nya.style.height=32+ki.a.lf;this.nya.setAttribute(ab.a.JD,
"paperSizeElementId");this.mya=new jk.a(this.nya,!0);for(var oa=0,Va=Q.paperSizeOptions.length;oa<Va;++oa){var Ub=nf.a.instance.ea(Q.TOi[oa]);this.mya.AL(Ub,Q.paperSizeOptions[oa].toString(),!1)}J.appendChild(this.nya)};Q.prototype.sGh=function(){var J={};J.IsLandscape=2===this.Dya;J.PaperSize=this.Sla;J.ScalingWidth=this.AHb;J.ScalingHeight=this.zHb;J.ScalingPercent=100;J.FitToPage=this.v_?!0:!1;return J};Q.prototype.WGa=function(){var J=new Sys.StringBuilder;J.append(Pj.a(this.$,"Pdf",!0));this.Sha.Cvc()&&
fi.a.Vf(J,Pf.a.Fag,"1");fi.a.Vf(J,Pf.a.yDd,""+this.e6);fi.a.Vf(J,Pf.a.OGf,this.$.xa.oa.name);this.e6||(fi.a.Vf(J,Pf.a.NGf,this.selectedRange),fi.a.Vf(J,Pf.a.HGf,this.activeCell));fi.a.Vf(J,Pf.a.IGf,""+this.Dya);fi.a.Vf(J,Pf.a.JGf,""+this.Sla);fi.a.Vf(J,Pf.a.MGf,""+this.v_);fi.a.Vf(J,Pf.a.LGf,"1");fi.a.Vf(J,Pf.a.GGf,this.MEb?"1":"0");fi.a.Vf(J,Pf.a.KGf,"1");ud.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",J.toString());return J.toString()};Q.prototype.Xwb=function(){var J=this,
oa=null;ud.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.ic(new Ee.a(223,0,function(Va,Ub,e){Va=new pj.a(Va,null,Ub,e,null,!0,!1,"GetFileCopyFileHandler","");Va.correlationID=vk.a.create().toString();oa=Va;ld.AFrameworkApplication.Hd.g9(J.WGa(),1,null,null,Q.I9c,!1,2,J.Xxd,J.Wxd,oa,void 0,void 0,void 0,12E4);return kb.Task.Ta(!0)},16),null)};Q.prototype.v4h=function(){ud.ULS.sendTraceTag(537154312,0,50,
"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.fTi(this.Ob);this.u6c(!0);this.TLd(!0);this.Mv=De.DOMElementExtensions.getElementById(this.Ob,Z.J3b);this.pca=De.DOMElementExtensions.getElementById(this.Ob,"printActiveSheet");this.C$=De.DOMElementExtensions.getElementById(this.Ob,"printEntireWorkbook");this.U6&&(this.Ucc=De.DOMElementExtensions.getElementById(this.Ob,"ignorePrintAreaCheckboxButtonId"),this.k4a=new Ai.a(this.Ucc));this.fvc()&&(this.Mv.disabled=!0,this.Im.SheetName=
this.sheetName);this.K5h();this.U6&&this.J4h();this.T0i()};Q.prototype.fvc=function(){return!!this.Im.ObjectId||!Oa.g(this.$).ha.va.Dh};Q.prototype.T0i=function(){Vi.a.instance.pa(Je.a.change,this.pca,this.f8a);Vi.a.instance.pa(Je.a.change,this.C$,this.f8a);Vi.a.instance.pa(Je.a.change,this.Mv,this.f8a);Vi.a.instance.pa(Je.a.change,this.Hwa,this.Zkc);Vi.a.instance.pa(Je.a.change,this.H9a,this.Zkc);Vi.a.instance.pa(Je.a.change,this.nya,this.wrf);Vi.a.instance.pa(Je.a.change,this.wza,this.xrf);this.U6&&
this.k4a.emb(this.vrf)};Q.prototype.vGj=function(){Vi.a.instance.za(Je.a.change,this.pca,this.f8a);Vi.a.instance.za(Je.a.change,this.C$,this.f8a);Vi.a.instance.za(Je.a.change,this.Mv,this.f8a);Vi.a.instance.za(Je.a.change,this.Hwa,this.Zkc);Vi.a.instance.za(Je.a.change,this.H9a,this.Zkc);Vi.a.instance.za(Je.a.change,this.nya,this.wrf);Vi.a.instance.za(Je.a.change,this.wza,this.xrf);this.U6&&this.k4a.Ica(this.vrf)};Q.prototype.fTi=function(J){J.classList.add(ba.bUi);if(!this.Le){document.getElementById("ewaDialogTitle").classList.add(ba.printDialogTitle);
var oa=document.getElementById("ewaDialogCloseButtonLink");oa.style.top=32+ki.a.lf;this.rtl?oa.style.left=32+ki.a.lf:oa.style.right=32+ki.a.lf}oa=Q.Iy(ba.cUi);J.appendChild(oa);var Va=Q.Iy(ba.Y9a,1180);Va.style.marginBottom=12+ki.a.lf;Va.id="whatToPrintTitleElementId";oa.appendChild(Va);Va=Q.Iy(ba.X9a);oa.appendChild(Va);Q.hqb(Va,this.rtl,"printActiveSheet",1184,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));
Va=Q.Iy(ba.X9a);oa.appendChild(Va);Q.hqb(Va,this.rtl,"printEntireWorkbook",1177,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Va=Q.Iy(ba.X9a);oa.appendChild(Va);Q.hqb(Va,this.rtl,Z.J3b,1176,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.U6?(Va=Q.Iy(ba.Y9a,1209),Va.style.marginTop=
24+ki.a.lf,Va.id="printAreaElementId",oa.appendChild(Va),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Va.style.marginBottom=12+ki.a.lf,Va=Q.Iy(Nj.a.w7c),Va.id="ignorePrintAreaCheckboxWarpperId",De.DOMElementExtensions.setVisible(Va,!0),oa.appendChild(Va),oa=this.getElementById("ignorePrintAreaCheckboxButtonId"),De.DOMElementExtensions.setVisible(oa,!0),Va.appendChild(oa),oa=this.getElementById("ignorePrintAreaCheckboxLabelId"),De.DOMElementExtensions.setVisible(oa,
!0),Va.appendChild(oa)):(Va=Q.Iy(ba.X9a),oa.appendChild(Va),Q.k0g(Va,this.rtl))):(Va=Q.Iy(ba.Y9a,1182),Va.style.marginTop=24+ki.a.lf,Va.id="paperSizeElementId",oa.appendChild(Va),Va=Q.Iy(ba.ICd),this.NBe(Va),oa.appendChild(Va));oa=Q.Iy(ba.dUi);J.appendChild(oa);J=Q.Iy(ba.Y9a,1181);J.style.marginBottom=12+ki.a.lf;J.id="orientationTitleElementId";oa.appendChild(J);J=Q.Iy(ba.X9a);oa.appendChild(J);Q.hqb(J,this.rtl,"portraitRadioButtonId",1187,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");oa.appendChild(document.createElement("BR"));J=Q.Iy(ba.X9a);oa.appendChild(J);Q.hqb(J,this.rtl,"landscapeRadioButtonId",1186,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.U6&&(J=Q.Iy(ba.Y9a,1182),J.style.marginTop=12+ki.a.lf,J.id="paperSizeElementId",oa.appendChild(J),J=Q.Iy(ba.ICd),this.NBe(J),oa.appendChild(J));J=Q.Iy(ba.Y9a,1183);J.style.marginTop=(this.U6?10:74)+ki.a.lf;J.id="scalingElementId";
oa.appendChild(J);J=Q.Iy(ba.ICd);this.W4g(J);oa.appendChild(J);this.Le||document.getElementById("buttonarea").classList.add(ba.aUi);this.Hwa=De.DOMElementExtensions.getElementById(this.Ob,"landscapeRadioButtonId");this.H9a=De.DOMElementExtensions.getElementById(this.Ob,"portraitRadioButtonId")};Q.prototype.vWg=function(){var J=this;ud.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.e6=this.GXc();2!==this.e6&&(this.Dya=this.fte(),this.mya&&(this.Sla=
Q.paperSizeOptions[this.mya.selectedIndex]),this.vza&&(this.v_=Q.scalingOptions[this.vza.selectedIndex]));if(this.$.Tva&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var oa=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ee.a(133,0,function(Va,Ub,e){var C={};C.WhatToPrint=J.e6;C.UseNamedAction=J.Sha.Cvc();C.SelectedSheetName=J.$.xa.oa.name;C.ActiveCell=J.activeCell;C.SelectedRanges=[J.selectedRange];C.IsPdfDocumentRequired=!1;C.Orientation=
J.Dya;C.PaperSize=J.Sla;C.Scaling=J.v_;C.RichValuesEnabled=!0;J.U6&&(C.IgnorePrintArea=J.MEb);return Y(J.$.qa.ta,C,T.b(J.ZBb,Va),Ub,e,oa)},16),null)}else this.Xwb()};Q.prototype.u6c=function(J){this.H9a.disabled=J;this.Hwa.disabled=J;this.mya.Gn.disabled=J;this.vza.Gn.disabled=J};Q.prototype.TLd=function(J){J?(this.Hwa.checked=!1,this.H9a.checked=!1,this.mya.selectedIndex=-1,this.vza.selectedIndex=-1):(2===this.Dya?this.Hwa.checked=!0:this.H9a.checked=!0,this.mya.selectedIndex=this.xAd[this.Sla.toString()],
this.vza.selectedIndex=this.v_)};Q.prototype.gcj=function(J){var oa=this;ud.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Va=this.$.xa.oa.name,Ub=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ee.a(226,0,function(e,C,M){return ma(oa.$.qa.ta,Va,J,e,C,M,Ub)},void 0,function(){return new O(Va,J)}),null)};Q.prototype.jhd=function(J){return this.Tr.IsLandscape!==J.IsLandscape||this.Tr.PaperSize!==
J.PaperSize||this.Tr.FitToPage!==J.FitToPage||this.Tr.ScalingHeight!==J.ScalingHeight||this.Tr.ScalingWidth!==J.ScalingWidth?!0:!1};Q.prototype.fte=function(){return this.Hwa&&this.Hwa.checked?2:1};Q.prototype.GXc=function(){return this.Mv.checked?0:this.pca.checked?1:this.C$.checked?2:1};Q.Iy=function(J,oa){J=void 0===J?null:J;oa=void 0===oa?0:oa;var Va=document.createElement("div");J&&(Va.className=J);oa&&(Va.innerHTML=nf.a.instance.ea(oa));return Va};Q.u2g=function(J){var oa=document.createElement("input");
oa.setAttribute("type","checkbox");oa.className=Nj.a.jKe;oa.id="ignorePrintAreaCheckboxButtonId";oa.setAttribute("name","ignorePrintAreaCbName");oa.style.height=16+ki.a.lf;oa.style.width=16+ki.a.lf;De.DOMElementExtensions.setVisible(oa,!1);var Va=nf.a.instance.ea(1209),Ub=nf.a.instance.ea(1210);oa.setAttribute(ab.a.Bv,Va+ki.a.space+Ub);J.appendChild(oa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.id="ignorePrintAreaCheckboxLabelId";oa.innerHTML=Ub;
oa.setAttribute(ab.a.dP,"true");oa.style.position="relative";oa.style.marginLeft=15+ki.a.lf;De.DOMElementExtensions.setVisible(oa,!1);J.appendChild(oa)};Q.k0g=function(J,oa){var Va=document.createElement("input");Va.setAttribute("type","checkbox");Va.id="ignorePrintAreaCheckboxButtonId";Va.setAttribute("name","ignorePrintAreaCbName");Va.setAttribute(ab.a.JD,"printAreaElementId"+ki.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Va.style.height=16+ki.a.lf;Va.style.width=16+ki.a.lf;oa?Va.style.marginRight=
0+ki.a.lf:Va.style.marginLeft=0+ki.a.lf;J.appendChild(Va);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.setAttribute(ab.a.dP,"true");oa.style.position="relative";oa.style.marginLeft=15+ki.a.lf;J.appendChild(oa);J=Q.Iy(ba.BFf,1210);J.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";oa.appendChild(J)};Q.hqb=function(J,oa,Va,Ub,e,C,M,ra){var Na=document.createElement("input");Na.setAttribute("type","radio");Na.id=Va;Na.setAttribute("name",e);Na.setAttribute(ab.a.JD,
ra+ki.a.space+M);Na.style.height=16+ki.a.lf;Na.style.width=16+ki.a.lf;oa?Na.style.marginRight=0+ki.a.lf:Na.style.marginLeft=0+ki.a.lf;J.appendChild(Na);oa=document.createElement("label");oa.setAttribute("for",Va);oa.style.position="relative";J.appendChild(oa);J=Ti.createClusteredImage(32,32,C,ba.jUi,!0,nf.a.instance.ea(Ub));Ub=Q.Iy(ba.BFf,Ub);Ub.id=M;Ub.setAttribute(ab.a.dP,"true");M=Q.Iy(ba.iUi);M.appendChild(Ub);oa.appendChild(M);oa.appendChild(J)};tl.Object.defineProperties(Q.prototype,{xc:{configurable:!0,
enumerable:!0,get:function(){return"PdfPrintDialog"}}});Q.u4c=1;Q.t4c=0;Q.j4b=100;Q.Jqb=9;Q.n4c=!0;Q.UIg=13;Q.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];Q.TOi=[1189,1190,1197,1191,1192,1193,1194,1195,1188,1198,1199,1200,1201,1202,1203,1204];Q.scalingOptions=[0,1,2,3];Q.Pcj=[1205,1206,1207,1208];Q.I9c=["Content-Type"];Object(Ze.a)(Q,"PdfPrintDialog",Z,[]);tl.Object.defineProperties(I.prototype,{lv:{configurable:!0,enumerable:!0,get:function(){return this.e6},set:function(J){0<=J&&
2>=J?this.e6=J:(ud.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.e6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.p5d},set:function(J){J||!J?this.p5d=J:ud.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(Ze.a)(I,"PdfPrintDialogBrowserSessionState",null,[]);var ok=b(1370);Object(Ze.a)(R,"MacroRecorderPrintAreaSetPayload",null,[98]);Object(Ze.a)(W,"MacroRecorderPageBreakInsertedPayload",
null,[98]);Object(Ze.a)(ia,"MacroRecorderPageBreakRemovedPayload",null,[98]);P.prototype.getSheetName=function(){return this.sheetName};Object(Ze.a)(P,"MacroRecorderPageBreaksAllResetPayload",null,[98]);N.prototype.getSheetName=function(){return this.sheetName};Object(Ze.a)(N,"MacroRecorderPrintAreaClearedPayload",null,[98]);var Yj=b(154);Object(Ze.a)(U,"PageBreaksInformation",null,[]);Object(Ze.a)(B,"RowColBreak",null,[]);Object(Ze.a)(w,"SharedRange",null,[]);var Tk=b(122);G.prototype.executeCommand=
function(J,oa,Va,Ub,e,C,M){e=void 0===e?null:e;C=void 0===C?null:C;M=void 0===M?null:M;this.$Td();this.ribbonCommandInfo=oa;this.Kwj(oa.command);J=T.b(e,this.oEj);ud.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",oa.command);switch(oa.command){case 78661008:return this.x3e(oa,J,C,M,!1);case 275604654:return this.x3e(oa,J,C,M,!0);case -13332329:return this.v2e(oa,J,C,M);case -837651977:return this.xXh(oa,J,C,M);case -1778266776:return this.pYh(oa,
J,C,M);case 845325699:return this.s3e(oa,J,C,M)}return Ed.a(oa.command)};G.prototype.Gc=function(J,oa){switch(oa.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===J;case 845325699:case -13332329:return!0}return!1};G.prototype.FWf=function(J,oa,Va){var Ub=Oa.g(this.$),e=Ub.Ca,C=nh.r(Ub.ha.va.selectedRanges,this.$);if((e=e.oE())&&e.length){e=yl(e);for(var M=e.next();!M.done;M=e.next()){M=M.value;var ra=M.yf;if(ra){for(var Na=nh.j(M.Wf),Ib=[],Gc=yl(C.Ranges),id=Gc.next();!id.done;id=
Gc.next()){var Uc=id.value;Uc.FirstRow>Na.LastRow+1||Uc.LastRow<Na.FirstRow||Uc.FirstColumn>Na.LastColumn+1||Uc.LastColumn<Na.FirstColumn||(id=this.NOh(Na,Uc,ra),Uc=this.MOh(Na,Uc,ra),Ib.push(Object.assign(new w,{FirstRow:id.FirstRow,FirstColumn:Uc.FirstColumn,LastRow:id.LastRow,LastColumn:Uc.LastColumn})))}0<Ib.length&&!Va?ra.setPrintArea(Ib):0<Ib.length&&Va?ra.addToPrintArea(Ib):!Va&&ra.hasPrintArea()&&ra.clearPrintArea();!ra.isDirty()&&ra.hasPageLayout()&&ra.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+
M.Xd,4)}}this.NLb(Ub,J,oa)}};G.prototype.WTg=function(J,oa){var Va=Oa.g(this.$),Ub=Oa.g(this.$).Ca.oE();if(Ub&&Ub.length){Ub=yl(Ub);for(var e=Ub.next();!e.done;e=Ub.next()){e=e.value;var C=e.yf;C&&(C.clearPrintArea(),!C.isDirty()&&C.hasPageLayout()&&C.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+e.Xd,4))}this.NLb(Va,J,oa)}};G.prototype.q6h=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca,e=nh.o(Va.ha.va.activeCell,this.$);if(e){var C=Ub.oE();if(C&&C.length){Ub=null;for(var M=yl(C),
ra=M.next();!ra.done;ra=M.next()){ra=ra.value;var Na=ra.yf;if(Na){var Ib=nh.j(ra.Wf);if(!(e.FirstRow>Ib.LastRow||e.FirstRow<Ib.FirstRow||e.FirstColumn>Ib.LastColumn||e.FirstColumn<Ib.FirstColumn)&&(Ub=this.I3g(Na,Ib,e),Na.insertPageBreak(Ub),!Na.isDirty()&&Na.hasPageLayout()&&Na.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+ra.Xd,4),Ub))break}}if(!Ub)for(C=yl(C),ra=C.next();!ra.done;ra=C.next())if(Ub=ra.value,M=Ub.yf)Ub=nh.j(Ub.Wf),Ub=this.MBe(M,Ub,e),M.insertPageBreak(Ub);
this.NLb(Va,J,oa)}}};G.prototype.g3i=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca,e=nh.o(Va.ha.va.activeCell,this.$);if(e&&(Ub=Ub.oE())&&Ub.length){Ub=yl(Ub);for(var C=Ub.next();!C.done;C=Ub.next()){C=C.value;var M=C.yf;if(M){var ra=nh.j(C.Wf);(ra=this.MBe(M,ra,e))&&M.removePageBreak(ra);!M.isDirty()&&M.hasPageLayout()&&M.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+C.Xd,4)}}this.NLb(Va,J,oa)}};G.prototype.i9i=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca.oE();if(Ub&&Ub.length){Ub=
yl(Ub);for(var e=Ub.next();!e.done;e=Ub.next()){e=e.value;var C=e.yf;C&&(C.resetAllPageBreak(),!C.isDirty()&&C.hasPageLayout()&&C.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+e.Xd,4))}this.NLb(Va,J,oa)}};G.prototype.x3e=function(J,oa,Va,Ub,e){if(!e){var C=this.$.xb.getItemByName("PRINT_AREA");if(C&&(ud.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",C.type),2===C.type))return this.V7h(),
kb.Task.Ta(!0)}C=Oa.g(this.$).ha.va;var M=nh.r(C.selectedRanges,this.$);if(1===M.Ranges.length&&!e){if(C.wwa())return this.EYh(J,M,oa,Va,Ub,e),kb.Task.Ta(!0);if(nh.R(M.Ranges[0]))return this.$.xa.oa.hasPrintArea?this.v2e(J,oa,Va,Ub):kb.Task.Ta(!0)}this.FWf(J.command,Ub,e);return this.n9e(J,oa,Va,M,e)};G.prototype.v2e=function(J,oa,Va,Ub){this.WTg(J.command,Ub);return this.G7h(J,oa,Va)};G.prototype.xXh=function(J,oa,Va,Ub){this.q6h(J.command,Ub);return this.S7h(J,oa,Va)};G.prototype.pYh=function(J,
oa,Va,Ub){if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var e=nh.r(Oa.g(this.$).ha.va.selectedRanges,this.$);if(nh.R(e.Ranges[0]))return this.s3e(J,oa,Va,Ub)}this.g3i(J.command,Ub);return this.X7h(J,oa,Va)};G.prototype.s3e=function(J,oa,Va,Ub){this.i9i(J.command,Ub);return this.Z7h(J,oa,Va)};G.prototype.n9e=function(J,oa,Va,Ub,e){function C(){return new R(Ub,e)}function M(Na,Ib,Gc){Na=T.b(Na,oa);Ib=T.a(Ib,Va);var id=ra.Oa(1,null);id.selectedRanges=
Ub;id.addToPrintArea=e;return Le.i(ra,"SetPrintArea",id,Na,Ib,Gc,null,0)}var ra=this.$.qa.ta;return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,M,function(Na){return new Ee.a(241,0,Na,64,C)},J):oe.a(this.$.userOperationManager,M,function(Na){return new sj.a(241,0,Na,void 0,C)},J)};G.prototype.G7h=function(J,oa,Va){function Ub(){return new N(C)}function e(ra,Na,Ib){ra=T.b(ra,oa);Na=T.a(Na,Va);var Gc=M.Oa(1,null);Gc.sheetName=C;return Le.i(M,"ClearPrintArea",Gc,ra,Na,Ib,null,0)}var C=this.$.xa.oa.name,
M=this.$.qa.ta;return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,e,function(ra){return new Ee.a(243,0,ra,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(ra){return new sj.a(243,0,ra,void 0,Ub)},J)};G.prototype.S7h=function(J,oa,Va){function Ub(){return new W(ra)}function e(Na,Ib,Gc){var id=C.$.qa.ta;Na=T.b(Na,oa);Ib=T.a(Ib,Va);var Uc=id.Oa(9,null);Uc.sheetCell=ra;return Le.i(id,"InsertPageBreak",Uc,Na,Ib,Gc,null,0)}var C=this,M=Oa.g(this.$),ra=nh.o(M.ha.va.activeCell,this.$);return Ag.EwaSettings.tc()?
oe.a(this.$.userOperationManager,e,function(Na){return new Ee.a(244,0,Na,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(Na){return new sj.a(244,0,Na,void 0,Ub)},J)};G.prototype.X7h=function(J,oa,Va){function Ub(){return new ia(ra)}function e(Na,Ib,Gc){var id=C.$.qa.ta;Na=T.b(Na,oa);Ib=T.a(Ib,Va);var Uc=id.Oa(9,null);Uc.sheetCell=ra;return Le.i(id,"RemovePageBreak",Uc,Na,Ib,Gc,null,0)}var C=this,M=Oa.g(this.$),ra=nh.o(M.ha.va.activeCell,this.$);return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,
e,function(Na){return new Ee.a(245,0,Na,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(Na){return new sj.a(245,0,Na,void 0,Ub)},J)};G.prototype.Z7h=function(J,oa,Va){function Ub(){return new P(M)}function e(ra,Na,Ib){var Gc=C.$.qa.ta;ra=T.b(ra,oa);Na=T.a(Na,Va);var id=Gc.Oa(9,null);id.sheetName=M;return Le.i(Gc,"ResetAllPageBreaks",id,ra,Na,Ib,null,0)}var C=this,M=this.$.xa.oa.name;return Ag.EwaSettings.tc()?oe.a(this.$.userOperationManager,e,function(ra){return new Ee.a(246,0,ra,64,Ub)},
J):oe.a(this.$.userOperationManager,e,function(ra){return new sj.a(246,0,ra,void 0,Ub)},J)};G.prototype.NOh=function(J,oa,Va){if(!J||!oa||!Va)return null;var Ub=new w;Ub.FirstRow=oa.FirstRow===J.LastRow+1?Va.getRowIndex(J.LastRow+1)+1:oa.FirstRow<J.FirstRow?0:Va.getRowIndex(oa.FirstRow+1);Ub.LastRow=oa.FirstRow===J.LastRow+1||oa.LastRow>J.LastRow?Va.getRowIndex(J.LastRow+1)+1:Va.getRowIndex(oa.LastRow+1);return Ub};G.prototype.MOh=function(J,oa,Va){if(!J||!oa||!Va)return null;var Ub=new w;Ub.FirstColumn=
oa.FirstColumn===J.LastColumn+1?Va.getColumnIndex(J.LastColumn+1)+1:oa.FirstColumn<J.FirstColumn?0:Va.getColumnIndex(oa.FirstColumn+1);Ub.LastColumn=oa.FirstColumn===J.LastColumn+1||oa.LastColumn>J.LastColumn?Va.getColumnIndex(J.LastColumn+1)+1:Va.getColumnIndex(oa.LastColumn+1);return Ub};G.prototype.I3g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=J.getPrintArea();if(!Ub||!Ub.length)return null;var e=J.getRowIndex(Va.FirstRow+1),C=J.getColumnIndex(Va.FirstColumn+1),M=null,ra=null;Ub=yl(Ub);
for(var Na=Ub.next();!Na.done;Na=Ub.next())if(Na=Na.value,e>=Na.FirstRow&&e<=Na.LastRow&&C>=Na.FirstColumn&&C<=Na.LastColumn){if(Va.FirstRow===Na.FirstRow&&Va.FirstColumn===Na.FirstColumn)return new U;e>Na.FirstRow&&(M=Object.assign(new B,{Index:e-1,Min:Na.FirstColumn-1,Max:Math.min(Na.LastColumn,J.getColumnIndex(oa.LastColumn+1))}));C>Na.FirstColumn&&(ra=Object.assign(new B,{Index:C-1,Min:Na.FirstRow-1,Max:Math.min(Na.LastRow,J.getRowIndex(oa.LastRow+1))}));break}return M||ra?Object.assign(new U,
{Row:M?[M]:null,Col:ra?[ra]:null}):null};G.prototype.S4g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=null;Va.FirstRow>oa.FirstRow&&Va.FirstRow<=oa.LastRow?Ub=Object.assign(new B,{Index:J.getRowIndex(Va.FirstRow+1)-1,Min:-1,Max:-1}):Va.FirstRow===oa.LastRow+1&&(Ub=Object.assign(new B,{Index:J.getRowIndex(oa.LastRow+1),Min:-1,Max:-1}));return Ub};G.prototype.r0g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=null;Va.FirstColumn>oa.FirstColumn&&Va.FirstColumn<=oa.LastColumn?Ub=Object.assign(new B,
{Index:J.getColumnIndex(Va.FirstColumn+1)-1,Min:-1,Max:-1}):Va.FirstColumn===oa.LastColumn+1&&(Ub=Object.assign(new B,{Index:J.getColumnIndex(oa.LastColumn+1),Min:-1,Max:-1}));return Ub};G.prototype.MBe=function(J,oa,Va){if(!Va||!J||!oa)return null;var Ub=this.S4g(J,oa,Va);J=this.r0g(J,oa,Va);return Ub||J?Object.assign(new U,{Row:Ub?[Ub]:null,Col:J?[J]:null}):null};G.prototype.V7h=function(){var J=new Xb.StandardDialog;J.kc=0;J.Cc(1,nf.a.instance.ea(4));J.Kk(nf.a.instance.ea(559),nf.a.instance.ea(560),
1,null)};G.prototype.Kwj=function(J){if(this.$ua.wb(J)&&(this.uOf&&(this.zDb=this.$.Ub.Fc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.eKa.wb(J)&&this.eKa.remove(J),this.eKa.add(J,vk.a.create().toString()),Oa.g(this.$).Ji)){var oa=Gd.b()?Gd.b().pi(J):"";Oa.g(this.$).Ji.X6(this.$ua.na(J),this.eKa.na(J),oa)}};G.prototype.eSg=function(J){if(this.zDb&&J){var oa=this.zDb.Ac;this.zDb.stop();this.zDb=null;switch(J){case "SetPrintArea":this.Nob(oa,1700,J);break;case "ClearPrintArea":this.Nob(oa,
1500,J);break;case "InsertPageBreak":this.Nob(oa,1500,J);break;case "RemovePageBreak":this.Nob(oa,1600,J);break;case "ResetAllPageBreaks":this.Nob(oa,1700,J)}}};G.prototype.Nob=function(J,oa,Va){J>oa&&(oa=Object.assign(new Oh.a,{extendedProperties:new Map}),oa.extendedProperties.set("OperationName",Va),oa.extendedProperties.set("OperationExecutionTime",J.toString()),mg.Health.instance.recordQosError(Yj.a.yvj,[zh.a.tvj],!1,!0,!0,!1,oa))};G.prototype.EYh=function(J,oa,Va,Ub,e,C){var M=this,ra=new Xb.StandardDialog,
Na=new ok.a(nf.a.instance.ea(557),nf.a.instance.ea(558),nf.a.instance.ea(6),nf.a.instance.ea(5));ra.kc=1;ra.Cc(1,Na.confirmButton);ra.Cc(0,Na.cancelButton);ra.Kk(Na.title,Na.body,3,function(Ib){1===Ib&&(M.FWf(J.command,e,C),M.n9e(J,Va,Ub,oa,C))})};G.prototype.NLb=function(J,oa,Va){Va();this.eKa.wb(oa)&&J.Ji.m0(this.eKa.na(oa),Kj.BasicTelemetryCalculator.sQ)};G.prototype.$Td=function(){this.Ind&&this.$.Ce(-1753588160,-1,0,null)};Object(Ze.a)(G,"PrintAreaBreakManager",null,[347]);var dl=b(384);r.prototype.equals=
function(J){return J?this.orientation===J.orientation&&this.$ba===J.$ba&&this.V_===J.V_&&this.margin===J.margin&&this.sheetPrintOptions===J.sheetPrintOptions&&this.y0a===J.y0a&&this.NoColor===J.NoColor:!1};r.Pze=function(J,oa){J&&oa&&(oa.lv=J.lv,oa.orientation=J.orientation,oa.$ba=J.$ba,oa.V_=J.V_,oa.margin=J.margin,oa.ignorePrintArea=J.ignorePrintArea,oa.sheetPrintOptions=J.sheetPrintOptions,oa.y0a=J.y0a,oa.NoColor=J.NoColor)};Object(Ze.a)(r,"PrintSettingsContainer",null,[]);var il=b(148),cl=b(337),
Bk=b(947),Rk=b(908),pk=b(686);Object(Ze.a)(z,"PrintSettingMarginOption",null,[]);Object(Ze.a)(t,"PrintSettingMarginValue",null,[]);Object(Ze.a)(x,"PrintSettingOption",null,[]);A.prototype.dispose=function(){};A.prototype.Bub=function(J){if(!J)return null;var oa=new t;oa.left=J.Left;oa.right=J.Right;oa.top=J.Top;oa.bottom=J.Bottom;oa.header=J.Header;oa.footer=J.Footer;return oa};A.prototype.B2c=function(J){ud.ULS.shipAssertTag(537154186,0,6===J.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");
var oa={};oa.Top=J[0];oa.Bottom=J[1];oa.Left=J[2];oa.Right=J[3];oa.Header=J[4];oa.Footer=J[5];return oa};A.prototype.e5h=function(){this.Zge=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1184)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1177)}),Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1176)})];this.kae=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1187)}),
Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1186)})];this.Bae=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1189)}),Object.assign(new x,{printSettingOptionKey:5,printSettingOptionText:this.Om.ea(1190)}),Object.assign(new x,{printSettingOptionKey:6,printSettingOptionText:this.Om.ea(1197)}),Object.assign(new x,{printSettingOptionKey:7,printSettingOptionText:this.Om.ea(1191)}),Object.assign(new x,{printSettingOptionKey:8,printSettingOptionText:this.Om.ea(1192)}),
Object.assign(new x,{printSettingOptionKey:9,printSettingOptionText:this.Om.ea(1193)}),Object.assign(new x,{printSettingOptionKey:11,printSettingOptionText:this.Om.ea(1194)}),Object.assign(new x,{printSettingOptionKey:12,printSettingOptionText:this.Om.ea(1195)}),Object.assign(new x,{printSettingOptionKey:13,printSettingOptionText:this.Om.ea(1196)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1188)})];this.mde=[Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1205)}),
Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1206)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1207)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1208)})];this.f9d=[Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1211)}),marginValue:this.Bub(this.normal)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:1,
printSettingOptionText:this.Om.ea(1212)}),marginValue:this.Bub(this.wide)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1213)}),marginValue:this.Bub(this.narrow)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1214)}),marginValue:this.Bub(this.c6)})]};A.prototype.Y4h=function(){this.normal=this.B2c(this.Pvi);this.narrow=this.B2c(this.Fui);this.wide=this.B2c(this.iPj)};
tl.Object.defineProperties(A.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Zge}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.kae}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.Bae}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.mde}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.f9d}}});A.Z8g=1;A.L8g=1;A.Jqb=9;A.Q8g=2;A.J8g=0;A.C8g=!1;
A.y8g=!1;A.xHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(Ze.a)(A,"PrintSettingsManagerBase",null,[3]);var $k=b(120);m.prototype.getSheetName=function(){return this.sheetName};Object(Ze.a)(m,"MacroRecorderSheetPrintOptionsSavedPayload",null,[98]);vm(v,A);v.prototype.L7h=function(J){var oa=this;this.M7h(function(Va){J&&(Va=oa.SOh(Va),J(Va))})};v.prototype.UJd=function(J,oa){if(J){var Va=new I(J.lv,J.ignorePrintArea);this.fcj(Va);!oa||this.$0f?ud.ULS.sendTraceTag(593294034,
0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",oa?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(oa=this.UOh(J.V_),oa.IsLandscape=2===J.orientation,oa.PaperSize=J.$ba,this.isUniversalPrintEnabled&&(oa.NoColor=J.NoColor),this.jwa&&(oa.PageMargin=this.ned(J.margin)),oa.SheetPrintOptions=A.xHa,oa.SheetPrintOptions.PrintGrid=J.sheetPrintOptions.PrintGrid,oa.SheetPrintOptions.HorizontalCenter=J.sheetPrintOptions.HorizontalCenter,
oa.SheetPrintOptions.VerticalCenter=J.sheetPrintOptions.VerticalCenter,oa.SheetPrintOptions.PrintHeaders=J.sheetPrintOptions.PrintHeaders,this.ecj(oa))}else ud.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};v.prototype.ned=function(J){var oa={};J?1===J?oa=this.wide:2===J?oa=this.narrow:3===J&&(oa=this.c6):oa=this.normal;return oa};v.prototype.c8h=function(J){var oa=this;if(J){ud.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");
var Va=function(){return new m(oa.$.xa.oa.name,J)},Ub=this.$.qa.ta,e=this.$.qa.ta.Xb(),C=function(M,ra,Na){var Ib=oa.$.xa.oa.name;M=T.b(oa.$yd,M);ra=T.a(oa.hzd,ra);var Gc=Ub.Oa(1,null);Gc.sheetName=Ib;Gc.printOptions=J;return Le.i(Ub,"SetPrintOptions",Gc,M,ra,Na,e,0)};Va=Ag.EwaSettings.tc()?new Ee.a(598,0,C,64,Va):new sj.a(598,0,C,void 0,Va);this.$.userOperationManager.ic(Va,null)}else ud.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};
v.prototype.dispose=function(){this.Ld||(this.Ld=!0,this.$.userOperationManager.pz(this.aF),this.RX())};v.prototype.fcj=function(J){this.qN.lv=J.lv;this.qN.ignorePrintArea=J.ignorePrintArea};v.prototype.M7h=function(J){function oa(ra,Na,Ib){return S(e.$.qa.ta,e.sheetName,e.locale,T.b(ra,Ub),T.a(Na,Va),Ib,C)}function Va(ra){ra=wi.a.yg(ra.data);ud.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",vh.a.Uc(ra));J(null)}function Ub(ra){Vg.a(ra)?
ud.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",vh.a.Uc(ra.Errors)):(ud.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),J(ra.Result))}var e=this,C=this.$.qa.ta.Xb();var M=Ag.EwaSettings.tc()?new Ee.a(247,0,oa,80):new sj.a(247,0,oa,16);M=this.$.userOperationManager.ic(M,null);this.Su.add(M)};v.prototype.ecj=function(J){var oa=this;ud.ULS.sendTraceTag(593294031,
0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Va=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ee.a(226,0,function(Ub,e,C){return ma(oa.$.qa.ta,oa.sheetName,J,T.b(Ub,oa.CJi),T.a(e,oa.BJi),C,Va)},void 0,function(){return new O(oa.sheetName,J)}),null)};v.prototype.Cdi=function(J){return this.y$e(J)||!this.qcf(J.PaperSize)};v.prototype.o$c=function(J){this.y$e(J)&&(ud.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),
J.ScalingWidth=v.u4c,J.ScalingHeight=v.t4c,J.ScalingPercent=v.j4b,J.FitToPage=v.n4c);this.qcf(J.PaperSize)||(ud.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",J.PaperSize.toString()),J.PaperSize=v.Jqb);return J};v.prototype.QOh=function(J){if(J.FitToPage){if(1===J.ScalingWidth&&1===J.ScalingHeight)return 1;if(!J.ScalingWidth&&1===J.ScalingHeight)return 3}else return 0;return 2};v.prototype.POh=function(J){return this.qnd(J,
this.normal)?0:this.qnd(J,this.wide)?1:this.qnd(J,this.narrow)?2:3};v.prototype.qnd=function(J,oa){return J.Left===oa.Left&&J.Right===oa.Right&&J.Top===oa.Top&&J.Bottom===oa.Bottom&&J.Header===oa.Header&&J.Footer===oa.Footer};v.prototype.UOh=function(J){var oa={};oa.ScalingPercent=v.j4b;oa.FitToPage=!!J;2===J?(oa.ScalingWidth=1,oa.ScalingHeight=0):3===J?(oa.ScalingWidth=0,oa.ScalingHeight=1):1===J&&(oa.ScalingWidth=1,oa.ScalingHeight=1);return oa};v.prototype.qcf=function(J){return this.SOi.contains(J.toString())};
v.prototype.y$e=function(J){return 100!==J.ScalingPercent||J.FitToPage&&(1<J.ScalingWidth||1<J.ScalingHeight)};v.prototype.iZg=function(){for(var J=new pk.a(Tg.a.Ik()),oa=0;oa<this.paperSizeOptions.length;oa++)J.add(this.paperSizeOptions[oa].printSettingOptionKey.toString());return J};v.prototype.SOh=function(J){var oa=null;if(J){var Va=this.qN.lv,Ub=this.qN.ignorePrintArea;this.Cdi(J)&&(this.$0f=!0,J=this.o$c(J));oa=new r;oa.lv=Va;oa.ignorePrintArea=Ub;oa.orientation=J.IsLandscape?2:1;oa.$ba=J.PaperSize;
oa.V_=this.QOh(J);oa.sheetPrintOptions=A.xHa;oa.sheetPrintOptions.PrintGrid=J.SheetPrintOptions.PrintGrid;oa.y0a=J.Draft;this.isUniversalPrintEnabled&&(oa.NoColor=J.NoColor);oa.sheetPrintOptions.HorizontalCenter=J.SheetPrintOptions.HorizontalCenter;oa.sheetPrintOptions.VerticalCenter=J.SheetPrintOptions.VerticalCenter;oa.sheetPrintOptions.PrintHeaders=J.SheetPrintOptions.PrintHeaders;this.jwa&&(oa.margin=this.POh(J.PageMargin),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
ud.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",oa.margin),3===oa.margin&&(this.c6={},this.c6.Left=J.PageMargin.Left,this.c6.Right=J.PageMargin.Right,this.c6.Top=J.PageMargin.Top,this.c6.Bottom=J.PageMargin.Bottom,this.c6.Header=J.PageMargin.Header,this.c6.Footer=J.PageMargin.Footer))}return oa};v.prototype.RX=function(){if(this.Su){for(var J=yl(this.Su),oa=J.next();!oa.done;oa=J.next())oa=oa.value,this.$&&this.$.userOperationManager&&(oa.operation&&ud.ULS.sendTraceTag(537154187,0,
50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",$k.a(oa.operation.operationName)),this.$.userOperationManager.CHa(oa)),this.Su.remove(oa);this.Su=null}};v.u4c=1;v.t4c=0;v.j4b=100;v.Jqb=9;v.n4c=!0;Object(Ze.a)(v,"PrintSettingsManager",A,[]);Object(Ze.a)(u,"PrintSettingsTaskPaneCallbacks",null,[]);Object(Ze.a)(f,"SelectedPrintSettings",null,[]);Object(Ze.a)(l,"PrintOperationCallbacks",null,[]);Object(Ze.a)(n,"PrintPreviewPaneCallbacks",null,[]);var el=
b(1186);Object(Ze.a)(k,"UniversalPrintAppSettings",null,[]);var Xi=b(374);c.prototype.WBg=function(J){this.Ma.addHandler("ppocek",J)};c.prototype.P5i=function(J){this.Ma.removeHandler("ppocek",J)};c.prototype.stj=function(J,oa){this.G9i();this.$.userOperationManager.uy(this.aF);this.Im=J;this.Ma.raiseEvent("ppocek");this.Im.SelectedRanges&&this.Im.SelectedRanges.Ranges&&0<this.Im.SelectedRanges.Ranges.length&&this.Im.SelectedRanges.Ranges[0]&&(this.selectedRange=nh.B(this.Im.SelectedRanges.Ranges[0]).toString());
ud.ULS.shipAssertTag(537154268,0,!this.Tu,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Tu=new v(this,this.$,oa,this.$.xa.oa.name,nf.a.instance,this.isUniversalPrintEnabled);ud.ULS.shipAssertTag(537154267,0,!this.qg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.qg=new Rk.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.qg.Cbh();this.qg.utj();this.qg.nBg(this.Kwf)};c.prototype.fMh=function(){this.Tu.c6&&
4<=this.Tu.marginDetailedOptions.length&&(this.Tu.marginDetailedOptions[3].marginValue=this.Tu.Bub(this.Tu.c6));return this.Tu.marginDetailedOptions};c.prototype.fvc=function(){return!!this.Im&&!!this.Im.ObjectId||!Oa.g(this.$).ha.va.Dh};c.prototype.VOh=function(){var J=Object.assign(new f,{selectedWhatToPrint:A.Z8g,selectedOrientation:A.L8g,selectedPaperSize:A.Jqb,selectedScaling:A.Q8g,selectedMargin:A.J8g,selectedIgnorePrintArea:A.C8g,selectedPrintGridlines:A.xHa.PrintGrid,selectedDraft:A.y8g,selectedHorizontalCenter:A.xHa.HorizontalCenter,
selectedVerticalCenter:A.xHa.VerticalCenter,selectedRowAndColumnHeadings:A.xHa.PrintHeaders});this.ZG?(J.selectedWhatToPrint=this.ZG.lv,J.selectedOrientation=this.ZG.orientation,J.selectedPaperSize=this.ZG.$ba,J.selectedScaling=this.ZG.V_,this.jwa&&(J.selectedMargin=this.ZG.margin),J.selectedIgnorePrintArea=this.ZG.ignorePrintArea,J.selectedPrintGridlines=this.ZG.sheetPrintOptions.PrintGrid,J.selectedDraft=this.ZG.y0a,this.isUniversalPrintEnabled&&(J.selectedColor=this.ZG.NoColor?0:1),J.selectedHorizontalCenter=
this.ZG.sheetPrintOptions.HorizontalCenter,J.selectedVerticalCenter=this.ZG.sheetPrintOptions.VerticalCenter,J.selectedRowAndColumnHeadings=this.ZG.sheetPrintOptions.PrintHeaders):ud.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return J};c.prototype.zZe=function(){var J=this;return Object.assign(new n,{onBackToSheet:function(){J.kla()}})};c.prototype.ROh=function(){var J=this;return Object.assign(new el.a,{backActionButtonText:nf.a.instance.ea(1164),
printPreviewPaneCallbacks:this.zZe(),logger:new dl.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new l,{onClosePreviewer:function(){J.kla()},getGraphServiceAuthorizationToken:this.v9b(),onLocalPrint:function(){J.Bxf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object.assign(new k,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.h9h()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,
appName:"Excel"})})};c.prototype.TOh=function(){var J=this;return Object.assign(new u,{onSettingChange:function(oa){J.pIi(oa)},onPrint:function(){J.Bxf()}})};c.prototype.pIi=function(J){this.w_++;J?(this.qg&&this.qg.nuj(),this.sk.lv=J.selectedWhatToPrint,this.sk.V_=J.selectedScaling,this.sk.orientation=J.selectedOrientation,this.sk.$ba=J.selectedPaperSize,this.isUniversalPrintEnabled&&(this.sk.NoColor=!J.selectedColor),this.jwa&&(this.sk.margin=J.selectedMargin),this.sk.ignorePrintArea=J.selectedIgnorePrintArea,
this.bkj(J.selectedPageStart,J.selectedPageEnd),this.Tu&&this.QZh(this.sk,J)?(this.sk.sheetPrintOptions=A.xHa,this.sk.sheetPrintOptions.PrintGrid=J.selectedPrintGridlines,this.sk.sheetPrintOptions.HorizontalCenter=J.selectedHorizontalCenter,this.sk.sheetPrintOptions.VerticalCenter=J.selectedVerticalCenter,this.sk.sheetPrintOptions.PrintHeaders=J.selectedRowAndColumnHeadings,this.Tu.c8h(this.sk.sheetPrintOptions)):this.Xwb()):ud.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};
c.prototype.kla=function(){this.S4a&&(this.MKb=!0);ud.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.w_);this.Axf();this.Tve()};c.prototype.Bxf=function(){ud.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.w_);this.jwa&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
ud.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.sk.margin,this.ZG.margin);if(this.useMSPdfViewer)this.xFf();else if(this.z5a)try{this.qg.printPdf(),this.q_c()}catch(J){ud.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.xFf()}else this.Sha.b0f(this.WGa(!0)),this.q_c()};c.prototype.xFf=function(){var J=this.WGa(!0);this.q_c();li.HelperMethods.sf(J,
void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};c.prototype.dispose=function(){Kg.a.Fa(this.Ma)};c.prototype.Xwb=function(){var J=this;if(this.$.Tva)this.I7h();else{this.RX();this.dQf();var oa=null;this.y4h();ud.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Va=function(Ub,e,C){Ub=new pj.a(Ub,null,e,C,null,!0,!1,"GetFileCopyFileHandler","");Ub.correlationID=vk.a.create().toString();oa=Ub;J.oba=J.G2.g9(J.WGa(J.z5a?
!1:!0,J.a9h?"Base64":"Pdf"),1,null,null,c.I9c,!1,2,J.Xxd,J.Wxd,oa,void 0,void 0,void 0,12E4);Ub.requestId=J.oba;ud.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",J.oba);return kb.Task.Ta(!0)};this.uMa=Ag.EwaSettings.tc()?this.$.userOperationManager.ic(new Ee.a(223,0,Va,80),null):this.$.userOperationManager.ic(new sj.a(223,0,Va,16),null)}};c.prototype.q_c=function(){this.Axf();this.Tve()};c.prototype.$yd=function(J){vh.a.Pq(J.Errors)?
this.qg.showErrorMessageForPrintOptions(nf.a.instance.ea(1215)):(ud.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Xwb(),this.qg&&this.qg.hideErrorMessageForPrintOptions())};c.prototype.hzd=function(J){this.qg&&this.qg.showErrorMessageForPrintOptions(nf.a.instance.ea(1215));J=wi.a.yg(J.data);ud.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",
vh.a.Uc(J))};c.prototype.I7h=function(){function J(Ub,e,C){var M={};M.WhatToPrint=oa.sk.lv;M.UseNamedAction=oa.Sha.Cvc();M.SelectedSheetName=oa.$.xa.oa.name;M.ActiveCell=oa.activeCell;M.SelectedRanges=[oa.selectedRange];M.IsPdfDocumentRequired=!1;M.Orientation=oa.sk.orientation;M.PaperSize=oa.sk.$ba;M.Scaling=oa.sk.V_;M.RichValuesEnabled=!0;M.IgnorePrintArea=oa.sk.ignorePrintArea;M.Preview=!0;oa.isUniversalPrintEnabled&&(M.NoColor=oa.sk.NoColor);oa.CYf()&&(M.PaginationStartPage=oa.kya,M.PaginationEndPage=
oa.Ela,M.OutputTotalPdfPageCount=!0);if(oa.jwa){var ra=oa.Tu.ned(oa.sk.margin);ra&&(M.PageMargin={},M.PageMargin.Top=ra.Top,M.PageMargin.Bottom=ra.Bottom,M.PageMargin.Left=ra.Left,M.PageMargin.Right=ra.Right,M.PageMargin.Header=ra.Header,M.PageMargin.Footer=ra.Footer)}oa.B6a=Y(oa.$.qa.ta,M,T.b(oa.hBi,Ub),T.a(oa.gBi,e),C,Va);return oa.B6a}var oa=this;ud.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.RX();var Va=this.$.qa.ta.Xb();
Ag.EwaSettings.tc()?this.uMa=this.$.userOperationManager.ic(new Ee.a(133,0,J,80),null):this.uMa=this.$.userOperationManager.ic(new sj.a(133,0,J,16),null)};c.prototype.Tve=function(){this.$.userOperationManager.pz(this.aF);this.RX();this.dQf();ud.ULS.shipAssertTag(537154261,0,!!this.qg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.qg&&(this.qg.r5i(this.Kwf),this.qg.Lbh(),this.qg=null);this.Im=null;this.Tu&&(this.Tu.dispose(),this.Tu=null);this.Y1a=this.MDb=
null;this.nJc=!1;this.Ma&&this.Ma.raiseEvent("ppocek")};c.prototype.cpj=function(){return this.$.isEditMode&&!!this.ZG&&!!this.sk&&2!==this.sk.lv&&this.jhd()};c.prototype.UJd=function(){ud.ULS.shipAssertTag(537154260,0,!!this.Tu,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Tu&&this.Tu.UJd(this.sk,this.cpj())};c.prototype.WGa=function(J,oa){oa=void 0===oa?"Pdf":oa;var Va=new Sys.StringBuilder;Va.append(Pj.a(this.$,oa,!0));fi.a.Vf(Va,Pf.a.yDd,""+this.sk.lv);
J&&this.Sha.Cvc()&&fi.a.Vf(Va,Pf.a.Fag,"1");fi.a.Vf(Va,Pf.a.OGf,this.$.xa.oa.name);this.sk.lv||(fi.a.Vf(Va,Pf.a.NGf,this.selectedRange),fi.a.Vf(Va,Pf.a.HGf,this.activeCell));fi.a.Vf(Va,Pf.a.IGf,""+this.sk.orientation);fi.a.Vf(Va,Pf.a.JGf,""+this.sk.$ba);fi.a.Vf(Va,Pf.a.MGf,""+this.sk.V_);fi.a.Vf(Va,Pf.a.LGf,"1");fi.a.Vf(Va,Pf.a.GGf,this.sk.ignorePrintArea?"1":"0");fi.a.Vf(Va,Pf.a.KGf,"1");this.CFg(Va);this.isUniversalPrintEnabled&&fi.a.Vf(Va,Pf.a.eWi,this.sk.NoColor?"1":"0");this.jwa&&this.BFg(Va);
Fc.a.equals(oa,"Pdf",!0)&&(Va.append("&#toolbar=0"),Va.append("&zoom=100"));J=Va.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ud.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",J);return J};c.prototype.bkj=function(J,oa){J||oa?(this.nxb=!0,this.kya=J,this.Ela=oa):this.sPf()};c.prototype.CFg=function(J){this.CYf()&&(fi.a.Vf(J,Pf.a.gWi,""+this.kya),fi.a.Vf(J,Pf.a.fWi,""+this.Ela),fi.a.Vf(J,Pf.a.hWi,"1"),ud.ULS.sendTraceTag(537154258,0,50,
"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.kya,this.Ela))};c.prototype.CYf=function(){return null!=this.kya&&0<this.kya&&null!=this.Ela&&0<this.Ela};c.prototype.BFg=function(J){if(this.Tu&&this.sk){var oa=this.Tu.ned(this.sk.margin);oa&&fi.a.Vf(J,Pf.a.dWi,""+oa.Top+" "+oa.Bottom+" "+oa.Left+" "+oa.Right+" "+oa.Header+" "+oa.Footer)}};c.prototype.ZBb=function(J,oa,Va,Ub){this.qg&&(ud.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.oa&&(this.z5a?(Ub||(Ub=this.WGa(!1)),this.qg.mli(Ub)):this.mtj()))};c.prototype.jhd=function(){return!this.ZG.equals(this.sk)};c.prototype.Axf=function(){!this.MKb&&0<this.w_&&(this.Jnd?this.UJd():ud.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ud.ULS.shipAssertTag(537154250,0,!!this.qg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.qg&&this.qg.Z_h();this.$Td()};
c.prototype.ri=function(){ud.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.qg){var J=this.sza(nf.a.instance.ea(1));this.hna(J,1)}else J=vh.a.jd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),Ag.EwaSettings.az()?new cl.a(this.$,J):(new il.ErrorDialog(this.$,J)).nf()};c.prototype.ttj=function(J){J?(!J.lv&&this.fvc()&&(ud.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Im.ObjectId?"floatingObject":"discontinuousRange"),J.lv=1),r.Pze(J,this.ZG),r.Pze(J,this.sk),ud.ULS.shipAssertTag(537154248,0,!!this.qg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.qg&&(this.Jnd=!0,this.qg.vtj(),this.Xwb())):(ud.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.ri())};c.prototype.eZc=function(J,oa,Va){J>oa&&(oa=Object.assign(new Oh.a,{extendedProperties:new Map}),oa.extendedProperties.set("WtpSelectedValue",
Va),oa.extendedProperties.set("FullyRenderedPdfLoadTime",J.toString()),mg.Health.instance.recordQosError(Yj.a.wvj,[zh.a.h1f],!1,!0,!0,!1,oa))};c.prototype.RX=function(){this.uMa&&(0<this.oba||this.B6a)&&(ud.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.oba),this.$.userOperationManager.CHa(this.uMa),this.B6a?wi.a.Zt(this.B6a.kt):this.G2.Zt(this.oba),this.zId())};c.prototype.zId=function(){this.B6a=this.uMa=null};c.prototype.y4h=
function(){this.SHd&&this.sk&&(this.Y1a=this.$.Ub.Fc("UserAction",(1===this.sk.lv?"ActiveSheet":this.sk.lv?"EntireWorkbook":"CurrentSelection")+"FullyRenderedPdfLoadTimeStopwatch"))};c.prototype.sPf=function(){this.nxb=!1;this.kya=1;this.Ela=this.LCd};c.prototype.sza=function(J){if(J)return J.replace("&#39;","'");ud.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return J};c.prototype.mtj=function(){ud.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");
if(this.dyb)if(this.Kfc)ud.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var J=this.sza(nf.a.instance.ea(1169));this.hna(J,2)}else J=this.sza(nf.a.instance.ea(1170)),this.hna(J,3)};c.prototype.hna=function(J,oa,Va){this.qg.xz(J,oa,void 0===Va?null:Va)};c.prototype.K4h=function(){this.Kfc=this.Bve();this.dyb=this.CSg();this.z5a=this.DSg();ud.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",
this.Kfc,this.dyb,this.z5a)};c.prototype.G9i=function(){this.y6a=null;this.zId();this.sPf();this.MDb=this.$.Ub.Fc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.w_=0;this.Jnd=this.S4a=this.MKb=!1;this.nJc=!0};c.prototype.arj=function(){var J=this.pfc&&this.nef()?!0:!1;ud.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",J);return J};c.prototype.Bve=function(){return!Rg.a.xA};c.prototype.kSg=function(){var J=15;Rg.a.iH&&Rg.a.yrb&&
(J=parseFloat(Rg.a.yrb));return this.Bve()&&14<J&&this.dyb};c.prototype.CSg=function(){var J=this.$.ig.get(111);return this.pfc?J:J&&!this.nef()};c.prototype.nef=function(){return Rg.a.rC||ld.AFrameworkApplication.isUnifiedHostMode};c.prototype.DSg=function(){return this.Kfc&&this.dyb};c.prototype.dQf=function(){this.y6a&&(URL.revokeObjectURL(this.y6a),this.y6a=null)};c.prototype.g0g=function(J){var oa=J.data.fe;J=this.$.Ub.Fc("UserAction","PrintPreviewBlobFileCreation");var Va=window.self.atob(oa);
oa=new Uint8Array(oa.length);for(var Ub=0;Ub<Va.length;Ub++)oa[Ub]=Va.charCodeAt(Ub)&255;Va=new Blob([oa],{type:"application/pdf"});this.y6a=URL.createObjectURL(Va);ud.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",J.Ac,Va.size);J.stop();return this.y6a+"#toolbar=0&zoom=100"};c.prototype.l_i=function(J){if(this.SHd&&vh.a.hh(J,c.dQi)){var oa=Object.assign(new Oh.a,{extendedProperties:new Map});oa.extendedProperties.set("ErrorMessageIdName",
J[0].MessageIdName);mg.Health.instance.recordQosError(Yj.a.vFf,[zh.a.wFf],!1,!0,!0,!1,oa)}};c.prototype.QZh=function(J,oa){return J.sheetPrintOptions.PrintGrid!==oa.selectedPrintGridlines||J.sheetPrintOptions.HorizontalCenter!==oa.selectedHorizontalCenter||J.sheetPrintOptions.VerticalCenter!==oa.selectedVerticalCenter||J.sheetPrintOptions.PrintHeaders!==oa.selectedRowAndColumnHeadings};c.prototype.$Td=function(){this.Ind&&this.$.Ce(-1753588160,-1,0,null)};c.prototype.h9h=function(){return!!this.$.ya&&
!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};c.prototype.getToken=function(){return this.Awd.XR("Print",this.graphServiceEndpoint).then(function(J){return J?(J.IsSuccess||ud.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",J.ErrorCode,J.ErrorMessage),J):Object.assign(new Bk.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(J){var oa=new Bk.a;Object.getType(J)===
Object.getType(oa)?oa=J:(oa.ErrorMessage=J.toString(),oa.ErrorCode="exception");return Promise.resolve(oa)})};c.prototype.v9b=function(){var J=this;return function(){var oa=Promise.resolve("");try{if(J.Awd&&J.Awd.gLa())return J.getToken().then(function(Va){return Va.IsSuccess?Promise.resolve(Va.Token):oa},function(){return oa})}catch(Va){ud.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Va)}return oa}};c.prototype.onNotifyPrintJobStatus=
function(J,oa){J=Xi.a.sy.notificationBar.k$(J,!1);J.displayTimeoutSeconds=10;J.image="failure"===oa?1:"success"===oa?3:0;Xi.a.sy.notificationBar.BD(J)};tl.Object.defineProperties(c.prototype,{Bdi:{configurable:!0,enumerable:!0,get:function(){return this.nJc}}});c.dQi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];c.I9c=["Content-Type","Total-Pdf-PageCount"];Object(Ze.a)(c,"PrintPreviewManager",
null,[341,3,342]);d.prototype.Xc=function(){return!1};d.prototype.executeCommand=function(J,oa,Va,Ub){var e=oa.command;return 1588554917===e?(oa.uxb=!0,uk.a(this.$)&&this.$.da.Aa(423).Wvc(!1),this.tch(oa)?kb.Task.Ta(!0):Ed.a(e)):this.tFf.executeCommand(J,oa,Va,Ub,this.XHi,this.WHi,this.iEj)};d.prototype.Gc=function(J,oa){return 1588554917===oa.command?(ud.ULS.shipAssertTag(537154305,0,this.$.Yja,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.tFf.Gc(J,
oa)};d.prototype.fd=function(){return!1};d.prototype.tch=function(J){return this.$.fa.oc?this.uch(J):!1};d.prototype.uch=function(J){ud.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var oa=this.$.Ub.Fc("UserAction","DoPrintHtml"),Va=this.$,Ub=this.fa.isNamedObjectViewMode?Va.xb.oa.sheetName:Va.xa.oa.name,e=this.fa.isNamedObjectViewMode,C=!e;Va=this.OOh(Va,Ub,C);var M=!0;!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Tva&&(M=!1);
C?M?Ak.a(this.$)?ud.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.NC.stj(Va,this.qN),ud.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new Q(this.$,nf.a.instance.ea(1178),3,Va,J,this.Sha,Ub,this.qN)).nf(),ud.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",oa.Ac)):((new ca(this.$,nf.a.instance.ea(1178),3,Va,J)).nf(),ud.ULS.sendTraceTag(591196514,
0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",oa.Ac,e));oa.stop();this.Jgd();return!0};d.prototype.OOh=function(J,oa,Va){var Ub={};Ub.SessionId=this.fa.sessionId;Ub.UsedRangeTooBig=!1;var e=Oa.g(J),C=e.ha,M=C.Te;if(Hk.e(J.oa))Ub.Type=0,Ub.ObjectId=J.oa.name,Ub.UseSelection=!1;else if(Hk.g(J.oa))Ub.Type=1,Ub.ObjectId=J.oa.Eja,Ub.UseSelection=!0;else if(2===M||4===M||64===M)e=C.Qa.nc.floatingObject,Ub.Type=1,Ub.SheetName=oa,Ub.ObjectId=
e.id,Ub.UseSelection=!0;else if(Va&&M&470)Ub.ObjectId=C.Qa.nc.floatingObject.id,Ub.SheetName=oa;else if(Hk.i(J.oa)){Ub.Type=2;Ub.SheetName=oa;if(C.va.Dh)if(Va=C.va.Qd,Ub.SelectedRanges=nh.q(Va,J),20<Va.DT)Ub.UseSelection=!0;else{oa=0;e=e.sl("PrintCommandHandler.DoPrintHtml",Va);try{for(e.$$rst();e.$$mn()&&2>oa;)e.$$cu().text&&oa++;Ub.UseSelection=2<=oa}finally{e&&e.dispose()}}else Ub.UseSelection=!1,Ub.SelectedRanges=nh.q(C.va.activeRange,J);this.fa.isNamedObjectViewMode&&(Ub.UsedRange=nh.v(J.oa.usedRange,
J))}Ub.Title=J.workbookContext.WorkbookFileName;return Ub};d.prototype.Jgd=function(){Oa.g(this.$);if(!this.MYf){this.WOc=!0;var J=this.$.Ub.Fc("UserAction","HandlePageLayoutRendering");this.yEj();ud.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",J.Ac);J.stop()}};d.prototype.yEj=function(){for(var J=Oa.g(this.$).Ca,oa=J.oE(),Va=!1,Ub=0,e=0;e<oa.length;e++){var C=oa[e],M=C.yf;M&&M.hasPageLayout()&&(Va=!0,M.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
C.Xd,4),Ub++)}Va&&(ud.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",oa.length,Ub),J.jwd())};tl.Object.defineProperties(d.prototype,{MYf:{configurable:!0,enumerable:!0,get:function(){return this.WOc}}});Object(Ze.a)(d,"PrintCommandHandler",null,[147,319]);var wj=Ka.a;vm(a,wj);a.prototype.Md=function(){var J=this,oa=ld.AFrameworkApplication.ga.appSettings,Va=this.$.ya.DirectPrintSetting;
oa.DirectPrintIsEnabled=Va.DirectPrintIsEnabled.toString();oa.DirectPrintProbeIsEnabled=Va.DirectPrintProbeIsEnabled.toString();oa.DirectPrintEnabledForInternetExplorer=Va.DirectPrintEnabledForInternetExplorer.toString();oa.DirectPrintSupportedMimeTypes=Va.DirectPrintSupportedMimeTypes;oa.DirectPrintSupportedPlugins=Va.DirectPrintSupportedPlugins;oa.DirectPrintImmersivePreviewPlugins=Va.DirectPrintImmersivePreviewPlugins;oa.DirectPrintMinimalSupportedEdgeVersion=Va.DirectPrintMinimalSupportedEdgeVersion;
oa.DirectPrintEnabledForEdge=Va.DirectPrintEnabledForEdge.toString();oa=new Ia(oa);var Ub=null;Va=null;try{Va=window.navigator.mimeTypes}catch(M){ud.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var e=null;try{e=window.navigator.plugins}catch(M){ud.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Ub=new na(oa,Va,e,na.V$e,na.bef,new lb(ld.AFrameworkApplication.sa.MW),ld.AFrameworkApplication.sa.fD,na.cef,function(M,ra){return new Ma(M,!1,ra)},
!1);if(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.ig.get(116)){var C=qc.GetServiceTaskFactory.Xa(this.$.da,349,350,this.tb);mc.TaskExtensions.Ba(C,function(){var M=new d(J.$,Ub,C.result);J.Ed([M])},this.$.ma)}else this.Ed([new d(this.$,Ub,null)])};a.ja=function(J){Ka.a.de(73,new a(J))};Object(Ze.a)(a,"PrintCommandHandlerFactory",Ka.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");sg.a.Yi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");pg.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Lg.a.instance.mj(new Id);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Qe.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");Xf.main();Type.registerNamespace("Common.App.SaveToSharePoint");df.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ih.main();Type.registerNamespace("Common.App.SaveACopy");
Tf.main();Type.registerNamespace("Common.App.SharedFilePicker");Ff.main();Type.registerNamespace("Common.App.WildFire");jg.main();qe.a.Ga(Yf.ja);qe.a.Ga(Fe.ja);qe.a.Ga(yd.ja);sg.a.Yi(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
qe.a.Ga(ve.ja);sg.a.Yi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){qe.a.Ga(function(J){cb.ja(J)})})();(function(){qe.a.Ga(function(J){J.da.Ha(165,new ye(J))})})();qe.a.Ga(Jc.ja);(function(){qe.a.Ga(function(J){J.da.Ha(57,new Xe(J));J.da.Ha(60,new gd(J));J.da.Ha(63,new xd(J))})})();qe.a.Ga(Hb.ja);qe.a.Ga(Xc.ja);qe.a.Ga(Lc.ja);sg.a.Yi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){qe.a.Ga(function(J){Wd.ja(J);gb.ja(J)})})();sg.a.Yi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
sg.a.Yi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){qe.a.Ga(function(J){Yd.ja(J);mb.ja(J)})})();qe.a.Ga(uc.ja);qe.a.Ga(Jb.ja);(function(){qe.a.Ga(function(J){db.ja(J);Wa.ja(J)})})();qe.a.Ga(Ua.ja);qe.a.Ga(pb.ja);(function(){qe.a.Ga(function(J){sb.ja(J);va.ja(J)})})();qe.a.Ga(Fb.ja);(function(){qe.a.Ga(function(J){za.ja(J);Ya.ja(J)})})();Type.registerNamespace("Common.App.DirectPrint");Lg.a.instance.mj(new xa);qe.a.Ga(a.ja)},831:function(y,
D,b){function a(B,U){var N=w.call(this,document.createElement("div"))||this;N.Zw=null;N.hX=null;N.J7=null;N.pba=null;N.e1b=null;N.zhe=null;N.$me=null;N.uhf=null;N.Svb=!1;N.Vy=!1;N.l4=!1;N.nKa=!1;N.tAi=function(P){N.XE(P)};N.wAi=function(P){13===P.keyCode&&N.XE(P)};N.Owd=function(P){N.Vo(P.zb);return!0};N.Wwd=function(P){N.H5(P.zb);return!0};N.Byd=function(P){N.ula(P.zb);return!0};N.X0=B;N.zG=U;N.WVc=U.cob.toString();N.title=U.title;N.message=U.message;N.set_visibilityMode(1);return N}b.d(D,"a",function(){return a});
y=b(0);var d=b(13),c=b(88),k=b(276),n=b(12),l=b(117),f=b(91);D=b(232);var u=b(1174),v=b(16),m=b(4),A=b(316),x=b(51),t=b(11),z=b(69),r=b(14),G=b(20),w=D.a;vm(a,w);a.prototype.dispose=function(){c.a.pc([this.e1b,this.hX,this.J7]);this.Vy&&this.hX&&(k.a.instance.za(n.a.click,this.hX.domElement,this.Owd),l.KeyInputManager.instance.jv(this.domElement,this.zhe));this.l4&&this.J7&&(k.a.instance.za(n.a.click,this.J7.domElement,this.Wwd),l.KeyInputManager.instance.jv(this.domElement,this.$me));this.nKa&&this.pba&&
(k.a.instance.za(n.a.click,this.pba,this.Byd),l.KeyInputManager.instance.jv(this.domElement,this.uhf));this.pba=this.Zw=this.X0=this.J7=this.hX=null;w.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.qIj=function(){this.LBe(!0)};a.prototype.I1c=function(){this.LBe(!1)};a.prototype.LBe=function(B){var U="<div class='"+u.a.lih+"' id='{0}'><div class='"+u.a.jih+"'><a class='"+u.a.rih+"' title='{1}'><span class='"+v.a.b_c+" "+u.a.nih+"' id='{2}'>";this.Vj.length&&(U+="<img class='{3}' src='{4}'/>");
U+="</span></a><span class='"+u.a.qih+"' id='{5}'>{6}</span><span class='"+u.a.pih+"' id='message'>{7}</span><a id='link' href='#' class='"+u.a.oih+"'>{8}</a><span class='"+u.a.VJe+"'><button type='button' id='action' class='"+u.a.UJe+"'>{9}</button></span><span class='"+u.a.VJe+"'><button type='button' id='altAction' class='"+u.a.UJe+"'>{10}</button></span></div><a class='"+u.a.mih+"' tabindex='0' role='button'><span id='close' class='"+v.a.OB+"'><img class='"+v.a.f8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";
B||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var N=this.businessBar.$.Ib;B=N+"ewaBusinessBarEntryBody"+this.WVc;var P=N+"ewaBusinessBarEntryTitle"+this.WVc;N=N+"ewaBusinessBarEntryIcon"+this.WVc;this.domElement.className=u.a.kih;this.domElement.innerHTML=String.format(U,B,this.alt,N,this.Vj,x.a.Be(0),P,this.title,this.message,this.linkText,this.actionButton,this.aYa,x.a.Be(13),r.a.instance.ea(773));t.DOMElementExtensions.ro(this.domElement,m.a.Bga,P,B);
this.pba=$get("link",this.domElement);t.DOMElementExtensions.setVisible(this.pba,this.nKa);this.nKa&&(k.a.instance.pa(n.a.click,this.pba,this.Byd),this.uhf=l.KeyInputManager.instance.Ur(this.pba,this.Byd,f.a.$h,f.a.K0));this.hX=new A.a(t.DOMElementExtensions.getElementById(this.domElement,"action"));this.hX.isVisible=this.Vy;this.J7=new A.a(t.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.J7.isVisible=this.l4;this.Vy&&(k.a.instance.pa(n.a.click,this.hX.domElement,this.Owd),
this.zhe=l.KeyInputManager.instance.Ur(this.hX.domElement,this.Owd,f.a.$h,f.a.K0),this.l4&&(k.a.instance.pa(n.a.click,this.J7.domElement,this.Wwd),this.$me=l.KeyInputManager.instance.Ur(this.hX.domElement,this.Wwd,f.a.$h,f.a.K0)));this.Zw=$get("close",this.domElement);this.e1b=this.Nd.Cd(this.Zw);this.e1b.ja("click",this.tAi);this.e1b.ja("keydown",this.wAi);t.DOMElementExtensions.setVisible(this.Zw,!this.Svb)};a.prototype.Vo=function(){d.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",
this.zG.hash,this.zG.a7c);G.g(this.businessBar.$).Dq(!0)};a.prototype.H5=function(){d.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.zG.hash);G.g(this.businessBar.$).Dq(!0)};a.prototype.ula=function(){d.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.zG.hash);G.g(this.businessBar.$).Dq(!0)};a.prototype.XE=function(B){d.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",
this.zG.hash,this.zG.a7c);this.set_visible(!1);this.businessBar.removeEntry(this.ONg);z.g(B)};tl.Object.defineProperties(a.prototype,{ONg:{configurable:!0,enumerable:!0,get:function(){return this.zG.cob}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.X0}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.actionButton:""}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.aYa:""}},linkText:{configurable:!0,enumerable:!0,
get:function(){return this.zG?this.zG.link:""}},Vj:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.Vj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.alt:""}}});Object(y.a)(a,"BusinessBarEntry",D.a,[])},908:function(y,D,b){function a(Q,O,ba,ca){var S=I.call(this)||this;S.fF=null;S.PC=null;S.gR=null;S.Vx=null;S.NEb=null;S.sK=null;S.dic=null;S.Xzb=null;S.Wzb=!1;S.Yva=!0;S.Pnc=null;S.ewaAccessibilityManager=null;S.KCd=null;S.JCd=null;S.NCd=null;S.Ald=
!1;S.nvf=function(){v.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",S.Wzb);S.Wzb&&(S.g0h(),S.sK.style.visibility="visible",S.dic?S.dic.stop():v.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),S.raiseEvent(a.tBb,new u(1)),S.cMd(),S.Wzb=!1)};S.$=Q;S.NC=O;S.e4g();S.pfc=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);S.useMSPdfViewer=
ba;S.isUniversalPrintEnabled=ca;return S}function d(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function c(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=
null}function k(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function n(Q){this.qg=Q}function l(Q){this.qg=Q}function f(Q){this.qg=Q}function u(Q){var O=U.call(this)||this;O.fUi=Q;return O}b.r(D);y=b(0);var v=b(13),m=b(5);b(23);var A=b(384),x=b(36),t=b(56),z=b(11),r=b(121),G=b(1),w=b(14),B=b(20),U=Sys.EventArgs;vm(u,U);Object(y.a)(u,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var N=b(256),P=b(245);f.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};
f.prototype.s7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};f.prototype.Ah=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};f.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};f.prototype.Vh=function(){};f.prototype.Qe=function(Q,O){return O?!1:(this.qg.enterPrintPreviewHeaderFocusTrapZone(),!0)};tl.Object.defineProperties(f.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.yFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=
b(908).PrintPreviewPane;return document.getElementById(Q.eUi)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(f,"PrintPreviewHeaderKeyboardAccessibleSection",null,[107]);l.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};l.prototype.s7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};l.prototype.Ah=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};l.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};
l.prototype.Vh=function(){};l.prototype.Qe=function(Q,O){return O?!1:(this.qg.useMSPdfViewer?(Q=document.getElementById(b(908).PrintPreviewPane.KAd))&&z.DOMElementExtensions.setFocus(Q,!0):z.DOMElementExtensions.setFocus(this.qg.sK),!0)};tl.Object.defineProperties(l.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.zFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=b(908).PrintPreviewPane;return this.qg.useMSPdfViewer?document.getElementById(b(908).PrintPreviewPane.KAd):
document.getElementById(Q.WCf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(l,"PrintPreviewKeyboardAccessibleSection",null,[107]);n.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};n.prototype.s7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};n.prototype.Ah=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};n.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};n.prototype.Vh=function(){};
n.prototype.Qe=function(Q,O){return O?!1:(this.qg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};tl.Object.defineProperties(n.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.CFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=b(908).PrintPreviewPane;return document.getElementById(Q.MCd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(n,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[107]);Object(y.a)(k,"MSPdfViewerFileUrl",
null,[]);Object(y.a)(c,"PrintSettingsTaskPaneProps",null,[]);Object(y.a)(d,"ViewerPaneProps",null,[]);var ia=b(1186),W=b(376),R=b(4);b.d(D,"PrintPreviewPane",function(){return a});var I=x.a;vm(a,I);a.prototype.nBg=function(Q){this.addHandler(a.tBb,Q)};a.prototype.r5i=function(Q){this.removeHandler(a.tBb,Q)};a.prototype.utj=function(){this.a4g()};a.prototype.vtj=function(){var Q=this.$.Ub.Fc("UserAction","createSettingsPaneStopwatch"),O=document.getElementById(a.MCd);this.f4g();var ba=this.g4g();this.PC.createPrintSettingsTaskPane(O,
ba);Q.stop();this.Wzb=!1;if(this.isUniversalPrintEnabled&&this.Vx){Q="A4";switch(ba.selectedPrintSettingsValues.selectedPaperSize){case 8:Q="A3";break;case 9:Q="A4";break;case 11:Q="A5";break;case 12:Q="JIS B4";break;case 13:Q="JIS B5";break;case 5:Q="North America Legal";break;case 1:Q="North America Letter";break;case 6:Q="North America Invoice";break;case 7:Q="North America Executive";break;case 3:Q="North America Ledger"}this.fF.setDocumentSettings({mediaSize:Q,orientation:2===ba.selectedPrintSettingsValues.selectedOrientation?
"landscape":"portrait",colorMode:1===ba.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.xFd()};a.prototype.setPageRangeSettings=function(Q,O,ba,ca,S){this.PC&&(this.PC.setPageRangeSettings(Q,O,ba,ca,S),this.tWf(String.format(w.a.instance.Cb(195),ca,S,Q)))};a.prototype.Z_h=function(){this.Vx&&(this.Vx.style.display="none")};a.prototype.Lbh=function(){this.dispose();this.SUd();this.rGj();this.fF&&this.fF.closePrintPreviewPane();this.gR=this.PC=this.fF=this.Vx=null};a.prototype.mli=
function(Q){v.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.Xzb=this.$.Ub.Fc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||v.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.gR.renderPdf(Q)):this.sK&&((this.dic=this.$.Ub.Fc("UserAction","loadPdfStopwatch"))||v.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.Wzb=
!0,this.sK.src&&this.sK.src===Q?this.nvf(null):this.sK.src=Q);if(this.isUniversalPrintEnabled&&this.Vx){var O=W.b(this.$.workbookContext);this.fF.setFileUrl(Q,O)}};a.prototype.onPdfLoad=function(){this.Xzb?(v.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.Xzb.Ac,this.Yva),this.Xzb.stop()):v.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.tBb,new u(1));this.hideWaitCursor();
this.cMd()};a.prototype.printPdf=function(){z.DOMElementExtensions.setFocus(this.sK);this.sK.contentWindow.print()};a.prototype.nuj=function(){this.showSpinner();this.showWaitCursor();this.tWf("")};a.prototype.g0h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.xz=function(Q,O,ba){this.Vx&&this.gR&&(this.Ald=!1,this.gR.showErrorDetails(O,Q,void 0===ba?null:ba),this.NC.S4a=!0,this.sK&&(this.sK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.ndi(O)&&(this.Ald=!0,this.$Hi()))};
a.prototype.hidePreviewError=function(){this.NC.S4a=!1;this.gR.hidePreviewError();this.enablePrintButton()};a.prototype.Cbh=function(){(this.NEb=document.getElementById(a.AFf))&&this.NEb.parentNode&&this.NEb.parentNode.removeChild(this.NEb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.PC&&this.PC.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(Q){this.PC&&this.PC.showErrorMessageForPrintOptions(Q)};a.prototype.showSpinner=function(){this.NC.S4a||
G.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Ald?this.hidePreviewError():this.sK&&(this.sK.style.visibility="hidden");this.gR&&this.gR.showSpinner()};a.prototype.hideSpinner=function(){this.gR&&this.gR.hideSpinner()};a.prototype.enablePrintButton=function(){this.PC&&this.PC.enablePrintButton();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.PC&&this.PC.disablePrintButton();
this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.PC&&this.PC.showWaitCursor();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.PC&&this.PC.hideWaitCursor();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!0)};a.prototype.c4g=function(){if(this.Vx)v.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");
else if(this.Vx=document.createElement("div"),this.Vx.id=a.AFf,this.Vx.classList.add(a.gUi),this.$.Oq.insertBefore(this.Vx,this.$.Oq.firstChild),m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Ai){var Q=document.getElementById(R.a.xFa);Q&&(this.Vx.style.top=Q.clientHeight+"px",this.Vx.style.height="calc(100% - "+Q.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.fF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=
function(){this.fF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.WRi=function(){var Q=this;this.$.da.Za(15,function(O){Q.ewaAccessibilityManager=O;Q.ewaAccessibilityManager.mode=3})};a.prototype.e4g=function(){this.NCd=new n(this);this.KCd=new l(this);this.JCd=new f(this)};a.prototype.xFd=function(){this.NCd.Tg();this.KCd.Tg();this.JCd.Tg();this.WRi()};a.prototype.SUd=function(){this.NCd.s7();this.KCd.s7();this.JCd.s7();B.g(this.$).e0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0)};a.prototype.iW=function(){this.Pnc=r.a.instance.Cd(this.sK);this.Pnc.ja("load",this.nvf)};a.prototype.rGj=function(){this.Pnc&&this.sK&&this.Pnc.detach("load")};a.prototype.cMd=function(){if(this.Yva){var Q=document.getElementById(a.MCd);Q&&(Q=z.DOMElementExtensions.getElementById(Q,a.uFf))&&(this.Yva=!1,Q.focus())}};a.prototype.$Hi=function(){this.NC.S4a=!1;this.enablePrintButton();this.cMd()};a.prototype.a4g=function(){var Q=this;t.GetServiceTaskFactory.Xa(this.$.da,283,284,0).result.wo.loadScript("excelPrintPreviewer").then(function(){var O=
Q.$.Ub.Fc("UserAction","createEmptyPreviewerStopwatch");Q.c4g();Q.d4g();Q.isUniversalPrintEnabled?Q.fF.createEmptyPrintPreviewPaneAsync(Q.Vx,Q.SBe()).then(function(){O.stop();Q.Hye();Q.fF.updatePrintButtonEnableDisableState(!1)}):(Q.fF.createEmptyPrintPreviewPane(Q.Vx,Q.SBe()),O.stop(),Q.Hye())})};a.prototype.Hye=function(){var Q=this.$.Ub.Fc("UserAction","createPdfPreviewPaneStopwatch"),O=document.getElementById(a.KAd);this.useMSPdfViewer&&(O.tabIndex=0);this.O3g();this.N3g(O);Q.stop();this.raiseEvent(a.tBb,
new u(0))};a.prototype.d4g=function(){this.fF||(this.fF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.fF||v.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.f4g=function(){this.PC||(this.PC=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.PC||v.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};
a.prototype.O3g=function(){this.gR||(this.gR=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.gR||v.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.N3g=function(Q){this.pfc?this.gR.createPrintPreviewPane(Q,this.p6g()):this.gR.createPrintPreview(Q);this.useMSPdfViewer||(this.sK=z.DOMElementExtensions.getElementById(this.Vx,a.WCf),this.sK.title=w.a.instance.ea(1166),
this.iW())};a.prototype.g4g=function(){var Q="en-US";var O=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?Q=this.$.ya.DataCultureTag:v.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object.assign(new c,{whatToPrintOptions:this.NC.Tu.whatToPrintOptions,orientationOptions:this.NC.Tu.orientationOptions,paperSizeOptions:this.NC.Tu.paperSizeOptions,scalingOptions:this.NC.Tu.scalingOptions,marginDetailedOptions:this.NC.fMh(),
selectedPrintSettingsValues:this.NC.VOh(),printSettingsTaskPaneCallbacks:this.NC.TOh(),logger:new A.a,shouldDisableCurrentSelection:this.NC.fvc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:O,dataCultureTag:Q,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.SBe=function(){return this.isUniversalPrintEnabled?this.NC.ROh():Object.assign(new ia.a,{backActionButtonText:w.a.instance.ea(1164),printPreviewPaneCallbacks:this.NC.zZe(),logger:new A.a,disableTellMeControl:!0})};
a.prototype.p6g=function(){var Q=this;return this.useMSPdfViewer?Object.assign(new d,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.c3g(),onPdfLoad:function(){Q.onPdfLoad()}}):Object.assign(new d,{useMSPdfViewer:!1})};a.prototype.c3g=function(){return Object.assign(new k,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.tWf=function(Q){this.Vx&&this.fF.setAdditionalHeaderText(Q)};
a.ndi=function(Q){return 3===Q||2===Q};a.AFf="PrintPreviewerContainer";a.MCd="printSettingsTaskPaneId";a.KAd="previewId";a.WCf="printpreviewiframe";a.eUi="printPreviewHeaderId";a.uFf="printButton";a.gUi="PrintPreviewerContainer";a.tBb="pppnosu";Object(y.a)(a,"PrintPreviewPane",x.a,[351])},975:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(5),k=b(47),n=b(23);a.WTe=function(l,f){switch(l){case 3:return a.KUh(f);case 2:return a.UNh(f);case 1:return a.nIh(f)}return""};
a.KUh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.UNh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.nIh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(l,f,u){if(n.a.Yg||n.a.Ip)window.setTimeout(function(){a.zJf(u,a.Yac())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Jne(u),l,0,!1)};a.qUg=function(l,f,u,v){f&&v&&v();a.openInClient(l,f,u)};a.Yac=function(){return n.a.Yg?1:n.a.Ip?2:n.a.r6a?3:n.a.isMac?4:0};a.GUh=function(l){switch(l){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";
case 1:return"WildFireExcelBizBar";default:return""}};a.HUh=function(l){switch(l){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.zJf=function(l,f){1===f?(d.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),l=a.WTe(l,f),8<n.a.f4a?k.a.sf(l,void 0,void 0,"RedirectToAppStore"):k.a.wU(l)):document.hidden||(a.nfc?(l=c.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?
(d.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),k.a.wU(l)):d.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(d.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.WTe(l,f),null,null)))};a.Jne=function(l){switch(l){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.pbd=function(l){switch(l){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";
default:return""}};a.Rmd=function(l){return(l=a.cLh(l))&&""!==l?Boolean.parse(l):!1};a.SMd=function(l){a.njj(l)};a.cLh=function(l){try{return localStorage.getItem(l)}catch(f){return d.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+f.message),null}};a.njj=function(l){try{localStorage.setItem(l,"true")}catch(f){d.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+f.message)}};tl.Object.defineProperties(a,
{nfc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},Avc:{configurable:!0,enumerable:!0,get:function(){return(n.a.r6a||n.a.isMac)&&n.a.Po}},Bqj:{configurable:!0,enumerable:!0,get:function(){return n.a.Yg||n.a.Ip}}});a.Ive="ChromeExtensionBarDismiss";Object(y.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/489a43098ed73a990c05237e58f9d5d3/EwaDS.kmhv.js.map