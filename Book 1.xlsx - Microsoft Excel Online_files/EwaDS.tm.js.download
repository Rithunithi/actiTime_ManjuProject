(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1270:function(y,D,b){function a(){var A=m.call(this)||this;A.Nmf=3E4;A.Pnd=void 0;A.UW={};A.aXd={};A.Mnb={};A.Kdf=!1;return A}function d(A){var x=u.call(this)||this;x.$=A;x.dc();return x}b.r(D);y=b(0);var c=b(13),k=b(1),n=b(74),l=b(8),f=b(216),u=f.a;vm(d,u);d.prototype.create=function(){var A=b(1270).RenderingFidelityTracker,x=this.$.da.Aa(462);x||(x=this.$.da.Ha(462,new A));this.Fb(x)};Object(y.a)(d,"RenderingFidelityTrackerFactory",
f.a,[]);var v=b(46);b.d(D,"RenderingFidelityTracker",function(){return a});var m=n.a;vm(a,m);a.prototype.FEg=function(A,x,t,z){void 0===this.Pnd&&(this.Pnd=k.EwaSettings.isChangeGateEnabled("OfficeVSO:5839331_RFMetricPhase4"));this.Pnd?this.GEg(A,x,t,z):this.HEg(A,x,t,z)};a.ja=function(A){A.da.Ha(463,new d(A))};a.prototype.HEg=function(A,x,t,z){var r=this;if(!(v.PageLoadTrackingInfo.instance.naa(new Date)<this.Nmf||this.Kdf)){var G=l.HelperMethods.Ska(function(){for(var w=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(x),
B=Object.keys(w),U=r.Mnb[A],N=0;N<B.length;N++){var P=B[N];(null===U||void 0===U?0:U[P])&&r.UW[P]&&(r.UW[P]-=U[P])}r.Mnb[A]=w;for(U=0;U<B.length;U++)if(N=B[U],P=w[N],r.UW[N]&&(P+=r.UW[N]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(N,P)){r.Kdf=!0;r.UW={};r.Mnb={};c.ULS.sendTraceTag(529065378,0,50,"Session Vetoed because of : { key:"+N+", isHC:"+t+", scaleFactor:"+z+"}");break}else r.UW[N]=P});1<G&&c.ULS.sendTraceTag(537151041,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",
G)}};a.prototype.GEg=function(A,x,t,z){var r=this;if(!(v.PageLoadTrackingInfo.instance.naa(new Date)<this.Nmf)){var G=l.HelperMethods.Ska(function(){for(var w=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(x),B=Object.keys(w),U=r.Mnb[A],N=0;N<B.length;N++){var P=B[N];r.aXd[P]||(null===U||void 0===U?0:U[P])&&r.UW[P]&&(r.UW[P]-=U[P])}r.Mnb[A]=w;for(U=0;U<B.length;U++)if(N=B[U],!r.aXd[N])if(P=w[N],r.UW[N]&&(P+=r.UW[N]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(N,
P)){r.aXd[N]=!0;c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+N+", isHC:"+t+", scaleFactor:"+z+"}");break}else r.UW[N]=P});1<G&&c.ULS.sendTraceTag(527472323,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",G)}};Object(y.a)(a,"RenderingFidelityTracker",n.a,[723,3])},1382:function(y,D,b){function a(ya){var qa=this;this.a8a=function(){qa.dDf(qa.mRe)};this.Hg=function(){qa.dDf(qa.SJg)};this.$=ya;this.SJg=
new $d.a;this.mRe=new $d.a;Id.g(this.$).Ca.np(this.Hg);Id.g(this.$).Ca.oke(this.a8a)}function d(ya,qa,ub){this.BNj=ya;this.vU=qa;this.name=ub}function c(ya,qa,ub,Dd,be,Je){qa=void 0===qa?null:qa;ub=void 0===ub?null:ub;Dd=void 0===Dd?null:Dd;be=void 0===be?null:be;Je=void 0===Je?!1:Je;var Cf=kf.call(this)||this;Cf.Jrh=[We.a.qre,We.a.RJe,We.a.SJe,We.a.ldc,We.a.gic,We.a.$hf,We.a.renderCachedContent,We.a.renderServerContent,We.a.j3b,We.a.SRf,We.a.TRf,We.a.URf,We.a.ggj];Cf.Wee=null;Cf.TVa=null;Cf.Aqe=
null;Cf.S8d=null;Cf.geb=null;Cf.IMb=null;Cf.sCa=null;Cf.ckb=null;Cf.nre=!1;Cf.ZCf=!1;Cf.Sbg=null;Cf.hId=null;Cf.bbg=null;Cf.Zag=null;Cf.$ag=null;Cf.kyf=function(Jg,$g){for(Jg=0;Jg<$g.entries.length;Jg++){var Tg=$g.entries[Jg];Tg.url=nd.a.removeParameter(Tg.url,Xc.AFrameworkApplication.YO);var Dh=nd.a.Eca(Tg.url);Cf.kei(Tg.url,Dh)&&(Tg.behavior=1);if("img"===Tg.Xt.initiatorType&&Dh.endsWith(ei.a.eHe)){var Mh=nd.a.dja(Tg.url,ei.a.V5c),Oh=nd.a.dja(Tg.url,ei.a.W5c);Tg.q$=Tg.q$+"imageID="+Mh+", imgStateID="+
Oh}Mh=Tg.Xt[We.a.transferSize];Oh=null;void 0!==Mh&&null!==Mh&&(Oh=!Mh);Pg.PageLoadTrackingInfo.instance.Sxg(Dh,Math.round(Tg.Xt.fetchStart),Math.round(Tg.Xt.responseEnd),Oh,Cf.Gfi);pe.a.contains(Dh,We.a.richTextEditor,!0)&&(Dh=Gi.TextEditorTelemetry.instance,Dh.CD(We.a.w$i,Math.round(Tg.Xt.fetchStart)),Dh.CD(We.a.y$i,Math.round(Tg.Xt.responseEnd)))}};Cf.HV=function(){var Jg=Cf.b7,$g;for($g in Jg)Jg[$g].h=!0};Cf.userSessionId=ya;Cf.u_a=qa=qa||new xb.a;Cf.Pg=ub||Qf.a.Ra;Cf.jyj=Dd||Cf;Cf.ef=be;Cf.Gfi=
Je;Cf.GDe=qa.m7a();Cf.ef&&Cf.ef.aFa(Cf.HV);return Cf}function k(){}function n(){}function l(){}function f(){}function u(){}function v(){}function m(ya,qa){this.MJd=void 0===qa?1:qa;this.total=ya}function A(){var ya=Ge.call(this)||this;ya.gvi=0;ya.operation="DOMUpdate";ya.target=null;ya.sender=null;return ya}function x(ya,qa){function ub(Je,Cf){null!=Cf&&(Dd[Je]=Cf)}var Dd={},be=null;switch(ya){case 0:be="Actions";ub("Id",qa.a);ub("Operation",null==qa.b?null:qa.b);ub("Target",qa.c);ub("StartTime",
null==qa.d?null:qa.d.toString());ub("Duration",null==qa.e?null:qa.e.toString());ub("CorrelationId",qa.f);ub("ParentAction",qa.g);ub("DocumentHidden",null==qa.h?null:qa.h.toString());break;case 1:be="CorrelationStart";ub("CorrelationId",qa.a);ub("UserSessionId",qa.b);ub("UserAction",qa.c);break;case 2:be="ReorderSheetOp";ub("UserSessionId",qa.a);ub("IsDragReorder",null==qa.b?null:qa.b.toString());ub("DocumentUp",null==qa.c?null:qa.c.toString());ub("OldIndex",null==qa.d?null:qa.d.toString());ub("NewIndex",
null==qa.e?null:qa.e.toString());ub("TotalSheets",null==qa.f?null:qa.f.toString());break;case 3:be="FormatCellOp";ub("UserSessionId",qa.a);ub("TaskId",null==qa.b?null:qa.b.toString());ub("NumberOfRanges",null==qa.c?null:qa.c.toString());ub("Ranges",qa.d);ub("ActiveCell",qa.e);ub("ActionId",null==qa.f?null:qa.f.toString());ub("CommandParameters",qa.g);ub("UserActionStopwatchId",qa.h);break;case 4:be="CopyOp";ub("UserSessionId",qa.a);ub("IsChrome",null==qa.b?null:qa.b.toString());ub("IsIE",null==qa.c?
null:qa.c.toString());ub("IsFromUI",null==qa.d?null:qa.d.toString());ub("IsCopyInLoadedRange",null==qa.e?null:qa.e.toString());ub("IsRepeatedCopy",null==qa.f?null:qa.f.toString());ub("IsClipboarAccessSupported",null==qa.g?null:qa.g.toString());ub("IsClipboarAccessInstallationSupported",null==qa.h?null:qa.h.toString());ub("RibbonCommand",null==qa.i?null:qa.i.toString());ub("CutCopyPasteFlags",null==qa.j?null:qa.j.toString());ub("IsDrag",null==qa.k?null:qa.k.toString());ub("IsIeBeforeAlowDenyPopUp",
null==qa.l?null:qa.l.toString());ub("IsPasteMatchCopy",qa.m);ub("WaitMessageInClipboard",qa.n);ub("CallCount",null==qa.o?null:qa.o.toString());break;case 5:be="PasteOp";ub("UserSessionId",qa.a);ub("IsChrome",null==qa.b?null:qa.b.toString());ub("IsIE",null==qa.c?null:qa.c.toString());ub("IsCopyActive",null==qa.d?null:qa.d.toString());ub("IsFromUI",null==qa.e?null:qa.e.toString());ub("IsClipboarAccessSupported",null==qa.f?null:qa.f.toString());ub("IsClipboarAccessInstallationSupported",null==qa.g?null:
qa.g.toString());ub("RibbonCommand",null==qa.h?null:qa.h.toString());ub("CutCopyPasteFlags",null==qa.i?null:qa.i.toString());ub("WaitMessageInClipboard",qa.j);ub("PopupDialog",qa.k);ub("SimplePopupMessage",qa.l);ub("DialogCloseButton",qa.m);ub("UserPressedInstallLink",qa.n);ub("CallCount",null==qa.o?null:qa.o.toString());break;case 6:be="GetNumberViewModelDataOp";ub("UserSessionId",qa.a);ub("NumberFormatOptionsPreviousOutputJson",qa.b);ub("NumberFormatOptionsNewInputJson",qa.c);break;case 7:be="InstantaneousSetData";
ub("Id",qa.a);ub("WasEmpty",null==qa.b?null:qa.b.toString());ub("ValueNotChanged",null==qa.c?null:qa.c.toString());ub("Source",qa.d);ub("ProcessingCompleted",null==qa.e?null:qa.e.toString());break;case 8:be="ImmediateSetData";ub("ClientStopwatchId",qa.a);ub("Operation",qa.b);ub("Parameters",qa.c);ub("WasUpdatedByImmediate",null==qa.d?null:qa.d.toString());ub("areHtmlElementsEqualClientComparison",null==qa.e?null:qa.e.toString());ub("WasDecisionMadeByHtmlComparison",null==qa.f?null:qa.f.toString());
ub("IsNumeric",null==qa.g?null:qa.g.toString());ub("IsDateTime",null==qa.h?null:qa.h.toString());ub("HasCurrencySymbol",null==qa.i?null:qa.i.toString());ub("HasPercentSymbol",null==qa.j?null:qa.j.toString());ub("IsFunc",null==qa.k?null:qa.k.toString());ub("DiffInWrappingWhitespace",null==qa.l?null:qa.l.toString());ub("ImmediatePattern",qa.m);ub("TextAlignmentMatch",null==qa.n?null:qa.n.toString());ub("FontColorMatch",null==qa.o?null:qa.o.toString());ub("FormulaTextMatch",null==qa.p?null:qa.p.toString());
ub("isFormula",null==qa.q?null:qa.q.toString());ub("FormulaText",qa.r);ub("InstantaneousPattern",qa.s);ub("AreHtmlInnerTextElementsEqualClientComparison",null==qa.t?null:qa.t.toString());ub("HtmlComparisonDecision",qa.u);break;case 9:be="DependentCellsCalc";ub("CalcStatus",qa.a);ub("SuccessfullyCalculatedRanges",null==qa.b?null:qa.b.toString());ub("RangesSkipped",null==qa.c?null:qa.c.toString());ub("TotalErrors",null==qa.d?null:qa.d.toString());ub("Partial",null==qa.e?null:qa.e.toString());ub("Canceled",
null==qa.f?null:qa.f.toString());ub("Aggregate",null==qa.g?null:qa.g.toString());ub("Unknown",null==qa.h?null:qa.h.toString());ub("UnavailableData",null==qa.i?null:qa.i.toString());ub("Cycle",null==qa.j?null:qa.j.toString());ub("NotImplemented",null==qa.k?null:qa.k.toString());ub("InvalidInput",null==qa.l?null:qa.l.toString());ub("AreDepCells",null==qa.m?null:qa.m.toString());break;case 10:be="DependentCellsGraphStat";ub("ParsedFormulas",null==qa.a?null:qa.a.toString());ub("GraphNodes",null==qa.b?
null:qa.b.toString());ub("GraphArcs",null==qa.c?null:qa.c.toString());ub("AnalyzedBlocks",null==qa.d?null:qa.d.toString());ub("IterationId",null==qa.e?null:qa.e.toString());ub("UniqueId",qa.f);ub("Aborted",null==qa.g?null:qa.g.toString());break;case 11:be="DependentCellsGraphSectionStat";ub("IterationId",null==qa.a?null:qa.a.toString());ub("BlockHash",qa.b);ub("Functions",qa.c);ub("Operators",qa.d);ub("CrossDocRefs",null==qa.e?null:qa.e.toString());ub("CrossSheetRefs",null==qa.f?null:qa.f.toString());
ub("ErrRefs",null==qa.g?null:qa.g.toString());ub("LargeRanges",null==qa.h?null:qa.h.toString());ub("NameRefs",null==qa.i?null:qa.i.toString());ub("ParserErrors",null==qa.j?null:qa.j.toString());ub("RowRefs",null==qa.k?null:qa.k.toString());ub("ColumnRefs",null==qa.l?null:qa.l.toString());ub("TableRefs",null==qa.m?null:qa.m.toString());ub("UniqueId",qa.n);ub("UnreachableReferences",null==qa.o?null:qa.o.toString());break;case 12:be="GetRangeContentPrefetchFailures";ub("UserSessionId",qa.a);ub("ClientStopwatchId",
qa.b);ub("StateId",null==qa.c?null:qa.c.toString());break;case 13:be="GridBlockUpdates";ub("UserSessionId",qa.a);ub("CorrelationId",qa.b);ub("Operation",qa.c);ub("PerformanceType",null==qa.d?null:qa.d.toString());ub("BlockHash",qa.e);ub("DurationInMs",null==qa.f?null:qa.f.toString());break;case 14:be="BrowserAppStart";ub("ScriptExecutionStart",null==qa.a?null:la.a.qsa(qa.a.getTime()));ub("UserSessionId",qa.b);ub("ClockMechanism",qa.c);ub("ScreenDPI",null==qa.d?null:qa.d.toString());ub("NavigationToScriptExecutionDelta",
null==qa.e?null:qa.e.toString());break;case 15:be="LinkedObjects";ub("ChildId",qa.a);ub("ParentId",qa.b);ub("ChildTable",qa.c);ub("ParentTable",qa.d);break;case 16:be="LongFrames";ub("StartTime",null==qa.a?null:la.a.qsa(qa.a.getTime()));ub("DurationInMs",null==qa.b?null:qa.b.toString());break;case 17:be="Task";ub("StopwatchId",qa.a);ub("Status",null==qa.b?null:qa.b.toString());ub("CreateTime",null==qa.c?null:qa.c.toString());ub("TaskId",null==qa.d?null:qa.d.toString());break;case 18:be="ConflictInEditing";
ub("OtherUserState",qa.a);ub("UserSessionId",qa.b);ub("ConflictTime",null==qa.c?null:la.a.qsa(qa.c.getTime()));break;case 19:be="IncomingPresenceData";ub("UserSessionId",qa.a);ub("UserId",qa.b);ub("Disconnected",null==qa.c?null:qa.c.toString());ub("ReceivedTime",null==qa.d?null:la.a.qsa(qa.d.getTime()));break;case 20:be="EditorTableDelay";ub("UserSessionId",qa.a);ub("UserId",qa.b);ub("Received",null==qa.c?null:qa.c.toString());ub("DurationInMs",null==qa.d?null:qa.d.toString());ub("NotAloneAtLogTime",
null==qa.e?null:qa.e.toString());ub("Time",null==qa.f?null:la.a.qsa(qa.f.getTime()));break;case 21:be="PresenceStartup";ub("UserSessionId",qa.a);ub("EverReceived",null==qa.b?null:qa.b.toString());ub("NotAloneOnOpen",null==qa.c?null:qa.c.toString());ub("NotAloneAtLogTime",null==qa.d?null:qa.d.toString());ub("EditorCount",null==qa.e?null:qa.e.toString());ub("WorkbookOpenToFirstReceivedInMs",null==qa.f?null:qa.f.toString());break;case 22:be="PresenceDelete";ub("UserSessionId",qa.a);ub("UserId",qa.b);
ub("Context",qa.c);ub("Reason",qa.d);ub("Time",null==qa.e?null:la.a.qsa(qa.e.getTime()));break;case 23:be="EditorEvent";ub("UserSessionId",qa.a);ub("UserId",qa.b);ub("Context",qa.c);ub("Time",null==qa.d?null:la.a.qsa(qa.d.getTime()));break;case 24:be="EditorTime";ub("UserSessionId",qa.a);ub("UserId",qa.b);ub("DurationInMs",null==qa.c?null:qa.c.toString());break;case 25:be="GridScreenReaderOps";ub("UserSessionId",qa.a);ub("CommandTaskId",qa.b);ub("CommandId",null==qa.c?null:qa.c.toString());ub("ClientSideOnly",
null==qa.d?null:qa.d.toString());ub("DurationInMS",null==qa.e?null:qa.e.toString());ub("ReachedMaxReadoutCells",null==qa.f?null:qa.f.toString());ub("RequstedCellCount",null==qa.g?null:qa.g.toString());ub("NonEmptyCellCount",null==qa.h?null:qa.h.toString());ub("Succeeded",null==qa.i?null:qa.i.toString());ub("Canceled",null==qa.j?null:qa.j.toString());ub("ErrorType",qa.k);break;case 26:be="SendPresenceToService";ub("UserSessionId",qa.a);ub("TotalCount",null==qa.b?null:qa.b.toString());ub("SendCount",
null==qa.c?null:qa.c.toString());break;case 27:be="IME";ub("UserSessionId",qa.a);break;case 28:be="FreezePaneFloatingObjects";ub("UserSessionId",qa.a);ub("ObjectType",null==qa.b?null:qa.b.toString());ub("ObjectID",qa.c);ub("SpannedPanesCount",null==qa.d?null:qa.d.toString());break;case 29:be="CustomizeStatusBar";ub("UserSessionId",qa.a);ub("UIControlName",qa.b);ub("IsControlVisible",null==qa.c?null:qa.c.toString());break;case 30:be="ClientWebRequests";ub("Path",qa.a);ub("ProxyStopwatchId",qa.b);ub("RequestStatus",
qa.c);ub("ResponseSizeInBytes",null==qa.d?null:qa.d.toString());ub("ClientRequestId",qa.e);ub("StateId",null==qa.f?null:qa.f.toString());break;case 31:be="ShowCommentTaskPane";ub("UserSessionId",qa.a);ub("IsFromKeyboardShortcut",null==qa.b?null:qa.b.toString());ub("IsShowPane",null==qa.c?null:qa.c.toString());ub("ShowForDeepLink",null==qa.d?null:qa.d.toString());ub("DeepLinkFound",null==qa.e?null:qa.e.toString());break;case 32:be="ApplyThreadedCommentChange";ub("UserSessionId",qa.a);ub("Operation",
null==qa.b?null:qa.b.toString());ub("CommentId",qa.c);ub("CommentsCount",null==qa.d?null:qa.d.toString());break;case 33:be="UpgradeLegacyCommentsChange";ub("UserSessionId",qa.a);ub("OperationSuccessful",null==qa.b?null:qa.b.toString());break;case 34:be="FindNextOrPreviousComment";ub("UserSessionId",qa.a);ub("Succeeded",null==qa.b?null:qa.b.toString());break;case 35:be="Goto";ub("UserSessionId",qa.a);ub("IsSucceeded",null==qa.b?null:qa.b.toString());ub("IsNOVMode",null==qa.c?null:qa.c.toString());
break;case 36:be="LaunchOfficeAddInDialog";ub("UserSessionId",qa.a);ub("SourceId",qa.b);ub("SourceLabel",qa.c);ub("Flight",qa.d);ub("Experiment",qa.e);ub("UICultureTag",qa.f);ub("UICultureTagLcid",null==qa.g?null:qa.g.toString());ub("WacHostId",null==qa.h?null:qa.h.toString());break;case 37:be="RichApiInvocation";ub("UserSessionId",qa.a);ub("Succeeded",null==qa.b?null:qa.b.toString());ub("ErrorType",qa.c);ub("ResultInfo",qa.d);ub("Source",qa.e);break;case 38:be="FxLibrary";ub("EntityName",qa.a);ub("EntryPoint",
null==qa.b?null:qa.b.toString());ub("Action",null==qa.c?null:qa.c.toString());ub("InsertLocation",null==qa.d?null:qa.d.toString());break;case 39:be="EmbeddedApiSession";ub("UserSessionId",qa.a);break;case 40:be="NumberFormattingCalculator";ub("Id",qa.a);ub("CounterName",qa.b);ub("Values",qa.c);break;case 41:be="RequestDataAfterSend";ub("ClientStopwatchId",qa.a);ub("RequestStatus",qa.b);ub("SendDuration",null==qa.c?null:qa.c.toString());ub("RequestId",null==qa.d?null:qa.d.toString());break;case 42:be=
"FloatingObjectsStopwatchData";ub("StopMessage",qa.a);ub("Type",null==qa.b?null:qa.b.toString());ub("GUID",qa.c);ub("Pane",null==qa.d?null:qa.d.toString());ub("IsAboveGrid",null==qa.e?null:qa.e.toString());ub("StartCorrelation",qa.f);ub("LoadImageCorrelation",qa.g);ub("SkippedGetEffectsExtents",null==qa.h?null:qa.h.toString());ub("Version",null==qa.i?null:qa.i.toString());break;case 43:be="Copy";ub("UserSessionId",qa.a);ub("Trigger",qa.b);ub("RibbonCommandName",qa.c);ub("SourceItem",qa.d);ub("SourceRangeCellCount",
null==qa.e?null:qa.e.toString());ub("ClientSideStopwatchId",qa.f);ub("CopyOperationId",qa.g);ub("IsAsync",null==qa.h?null:qa.h.toString());ub("IsFromCache",null==qa.i?null:qa.i.toString());ub("IsSuccessiveCopy",null==qa.j?null:qa.j.toString());ub("IsSelectionAllowed",null==qa.k?null:qa.k.toString());ub("IsSuccess",null==qa.l?null:qa.l.toString());ub("IsExpectedError",null==qa.m?null:qa.m.toString());ub("ExpectedErrorReason",qa.n);ub("ErrorMessage",qa.o);ub("ClientSideCopyTimeInMs",null==qa.p?null:
qa.p.toString());ub("TotalTimeInMs",null==qa.q?null:qa.q.toString());ub("PlainTextPayloadSize",null==qa.r?null:qa.r.toString());ub("CopyPasteTargetType",qa.s);ub("ShadowWorkbookPayloadSize",null==qa.t?null:qa.t.toString());ub("HtmlPayloadSize",null==qa.u?null:qa.u.toString());ub("HtmlSizeExceedsLimit",null==qa.v?null:qa.v.toString());ub("CopyTotalSizeExceedsLimit",null==qa.w?null:qa.w.toString());ub("ErrorReason",null==qa.x?null:qa.x.toString());ub("ErrorName",qa.y);ub("IsSucceededWithAlert",null==
qa.z?null:qa.z.toString());ub("EncounteredDeploymentErrors",null==qa.ba?null:qa.ba.toString());ub("ShadowWorkbookSizeExceedsLimit",null==qa.bb?null:qa.bb.toString());ub("CopyPasteTargetName",qa.bc);ub("CCPSliceName",qa.bd);ub("SyncClipboardItemsKeys",qa.be);ub("AsyncClipboardItemsKeys",qa.bf);ub("CopyPasteHandlerName",qa.bg);ub("SucceededPopulatingSystemClipboardSync",qa.bh);ub("SucceededPopulatingSystemClipboardAsync",qa.bi);ub("Location",qa.bj);ub("CopyContextId",qa.bk);ub("ServerRequestTimeInMs",
null==qa.bl?null:qa.bl.toString());ub("EcsOperationDuration",null==qa.bm?null:qa.bm.toString());ub("EcsRequestDuration",null==qa.bn?null:qa.bn.toString());ub("WfeRequestDuration",null==qa.bo?null:qa.bo.toString());ub("OriginalSourceRangesCountExceedsLimit",null==qa.bp?null:qa.bp.toString());ub("UploadToClipServiceAttempted",null==qa.bq?null:qa.bq.toString());ub("FloatingObjectType",null==qa.br?null:qa.br.toString());break;case 44:be="Paste";ub("UserSessionId",qa.a);ub("Trigger",qa.b);ub("RibbonCommandName",
qa.c);ub("PasteTypeFlagValue",null==qa.d?null:qa.d.toString());ub("PasteOperationId",qa.e);ub("CopyOperationId",qa.f);ub("ClientSideStopwatchId",qa.g);ub("OriginalDestinationRange",qa.h);ub("ExpandDestinationRange",qa.i);ub("SourceItem",qa.j);ub("SourceRangeCellCount",null==qa.k?null:qa.k.toString());ub("IsSuccess",null==qa.l?null:qa.l.toString());ub("IsExpectedError",null==qa.m?null:qa.m.toString());ub("ClipboardFormatReadTimeInMs",qa.n);ub("ClipboardFormatReadStatus",qa.o);ub("ClipboardReadPermissionPromptShown",
null==qa.p?null:qa.p.toString());ub("AsyncApiReadTimedOut",null==qa.q?null:qa.q.toString());ub("ExpectedErrorReason",qa.r);ub("ErrorMessage",qa.s);ub("TotalTimeInMs",null==qa.t?null:qa.t.toString());ub("PlainTextPayloadSize",null==qa.u?null:qa.u.toString());ub("ShadowWorkbookPayloadSize",null==qa.v?null:qa.v.toString());ub("HtmlPayloadSize",null==qa.w?null:qa.w.toString());ub("CopyPasteTargetType",qa.x);ub("IsLastCopyWasExternal",null==qa.y?null:qa.y.toString());ub("IsClipboardDataContainShadowWorkbook",
null==qa.z?null:qa.z.toString());ub("IsShadowWorkbookParsedSuccessfully",null==qa.ba?null:qa.ba.toString());ub("ActiveSelectionType",qa.bb);ub("PasteResult",qa.bc);ub("ErrorReason",null==qa.bd?null:qa.bd.toString());ub("ErrorName",qa.be);ub("IsSucceededWithAlert",null==qa.bf?null:qa.bf.toString());ub("IsAfterCut",null==qa.bg?null:qa.bg.toString());ub("EncounteredDeploymentErrors",null==qa.bh?null:qa.bh.toString());ub("IsCrossSession",null==qa.bi?null:qa.bi.toString());ub("ShadowWorkbookSizeExceedsLimit",
null==qa.bj?null:qa.bj.toString());ub("ClipboardContainXLOPayload",null==qa.bk?null:qa.bk.toString());ub("CopyPasteTargetName",qa.bl);ub("ChromeExtensionId",qa.bm);ub("PayloadOrigin",qa.bn);ub("PayloadType",qa.bo);ub("CCPSliceName",qa.bp);ub("ClipboardItemsKeys",qa.bq);ub("CopyPasteHandlerName",qa.br);ub("IsSourceItemOriginSameSession",null==qa.bs?null:qa.bs.toString());ub("Location",qa.bt);ub("ExternalAppSource",qa.bu);ub("PasteContextId",qa.bv);ub("ServerRequestTimeInMs",null==qa.bw?null:qa.bw.toString());
ub("IndicationDisplayScheduled",null==qa.bx?null:qa.bx.toString());ub("PasteIndicationDisplayStatus",qa.by);ub("PasteRecoveryUIDisplayed",null==qa.bz?null:qa.bz.toString());ub("IsFromPasteRecoveryUI",null==qa.ca?null:qa.ca.toString());ub("EcsOperationDuration",null==qa.cb?null:qa.cb.toString());ub("EcsRequestDuration",null==qa.cc?null:qa.cc.toString());ub("WfeRequestDuration",null==qa.cd?null:qa.cd.toString());ub("OriginalSourceRangesCountExceedsLimit",null==qa.ce?null:qa.ce.toString());ub("PasteRecoveryUndoStopwatchId",
qa.cf);ub("PasteRecoveryUndoTimeInMs",null==qa.cg?null:qa.cg.toString());ub("PasteCSEPerformed",null==qa.ch?null:qa.ch.toString());ub("CSEStatus",null==qa.ci?null:qa.ci.toString());ub("IsFromEnterShortcut",null==qa.cj?null:qa.cj.toString());ub("pasteDestinationHasMergedCells",null==qa.ck?null:qa.ck.toString());break;case 45:be="DragDrop";ub("UserSessionId",qa.a);ub("Trigger",qa.b);ub("RibbonCommandName",qa.c);ub("OperationId",qa.d);ub("ClientSideStopwatchId",qa.e);ub("SourceRange",qa.f);ub("DestinationRange",
qa.g);ub("CutCopyType",qa.h);ub("IsShiftKeyDown",null==qa.i?null:qa.i.toString());ub("IsDragInsert",null==qa.j?null:qa.j.toString());ub("IsSuccess",null==qa.k?null:qa.k.toString());ub("IsExpectedError",null==qa.l?null:qa.l.toString());ub("ExpectedErrorReason",qa.m);ub("ErrorMessage",qa.n);ub("TotalTimeInMs",null==qa.o?null:qa.o.toString());ub("ErrorName",qa.p);ub("IsSucceededWithAlert",null==qa.q?null:qa.q.toString());ub("CopyPasteTargetType",qa.r);ub("EncounteredDeploymentErrors",null==qa.s?null:
qa.s.toString());break;case 46:be="ClearCopyState";ub("UserSessionId",qa.a);ub("ClientSideStopwatchId",qa.b);ub("Trigger",qa.c);ub("IsClearClipboard",null==qa.d?null:qa.d.toString());ub("IsExplicit",null==qa.e?null:qa.e.toString());ub("IsSuccess",null==qa.f?null:qa.f.toString());ub("ErrorMessage",qa.g);ub("ErrorName",qa.h);ub("TotalTimeInMs",null==qa.i?null:qa.i.toString());ub("CopyPasteTargetType",qa.j);break;case 47:be="WebWorkerRecalcStats";ub("SuccessCount",null==qa.a?null:qa.a.toString());ub("FailureCount",
null==qa.b?null:qa.b.toString());ub("ValueTypeMismatchCount",null==qa.c?null:qa.c.toString());ub("CellValueMismatchCount",null==qa.d?null:qa.d.toString());ub("IfmtMismatchCount",null==qa.e?null:qa.e.toString());ub("FormattedTextMismatchCount",null==qa.f?null:qa.f.toString());ub("CellValueStringMismatchCount",null==qa.g?null:qa.g.toString());ub("CellValueNumberMismatchCount",null==qa.h?null:qa.h.toString());ub("CellValueBooleanMismatchCount",null==qa.i?null:qa.i.toString());ub("CellValueBlankMismatchCount",
null==qa.j?null:qa.j.toString());ub("CellValueErrorMismatchCount",null==qa.k?null:qa.k.toString());ub("FormattedTextStringMismatchCount",null==qa.l?null:qa.l.toString());ub("FormattedTextNumberMismatchCount",null==qa.m?null:qa.m.toString());ub("FormattedTextBooleanMismatchCount",null==qa.n?null:qa.n.toString());ub("FormattedTextBlankMismatchCount",null==qa.o?null:qa.o.toString());ub("FormattedTextErrorMismatchCount",null==qa.p?null:qa.p.toString());ub("StringMismatchCount",null==qa.q?null:qa.q.toString());
ub("NumericMismatchCount",null==qa.r?null:qa.r.toString());ub("ErrorMismatchCount",null==qa.s?null:qa.s.toString());ub("StringValuesCount",null==qa.t?null:qa.t.toString());ub("NumericValuesCount",null==qa.u?null:qa.u.toString());ub("BooleanValuesCount",null==qa.v?null:qa.v.toString());ub("BlankValuesCount",null==qa.w?null:qa.w.toString());ub("ErrorValuesCount",null==qa.x?null:qa.x.toString());ub("NumericValuesDiffAverage",null==qa.y?null:qa.y.toString());ub("NumericEvaluatedValuesMismatchSamples",
qa.z);ub("NumericFormattedTextMismatchSamples",qa.ba);ub("NumericMismatchSamples",qa.bb);ub("CellValueTypeMismatchSamples",qa.bc);ub("IfmtMismatchSamples",qa.bd);ub("BlockHashCode",qa.be);break;case 48:be="DataValidationEditOpenDialog";ub("ServerCommand",qa.a);ub("SubDialogOpened",null==qa.b?null:qa.b.toString());ub("SubDialogButtonClicked",qa.c);ub("DialogOpened",null==qa.d?null:qa.d.toString());ub("RuleType",qa.e);ub("ConditionType",qa.f);ub("LowerBoundaryFilled",null==qa.g?null:qa.g.toString());
ub("UpperBoundaryFilled",null==qa.h?null:qa.h.toString());ub("IgnoreBlank",null==qa.i?null:qa.i.toString());ub("InCellDropdown",null==qa.j?null:qa.j.toString());ub("ShowInputMessage",null==qa.k?null:qa.k.toString());ub("InputTitleFilled",null==qa.l?null:qa.l.toString());ub("InputMessageFilled",null==qa.m?null:qa.m.toString());ub("ShowErrorAlert",null==qa.n?null:qa.n.toString());ub("AlertBlocking",null==qa.o?null:qa.o.toString());ub("AlertTitleFilled",null==qa.p?null:qa.p.toString());ub("AlertMessageFilled",
null==qa.q?null:qa.q.toString());ub("StopWatchId",qa.r);break;case 49:be="DataValidationEditSubmitRule";ub("RuleType",qa.a);ub("ConditionType",qa.b);ub("LowerBoundaryFilled",null==qa.c?null:qa.c.toString());ub("UpperBoundaryFilled",null==qa.d?null:qa.d.toString());ub("IgnoreBlank",null==qa.e?null:qa.e.toString());ub("InCellDropdown",null==qa.f?null:qa.f.toString());ub("ShowInputMessage",null==qa.g?null:qa.g.toString());ub("InputTitleFilled",null==qa.h?null:qa.h.toString());ub("InputMessageFilled",
null==qa.i?null:qa.i.toString());ub("ShowErrorAlert",null==qa.j?null:qa.j.toString());ub("AlertBlocking",null==qa.k?null:qa.k.toString());ub("AlertTitleFilled",null==qa.l?null:qa.l.toString());ub("AlertMessageFilled",null==qa.m?null:qa.m.toString());ub("ClearAllPressed",null==qa.n?null:qa.n.toString());ub("ActionStatus",qa.o);ub("Error",qa.p);ub("StopWatchId",qa.q);break;case 50:be="CustomSort";ub("RangeType",qa.a);ub("HasHeaders",null==qa.b?null:qa.b.toString());ub("SortTopToBottom",null==qa.c?null:
qa.c.toString());ub("ColumnCount",null==qa.d?null:qa.d.toString());ub("RowCount",null==qa.e?null:qa.e.toString());ub("RangeLimitExceeded",null==qa.f?null:qa.f.toString());ub("CaseSensitive",null==qa.g?null:qa.g.toString());ub("GetSortInfoDuration",null==qa.h?null:qa.h.toString());ub("LevelCount",null==qa.i?null:qa.i.toString());ub("SortOnValuesCount",null==qa.j?null:qa.j.toString());ub("SortOnCellColorCount",null==qa.k?null:qa.k.toString());ub("SortOnFontColorCount",null==qa.l?null:qa.l.toString());
ub("SortOnIconCount",null==qa.m?null:qa.m.toString());ub("CustomOrderCount",null==qa.n?null:qa.n.toString());ub("AvgCellColorCount",null==qa.o?null:qa.o.toString());ub("MaxCellColorCount",null==qa.p?null:qa.p.toString());ub("AvgFontColorCount",null==qa.q?null:qa.q.toString());ub("MaxFontColorCount",null==qa.r?null:qa.r.toString());ub("AvgIconsCount",null==qa.s?null:qa.s.toString());ub("MaxIconsCount",null==qa.t?null:qa.t.toString());ub("Executed",null==qa.u?null:qa.u.toString());break;case 51:be=
"NamedSheetViewUserAction";ub("UserSessionId",qa.a);ub("UserActionName",qa.b);ub("UserActionSource",null==qa.c?null:qa.c.toString());ub("UserActionData",qa.d);ub("OtherData",qa.e);break;case 52:be="NamedSheetViewTeachingCallout";ub("UserSessionId",qa.a);ub("TeachingCalloutSequence",null==qa.b?null:qa.b.toString());ub("TeachingCalloutIndex",null==qa.c?null:qa.c.toString());ub("UserActionName",null==qa.d?null:qa.d.toString());ub("UserActionData",qa.e);ub("DurationInMs",null==qa.f?null:qa.f.toString());
break;case 53:be="NamedSheetViewTeachingDialog";ub("UserSessionId",qa.a);ub("UserActionName",qa.b);ub("ButtonClicked",qa.c);ub("DurationInMs",null==qa.d?null:qa.d.toString());ub("IsNewTeachingDialog",null==qa.e?null:qa.e.toString());break;case 54:be="NamedSheetViewOptionsDialog";ub("UserSessionId",qa.a);ub("OptionsAction",null==qa.b?null:qa.b.toString());ub("OptionsActionData",qa.c);ub("OptionsOtherData",qa.d);ub("DurationInMs",null==qa.e?null:qa.e.toString());break;case 55:be="NamedSheetViewTempViewApplyDialog";
ub("UserSessionId",qa.a);ub("TriggeredFrom",qa.b);ub("ButtonClicked",qa.c);ub("DurationInMs",null==qa.d?null:qa.d.toString());break;case 56:be="NamedSheetViewTempViewSaveDialog";ub("UserSessionId",qa.a);ub("TriggeredFrom",qa.b);ub("ButtonClicked",qa.c);ub("NameUpdated",null==qa.d?null:qa.d.toString());ub("DurationInMs",null==qa.e?null:qa.e.toString());break;case 57:be="TemporaryViewStartedDataRestore";ub("UserSessionId",qa.a);ub("CountOfTempViews",null==qa.b?null:qa.b.toString());break;case 58:be=
"TemporaryViewFetchedVersion";ub("UserSessionId",qa.a);ub("NumberOfBytes",null==qa.b?null:qa.b.toString());break;case 59:be="RaiseEventsAndGenerateBlockRequests";ub("ReturnContentStatus",null==qa.a?null:qa.a.toString());ub("CacheState",null==qa.b?null:qa.b.toString());ub("FromXhrCallback",null==qa.c?null:qa.c.toString());ub("AreGeneralErrorsPresent",null==qa.d?null:qa.d.toString());ub("BlockCacheItemHash",qa.e);ub("StopwatchId",qa.f);ub("BlockCacheItemProcessingStopwatchId",qa.g);ub("StateId",null==
qa.h?null:qa.h.toString());ub("IsHighPriority",null==qa.i?null:qa.i.toString());ub("CalcComplete",null==qa.j?null:qa.j.toString());ub("EditedCellsUpdatedByCse",null==qa.k?null:qa.k.toString());ub("DependentCellsUpdatedByCse",null==qa.l?null:qa.l.toString());ub("Revision",null==qa.m?null:qa.m.toString());ub("SheetProcessedDataVersion",null==qa.n?null:qa.n.toString());ub("RefCount",null==qa.o?null:qa.o.toString());ub("ExistsInView",null==qa.p?null:qa.p.toString());ub("ContentSource",null==qa.q?null:
qa.q.toString());break;case 60:be="LaunchMakerCodeEditor",ub("SessionId",qa.a),ub("Command",qa.b),ub("IsPreviewGallery",null==qa.c?null:qa.c.toString()),ub("MenuItemId",qa.d),ub("ScriptId",qa.e),ub("ShareId",qa.f),ub("IsOwner",null==qa.g?null:qa.g.toString()),ub("PublishedScriptCount",null==qa.h?null:qa.h.toString()),ub("RecentScriptCount",null==qa.i?null:qa.i.toString()),ub("WorkbookScriptCount",null==qa.j?null:qa.j.toString())}Dd.Table=be;return Sys.Serialization.JavaScriptSerializer.serialize(Dd)}
function t(){this.ipa=new z}function z(){}function r(ya){var qa=ni.call(this)||this;qa.$=ya;qa.dc();return qa}function G(ya){var qa=Zg.call(this)||this;qa.Lmb=-1;qa.qqd=0;qa.Mwa=new Date(0);qa.iY=null;qa.Kha={};qa.vta=new $d.a;qa.F6a=!1;qa.ZId=!1;qa.V1a=null;qa.N7a=0;qa.Wxc=0;qa.EKa=0;qa.isSynthetic=!1;qa.oSe=function(){var ub=new Date,Dd=ub.getMinutes(),be=ub.getSeconds();qa.wzb&&ub.getTime()-qa.wzb.getTime()>qa.rBj?(qa.stop(),qa.v$c(ub)):(Dd!==qa.qqd&&(qa.v$c(ub),qa.qqd=Dd),qa.F6a&&(qa.ef.kj?qa.iY[be]=
G.Q4b:(qa.kFe(be),qa.F6a=!1,qa.vta.clear(),qa.Kha={})),qa.iY[be]!==G.Q4b&&(qa.iY[be]++,Dd=ub.getTime()-qa.Mwa.getTime(),Dd>qa.Fjf&&qa.sni(qa.Mwa,Dd)),qa.Lmb=window.requestAnimationFrame(qa.oSe),qa.Mwa=ub)};qa.HV=function(){qa.F6a=!0};qa.yqf=function(){qa.pause()};qa.Aqf=function(){qa.ZId&&qa.resume()};qa.Hg=function(){qa.Ca.cH()&&qa.pKj()};qa.wzb=new Date;qa.ef=new R;qa.ef.aFa(qa.HV);Xc.AFrameworkApplication.WSc(qa.yqf);Xc.AFrameworkApplication.XSc(qa.Aqf);qa.$=ya;qa.Fjf=ya.ya.LongFrameThresholdMs;
qa.Soi="MoreThan_"+qa.Fjf.toString()+"_Ms";qa.qBj=ya.ya.ThresholdToEndOperationTrackingSeconds;qa.rBj=ya.ya.ThresholdToStopFPSTrackingMS;qa.Ca=Id.g(qa.$).Ca;Xc.AFrameworkApplication.Gb&&Xc.AFrameworkApplication.Gb.IsSynthetic&&(qa.isSynthetic=pe.a.compare(Xc.AFrameworkApplication.Gb[me.a.isSynthetic],"True",!0)?!1:!0);qa.Ca.np(qa.Hg);qa.tId();qa.tni=qa.$.dwa&&wd.EwaSettings.la(614);return qa}function w(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Tg){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=
0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===ya?null:ya;this.count=void 0===qa?0:qa;this.start=void 0===ub?-1:ub;this.end=void 0===Dd?-1:Dd;this.Avg=void 0===be?0:be;this.Max=void 0===Je?-1:Je;this.Min=ph.a.seg;this.longFrameCount=void 0===Cf?0:Cf;this.coauth=(void 0===Jg?-1:Jg)||1;this.tfAppInt=void 0===$g?-1:$g;this.Props=void 0===Tg?null:Tg;this.LFrame=null}function B(ya,qa){this.duration=this.startSecond=0;this.startSecond=void 0===ya?-1:
ya;this.duration=void 0===qa?-1:qa}function U(){this.f=null}function N(ya){var qa=this;this.$zd={};this.vga=null;this.Xdb=function(ub,Dd){ub.longFramesOverThresholdOps++;ub.maxLongFrameDuration=Math.max(ub.maxLongFrameDuration,Dd)};this.mf=new P;this.z3g();ya.da.Za(276,function(){kh.a(ya).f9(qa.mf)})}function P(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}function ia(ya){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=
new W;this.l2FramePerformanceData=new W;this.l3FramePerformanceData=new W;this.name=ya}function W(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}function R(){var ya=mi.call(this)||this;ya.rL=!1;ya.L7d=null;ya.M7d=null;ya.Lxd=function(){ya.l$f()};ya.VHi=function(){zd.a.Fa(ya.LY);zd.a.Fa(ya.nk)};ya.LY=ud.a.instance.ysa();ya.nk=ud.a.instance.VD();ya.LY.ja("visibilitychange",ya.Lxd);
ya.nk.ja("pagehide",ya.VHi);ya.l$f();return ya}function I(ya){var qa=this;this.MDe=!1;this.ODe=null;this.kd=function(){qa.xbj();Id.g(qa.$).ha&&Id.g(qa.$).ha.DK(qa.kd)};this.Yh=function(ub,Dd){Dd.oa&&!qa.DSd.has(Dd.oa.name)&&(qa.DSd.add(Dd.oa.name),Id.g(qa.$).ha&&(Id.g(qa.$).ha.DK(qa.kd),Id.g(qa.$).ha.iG(qa.kd)))};this.$=ya;this.O4f=new Set;this.DSd=new Set;this.$.xa&&this.$.xa.oa&&this.DSd.add(this.$.xa.oa.name);Id.g(this.$).ha.iG(this.kd);this.$.xa.Pf(this.Yh)}function Q(ya){ed.ULS.sendTraceTag(537151049,
0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");tc.TaskExtensions.Ba(hh.a.Fq(ye.a.instance.mc("Common.ICpuMeterProvider")),function(qa){ed.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");tc.TaskExtensions.Ba(qa.result.Sl.task,function(ub){ed.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");var Dd=
new O(ya);ub.result.nSc(0,Object(Sc.a)(Dd,Dd.Juh,"filterTaskEvent"),Object(Sc.a)(Dd,Dd.GDj,"traceTaskEvent"))},ya.ma,3)},ya.ma,3)}function O(ya){var qa=this;this.ef=null;this.WSd=ya.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.VSd=ya.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.USd=ya.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.TSd=ya.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.fa=ya.fa;ya.da.Za(291,function(ub){qa.ef=ub});ed.ULS.sendTraceTag(537151046,0,50,"TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = {0}, TimeToReportOnLongWaitingTaskInMsAsWarning = {1}, TimeToReportOnLongRunningTaskInMsAsMedium = {2}, TimeToReportOnLongRunningTaskInMsAsWarning = {3}",
this.VSd,this.WSd,this.TSd,this.USd)}function ba(ya){this.Nra=[];this.NYc=null;this.Ksi=100;this.documentVisibilityObserver=null;this.Jsi=ya}function ca(ya,qa){this.G8c=0;this.gOe=this.startTime=nb.HelperMethods.jc();this._name=ya;this.AB=qa}function S(ya,qa){this.stopped=!1;this.chainedCallsTracer=ya;this.Bhg=qa}function Y(ya){var qa=this;this.GUc="AppUnloadInfo";this.nk=this.$=this.workbookHashedId=this.vy=null;this.MZd=this.o2d=!1;this.Df=null;this.c7e=0;this.Uba=function(ub,Dd){qa.c7e=Dd.eyc};
this.WAf=function(ub,Dd){Dd.AWd.length&&qa.$.CE&&(qa.vy.dataLossInfo=new ma(Dd),qa.vy.wasDataLostDuringUnload=!0,qa.Rab())};this.Rg=function(){qa.CTf();qa.$.fa.hr(qa.Rg)};this.GNa=function(){qa.vy.wasUpdatedOnBeforeUnload=!0;qa.vy.inactivityDurationBeforeUnloadSeconds=qa.Df.cdb<Y.Hri?qa.c7e:qa.Df.cdb;qa.u$f()};this.mDb=function(){qa.vy.wasUpdatedOnUnload=!0;qa.u$f();Sys.Application.remove_unload(qa.mDb)};this.JKi=function(){qa.vy.lastSilentReopenStartTime=Qf.a.Ra.Kb;qa.vy.lastSilentReopenEndTime=
null;qa.Rab();qa.$.Rk(qa.Mzf)};this.Mzf=function(){qa.vy.lastSilentReopenEndTime=Qf.a.Ra.Kb;qa.Rab();qa.$.ml(qa.Mzf)};this.localStorage=new pg.a;this.$Nf=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");this.localStorage.og()&&(this.$=ya,this.workbookHashedId=mh.a(this.$),this.vy=new Z(this.workbookHashedId,this.$.ya.UserSessionId),this.nk=ud.a.instance.VD(),this.nk.ja("beforeunload",this.GNa),this.$.userOperationManager.UCg(this.WAf),ya.fa.Mh?this.CTf():this.$.fa.sn(this.Rg),
this.Df=this.$.fa.Df,this.Df.dra(this.Uba),Sys.Application.add_unload(this.mDb),wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&this.$.fa.PTc(this.JKi))}function ma(ya){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=ya.kxe+ya.$7f;this.dataLossReason=ya.qte;this.POg(ya.AWd)}function Z(ya,qa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=
0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=ya;this.wasUpdatedOnUnload=
this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=qa}function xa(ya){var qa=sg.call(this)||this;qa.Cla=null;qa.ima=null;qa.YCe=Array(1);qa.Jsd=null;qa.ZKc=null;qa.Zh=function(ub,Dd){wd.EwaSettings.la(41)&&(qa.ima=qa.ima||new Ya(qa.$,qa.ZH,qa.Yka),qa.ima.Zh(ub,Dd))};qa.Xo=function(ub,Dd){wd.EwaSettings.la(41)&&(qa.ima=qa.ima||new Ya(qa.$,qa.ZH,qa.Yka),qa.ima.Xo(ub,Dd))};qa.qd=function(ub,Dd){wd.EwaSettings.la(41)&&qa.ZH.qd(ub,
Dd)};qa.Rg=function(ub,Dd){wd.EwaSettings.la(41)&&qa.ZH.Rg(ub,Dd)};qa.Pgc=function(ub,Dd){wd.EwaSettings.la(41)&&qa.ZH.Pgc(ub,Dd)};qa.$=ya;if(!wd.EwaSettings.la(41))return qa;He.a.s3h(qa.$);qa.QM=new Da(qa.$);qa.M2g();wd.EwaSettings.la(615)&&qa.$6a&&(qa.Jsd=new wa(qa.$,qa.$6a));qa.ZH=new na(qa.$);qa.Yka=new Sb(qa.$);qa.$.Vl(qa.qd);qa.$.qa.us(qa.Zh);qa.$.qa.FB(qa.Xo);qa.$.fa.Uke(qa.Pgc);wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&qa.$.fa.sn(qa.Rg);return qa}function na(ya){this.dirtySessionOnLastRecordedRequest=
this.zQd=!1;this.Ohf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=ya;this.qlb={};this.plb={};this.F3c={}}function pa(ya,qa,ub,Dd,be,Je,Cf,Jg){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=ya;this.ocsCapable=qa;this.endedBySplashScreen=ub;this.dirtySessionOnLastRecordedRequest=Dd;this.loadOnDemandCount=be;this.maxCoauthorsCount=
Je;this.everConnectedToOcs=Cf;ya=[];for(var $g in Jg)qa=Jg[$g],qa.R9c(),ya.push(qa.data);this.requests=ya}function Ia(ya){this.data=new Ma;this.data.requestName=ya;this.data.totalCount=0;this.nab=[];this.JTd=this.ATd=this.BTd=this.GTd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}function Ma(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}function lb(ya,qa){this.data=new zb;this.data.operationName=ya;this.data.isUserOperation=
qa;this.data.totalCount=0;this.c2f=[];this.d2f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}function zb(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}function Ya(ya,qa,ub){this.$=ya;this.ZH=qa;this.Yka=ub}function Wb(){}function Zb(ya,qa,ub,
Dd,be,Je,Cf,Jg,$g,Tg,Dh,Mh,Oh,Li,Th,Rg,$h){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=
this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=ya;this.isUserTriggeredRequest=Zb.ZKh(ya);this.isFullyLoggedKPIRequest=Zb.WKh(ya);this.isPromotedUTRRequest=Zb.XKh(ya);this.requestDuration=qa;this.totalOperationDuration=ub;this.requestTimeInQueue=Dd;this.requestInvokedTime=be;this.ecsOperationDuration=Je.EcsOperationDuration;this.EcsRequestDuration=Je.EcsRequestDuration;this.WfeRequestDuration=Je.WfeRequestDuration;
this.TimeFromLastEcsFreeze=Je.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Je.DuringLoadOnDemand;this.correlationID=Cf;this.errors=Zb.bYg(Jg);this.httpStatus=$g;this.requestResourceTiming=Tg;this.communicationErrorRetryCount=Dh;this.successfulCall=Mh;this.isDocumentHidden=Oh;this.coauthorsCount=Li;this.responseSize=Th;this.networkInfoData=Rg;this.responseToCallbackTime=$h}function da(ya,qa){this.messageIdName=null;this.errorCause=0;this.messageIdName=ya;this.errorCause=qa}function za(ya,qa,ub,Dd){var be=
this;this.framePerformanceTracker=this.xGb=this.p_=this.p0=null;this.d8i=function(){be.AUc=-1;var Je=nb.HelperMethods.jc();be.uLj(Je);wd.EwaSettings.la(378)&&(be.KHb&&(ed.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),be.zMb(be.XD,Je),be.KHb=!1),be.ifc&&(be.zMb(be.FC,Je),be.KHb||be.zMb(be.XD,Je)));window.setTimeout(be.Ymi,0)};this.Ymi=function(){for(var Je=new $d.a,Cf=be.$.ya.OperationToPrevOperationThreshold,
Jg=0;Jg<be.XD.count;Jg++){var $g=be.XD.na(Jg);Jg<Cf&&Je.add($g);be.FC.add($g)}Id.g(be.$)&&Id.g(be.$).Ca?((Jg=be.sessionStatisticsManager.$bd(0))?ed.ULS.sendTraceTag(237798547,1,50,"DOM count: ({0}, {1}, {2}), long tasks: {3}, operations count: {4}, operations: {5}",Jg.Psi,Jg.OIg,Jg.sri,be.iAb,be.XD.count,Je):ed.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),be.XD.count>Cf&&ed.ULS.sendTraceTag(537153875,1,50,"More than {0} operations are in the operationsList. count: {1}",
Cf,be.XD.count),be.XD.clear(),be.iAb.clear()):ed.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Tlc=function(Je,Cf){be.Uoi(Cf.nJe)};this.$=ya;this.ZH=qa;this.Pg=this.Pg||Qf.a.Ra;this.FC=new $d.a;this.XD=new $d.a;this.AUc=this.z6a=-1;this.iAb=new $d.a;this.operationsGroupDetector=new hb;this.KHb=this.ifc=!1;this.v3h();this.a3h();this.$2h();this.sessionStatisticsManager=ub;this.QM=Dd;this.QM.ele(this.Tlc);this.$.da.Za(263,function(Je){be.framePerformanceTracker=Je})}function hb(){this.operationsGroups=
null;this.Z2h()}function Gb(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Tg){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===ya?"":ya;this.startTime=void 0===qa?-1:qa;this.startToNextFrame=void 0===ub?-1:ub;this.startToResponseRenderEnd=void 0===Dd?-1:Dd;this.wasHidden=void 0===be?!1:be;this.isUserOperation=
void 0===Je?!0:Je;this.isGroupBreaking=void 0===Cf?!0:Cf;this.operationThatLedToLogging=void 0===$g?"":$g;this.startToOperationThatLedToLogging=void 0===Tg?-1:Tg;this.isPartOfGroup=void 0===Jg?!1:Jg}function Sb(ya){var qa=fc.call(this)||this;qa.statusBarManager=null;qa.BSc=!1;qa.Sof=function(){qa.raiseEvent("NetworkInformation")};qa.$=ya;if(!wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry"))return qa;qa.f_=qa.mUd("connection")||qa.mUd("mozConnection")||qa.mUd("webkitConnection");
qa.f_&&wd.EwaSettings.la(490)&&ya.da.Za(29,function(ub){qa.statusBarManager=ub;ub.$I(qa);qa.f_.addEventListener("change",qa.Sof);qa.BSc=!0});return qa}function Fb(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}function wa(ya,qa){var ub=vc.call(this)||this;ub.ef=null;ub.statusBarManager=null;ub.dwf=function(Dd,be){be.Gsd&&be.Gsd.duration>=ub.Woi&&(ub.Ijf++,ub.lgf=be.Gsd.duration)};ub.$=ya;ub.$.da.Za(29,function(Dd){ub.statusBarManager=Dd;Dd.$I(ub)});
ub.$.da.Za(291,function(Dd){ub.ef=Dd});ub.Ijf=0;ub.lgf=0;ub.Woi=ya.ya.LongTaskThresholdMs;ub.$6a=qa;ub.$6a.cBg(ub.dwf);return ub}function va(ya,qa){var ub=this;this.Ma=new Df.a;this.oMa=this.n5=this.cS=this.ef=null;this.Qff=this.NOd=this.Ogc=!1;this.XMa=null;this.maxUsersCount=0;this.Tlc=function(Dd,be){Dd=be.nJe.getEntriesByType(me.a.Fsd);Dd=yl(Dd);for(be=Dd.next();!be.done;be=Dd.next())if(be=be.value,!ub.ef.eH(be.duration)&&!Xc.AFrameworkApplication.$5a){ub.cS.bke(be.duration);ub.Ma.raiseEvent("lttek",
new sa(be));var Je={};Je.LongTaskDuration=be.duration;Je.LongTaskStartTime=be.startTime;ed.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Je))}};this.Rg=function(){ub.NOd=!0;ub.Pwc()};this.IH=function(Dd,be){be&&(ub.maxUsersCount=Math.max(ub.maxUsersCount,be.BWd));ub.n5.maxUsersCount=ub.maxUsersCount};this.od=function(){ub.Pwc()};this.qd=function(){ub.D2f()};this.cwf=function(Dd,be){be.vdc&&ub.Pwc()};this.zjf=function(){ub.cS.QSc(Xf.getElapsedMilliseconds(ub.oMa,Qf.a.Ra.Kb));ub.EQd(!0);var Dd=!1;
ub.n5.postBootWindowData.activeSessionDuration?(!ub.Qff&&wd.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(ub.Xag&&Sf.b().qOf(2),Hf.Health.instance.recordKpiUsage(ac.a.longJsTask,0,ob.a.mii,null),ub.Qff=!0),!ub.n5.isVetoSession&&ub.cS.dhi(ub.Gbg)&&(ub.n5.isVetoSession=!0,wd.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(ub.Xag&&Sf.b().rOf(2,ub.Toi),Hf.Health.instance.recordKpiFailure(ac.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,
null))),ub.n5.worstWindowData.Isd<=ub.cS.Isd&&(ub.n5.worstWindowData=ub.cS),ub.n5.entireSessionData.Eyg(ub.cS)):(ub.n5.postBootWindowData=new Tb(ub.cS.activeSessionDuration,ub.cS.longTaskDuration),Dd=!0);var be={};be.LastWindowScore=ub.cS;be.postBootWindow=Dd;be.CoauthersNumber=ub.$.fa.Em.length;Dd=JSON.stringify(be);ed.ULS.sendTraceTag(20779346,0,50,Dd);ub.cS=new Tb};this.Okc=function(){ub.ef.kj||Xc.AFrameworkApplication.$5a||ub.EQd(!1)};this.Nkc=function(){ub.cS.QSc(Xf.getElapsedMilliseconds(ub.oMa,
Qf.a.Ra.Kb));ub.oMa=null;ub.XMa.cancel()};this.$=ya;this.Gbg=ya.ya.LongTaskPerformanceVetoThreshold;this.Toi="PercentageOver_"+this.Gbg.toString();this.Hsd=ya.ya.LongTaskPerformanceWindowDurationInMs;this.QM=qa;this.Xag=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Za(291,function(Dd){ub.ef=Dd;ub.Pwc()});this.$.fa.Mh?this.Rg(this,Sys.EventArgs.Empty):this.$.fa.sn(this.Rg);this.QM.bBg(this.cwf);this.$.Rk(this.od);this.$.Vl(this.qd)}function sa(ya){var qa=Ea.call(this)||
this;qa.Gsd=ya;return qa}function sb(ya,qa,ub,Dd,be){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=ya;this.entireSessionData=qa;this.worstWindowData=ub;this.postBootWindowData=Dd;this.maxUsersCount=be}function Tb(ya,qa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===ya?0:ya;this.longTaskDuration=void 0===qa?0:qa}function Da(ya){var qa=this;this.Ma=new Df.a;this.sIc=!1;this.Rg=
function(){if(ce.a.Po){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(qa.Voi)).observe(new Lb([me.a.Fsd])),qa.sIc=!0)}catch(ub){qa.sIc=!1,ed.ULS.sendTraceTag(537153885,0,10,"Exception related to PerformanceObserver: {0}",ub)}qa.Ma.raiseEvent("ltpoiek",new Sa(qa.vdc))}};this.Voi=function(ub){qa.Ma.raiseEvent("ltoek",new Ra(ub))};this.$=ya;this.$.fa.Mh?this.Rg(this,Sys.EventArgs.Empty):this.$.fa.sn(this.Rg)}function Sa(ya){var qa=Bf.call(this)||
this;qa.vdc=ya;return qa}function Ra(ya){var qa=Qe.call(this)||this;qa.nJe=ya;return qa}function Lb(ya,qa){this.entryTypes=null;this.buffered=!1;this.entryTypes=ya;this.buffered=void 0===qa?!1:qa}function Ja(ya,qa){var ub=Md.call(this)||this;ub.FGb=!1;ub.Vgd=!1;ub.bZf=!0;ub.Ma=new Df.a;ub.bFc=!1;ub.qd=function(){var Dd=Ob.a(ub.$).nd.activityState,be=Cd.a.ug(Dd,Ba.a.tie);Cd.a.ug(Dd,Ba.a.Jlb)||be||ub.upload()};ub.$=ya;ub.Ttb=qa;ub.fa=ya.fa;ub.$.Vl(ub.qd);ub.h8f=new Mb;ub.uOa=new Ic(ad.a.hKd,ya.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);
ub.uAc=new wb(ub);return ub}function wb(ya){this.w1b=[];this.jFg=null;this.sqmManager=ya}function Mb(){this.Csd=null;this.MVg=Mb.u0g();this.pPf()}function Eb(ya,qa,ub){this.wPc=ya.keyCode;this.lIb(ya.ctrlKey,1);this.lIb(ya.shiftKey,2);this.lIb(ya.altKey,4);this.lIb(gg.b(ya),8);this.lIb(ub,16);this.wPc=this.zcb|qa<<24}function Ic(ya,qa){this.tPb=null;this.Y3b=this.Zhd=!1;this.pde=this.qde=null;this.a4a=this.$3a=0;this.xSf=ya;this.yae=qa}function Zc(ya){var qa=Od.call(this)||this;qa.rU=ya;return qa}
function Pc(ya){var qa=$f.call(this)||this;qa.$=ya;qa.dc();return qa}function vd(ya){var qa=this;this.PIa=new Set;this.GKb=null;this.t3f=!1;this.Rg=function(){qa.fmi();qa.GKb=mf.a.instance.create(function(){qa.dAb()},vd.Wyj,jg.a.dAb)};this.qd=function(){qa.dAb()};this.yDb=function(ub,Dd){ub=qa.Nnb.blockedActions.length;var be=Dd.details?Dd.actionName+"_"+Dd.details:Dd.actionName;Dd=Object.assign(new Ta,{order:ub+1,name:be,componentName:Dd.componentName,timeFromNavigationStart:Dd.timeFromNavigationStart});
Array.add(qa.Nnb.blockedActions,Dd)};this.Nnb=new eb;this.Nnb.hasBlockedActions=!1;this.Kcb=new Tc;this.tuh();this.$=ya;this.$.fa.sn(this.Rg);this.$.Vl(this.qd)}function Tc(){this.successfulActions=[]}function rb(){var ya=Ta.call(this)||this;ya.inputMethod=null;ya.isCommand=!1;return ya}function eb(){this.hasBlockedActions=!1;this.blockedActions=[]}function Ta(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}function fb(ya){var qa=Mg.call(this)||this;qa.$=ya;qa.dc();
return qa}function pb(ya,qa){this.interactivityTrackerService=this.X1f=this.fDd=this.$9a=this.gDd=this.jGf=this.kGf=null;this.kVi=new Set([1,0]);ed.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=ya;this.interactivityTrackerService=qa;this.g5h();this.f5h();this.nii=this.$.ya.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.kze=wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",
3E5);this.wxj()}function rc(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=
this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=
this.appName=null}function vb(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}function E(ya,qa){this.VKi=ya;this.XKi=qa}function Nb(){}function ka(){}function bb(){this.customProperties=new Map}function Ha(ya){this.svj=ya}function Ga(ya){var qa=Rd.call(this)||this;qa.$=ya;qa.dc();return qa}function Ua(ya){var qa=this;this.Kaa=null;if(Ua.gbf)ed.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");
else{if(wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(ya);else{var ub=qb.GetServiceTaskFactory.Xa(ya.da,283,284,1);tc.TaskExtensions.Ba(ub,function(){tc.TaskExtensions.Ba(fd.c(ub.result.wo.loadScript("interactivity")),function(){ed.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");qa.initialize(ya)},ya.ma,3)},ya.ma,3)}Ua.gbf=!0}}function jb(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=
this.callbacks=null}function $a(ya){this.$=ya}function Yb(){this.coAuthCount=this.appState=null}function ec(ya){var qa=Qa.call(this)||this;qa.J8e=0;qa.eRe=!1;qa.sqd=Array(ec.r7a);qa.E3b=0;qa.$=ya;qa.Sxb=wd.EwaSettings.la(78);qa.oef=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");qa.ddi=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");qa.R8h=wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AsyncLogInteractivityRecord",
!1);qa.ySj=Zf.a.MNh();qa.y4={};ec.zWb||(ec.zWb=new qg.a(Vf.a.Ik()),ec.y3h(ec.zWb));Za.m4h();if(wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(ya=0;ya<ec.r7a;ya++)qa.sqd[ya]="NA";return qa}function Za(){this.commandSurface=this.triggerMethod=Zf.a.Mdb}function Wa(ya,qa,ub){ya=Ca.call(this,ya.operation,ya.properties,ya.correlations)||this;ya.timeFromAppInteractive=0;ya.timeFromNavigationStart=0;ya.timeFromAppInteractive=qa;ya.timeFromNavigationStart=ub;return ya}
function Ca(ya,qa,ub){this.correlations=this.properties=this.operation=null;this.operation=ya;this.properties=qa;this.correlations=ub}function db(ya){var qa=og.call(this)||this;qa.vye=!1;qa.$=ya;return qa}function $b(ya,qa,ub){var Dd=bg.call(this,qa,ub)||this;Dd.Ma=new Ig.a;Dd.D0h=function(be){if(wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){var Je=be.Values.m_Origin;Xc.AFrameworkApplication.wopiHostOriginFromPostMessage||(Xc.AFrameworkApplication.wopiHostOriginFromPostMessage=
Je)}switch(be.MessageId){case Wc.a.fid:bf.a(Dd.$).d3e(be);break;case Wc.a.Hrd:kc.a.ltas(null);break;case Wc.a.Gcc:Dd.jFi();break;case Wc.a.jid:Dd.iFi(be)}};Dd.$=ya;ub!==Af.a.r9&&Dd.TEa(ub);Dd.i5h();Dd.w4h();ya=Dd.D0h;Dd.Km(Wc.a.fid,ya);Dd.Km(Wc.a.Hrd,ya);Dd.Km(Wc.a.Gcc,ya);Dd.Km(Wc.a.jid,ya);return Dd}function Jb(){}function Hc(){}function uc(ya){this.Nw=[];this.dQb=[];this._count=void 0===ya?1:ya}function Aa(ya){this.pgb=null;this.Sl=new ue.a;this.mL=ya}function mb(ya,qa,ub,Dd,be){this.sEa=0;this.$F=
null;this.tUb=this.Pee=0;this.bde=!1;this.GUa=0;this.aib=!1;this.bqa=null;this.ARb=0;this.V$d=new Ig.a;this.zVb=[];this.mL=ya;this.$Kc=qa;this.UGc=ub;this.c9d=Dd;Xc.AFrameworkApplication.ga&&Xc.AFrameworkApplication.ga.ra("WrapSetTimeoutForTelemetryIsEnabled")&&this.Wpd();this.Tjg=be;this.VGc=new Qd(100);this.Hng=Ac.i2a(1,5,new dc)}function dc(ya){ya=void 0===ya?null:ya;this.Sm=null;this.reset();this.ikb=ya}function Ac(ya,qa,ub,Dd,be,Je,Cf){Je=void 0===Je?!0:Je;Cf=void 0===Cf?null:Cf;this.sX=this.cfe=
this.p7d=!1;this.je=null;if(!ya)throw re.a.argument("taskManagerLazy");if(!be)throw re.a.argument("dataAggregator");this.Esg=ya;this.eMc=qa;this._id=ub;this.O5d=6E4*Dd;this.VPb=be;this.pce=Je;this.ikb=Cf;bd.SUh().wb(this._id.toString())&&(this.sX=!0)}function bd(){}function Kd(){}function Yd(){}function qd(ya){var qa=hc.call(this)||this;qa.aof=ya;return qa}function Ie(){}function cc(){}function Qd(ya,qa){var ub=this;this.iIc=!1;this.WCa={};this.rSb=void 0===ya?0:ya;this.BSb=void 0===qa?0:qa;this.EQc=
0;Be.a.addHandler(window.self,Ce.a.ZDg,function(){ub.iIc=!0});Be.a.addHandler(window.self,Ce.a.$Dg,function(){ub.iIc=!1})}function Wd(){this.S=this.T=this.M=this.C=0}function ee(){this.iUa=[];this.t1d=this.ZEc=0;this.Aea=null;this.Ya=new Ig.a}function ne(ya,qa){var ub=Qc.call(this)||this;ub.sBj=ya;ub.actualValue=qa;return ub}function Bd(){this.rb=null}function Pd(ya,qa,ub,Dd,be){ub=void 0===ub?null:ub;Dd=void 0===Dd?null:Dd;be=void 0===be?100:be;this.DJc=!1;this.Ri=null;this.qgb=0;this.Ya=new Ig.a;
this.vfb=null;this.AX=!1;this.Sfe=0;this.je=ya;this.W1d=0;this.gWd=this;this.IFc=new kd(ub);this.NI=qa;Dd&&(this.vfb=new Jf(null,Dd,be))}function ze(ya){var qa=sf.call(this)||this;qa.entries=ya;return qa}function Jf(ya,qa,ub){this.TZd=ya;this.mVb=void 0===qa?null:qa;this.rfb={};this.yhg=void 0===ub?100:ub}function oc(ya,qa){this.q$=null;this.rQc=ya;this.behavior=qa;this.url=this.Xt.name}function hd(ya,qa,ub){this.ai=ya;this.gWd=this;this.Nkg=(void 0===qa?null:qa)||function(){return window.location.href};
this.IFc=new kd(void 0===ub?null:ub)}function wc(ya,qa){function ub(Je,Cf){null!=Cf&&(Dd[Je]=Cf)}var Dd={},be=null;switch(ya){case 0:be="ResourceTiming";ub("Url",qa.a);ub("InitiatorType",qa.b);ub("RedirectStart",null==qa.c?null:qa.c.toString());ub("RedirectEnd",null==qa.d?null:qa.d.toString());ub("FetchStart",null==qa.e?null:qa.e.toString());ub("DomainLookupStart",null==qa.f?null:qa.f.toString());ub("DomainLookupEnd",null==qa.g?null:qa.g.toString());ub("ConnectStart",null==qa.h?null:qa.h.toString());
ub("ConnectEnd",null==qa.i?null:qa.i.toString());ub("SecureConnectionStart",null==qa.j?null:qa.j.toString());ub("RequestStart",null==qa.k?null:qa.k.toString());ub("ResponseStart",null==qa.l?null:qa.l.toString());ub("ResponseEnd",null==qa.m?null:qa.m.toString());ub("CustomText",qa.n);ub("DecodedBodySize",null==qa.o?null:qa.o.toString());ub("EncodedBodySize",null==qa.p?null:qa.p.toString());ub("TransferSize",null==qa.q?null:qa.q.toString());break;case 1:be="PerformanceTiming",ub("Url",qa.a),ub("NavigationStart",
null==qa.b?null:qa.b.toString()),ub("UnloadEventStart",null==qa.c?null:qa.c.toString()),ub("UnloadEventEnd",null==qa.d?null:qa.d.toString()),ub("RedirectStart",null==qa.e?null:qa.e.toString()),ub("RedirectEnd",null==qa.f?null:qa.f.toString()),ub("FetchStart",null==qa.g?null:qa.g.toString()),ub("DomainLookupStart",null==qa.h?null:qa.h.toString()),ub("DomainLookupEnd",null==qa.i?null:qa.i.toString()),ub("ConnectStart",null==qa.j?null:qa.j.toString()),ub("ConnectEnd",null==qa.k?null:qa.k.toString()),
ub("SecureConnectionStart",null==qa.l?null:qa.l.toString()),ub("RequestStart",null==qa.m?null:qa.m.toString()),ub("ResponseStart",null==qa.n?null:qa.n.toString()),ub("ResponseEnd",null==qa.o?null:qa.o.toString()),ub("DomLoading",null==qa.p?null:qa.p.toString()),ub("DomInteractive",null==qa.q?null:qa.q.toString()),ub("DomContentLoadedEventStart",null==qa.r?null:qa.r.toString()),ub("DomContentLoadedEventEnd",null==qa.s?null:qa.s.toString()),ub("DomComplete",null==qa.t?null:qa.t.toString()),ub("LoadEventStart",
null==qa.u?null:qa.u.toString()),ub("LoadEventEnd",null==qa.v?null:qa.v.toString()),ub("CustomText",qa.w)}Dd.Table=be;return Sys.Serialization.JavaScriptSerializer.serialize(Dd)}function gb(ya,qa){this.q$=null;this.rQc=ya;this.url=qa}function kd(ya){this.MCc=ya}function Lc(){}function Cb(){}function Bb(){this.Version=this.Name=null}function Hb(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=
this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}b.r(D);var Pb=b(0),ed=b(13);Object(Pb.a)(Hb,"BrowserInfo",null,[]);Object(Pb.a)(Bb,"PluginInfo",null,
[]);var Xc=b(5),ce=b(23);Cb.hni=function(){if(Xc.AFrameworkApplication.ga.ra("LogBrowserInfoIsEnabled")){var ya=Cb.Hzh();try{var qa=JSON.stringify(ya);ed.ULS.sendTraceTag(6903563,102,50,qa)}catch(ub){ed.ULS.sendTraceTag(6903564,102,15,ub.message)}}else ed.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")};Cb.nOh=function(){var ya=window.navigator.plugins;if(!ya||!ya.length)return null;for(var qa=[],ub=0;ub<ya.length;ub++){var Dd=ya[ub].name,be=ya[ub].version;Array.add(qa,
Object.assign(new Bb,{Name:Dd,Version:be}))}return qa};Cb.Hzh=function(){var ya=new Hb,qa=new Sys.StringBuilder;Cb.Fs(function(ub){ya.DocElemClientHeight=ub},function(){return document.documentElement.clientHeight},qa);Cb.Fs(function(ub){ya.DocElemClientWidth=ub},function(){return document.documentElement.clientWidth},qa);Cb.Fs(function(ub){ya.DocElemOffsetHeight=ub},function(){return document.documentElement.offsetHeight},qa);Cb.Fs(function(ub){ya.DocElemOffsetWidth=ub},function(){return document.documentElement.offsetWidth},
qa);Cb.Fs(function(ub){ya.ScreenAvailHeight=ub},function(){return window.screen.availHeight},qa);Cb.Fs(function(ub){ya.ScreenAvailWidth=ub},function(){return window.screen.availWidth},qa);Cb.Fs(function(ub){ya.ScreenWidth=ub},function(){return window.screen.width},qa);Cb.Fs(function(ub){ya.ScreenHeight=ub},function(){return window.screen.height},qa);Cb.Fs(function(ub){ya.ScreenLogicalXdpi=ub},function(){return window.screen.logicalXDPI},qa);Cb.Fs(function(ub){ya.ScreenLogicalYdpi=ub},function(){return window.screen.logicalYDPI},
qa);Cb.Fs(function(ub){ya.ScreenDeviceXdpi=ub},function(){return window.screen.deviceXDPI},qa);Cb.Fs(function(ub){ya.ScreenDeviceYdpi=ub},function(){return window.screen.deviceYDPI},qa);Cb.Fs(function(ub){ya.WinInnerHeight=ub},function(){return window.self.innerHeight},qa);Cb.Fs(function(ub){ya.WinInnerWidth=ub},function(){return window.self.innerWidth},qa);Cb.Fs(function(ub){ya.WinOuterHeight=ub},function(){return window.self.outerHeight},qa);Cb.Fs(function(ub){ya.WinOuterWidth=ub},function(){return window.self.outerWidth},
qa);Cb.Fs(function(ub){ya.WinOrientation=ub},function(){return window.self.orientation},qa);Cb.Fs(function(ub){ya.WinDevicePixelRatio=ub},function(){return window.self.devicePixelRatio},qa);Cb.Fs(function(ub){ya.SupportsTouch=ub},function(){return ce.a.qxc},qa);Cb.Fs(function(ub){ya.NavAppName=ub},function(){return window.navigator.appName},qa);Cb.Fs(function(ub){ya.NavAppVersion=ub},function(){return window.navigator.appVersion},qa);Cb.Fs(function(ub){ya.NavLanguage=ub},function(){return window.navigator.browserLanguage||
window.navigator.language},qa);Cb.Fs(function(ub){ya.NavUserAgent=ub},function(){return window.navigator.userAgent},qa);Cb.Fs(function(ub){ya.NavPlatform=ub},function(){return window.navigator.platform},qa);Cb.Fs(function(ub){ya.NavPlugins=ub},Cb.nOh,qa);Cb.Fs(function(ub){ya.CalculatedDevicePixelRatio=ub},function(){return Cb.devicePixelRatio},qa);ya.Error=qa.toString();return ya};Cb.Fs=function(ya,qa,ub){try{var Dd=qa();ya(Dd)}catch(be){ub.isEmpty()||ub.append(" | "),ub.append(be.message||"null")}};
tl.Object.defineProperties(Cb,{devicePixelRatio:{configurable:!0,enumerable:!0,get:function(){var ya=window.devicePixelRatio;return isNaN(ya)?window.screen.deviceXDPI/window.screen.logicalXDPI:ya}}});Object(Pb.a)(Cb,"BrowserInfoLogger",null,[]);var Xd=b(274);Lc.prototype.di=function(){};Lc.prototype.init=function(){Cb.hni()};Lc.prototype.dispose=function(){};Lc.main=function(){Xd.a.instance.mj(new Lc)};tl.Object.defineProperties(Lc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.BrowserInfoLogger"}}});
Object(Pb.a)(Lc,"BrowserInfoLoggerPackage",null,[4,5]);var nd=b(77);kd.prototype.K$e=function(ya){if(!this.MCc)return!0;ya=nd.a.cdd(ya);if(!ya)return!1;ya=ya.toLowerCase();for(var qa=0;qa<this.MCc.length;qa++)if(ya.endsWith(this.MCc[qa]))return!0;return!1};Object(Pb.a)(kd,"DomainAllowListManager",null,[]);gb.prototype.iTd=function(){var ya={},qa=this.Xt;ya.a=this.hWd;ya.b=this.round(qa.navigationStart);ya.c=this.round(qa.unloadEventStart);ya.d=this.round(qa.unloadEventEnd);ya.e=this.round(qa.redirectStart);
ya.f=this.round(qa.redirectEnd);ya.g=this.round(qa.fetchStart);ya.h=this.round(qa.domainLookupStart);ya.i=this.round(qa.domainLookupEnd);ya.j=this.round(qa.connectStart);ya.k=this.round(qa.connectEnd);ya.l=void 0!==qa.secureConnectionStart&&null!==qa.secureConnectionStart?this.round(qa.secureConnectionStart):0;ya.m=this.round(qa.requestStart);ya.n=this.round(qa.responseStart);ya.o=this.round(qa.responseEnd);ya.q=this.round(qa.domInteractive);ya.r=this.round(qa.domContentLoadedEventStart);ya.s=this.round(qa.domContentLoadedEventEnd);
ya.t=this.round(qa.domComplete);ya.u=this.round(qa.loadEventStart);ya.v=this.round(qa.loadEventEnd);ya.w=this.q$;return ya};gb.prototype.round=function(ya){return Math.round(1E3*ya)/1E3};tl.Object.defineProperties(gb.prototype,{hWd:{configurable:!0,enumerable:!0,get:function(){return nd.a.Eca(this.url)}},Xt:{configurable:!0,enumerable:!0,get:function(){return this.rQc}}});Object(Pb.a)(gb,"PerformanceTimingEntry",null,[]);var je=b(54),Xe=b(213),Ne=b(315);hd.prototype.run=function(){if(hd.mP(window.performance))try{var ya=
this.Nkg();if(hd.ptg.exec(ya)&&this.IFc.K$e(ya)){var qa=new gb(window.performance.timing,ya);Ne.a.instance.WZi(qa.Xt.fetchStart);Ne.a.instance.XZi(qa.Xt.navigationStart);Ne.a.instance.GAb(je.a.Dyh,"connectStart","requestStart");Ne.a.instance.GAb(je.a.Myh,"requestStart","responseStart");Ne.a.instance.GAb(je.a.Pyh,"responseStart","responseEnd");this.gWd.Ne(1,qa.iTd());this.ai.qn(je.a.T1a,qa.Xt.fetchStart);this.ai.qn(je.a.Iyh,qa.Xt.domainLookupStart);this.ai.qn(je.a.Hyh,qa.Xt.domainLookupEnd);this.ai.qn(je.a.Fyh,
qa.Xt.connectStart);this.ai.qn(je.a.Qyh,qa.Xt.secureConnectionStart);this.ai.qn(je.a.Eyh,qa.Xt.connectEnd);this.ai.qn(je.a.Nyh,qa.Xt.requestStart);this.ai.qn(je.a.nad,qa.Xt.responseStart);this.ai.qn(je.a.Jyh,qa.Xt.responseEnd-qa.Xt.responseStart);this.ai.qn(je.a.Oyh,qa.Xt.responseStart-qa.Xt.requestStart);var ub=0,Dd=0,be=0,Je=this.FFj(ya);ub=Je.transferSize;Dd=Je.w6c;be=Je.e4c;Je.returnValue&&(this.ai.qn(je.a.Ryh,ub),this.ai.qn(je.a.Gyh,be),this.ai.qn(je.a.Kyh,Dd));this.ai.qn(je.a.Lyh,qa.Xt.navigationStart)}}catch(Cf){ed.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Cf)}};hd.prototype.FFj=function(ya){var qa,ub;var Dd=ub=qa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:qa,w6c:ub,e4c:Dd};ya=window.performance.getEntriesByName(ya,"navigation");if(void 0===ya||null===ya||1!==ya.length)return{returnValue:!1,transferSize:qa,w6c:ub,e4c:Dd};ya=ya[0];var be=ya.transferSize;void 0!==qa&&null!==qa&&(qa=be);be=ya.decodedBodySize;
void 0!==be&&null!==be&&(Dd=be);ya=ya.encodedBodySize;void 0!==ya&&null!==ya&&(ub=ya);return{returnValue:!0,transferSize:qa,w6c:ub,e4c:Dd}};hd.prototype.Ne=function(ya,qa){ed.ULS.sendTraceTag(4551815,306,50,wc(ya,qa))};hd.mP=function(ya){return!(void 0===ya||null===ya)&&!(void 0===ya.timing||null===ya.timing)};tl.Object.defineProperties(hd,{instance:{configurable:!0,enumerable:!0,get:function(){return hd.Na||(hd.Na=new hd(Xe.a.instance,null,Xc.AFrameworkApplication.ga.ra("PerfTimingLoggerFilterDomainsIsEnabled")?
Xc.AFrameworkApplication.ga.Tv("ResourceLoggerDomainAllowList"):null))}}});hd.Na=null;hd.ptg=RegExp("^https?://.*","i");Object(Pb.a)(hd,"PerformanceTimingLogger",null,[758]);var Ig=b(94),Lf=b(84);oc.prototype.iTd=function(){var ya={},qa=this.Xt;ya.a=this.hWd;ya.b=qa.initiatorType;ya.c=this.round(qa.redirectStart);ya.d=this.round(qa.redirectEnd);ya.e=this.round(qa.fetchStart);ya.f=this.round(qa.domainLookupStart);ya.g=this.round(qa.domainLookupEnd);ya.h=this.round(qa.connectStart);ya.i=this.round(qa.connectEnd);
ya.j=void 0!==qa.secureConnectionStart&&null!==qa.secureConnectionStart?this.round(qa.secureConnectionStart):0;ya.k=this.round(qa.requestStart);ya.l=this.round(qa.responseStart);ya.m=this.round(qa.responseEnd);ya.o=this.round(oc.b3a(qa,"decodedBodySize"));ya.p=this.round(oc.b3a(qa,"encodedBodySize"));ya.q=this.round(oc.b3a(qa,"transferSize"));ya.n=this.q$;return ya};oc.prototype.round=function(ya){return Math.round(1E3*ya)/1E3};oc.b3a=function(ya,qa){return ya[qa]};tl.Object.defineProperties(oc.prototype,
{hWd:{configurable:!0,enumerable:!0,get:function(){return 2===this.behavior?this.url:nd.a.Eca(this.url)}},Xt:{configurable:!0,enumerable:!0,get:function(){return this.rQc}}});Object(Pb.a)(oc,"ResourceTimingEntry",null,[772]);var Hf=b(93),ag=b(38),Bg=b(110),uf=b(178);Jf.prototype.$Ej=function(ya){var qa=ya.name.toLowerCase(),ub=nd.a.Nua(qa);this.z$i(ub,qa)&&(ub in this.rfb?ed.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",ub):(qa={},qa.fetchstart=ya.fetchStart,
qa.responseend=ya.responseEnd,qa.iscached=this.ugi(ya),qa.encodedsize=oc.b3a(ya,"encodedBodySize"),qa.decodedsize=oc.b3a(ya,"decodedBodySize"),this.rfb[ub]=qa))};Jf.prototype.z$i=function(ya,qa){if(this.TZd)return Array.contains(this.TZd,ya);if(this.mVb)for(ya=nd.a.oM(qa),qa=0;qa<this.mVb.length;qa++)if(this.mVb[qa]&&ya.endsWith(this.mVb[qa]))return!0;return!1};Jf.prototype.ugi=function(ya){try{var qa=oc.b3a(ya,"transferSize");if(qa)return!qa;ed.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return ya.responseEnd-ya.fetchStart<this.yhg}catch(ub){ed.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",ub.message)}return!1};Jf.prototype.p_i=function(){if(Bg.a.yj(this.rfb))ed.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var ya=Xc.AFrameworkApplication.yJ?Xc.AFrameworkApplication.yJ.split(";"):[],qa=Object.assign(new uf.a,{extendedProperties:this.pIh()});qa.extendedProperties.set("Flights",
ag.c(ya));this.oni(qa,this.rfb,Hf.Health.instance)}};Jf.prototype.pIh=function(){try{return new Map}catch(ya){return null}};Jf.prototype.oni=function(ya,qa,ub){if(qa){var Dd=0,be=0,Je=0,Cf=0,Jg=0,$g=0,Tg=0,Dh=0,Mh=0,Oh=0,Li=0,Th;for(Th in qa){var Rg=qa[Th];try{var $h=Object(Lf.a)(Object,Rg);if($h){var gi=$h.iscached?Boolean.parse($h.iscached.toString()):!1,Ae=$h.fetchstart?this.parseFloat($h.fetchstart.toString()):0,Xh=($h.responseend?this.parseFloat($h.responseend.toString()):0)-Ae,qi=$h.encodedsize?
this.parseFloat($h.encodedsize.toString()):0,h=$h.decodedsize?this.parseFloat($h.decodedsize.toString()):0;Dd+=Xh;Cf+=qi;Tg+=h;Oh++;gi?(Je+=Xh,$g+=qi,Mh+=h,Li++):(be+=Xh,Jg+=qi,Dh+=h)}}catch(Ab){ed.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Ab.message)}}ya.extendedProperties.set("StaticResources",ag.c(qa));ya.extendedProperties.set("TotalResourceDownloadLatency",Dd.toString());ya.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
be.toString());ya.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Je.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Cf.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Jg.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",$g.toString());ya.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Tg.toString());ya.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Dh.toString());
ya.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Mh.toString());ya.extendedProperties.set("TotalNumberOfResourcesDownloaded",Oh.toString());ya.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Li.toString());ub.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);ub.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",ya)}};Jf.prototype.parseFloat=function(ya){if(!ya)return 0;ya=parseFloat(ya);return isNaN(ya)?
0:ya};Object(Pb.a)(Jf,"AppStaticResourceManager",null,[]);var sf=Sys.EventArgs;vm(ze,sf);Object(Pb.a)(ze,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var xg=b(109);Pd.prototype.bAg=function(ya){this.Ya.addHandler(Pd.Z6c,ya)};Pd.prototype.r4i=function(ya){this.Ya.removeHandler(Pd.Z6c,ya)};Pd.prototype.di=function(ya,qa){var ub=this.$Sd!==ya;this.Sfe=ya;this.isActive&&this.je&&ub&&(this.Bp(),this.gh());this.W1d=qa};Pd.prototype.activate=function(){!this.isActive&&this.Mre&&(this.gh(),this.AX=!0)};
Pd.prototype.deactivate=function(ya){this.isActive&&(this.Bp(),ya&&this.flush(),this.AX=!1)};Pd.prototype.flush=function(){if(this.isActive&&this.Mre)try{var ya=window.performance.getEntriesByType("resource");0<ya.length-this.qgb&&ed.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",ya.length-this.qgb);var qa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);qa&&(window.performance.clearResourceTimings(),
this.qgb=0);for(var ub=[],Dd=this.qgb;Dd<ya.length;Dd++)this.IFc.K$e(ya[Dd].name)&&(this.vfb&&this.vfb.$Ej(ya[Dd]),ub.push(new oc(ya[Dd],this.t8g)));qa||(this.qgb=ya.length);this.Ya.raiseEvent(Pd.Z6c,new ze(ub));for(ya=0;ya<ub.length;ya++)ub[ya].behavior&&2!==ub[ya].behavior||this.gWd.Ne(0,ub[ya].iTd());0<ub.length&&ed.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",ub.length)}catch(be){ed.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",
be)}};Pd.prototype.Ne=function(ya,qa){ed.ULS.sendTraceTag(4310804,306,50,wc(ya,qa))};Pd.prototype.VZi=function(){this.vfb.p_i()};Pd.prototype.gh=function(){var ya=this;this.je&&0<this.$Sd&&(this.Ri=new xg.a(3,2,1E3*this.$Sd,function(){ya.flush()},5),this.je.gh(this.Ri),this.DJc=!0)};Pd.prototype.Bp=function(){this.DJc&&(this.je.Bp(this.Ri),this.Ri=null,this.DJc=!1)};tl.Object.defineProperties(Pd.prototype,{Mre:{configurable:!0,enumerable:!0,get:function(){try{return!(void 0===this.NI||null===this.NI)&&
!(void 0===this.NI.getEntriesByType||null===this.NI.getEntriesByType)}catch(ya){return ed.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",ya),!1}}},t8g:{configurable:!0,enumerable:!0,get:function(){return this.W1d}},isActive:{configurable:!0,enumerable:!0,get:function(){return this.AX}},$Sd:{configurable:!0,enumerable:!0,get:function(){return this.Sfe}}});Pd.Z6c="EntriesAvailable";Object(Pb.a)(Pd,"ResourceTimingLogger",null,[734,
758]);var sc=b(157);Bd.prototype.init=function(){this.rb.resolve("Common.NetworkTiming.IResourceTimingLogger");hd.instance.run()};Bd.prototype.dispose=function(){};Bd.prototype.di=function(ya){this.rb=ya;var qa=null;if(Xc.AFrameworkApplication.ga.ra("ResourceLoggerFilterDomainsIsEnabled"))try{qa=Xc.AFrameworkApplication.ga.Tv("ResourceLoggerDomainAllowList")}catch(be){ed.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var ub=[];ub.push(nd.a.oM(sc.a.KW).toLowerCase());
ub.push(nd.a.oM(sc.a.Jbb).toLowerCase());var Dd=Xc.AFrameworkApplication.ga.zd("AppStaticResourceMonitorCacheThresholdInMs",100);ya.register(734,"Common.NetworkTiming.IResourceTimingLogger").zc().Ic(function(){return new Pd(Xc.AFrameworkApplication.oj,window.performance,qa,ub,Dd)})};Bd.main=function(){Xd.a.instance.mj(new Bd)};tl.Object.defineProperties(Bd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.ResourceTiming"}}});Object(Pb.a)(Bd,"ResourceTimingPackage",null,[4,
5]);var Sc=b(80),Qc=Sys.EventArgs;vm(ne,Qc);Object(Pb.a)(ne,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var ie=b(167);ee.prototype.init=function(ya,qa,ub){this.Aea=ya;this.ZEc=qa;this.t1d=ub;this.Aea.mle(Object(Sc.a)(this,this.jBi,"onCpuMeterFrameAvailable"));this.sBg(Object(Sc.a)(this,this.g_g,"cpuPercentThresholdExceeded"))};ee.prototype.jBi=function(ya,qa){qa.aof&&(Array.enqueue(this.iUa,qa.aof.CP),this.iUa.length>this.t1d&&(Array.dequeue(this.iUa),this.nSg()))};ee.prototype.nSg=
function(){for(var ya=this.iUa.length,qa=0,ub=0;ub<ya;ub++){var Dd=Array.dequeue(this.iUa);qa+=Dd;Array.enqueue(this.iUa,Dd)}ya=qa/ya;ya>this.ZEc&&this.Ya.raiseEvent("CPTTE",new ne(this.ZEc,ya))};ee.prototype.g_g=function(ya,qa){ie.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.h1g(qa.sBj,qa.actualValue))};ee.prototype.sBg=function(ya){this.Ya.addHandler("CPTTE",ya)};ee.prototype.h1g=function(ya,qa){var ub={};ub.ThresholdValue=ya;ub.ActualValue=qa;return ub};Object(Pb.a)(ee,
"CpuMeterMonitor",null,[782]);var ue=b(139);Object(Pb.a)(Wd,"ProfileInformation",null,[]);var Ce=b(12),Be=b(40),le=b(259);Qd.prototype.Jme=function(ya,qa,ub){var Dd=Qd.generateKey(qa,ub);Dd in this.WCa?qa=this.WCa[Dd]:(qa=new Wd,qa.S=ub?1:0,this.WCa[Dd]=qa,this.EQc++);qa.C++;qa.M=ya>qa.M?ya:qa.M;qa.T+=ya};Qd.prototype.WXa=function(ya,qa){this.Jme(ya,qa,!1);this.iIc&&this.Jme(ya,qa,!0)};Qd.prototype.getData=function(){if(0<this.BSb&&this.EQc>this.BSb)return this.oGh();var ya=0<this.rSb,qa={},ub=this.WCa,
Dd;for(Dd in ub){var be=Dd,Je=ub[Dd];this.CQf(Je);ya&&Je.T>=this.rSb&&(qa[be]=Je)}return ya?Bg.a.yj(qa)?null:qa:this.WCa};Qd.prototype.oGh=function(){var ya=0<this.rSb,qa=[],ub=this.WCa;for(Je in ub){var Dd={key:Je,value:ub[Je]},be=Dd.value;(!ya||be.T>=this.rSb)&&Array.add(qa,Dd)}if(qa.length>this.BSb)qa.sort(function(Cf,Jg){return Jg.value.T-Cf.value.T}),qa=qa.slice(0,this.BSb);else if(!qa.length)return null;ya={};qa=yl(qa);for(ub=qa.next();!ub.done;ub=qa.next()){ub=ub.value;var Je=ub.value;this.CQf(Je);
ya[ub.key]=Je}return ya};Qd.prototype.CQf=function(ya){ya.M=le.a.S_(ya.M,0);ya.T=le.a.S_(ya.T,0)};Qd.prototype.reset=function(){this.WCa={};this.EQc=0};Qd.generateKey=function(ya,qa){return qa?ya+" [it]":ya};Object(Pb.a)(Qd,"FunctionCallAggregator",null,[780]);cc.hJg="BatchedOperation";cc.replication="Replication";cc.hGj="25";cc.H7i="9_"+cc.hJg+"_"+cc.replication;Object(Pb.a)(cc,"CpuMeterConstants",null,[]);Object(Pb.a)(Ie,"CpuMeterFrame",null,[]);var hc=Sys.EventArgs;vm(qd,hc);Object(Pb.a)(qd,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);Object(Pb.a)(Yd,"MiniTaskItemInfo",null,[]);Object(Pb.a)(Kd,"TaskItemInfo",null,[]);var gd=b(685),xd=b(101);bd.SUh=function(){if(!bd.HOb&&(bd.HOb=new xd.a,Xc.AFrameworkApplication.ga&&Xc.AFrameworkApplication.ga.Dy("AggregatorIdDisabledList")))for(var ya=Xc.AFrameworkApplication.ga.Tv("AggregatorIdDisabledList"),qa=0;qa<ya.length;qa++)bd.HOb.ia(ya[qa],!0);return bd.HOb};bd.HOb=null;Object(Pb.a)(bd,"DisabledAggregatorListStore",null,[]);var re=b(262);Ac.prototype.track=function(ya,
qa){qa=void 0===qa?null:qa;this.sX||(this.mhh(),this.Wcj(),this.VPb.WXa(ya,qa))};Ac.prototype.Wcj=function(){!this.p7d&&0<this.O5d&&(this.p7d=!0,this.qSf())};Ac.prototype.qSf=function(){var ya=this,qa=new xg.a(5,1,this.O5d,function(){ya.efj()},19,this._id.toString());this.taskManager.gh(qa)};Ac.prototype.efj=function(){!this.ikb||this.ikb.roj()?this.uTf():this.pce&&this.VPb.reset();this.qSf()};Ac.prototype.uTf=function(){var ya=this.VPb.getData();if(ya){var qa=parseInt(String(ya.length));if(isNaN(qa)||
0<qa)this.vtc(ya),this.pce&&this.VPb.reset()}};Ac.prototype.vtc=function(ya){var qa={};ed.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",(qa.ID=this._id.toString(),qa.Data=ya,qa))};Ac.prototype.mhh=function(){var ya=this;this.cfe||(this.eMc(function(){ya.uTf()}),this.cfe=!0)};Ac.zU=function(ya,qa,ub,Dd,be){return new Ac(new gd.a(function(){return Xc.AFrameworkApplication.oj}),Xc.AFrameworkApplication.DKb,ya,qa,ub,Dd,be)};Ac.i2a=function(ya,qa,ub){return Ac.zU(ya,qa,ub,!0,null)};tl.Object.defineProperties(Ac.prototype,
{taskManager:{configurable:!0,enumerable:!0,get:function(){return this.je||(this.je=this.Esg.value)}}});Object(Pb.a)(Ac,"Aggregator",null,[784]);dc.prototype.WXa=function(ya,qa){if(!this.ikb||this.ikb.roj())qa in this.Sm||(this.Sm[qa]=[]),this.Sm[qa].push(ya)};dc.prototype.getData=function(){return Bg.a.count(this.Sm)?this.Sm:null};dc.prototype.reset=function(){this.Sm={}};Object(Pb.a)(dc,"NamedValuesAggregator",null,[780]);var Jc=b(308);mb.prototype.mle=function(ya){this.V$d.addHandler("OnCpuMeterFrameAvailable",
ya)};mb.prototype.Z9a=function(ya,qa,ub,Dd){ub=(Dd=void 0===Dd?null:Dd)?Dd.priority:7;var be=this.mL();this.start(qa,ub);try{ya()}finally{this.stop(qa,Dd),ya=this.mL()-be,this.c9d.track(ya,qa)}};mb.prototype.f6=function(ya,qa){var ub=this.mL();try{ya()}finally{ya=this.mL()-ub,this.UGc.WXa(ya,qa),0<this.sEa&&this.VGc.WXa(ya,qa),this.c9d.track(ya,qa)}};mb.prototype.Azd=function(ya){var qa=new Kd;qa.TN=ya.Bic;qa.TP=ya.priority;this.NHf(1,qa)};mb.prototype.o7a=function(ya){this.ARb|=ya};mb.prototype.start=
function(ya,qa){if(!this.sEa){this.VGc.reset();var ub=this.Lef(ya);ub&&this.Dtd(1);this.$F=new Kd;this.$F.TN=ya;this.$F.TP=qa;this.$F.ST=(new Date).toISOString();this.$F.STS=le.a.S_(this.mL(),2);ub?this.$F.UI=1:this.Dci(ya)?this.$F.UI=2:this.$F.UI=0}this.sEa++};mb.prototype.Dtd=function(ya){this.GUa|=ya};mb.prototype.DZc=function(ya,qa){this.GUa=void 0===ya||ya?0:this.GUa&~(void 0===qa?0:qa)};mb.prototype.stop=function(ya,qa){qa=void 0===qa?null:qa;this.sEa--;if(0>=this.sEa&&this.$F){var ub=this.mL()-
this.$F.STS;this.tUb+=ub;this.$Kc.WXa(ub,ya);this.Lef(ya)&&this.DZc(!1,1);this.$F.TRT=le.a.S_(ub,2);qa&&(this.$F.TQT=le.a.S_(qa.uWi,2),this.$F.TDT=le.a.S_(qa.Zff,2));this.Tjg&&(this.NHf(0,this.$F),this.o8i());this.sEa=0}0<=ya.indexOf(cc.hGj)&&this.o7a(2);0<=ya.indexOf(cc.H7i)&&this.o7a(4);1===(this.GUa&1)&&this.o7a(1);2===(this.GUa&2)&&this.o7a(8)};mb.prototype.o8i=function(){var ya=this.$F.TRT;if(750<ya){var qa=this.VGc.getData();if(qa){var ub={},Dd;for(Dd in qa){var be=qa[Dd],Je=Dd;Je.startsWith("SiOp_")||
(ub[Je]=le.a.S_(100*be.T/ya,2))}qa=ub}ya=Object.assign(new Yd,{T:ya,S:qa});this.Hng.track(ya,this.$F.TN)}};mb.prototype.Ivj=function(){var ya=this.mL()-this.Pee,qa=le.a.S_(this.tUb/ya*100,2);ya=new Ie;ya.CP=qa;ya.II=this.ARb;qa=this.$Kc.getData();Bg.a.count(qa)&&(ya.LRT=qa);qa=this.UGc.getData();Bg.a.count(qa)&&(ya.FP=qa);this.V$d.raiseEvent("OnCpuMeterFrameAvailable",new qd(ya));this.Q1f()};mb.prototype.Q1f=function(){this.$Kc.reset();this.UGc.reset();this.tUb=this.sEa=0;this.Pee=this.mL();this.ARb=
0;this.$F=null};mb.prototype.run=function(){this.bde?this.Ivj():(this.Q1f(),this.bde=!0);this.bqa?this.bqa(Object(Sc.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Sc.a)(this,this.run,"run"),1E3)};mb.prototype.nSc=function(ya,qa,ub){var Dd=Array(2);Dd[0]=qa;Dd[1]=ub;this.zVb[ya]||(this.zVb[ya]=[]);this.zVb[ya].push(Dd)};mb.prototype.NHf=function(ya,qa){ya=this.zVb[ya];if(!Jc.a.yj(ya))for(var ub=0;ub<ya.length;ub++){var Dd=ya[ub],be=Dd[0];Dd=Dd[1];be&&!be(qa)||Dd(qa)}};mb.prototype.Wpd=function(){if(!this.aib){var ya=
window.setTimeout;this.bqa=function(qa,ub){return ya(qa,ub)};this.aib=!0}};mb.prototype.Lef=function(ya){return ya.startsWith("key")||ya.startsWith("input")};mb.prototype.Dci=function(ya){return ya.startsWith("click")||ya.startsWith("mouse")||ya.startsWith("pointer")};Object(Pb.a)(mb,"CpuMeter",null,[106]);Aa.prototype.initialize=function(ya,qa,ub,Dd){this.pgb||(this.pgb=new mb(this.mL,ya,qa,ub,void 0===Dd?!1:Dd),this.Sl.setResult(this.pgb));return this.pgb};Object(Pb.a)(Aa,"CpuMeterProvider",null,
[781]);uc.prototype.wvh=function(){for(var ya=0,qa=0;qa<this.Nw.length;qa++)this.Nw[qa]<this.Nw[ya]&&(ya=qa);return ya};uc.prototype.WXa=function(ya,qa){ya=le.a.S_(ya,2);if(this.Nw.length<this._count)Array.add(this.Nw,ya),Array.add(this.dQb,qa);else{var ub=this.wvh();ya>this.Nw[ub]&&(this.Nw[ub]=ya,this.dQb[ub]=qa)}};uc.prototype.getData=function(){if(!this.Nw.length)return null;var ya={};return ya.Vals=this.Nw,ya.Desc=this.dQb,ya};uc.prototype.reset=function(){this.Nw=[];this.dQb=[]};Object(Pb.a)(uc,
"MaxDataAggregator",null,[780]);var Bc=b(47),ye=b(86);Hc.prototype.di=function(ya){ya.register(Aa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").zc().Ic(function(){return new Aa(Bc.a.me)});ya.register(ee,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").zc().Ic(function(){return new ee})};Hc.prototype.init=function(){var ya=Xc.AFrameworkApplication.ga;if(ya.ra("CpuMeterIsEnabled")){var qa=ye.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
Ne.a.instance.bFg.continueWith(function(){Hc.$3h(ya,qa)})}};Hc.prototype.dispose=function(){};Hc.$3h=function(ya,qa){var ub=Ac.i2a(10,5,new Qd(ya.zd("TaskManagerLoggingThreshold",0),ya.zd("CpuMeterMaximumEntriesToLog",0)));qa=qa.initialize(new uc(5),new Qd,ub,ya.ra("CPUMeterExposeTaskDetailsIsEnabled"));qa.run();ya.ra("CpuMeterMonitorIsEnabled")&&ye.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(qa,ya.Tia("CpuMeterAverageCpuPercentThreshold",80),ya.zd("CpuMeterRollingAverageFramesCount",
15));ie.a(16827671,306,50,"Initializing CpuMeter")};Hc.main=function(){Xd.a.instance.mj(new Hc)};tl.Object.defineProperties(Hc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CpuMeter"}}});Object(Pb.a)(Hc,"CpuMeterPackage",null,[4,5]);var cb=b(1085);Jb.prototype.di=function(){};Jb.prototype.init=function(){cb.a.instance.init()};Jb.prototype.dispose=function(){};Jb.main=function(){Xd.a.instance.mj(new Jb)};tl.Object.defineProperties(Jb.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.EventsCachePackage"}}});Object(Pb.a)(Jb,"EventsCachePackage",null,[4,5]);var nc=b(10),Nc=b(216),Rc=b(1254),Wc=b(170),fe=b(371),ve=b(197),kc=b(150),ad=b(57),yd=b(92),wd=b(1),pe=b(19),bf=b(166),Af=b(889),bg=Rc.a;vm($b,bg);$b.prototype.dispose=function(){this.$=null;bg.prototype.dispose.call(this)};$b.prototype.i5h=function(){this.Pn(Wc.a.ste);this.Pn(Wc.a.fid);this.Pn(Wc.a.Gcc);this.Pn(Wc.a.jid);this.gSc(Wc.a.Hrd);this.Pn(Wc.a.iid)};$b.prototype.w4h=function(){this.gga(Wc.a.olb);
this.gga(Wc.a.dta);this.gga("App_CloseTab");this.gga(Wc.a.gTa);this.gga(Wc.a.hTa);this.gga(Wc.a.aid);this.gga(Wc.a.Dcc)};$b.prototype.jFi=function(){var ya={};ya.hostMessageReceived=(new Date).getTime();ed.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");Xc.AFrameworkApplication.Bod=!0;ya.appUnloadStart=(new Date).getTime();ya.sendBeaconFlight=Xc.AFrameworkApplication.ga.ra("SendBeaconOnShuttingDownRequestsEnabled");ya.sendBeaconSupported=ad.a.eda();ad.a.Kne();ya.appUnloadEnd=(new Date).getTime();
ya.appMessageSent=(new Date).getTime();this.Qj(Wc.a.kFg,ya)};$b.prototype.iFi=function(ya){ed.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");ya.Values&&fe.a.Bvd in ya.Values&&pe.a.equals(ya.Values[fe.a.Bvd],ve.a.edit,!0)&&!this.$.isEditMode&&(ed.ULS.sendTraceTag(537162881,0,50,"EwaHostMessenger.OnHostSwitchMode: Switching to {0}",ya.Values[fe.a.Bvd]),ya=new yd.a(-8805455,0,1,0,null),this.$.Ka.Zb(ya))};Object(Pb.a)($b,"EwaHostMessenger",Rc.a,[751,228,3]);var og=Nc.a;vm(db,og);
db.prototype.create=function(){var ya=this,qa=this.$.da,ub=ye.a.instance;if(!this.vye){this.vye=!0;var Dd=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||Af.a.r9:Xc.AFrameworkApplication.IBd||Af.a.r9;ub.register($b,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").zc().Ic(function(){return new $b(ya.$,window.parent,Dd,Xc.AFrameworkApplication.ga.ra("HostSendReadyToAcceptPostMessage"))})}this.Fb(qa.Aa(21)||
qa.Ha(21,ub.resolve("Postmessage.IHostPostmessenger")))};Object(Pb.a)(db,"HostMessengerFactory",Nc.a,[]);var Zf=b(116),If=b(143),qg=b(805),Vf=b(574),Fe=b(74),zg=b(125),Yf=b(457),jg=b(42),Ff=b(459),de=b(350),Tf=b(353),Ve=b(496),We=b(4),Sf=b(48);Ca.Psh=function(ya,qa,ub){var Dd={},be=Sf.b();switch(ya.command){case -1537138325:Dd.Action=qa.LabelText;break;case -1104934572:Dd.PrevTab=be.pi(parseInt(qa.OldContextCommand));Dd.NextTab=be.pi(parseInt(qa.NewContextCommand));break;case 802602464:Dd.Origin=
qa[We.a.N$];break;case -1027730316:case -1059615499:Dd.MenuType=qa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5197543_AddColorPickerMenuSectionInfoToLogs")&&"SqmControlId"in qa&&(Dd.SqmControlId=qa.SqmControlId)}Dd.InputMethod=de.a[ya.method];Dd.Location=Tf.a[ya.df];Dd.Mode=Ve.a[ya.mode];Dd.IsSystemInitiated="IsSystemInitiated"in qa?qa.IsSystemInitiated:!1;Dd.NoReporting="NoReporting"in
qa?qa.NoReporting:!1;ya=yl(Object.keys(ub));for(qa=ya.next();!qa.done;qa=ya.next())qa=qa.value,Dd[qa]=ub[qa];return Dd};Object(Pb.a)(Ca,"InteractivityRecord",null,[]);vm(Wa,Ca);Object(Pb.a)(Wa,"FirstUserInteractivityRecord",Ca,[]);var vg=b(686);Za.m4h=function(){Za.D1a||(Za.D1a=new vg.a(Vf.a.Ik()),Za.D1a.add("InputMethod"),Za.D1a.add("Location"),Za.D1a.add("Mode"))};Za.D1a=null;Object(Pb.a)(Za,"ExcelUserAction",null,[]);var kh=b(208),Pg=b(46),qf=b(429),ih=b(250),Qa=Fe.a;vm(ec,Qa);ec.prototype.dispose=
function(){this.$=this.y4=null;Qa.prototype.dispose.call(this)};ec.prototype.ZNf=function(ya,qa,ub){if(this.Sxb){var Dd=Sf.b().pi(ya.command);Dd||ed.ULS.sendTraceTag(537155555,3,50,"InteractivityLogger.ReportCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",Dd,ya.command,ya);qa=Ca.Psh(ya,qa,ub);ub=!!qa&&(!("IsSystemInitiated"in qa)||!qa.IsSystemInitiated);this.$&&this.$.fa.Mh&&ub&&cb.a.instance.dJf("OtelUserAction",new qf.a(Dd,ya.tabName,Date.now()));this.nOf(Dd,
qa,null,!0,!0)}};ec.prototype.ae=function(ya,qa,ub,Dd){this.Sxb&&this.nOf(ya,qa,void 0===ub?null:ub,!1,void 0===Dd?!1:Dd)};ec.prototype.RQd=function(ya){if(this.Sxb)if(this.y4){++this.J8e;this.y4[ya]||(this.y4[ya]=[]);var qa=this.J8e.toString();this.y4[ya].push(qa);ed.ULS.sendTraceTag(537155553,0,50,"StartInteractivityCorrellation - '{0}', correlation={1}",ya,qa)}else ed.ULS.shipAssertTag(537155554,0,!1,"StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",
ya)};ec.prototype.dRd=function(ya){if(this.Sxb)if(this.y4&&this.y4[ya]){var qa=this.y4[ya],ub=qa.pop().toString();qa.length||delete this.y4[ya];ed.ULS.sendTraceTag(537155551,0,50,"StopInteractivityCorrellation - '{0}', correlation={1}",ya,ub)}else ed.ULS.shipAssertTag(537155552,0,!1,"StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",ya)};ec.prototype.IP=function(ya,qa,ub){var Dd=this;ub=void 0===ub?!1:ub;return this.Sxb?Ff.a(function(be){Dd.ae(ya,
be(),void 0,ub)},ec.uBj,this.ma,jg.a.i7h,!1,!qa):null};ec.prototype.PHd=function(){for(var ya="",qa=0;qa<ec.r7a;qa++)ya+=this.sqd[(this.E3b+ec.r7a-qa-1)%ec.r7a]+",";ed.ULS.sendTraceTag(557188890,0,15,"Last operations {0}",ya)};ec.prototype.$Jj=function(ya){ya&&(this.sqd[this.E3b]=ya,this.E3b=(this.E3b+1)%ec.r7a)};ec.prototype.Pif=function(ya,qa,ub){Xc.AFrameworkApplication.p6b();var Dd=ya.operation,be=ya.properties;void 0!==ub?Yf.a(this.$,432,433,0,function(Je){Je.q_i(Dd,be,ub)}):this.oGj(ya);this.pGj(ya);
this.ZNi(qa,be,Dd)};ec.prototype.oGj=function(ya){this.Huj(ya)||(this.eRe=!0,ya=new Wa(ya,Pg.PageLoadTrackingInfo.instance.naa(new Date),Pg.PageLoadTrackingInfo.sE()),ya=Sys.Serialization.JavaScriptSerializer.serialize(ya),ed.ULS.sendTraceTag(458261331,0,50,"{0}",ya))};ec.prototype.Huj=function(ya){var qa=ya.properties;ya=ya.operation;return this.eRe||void 0===ya||null===ya||ya===zg.a.MRc||ya===zg.a.RKd||ya===zg.a.hCd||ad.a.Ond(ya)||!!qa&&"IsSystemInitiated"in qa&&qa.IsSystemInitiated};ec.prototype.pGj=
function(ya){wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.$Jj(ya.operation);ya=Sys.Serialization.JavaScriptSerializer.serialize(ya);ed.ULS.sendTraceTag(21542793,0,50,"{0}",ya)};ec.prototype.ZNi=function(ya,qa,ub){Zf.a.tka()&&(qa?"NoReporting"in qa&&qa.NoReporting||"IsSystemInitiated"in qa&&qa.IsSystemInitiated||!ya&&!this.oef||((ya=Zf.a.Fk(qa,ec.zWb,Za.D1a))?(qa=ec.Wsh(qa))?If.a.sendUserActionEvent(Zf.a.h3b(ub,null,qa.triggerMethod,qa.commandSurface,
ya)):ed.ULS.sendTraceTag(537155550,0,50,"user action was null"):ed.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):ed.ULS.sendTraceTag(537155548,0,50,"Not logging action telemetry because adction data was null, actionName: {0}",ub))};ec.prototype.nOf=function(ya,qa,ub,Dd,be){var Je=this,Cf=kh.a(this.$);if(this.oef){var Jg=null;pe.a.equals(ya,zg.a.itc,!0)&&qa&&"InputMethod"in qa&&(Jg=zg.a.aSe(ya,qa.InputMethod));Cf.DGb(Jg||ya,ub)}else pe.a.equals(ya,zg.a.itc,!0)&&
qa&&"InputMethod"in qa&&(ya=zg.a.aSe(ya,qa.InputMethod)),Cf.DGb(ya,ub);qa&&(qa.IsCommand=Dd);var $g=void 0;this.ddi&&($g="ActionRelativeTime"in qa?qa.ActionRelativeTime:Pg.PageLoadTrackingInfo.sE());this.R8h?Object(ih.b)(function(){var Tg=new Ca(ya,qa,Je.y4);Je.Pif(Tg,be,$g)},this.$.ma,50):(ub=new Ca(ya,qa,this.y4),this.Pif(ub,be,$g))};ec.Wsh=function(ya){if(!ya)return null;var qa=new Za;"InputMethod"in ya&&(qa.triggerMethod=ya.InputMethod);"Location"in ya&&(qa.commandSurface=ya.Location);return qa};
ec.y3h=function(ya){ya?(ya.add("Origin",2),ya.add("InputMethod",2),ya.add("ButtonType",2),ya.add("selectedRange",2),ya.add("SelectedRanges",2),ya.add("editRange",2),ya.add("Location",2),ya.add("Mode",2),ya.add("CurrentSelectionMode",2),ya.add("Action",2),ya.add("type",2),ya.add("floatingObjectType",2),ya.add("PrevTab",2),ya.add("NextTab",2),ya.add("DialogName",2),ya.add("dx",3),ya.add("dy",3),ya.add("NumberOfSelectedRanges",3),ya.add("IsCommand",1),ya.add("IsInFormulaBarEdit",1),ya.add("isLink",1),
ya.add("isSheetRef",1),ya.add("isEmptyText",1),ya.add("isFormula",1),ya.add("IsResizingHiddenHeader",1)):ed.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")};ec.uBj=1E3;ec.r7a=40;ec.zWb=null;Object(Pb.a)(ec,"InteractivityLogger",Fe.a,[10]);var qb=b(56),tc=b(35);Object(Pb.a)(Yb,"CurrentAppInfo",null,[]);$a.prototype.getAppState=function(){var ya=Pg.PageLoadTrackingInfo.instance.naa(new Date);return-1===ya?"boot":3E4>ya?"postboot":"steady"};$a.prototype.isChangeGateEnabled=
function(ya){return wd.EwaSettings.isChangeGateEnabled(ya)};$a.prototype.getCurrentAppInfo=function(){return Object.assign(new Yb,{appState:this.getAppState(),coAuthCount:this.$.fa.Em.length})};$a.prototype.sendBeaconTraceTag=function(ya,qa,ub,Dd){this.$.sendBeaconTraceTag(ya,qa,ub,Dd)};Object(Pb.a)($a,"InteractivityTrackerCallbacks",null,[796]);Object(Pb.a)(jb,"InteractivityTrackerOptions",null,[]);var fd=b(335);Ua.prototype.initialize=function(ya){ed.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");
if(this.Kaa=interactivity.InteractivityTrackerFactoryGlobal.create()){var qa=new jb;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5738340_TrackDblClick")&&Ua.A3f.push("dblclick");qa.events=Ua.A3f;qa.durationThresholdInMs=Ua.durationThresholdInMs;qa.callbacks=new $a(ya);qa.patchTaskScheduling=wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);ya=this.Kaa.start(qa);ya.started?ed.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):
ed.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+ya.failureReason)}else ed.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")};Ua.prototype.Jna=function(ya,qa){this.Kaa?this.Kaa.track(ya,qa):ed.ULS.sendTraceTag(537155540,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: {0}",qa)};Ua.prototype.fCe=function(){return this.Kaa?this.Kaa.createActionsRetriever():
(ed.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)};Ua.prototype.dispose=function(){this.Kaa&&(this.Kaa.stop(),this.Kaa=null)};Ua.durationThresholdInMs=100;Ua.A3f=["click","mousedown","contextmenu","keypress","keydown"];Ua.gbf=!1;Object(Pb.a)(Ua,"InteractivityTrackerService",null,[542]);var Rd=Nc.a;vm(Ga,Rd);Ga.prototype.create=function(){var ya=this;if(wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){var qa=
qb.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);tc.TaskExtensions.Ba(qa,function(){tc.TaskExtensions.Ba(fd.c(qa.result.wo.loadScript("interactivity")),function(){ya.Fb(ya.$.da.Aa(443)||new Ua(ya.$))},ya.$.ma,3)},this.$.ma,3)}else this.Fb(this.$.da.Aa(443)||this.$.da.Ha(443,new Ua(this.$)))};Ga.ja=function(ya){ya.da.Ha(444,new Ga(ya))};Object(Pb.a)(Ga,"InteractivityTrackerServiceFactory",Nc.a,[]);var zd=b(88),xe=b(384),me=b(9),mf=b(44),df=b(211),rf=b(52);Ha.prototype.getCustomProperties=function(ya){var qa=
new Map;if(ya.hasOwnProperty("startTimeInMs")&&ya.hasOwnProperty("totalExecutionTimeInMs")){var ub=ya.startTimeInMs;ya=this.svj.retrieveSlowActionsBetweenTimeRange(ub,ub+ya.totalExecutionTimeInMs);qa.set("actions",rf.a.Hc(ya))}return qa};Object(Pb.a)(Ha,"CallTreeCustomPropertiesRetriever",null,[779]);bb.prototype.addCustomProperty=function(ya,qa){this.customProperties.set(ya,qa)};bb.prototype.getCustomProperties=function(){return this.customProperties};Object(Pb.a)(bb,"CustomPropertiesRetriever",
null,[777]);ka.prototype.isFeatureEnabled=function(ya,qa){return wd.EwaSettings.getBooleanFeatureGate(ya,qa)};Object(Pb.a)(ka,"ExcelFeatureChecker",null,[778]);Nb.prototype.isProfilingEnabled=function(){return!0};Object(Pb.a)(Nb,"ExcelProfilingFeatureChecker",null,[776]);E.prototype.onProfilerEvent=function(ya){switch(ya.eventId){case 1:this.VKi(wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.KeepOldCollectedActions",!1));break;case 0:this.XKi();break;default:ed.ULS.sendTraceTag(537155529,
0,15,"JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId {0}",ya.eventId)}};Object(Pb.a)(E,"JSCPUProfilerObserver",null,[771]);Object(Pb.a)(vb,"JSCPUProfilerInitOptions",null,[]);Object(Pb.a)(rc,"JSCPUProfilingPackageInitOptions",null,[]);pb.prototype.dispose=function(){ed.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");zd.a.Fa(this.X1f);this.fDd=this.$=null;this.gDd.clear();this.$9a.clear()};pb.prototype.Nwj=function(){var ya=this,qa=Math.random()*this.kze;
ed.ULS.sendTraceTag(537155526,0,50,"JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: {0}",qa);this.X1f=mf.a.instance.create(function(){ya.Ydd("ExcelOnlineContinuousSessionProfiler",2).start()},qa,jg.a.Knj,!0)};pb.prototype.Zwj=function(){ed.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Ydd("ExcelOnlineFullSessionProfiler",3).start()};pb.prototype.fxj=function(ya){var qa=void 0===qa?1E4:qa;ed.ULS.sendTraceTag(537155524,
0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Hcf(ya)?this.Ydd(ya,0,qa).start():ed.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")};pb.prototype.byj=function(ya){this.Hcf(ya)?(ya=this.BZe(ya))&&ya.stop():ed.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")};pb.prototype.eDd=function(ya){return this.$9a.has(ya)};pb.prototype.wxj=function(){wd.EwaSettings.c_e()||
(wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.Zwj():this.Nwj())};pb.prototype.createProfiler=function(ya,qa,ub,Dd,be,Je){ed.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");var Cf=new vb;Cf.samplingIntervalInMs=qa;Cf.maximumNumberOfSamplesToTake=ub;Cf.idleIntervalInMs=Dd;Cf.profilingIntervalInMs=be;return this.h4g(ya,Je,Cf)};pb.prototype.f5h=function(){var ya=new Nb,qa=new rc;qa.ulsInstance=new xe.a;qa.deObfuscationEndpoint=
"ProfilerReporting.ashx";qa.shouldCompressSerializedCallTrees=!1;qa.shouldKeepSamplesOutsideOfProfilingInterval=!1;qa.shouldSendAllCallTreesFromProfileInASingleRequest=!wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);qa.shouldUseSendBeaconForSendingCallTrees=wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);qa.callTreeFilteringThresholdInMs=wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",
50);qa.deObfuscationRequestQueryParamsRetriever=this.W0g();qa.deObfuscationRequestBodyPropertiesRetriever=this.V0g();qa.featureEnabledChecker=new ka;qa.useMainEventLoopForProfilerTraceProcessing=!1;qa.profilerTraceProcessingWebWorkerSourceURL=this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;qa.shouldProcessProfileCapturedWhileUserIsIdle=wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldProcessProfileCapturedWhileUserIsIdle",!0);this.fDd=this.kGf.retrievePackage(ya,qa).retrieveProfilerFactory()};
pb.prototype.W0g=function(){var ya=new bb;ya.addCustomProperty(me.a.SGf,Xc.AFrameworkApplication.userType);ya.addCustomProperty(Xc.AFrameworkApplication.jeb,Xc.AFrameworkApplication.userSessionId);ya.addCustomProperty(me.a.qof,this.$.ya.SkipAuthentication?me.a.rof:null);ya.addCustomProperty(me.a.zDd,this.$.ya.MachineCluster);return ya};pb.prototype.V0g=function(){var ya=new bb;ya.addCustomProperty("appName","Excel");ya.addCustomProperty("buildVersion",Xc.AFrameworkApplication.buildVersion);ya.addCustomProperty("shouldUseSourceMaps",
"true");wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5619353_profilerFilterSensitiveResources")&&ya.addCustomProperty("shouldFilterSensitiveResources","true");wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5636639_UseNewDeobfForProfiler")&&ya.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","true");return ya};pb.prototype.h4g=function(ya,qa,ub){var Dd=new bb;Dd.addCustomProperty("ProfilerName",ya);this.jGf.set(ya,Dd);qa=this.fDd.createProfiler(qa,ub,Dd);this.$9a.set(ya,qa);wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5786153_JsProfilerAddSlowActionsRetriever")&&
(ya=this.y2g(ya),qa.subscribeProfilerObserver(ya,this.kVi));return qa};pb.prototype.BZe=function(ya){return this.eDd(ya)?this.$9a.get(ya):(ed.ULS.shipAssertTag(537155520,0,!1,"JsSelfProfilerManager.GetProfiler: Profiler with such name ({0}) does not exist",ya),null)};pb.prototype.Ydd=function(ya,qa,ub){ub=void 0===ub?null:ub;if(this.eDd(ya))return this.BZe(ya);var Dd=this.nii;return this.createProfiler(ya,Dd,null!=ub&&0<Dd?ub/Dd:2E6,2===qa?this.kze:null,qa?this.profilingIntervalInMs:null,qa)};pb.prototype.y2g=
function(ya){var qa=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:df.b(this.$);if(qa){var ub=qa.fCe();if(ub){qa=this.$9a.get(ya);var Dd=new Ha(ub);qa.subscribeCallTreeCustomPropertiesRetriever(Dd);qa=new E(function(be){ub.startCollectingSlowActions(be)},Object(Sc.a)(ub,ub.stopCollectingSlowActions,"stopCollectingSlowActions"));this.gDd.set(ya,qa);return qa}ed.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");
return null}ed.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null};pb.prototype.g5h=function(){this.kGf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.jGf=new Map;this.gDd=new Map;this.$9a=new Map};pb.prototype.Hcf=function(ya){return!!ya};Object(Pb.a)(pb,"JsSelfProfilerManager",null,[753,3]);var Mg=Nc.a;vm(fb,Mg);fb.prototype.create=function(){var ya=this;ed.ULS.sendTraceTag(537155489,
0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");var qa=qb.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);tc.TaskExtensions.Ba(qa,function(){wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?ya.$.da.Za(443,function(ub){ya.iBe(qa.result,ub)}):ya.iBe(qa.result)},this.$.ma,3)};fb.prototype.iBe=function(ya,qa){var ub=this;tc.TaskExtensions.Ba(fd.c(ya.wo.loadScript("officeOnlineCpuProfiling")),function(){ub.Fb(ub.$.da.Aa(437)||
new pb(ub.$,qa))},this.$.ma,3)};fb.ja=function(ya){ya.da.Ha(438,new fb(ya))};Object(Pb.a)(fb,"JsSelfProfilerManagerFactory",Nc.a,[]);Object(Pb.a)(Ta,"ActionData",null,[]);Object(Pb.a)(eb,"BlockedEngagementInfo",null,[]);vm(rb,Ta);Object(Pb.a)(rb,"SuccessfulActionData",Ta,[]);Object(Pb.a)(Tc,"SuccessfulEngagementInfo",null,[]);var lf=b(39);vd.prototype.dispose=function(){this.$.fa&&this.$.fa.hr(this.Rg);this.$.En(this.qd);zd.a.Fa(this.GKb);this.$=this.GKb=null};vd.prototype.q_i=function(ya,qa,ub){if(void 0!==
ya&&null!==ya&&qa){var Dd=this.Kcb.successfulActions.length+1,be="InputMethod"in qa?qa.InputMethod:"",Je="IsCommand"in qa&&qa.IsCommand;Dd>vd.Ilf||!this.Mgi(ya,qa,be,Je)||(ya=Object.assign(new rb,{order:Dd,name:ya,componentName:"Location"in qa?qa.Location:"",timeFromNavigationStart:ub,inputMethod:be,isCommand:Je}),Array.add(this.Kcb.successfulActions,ya),1===Dd?this.Smi():Dd===vd.Ilf&&this.dAb())}};vd.prototype.c_i=function(ya){lf.a(this.$).TXb(this.yDb);this.Nnb.hasBlockedActions=!0;this.yDb(null,
ya)};vd.prototype.fmi=function(){ed.ULS.sendTraceTag(254546634,0,50,"{0}",ag.c(this.Nnb))};vd.prototype.Smi=function(){Pg.PageLoadTrackingInfo.instance.naa(new Date)>vd.Fuh?ed.ULS.sendTraceTag(537154758,0,50,"First user interaction was filtered: {0}",ag.c(this.Kcb.successfulActions[0])):ed.ULS.sendTraceTag(254563592,0,50,"{0}",ag.c(this.Kcb.successfulActions[0]))};vd.prototype.dAb=function(){!this.t3f&&this.Kcb.successfulActions.length&&(this.t3f=!0,zd.a.Fa(this.GKb),this.GKb=null,this.$.sendBeaconTraceTag(254559496,
50,!1,ag.c(this.Kcb)))};vd.prototype.tuh=function(){this.PIa.add(zg.a.MRc);this.PIa.add(zg.a.RKd);this.PIa.add(zg.a.hCd);this.PIa.add(zg.a.LEf);this.PIa.add(zg.a.NEf);this.PIa.add(zg.a.PEf)};vd.prototype.Mgi=function(ya,qa,ub,Dd){ub=!ub||"unknown"===ub;var be="IsSystemInitiated"in qa&&qa.IsSystemInitiated;qa="NoReporting"in qa&&qa.NoReporting;var Je=this.PIa.has(ya);ya=pe.a.equals(ya,zg.a.itc,!0)&&ub;return!be&&!qa&&!Je&&!ya&&!(Dd&&ub)};vd.Ilf=10;vd.Fuh=6E4;vd.Wyj=12E4;Object(Pb.a)(vd,"PageLoadEngagementInfo",
null,[749]);var $f=Nc.a;vm(Pc,$f);Pc.prototype.create=function(){this.Fb(this.$.da.Aa(432)||this.$.da.Ha(432,new vd(this.$)))};Pc.ja=function(ya){ya.da.Ha(433,new Pc(ya))};Object(Pb.a)(Pc,"PageLoadEngagementInfoFactory",Nc.a,[]);var dg=b(49),yf=b(144),Hg=b(518),Df=b(36),xc=b(73),dd=b(374),Cd=b(32),Ld=b(226),Od=Sys.EventArgs;vm(Zc,Od);Object(Pb.a)(Zc,"ErrorDataArgs",Sys.EventArgs,[]);var ef=b(691),Xf=b(107),Qf=b(26);Ic.prototype.blj=function(ya){this.Y3b||(this.qde=ya,this.pde=Xf.toUtc(this.EHb))};
Ic.prototype.J0h=function(ya){if(ya.Values&&(!this.$3a||!this.a4a))try{fe.a.c6e in ya.Values&&(this.$3a=parseInt(ya.Values[fe.a.c6e].toString()));fe.a.d6e in ya.Values&&(this.a4a=parseInt(ya.Values[fe.a.d6e].toString()));var qa=Ne.a.instance;0<this.$3a&&(this.Nif(this.$3a,"PageLoadFromHostClick"),qa.s_i(this.$3a));0<this.a4a&&(this.Nif(this.a4a,"PageLoadFromHostFrameCreation"),qa.t_i(this.a4a));var ub=ya.Values[fe.a.M0h]||0,Dd=ya.Values[fe.a.K0h]||ya.Values[fe.a.L0h]||0;0<Dd&&qa.e_i(Dd);qa.f_i(ub)}catch(be){}};
Ic.prototype.T9i=function(){this.xSf=this.Dwe=Qf.a.Ra.Kb;this.yae=0;this.Zhd=this.Y3b=!1};Ic.prototype.lte=function(ya){var qa=this.Dwe.getTime();return qa>=ya?0:ya-qa+this.bCf};Ic.prototype.Nif=function(ya,qa){if(ya){var ub=Sf.b();ub.sKb("UserAction",qa,qa,Qf.a.xAb(ya),ef.EcmaDateClock.instance.appStart);ub.Irb(qa,Xf.toTimestamp(this.EHb))}};tl.Object.defineProperties(Ic.prototype,{bCf:{configurable:!0,enumerable:!0,get:function(){return this.yae}},EHb:{configurable:!0,enumerable:!0,get:function(){return this.qde}},
wSf:{configurable:!0,enumerable:!0,get:function(){return this.pde}},lii:{configurable:!0,enumerable:!0,get:function(){return this.lte(this.xSf.getTime())}},MOi:{configurable:!0,enumerable:!0,get:function(){return this.lte(this.wSf.getTime())}},$Yf:{configurable:!0,enumerable:!0,get:function(){return!(this.Y3b||void 0===window.bsqmXLSPageLoadStartTime)}},Dwe:{configurable:!0,enumerable:!0,get:function(){try{return this.tPb||(this.tPb=Xf.toUtc(window.bsqmXLSPageLoadStartTime)),this.tPb}catch(ya){return null}},
set:function(ya){this.tPb=ya}}});Object(Pb.a)(Ic,"PageLoadPerfInfo",null,[]);var gg=b(69);Eb.prototype.lIb=function(ya,qa){ya&&(this.wPc=this.zcb|qa<<16)};tl.Object.defineProperties(Eb.prototype,{zcb:{configurable:!0,enumerable:!0,get:function(){return this.wPc}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.zcb&65535}}});Object(Pb.a)(Eb,"ShortcutSqmData",null,[]);Mb.prototype.GQg=function(ya,qa,ub){ub||(ub=this.MVg[qa.toString()]);return Mb.ZYf(ya,ub)&&(ya=new Eb(ya,ub,ce.a.isMac),
!Cd.a.ug(this.Csd,ya.zcb.toString()))?(this.Csd[ya.zcb.toString()]=!0,ya):null};Mb.prototype.pPf=function(){this.Csd={}};Mb.u0g=function(){var ya={};return ya["1"]=1,ya["2"]=2,ya["4"]=3,ya["8"]=4,ya["16"]=5,ya["32"]=6,ya};Mb.Zai=function(ya){return 112<=ya&&123>=ya||61440<=ya&&61451>=ya};Mb.oci=function(ya){return 17!==ya&&18!==ya&&16!==ya&&91!==ya&&93!==ya};Mb.ZYf=function(ya,qa){var ub=ya.ctrlKey||ya.altKey||gg.b(ya);ya=ya.keyCode;ub=Mb.Zai(ya)||ub;ub=Mb.oci(ya)&&ub;return!!qa&&ub};Object(Pb.a)(Mb,
"UnhandledShortcutLogger",null,[]);wb.prototype.fXb=function(ya){Array.add(this.w1b,ya)};wb.prototype.tba=function(ya,qa,ub){try{if(qa)qa.endTime=ub,this.sqmManager.Rie(qa);else{qa=0;for(var Dd=this.w1b.length;qa<Dd;qa++){var be=this.w1b[qa];ya?(be.endTime=be.startTime,be.Jxe=0):be.endTime=ub;this.sqmManager.Rie(be)}}}catch(Je){}finally{Array.clear(this.w1b)}};Object(Pb.a)(wb,"UserInteractionPerfInfo",null,[]);var Ba=b(33),Ob=b(64),Ec=b(99),od=b(225),Md=Fe.a;vm(Ja,Md);Ja.prototype.fTc=function(ya){this.Ma.addHandler("EREK",
ya)};Ja.prototype.JGd=function(ya){this.Ma.removeHandler("EREK",ya)};Ja.prototype.dispose=function(){this.U6g&&Xc.AFrameworkApplication.Pm&&Xc.AFrameworkApplication.Pm.disable();this.$&&this.$.En(this.qd);this.$=this.uAc=this.uOa=this.tT=null;Md.prototype.dispose.call(this)};Ja.prototype.d3e=function(ya){this.uOa.J0h(ya);this.bni()};Ja.prototype.ALd=function(ya){this.setDw(9415,ya)};Ja.prototype.fXb=function(ya){this.uAc.fXb(ya)};Ja.prototype.tba=function(ya,qa,ub){this.uAc.tba(ya,qa,ub)};Ja.prototype.fsd=
function(ya){if(this.x2){var qa=this.fa.isNamedObjectViewMode&&1===this.workbookContext.NovMode;ya=this.$.isEditMode||ya&&this.fa.workbookContext.Options&512?2:qa?9:this.fa.lc.inEmbedView?14:1;this.setDw(8721,ya);this.Awh(ya);this.bFc=!1}};Ja.prototype.Zif=function(){var ya=this.uOa;this.x2&&ya.$Yf&&(this.setDw(9450,ya.bCf),this.setDw(9085,ya.lii))};Ja.prototype.$if=function(ya){if(!this.FGb){this.FGb=!0;var qa=this.uOa,ub=0;this.x2&&qa.$Yf?(qa.blj(ya),this.uAc.jFg=qa.wSf,this.setDw(9086,qa.MOi),
qa.Y3b=!0,ub=this.uOa.EHb.getTime()):ub=ya.getTime();tc.TaskExtensions.Ba(this.Ttb.value,function(Dd){var be={};Dd.result.Qj(Wc.a.cFg,(be[fe.a.dFg]=ub,be))},this.ma,3)}};Ja.prototype.Rie=function(ya){this.x2&&ya&&1!==ya.vda&&this.mga(8327,Ld.b(ya),Ld.n(ya),Ld.a(ya),2,ya.Jxe,Ld.o(ya),Ld.d(ya),Ld.e(ya))};Ja.prototype.MHd=function(ya,qa){ya&&ya.MessageIdHash&&this.LHd(ya.MessageIdHash,ya.MessageIdName,ya.MessageId,ya.ErrorCause?ya.ErrorCause:dg.a.Yyc,!1,qa,ya,null)};Ja.prototype.LHd=function(ya,qa,ub,
Dd,be,Je,Cf,Jg){Ja.appEncounteredFirstError||(Ja.appEncounteredFirstError=!0,yf.a.get_instance().isCompleted(13)||(yf.a.get_instance().sw(13),ed.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));ya=this.Qrb(ya);var $g=!!Cf,Tg={};Tg.ErrorName=qa;Tg.ErrorHashCode=ya.toString();Tg.ErrorId=ub.toString();Tg.ErrorCause=Dd.toString();Tg.ErrorType=Je?"BusinessBar":"ErrorDialog";Tg.BusinessBarEntryName=Jg||"null";Tg.ServerCorrelationId=$g?Cf.CorrelationId:"null";
Tg.WebMethodName=$g?Cf.WebMethodName:"null";Tg.SessionHostingEcs=this.fa.workbookContext?this.fa.workbookContext.EcsServerName:"null";Tg.EcsServerId=$g?Cf.EcsServerId:"null";Tg.WfeServerId=$g?Cf.WfeServerId:"null";qa=rf.a.Hc(Tg);this.Ma.raiseEvent("EREK",new Zc(Tg));ed.ULS.sendTraceTag(1881314,0,15,qa);this.x2&&(Ec.a.fJf(ya.toString()),this.mga(9134,ya,Dd,dg.a.JUd),this.fa.Dt||be||(this.setDw(10459,ya),this.fsd(!0),this.Vgd=!0,this.upload(),this.S7e()))};Ja.prototype.Qrb=function(ya){return 5439488|
(ya>>>16^ya&65535)&65535};Ja.prototype.usd=function(ya,qa,ub){ya=this.h8f.GQg(ya,qa,ub);this.x2&&ya&&this.mga(11007,ya.zcb)};Ja.prototype.upload=function(){!this.x2||!this.FGb&&!this.Vgd||ce.a.zf&&Xc.AFrameworkApplication.Gg?ce.a.zf&&Xc.AFrameworkApplication.Gg&&ed.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.tT.GMb(),this.bFc=!0);Xc.AFrameworkApplication.Pm=this.tT=null;this.uOa.T9i();this.FGb=!1;Xc.AFrameworkApplication.Pm=this.tT=this.MIe();this.h8f.pPf()};
Ja.prototype.bni=function(){var ya=this.uOa;if(this.x2&&!ya.Zhd){var qa=ya.$3a,ub=ya.a4a,Dd=ya.EHb.getTime();Xc.AFrameworkApplication.SP=ya.EHb;qa&&this.setDw(10324,qa>Dd?0:Dd-qa);ub&&this.setDw(10325,ub>Dd?0:Dd-ub);ya.Zhd=!0}};Ja.prototype.mga=function(ya,qa){for(var ub=[],Dd=1;Dd<arguments.length;++Dd)ub[Dd-1]=arguments[Dd];this.x2&&this.tT.mga.apply(this.tT,[ya].concat(Fl(ub)))};Ja.prototype.setDw=function(ya,qa){this.x2&&this.tT.setDw(ya,qa)};Ja.prototype.MIe=function(){dd.a.jJe(this.$.ya);return Xc.AFrameworkApplication.Pm};
Ja.prototype.Awh=function(ya){try{var qa=Object(Lf.a)(Object,rf.a.li(Xc.AFrameworkApplication.ga.appSettings.SessionStartInfoJson))}catch(be){ed.ULS.sendTraceTag(537151311,0,15,"Couldn't parse SessionStartInfoJson. Message: {0}",be.message);return}if(qa){var ub=Object(Lf.a)(String,qa.ApplicationModeExtended),Dd=Object(Lf.a)(String,qa.ApplicationMode);ub&&Dd&&(ub=ub.toUpperCase(),2!==ya&&16!==ya||"VIEW"!==ub&&"UNIFIED"!==ub?1!==ya||"EDIT"!==ub&&"UNIFIED"!==ub||(ub="VIEW",Dd="View"):(ub="EDIT",Dd="Edit"),
qa.ApplicationModeExtended=ub,qa.ApplicationMode=Dd,Xc.AFrameworkApplication.ga.appSettings.SessionStartInfoJson=rf.a.Hc(qa))}};Ja.prototype.S7e=function(){var ya=this.$.ya;this.tT.oV=!0;this.tT.yMb(ya.BWsaStartTime);this.setDw(59,83);this.FGb=!1;if(this.x2){var qa=ya.DocumentHostInfo;this.x5g();this.setDw(8491,this.$.pI);this.setDw(9236,ya.RequestedUILcid);this.setDw(8473,ya.WacHostId);this.setDw(9902,Ld.c(qa.ClusterId));wd.EwaSettings.la(472)?this.tT.nVf(""):this.tT.nVf(ya.FlightHolder?ya.FlightHolder.FlightId:
"");this.ALd(this.fa.lc.inEmbedView?1:0);this.Vgd=!1;this.setDw(9104,Ld.c(qa.FileSourceId));this.setDw(10309,this.P6h);this.dnj();Xc.AFrameworkApplication.Eb.qKf(Hg.a.getInstance(!1))}};Ja.prototype.dnj=function(){Ne.a.instance.E3h(this.tT);if(this.bZf){var ya=Ne.a.instance;ya.$Zi();ya.o_i();ya.n_i();ya.m_i();ya.i_i();this.bZf=!1}};Ja.prototype.x5g=function(){this.createStream(8327,1,od.a.P8g,od.a.c0a);this.createStream(9134,1,3,od.a.c0a);this.createStream(11007,1,1,od.a.c0a)};Ja.prototype.createStream=
function(ya,qa,ub,Dd){this.tT.createStream(ya,qa,ub,Dd)};tl.Object.defineProperties(Ja.prototype,{U6g:{configurable:!0,enumerable:!0,get:function(){return this.bFc}},P6h:{configurable:!0,enumerable:!0,get:function(){return this.$.frame.JZ?me.a.R6h:me.a.Q6h}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},tT:{configurable:!0,enumerable:!0,get:function(){Ja.Dfb||(Ja.Dfb=this.MIe());Ja.TWc||(Ja.TWc=!0,this.S7e());return Ja.Dfb},set:function(ya){Ja.Dfb=ya;
Ja.Dfb||(Ja.TWc=!1)}},x2:{configurable:!0,enumerable:!0,get:function(){return xc.a(this.$.ya,3)}}});Ja.Dfb=null;Ja.TWc=!1;Ja.appEncounteredFirstError=!1;Object(Pb.a)(Ja,"SqmManager",Fe.a,[123,722]);var He=b(879);Object(Pb.a)(Lb,"PerformanceObserverInit",null,[]);var Qe=Sys.EventArgs;vm(Ra,Qe);Object(Pb.a)(Ra,"LongTaskObservedEventArgs",Sys.EventArgs,[]);var Bf=Sys.EventArgs;vm(Sa,Bf);Object(Pb.a)(Sa,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);Da.prototype.ele=function(ya){this.Ma.addHandler("ltoek",
ya)};Da.prototype.g5i=function(ya){this.Ma.removeHandler("ltoek",ya)};Da.prototype.bBg=function(ya){this.Ma.addHandler("ltpoiek",ya)};Da.prototype.h5i=function(ya){this.Ma.removeHandler("ltpoiek",ya)};Da.prototype.dispose=function(){this.$.fa.hr(this.Rg);zd.a.Fa(this.Ma);this.$=this.Ma=null};tl.Object.defineProperties(Da.prototype,{vdc:{configurable:!0,enumerable:!0,get:function(){return this.sIc}}});Object(Pb.a)(Da,"LongTaskPerformanceObserver",null,[3]);var Uf=b(186);Tb.prototype.dhi=function(ya){return 100*
this.Isd>ya};Tb.prototype.Eyg=function(ya){this.bke(ya.longTaskDuration);this.QSc(ya.activeSessionDuration)};Tb.prototype.bke=function(ya){this.longTaskDuration+=ya};Tb.prototype.QSc=function(ya){this.activeSessionDuration+=ya};tl.Object.defineProperties(Tb.prototype,{Isd:{configurable:!0,enumerable:!0,get:function(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}}});Object(Pb.a)(Tb,"LongTaskPerformanceData",null,[]);tl.Object.defineProperties(sb.prototype,{reportName:{configurable:!0,
enumerable:!0,get:function(){return"LongTaskPerformance"}}});tl.Object.defineProperties(sb,{Qfh:{configurable:!0,enumerable:!0,get:function(){return new sb(!1,new Tb,new Tb,new Tb,0)}}});Object(Pb.a)(sb,"LongTaskPerformanceDataStatistics",null,[190]);var Ea=Sys.EventArgs;vm(sa,Ea);Object(Pb.a)(sa,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var ob=b(458),ac=b(375);va.prototype.cBg=function(ya){this.Ma.addHandler("lttek",ya)};va.prototype.i5i=function(ya){this.Ma.removeHandler("lttek",ya)};va.prototype.dispose=
function(){this.NOd=!1;this.D2f();this.$.ml(this.od);this.$.En(this.qd);this.QM.h5i(this.cwf);zd.a.Fa(this.XMa);this.QM=this.$=this.XMa=null;void 0!==this.ef&&null!==this.ef&&zd.a.Fa(this.ef)};va.prototype.Pwc=function(){void 0===this.ef||null===this.ef?ed.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.QM.vdc?this.Ogc?ed.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.NOd?(this.Ogc=!0,this.n5=sb.Qfh,this.cS=new Tb,this.$.fa.rga(this.IH),this.maxUsersCount=this.$.fa.Em.length,this.QM.ele(this.Tlc),this.ef.aFa(this.Nkc),this.ef.imb(this.Okc),Xc.AFrameworkApplication.WSc(this.Nkc),Xc.AFrameworkApplication.XSc(this.Okc),this.XMa=mf.a.instance.create(this.zjf,this.Hsd,jg.a.Sif,!1),kh.a(this.$).f9(this.n5),this.ef.kj||Xc.AFrameworkApplication.$5a||this.EQd(!0),ed.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):
ed.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):ed.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")};va.prototype.D2f=function(){this.Ogc&&(this.Ogc=!1,this.$.fa.hr(this.Rg),this.QM.g5i(this.Tlc),this.$.fa.Pca(this.IH),void 0!==this.ef&&null!==this.ef&&(this.ef.U$a(this.Nkc),
this.ef.dGb(this.Okc)),Xc.AFrameworkApplication.SLf(this.Nkc),Xc.AFrameworkApplication.TLf(this.Okc),this.XMa.cancel(),this.oMa=this.cS=this.n5=null,this.maxUsersCount=0)};va.prototype.EQd=function(ya){ya||void 0===this.oMa||null===this.oMa?(this.oMa=Qf.a.Ra.Kb,this.XMa=Uf.AsyncMethodContext.D3g(this.zjf,ya?this.Hsd:this.Hsd-this.cS.activeSessionDuration,jg.a.Sif,this.XMa)):ed.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")};
Object(Pb.a)(va,"LongTaskPerformanceTracker",null,[3]);var vc=Df.a;vm(wa,vc);wa.prototype.iq=function(ya){this.addHandler("LTSCEK",ya)};wa.prototype.zq=function(ya){this.removeHandler("LTSCEK",ya)};wa.prototype.gz=function(){this.gn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")};wa.prototype.Jr=function(ya,qa){if("QueryLongTasksCount"!==ya)return!1;this.gYh(qa);return!0};wa.prototype.gn=function(){return wd.EwaSettings.la(615)};wa.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.iF(this),
this.statusBarManager=null);this.$6a.i5i(this.dwf);vc.prototype.dispose.call(this)};wa.prototype.gYh=function(ya){ya.Value=String.format("Long Tasks: {0} | Last Task Duration: {1}ms",this.Ijf,Math.round(this.lgf))};Object(Pb.a)(wa,"LongTasksStatusBarManager",Df.a,[3,143,144]);var nb=b(8);Object(Pb.a)(Fb,"NetworkInfoData",null,[]);var fc=Df.a;vm(Sb,fc);Sb.prototype.iq=function(ya){this.addHandler("NetworkInformation",ya)};Sb.prototype.zq=function(ya){this.removeHandler("NetworkInformation",ya)};Sb.prototype.O2a=
function(){return this.f_?Object.assign(new Fb,{bandwidthMps:this.f_.downlink,rttMs:this.f_.rtt,connectionType:this.f_.type,effectiveConnection:this.f_.effectiveType,downlinkMaxMps:this.f_.downlinkMax}):null};Sb.prototype.Jr=function(ya,qa){if("QueryNetworkInformation"!==ya)return!1;this.hYh(qa);return!0};Sb.prototype.gn=function(){return this.BSc};Sb.prototype.dispose=function(){this.BSc&&(this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null),this.f_&&this.f_.removeEventListener("change",
this.Sof));this.$=null;fc.prototype.dispose.call(this)};Sb.prototype.mUd=function(ya){return nb.HelperMethods.fm(window.navigator,ya)?window.navigator[ya]:null};Sb.prototype.hYh=function(ya){ya.Value="Network: "+this.f_.downlink.toString()+" Mbps, "+this.f_.rtt.toString()+" ms"};Object(Pb.a)(Sb,"NetworkInformationManager",Df.a,[143,144]);var $d=b(185),Id=b(20);Object(Pb.a)(Gb,"OperationStatisticsData",null,[]);var Me=b(72);hb.prototype.isGroup=function(ya,qa,ub){var Dd=new $d.a;Dd.addRange(ya);Dd.addRange(qa);
for(var be=0;be<this.operationsGroups.count;be++)if(this.xdi(this.operationsGroups.na(be),Dd,ub))return ed.ULS.sendTraceTag(595194768,1,50,"OperationsGroupDetector: Operation '{0}' is part of a group ( operationsList: {1} , frameOperationsList: {2})",ub,this.NBf(ya),this.NBf(qa)),!0;ed.ULS.sendTraceTag(595194767,1,50,"OperationsGroupDetector: Operation '{0}' is NOT part of a group.",ub);return!1};hb.prototype.xdi=function(ya,qa,ub){for(var Dd=0,be=0;be<qa.count;be++)if(qa.na(be).isGroupBreaking){if(ya.count<=
Dd||!pe.a.equals(qa.na(be).name,ya.na(Dd),!0))return!1;Dd++}return ya.count>Dd&&pe.a.equals(ub,ya.na(Dd),!0)};hb.prototype.NBf=function(ya){ya=Me.select(ya,function(qa){return qa.name});return String.format("[{0}]",Me.toArray(ya).join(", "))};hb.prototype.Z2h=function(){this.operationsGroups=new $d.a;var ya;this.sXa((ya=new $d.a,ya.add("Paste"),ya.add("SelectingRange_unknown"),ya));var qa;this.sXa((qa=new $d.a,qa.add("AutoSum"),qa.add("SelectingRange_unknown"),qa));var ub;this.sXa((ub=new $d.a,ub.add("ChangeSheetDirection"),
ub.add("ActiveItemChanged"),ub));var Dd;this.sXa((Dd=new $d.a,Dd.add("InsertSheet"),Dd.add("ActiveItemChanged"),Dd.add("SelectingRange_unknown"),Dd));var be;this.sXa((be=new $d.a,be.add("DeleteSheet"),be.add("DialogButtonClick"),be.add("ActiveItemChanged"),be.add("SelectingRange_unknown"),be));var Je;this.sXa((Je=new $d.a,Je.add("EditBoxEndEdit"),Je.add("SetCell"),Je.add("SelectingRange_keyboard"),Je.add("MoveDownWithinSelectionOrCommitEdit"),Je))};hb.prototype.sXa=function(ya){this.operationsGroups.add(ya)};
Object(Pb.a)(hb,"OperationsGroupDetector",null,[]);var se=b(29);za.prototype.DGb=function(ya,qa){var ub=nb.HelperMethods.jc(),Dd=wd.EwaSettings.la(378)?this.operationsGroupDetector.isGroup(this.FC,this.XD,ya):!1;this.ifc=this.icf(ya);wd.EwaSettings.la(378)?this.ifc&&0<this.FC.count&&!Dd&&(this.zKj(),this.z$f(ya,ub),this.vRe()):0<this.FC.count&&this.icf(ya)&&(this.z$f(ya,ub),this.vRe());this.z6a=-1;if(Id.g(this.$)&&Id.g(this.$).Ca){var be=!this.p0.contains(ya);ub=new Gb(ya,ub,void 0,void 0,void 0,
be,this.ifc,Dd);this.XD.add(ub);this.framePerformanceTracker&&this.framePerformanceTracker.nxj(ub.name,qa);wd.EwaSettings.la(378)&&!this.KHb&&this.xGb.contains(ya)&&(this.KHb=!0);-1===this.AUc&&(this.AUc=window.requestAnimationFrame(this.d8i))}else ed.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")};za.prototype.qrc=function(){this.z6a=nb.HelperMethods.jc()};za.prototype.yrc=function(){this.FC.count||this.XD.count?(this.zMb(this.XD,this.z6a),this.zMb(this.FC,this.z6a)):ed.ULS.sendTraceTag(0,
1,50,"ReportOnBlockCacheConsistant when no operations in the list. Last block render time: {0}",this.z6a);this.z6a=-1};za.prototype.icf=function(ya){return!this.p_.contains(ya)&&!ya.includes("Menu")&&!ya.includes("TellMe")};za.prototype.vRe=function(){for(var ya=0;ya<this.FC.count;ya++){var qa=this.FC.na(ya);this.ZH.Cug(qa);this.Eni(qa)}this.FC.clear()};za.prototype.uLj=function(ya){for(var qa=0;qa<this.XD.count;qa++)this.XD.na(qa).startToNextFrame=this.Sdd(this.XD.na(qa).startTime,ya),this.XD.na(qa).wasHidden=
He.a.eH(this.XD.na(qa).startToNextFrame)};za.prototype.z$f=function(ya,qa){for(var ub=0;ub<this.FC.count;ub++)-1===this.FC.na(ub).startToResponseRenderEnd&&(this.FC.na(ub).operationThatLedToLogging=ya,this.FC.na(ub).startToOperationThatLedToLogging=this.Sdd(this.FC.na(ub).startTime,qa))};za.prototype.zKj=function(){for(var ya=!1,qa=yl(this.FC),ub=qa.next();!ub.done;ub=qa.next())if(ub.value.isPartOfGroup){ya=!0;break}if(ya)for(ya=0;ya<this.FC.count;ya++)this.FC.na(ya).isPartOfGroup=this.FC.na(ya).isGroupBreaking};
za.prototype.zMb=function(ya,qa){for(var ub=0;ub<ya.count;ub++)ya.na(ub).startToResponseRenderEnd=this.Sdd(ya.na(ub).startTime,qa),ya.na(ub).wasHidden=He.a.eH(ya.na(ub).startToResponseRenderEnd)};za.prototype.Eni=function(ya){ed.ULS.sendTraceTag(2020372336,1,50,"{0}",ya)};za.prototype.Sdd=function(ya,qa){return-1===ya?-1:-1===qa?-2:qa-ya};za.prototype.Uoi=function(ya){ya=ya.getEntriesByType(me.a.Fsd);for(var qa=0;qa<ya.length;qa++)if(30>this.iAb.count)if(this.XD.count)this.iAb.add(this.sQi(ya[qa]));
else{var ub=ya[qa];if(null===ub||void 0===ub?0:ub.attribution)void 0!==ub.attribution.containerSrc&&null!==ub.attribution.containerSrc&&(ub.attribution.containerSrc=""),void 0!==ub.attribution.containerId&&null!==ub.attribution.containerId&&(ub.attribution.containerId=""),void 0!==ub.attribution.containerName&&null!==ub.attribution.containerName&&(ub.attribution.containerName="");ed.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty. {0}",ub)}else{ed.ULS.sendTraceTag(537153874,
1,50,"More then {0} long tasks are in the longTaskList. entries length: {1} First long task: {2}",30,ya.length,this.iAb.na(0));break}};za.prototype.sQi=function(ya){return String.format("name:{0}, startTime:{1}, duration:{2}",ya.name,ya.startTime,ya.duration)};za.prototype.v3h=function(){this.p0||(this.p0=new vg.a(Vf.a.Ik()),this.p0.add("ActiveItemChanged"),this.p0.add(Sf.b().pi(-1398645260)),this.p0.add(Sf.b().pi(722290388)),this.p0.add(Sf.b().pi(974713501)),this.p0.add(se.a.mQ(se.a.k1b)),this.p0.add(se.a.mQ(se.a.j1b)),
this.p0.add(se.a.mQ(se.a.hpb)),this.p0.add(se.a.mQ(se.a.AGf)),this.p0.add(se.a.mQ(se.a.oma)))};za.prototype.a3h=function(){this.p_||(this.p_=new vg.a(Vf.a.Ik()),this.p_.add("PromptEditInBrowser"),this.p_.add(Sf.b().pi(-1398645260)),this.p_.add(Sf.b().pi(722290388)),this.p_.add(Sf.b().pi(974713501)),this.p_.add(se.a.mQ(se.a.k1b)),this.p_.add(se.a.mQ(se.a.j1b)),this.p_.add(se.a.mQ(se.a.hpb)),this.p_.add(se.a.mQ(se.a.AGf)),this.p_.add(se.a.mQ(se.a.oma)))};za.prototype.$2h=function(){this.xGb||(this.xGb=
new vg.a(Vf.a.Ik()),this.xGb.add("SelectingRange_keyboard"),this.xGb.add("SelectingRange_mouse"))};Object(Pb.a)(za,"OperationStatistics",null,[]);var td=b(599);Object(Pb.a)(da,"RequestError",null,[]);Zb.bYg=function(ya){if(!ya)return[];var qa=[];ya=yl(ya);for(var ub=ya.next();!ub.done;ub=ya.next())ub=ub.value,qa.push(new da(ub.MessageIdName,ub.ErrorCause));return qa};Zb.ZKh=function(ya){return!Zb.Ovi.contains(ya)};Zb.hNh=function(){var ya=new vg.a(Vf.a.Ik());ya.add("CheckPersistedContentUpdate");
ya.add("GetContentBundle");ya.add("GetSessionStatus");ya.add("GetStatusBarAggregates");ya.add("PollSessionStatus");ya.add("UpdatePresenceUsers");ya.add("UploadLatencyTelemetry");return ya};Zb.WKh=function(ya){return Zb.ezh.contains(ya)};Zb.XKh=function(ya){return Zb.qVi.contains(ya)};Zb.HJh=function(){var ya=new vg.a(Vf.a.Ik());ya.add("SetRichTextCell");ya.add("Copy");ya.add("FormatCells");ya.add("PasteRange");ya.add("FindCell");ya.add("ApplyToRangesV2");ya.add("ResizeRowsColumns");ya.add("InsertDeleteCells");
ya.add("FillRange");ya.add("PasteHtmlContent");ya.add("ApplyFilter");ya.add("PasteString");ya.add("Undo");ya.add("LineageUpdateView");ya.add("FindAll");ya.add("ApplyHyperlink");ya.add("AutoFit");ya.add("GetPrintSettings");ya.add("GetEdgeCell");ya.add("Paste");ya.add("MoveAndResizeFloatingObject");ya.add("FindRange");ya.add("SetCustomFilter");ya.add("RenameSheet");ya.add("ApplyThreadedComment");ya.add("SortFilterColumn");ya.add("InsertCopiedCutCells");ya.add("InsertSheet");ya.add("ToggleAutoFilter");
ya.add("ReorderSheets");ya.add("SetOutlineLevel");ya.add("RefreshAll");ya.add("LineageOpenPaneOrChangeFilter");ya.add("ApplySlicerSelection");ya.add("GetCardViewCardByCell");ya.add("AutoSum");ya.add("LineageClosePane");ya.add("Sort");ya.add("ClearAutoFilter");ya.add("DeleteSheet");ya.add("Redo");wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(ya.add("RemovePageBreak"),ya.add("InsertPageBreak"),ya.add("SetPrintArea"),ya.add("ClearPrintArea"));return ya};Zb.YKh=
function(){var ya=new vg.a(Vf.a.Ik());ya.add("DeleteConditionalFormattingRules");ya.add("GetConditionalFormattingRules");ya.add("AddConditionalFormattingRule");ya.add("QuickEditConditionalFormattingRule");ya.add("GetPrintSettings");ya.add("UpdatePresenceUsers");ya.add("GetThemeInfo");wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(ya.add("LineageOpenPaneOrChangeFilter"),ya.add("LineageUpdateView"),ya.add("LineageRefreshView"),ya.add("LineageLoadMore"));return ya};Zb.Ovi=
Zb.hNh();Zb.ezh=Zb.HJh();Zb.qVi=Zb.YKh();Object(Pb.a)(Zb,"RequestStatisticsData",null,[]);var af;Wb.EWg=(af=new $d.a,af.add(me.a.Z2a),af.add(me.a.Pua),af.add("GetSessionStatus"),af.add("SetCell"),af.add("FindRange"),af.add("FindAll"),af.add("FindCell"),af.add("PollSessionStatus"),af);var Fd={};Wb.ecg=(Fd.GetPrintSettings=ob.a.Pxc,Fd.UpdatePresenceUsers=ob.a.presence,Fd.GetThemeInfo=ob.a.Pxc,Fd);Object(Pb.a)(Wb,"WebRequestsKpi",null,[]);Ya.prototype.Drc=function(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Tg,Dh,Mh,
Oh,Li){Mh=td.a(Mh);ya=new Zb(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Mh,Tg,Dh,He.a.eH(qa),this.tdd(null),Oh,this.Yka.O2a(),Li);this.aId(ya)};Ya.prototype.Zh=function(ya,qa){ya="UnknownMethodName";var ub=-1;void 0!==qa.context&&null!==qa.context&&(ya=qa.context.methodName,ub=qa.context.communicationErrorRetryCount);var Dd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};if(qa.yd){var be=qa.yd.Errors||[];this.ZH.U7i(qa.yd.EditSessionIsDirty);void 0!==
qa.yd.RequestTelemetryData&&null!==qa.yd.RequestTelemetryData&&(Dd=qa.yd.RequestTelemetryData)}else be=[];var Je=qa.duration,Cf=td.a(qa.url);qa=new Zb(ya,Je,qa.totalOperationDuration,qa.PSd,qa.AE,Dd,qa.nLd,be,qa.httpStatus,Cf,ub,!0,He.a.eH(Je),this.tdd(qa.yd),qa.responseSize,this.Yka.O2a(),qa.responseToCallbackTime);this.aId(qa)};Ya.prototype.Xo=function(ya,qa){ya="UnknownMethodName";var ub=-1;void 0!==qa.context&&null!==qa.context&&(ya=qa.context.methodName,ub=qa.context.communicationErrorRetryCount);
var Dd=qa.duration,be=td.a(qa.url);qa=new Zb(ya,Dd,qa.totalOperationDuration,qa.PSd,qa.AE,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},qa.nLd,qa.errors||[],qa.httpStatus,be,ub,!1,He.a.eH(Dd),this.tdd(null),-1,this.Yka.O2a(),qa.responseToCallbackTime);this.aId(qa)};Ya.prototype.aId=function(ya){this.ZH.bEg(ya);if(wd.EwaSettings.la(230)){var qa=ya.requestName;if(qa!==me.a.Pua&&"SetCell"!==qa&&"FindRange"!==qa&&"FindAll"!==qa&&"FindCell"!==
qa)return}qa=wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===ya.requestName||null===ya.requestName)&&ya.isPromotedUTRRequest;Ya.Ddh(ya,qa);wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5158052_AddInfraToRecordKpiForWebRequests")&&Ya.h_i(ya);this.ZH.Dug(ya)};Ya.prototype.tdd=function(ya){var qa;if(null===(qa=null===ya||void 0===ya?void 0:ya.CollaborationResult)||void 0===qa?0:qa.Users)return ya.CollaborationResult.Users.length;ya=this.$.fa.Em.length;return 0<
ya?ya:1};Ya.Ddh=function(ya,qa){qa?Sf.b().wtc(388829456,0,15,ya):(qa=Sys.Serialization.JavaScriptSerializer.serialize(ya),ed.ULS.sendTraceTag(388829456,0,50,qa));if(wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==ya.requestName&&null!==ya.requestName&&ya.isFullyLoggedKPIRequest){qa=new Map;qa.set("isUserTriggeredRequest",ya.isUserTriggeredRequest.toString());qa.set("requestDuration",ya.requestDuration.toString());qa.set("totalOperationDuration",ya.totalOperationDuration.toString());
qa.set("requestTimeInQueue",ya.requestTimeInQueue.toString());qa.set("requestInvokedTime",ya.requestInvokedTime.toString());qa.set("ecsOperationDuration",ya.ecsOperationDuration.toString());qa.set("ecsRequestDuration",ya.EcsRequestDuration.toString());qa.set("wfeRequestDuration",ya.WfeRequestDuration.toString());qa.set("timeFromLastEcsFreeze",ya.TimeFromLastEcsFreeze.toString());qa.set("duringLoadOnDemand",ya.DuringLoadOnDemand.toString());qa.set("correlationID",ya.correlationID);qa.set("errors",
ya.errors.toString());qa.set("httpStatus",ya.httpStatus.toString());if(ya.networkInfoData){var ub=ya.networkInfoData;qa.set("networkInfoData_bandwidthMps",void 0===ub.bandwidthMps||null===ub.bandwidthMps?"NA":ub.bandwidthMps.toString());qa.set("networkInfoData_rttMs",void 0===ub.rttMs||null===ub.rttMs?"NA":ub.rttMs.toString());qa.set("networkInfoData_effectiveConnection",void 0===ub.effectiveConnection||null===ub.effectiveConnection?"NA":ub.effectiveConnection)}ya.requestResourceTiming&&(ub=ya.requestResourceTiming,
qa.set("requestResourceTiming_fetchStart",void 0===ub.downloadDuration||null===ub.downloadDuration?"NA":ub.downloadDuration.toString()));qa.set("communicationErrorRetryCount",ya.communicationErrorRetryCount.toString());qa.set("successfulCall",ya.successfulCall.toString());qa.set("isDocumentHidden",ya.isDocumentHidden.toString());qa.set("coauthorsCount",ya.coauthorsCount.toString());qa.set("responseSize",ya.responseSize.toString());qa.set("responseToCallbackTime",ya.responseToCallbackTime.toString());
Sf.b().zrc(ya.requestName,ya.successfulCall,qa)}};Ya.h_i=function(ya){var qa=ya.requestName;if(!Wb.EWg.contains(qa))if(!nb.HelperMethods.DZ&&!Ya.lbf)ed.ULS.sendTraceTag(537153872,0,15,"RequestStatistics.RecordKpiForRequest: Failed to record KPI since usage is not supported."),Ya.lbf=!0;else if(qa in Wb.ecg){var ub=new Map,Dd=qa+"WebRequest";ub.set("IsUserTriggeredRequest",ya.isUserTriggeredRequest.toString());ub.set("RequestDuration",ya.requestDuration.toString());ub.set("TotalOperationDuration",
ya.totalOperationDuration.toString());ub.set("RequestTimeinQueue",ya.requestTimeInQueue.toString());ub.set("EcsOperationDuration",ya.ecsOperationDuration.toString());ub.set("WfeRequestDuration",ya.WfeRequestDuration.toString());ub.set("ResponseSize",ya.responseSize.toString());ub.set("IsSuccessfulCall",ya.successfulCall.toString());ub.set("EcsRequestDuration",ya.EcsRequestDuration.toString());ub.set("ResponseToCallbackTime",ya.responseToCallbackTime.toString());Hf.Health.instance.recordKpiUsage(Dd,
0,Wb.ecg[qa].toString(),ub)}};Ya.lbf=!1;Object(Pb.a)(Ya,"RequestStatistics",null,[]);var wf=b(199),vf=b(81),pg=b(304);Object(Pb.a)(zb,"OperationTypeStatisticsData",null,[]);lb.prototype.ae=function(ya){this.data.totalCount<lb.R5c&&(Array.add(this.c2f,ya.startToNextFrame),Array.add(this.d2f,ya.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<ya.startToNextFrame&&(this.data.longestStartToNextFrame=ya.startToNextFrame);this.data.longestStartToResponse<ya.startToResponseRenderEnd&&
(this.data.longestStartToResponse=ya.startToResponseRenderEnd)};lb.prototype.R9c=function(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.jZe(this.c2f),this.data.startToResponsePercentiles=this.jZe(this.d2f))};lb.prototype.jZe=function(ya){ya.sort(nb.HelperMethods.xC);var qa="("+He.a.xua(ya,25).toString();qa=qa+", "+He.a.xua(ya,50).toString();qa=qa+", "+He.a.xua(ya,75).toString();qa=qa+", "+He.a.xua(ya,95).toString();return qa+")"};lb.R5c=1E3;Object(Pb.a)(lb,"OperationTypeStatistics",
null,[]);Object(Pb.a)(Ma,"RequestTypeStatisticsData",null,[]);Ia.prototype.A8i=function(ya){this.data.totalCount<Ia.R5c&&Array.add(this.nab,ya.requestDuration);this.data.totalCount++;this.GTd+=ya.requestDuration;this.BTd+=Ia.dbd(ya.ecsOperationDuration);this.ATd+=Ia.dbd(ya.EcsRequestDuration);this.JTd+=Ia.dbd(ya.WfeRequestDuration);0<ya.TimeFromLastEcsFreeze&&ya.TimeFromLastEcsFreeze<Ia.Vyh&&this.data.callsDuringEcsFreeze++;ya.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;
ya.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<ya.requestDuration)this.data.longestRequest=ya};Ia.prototype.R9c=function(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.GTd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.BTd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.ATd/
this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.JTd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.nab.sort(nb.HelperMethods.xC),this.data.requestDurationPercentile25=He.a.xua(this.nab,25),this.data.requestDurationPercentile50=He.a.xua(this.nab,50),this.data.requestDurationPercentile75=He.a.xua(this.nab,75),this.data.requestDurationPercentile95=He.a.xua(this.nab,95))};Ia.dbd=function(ya){return 0>
ya?0:ya};Ia.Vyh=3E3;Ia.R5c=1E3;Object(Pb.a)(Ia,"RequestTypeStatistics",null,[]);Object(Pb.a)(pa,"SessionStatisticsData",null,[]);na.prototype.qd=function(){var ya=this.w6g();ad.a.eda()?this.$.Dma(wf.a.ZPj,{xlendJson:ya},!1):vf.pb(this.$.qa.ta,ya,null,null,null,null,null);ya=this.x6g();ad.a.eda()?this.$.Dma(wf.a.$Pj,{xlenoJson:ya},!1):ed.ULS.sendTraceTag(388776782,0,50,ya);wd.EwaSettings.la(69)&&(ya=this.S0g(),ad.a.eda()?this.$.Dma(wf.a.YPj,{xlencJson:ya},!1):ed.ULS.sendTraceTag(388776770,0,50,ya));
this.h9i()};na.prototype.Pgc=function(){this.everConnectedToOcs=this.$.fa.j6a||this.everConnectedToOcs;Hf.Health.instance&&Hf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())};na.prototype.Rg=function(){var ya=new pg.a,qa="",ub=!this.$.isAnonymousUser(),Dd=ya.og();if(Dd){if(ub){ya.quc("UMI_Linkable","true");return}qa=ya.K2a("UMI_Linkable")}ub||ed.ULS.sendTraceTag(537153870,0,50,"SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:{0}, UMIIsLinkable:{1}",
Dd,!!qa)};na.prototype.kab=function(){this.zQd=!0};na.prototype.U7i=function(ya){this.dirtySessionOnLastRecordedRequest=ya};na.prototype.bEg=function(ya){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,ya.coauthorsCount);Hf.Health.instance&&Hf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())};na.prototype.Dug=function(ya){if(!(ya.requestName in this.qlb)){var qa=new Ia(ya.requestName);this.qlb[ya.requestName]=qa}this.qlb[ya.requestName].A8i(ya)};
na.prototype.Cug=function(ya){if(!(ya.name in this.plb)){var qa=new lb(ya.name,ya.isUserOperation);this.plb[ya.name]=qa}this.plb[ya.name].ae(ya)};na.prototype.f9=function(ya){this.F3c[ya.reportName]=ya};na.prototype.h9i=function(){this.dirtySessionOnLastRecordedRequest=this.zQd=!1;this.Ohf=this.$.fa.Drd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.qlb={};this.plb={};this.F3c={}};na.prototype.w6g=function(){var ya=new pa(this.$.isEditMode?"edit":"view",this.$.fa.ocsCapable,this.zQd,this.dirtySessionOnLastRecordedRequest,
this.$.fa.Drd-this.Ohf,this.maxCoauthorsCount,this.everConnectedToOcs,this.qlb);return Sys.Serialization.JavaScriptSerializer.serialize(ya)};na.prototype.x6g=function(){var ya=new $d.a,qa=this.plb,ub;for(ub in qa){var Dd=qa[ub];Dd.R9c();ya.add(Dd.data)}ya=ya.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(ya)};na.prototype.S0g=function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.F3c)};Object(Pb.a)(na,"SessionStatistics",null,[]);var sg=Fe.a;vm(xa,sg);xa.prototype.dispose=
function(){this.$&&wd.EwaSettings.la(41)&&(this.$.En(this.qd),this.$.qa.Lt(this.Zh),this.$.qa.VC(this.Xo),this.$.fa.yMf(this.Pgc),wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.fa.hr(this.Rg));zd.a.Fa(this.Yka);zd.a.Fa(this.$6a);this.ZKc=null;zd.a.Fa(this.QM);this.QM=null;zd.a.Fa(this.Jsd);this.$=this.Jsd=null;sg.prototype.dispose.call(this)};xa.prototype.kab=function(){wd.EwaSettings.la(41)&&this.ZH.kab()};xa.prototype.Drc=function(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Tg,Dh,
Mh,Oh,Li){wd.EwaSettings.la(41)&&(this.ima=this.ima||new Ya(this.$,this.ZH,this.Yka),this.ima.Drc(ya,qa,ub,Dd,be,Je,Cf,Jg,$g,Tg,Dh,Mh,Oh,Li))};xa.prototype.DGb=function(ya,qa){wd.EwaSettings.la(41)&&(this.Cla=this.Cla||new za(this.$,this.ZH,this,this.QM),this.Cla.DGb(ya,qa))};xa.prototype.qrc=function(){wd.EwaSettings.la(41)&&(this.Cla=this.Cla||new za(this.$,this.ZH,this,this.QM),this.Cla.qrc())};xa.prototype.yrc=function(){wd.EwaSettings.la(41)&&(this.Cla=this.Cla||new za(this.$,this.ZH,this,this.QM),
this.Cla.yrc())};xa.prototype.f9=function(ya){wd.EwaSettings.la(41)&&this.ZH.f9(ya)};xa.prototype.$bd=function(ya){return wd.EwaSettings.la(41)?this.YCe[ya]:null};xa.prototype.ZUf=function(ya){ya&&(this.YCe[ya.type]=ya)};xa.prototype.O2a=function(){return this.Yka.O2a()};xa.prototype.M2g=function(){ce.a.Po&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.ZKc=new va(this.$,this.QM))};tl.Object.defineProperties(xa.prototype,{$6a:{configurable:!0,enumerable:!0,get:function(){return this.ZKc}}});
Object(Pb.a)(xa,"SessionStatisticsManager",Fe.a,[721]);var Ze=b(102),Lg=b(1216),hg=b(113),ud=b(121);Z.prototype.zCj=function(){return rf.a.Hc(this)};Object(Pb.a)(Z,"AppUnloadInfo",null,[]);var xf=b(816),Nh=b(120),Fg=b(584);ma.prototype.POg=function(ya){var qa=new xf.a(Fg.a.JJ()),ub=0,Dd=0;ya=yl(ya);for(var be=ya.next();!be.done;be=ya.next()){be=be.value;qa.wb(be)||qa.ia(be,0);var Je=qa.ia(be,qa.na(be)+1);Je>ub&&(ub=Je,Dd=be)}ub>this.mostCommonOperationCount&&(this.mostCommonOperationName=Nh.a(Dd),
this.mostCommonOperationCount=ub)};Object(Pb.a)(ma,"DataLossInfo",null,[]);var mh=b(53);Y.prototype.dispose=function(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.F6i(this.WAf);this.Df&&(this.Df.eza(this.Uba),this.Df=null);this.nk.kA();this.$=this.nk=null};Y.prototype.u$f=function(){this.Vlj();this.Rab()};Y.prototype.Vlj=function(){this.vy.wasOfflineDuringUnload=this.$.uf.jV;this.vy.timeFromLastConnectivity=hg.a(Qf.a.Ra,this.$.uf.Kgf);this.vy.timeFromLastDisconnectionStart=hg.a(Qf.a.Ra,
this.$.uf.Vii);this.vy.disconnectionSource=Enum.toString(Lg.a,this.$.uf.disconnectionSource);this.$Nf&&(this.vy.hadConnectivityIssuesDuringUnload=this.$.uf.Zja,this.vy.timeFromLastStatusCode0=hg.a(Qf.a.Ra,this.$.uf.Jgf))};Y.prototype.Rab=function(){this.vy.timestamp=Date.now();this.localStorage.quc(this.GUc,this.vy.zCj())};Y.prototype.CTf=function(){var ya=this.localStorage.K2a(this.GUc);if(ya)try{var qa=rf.a.li(ya);this.localStorage.eGd(this.GUc);var ub=this.fqi(qa);ed.ULS.sendTraceTag(574677456,
0,50,ub)}catch(Dd){ed.ULS.sendTraceTag(537151056,0,15,"AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: {0}",Dd.message)}else ed.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")};Y.prototype.fqi=function(ya){var qa={};qa.WACSessionID=ya.wacSessionId;qa.wasRefreshed=this.ESg(ya,this.$.ya.MaxAppReloadDurationIndicatingRefresh);qa.closedWithDialogConfirmation=ya.dialogPromptedOnUnload;qa.wasOfflineDuringUnload=
ya.wasOfflineDuringUnload;qa.TimeFromLastConnectivityMs=ya.timeFromLastConnectivity;qa.TimeFromLastDisconnectionStart=ya.timeFromLastDisconnectionStart;qa.wasDataLostDuringUnload=ya.wasDataLostDuringUnload;qa.DataLossInfo=ya.dataLossInfo;qa.flushedOnUnload=ya.wasUpdatedOnUnload;qa.flushedOnBeforeUnload=ya.wasUpdatedOnBeforeUnload;qa.InactivityDurationBeforeUnload=ya.inactivityDurationBeforeUnloadSeconds;qa.DisconnectionSource=ya.disconnectionSource;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(qa.ApiBeforeCloseNotificationEnabledOnUnload=ya.apiBeforeCloseNotificationEnabledOnUnload);this.$Nf&&(qa.hadConnectivityIssuesDuringUnload=ya.hadConnectivityIssuesDuringUnload,qa.TimeFromLastStatusCode0=ya.timeFromLastStatusCode0);wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&(qa.LastSilentReopenStartTime=ya.lastSilentReopenStartTime,qa.LastSilentReopenEndTime=ya.lastSilentReopenEndTime);return ag.c(qa)};Y.prototype.ESg=function(ya,qa){var ub=window.performance.timing.navigationStart-
ya.timestamp;(ya=this.workbookHashedId===ya.workbookHashedId&&ub<qa)&&ed.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return ya};Y.ja=function(ya){ya.fa.lc.inWebPart||ya.da.Ha(410,new Y(ya))};tl.Object.defineProperties(Y.prototype,{dialogPromptedOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.o2d},set:function(ya){this.o2d=ya;this.vy?(this.vy.dialogPromptedOnUnload=ya,this.Rab()):this.localStorage.og()&&ed.ULS.sendTraceTag(537151058,
0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.og())}},apiBeforeCloseNotificationEnabledOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.MZd},set:function(ya){this.MZd=ya;this.vy?(this.vy.apiBeforeCloseNotificationEnabledOnUnload=ya,this.Rab()):this.localStorage.og()&&ed.ULS.sendTraceTag(537151057,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",
this.localStorage.og())}}});Y.Hri=10;Object(Pb.a)(Y,"AppUnloadTelemetryManager",null,[725,3]);var ld=b(179),mg=b(106);S.prototype.w2f=function(){ed.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.cyj(this))};S.prototype.dispose=function(){this.w2f()};tl.Object.defineProperties(S.prototype,{call:{configurable:!0,enumerable:!0,get:function(){return this.Bhg}}});
Object(Pb.a)(S,"CallMeasureContext",null,[750,3]);ca.prototype.HYg=function(){this.gOe=nb.HelperMethods.jc()};ca.prototype.s2f=function(){this.G8c+=nb.HelperMethods.jc()-this.gOe};ca.prototype.FKh=function(){return nb.HelperMethods.jc()-this.startTime};ca.prototype.Wxj=function(){this.s2f();return this.G8c};tl.Object.defineProperties(ca.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},type:{configurable:!0,enumerable:!0,get:function(){return this.AB}}});Object(Pb.a)(ca,
"MeasuredCall",null,[]);ba.prototype.U1f=function(ya,qa){this.j3g();this.Zxj();ya=new ca(ya,qa);this.Nra.push(ya);return new S(this,ya)};ba.prototype.j3g=function(){0<this.Nra.length?ed.ULS.shipAssertTag(537151054,1,!!this.NYc,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):this.NYc=ld.a.create().toString()};ba.prototype.cyj=function(ya){var qa=this.Nra.pop();if(ya.call!==qa)ed.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",
ya.call.name,qa?qa.name:"null"),this.Nra=[];else{ya=qa.FKh();var ub=qa.Wxj();ed.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var Dd=this.documentVisibilityObserver?this.documentVisibilityObserver.eH(ya+this.Ksi):null;this.Lmi(qa,ya,ub,Dd);this.IYg()}};ba.prototype.Zxj=function(){var ya=this.IXe();ya&&ya.s2f()};ba.prototype.IYg=function(){var ya=this.IXe();ya&&ya.HYg()};ba.prototype.IXe=function(){return this.Nra.length?
this.Nra[this.Nra.length-1]:null};ba.prototype.Lmi=function(ya,qa,ub,Dd){if(!(qa<this.Jsi)){var be=mg.f(this.Nra,function(Je){return Je.name}).join();ed.ULS.sendTraceTag(537151051,0,50,"ChainedCallsTracer: Inclusive duration: {0} Exclusive duration: {1} Chain ID: {2} Call ID: {3} Type: {4} Document hidden: {5} Call chain: {6}",qa.toFixed(2),ub.toFixed(2),this.NYc,ya.name,ya.type,Dd,be)}};ba.ja=function(ya){if(wd.EwaSettings.la(713)){var qa=new ba(ya.ya.ChainedCallsTracerMinThresholdToLogInMs);ya.da.Za(291,
function(ub){qa.documentVisibilityObserver=ub});ya.da.Ha(425,qa);Df.a.ohj(qa)}};Object(Pb.a)(ba,"ChainedCallsTracer",null,[724]);var hh=b(524);O.prototype.GDj=function(ya){var qa={};qa=(qa.TaskName=ya.TN,qa.TotalRunInMs=ya.TRT,qa.TotalDelayInMs=ya.TDT,qa.TotalQueueInMs=ya.TQT,qa.TaskPriority=ya.TP,qa.CoauthorsCount=this.fa.Em.length,qa);ya.TDT>this.WSd||ya.TRT>this.USd?ed.ULS.sendTraceTag(321938518,0,15,Bg.a.toJSON(qa)):(ya.TDT>this.VSd||ya.TRT>this.TSd)&&ed.ULS.sendTraceTag(321938508,0,50,Bg.a.toJSON(qa))};
O.prototype.Juh=function(ya){return this.ef.eH(ya.TRT+ya.TQT+3E3)?!1:ya.TDT>Math.min(this.VSd,this.WSd)||ya.TRT>Math.min(this.TSd,this.USd)};Object(Pb.a)(O,"TaskEventProcessor",null,[]);var $e=b(14);I.prototype.dispose=function(){this.$=null};I.prototype.xbj=function(){this.ODe||this.WOg();var ya=Id.c(Id.g(this.$));if(!this.MDe){var qa=$e.a.instance.Va(279).split(",");Array.addRange(ya,qa);this.MDe=!0}ya=yl(ya);for(qa=ya.next();!qa.done;qa=ya.next())(qa=qa.value)&&!this.O4f.has(qa)&&(this.Vmi(qa),
this.O4f.add(qa))};I.prototype.Vmi=function(ya){this.TPg(ya)};I.prototype.WOg=function(){this.ODe=I.E2a("monospace");I.E2a("sans-serif");I.E2a("serif")};I.prototype.TPg=function(ya){I.E2a(String.format("{0},{1}",ya,"monospace"));I.E2a(String.format("{0},{1}",ya,"sans-serif"));I.E2a(String.format("{0},{1}",ya,"serif"))};I.ja=function(ya){if(wd.EwaSettings.la(62)){var qa=new I(ya);ya.da.Ha(210,qa)}};I.E2a=function(ya){var qa=document.createElement("div"),ub=document.createElement("div");qa.style.cssText=
"position: absolute; overflow: auto; visibility: hidden;";I.Flj(ub,ya);document.body.appendChild(qa);qa.appendChild(ub);ub.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";ya=ub.offsetWidth+"x"+ub.offsetHeight;document.body.removeChild(ub.parentNode);return ya};I.Flj=function(ya,qa){ya.style.cssText="display: inline; visibility: hidden;";ya.style.fontSize="100px";ya.style.fontWeight="normal";ya.style.fontStyle="normal";ya.style.letterSpacing="normal";ya.style.lineHeight=
"normal";ya.style.whiteSpace="nowrap";ya.style.fontFamily=qa};Object(Pb.a)(I,"FontTelemetryManager",null,[3]);var Qg=b(229),ch=b(164),wg;(function(ya){ya[ya.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";ya[ya.reactSingleLineRibbon=1]="reactSingleLineRibbon";ya[ya.reactMultiLineRibbon=2]="reactMultiLineRibbon";ya[ya.invalid=3]="invalid"})(wg||(wg={}));Object(Pb.b)("RibbonMode",wg);var Gi=b(104),mi=Df.a;vm(R,mi);R.prototype.aFa=function(ya){this.addHandler("ekdh",ya)};R.prototype.U$a=function(ya){this.removeHandler("ekdh",
ya)};R.prototype.imb=function(ya){this.addHandler("ekduh",ya)};R.prototype.dGb=function(ya){this.removeHandler("ekduh",ya)};R.prototype.eH=function(ya){return this.kj?!0:this.uhc?Xf.getElapsedMilliseconds(this.uhc,Qf.a.Ra.Kb)<ya:!1};R.prototype.dispose=function(){zd.a.Fa(this.LY);zd.a.Fa(this.nk);mi.prototype.dispose.call(this)};R.prototype.l$f=function(){this.rL="hidden"===window.document.visibilityState;this.kj?(this.raiseEvent("ekdh"),this.L7d=Qf.a.Ra.Kb):(this.raiseEvent("ekduh"),this.M7d=Qf.a.Ra.Kb)};
tl.Object.defineProperties(R.prototype,{kj:{configurable:!0,enumerable:!0,get:function(){return this.rL}},$ff:{configurable:!0,enumerable:!0,get:function(){return this.L7d}},uhc:{configurable:!0,enumerable:!0,get:function(){return this.M7d}}});Object(Pb.a)(R,"DocumentVisibilityObserver",Df.a,[769,3]);Object(Pb.a)(W,"FramePerformanceData",null,[]);Object(Pb.a)(ia,"FramePerformanceDataGroup",null,[]);tl.Object.defineProperties(P.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this._reportName}}});
Object(Pb.a)(P,"FramePerformanceSessionEndsReport",null,[190]);N.prototype.z3g=function(){this.vga=new ia("AllGridOperationsData");this.mf.operationsGroups.push(this.vga);this.aqb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.aqb("DragScroll",["DragScroll"]);this.aqb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.aqb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.aqb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])};N.prototype.t8i=function(ya,qa,ub,Dd){var be=this.DJh(ya);be&&(mg.b(this.mf.operationsGroups,function(Je){return pe.a.equals(Je.name,be.name,!1)})||this.mf.operationsGroups.push(be),be.count++,this.Rzc(qa,
be),this.Nzc(ub,be),this.vga.count++,this.Rzc(qa,this.vga),this.Nzc(ub,this.vga),0<Dd&&this.gKj(Dd,be),0<=qa&&this.BJj(qa,be))};N.prototype.IKj=function(){for(var ya=yl(this.mf.operationsGroups),qa=ya.next();!qa.done;qa=ya.next())N.HJj(qa.value)};N.prototype.aqb=function(ya,qa){ya=new ia(ya);qa=yl(qa);for(var ub=qa.next();!ub.done;ub=qa.next())this.$zd[ub.value]=ya};N.prototype.DJh=function(ya){return ya in this.$zd?this.$zd[ya]:null};N.prototype.BJj=function(ya,qa){30>ya&&this.eVd(function(ub){ub.l1FramePerformanceData.fpsUnderThresholdOps++},
qa);15>ya&&this.eVd(function(ub){ub.l2FramePerformanceData.fpsUnderThresholdOps++},qa);5>ya&&this.eVd(function(ub){ub.l3FramePerformanceData.fpsUnderThresholdOps++},qa)};N.prototype.gKj=function(ya,qa){100<=ya&&(this.Ydb(qa.l1FramePerformanceData,ya,this.Xdb),this.Ydb(this.vga.l1FramePerformanceData,ya,this.Xdb));300<=ya&&(this.Ydb(qa.l2FramePerformanceData,ya,this.Xdb),this.Ydb(this.vga.l2FramePerformanceData,ya,this.Xdb));600<=ya&&(this.Ydb(qa.l3FramePerformanceData,ya,this.Xdb),this.Ydb(this.vga.l3FramePerformanceData,
ya,this.Xdb))};N.prototype.eVd=function(ya,qa){qa&&(ya(qa),ya(this.vga))};N.prototype.Ydb=function(ya,qa,ub){ya&&ub(ya,qa)};N.prototype.Rzc=function(ya,qa){qa.minFPS=-1===qa.minFPS?ya:Math.min(qa.minFPS,ya)};N.prototype.Nzc=function(ya,qa){qa.maxFPS=Math.max(qa.maxFPS,ya)};N.HJj=function(ya){N.DVd(ya.l1FramePerformanceData,ya.count);N.DVd(ya.l2FramePerformanceData,ya.count);N.DVd(ya.l3FramePerformanceData,ya.count)};N.DVd=function(ya,qa){ya.fpsUnderThresholdOpsPercentage=100*ya.fpsUnderThresholdOps/
qa;ya.longFramesOverThresholdOpsPercentage=100*ya.longFramesOverThresholdOps/qa};Object(Pb.a)(N,"FramePerformanceSessionEndsReportManager",null,[]);Object(Pb.a)(U,"FpsDataWrapper",null,[]);Object(Pb.a)(B,"LongFrameData",null,[]);var ph=b(340);Object(Pb.a)(w,"OperationFPSData",null,[]);var Ng=b(34),ai=b(924),Zg=Fe.a;vm(G,Zg);G.prototype.start=function(){this.ZId=!0;this.resume()};G.prototype.stop=function(){this.ZId=!1;this.pause()};G.prototype.dispose=function(){this.stop();this.ef.U$a(this.HV);Xc.AFrameworkApplication.SLf(this.yqf);
Xc.AFrameworkApplication.TLf(this.Aqf);zd.a.Fa(this.ef);this.Ca.yq(this.Hg);Zg.prototype.dispose.call(this)};G.prototype.nxj=function(ya,qa){var ub=ya in this.Kha?this.Kha[ya]:null;this.wzb=new Date;this.start();var Dd=this.wzb.getSeconds(),be=Dd+this.qBj;ub&&Dd<=ub.end?(ub.count++,ub.end=be):(ub&&Dd>ub.end&&this.vta.add(ub),this.Kha[ya]=new w(ya,1,Dd,be,void 0,void 0,void 0,this.$.fa.Em.length,Pg.PageLoadTrackingInfo.instance.naa(this.wzb),qa))};G.prototype.P1g=function(){this.V1a||(this.v$c(new Date),
this.V1a=new N(this.$))};G.prototype.resume=function(){this.iaf()||!this.Ca.NH||this.isSynthetic||(this.F6a=this.ef.kj,this.Mwa=new Date,this.qqd=this.Mwa.getMinutes(),this.tId(),this.kFe(this.Mwa.getSeconds()),this.Lmb=window.requestAnimationFrame(this.oSe))};G.prototype.iaf=function(){return 0<=this.Lmb};G.prototype.pause=function(){this.iaf()&&(this.F6a||(this.lFe((new Date).getSeconds()),ed.ULS.sendTraceTag(21280654,0,50,"FPS : {0}",this.iY.toString())),window.cancelAnimationFrame(this.Lmb),this.Lmb=
-1)};G.prototype.v$c=function(ya){if(ya.getTime()-this.Mwa.getTime()<G.Hsi&&(this.F6a&&this.lFe(this.Mwa.getSeconds()),this.igh(),0<this.vta.count&&(ya={},ya.NonEmptyCellsCount=this.N7a,ya.TextCellsCount=this.Wxc,ya.xlfpsJson=Object.assign(new U,{f:this.vta.toArray()}),ya.memoryInfo=this.Tri(),ya.zoom=Ng.a(this.$)?Ng.a(this.$).zoom:1,ya.HtmlOverlayDomCount=this.EKa,wd.EwaSettings.isChangeGateEnabled("OfficeVSO:4941972_AddRibbonModeToXLFPS")&&(ya.RibbonMode=ch.a(this.$)?wg[ch.a(this.$).Q_]:G.invalid),
ya.deviceMemory=navigator.deviceMemory||0,ya.hardwareConcurrency=navigator.hardwareConcurrency||0,ya=JSON.stringify(ya),ed.ULS.sendTraceTag(537151044,0,50,"FPS : {0}",this.iY.toString()),!this.isSynthetic))){ad.a.eda()?this.$.Dma(wf.a.aQj,{xlfpsJson:ya},!1):ed.ULS.sendTraceTag(388781010,0,50,"{0}",ya);if(this.tni)for(var qa=yl(this.vta),ub=qa.next();!ub.done;ub=qa.next()){ub=ub.value;var Dd=1E3>=this.N7a?"0_1000":3E3>=this.N7a?"1000_3000":"3000_inf",be=new Map;be.set("Operation",ub.Op);be.set("BucketOfRenderedCells",
Dd);Hf.Health.instance.recordKpiUsage(ac.a.longFrame,0,ob.a.canvas,be);0<ub.longFrameCount&&Hf.Health.instance.recordKpiFailure(ac.a.longFrame,"LongFrame",!1,!0,Object.assign(new uf.a,{extendedProperties:be}));3E4<ub.tfAppInt&&(0<ub.longFrameCount?Sf.b().oOf(0,this.Soi,be):Sf.b().pOf(0,be))}ed.ULS.sendTraceTag(537151043,0,50,"Operations message length: {0}",ya.length)}this.reset()};G.prototype.Tri=function(){var ya={};if(window.performance){var qa=window.performance.memory;qa&&(ya.jsHeapSizeLimit=
qa.jsHeapSizeLimit,ya.usedJSHeapSize=qa.usedJSHeapSize,ya.totalJSHeapSize=qa.totalJSHeapSize)}return ya};G.prototype.reset=function(){this.vta.clear();this.Kha={};this.tId()};G.prototype.igh=function(){var ya=!0;ya=void 0===ya?!0:ya;if(this.iY){for(var qa=yl(ai.a(this.Kha)),ub=qa.next();!ub.done;ub=qa.next())ub=this.Kha[ub.value],ub.end=Math.min(this.iY.length-1,ub.end),this.vta.add(ub);this.hPg(this.vta,this.iY,ya)}};G.prototype.hPg=function(ya,qa,ub){ub=void 0===ub?!0:ub;ya=yl(ya);for(var Dd=ya.next();!Dd.done;Dd=
ya.next()){Dd=Dd.value;var be=0,Je=0;if(Dd.end<qa.length){for(var Cf=Dd.start;Cf<=Dd.end;Cf++){var Jg=qa[Cf];0<=Jg&&(Dd.Max=Math.round(Math.max(Dd.Max,Jg)),Dd.Min=Math.round(Math.min(Dd.Min,Jg)),be+=Jg,Je++)}0<Je&&(Dd.Avg=Math.round(be/Je));ub&&this.V1a&&this.V1a.t8i(Dd.Op,Dd.Min,Dd.Max,Dd.LFrame?Dd.LFrame.duration:-1);Dd.Props&&(this.EFj(Dd),Dd.Props=null)}}ub&&this.V1a&&this.V1a.IKj()};G.prototype.tId=function(){this.iY=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};G.prototype.kFe=function(ya){ya++;for(var qa=0;qa<ya;qa++)this.iY[qa]=G.Q4b};G.prototype.lFe=function(ya){for(;60>ya;ya++)this.iY[ya]=G.Q4b};G.prototype.sni=function(ya,qa){ya=ya.getSeconds();var ub=ai.a(this.Kha);if(0<ub.length){ub=yl(ub);for(var Dd=ub.next();!Dd.done;Dd=ub.next())if(Dd=this.Kha[Dd.value],ya>=Dd.start&&ya<Dd.end)Dd.LFrame?Dd.LFrame.duration<qa&&(Dd.LFrame.startSecond=ya,Dd.LFrame.duration=qa,Dd.longFrameCount++):(Dd.LFrame=new B(ya,
qa),Dd.longFrameCount++)}};G.prototype.pKj=function(){this.EKa=this.Wxc=this.N7a=0;for(var ya=yl(Id.g(this.$).jn),qa=ya.next();!qa.done;qa=ya.next()){qa=qa.value.nBa;for(var ub in qa){var Dd=this.Ca.jl(qa[ub].hashCode);if(null===Dd||void 0===Dd?0:Dd.tk)this.N7a+=Dd.re.NonEmptyCellsCount,this.Wxc+=Dd.re.TextValueCellsCount,this.EKa+=Dd.EKa}}};G.prototype.EFj=function(ya){var qa=ya.Props;if(We.a.oJb in qa&&qa[We.a.oJb]&&We.a.hLb in qa){var ub;(ub=Object(Lf.a)(Qg.a,qa[We.a.hLb]))&&ub.continueWith(function(Dd){Gi.TextEditorTelemetry.instance.Swg(ya.Op,
ya.Min,!!ya.LFrame,ya.LFrame?ya.LFrame.duration:0,Dd.result)})}};G.Q4b=-1;G.Hsi=6E4;G.invalid="Invalid";Object(Pb.a)(G,"FramePerformanceTracker",Fe.a,[748,3]);var ni=Nc.a;vm(r,ni);r.prototype.create=function(){var ya=this.$.da.Aa(263);ya||(ya=this.$.da.Ha(263,new G(this.$)));this.Fb(ya)};r.ja=function(ya){ya.da.Ha(264,new r(ya))};Object(Pb.a)(r,"FramePerformanceTrackerFactory",Nc.a,[]);var yh=b(1270),fh=b(1073);z.prototype.Xh=function(ya,qa){return new fh.a(ya,qa)};z.prototype.Fc=function(ya,qa){ya=
this.Xh(ya,qa);ya.start();return ya};Object(Pb.a)(z,"DefaultStopwatchBuilder",null,[127]);t.prototype.Xh=function(ya,qa){return this.ipa.Xh(ya,qa)};t.prototype.Fc=function(ya,qa){return this.ipa.Fc(ya,qa)};Object(Pb.a)(t,"StopwatchBuilder",null,[127]);var yi=b(408),ei=b(926),la=b(1059),kb;(function(ya){ya[ya.actions=0]="actions";ya[ya.correlationStart=1]="correlationStart";ya[ya.reorderSheetOp=2]="reorderSheetOp";ya[ya.formatCellOp=3]="formatCellOp";ya[ya.copyOp=4]="copyOp";ya[ya.pasteOp=5]="pasteOp";
ya[ya.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";ya[ya.instantaneousSetData=7]="instantaneousSetData";ya[ya.immediateSetData=8]="immediateSetData";ya[ya.dependentCellsCalc=9]="dependentCellsCalc";ya[ya.dependentCellsGraphStat=10]="dependentCellsGraphStat";ya[ya.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";ya[ya.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";ya[ya.gridBlockUpdates=13]="gridBlockUpdates";ya[ya.browserAppStart=14]="browserAppStart";
ya[ya.linkedObjects=15]="linkedObjects";ya[ya.longFrames=16]="longFrames";ya[ya.task=17]="task";ya[ya.conflictInEditing=18]="conflictInEditing";ya[ya.incomingPresenceData=19]="incomingPresenceData";ya[ya.editorTableDelay=20]="editorTableDelay";ya[ya.presenceStartup=21]="presenceStartup";ya[ya.presenceDelete=22]="presenceDelete";ya[ya.editorEvent=23]="editorEvent";ya[ya.editorTime=24]="editorTime";ya[ya.gridScreenReaderOps=25]="gridScreenReaderOps";ya[ya.sendPresenceToService=26]="sendPresenceToService";
ya[ya.IME=27]="IME";ya[ya.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";ya[ya.customizeStatusBar=29]="customizeStatusBar";ya[ya.clientWebRequests=30]="clientWebRequests";ya[ya.showCommentTaskPane=31]="showCommentTaskPane";ya[ya.applyThreadedCommentChange=32]="applyThreadedCommentChange";ya[ya.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";ya[ya.findNextOrPreviousComment=34]="findNextOrPreviousComment";ya[ya.goto=35]="goto";ya[ya.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";
ya[ya.richApiInvocation=37]="richApiInvocation";ya[ya.fxLibrary=38]="fxLibrary";ya[ya.embeddedApiSession=39]="embeddedApiSession";ya[ya.numberFormattingCalculator=40]="numberFormattingCalculator";ya[ya.requestDataAfterSend=41]="requestDataAfterSend";ya[ya.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";ya[ya.copy=43]="copy";ya[ya.paste=44]="paste";ya[ya.dragDrop=45]="dragDrop";ya[ya.clearCopyState=46]="clearCopyState";ya[ya.webWorkerRecalcStats=47]="webWorkerRecalcStats";ya[ya.dataValidationEditOpenDialog=
48]="dataValidationEditOpenDialog";ya[ya.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";ya[ya.customSort=50]="customSort";ya[ya.namedSheetViewUserAction=51]="namedSheetViewUserAction";ya[ya.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";ya[ya.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";ya[ya.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";ya[ya.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";ya[ya.namedSheetViewTempViewSaveDialog=
56]="namedSheetViewTempViewSaveDialog";ya[ya.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";ya[ya.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";ya[ya.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";ya[ya.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(kb||(kb={}));Object(Pb.b)("UsageTable",kb);var Xb=b(415),Dc=b(475),xb=b(644),jd=b(692),ke=b(263),Ge=Sys.EventArgs;vm(A,Ge);Object(Pb.a)(A,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,
[]);m.prototype.EVg=function(ya){return new m(this.total+ya.total,this.MJd+ya.MJd)};m.mMg=function(ya,qa){return String.format("{0}_{1}",ya,qa)};tl.Object.defineProperties(m.prototype,{average:{configurable:!0,enumerable:!0,get:function(){return this.total/this.MJd}}});Object(Pb.a)(m,"StopwatchAverage",null,[]);var cf;(function(ya){ya[ya.longFrame=0]="longFrame";ya[ya.longGetRange=1]="longGetRange";ya[ya.longJsTask=2]="longJsTask";ya[ya.viewportCalculationLoops=3]="viewportCalculationLoops"})(cf||
(cf={}));Object(Pb.b)("UtrKpiVeto",cf);v.h3a=function(ya){return Enum.toString(cf,ya)};v.YSa="UTR";Object(Pb.a)(v,"KpiConstants",null,[]);u.dbg="UTRVetoName";u.Wag="UTRErrorName";u.OMj="UTROperationName";u.EWd="UTRDuration";u.PMj="UTREndedInPhase";u.abg="UTRMessage";u.cbg="UtrUnavailabilityType";u.operationName="OperationName";u.duration="Duration";u.message="Message";Object(Pb.a)(u,"UtrAdditionalData",null,[]);f.ZNj="VetoLike";f.ieh="E2EOperationPerf";f.Y8i="RequestPerf";f.wGj="UnavailabilityDurations";
Object(Pb.a)(f,"UtrTypes",null,[]);l.prototype.CGb=function(ya,qa,ub){ub=void 0===ub?null:ub;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ub=ub?Object.assign(new uf.a,{extendedProperties:ub}):null,ya=v.h3a(ya),Hf.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+ya,qa,!1,!0,"",ub))};l.prototype.dIb=function(ya,qa,ub,Dd,be,Je){Je[v.YSa]=f.ZNj;Je[u.dbg]=v.h3a(Dd);Je[u.Wag]=be;ed.ULS.sendTraceTag(ya,qa,ub,rf.a.Hc(Je));delete Je[v.YSa];delete Je[u.dbg];delete Je[u.Wag]};
Object(Pb.a)(l,"UtrKpiVetoReporter",null,[]);n.prototype.K8i=function(ya){var qa=null;qa=void 0===qa?null:qa;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Hf.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+v.h3a(ya),0,"",qa)};n.prototype.CGb=function(ya,qa,ub){ub=void 0===ub?null:ub;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ya=v.h3a(ya),Hf.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+ya,qa,!1,!0,this.B1c(ub)))};n.prototype.h8i=function(ya,
qa){qa=void 0===qa?null:qa;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Hf.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+v.h3a(ya),"",this.B1c(qa))};n.prototype.g8i=function(ya,qa,ub){ub=void 0===ub?null:ub;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ya=v.h3a(ya),Hf.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+ya,qa,!1,!0,"",this.B1c(ub)))};n.prototype.B1c=function(ya){return ya?Object.assign(new uf.a,{extendedProperties:ya}):
null};Object(Pb.a)(n,"UtrKpiVetoUsageReporter",null,[]);k.prototype.rrc=function(ya,qa,ub){ub=void 0===ub?null:ub;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Hf.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+ya,"",Object.assign(new uf.a,{extendedProperties:ub,durationMs:qa}))};k.prototype.zrc=function(ya,qa,ub){ub=void 0===ub?null:ub;wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(qa?Hf.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+
ya,"",Object.assign(new uf.a,{extendedProperties:ub})):Hf.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+ya,"",!1,!1,"",Object.assign(new uf.a,{extendedProperties:ub})))};k.prototype.aIb=function(ya,qa,ub,Dd,be,Je,Cf,Jg){for(var $g=[],Tg=7;Tg<arguments.length;++Tg)$g[Tg-7]=arguments[Tg];$g=String.format.apply(null,[Cf].concat($g));Tg={};Tg[v.YSa]=f.ieh;Tg[u.OMj]=Dd;Tg[u.PMj]=be;Tg[u.EWd]=Je;Tg[u.abg]=$g;ed.ULS.sendTraceTag(ya,qa,ub,rf.a.Hc(Tg))};k.prototype.cIb=function(ya,qa,ub,Dd,be,
Je){this.fXf(Je,Dd,be);ed.ULS.sendTraceTag(ya,qa,ub,rf.a.Hc(Je));this.G9g(Je)};k.prototype.bIb=function(ya,qa,ub,Dd,be,Je,Cf){for(var Jg=[],$g=6;$g<arguments.length;++$g)Jg[$g-6]=arguments[$g];Jg=String.format.apply(null,[Je].concat(Jg));$g={};this.fXf($g,Dd,be,Jg);ed.ULS.sendTraceTag(ya,qa,ub,rf.a.Hc($g))};k.prototype.wtc=function(ya,qa,ub,Dd){Dd[v.YSa]=f.Y8i;ed.ULS.sendTraceTag(ya,qa,ub,rf.a.Hc(Dd));delete Dd[v.YSa]};k.prototype.fXf=function(ya,qa,ub,Dd){Dd=void 0===Dd?null:Dd;ya[v.YSa]=f.wGj;ya[u.cbg]=
qa;ya[u.EWd]=ub;Dd&&(ya[u.abg]=Dd)};k.prototype.G9g=function(ya){delete ya[v.YSa];delete ya[u.cbg];delete ya[u.EWd]};Object(Pb.a)(k,"UtrOperationPerfReporter",null,[]);var kf=Df.a;vm(c,kf);c.prototype.TQd=function(ya,qa,ub){this.sKb(ya,qa,ub,Qf.a.xAb(Qf.a.Ra.Kb.getTime()))};c.prototype.sKb=function(ya,qa,ub,Dd,be){be=void 0===be?null:be;if(this.b7[ub])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.b7[ub]=this.iCe(ya,qa,ub,Dd,be)};c.prototype.E6c=function(ya){this.Irb(ya,
Qf.a.xAb(Qf.a.Ra.Kb.getTime()))};c.prototype.Irb=function(ya,qa){var ub=this.b7[ya];ub&&(this.sye(ub,qa),this.iIj(ub),delete this.b7[ya])};c.prototype.GLf=function(ya){delete this.b7[ya]};c.prototype.e2f=function(ya,qa){this.geb||this.W1f(ya,qa)};c.prototype.R1f=function(){this.e2f(c.kgd,this.Pg.se)};c.prototype.EIe=function(ya,qa){qa=void 0===qa?!1:qa;if(this.geb){if(this.sCa===c.rAd||this.sCa===c.kgd){var ub=Ne.a.instance;ub.userSessionId=this.userSessionId;if(this.sCa===c.rAd){this.nre||(this.uba(ya.m,
Object(Sc.a)(ub,ub.ZZi,"recordContentFetchEnd")),this.nre=!0);if(qa){this.ZCf||(this.uba(ya.m,Object(Sc.a)(ub,ub.j_i,"recordPerceivedContentDisplayed")),this.ZCf=!0);return}this.uba(ya.m,Object(Sc.a)(ub,ub.YZi,"recordContentDisplayed"))}else this.sCa===c.kgd&&(qa=this.b7[this.IMb])&&this.uba(ke.a(ya,qa.s),Object(Sc.a)(ub,ub.g_i,"recordInteractivityContentDisplayed"),!1)}this.Irb(this.IMb,ya);this.IMb=this.sCa=this.geb=null}};c.prototype.uba=function(ya,qa,ub){ub=void 0===ub?!0:ub;Ne.a.mP&&Object(yi.a)(jd.PerformanceClock,
Qf.a.Ra)&&ub&&(ya+=window.performance.timing.navigationStart);qa(ya)};c.prototype.pi=function(ya){return Xb.a(ya)};c.prototype.Ne=function(ya,qa,ub){ub=void 0===ub?!1:ub;try{this.Djf[kb[ya]]=!0,ub&&ed.ULS.sendTraceTag(3704927,0,50,x(ya,qa))}catch(Dd){ed.ULS.sendTraceTag(3704928,0,10,"Error when serializing usage table: {0} exception: {1}",ya,Dd)}};c.prototype.C6c=function(ya,qa,ub){if(this.Tnc){var Dd=this.TVa[ya+qa];Dd&&(Dd.e=ub,this.S9c(Dd));delete this.TVa[ya+qa]}};c.prototype.Rrd=function(ya,
qa){kb[ya]in this.Djf||this.Ne(ya,qa)};c.prototype.CQi=function(){this.Pg.appStart&&this.W1f(c.rAd,this.Pg.appStart)};c.prototype.woi=function(ya){var qa={};qa.a=ya.i;qa.b=ya.o;qa.c=ya.t;qa.d=ke.a(ya.s,ya.p||this.Pg.appStart);qa.e=ke.a(ya.e,ya.s);qa.f=ya.c;qa.g=ya.a;qa.h=ya.h;this.Ne(0,qa,this.$ci(qa.b,qa.c))};c.prototype.$ci=function(ya,qa){return Array.contains(["CommandTask","QueuedTask","Task"],ya)&&!Array.contains(this.Jrh,qa)?!1:!0};c.prototype.CB=function(ya,qa,ub,Dd,be){if(ya&&qa){var Je=
{};Je.a=ya;Je.b=qa;Je.c=ub.toString();Je.d=Dd.toString();this.Ne(15,Je,void 0===be?!0:be)}};c.prototype.qjf=function(ya,qa,ub,Dd){var be={};ya&&(be.c=ke.a(ya,this.Pg.appStart));be.b=qa;be.a=ub;be.d=Dd;this.Ne(17,be)};c.prototype.dispose=function(){var ya=this;this.NPa.execute(function(qa){qa.deactivate(!0);qa.r4i(ya.kyf)});this.ef&&this.ef.U$a(this.HV);kf.prototype.dispose.call(this)};c.prototype.f1e=function(){return this.Sbg=this.Sbg||new t};c.prototype.iCe=function(ya,qa,ub,Dd,be){var Je={};Je.o=
ya;Je.t=qa;Je.p=void 0===be?null:be;Je.s=(void 0===Dd?null:Dd)||this.Pg.se;this.Qjd(Je,void 0===ub?null:ub);return Je};c.prototype.sye=function(ya,qa){ya&&(ya.e=(void 0===qa?null:qa)||this.Pg.se,ya.i=ya.i||this.u_a.m7a(),ya.c=ya.c||this.MCe,ya.a=ya.a||this.TCe,ya.h=void 0!==ya.h&&null!==ya.h?ya.h:this.ef?this.ef.kj:!1,this.S9c(ya))};c.prototype.yjf=function(ya){var qa=ya.context;ya.duration>c.Mdh&&(qa.methodName===me.a.Z2a||qa.methodName===me.a.Pua)&&this.wrc(1,c.pPh);if("GetSessionStatus"!==qa.methodName){var ub=
{};ub.a=qa.methodName;ub.b=qa.stopwatch.id;ub.c=ya.Irc;ub.d=ya.responseSize;ub.e=qa.c1b;ub.f=ya.yd?ya.yd.StateId:me.a.FUd;this.Ne(30,ub,!0);this.CB(ub.b,ya.yd.ServerCorrelationId,"clientWebRequests","ServerActions")}};c.prototype.G2f=function(){if(this.Tnc){var ya=this.TVa.LoadingUIShownSplashScreen;ya&&Pg.PageLoadTrackingInfo.instance.Ajj(ya.s)}};c.prototype.wrc=function(ya,qa){this.Yag.CGb(ya,qa,null)};c.prototype.pOf=function(ya,qa){this.xAc.h8i(ya,void 0===qa?null:qa)};c.prototype.oOf=function(ya,
qa,ub){this.xAc.g8i(ya,qa,void 0===ub?null:ub)};c.prototype.qOf=function(ya){this.xAc.K8i(ya)};c.prototype.rOf=function(ya,qa){this.xAc.CGb(ya,qa,null)};c.prototype.rrc=function(ya,qa,ub){this.keb.rrc(ya,qa,void 0===ub?null:ub)};c.prototype.zrc=function(ya,qa,ub){this.keb.zrc(ya,qa,void 0===ub?null:ub)};c.prototype.sendDNMTraceTag=function(ya,qa,ub,Dd,be){for(var Je=[],Cf=4;Cf<arguments.length;++Cf)Je[Cf-4]=arguments[Cf];wd.EwaSettings.la(218)&&ed.ULS.sendTraceTag.apply(null,[ya,qa,ub,Dd].concat(Je))};
c.prototype.aIb=function(ya,qa,ub,Dd,be,Je,Cf,Jg){for(var $g=[],Tg=7;Tg<arguments.length;++Tg)$g[Tg-7]=arguments[Tg];var Dh;(Dh=this.keb).aIb.apply(Dh,[ya,qa,ub,Dd,be,Je,Cf].concat($g))};c.prototype.cIb=function(ya,qa,ub,Dd,be,Je){this.keb.cIb(ya,qa,ub,Dd,be,Je)};c.prototype.bIb=function(ya,qa,ub,Dd,be,Je,Cf){for(var Jg=[],$g=6;$g<arguments.length;++$g)Jg[$g-6]=arguments[$g];var Tg;(Tg=this.keb).bIb.apply(Tg,[ya,qa,ub,Dd,be,Je].concat(Jg))};c.prototype.dIb=function(ya,qa,ub,Dd,be,Je){this.Yag.dIb(ya,
qa,ub,Dd,be,Je)};c.prototype.wtc=function(ya,qa,ub,Dd){this.keb.wtc(ya,qa,ub,Dd)};c.prototype.S9c=function(ya){this.jyj.woi(ya)};c.prototype.DQi=function(){if(this.Tnc){Stw.swpc=null;var ya=this.Tnc,qa;for(qa in ya)this.Qjd(ya[qa])}};c.prototype.Ruh=function(){var ya=this,qa=window[Dc.a.namespace];if(qa){var ub=qa[Dc.a.zxe];ub&&(delete qa[Dc.a.zxe],ub.forEach(function(Dd){ya.Qjd(Dd);ya.S9c(Dd)}))}};c.prototype.kei=function(ya,qa){if("about:blank"===ya||"renamehandler.ashx"===qa&&"2"===nd.a.tA(ya,
"u"))return!0;for(ya=0;ya<this.hId.length;ya++)if(qa.endsWith(this.hId[ya]))return!0;return!1};c.prototype.gmi=function(){var ya=this;this.NPa.execute(function(qa){qa.di(c.AIg,0);qa.bAg(ya.kyf);qa.activate()})};c.prototype.$li=function(){var ya={};ya.a=new Date(ef.EcmaDateClock.instance.appStart.m);ya.b=this.userSessionId;ya.c=this.Pg.D5f;ya.d=c.u8g*Cb.devicePixelRatio;ya.e=Qf.a.Ra.appStart.m;this.Ne(14,ya,!0);this.uba(Qf.a.Ra.appStart.m,Object(Sc.a)(Ne.a.instance,Ne.a.instance.RZi,"recordAppInitStart"))};
c.prototype.W1f=function(ya,qa){this.geb=this.u_a.m7a();this.IMb=this.u_a.m7a();this.sCa=ya;this.sKb("UserAction",ya,this.IMb,qa);this.zif(ya,this.geb)};c.prototype.sAj=function(){var ya=this,qa=window[Dc.a.namespace];qa&&!c.GAe&&(qa[Dc.a.hxj]=function(ub,Dd){return ya.iCe(ub,Dd)},qa[Dc.a.kgh]=function(ub){ya.sye(ub)},c.GAe=!0)};c.prototype.iIj=function(ya){var qa=m.mMg(ya.o,ya.t),ub=new m(ke.a(ya.e,ya.s)),Dd=qa in this.iRd?this.iRd[qa].EVg(ub):ub;this.iRd[qa]=Dd;if(ub===Dd||ub.average!==Dd.average)ya=
Object.assign(new A,{operation:ya.o,target:ya.t,gvi:Dd.average,sender:this}),this.raiseEvent(qa,ya)};c.prototype.zif=function(ya,qa){var ub={};ub.a=qa;ub.b=this.userSessionId;ub.c=ya;this.Ne(1,ub,!0)};c.prototype.j4h=function(){this.hId=["RemoteUls.ashx","GetSessionStatus",me.a.Pua,"Collector/3.0/","CheckCollabServiceContentUpdate","UpdatePresenceUsers","GetNumberFormatCategory","GetObjectMetadata","SetCell","GetSheetProcessedData","UploadLatencyTelemetry","PollSessionStatus","GetStatusBarAggregates",
"GetRichValueFieldListContextList","GetInstantaneousSupportInformation"]};c.prototype.Qjd=function(ya,qa){ya.i=(void 0===qa?null:qa)||this.u_a.m7a();ya.a=this.TCe;ya.c=this.MCe;ya.h=this.ef?this.ef.kj:!1};c.ja=function(ya){var qa=new R;ya.da.Ha(291,qa);qa=new c(ya.ya.UserSessionId,void 0,void 0,void 0,qa,!0);qa.zif(c.pof,qa.GDe);ed.ULS.sendTraceTag(19481687,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");qa.gmi();qa.sAj();qa.CQi();qa.$li();qa.Ruh();qa.DQi();qa.j4h();c.vhj(ya);
Ze.a.Xi.Ha(41,qa)};c.vhj=function(ya){var qa=Cb.devicePixelRatio;1<qa&&ya.lc.tw(!0,2<=qa?8388608:4194304)};tl.Object.defineProperties(c.prototype,{b7:{configurable:!0,enumerable:!0,get:function(){return this.Wee||(this.Wee={})}},MCe:{configurable:!0,enumerable:!0,get:function(){return this.geb||this.GDe}},TCe:{configurable:!0,enumerable:!0,get:function(){return this.sCa||c.pof}},iRd:{configurable:!0,enumerable:!0,get:function(){return this.Aqe=this.Aqe||{}}},Tnc:{configurable:!0,enumerable:!0,get:function(){return this.TVa||
"undefined"===typeof Stw?this.TVa:this.TVa=Stw.swpc}},Djf:{configurable:!0,enumerable:!0,get:function(){return this.S8d=this.S8d||{}}},NPa:{configurable:!0,enumerable:!0,get:function(){return this.ckb||(this.ckb=ye.a.instance.mc("Common.NetworkTiming.IResourceTimingLogger"))}},Yag:{configurable:!0,enumerable:!0,get:function(){return this.Zag||(this.Zag=new l)}},keb:{configurable:!0,enumerable:!0,get:function(){return this.bbg||(this.bbg=new k)}},xAc:{configurable:!0,enumerable:!0,get:function(){return this.$ag||
(this.$ag=new n)}}});c.pof="UnassignedUserAction";c.rAd="PageLoad";c.kgd="GridUpdateOperation";c.Mdh=5E3;c.pPh="MoreThan_5000_Ms";c.u8g=96;c.AIg=30;c.GAe=!1;Object(Pb.a)(c,"TelemetryManager",Df.a,[717,718,719,720]);var jf=b(188),Ef=b(103);Object(Pb.a)(d,"Validation",null,[]);a.prototype.vSc=function(ya,qa,ub,Dd,be){if(ya&&Dd){var Je=jf.a.Jy(qa,ub);this.jXb(function(){return!!Ef.a(ya).Hp(Je)},Dd.StateId,be)}};a.prototype.jXb=function(ya,qa,ub){this.Oyg(this.mRe,ya,qa,ub)};a.prototype.Oyg=function(ya,
qa,ub,Dd){ya&&qa&&ub!==me.a.Se&&ya.add(new d(qa,ub,Dd))};a.prototype.dDf=function(ya){if(ya){for(var qa=new $d.a,ub=yl(ya),Dd=ub.next();!Dd.done;Dd=ub.next()){Dd=Dd.value;if(Dd.vU===this.$.fa.rf)try{Dd.BNj()||ed.ULS.sendTraceTag(537151010,0,15,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [{0}]",Dd.name)}catch(be){ed.ULS.sendTraceTag(537151009,0,10,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [{0}]. Exception: [{1}]",
Dd.name,be)}qa.add(Dd)}qa=yl(qa);for(Dd=qa.next();!Dd.done;Dd=qa.next())ya.remove(Dd.value)}else ed.ULS.shipAssertTag(537151011,0,!!ya,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")};a.prototype.dispose=function(){Id.g(this.$)&&Id.g(this.$).Ca&&(Id.g(this.$).Ca.yq(this.Hg),Id.g(this.$).Ca.AGd(this.a8a));this.$=null};a.ja=function(ya){var qa=new a(ya);ya.da.Ha(277,qa)};Object(Pb.a)(a,"ValidationTelemetryManager",null,[716,3]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");
Lc.main();Type.registerNamespace("CNT");Bd.main();Type.registerNamespace("CACPU");Hc.main();Type.registerNamespace("Common.App.EventsCacheManager");Jb.main();(function(){nc.a.Ga(function(ya){ya.da.Ha(137,new db(ya))})})();(function(){nc.a.Ga(function(ya){ya.da.Ha(37,new ec(ya))})})();(function(){nc.a.Ga(function(ya){Ga.ja(ya)})})();(function(){nc.a.Ga(function(ya){fb.ja(ya)})})();(function(){nc.a.Ga(function(ya){Pc.ja(ya)})})();(function(){nc.a.Ga(function(ya){ya.da.Ha(40,new Ja(ya,new gd.a(function(){return qb.GetServiceTaskFactory.create(ya.da,
137,ya.ma,1)})))})})();(function(){nc.a.Ga(function(ya){ya.da.Ha(276,new xa(ya))})})();(function(){nc.a.Ga(function(ya){Ze.a.Xi.Za(135,function(){c.ja(ya);I.ja(ya);a.ja(ya);r.ja(ya);wd.EwaSettings.la(415)&&Q(ya);Y.ja(ya);ba.ja(ya);wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RenderingFidelityMetric",!1)&&yh.RenderingFidelityTracker.ja(ya)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.tm.js.map/fca21e07576cc7ceb3417860d200a075/EwaDS.tm.js.map