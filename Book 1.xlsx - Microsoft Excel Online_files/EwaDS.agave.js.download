(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1014:function(y,D,b){function a(){this.OKa=0;this.Wga=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.ucc=!1;this.I6e=this.Tha=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"AddInCommandsNotificationParameters",null,[])},1070:function(y,D,b){function a(){}function d(){}function c(Q,O,ba,ca,S,Y){Q=k.call(this,Q,O,ba,ca,S,void 0===Y?null:Y)||this;Q.RSb=null;return Q}function k(Q,O,
ba,ca,S,Y){Q=n.call(this,Q,ba,S.MW,void 0===Y?null:Y)||this;Q.G9d=0;Q.P0=Q.tMh(ca);Q.MWa=O;Q.Ie=S;Q.pCj=7;Q.el=Q.MWa.ownerDocument.createElement("div");Q.el.className="ModalCalloutControlOverlay";Q.el.tabIndex=0;Q.MWa.insertBefore(Q.el,Q.MWa.firstChild);return Q}function n(Q,O,ba,ca){var S=A.call(this,document.createElement("div"))||this;S.dqa=null;S.Foa=null;S.WF=null;S.PF=null;S.Dw=null;S.kS=null;S.lS=null;S.qpa=!1;S.Dhb=!1;S.lp=null;S.content=null;S.P0=0;S.Hqe=null;S.rT=0;S.Dzf=null;S.xfe=Q;S.Cae=
O;S.IO=ba;S.sGa=ca;S.vg=O.ownerDocument;S.Vhb=!1;S.Gu=!1;S.lhd=!1;return S}y=b(0);var l=b(13),f=b(80),u=b(369),v=b(12),m=b(89),A=Sys.UI.Control;vm(n,A);n.prototype.show=function(){this.Vhb||(this.l1g(),this.Gj(),this.Cae.appendChild(this.NV),this.NV.style.display="Block",this.ylj(),this.Vhb=!0,this.Dzf&&this.Dzf())};n.prototype.dismiss=function(){this.Vhb&&(this.gU(),this.Cae.removeChild(this.NV),this.Vhb=!1,this.sGa&&this.sGa())};n.prototype.dispose=function(){this.dismiss();this.kS=this.Dw=this.PF=
this.Foa=this.WF=this.dqa=null;Sys.Component.prototype.dispose.call(this)};n.prototype.mi=function(Q){return this.get_element().id+Q};n.prototype.l1g=function(){this.WF=this.vg.createElement("div");this.WF.id=this.mi("WACCalloutHeader");this.WF.className="WACCalloutHeader";this.Gu&&this.Qie();this.lhd&&this.Zje();this.PF=this.vg.createElement("div");this.PF.id=this.mi("WACCalloutContent");this.PF.className="WACCalloutContent";this.PF.style.width=190<this.P0?this.P0-26+"px":"164px";this.PF.appendChild(this.content);
this.NV.appendChild(this.QZb);this.NV.appendChild(this.WF);this.NV.appendChild(this.PF)};n.prototype.Qie=function(){this.Dw=this.vg.createElement("a");this.Dw.className="WACCalloutCloseAnchor";this.Dw.id=this.mi("WACCalloutCloseAnchor");this.Dw.href="#";this.WF.appendChild(this.Dw);var Q=u.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Dw.appendChild(Q)};n.prototype.Zje=function(){this.kS=this.vg.createElement("div");this.kS.className=
"WACCalloutTitle UIFontBold";this.kS.style.width=190<this.P0?this.P0-30+"px":"160px";this.kS.id=this.mi("WACCalloutTitle");this.kS.innerText=this.title;this.WF.contains(this.Dw)?this.WF.insertBefore(this.kS,this.Dw):this.WF.appendChild(this.kS)};n.prototype.ylj=function(){var Q=this.xfe;if(1===this.rT){var O=this.Hqe.y+16;var ba=-16}else 2!==this.rT&&3!==this.rT&&this.rT?(O=Q.y-this.NV.clientHeight-15-2,ba=this.NV.clientHeight-1):(O=Q.y+Q.height+15,ba=-15);this.NV.style.top=O+"px";this.QZb.style.top=
ba+"px";1===this.rT?(Q=this.Hqe.x-16,this.NV.style.left="50%",this.NV.style.marginLeft=-this.P0/2+"px",O=Sys.UI.DomElement.getBounds(this.NV),this.QZb.style.left=Q-O.x+"px"):(O=Q.x+this.xfe.width/2,2===this.rT||5===this.rT?(Q=20,O-=36):this.rT&&4!==this.rT?(Q=this.P0-20-32,O=O-this.P0+36):(Q=this.P0/2-16,O-=this.P0/2),this.NV.style.left=O+"px",this.QZb.style.left=Q+"px")};n.prototype.Gj=function(){this.Gu&&!this.lS&&(this.lS=Object(f.a)(this,this.U9,"closeHandler"),this.IO.pa(v.a.click,this.Dw,this.lS,
null))};n.prototype.gU=function(){this.Gu&&this.lS&&(this.IO.za(v.a.click,this.Dw,this.lS),this.lS=null)};n.prototype.U9=function(){this.dismiss();return!0};tl.Object.defineProperties(n.prototype,{NV:{configurable:!0,enumerable:!0,get:function(){this.dqa||(this.dqa=this.vg.createElement("div"),this.dqa.id=this.mi("WACCalloutOuter"),this.dqa.className="WACCalloutOuter",this.dqa.setAttribute(m.a.Sd,m.a.kYa),this.dqa.style.width=this.P0+"px");return this.dqa}},QZb:{configurable:!0,enumerable:!0,get:function(){if(!this.Foa){this.Foa=
this.vg.createElement("div");this.Foa.id=this.mi("WACCalloutBeakContainer");this.Foa.className="WACCalloutBeakContainer";var Q="CalloutBeakTopFilled_32x16x32";if(5===this.rT||6===this.rT||4===this.rT)Q="CalloutBeakBottomFilled_32x16x32";Q=u.createClusteredImage(32,16,Q,"WACCalloutBeak",!0,"");this.Foa.appendChild(Q)}return this.Foa},set:function(Q){this.Foa=Q}},tLa:{configurable:!0,enumerable:!0,get:function(){return this.Vhb}},title:{configurable:!0,enumerable:!0,get:function(){return this.lp},set:function(Q){this.lp!==
Q&&(this.lp=Q,this.kS&&(this.kS.innerText=this.lp))}},Gu:{configurable:!0,enumerable:!0,get:function(){return this.qpa},set:function(Q){this.qpa!==Q&&(this.qpa=Q,this.WF&&(this.WF.contains(this.Dw)&&!this.qpa?this.WF.removeChild(this.Dw):!this.WF.contains(this.Dw)&&this.qpa&&this.Qie()))}},lhd:{configurable:!0,enumerable:!0,get:function(){return this.Dhb},set:function(Q){this.Dhb!==Q&&(this.Dhb=Q,this.WF&&(this.WF.contains(this.kS)&&!this.Dhb?this.WF.removeChild(this.kS):!this.WF.contains(this.kS)&&
this.Dhb&&this.Zje()))}}});Object(y.a)(n,"Callout",Sys.UI.Control,[277]);vm(k,n);k.prototype.show=function(){this.tLa||(this.Ie.zEb(),this.Ie.jP(!1),this.el.style.zIndex=String(this.Ie.S1),n.prototype.show.call(this),this.ak(),this.G9d=window.setTimeout(Object(f.a)(this,this.dismiss,"dismiss"),1E3*this.pCj))};k.prototype.dismiss=function(){this.tLa&&(this.Ie.eM(!1),this.mm(),this.MWa&&this.MWa.contains(this.el)&&this.MWa.removeChild(this.el),n.prototype.dismiss.call(this),window.clearTimeout(this.G9d))};
k.prototype.ak=function(){this.Ie.cra(Object(f.a)(this,this.dismiss,"dismiss"));this.Ie.fy.pa(v.a.click,this.el,Object(f.a)(this,this.Vc,"onClick"))};k.prototype.mm=function(){this.Ie.Z$a(Object(f.a)(this,this.dismiss,"dismiss"));this.Ie.fy.za(v.a.click,this.el,Object(f.a)(this,this.Vc,"onClick"))};k.prototype.Vc=function(){this.dismiss();return!0};k.prototype.tMh=function(Q){var O=0;switch(Q){case 0:O=190;break;case 1:O=250;break;case 2:O=300;break;case 3:O=360}return O};Object(y.a)(k,"ModalCallout",
n,[]);var x=b(582),t=b(187);vm(c,k);c.prototype.show=function(){var Q=this;if(!this.tLa){var O=Object.assign(new x.a,{onShow:function(){k.prototype.show.call(Q)}});t.UISurfaces.pM().then(function(ba){var ca=ba.externalNotification();Q.RSb=ba.addNotification(ca,O);return null},function(ba){l.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",ba);return null})}};c.prototype.dismiss=function(){var Q=this;this.tLa&&this.RSb&&(t.UISurfaces.pM().then(function(O){O.removeNotification(Q.RSb);
return Q.RSb=null},function(O){l.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",O);return null}),k.prototype.dismiss.call(this))};Object(y.a)(c,"ReactManagedModalCallout",k,[]);var z=b(5);d.Y2g=function(Q,O,ba,ca){var S=void 0===S?null:S;return z.AFrameworkApplication.sa.Pa.nH?new c(Q,O,ba,ca,z.AFrameworkApplication.sa,S):new k(Q,O,ba,ca,z.AFrameworkApplication.sa,S)};Object(y.a)(d,"ModalCalloutControlFactory",null,[]);var r=b(49),G=b(1002),w=b(595),B=b(1003),U=b(128),
N=b(87),P=b(47),ia=b(86),W=b(942),R=b(830),I=b(818);b.d(D,"a",function(){return a});a.C1c=function(Q,O,ba,ca,S,Y){a.KI&&a.KI.tLa&&a.KI.dismiss();a.KI=d.Y2g(O,Q,Q,S);a.KI.content=ba;I.b(ca)||(a.KI.title=ca,a.KI.lhd=!0);Q=new Sys.UI.Bounds(0,0,N.a.j3a(),N.a.Uac());a.KI.rT=a.rEh(Q,O,a.KI.P0,Y);a.KI.show();a.nZb&&a.nZb.sendNotification(ba.innerText,!0)};a.E1c=function(Q,O,ba,ca){ca=void 0===ca?null:ca;t.UISurfaces.pM().then(function(S){var Y=null;a.Rjb&&(S.removeNotification(a.Rjb),a.Rjb=null);var ma=
S.callout(Object.assign(new G.a,{target:Q,title:O,content:ba,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:function(){S.removeNotification(Y)},directionalHint:null!=ca?ca:null})})),Z=Object.assign(new x.a,{expirationOptions:Object.assign(new w.a,{displayTimeoutSeconds:7,onExpire:function(){S.removeNotification(a.Rjb)}})});Y=a.Rjb=S.addNotification(ma,Z);return null},function(S){l.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
S);return null})};a.Fvc=function(Q,O){O=void 0===O?null:O;a.KI&&a.KI.tLa&&a.KI.dismiss();var ba=new U.StandardDialog;ba.rRa=!1;ba.kc=0;ba.xz(r.a.kji,CommonUIStrings.l_DialogError,I.b(Q)?a.NVe():Q,O)};a.SOd=function(Q){a.KI&&a.KI.tLa&&a.KI.dismiss();l.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",Q.errorCode));var O=I.b(Q.description)?a.NVe():Q.description,ba=new U.StandardDialog,ca=null;Q.Wga?(ba.kc=1,ba.Cc(1,Q.buttonText),ba.Kma(1)):ba.kc=0;ca=function(S){1===
S?Q.Wga():Q.Tha&&Q.Tha()};ba.rRa=!1;0===Q.OKa?ba.xz(Q.errorCode,Q.title?Q.title:CommonUIStrings.l_DialogError,O,ca):1===Q.OKa?ba.GW(Q.title?Q.title:CommonUIStrings.l_DialogWarning,O,ca):ba.cAa(Q.title?Q.title:CommonUIStrings.l_DialogInfo,O,ca)};a.rEh=function(Q,O,ba,ca){var S=ca?4:0,Y=Q.x+Q.width-O.x-O.width;O.x-Q.x+O.width/2<=ba/2?S=ca?5:2:Y+O.width/2<=ba/2&&(S=ca?6:3);return S};a.xrj=function(Q,O,ba,ca,S,Y){Y=void 0===Y?!1:Y;var ma=z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",
!1),Z=z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);if(a.qWd)(O=W.a.itb(ca))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,function(pa){pa&&(ma&&Z&&Y||a.E1c(pa,S,ba,5))});else if(Q)if(ca&&ca.tabs.count){ca=ca.tabs.na(0);var xa=ca.XRa[R.a.id],na=ca.KJ.na(0).ava[R.a.id];Q.IKd(xa)&&(Q=ca.isOfficeTab?Q.aKh(xa,na):Q.ESh(xa))&&(Q.x+Q.width/2>N.a.j3a()&&(Q=new Sys.UI.Bounds(N.a.j3a(),
Q.y+Q.height,0,0)),ma&&Z&&Y||a.C1c(O,Q,a.jse(ba),S,2,0))}else l.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else l.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.ZZf=function(Q,O,ba,ca,S){S=void 0===S?!1:S;a.xrj(Q,O,ca.startedNode?ca.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,ba),ca,ca.startedNode?ca.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,
ba),S)};a.wrj=function(Q,O,ba,ca){if(a.qWd)Q=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,ba,ca,CommonUIStrings.l_InsertionDialogRefresh)),a.E1c(O,Q,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{O=P.a.vn(O);var S=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Y=document.createElement("span");Y.innerText=S[0];var ma=document.createElement("span");ma.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
ba,ca,CommonUIStrings.l_InsertionDialogRefresh);ma.className="UIFontBold";ba=document.createElement("span");ba.innerText=S[1];ca=document.createElement("div");Sys.UI.DomElement.addCssClass(ca,"ModalCalloutControl");ca.appendChild(Y);ca.appendChild(ma);ca.appendChild(ba);a.C1c(Q,O,ca,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.Tsj=function(Q,O){var ba=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,ca=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.qWd?a.E1c(O,ba,ca):
(O=P.a.vn(O),a.C1c(Q,O,a.jse(ca),ba,3,1))};a.jse=function(Q){var O=document.createElement("div");Sys.UI.DomElement.addCssClass(O,"ModalCalloutControl");O.innerText=Q;return O};a.NVe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};tl.Object.defineProperties(a,{nZb:{configurable:!0,enumerable:!0,get:function(){return a.vea||(a.vea=ia.a.instance.Hh("Common.Utils.IAriaNotifier"))}},qWd:{configurable:!0,enumerable:!0,get:function(){return z.AFrameworkApplication.sa.Pa.Li&&
z.AFrameworkApplication.sa.Pa.nH}}});a.KI=null;a.Rjb=null;a.vea=null;Object(y.a)(a,"AddInCommandsNotificationFactory",null,[])},1079:function(y,D,b){function a(t,z,r,G,w){this.ms=t;this.AI=r;this.e1=G;this.Kd=w;this.kgb=this.AI.Gi;this.ly=this.kgb.getOsfControl(z);this.Lng=this.ly.getManifest()}function d(t,z,r,G){this._id=t;this.ms=z;this.e1=r;this.Kd=G}function c(t,z,r,G){this.Mz=!1;this._id=t;this.ms=z;this.e1=r;this.Kd=G}b.r(D);y=b(0);var k=b(13),n=b(1417),l=b(143),f=b(116),u=b(846),v=b(859),
m=b(338);c.prototype.setEnabled=function(){};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};c.prototype.invokePropertyGet=function(t){switch(t){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};
c.prototype.invokePropertySet=function(t,z){switch(t){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(t,z){switch(t){case 5:return this.iij(z);case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};c.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.iij=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setEnabled(t);return null};c.prototype.LBa=function(){this._OnAccess();return null};tl.Object.defineProperties(c.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Mz},set:function(t){var z=b(1079).DynamicRibbon,r=this.Kd.OwnerAddinStoreType,
G=this.Kd.PrimaryMarketplace.MarketplaceRef,w={};w=(w.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),w.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.Kd.OwnerAddinAssetId),w.ownerAddinStoreType=r,w.ribbonControlType="Button",w.toggle=t,w);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:z.Oxc+"ControlUpdate",dataFields:f.a.Fk(w)}));this.Mz=t;t={};r=(t.DynamicAddinCommandsMethodDispatchId=1,t.SolutionId=this.ms,t.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,
G,this.ms),t.SourceControlId=this.id,t.MethodData=this.Mz,t);this.e1.LJ(-1014260128,r)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(y.a)(c,"RibbonButton",null,[]);d.prototype.setVisibility=function(t){var z=b(1079).DynamicRibbon,r=this.Kd.OwnerAddinStoreType,G=this.Kd.PrimaryMarketplace.MarketplaceRef,w={};w=(w.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),w.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,
G,this.Kd.OwnerAddinAssetId),w.ownerAddinStoreType=r,w.ribbonControlType="Tab",w.toggle=t,w);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:z.Oxc+"ControlUpdate",dataFields:f.a.Fk(w)}));z={};t=(z.DynamicAddinCommandsMethodDispatchId=2,z.SolutionId=this.ms,z.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),z.StoreType=r,z.SourceControlId=this.id,z.MethodData=t,z);this.e1.LJ(-1014260128,t)};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};
d.prototype.invokePropertyGet=function(t){switch(t){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};d.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
d.prototype.invokeMethod=function(t,z){switch(t){case 3:return this.bmj(z);case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};d.prototype.bmj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setVisibility(t);return null};d.prototype.LBa=function(){this._OnAccess();return null};
tl.Object.defineProperties(d.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(y.a)(d,"RibbonTab",null,[]);var A=b(1122),x=b(156);b.d(D,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(t){try{var z={},r=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,this.ms),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,
this.Kd.OwnerAddinAssetId),z.ownerAddinStoreType=this.Kd.OwnerAddinStoreType,z.ribbonControlType="Ribbon",z);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Oxc+"ExecuteRequestCreate",dataFields:f.a.Fk(r)}));var G=x.a.li(t);t={};z={};z[u.a.$Ha]=this.ly;z[u.a.aIa]=G;z[u.a.U5c]=this.Kd;t[u.a.wrb]=3;t[u.a.t3]=this.ms;t[u.a.O5b]=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,this.ms);t[u.a.s3]=z;this.e1.LJ(-1014260128,t);var w=a.l9b("ExecuteRequestCreate",
!0,"");k.ULS.sendTraceTag(538572826,0,50,w)}catch(B){G=a.l9b("ExecuteRequestCreate",!1,B.toString()),k.ULS.sendTraceTag(538572825,0,50,G)}return null};a.prototype.executeRequestUpdate=function(t){try{var z=null,r=null;z=this.Kd.OwnerAddinStoreType;r=this.Kd.PrimaryMarketplace.MarketplaceRef;var G={},w=(G.addinAssetId=Telemetry.PrivacyRules.GetAssetId(z,r,this.ms),G.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(z,r,this.Kd.OwnerAddinAssetId),G.ownerAddinStoreType=this.Kd.OwnerAddinStoreType,
G.ribbonControlType="Ribbon",G);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Oxc+"ExecuteRequestUpdate",dataFields:f.a.Fk(w)}));var B=x.a.li(t);t={};G={};G[u.a.$Ha]=this.ly;G[u.a.aIa]=B;G[u.a.U5c]=this.Kd;t[u.a.wrb]=3;t[u.a.t3]=this.ms;t[u.a.O5b]=Telemetry.PrivacyRules.GetAssetId(z,r,this.ms);t[u.a.s3]=G;this.e1.LJ(-1014260128,t);var U=a.l9b("ExecuteRequestUpdate",!0,"");k.ULS.sendTraceTag(538572824,0,50,U)}catch(N){z=a.l9b("ExecuteRequestUpdate",!1,N.toString()),k.ULS.sendTraceTag(538572823,
0,50,z)}return null};a.prototype.getButton=function(t){var z=null;if(!this.R$e())return this.pAe();if(t&&0<t.length){if(!this.Cve(t))return this.IAe(t);z=new c(t,this.ms,this.e1,this.Kd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype.getTab=function(t){var z=null;if(!this.R$e())return this.pAe();if(this.ly.getOwnerAddinControlRecreated())return this.l2g();if(t&&0<t.length){if(!this.Cve(t))return this.IAe(t);z=new d(t,this.ms,this.e1,this.Kd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(t){switch(t){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};a.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};a.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(t){switch(t){case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokeMethodAsync=function(t,z){switch(t){case 7:return this.Zrh(z);case 6:return this.$rh(z);case 3:return this.aEh(z);case 5:return this.DSh(z)}t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};
a.prototype.Zrh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestCreate(t)};a.prototype.$rh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestUpdate(t)};a.prototype.aEh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getButton(t)};a.prototype.DSh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");
return this.getTab(t)};a.prototype.LBa=function(){this._OnAccess();return null};a.prototype.IAe=function(t){return A.a(v.a.PYg,x.a.ea(1714)+t)};a.prototype.pAe=function(){return A.a(v.a.oaj,x.a.ea(1710))};a.prototype.l2g=function(){return A.a(v.a.hostRestartNeeded,x.a.ea(1715))};a.prototype.R$e=function(){var t=this.ly.getSharedRuntimeId();t=!!t&&0<t.length;k.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",t));return t};a.prototype.Cve=function(t){var z=
this.Lng.getRibbonExtensionControlMap();return t in z||this.pSg(t)};a.prototype.pSg=function(t){var z=this.Jvh();if(z){z=yl(z.hHe.tabs);for(var r=z.next();!r.done;r=z.next()){r=r.value;if(r.id===t)return!0;r=yl(r.groups);for(var G=r.next();!G.done;G=r.next()){G=yl(G.value.controls);for(var w=G.next();!w.done;w=G.next()){w=w.value;if(w.id===t)return!0;if("Menu"===w.type){w=yl(w.items);for(var B=w.next();!B.done;B=w.next())if(B.value.id===t)return!0}}}}}return!1};a.prototype.Jvh=function(){return n.a.getInstance().K3(this.Kd.PrimaryMarketplace.MarketplaceType,
this.Kd.PrimaryMarketplace.SolutionId,1)};a.l9b=function(t,z,r){var G={};G.methodName="DynamicRibbon."+t;G.result=z?"Succeeded":"Failed";G.message=r;return x.a.Hc(G)};tl.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.Oxc="Office.Online.Extensibility.Ribbon.";Object(y.a)(a,"DynamicRibbon",null,[])},1100:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.r7b="extId";a.wye="ComponentType";a.GGa="ComponentId";a.hid="HostProps";
a.iya="OptionalProps";Object(y.a)(a,"ActionPropertyNames",null,[])},1119:function(y,D,b){function a(d,c){var k=!1;d&&(d=c.osfControl,(c=d.getManifest())&&c.getSharedRuntimeForCustomFunctions("Workbook")&&!d.getIsUpgrading()&&(k=!0));return k}b.d(D,"a",function(){return a})},1121:function(y,D,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.Iga=this.mSa=this.ddd=this.wfd=this.Uub=this.ySd=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"AppsForOfficeOauthResult",null,
[])},1122:function(y,D,b){function a(d,c){return OfficeExtension.WacRuntime.Utility.createPromise(function(k,n){n(OfficeExtension.WacRuntime.Utility.createRichApiException(d,c))})}b.d(D,"a",function(){return a})},1237:function(y,D,b){function a(da,za,hb){this.$va=!1;this.zE={};this.$=da;this.sh=za;this.hkd().tma();this.indexedDB=hb;this.indexedDB.og()&&(this.$va=!0,this.indexedDB.initialize(a.kjd,a.ljd))}function d(da,za){this.OOc=da;this._message=za}function c(){}function k(){}function n(da){switch(da){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(da,za){x(b(1237).CustomFunctionsInstaller.QXe("CustomFunctionsRuntimeLogging"),function(hb){if(hb.result&&window.console)switch(hb=n(da.severity)+" "+da.message+za,da.severity){case 2:window.console.log&&window.console.log(hb);break;case 0:window.console.info&&window.console.info(hb);break;case 1:window.console.error&&window.console.error(hb)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}
function f(da,za,hb,Gb,Sb){hb=da.CWCT(function(){za(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163459,0,10,Sb)},4);return hb}function u(da,za,hb){return f(da,za,ma.a.none,Z.a.current,hb)}function v(da,za,hb,Gb,Sb){hb=da.CWRCT(function(){return za(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163460,0,10,Sb)},4);return ba.TaskExtensions.mzc(hb)}function m(da,za,hb){return v(da,za,ma.a.none,Z.a.current,hb)}function A(da,za,hb,Gb,Sb){hb=da.CWRCT(function(){return za(da)},
hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163461,0,10,Sb)},4);return hb}function x(da,za,hb){return A(da,za,ma.a.none,Z.a.current,hb)}function t(da,za,hb,Gb,Sb){hb=da.CWRCT(function(){return za(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163462,0,10,Sb)},4);return ba.TaskExtensions.mzc(hb)}function z(da,za,hb){return t(da,za,ma.a.none,Z.a.current,hb)}function r(da,za,hb,Gb,Sb){hb=da.CWCT(function(){za(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163463,
0,10,Sb)},4);return hb}function G(da,za,hb){return r(da,za,ma.a.none,Z.a.current,hb)}function w(){}function B(da){da=da.split("|");this.ms=da[1];this.tPc=da[2];this.nRd=da[3]}b.r(D);y=b(0);var U=b(13),N=b(5),P=b(139),ia=b(185),W=b(84),R=b(519),I=b(163),Q=b(81),O=b(56),ba=b(35),ca=b(222),S=b(126),Y=b(554);tl.Object.defineProperties(B.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.tPc}},needToRestoreManifest:{configurable:!0,
enumerable:!0,get:function(){return this.nRd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(B,"AddinStoreInfo",null,[]);Object(y.a)(w,"CustomFunctionRegistrationInfos",null,[]);var ma=b(200),Z=b(60),xa=b(1119);Object(y.a)(k,"InstallationInfo",null,[]);Object(y.a)(c,"UninstallationInfo",null,[]);var na=b(26),pa=b(92),Ia=b(32),Ma=b(27),lb=b(1),zb=b(19),Ya=b(273),Wb=b(913),Zb=b(55);tl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.OOc}},
message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(y.a)(d,"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsInstaller",function(){return a});a.prototype.C8e=function(da,za,hb,Gb){var Sb=this;if(Gb.invariantNamespace)for(var Fb=0;Fb<Gb.invariantNamespace.length;++Fb){var wa=Gb.invariantNamespace.charAt(Fb);if("."!==wa&&"_"!==wa&&"a">wa&&"z"<wa&&"A">wa&&"Z"<wa&&"0">wa&&"9"<wa)throw U.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
wa,Fb),Error.create("InvariantNamespace validation failed");}return z(this.GOg(hb,Gb.manifest),function(){return z(Sb.nEd(da),function(va){var sa=va.result;return(null===sa||void 0===sa?0:sa.isDynamicMetadata)?Sb.sFd(da,za,sa,!1,!1,!1):z(Sb.XPj(da,za,Gb),function(sb){var Tb;sa=(Tb=new k,Tb.addinId=hb,Tb.locale=Gb.locale,Tb.addinInvariantNamespace=Gb.invariantNamespace,Tb.addinNamespace=Gb.namespace,Tb.addinTitle=Gb.title,Tb.isXllCompatible=Gb.isXllCompatible,Tb.metadataContent=JSON.stringify(JSON.parse(sb.result)),
Tb);return Sb.sFd(da,za,sa,!1,a.ath(Gb.osfControl.getStoreType()),xa.a(Sb.$,Gb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.E8e=function(da,za,hb,Gb){var Sb=this;if(!a.jpd(hb))throw U.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Error.create("Invalid Metadata JSON");return z(this.nEd(da),function(Fb){Fb=Fb.result;if(!Fb&&(Fb=Ia.a.Ec(Sb.dV,da),!Fb))throw U.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(za,null,da))),Error.create("Customfunctions dynamic registration failed");Fb.metadataContent=JSON.stringify(JSON.parse(hb));Fb.isDynamicMetadata=!0;return Sb.sFd(da,
za,Fb,!0,!0,Gb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.l8f=function(da,za){var hb=this;this.sh.cia();var Gb=Object.assign(new c,{solutionId:da}),Sb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(za,null,da));return z(this.cGd(da),function(){return z(hb.jGd(da),function(){return hb.PUd(hb.sh,da,za,Gb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},
Sb)};a.prototype.XPj=function(da,za,hb){var Gb=new P.a;OSF.OUtil.xhrGet(hb.metadataUrl,function(Sb){Sb?Gb.setResult(Sb):Gb.setException(Error.create("Invalid manifest"))},function(Sb){U.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(za,null,da),Sb);Gb.setException(Error.create("Failed to download manifest"))});return Gb.task};a.prototype.hkd=function(){var da=
this;return z(this.vpc(),function(za){var hb=za.result;if(!hb.length)return Zb.Task.Ta(!0);U.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");za=new ia.a;for(var Gb=[],Sb={},Fb=0;Fb<hb.length;Sb={dOb:Sb.dOb},Fb++)Sb.dOb=Object(W.a)(String,hb[Fb]),za.add(x(da.nEd(Sb.dOb),function(wa){return function(va){if(va=va.result){var sa=Ia.a.Ec(da.zE,va.addinId);sa&&sa===va.metadataContent||(da.zE[va.addinId]=va.metadataContent,
da.dV[wa.dOb]=va,Array.add(Gb,va))}return!0}}(Sb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return m(Zb.Task.WAE(za),function(){if(Gb.length){var wa,va=(wa=new w,wa.registrationInfos=Gb,wa);return da.PZb(da.sh,hb,va)}U.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Zb.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.F8e=function(){var da=this,za=new P.a;new ia.a;var hb=[],Gb=[];Object.keys(this.dV).forEach(function(Sb){Sb=Object(W.a)(String,Sb);var Fb=Ia.a.Ec(da.dV,Sb);Array.add(hb,Fb);Array.add(Gb,Sb)});if(!Gb.length)return za.setResult(!0),za.task;za=Object.assign(new w,{registrationInfos:hb});return this.PZb(this.sh,Gb,za)};a.prototype.vpc=function(){return x(this.xdd(Y.a.QXa),function(da){da=da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(da||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.Mcg=function(da){return this.qMd(Y.a.QXa,Sys.Serialization.JavaScriptSerializer.serialize(da))};a.prototype.nEd=function(da){return z(this.xdd(Y.a.N2a(da)),function(za){za=za.result||"";return 0<za.length?Zb.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(za,!0)):Zb.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.QPj=function(da,za){var hb=this;return z(this.OIe(da),function(){return z(hb.qMd(Y.a.N2a(da),Sys.Serialization.JavaScriptSerializer.serialize(za)),function(){return a.rMd(Y.a.ahd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.cGd=function(da){var za=this;return z(this.aLf(da),function(){return z(za.sLf(Y.a.N2a(da)),
function(){return z(za.vpc(),function(hb){return hb.result.length?Zb.Task.Ta(!0):a.rMd(Y.a.ahd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.HIf=function(da){return this.xdd(Y.a.M2a(da))};a.prototype.Jcg=
function(da,za){var hb=this;return z(this.OIe(da),function(){return hb.qMd(Y.a.M2a(da),za)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.jGd=function(da){var za=this;return z(this.aLf(da),function(){return za.sLf(Y.a.M2a(da))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.OIe=function(da){var za=this;return z(this.vpc(),function(hb){hb=hb.result;var Gb=da.toLowerCase();
if(Array.contains(hb,Gb))return Zb.Task.Ta(!0);hb.push(Gb);return za.Mcg(hb)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.aLf=function(da){var za=this;return z(this.vpc(),function(hb){hb=hb.result;var Gb=da.toLowerCase();return Array.contains(hb,Gb)?(hb.splice(Array.indexOf(hb,Gb),1),za.Mcg(hb)):Zb.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.GOg=function(da,za){if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return da=new OSF.AddinIdInfo(da),da.needToRestoreManifest()?this.Jcg(da.getSolutionId(),za):Zb.Task.Ta(!0);da=new B(da);return da.needToRestoreManifest?this.Jcg(da.solutionId,za):Zb.Task.Ta(!0)};a.prototype.N$i=function(da){var za=this;if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var hb=new OSF.AddinIdInfo(da);return hb.needToRestoreManifest()?
x(this.HIf(hb.getSolutionId()),function(Sb){(Sb=Sb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(hb.getSolutionId(),hb.getSolutionVersion(),Sb,za.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Zb.Task.Ta(!0)}var Gb=new B(da);return Gb.needToRestoreManifest?x(this.HIf(Gb.solutionId),function(Sb){(Sb=Sb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Gb.solutionId,Gb.solutionVersion,Sb,za.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Zb.Task.Ta(!0)};a.prototype.sLf=function(da){return this.$va?this.indexedDB.D4c(da):a.X2i(da)};a.prototype.qMd=function(da,za){return this.$va?this.indexedDB.Sab(new Wb.a(da,za)):a.rMd(da,za)};a.prototype.xdd=function(da){return this.$va?this.indexedDB.CJa(da):a.QXe(da)};a.prototype.sFd=function(da,za,hb,Gb,Sb,Fb){var wa=this,va=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetAssetId(za,null,da));return ba.TaskExtensions.mzc(x(this.tFd(this.sh,da,za,hb,!1,Gb,Fb),function(){return Sb?wa.QPj(da,hb):Zb.Task.Ta(!0)},va))};a.prototype.tFd=function(da,za,hb,Gb,Sb,Fb,wa){var va=this;if(!Fb&&(Fb=Ia.a.Ec(this.zE,Gb.addinId))&&Fb===Gb.metadataContent)return Zb.Task.Ta(!0);this.zE[Gb.addinId]=Gb.metadataContent;this.dV[za]=Gb;wa||da.QFb(za);da.cia();return z(this.D0i(za,hb,Gb),function(){return va.aDd(Gb.addinId,Sb)},"Failed to register functions for customfunction addin")};
a.prototype.D0i=function(da,za,hb){var Gb=this,Sb=new P.a,Fb=this.bob(hb);return this.kia(function(wa){lb.EwaSettings.la(257)&&l(a.Bqb,da);(wa=wa.Result)&&204===wa.ResponseStatusCode?Sb.setResult(!0):(delete Gb.zE[hb.addinId],delete Gb.dV[da],G(Gb.cGd(da),function(){G(Gb.jGd(da),function(){Gb.j_f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",da,wa?wa.ResponseStatusCode.toString():
"Unknown")),Sb.setResult(!1))},function(wa){wa=S.a.yg(wa.data);U.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(za,null,da),Ma.a.Uc(wa));lb.EwaSettings.la(257)&&l(a.Aqb,da);delete Gb.zE[hb.addinId];delete Gb.dV[da];Sb.setResult(!1)},Fb,Sb,!0)};a.prototype.PZb=function(da,za,hb){var Gb=this,Sb=new P.a,Fb=na.a.Ra.se.m;za.forEach(function(va){va=Object(W.a)(String,
va);da.gve(va)});da.cia();var wa=this.WWc(hb);return this.kia(function(va){lb.EwaSettings.la(257)&&l(a.Bqb,Sys.Serialization.JavaScriptSerializer.serialize(za));va=va.Result;var sa=!0,sb=Sys.Serialization.JavaScriptSerializer.deserialize(va.ResponseBody.toString());sb=Array.isArray(sb.value)?sb.value:null;for(var Tb=new ia.a,Da={mea:0};Da.mea<sb.length;Da={mea:Da.mea},Da.mea++)if(!sb[Da.mea]){sa=!1;var Sa=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
va.ResponseStatusCode);Tb.add(z(Gb.cGd(za[Da.mea]),function(Ra){return function(){delete Gb.zE[hb.registrationInfos[Ra.mea].addinId];delete Gb.dV[za[Ra.mea]];return Gb.jGd(za[Ra.mea])}}(Da),Sa))}u(Zb.Task.WAE(Tb),function(){G(Gb.aDd("",!1),function(){U.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",na.a.Ra.se.m-Fb);sa?Sb.setResult(sa):u(Gb.j_f(),function(){Sb.setResult(sa)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(va){va=S.a.yg(va.data);U.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Ma.a.Uc(va));lb.EwaSettings.la(257)&&l(a.Aqb,Sys.Serialization.JavaScriptSerializer.serialize(za));
for(va=0;va<hb.registrationInfos.length;va++)delete Gb.zE[hb.registrationInfos[va].addinId],delete Gb.dV[za[va]];Sb.setResult(!1)},wa,Sb,!0)};a.prototype.PUd=function(da,za,hb,Gb){var Sb=this;return z(this.iHj(da,za,hb,Gb),function(){return Sb.aDd(Gb.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.iHj=function(da,za,hb,Gb){var Sb=new P.a;da.QFb(za);(da=Ia.a.Ec(this.dV,za))&&delete this.zE[da.addinId];delete this.dV[za];Gb=this.gXc(Gb);return this.kia(function(){lb.EwaSettings.la(257)&&
l(a.B3c,za);Sb.setResult(!0)},function(Fb){Fb=S.a.yg(Fb.data);U.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(hb,hb,za),Ma.a.Uc(Fb));lb.EwaSettings.la(257)&&l(a.A3c,za);Sb.setResult(!1)},Gb,Sb,!1)};a.prototype.kia=function(da,za,hb,Gb,Sb){function Fb(){function Da(Lb,Ja,wb){lb.EwaSettings.la(257)&&l(Sb?a.z3c:a.C3c,Sa.RequestBody);return Q.i(va.ta,"ExecuteRichApiRequest",
hb,Ya.b(Lb,da),Ya.a(Ja,za),wb,null,0)}if(wa.MGa()||0<va.ta.G3||0<va.Ek.G3)return!1;sa&&wa.pz(sa);sb&&va.Lt(sb);Tb&&va.VC(Tb);var Sa=hb.request,Ra=0;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Sa.RequestFlags&1&&256!==(Sa.RequestFlags&256)||(Ra=16):Ra=Sa.RequestFlags&1?0:16;lb.EwaSettings.tc()?wa.tt(new I.a(507,0,Da,Ra|64)):wa.tt(new R.a(507,0,Da,Ra));return!0}var wa=this.$.userOperationManager,va=this.$.qa,sa=null,sb=null,Tb=null;Fb()||(sa=function(){Fb()},
sb=function(){Fb()},Tb=function(){Fb()},wa.uy(sa),va.us(sb),va.FB(Tb));return Gb.task};a.prototype.bob=function(da){var za={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};za.RequestBody=JSON.stringify(da);za.RequestFlags=1;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(za.RequestFlags|=256);da=this.$.qa.ta.Oa(1);da.request=za;return da};a.prototype.WWc=function(da){var za={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};za.RequestBody=JSON.stringify(da);za.RequestFlags=1;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(za.RequestFlags|=256);da=this.$.qa.ta.Oa(1);da.request=za;return da};a.prototype.gXc=function(da){var za={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};za.RequestBody=JSON.stringify(da);za.RequestFlags=1;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(za.RequestFlags|=
256);da=this.$.qa.ta.Oa(1);da.request=za;return da};a.prototype.aDd=function(da,za){var hb=this,Gb=O.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);return t(Gb,function(){Gb.result.lId();return da&&za?hb.N$i(da):Zb.Task.Ta(!0)},this.$.ma,ca.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.j_f=function(){var da=new pa.a(1949669462,0,this.$.ed,0,null);return this.$.Ka.Zb(da)};a.QXe=function(da){try{return Zb.Task.Ta(localStorage.getItem(da))}catch(za){return U.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",za.message||"Unknown"),Zb.Task.Ta(null)}};a.rMd=function(da,za){try{return localStorage.setItem(da,za),Zb.Task.Ta(!0)}catch(hb){return U.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",hb.message||"Unknown"),Zb.Task.Ta(!1)}};a.X2i=function(da){try{return localStorage.removeItem(da),Zb.Task.Ta(!0)}catch(za){return U.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",za.message||"Unknown"),Zb.Task.Ta(!1)}};a.ath=function(da){return zb.a.equals(da,"registry",!0)||zb.a.equals(da,"uploadfiledevcatalog",!0)||N.AFrameworkApplication.userNameUnknown||N.AFrameworkApplication.limitedEdit};a.jpd=function(da){if(!da)return!1;try{JSON.parse(da)}catch(za){return!1}return!0};tl.Object.defineProperties(a.prototype,{dV:{configurable:!0,enumerable:!0,get:function(){return this.sh.dV}}});
a.kjd="CustomFunctionCache";a.ljd="CustomFunction";a.z3c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Bqb=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Aqb=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.C3c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.B3c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.A3c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,
"CustomFunctionsInstaller",null,[234])},1239:function(y,D,b){function a(ca){this.zE={};this.$=ca;this.hkd().tma()}function d(ca,S){this.OOc=ca;this._message=S}function c(){}function k(){}function n(ca){switch(ca){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(ca,S){if(b(1239).CustomFunctionsLegacyInstaller.mub("CustomFunctionsRuntimeLogging")&&window.console)switch(S=n(ca.severity)+" "+ca.message+S,ca.severity){case 2:window.console.log&&window.console.log(S);
break;case 0:window.console.info&&window.console.info(S);break;case 1:window.console.error&&window.console.error(S)}}function f(){}function u(ca){ca=ca.split("|");this.ms=ca[1];this.tPc=ca[2];this.nRd=ca[3]}b.r(D);y=b(0);var v=b(13),m=b(1070),A=b(139),x=b(84),t=b(519),z=b(163),r=b(81),G=b(56),w=b(35),B=b(126),U=b(554),N=b(1119);tl.Object.defineProperties(u.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.tPc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.nRd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(u,"AddinStoreInfo",null,[]);Object(y.a)(f,"CustomFunctionRegistrationInfos",null,[]);Object(y.a)(k,"InstallationInfo",null,[]);Object(y.a)(c,"UninstallationInfo",null,[]);var P=b(147),ia=b(32),W=b(27),R=b(1),I=b(14),Q=b(273),O=b(1014),ba=b(55);tl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.OOc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(y.a)(d,"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.C8e=function(ca,S,Y,ma){var Z=this,xa=new A.a;if(ma.invariantNamespace)for(S=0;S<ma.invariantNamespace.length;++S){var na=ma.invariantNamespace.charAt(S);if("."!==na&&"_"!==na&&"a">na&&"z"<na&&"A">na&&"Z"<na&&"0">na&&"9"<na)return v.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
na,S),xa.setResult(!1),xa.task}a.cacheManifest(Y,ma.manifest);var pa=a.oEd(ca);(null===pa||void 0===pa?0:pa.isDynamicMetadata)?this.rFd(ca,pa,xa,!1,!1):OSF.OUtil.xhrGet(ma.metadataUrl,function(Ia){pa=Object.assign(new k,{addinId:Y,locale:ma.locale,addinInvariantNamespace:ma.invariantNamespace,addinNamespace:ma.namespace,addinTitle:ma.title,isXllCompatible:ma.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Ia))});Z.rFd(ca,pa,xa,!1,N.a(Z.$,ma))},function(Ia){v.ULS.sendTraceTag(537163528,0,
10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",ca,Ia);xa.setResult(!1)});return xa.task};a.prototype.E8e=function(ca,S,Y,ma){S=new A.a;if(!a.jpd(Y))return v.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),S.setResult(!1),S.task;var Z=a.oEd(ca);if(!Z)return v.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
S.setResult(!1),S.task;Z.metadataContent=JSON.stringify(JSON.parse(Y));Z.isDynamicMetadata=!0;this.rFd(ca,Z,S,!0,ma);return S.task};a.prototype.l8f=function(ca){var S=this,Y=new A.a,ma=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(ma,function(){var Z=ma.result;Z.cia();var xa=Object.assign(new c,{solutionId:ca});a.dGd(ca);a.kGd(ca);w.TaskExtensions.Ba(S.PUd(Z,ca,xa),function(na){P.b(na)?Y.setResult(na.result):(na.jg?v.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
ca):na.Ch&&v.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",ca),Y.setResult(!1))},S.$.ma,0)},this.$.ma,3);return Y.task};a.prototype.hkd=function(){var ca=this,S=new A.a,Y=a.sEd();0<Y.length&&v.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ma=[];Y.forEach(function(xa){xa=Object(x.a)(String,xa);if(xa=a.oEd(xa)){var na=
ia.a.Ec(ca.zE,xa.addinId);na&&na===xa.metadataContent||(ca.zE[xa.addinId]=xa.metadataContent,Array.add(ma,xa))}});if(!ma.length)return S.setResult(!0),v.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),S.task;var Z=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(Z,function(){var xa=Z.result,na=Object.assign(new f,{registrationInfos:ma});w.TaskExtensions.Ba(ca.PZb(xa,Y,na),function(pa){P.b(pa)?
S.setResult(pa.result):(pa.jg?v.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):pa.Ch&&v.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),S.setResult(!1))},ca.$.ma,0)},this.$.ma,3);return S.task};a.prototype.M$i=function(ca){ca=new u(ca);if(ca.needToRestoreManifest){var S=a.aZi(ca.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(ca.solutionId,
ca.solutionVersion,S,this.$.ya.UICultureTag)}};a.prototype.rFd=function(ca,S,Y,ma,Z){var xa=this,na=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(na,function(){w.TaskExtensions.Ba(xa.tFd(na.result,ca,S,!1,ma,Z),function(pa){P.b(pa)?((pa=pa.result)&&a.RPj(ca,S),Y.setResult(pa)):(pa.jg?v.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",ca):pa.Ch&&v.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
ca),Y.setResult(!1))},xa.$.ma,0)},this.$.ma,3)};a.prototype.tFd=function(ca,S,Y,ma,Z,xa){var na=this;if(!Z&&(Z=ia.a.Ec(this.zE,Y.addinId))&&Z===Y.metadataContent)return ba.Task.Ta(!0);this.zE[Y.addinId]=Y.metadataContent;var pa=new A.a;xa||ca.QFb(S);ca.cia();ca=this.bob(Y);return this.kia(function(Ia){R.EwaSettings.la(257)&&l(a.Bqb,S);var Ma=Ia.Result;204===Ma.ResponseStatusCode?w.TaskExtensions.Ba(na.$Cd(pa,Y.addinId,ma),function(lb){lb.jg?S?v.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",
S):v.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",Y.addinId):lb.Ch&&(S?v.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",S):v.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",Y.addinId));
pa.setResult(!1)},na.$.ma,4):(Ia=function(){delete na.zE[Y.addinId];a.dGd(S);a.kGd(S);v.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",S,Ma.ResponseStatusCode);pa.setResult(!1)},Ia=Object.assign(new O.a,{OKa:OSF.InfoType.Error,title:Y.addinTitle,description:String.format(I.a.instance.Cb(152),I.a.instance.ea(1833)),buttonText:I.a.instance.ea(4),Wga:Ia,ucc:!1,Tha:Ia,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
m.a.SOd(Ia))},function(Ia){Ia=B.a.yg(Ia.data);v.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",S,W.a.Uc(Ia));R.EwaSettings.la(257)&&l(a.Aqb,S);delete na.zE[Y.addinId];pa.setResult(!1)},ca,pa,!0)};a.prototype.PZb=function(ca,S,Y){var ma=this,Z=new A.a;S.forEach(function(na){na=Object(x.a)(String,na);ca.gve(na)});ca.cia();var xa=this.WWc(Y);return this.kia(function(na){R.EwaSettings.la(257)&&
l(a.Bqb,Sys.Serialization.JavaScriptSerializer.serialize(S));na=na.Result;var pa=!0,Ia=Sys.Serialization.JavaScriptSerializer.deserialize(na.ResponseBody.toString());Ia=Array.isArray(Ia.value)?Ia.value:null;for(var Ma=0;Ma<Ia.length;Ma++)Ia[Ma]||(pa=!1,delete ma.zE[Y.registrationInfos[Ma].addinId],a.dGd(S[Ma]),a.kGd(S[Ma]),v.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",S[Ma],na.ResponseStatusCode));
w.TaskExtensions.Ba(ma.$Cd(Z,"",!1),function(lb){lb.jg?v.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):lb.Ch&&v.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Z.setResult(!1)},ma.$.ma,4);Z.setResult(pa)},function(na){na=B.a.yg(na.data);v.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(S),W.a.Uc(na));R.EwaSettings.la(257)&&l(a.Aqb,Sys.Serialization.JavaScriptSerializer.serialize(S));na=yl(Y.registrationInfos);for(var pa=na.next();!pa.done;pa=na.next())delete ma.zE[pa.value.addinId];Z.setResult(!1)},xa,Z,!0)};a.prototype.PUd=function(ca,S,Y){var ma=this,Z=new A.a;ca.QFb(S);ca=this.gXc(Y);return this.kia(function(){R.EwaSettings.la(257)&&l(a.B3c,S);w.TaskExtensions.Ba(ma.$Cd(Z,Y.solutionId,!1),function(xa){xa.jg?S&&v.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",S):xa.Ch&&S&&v.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",S);Z.setResult(!1)},ma.$.ma,4)},function(xa){xa=B.a.yg(xa.data);v.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
S,W.a.Uc(xa));R.EwaSettings.la(257)&&l(a.A3c,S);Z.setResult(!1)},ca,Z,!1)};a.prototype.kia=function(ca,S,Y,ma,Z){function xa(){function zb(Zb,da,za){R.EwaSettings.la(257)&&l(Z?a.z3c:a.C3c,Ya.RequestBody);return r.i(pa.ta,"ExecuteRichApiRequest",Y,Q.b(Zb,ca),Q.a(da,S),za,null,0)}if(na.MGa()||0<pa.ta.G3||0<pa.Ek.G3)return!1;Ia&&na.pz(Ia);Ma&&pa.Lt(Ma);lb&&pa.VC(lb);var Ya=Y.request,Wb=Ya.RequestFlags&1?0:16;R.EwaSettings.tc()?na.tt(new z.a(507,0,zb,Wb|64)):na.tt(new t.a(507,0,zb,Wb));return!0}var na=
this.$.userOperationManager,pa=this.$.qa,Ia=null,Ma=null,lb=null;xa()||(Ia=function(){xa()},Ma=function(){xa()},lb=function(){xa()},na.uy(Ia),pa.us(Ma),pa.FB(lb));return ma.task};a.prototype.bob=function(ca){var S={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.WWc=function(ca){var S={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.gXc=function(ca){var S={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.$Cd=function(ca,S,Y){var ma=this,Z=G.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);w.TaskExtensions.Ba(Z,function(){Z.result.lId();S&&Y&&ma.M$i(S);ca.setResult(!0)},this.$.ma,
3);return Z};a.prototype.F8e=function(){return ba.Task.Ta(!0)};a.sEd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.mub(U.a.QXa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.mub(U.a.QXa)||"[]"):null)||[]};a.Ncg=function(ca){a.sMd(U.a.QXa,Sys.Serialization.JavaScriptSerializer.serialize(ca))};a.oEd=function(ca){ca=a.mub(U.a.N2a(ca))||"";return 0<ca.length?Sys.Serialization.JavaScriptSerializer.deserialize(ca,!0):null};a.RPj=function(ca,S){a.NIe(ca);
a.sMd(U.a.N2a(ca),Sys.Serialization.JavaScriptSerializer.serialize(S))};a.dGd=function(ca){a.$Kf(ca);a.tLf(U.a.N2a(ca))};a.aZi=function(ca){return a.mub(U.a.M2a(ca))};a.SPj=function(ca,S){a.NIe(ca);a.sMd(U.a.M2a(ca),S)};a.kGd=function(ca){a.$Kf(ca);a.tLf(U.a.M2a(ca))};a.NIe=function(ca){var S=a.sEd();ca=ca.toLowerCase();Array.contains(S,ca)||(S.push(ca),a.Ncg(S))};a.$Kf=function(ca){var S=a.sEd();ca=ca.toLowerCase();Array.contains(S,ca)&&(S.splice(Array.indexOf(S,ca),1),a.Ncg(S))};a.cacheManifest=
function(ca,S){ca=new u(ca);ca.needToRestoreManifest&&a.SPj(ca.solutionId,S)};a.mub=function(ca){try{return localStorage.getItem(ca)}catch(S){return v.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",S.message||"Unknown"),null}};a.sMd=function(ca,S){try{localStorage.setItem(ca,S)}catch(Y){v.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
Y.message||"Unknown")}};a.tLf=function(ca){try{localStorage.removeItem(ca)}catch(S){v.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",S.message||"Unknown")}};a.jpd=function(ca){if(!ca)return!1;try{JSON.parse(ca)}catch(S){return!1}return!0};a.z3c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Bqb=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Aqb=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
a.C3c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.B3c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.A3c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,"CustomFunctionsLegacyInstaller",null,[234])},1250:function(y,D,b){function a(W,R,I,Q,O){this.Ma=null;this.TTc="AddinActivated";this.$=W;this.Ve=R;this.ownerAddinInfo=I;this.ee=void 0===O?null:O;this.UPa=(void 0===Q?null:Q)||P.Task.Ta(!0);this.Ma=new m.a;return this}
function d(W){var R=N.call(this)||this;R.uCa="AddInCommandsDialog";R.Me=R.uCa;R.kc=5;R.dialogWidth=695;R.dialogHeight=438;R.jYg="100%";R.gYg="408px";R.hYg="15px";R.iYg="0";R.Bog=W;return R}function c(W,R,I,Q,O,ba){var ca=W.Oa(9);ca.sharedInfo=R;return x.i(W,"InsertAgaveTaskpane",ca,I,Q,O,ba,0)}function k(){}y=b(0);var n=b(200),l=b(13),f=b(5);Object(y.a)(k,"AddinCommandsHost",null,[]);var u=b(1292),v=b(1369),m=b(36),A=b(950),x=b(81),t=b(519),z=b(368),r=b(163),G=b(35),w=b(1),B=b(273),U=b(140),N=U.a;
vm(d,N);d.prototype.KC=function(){N.prototype.KC.call(this);this.fp.style.width=this.jYg;this.fp.style.height=this.gYg;this.fp.style.marginTop=this.hYg;this.fp.style.padding=this.iYg};d.prototype.WN=function(){N.prototype.WN.call(this);this.Lb.style.width=String.format("{0}px",this.dialogWidth);this.Lb.style.height=String.format("{0}px",this.dialogHeight)};d.prototype.dispose=function(){N.prototype.dispose.call(this);this.Bog()};tl.Object.defineProperties(d.prototype,{containerDiv:{configurable:!0,
enumerable:!0,get:function(){return this.fp}}});Object(y.a)(d,"AddInCommandsDialog",U.a,[]);var P=b(55),ia=b(60);U=b(101);b.d(D,"a",function(){return a});vm(a,k);a.prototype.Yyg=function(W){this.Ma.addHandler(this.TTc,W)};a.prototype.ZOa=function(){f.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&(l.ULS.sendTraceTag(0,220,50,"survey addin {0} is used.",Telemetry.PrivacyRules.GetAssetId(this.ownerAddinInfo.storeType,this.ownerAddinInfo.storeId,
this.ownerAddinInfo.solutionId)),this.Ma.raiseEvent(this.TTc,this.ownerAddinInfo.solutionId))};a.prototype.cYg=function(){var W=this.UPa;this.UPa=P.Task.Ta(!0);return W};a.prototype.disposeHost=function(W){this.Ve.xPa(W)};a.prototype.setOwnerAddinEToken=function(W){this.ownerAddinInfo.eToken=W};a.prototype.showTaskpane=function(W,R,I){var Q=this;l.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var O=null,ba=!1,ca=(new u.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,
new A.a,!0)).$Ce(W.solutionId.substr(this.ownerAddinInfo.solutionId.length));O=R.getSharedRuntimeForTaskpane("Workbook",ca);ba=!!O&&1===O.LifeTime;this.Ve.jve(ba?this.ownerAddinInfo.solutionId:W.solutionId,ba?O:null,null)?this.ZOa():(this.ljf(ba,!0),this.UPa=this.fkd(W,O,function(S,Y){S?(ba&&(S.PrimaryMarketplace.SolutionId=Q.ownerAddinInfo.solutionId,S.SharedRuntime=O),S.WebExtensionOsfControlType=3,Q.Ve.z_a(S),I(S.InstanceId,Y),Q.ZOa(),Q.ljf(ba,!1)):(l.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),
I(null,Y),Q.ZOa())}))};a.prototype.getSettings=function(W,R){var I=this.Ve.T$(W.solutionId);I?R(this.Ve.XY(I).OsfPropertyBag):this.UPa=this.fkd(W,null,function(Q){Q?R(Q.OsfPropertyBag):l.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(W,R,I){function Q(Y,ma,Z){return c(ca,S,B.b(Y,O),ma,Z,null)}function O(Y){var ma=Y.Result,Z=ma?ma.AgaveData:null;Z?(ba.Ve.YBe(Z,function(){var xa=new d(function(){ba.disposeHost(Z.InstanceId)});xa.initializeAndShow("",
null,null);ba.ZOa();return xa.containerDiv}),I(Z.InstanceId,0),ba.ZOa()):(l.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),I(null,Y.Errors?Y.Errors[0].ErrorCause:5001))}var ba=this;l.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var ca=this.$.qa.ta,S=a.lqb(W,this.ownerAddinInfo);w.EwaSettings.tc()?this.UPa=z.a(this.$.userOperationManager,Q,function(Y){return new r.a(500,0,Y,64)},this.ee):this.UPa=z.a(this.$.userOperationManager,Q,function(Y){return new t.a(500,
0,Y)},this.ee)};a.prototype.createUILessSandbox=function(W,R,I){var Q=this;l.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var O=R.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),ba=!!O&&1===O.LifeTime;(R=this.Ve.Nvh(ba?this.ownerAddinInfo.solutionId:W.solutionId,ba?O:null))?(I(R,0),this.ZOa()):this.UPa=this.fkd(W,O,function(ca,S){ca?(ba?(ca.PrimaryMarketplace.SolutionId=Q.ownerAddinInfo.solutionId,ca.SharedRuntime=O,ca.TaskpaneVisible=!1,ca.WebExtensionOsfControlType=3,Q.Ve.z_a(ca)):
(ca.WebExtensionOsfControlType=4,Q.Ve.YBe(ca,function(){a.Idb.ia(ca.InstanceId,new v.a);return a.Idb.na(ca.InstanceId).k0a})),I(ca.InstanceId,S),Q.ZOa()):(l.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),I(null,S))})};a.prototype.fkd=function(W,R,I){function Q(na,pa,Ia){return c(S,Y,B.b(na,O),pa,Ia,null)}function O(na){var pa=na.Result;(ca=pa?pa.AgaveData:null)||I(null,na.Errors?na.Errors[0].ErrorCause:5001)}var ba=this,ca=null,S=this.$.qa.ta,Y=a.lqb(W,this.ownerAddinInfo);R&&(l.ULS.sendTraceTag(537170634,
220,50,"Shared runtime agave is inserted."),Y.SharedRuntimeId=R.Resid);var ma=500,Z=0;void 0===Y.IsToBePersisted||null===Y.IsToBePersisted||Y.IsToBePersisted||(ma=538,Q=function(na,pa,Ia){l.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Y.CurrentStoreType,Y.StoreId,Telemetry.PrivacyRules.GetAssetId(Y.CurrentStoreType,Y.StoreId,Y.AssetId));na=B.b(na,O);var Ma=S.Oa(9,null);Ma.sharedInfo=Y;return x.i(S,"ShowAgaveTaskpane",Ma,
na,pa,Ia,null,0)},Z=16);if(w.EwaSettings.tc()){Z|=64;var xa=z.a(this.$.userOperationManager,Q,function(na){return new r.a(ma,0,na,Z)},this.ee)}else xa=z.a(this.$.userOperationManager,Q,function(na){return new t.a(ma,0,na,Z)},this.ee);return G.TaskExtensions.ts(xa,function(){return ca?ba.Frd(S,ca.InstanceId,function(na,pa){if(na){R||(ca.PrimaryMarketplace.MarketplaceType=W.storeType);ca.OwnerAddinSolutionId=ba.ownerAddinInfo.solutionId;ca.OwnerAddinAssetId=ba.ownerAddinInfo.assetId;ca.OwnerAddinStoreType=
ba.ownerAddinInfo.storeType;ca.OsfPropertyBag=[];for(pa=0;pa<na.Settings.length;pa++){var Ia=[];Ia[0]=na.Settings[pa].Name;Ia[1]=na.Settings[pa].Value;ca.OsfPropertyBag[pa]=Ia}I(ca,0)}else I(null,pa.Errors?pa.Errors[0].ErrorCause:5001)}):P.Task.Ta(!1)},n.a.none,3,ia.a.current)};a.prototype.Frd=function(W,R,I){function Q(ba,ca,S){ba=B.b(ba,O);var Y=W.Oa(1);Y.controlId=R;return x.i(W,"DdaLoadSettings",Y,ba,ca,S,null,0)}function O(ba){I(ba.Result,ba)}return w.EwaSettings.tc()?z.a(this.$.userOperationManager,
Q,function(ba){return new r.a(501,0,ba,80)},this.ee):z.a(this.$.userOperationManager,Q,function(ba){return new t.a(501,0,ba,16)},this.ee)};a.prototype.ljf=function(W,R){var I;W&&(null===(I=window.performance)||void 0===I?0:I.memory)&&l.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",R,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};
a.showUILessDialog=function(W){a.Idb.wb(W)&&a.Idb.na(W).initializeAndShowWithTitle()};a.hideUILessDialog=function(W){a.Idb.wb(W)&&a.Idb.na(W).hide()};a.lqb=function(W,R){var I={};I.SolutionId=W.solutionId;I.Version=W.version;I.StoreType=R.storeType;I.StoreId=W.storeId;I.AssetId=W.solutionId;I.AssetStoreId="omex";I.TargetType=1;I.Width=350;I.OwnerAddinSolutionId=R.solutionId;I.OwnerAddinStoreType=R.storeType;I.SharedRuntimeId=null;I.Preload=!1;I.Id=W.solutionId;I.AppVersion=W.version;I.CurrentStoreType=
R.storeType;I.OwnerAddinAssetId=R.assetId;return I};a.Idb=new U.a;Object(y.a)(a,"WACExcelAddinCommandsHost",k,[])},1285:function(y,D,b){function a(d,c,k,n){this._id=d;this.hsg=c;this.Yee=k;this.MTa=n}b.d(D,"a",function(){return a});y=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.hsg};a.prototype.getStoreType=function(){return this.Yee};Object(y.a)(a,"ExtensionIdentity",null,[301])},1286:function(y,D,b){function a(d,c,k){this.I8d=k}b.d(D,"a",function(){return a});
y=b(0);Object(y.a)(a,"HostProperties",null,[])},1287:function(y,D,b){function a(){this.ni={};this.Sq={}}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"ExtensionLaunchProperties",null,[])},1288:function(y,D,b){function a(){this.La=f.AFrameworkApplication.Eb}b.d(D,"a",function(){return a});y=b(0);var d=b(1285),c=b(1287),k=b(1100),n=b(1290),l=b(1286),f=b(5),u=b(592),v=b(29);a.prototype.CMa=function(m,A,x,t,z){this.yji(m,A,x,t,z)};a.prototype.yji=function(m,A,x,t,z){var r=b(1289).ExtensionComponentInstance,
G={};G[k.a.r7b]=m;G[k.a.wye]=A;G[k.a.GGa]=x;G[k.a.hid]=t;G[k.a.iya]=z;t=8;f.AFrameworkApplication.Vei(m.getId())&&(t=A===n.a.action?this.La.ze(v.a.iOe,2,G):this.La.ze(v.a.r_f,2,G));32===t?(t=u.a.create().toString(),z.ni.InstanceToken&&(t=z.ni.InstanceToken),m=new r(m,A,x,t),a.uv[t]=m):m=new r(m,A,x,null);m.Kgj(G)};a.prototype.xji=function(m){var A=m.ExtId,x=m.ComponentType,t=m.ComponentId,z=m.HostProps;m=m.OptionalProps;A=new d.a(A.Id,A.StoreId,A.StoreType,A.AppVersion);z=new l.a(z.HostType,z.FormFactor,
z.Locale);var r=new c.a;r.ni=m.OptionalProperties;r.Sq=m.DevProperties;a.instance.CMa(A,x,t,z,r)};a.prototype.getInstance=function(m){return a.uv[m]};a.prototype.T2i=function(m){delete a.uv[m]};tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.cGc||(a.cGc=new a);return a.cGc}}});a.cGc=null;a.uv={};Object(y.a)(a,"ExtensionLifeCycleManager",null,[300])},1289:function(y,D,b){function a(n,l,f,u){this.MTa=this.LF=null;this._id=n;this.nig=f;this.$lg=u;this.La=c.AFrameworkApplication.Eb?
c.AFrameworkApplication.Eb:null}b.r(D);b.d(D,"ExtensionComponentInstance",function(){return a});y=b(0);var d=b(1288),c=b(5),k=b(29);a.prototype.Obd=function(){return this.nig};a.prototype.Kgj=function(n){this.LF=n};a.prototype.stop=function(){var n=this.La.ze(k.a.PUg,2,this.LF);d.a.instance.T2i(this.$lg);return 32===n};a.prototype.Urc=function(){this.La.ze(k.a.PPf,2,this.LF)};tl.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.MTa}}});Object(y.a)(a,
"ExtensionComponentInstance",null,[332])},1290:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.taskpane="Taskpane";a.action="Action";Object(y.a)(a,"ComponentTypeNames",null,[])},1292:function(y,D,b){function a(k,n,l,f){this.TPc=this.mjb=this.VPc=null;this.LDa=k;c.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")?(this.VPc=l.oMh(),this.mjb=l.d9a,this.TPc=l.dti):(this.VPc=l.yxc,this.TPc=this.mjb=null);this.iDc=this.ms=n;this.prg=f}b.d(D,"a",function(){return a});
y=b(0);var d=b(13),c=b(5);a.prototype.wua=function(k){k=this.tNa+this.solutionId+k;return this.rOd?(k in a.jYb||(a.jYb[k]="AddinControl"+a.eDg++),a.jYb[k]):k};a.prototype.$Ce=function(k){if(this.rOd){var n=a.jYb,l;for(l in n){var f=l;if(k===n[l])return f.substr(this.tNa.length+this.solutionId.length)}}return k};a.prototype.jfd=function(k){k=this.tNa+this.solutionId+k;return this.rOd?(k in a.YTc||(a.YTc[k]="AddinTab"+a.mDg++),a.YTc[k]):k};a.prototype.vNh=function(k){return k.toLowerCase()in this.yxc?
(d.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",k.toLowerCase()),this.tNa+this.yxc[k.toLowerCase()]):null};a.prototype.INh=function(){if(!this.d9a)return null;for(var k=[],n=yl(this.d9a),l=n.next();!l.done;l=n.next())k.push(this.tNa+l.value);return k};a.prototype.mLh=function(k){k=this.bUe(k);return null===k?null:k[1]};a.prototype.kLh=function(k){k=this.bUe(k);return null===k?null:k[2]};a.prototype.bUe=function(k){return this.cSd&&k.toLowerCase()in this.cSd?(d.ULS.sendTraceTag(21017039,220,50,
"Get attributes for Tab id: {0}.",k.toLowerCase()),this.cSd[k.toLowerCase()]):null};tl.Object.defineProperties(a.prototype,{tNa:{configurable:!0,enumerable:!0,get:function(){return this.LDa}},yxc:{configurable:!0,enumerable:!0,get:function(){return this.VPc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.iDc}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.mjb}},cSd:{configurable:!0,enumerable:!0,
get:function(){return this.TPc}},rOd:{configurable:!0,enumerable:!0,get:function(){return this.prg}}});a.jYb={};a.YTc={};a.mDg=0;a.eDg=0;Object(y.a)(a,"DefaultRibbonNamingProvider",null,[295])},1346:function(y,D,b){function a(x){var t=this;this.jA=null;this.m6f={};this.o6f={};this.g$c={};this.Xvd={};this.Mgd=function(z,r){z=t.$.Ub.Fc("Task","DdaEventDispatch.HandleServerEvent");r=r.TTf;for(var G=0;G<r.length;G++)switch(r[G].EventType){case 2:var w=r[G],B={};B.Name=w.Name;B.BindingType=w.BindingType;
B.ColCount=w.ColCount;B.RowCount=w.RowCount;t.eva(w.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,B,null);break;case 4:t.eva(r[G].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(w=r[G],w.InstanceId){B=Array(w.Entries.length);for(var U=0;U<w.Entries.length;U++)B[U]=a.xac(w.Entries[U],w.IsRemoteOverride);0<w.Entries.length&&1===w.Entries[0].Category?t.FUi(w.InstanceId,B):w.InstanceId&&t.eva(w.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,B)}else{t.g$c={};t.Xvd={};for(B=0;B<w.Entries.length;B++)t.JFe(w.Entries[B],w.IsRemoteOverride);d.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",t.g$c,t.Xvd,t.m6f,t.o6f)}}z.stop()};this.SHb=function(z,r){t.eva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)};this.$=x;this.Btc=this.Mgd}b.r(D);y=b(0);var d=b(13),c=b(84),k;(function(x){x[x.none=0]="none";x[x.testEvent=1]=
"testEvent";x[x.test1Event=2]="test1Event";x[x.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";x[x.worksheetActivatedEvent=11]="worksheetActivatedEvent";x[x.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";x[x.worksheetAddedEvent=13]="worksheetAddedEvent";x[x.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";x[x.worksheetDeletedEvent=15]="worksheetDeletedEvent";x[x.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";x[x.worksheetFilteredEvent=17]="worksheetFilteredEvent";
x[x.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";x[x.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";x[x.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";x[x.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";x[x.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";x[x.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";x[x.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";x[x.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";x[x.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";x[x.worksheetMovedEvent=27]="worksheetMovedEvent";x[x.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";x[x.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";x[x.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";x[x.chartAddedEvent=50]="chartAddedEvent";x[x.chartActivatedEvent=51]="chartActivatedEvent";x[x.chartDeactivatedEvent=
52]="chartDeactivatedEvent";x[x.chartDeletedEvent=53]="chartDeletedEvent";x[x.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";x[x.tableDataChangedEvent=101]="tableDataChangedEvent";x[x.tableAddedEvent=102]="tableAddedEvent";x[x.tableDeletedEvent=103]="tableDeletedEvent";x[x.tableFilteredEvent=104]="tableFilteredEvent";x[x.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";x[x.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";x[x.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";x[x.commentAddedEvent=250]="commentAddedEvent";x[x.commentDeletedEvent=251]="commentDeletedEvent";x[x.commentChangedEvent=252]="commentChangedEvent";x[x.invocationMessage=1E3]="invocationMessage";x[x.cancellationMessage=1001]="cancellationMessage";x[x.metadataMessage=1002]="metadataMessage";x[x.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";x[x.visualChangeEvent=2001]="visualChangeEvent";x[x.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
x[x.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";x[x.shapeActivatedEvent=2101]="shapeActivatedEvent";x[x.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";x[x.shapeAddedEvent=2103]="shapeAddedEvent";x[x.shapeDeletedEvent=2104]="shapeDeletedEvent";x[x.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";x[x.wacOperationEvent=2201]="wacOperationEvent";x[x.recordingStateChangedEvent=2202]="recordingStateChangedEvent";x[x.workbookActivatedEvent=2203]="workbookActivatedEvent";
x[x.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";x[x.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";x[x.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";x[x.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";x[x.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";x[x.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
x[x.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";x[x.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";x[x.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";x[x.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";x[x.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";x[x.pivotTableAddedEvent=2900]="pivotTableAddedEvent";x[x.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
x[x.namedItemAddedEvent=3E3]="namedItemAddedEvent";x[x.namedItemDeletedEvent=3001]="namedItemDeletedEvent";x[x.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";x[x.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";x[x.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(k||(k={}));Object(y.b)("MessageType",k);var n=b(895),l=b(234),f=b(861),u=b(52),v=b(35),m=b(147),A=b(1);b.d(D,"DdaEventDispatch",function(){return a});
a.prototype.PXb=function(x){x&&(this.cia(),Array.add(this.jA,x))};a.prototype.Oqc=function(x){this.jA&&(Array.remove(this.jA,x),this.jA.length||(this.$.wantServerEvents=!1,this.$.j6i(this.Btc),this.jA=null))};a.prototype.FUi=function(x,t){var z=this,r=Object(c.a)(f.DdaFacade,l.a(this.$));v.TaskExtensions.Ba(r.FNh(x),function(G){if(m.b(G)){var w=G.result;G=r.an(w);if(w)if(G.nnd)z.eva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(G.y3c)for(w=0;w<t.length;w++)Array.add(G.y3c,t[w]);
else G.y3c=t}else G.jg?d.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):G.Ch&&d.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)};a.prototype.aVi=function(x,t){var z=Object(c.a)(f.DdaFacade,l.a(this.$)),r=z.lCh(x);r?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(r,t,this.SHb):z.o_g(x,t)};a.prototype.JFe=function(x,
t){var z=!1,r=parseInt(x.Type),G=x.Target,w=Object(c.a)(f.DdaFacade,l.a(this.$));if((G=w.dj.LNh(r,G))&&0<Object.keys(G).length){z=!0;for(var B in G)if(G=B,w.dj.gZb(G)){var U=Array(1);U[0]=a.xac(x,t);if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var N=U[0][3];if(void 0!==N&&null!==N&&(N=Object(c.a)(Object,u.a.li(N)))&&void 0!==N.triggerControlId&&null!==N.triggerControlId&&void 0!==N.triggerSource&&null!==N.triggerSource){var P=!1;t?(N.triggerSource="Unknown",
P=!0):w.gch(N.triggerControlId,G)&&(N.triggerSource="ThisLocalAddin",P=!0);P&&(U[0][3]=u.a.Hc(N))}}this.eva(G,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,U)}}z?(this.gdc(k[r],this.g$c),this.gdc(k[r],this.m6f)):(this.gdc(k[r],this.Xvd),this.gdc(k[r],this.o6f))};a.prototype.cia=function(){this.jA||(this.jA=[],this.$.Lle(this.Btc),this.$.wantServerEvents=!0)};a.prototype.gdc=function(x,t){x in t||(t[x]=0);t[x]+=1};a.prototype.jM=function(x,t,z){var r={};r.Target=t;r.Category=65536;r.Type=x;r.Message=
z;r.Id=-1;this.JFe(r,!1)};a.prototype.bwh=function(x,t){var z={Target:"",Category:2,Type:1E3};z.Message=t;z.Id=0;t=Array(1);t[0]=a.xac(z,!1);this.aVi(x,t)};a.prototype.j8b=function(x,t,z,r){var G={};G.Target=z;G.Category=65536;G.Type=t;G.Message=r;G.Id=-1;t=Array(1);t[0]=a.xac(G,!1);this.eva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.awh=function(x,t){this.eva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.eva=function(x,t,z,r){if(this.jA){var G=Object(c.a)(f.DdaFacade,
l.a(this.$));if(!G||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||G.dj.gZb(x))for(x=new n.a(t,x,z,r),t=0,z=this.jA.length;t<z;t++)(r=this.jA[t])&&r(x)}};a.xac=function(x,t){var z=Array(6);z[0]=x.Category;z[1]=x.Type;z[2]=x.Target;z[3]=x.Message;z[4]=x.Id;z[5]=t;return z};Object(y.a)(a,"DdaEventDispatch",null,[])},1369:function(y,D,b){function a(){var k=c.call(this,void 0,void 0,void 0,!0)||this;k.uCa="AddinCommandsUILessDialog";k.uQc="WACDialogTitleText";
k.gUa="0";k.xCa=380;k.Igb=190;k.Me=k.uCa;k.kc=5;k.uig=String.format("{0}px",k.xCa);k.fUa=String.format("{0}px",k.Igb);k.Gu=!1;k.X3e=!1;k.KC();return k}b.d(D,"a",function(){return a});y=b(0);D=b(140);var d=b(89),c=D.a;vm(a,c);a.prototype.KC=function(){c.prototype.KC.call(this);this.fp.style.width=this.uig;this.fp.style.height=this.fUa;this.fp.style.padding=this.gUa};a.prototype.$u=function(k){this.WN();document.getElementById(this.mi(this.uQc)).innerText=k};a.prototype.WN=function(){c.prototype.WN.call(this);
this.Lb.style.width=String.format("{0}px",this.xCa);this.Lb.style.height=String.format("{0}px",this.Igb);this.Lb.removeAttribute(d.a.Sd);this.Lb.removeAttribute(d.a.JD)};a.prototype.hide=function(){this.Yvb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};tl.Object.defineProperties(a.prototype,{k0a:{configurable:!0,enumerable:!0,get:function(){return this.fp}}});Object(y.a)(a,"AddinCommandsUILessDialog",D.a,[294])},1375:function(y,
D,b){function a(F){return Vk.call(this,F)||this}function d(F,fa,Pa){this.rangePicker=null;this.$=F;this.Ve=fa;this.we=new O(F.fa);this.Ez=new N(F,this.we);this.bof=Pa;this.A7b=new Map}function c(F,fa,Pa,yb,Cc){this.ZQc=null;this.POb=F;this.Rz=fa;this.AI=Pa;this.vb=yb;this.Ztg=Cc}function k(){}function n(){this.Kfa=null}function l(F){if(!F)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.std=F}function f(F,fa,Pa){return function(yb){return function(Cc,
Vc){Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(fa.da,279,fa.ma,1),function(rd){rd=rd.result;var Hd=!1,te=Pa.Gi.getOsfControl(F),hf=null;te&&(hf=te.getStoreType(),(te=te.getManifest())&&te.getSharedRuntimeForCustomFunctions("Workbook")&&(Hd=!0));Vg.TaskExtensions.Ba(rd.E8e(F,hf,yb,Hd),function(ff){Sk.b(ff)?ff.result?Cc(null):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,De.a.instance.ea(1712))):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,
De.a.instance.ea(1708)))},fa.ma,3)},fa.ma,3)}}}function u(F,fa){this.uO=dh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Rz=F;this.AI=fa;this.Nog=this.AI.Gi.getOsfControl(this.Rz)}function v(F,fa,Pa,yb){this.W_d="";this.KQb=0;this.uO=F;this._id=fa;this.Rz=Pa;this.AI=yb}function m(F,fa,Pa){this.dmg=F;this.emg=fa;this.Wpg=Pa}function A(){this.Zee=this.$9d=this.Mz=!1}function x(F,fa,Pa,yb){this.ms=F;this.e1=Pa;this.ly=yb.Gi.getOsfControl(fa)}function t(F,fa){this.AI=
fa;this.Rz=F}function z(F){this.Rz=F}function r(F){this.THa={};this.qri=F}function G(F,fa){var Pa=this;Pa.Qdf=function(yb,Cc){yb=G.fZg(yb,Cc);if(!Lj.a(Pa.$,yb))return!0;yb=Pa.$.shortcutKeyManager.O_e(yb);return!!yb&&0<yb.length};Pa.addinId=F;Pa.$=fa;return Pa}function w(){}function B(){}function U(F,fa,Pa,yb){this.Uth=F;this.fileSize=fa;this.Tuj=yb}function N(F,fa){var Pa=this;this.JH=function(yb,Cc){Pa.ZP.jJa(C.a.internalError,Cc)};this.$=F;this.ZP=fa}function P(F,fa,Pa,yb){Pa=kj.call(this,576,0,
Pa,yb)||this;Pa.rJd=new W("576",F,fa);return Pa}function ia(F,fa,Pa,yb,Cc,Vc,rd,Hd){fa=Ch.call(this,10,0,fa,Hd)||this;fa.Nkb=Pa;fa.chb=yb;fa.e3=Cc;fa.DEa=Vc;fa.request=rd;fa.rJd=new W("10",F,rd);return fa}function W(F,fa,Pa){this.parentName=F;this.$=fa;this.request=Pa}function R(F,fa){this.source=F;this.eventId=fa}function I(F,fa,Pa,yb,Cc,Vc){var rd=F.Oa(1);rd.request=fa;return Oi.i(F,"ExecuteRichApiRequest",rd,Pa,yb,Cc,Vc,0)}function Q(F,fa,Pa){this.$=F;this.ZP=fa;this.Ez=Pa}function O(F){this.fa=
F}function ba(F,fa,Pa,yb){F=Vd.call(this,F,"Select Data")||this;F.Knb=null;F.qDe=fa;F.$3c=Pa;F.callback=yb;return F}function ca(F){this.vb=F}function S(F){F.add("InternalTest","PreviewExecutionMethod",Y)}function Y(F,fa){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof F+", objectId="+F+", value="+fa);return null}function ma(F,fa){this.Mng=F;this.jog=fa}function Z(F){var fa=F.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Pa=fa.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Pa.addParameter("shortcuts","String[]",1,null,0);fa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Pa=fa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Pa.addParameter("shortcuts","Object",1,null,0);fa=F.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Pa=fa.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);Pa.addParameter("pickerCustomizationJsonString","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Pa=fa.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Pa.addParameter("base64File","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);fa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Pa=fa.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Pa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);fa=F.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);fa.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Pa=fa.addMethod("Register",1,"Void",0,0,"Register",0);Pa.addParameter("metadata",
"String",1,null,0);Pa.addParameter("javascript","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);fa.addProperty("Enabled",1,"Boolean",1,!1,null,0);fa.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);fa.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);fa=F.addEnumType("Microsoft.Authentication.IdentityType");fa.addEnumField("OrganizationAccount",0);fa.addEnumField("MicrosoftAccount",1);fa=F.addEnumType("Microsoft.Authentication.AuthorityType");
fa.addEnumField("External",0);fa.addEnumField("Msa",1);fa.addEnumField("Aad",2);fa=F.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);fa.addProperty("DisplayName",4,"String",1,!1,null,0);fa.addProperty("Email",3,"String",1,!1,null,0);fa.addProperty("FederationProvider",2,"String",1,!1,null,0);fa.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);fa=F.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);fa.addProperty("AppId",4,"String",1,!1,null,0);fa.addProperty("Authority",2,"String",1,!1,null,0);fa.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);fa.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);fa.addProperty("TenantId",6,"String",1,!1,null,0);fa.addProperty("Upn",1,"String",1,!1,null,0);fa=F.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);fa.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Pa=fa.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Pa.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);fa.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);fa.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);fa=F.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);fa.addProperty("AuthChallenge",3,"String",1,!1,null,0);fa.addProperty("CorrelationId",7,"String",1,!1,null,0);fa.addProperty("Policy",4,"String",1,!1,null,0);fa.addProperty("Resource",2,"String",1,!1,null,0);fa.addProperty("Scope",5,"String",1,!1,null,0);fa.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);fa=F.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);fa.addProperty("AccessToken",2,"String",1,!1,null,0);fa.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);fa=F.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);fa.addProperty("Id",1,"String",1,!0,null,0);fa.addProperty("Value",2,"Object",1,!1,null,0);fa=F.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Pa=fa.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Pa.addParameter("id","String",1,null,0);Pa=fa.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Pa.addParameter("id","String",1,null,0);fa=F.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);fa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Pa=fa.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Pa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);fa=F.addEnumType("Microsoft.AppRuntime.AppRuntimeState");fa.addEnumField("Inactive",0);fa.addEnumField("Background",1);fa.addEnumField("Visible",2);fa=F.addEnumType("Microsoft.AppRuntime.Visibility");fa.addEnumField("Hidden",1);fa.addEnumField("Visible",2);fa=F.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);fa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Pa=fa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Pa.addParameter("jsonCreate","String",1,null,0);Pa=fa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Pa.addParameter("jsonUpdate","String",1,null,0);Pa=fa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Pa.addParameter("id","String",
1,null,0);Pa=fa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Pa.addParameter("id","String",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);fa.addProperty("Id",2,"String",1,!0,null,0);Pa=fa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Pa.addParameter("visibility","Boolean",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);fa.addProperty("Enabled",3,"Boolean",1,!1,null,0);fa.addProperty("Id",2,"String",1,!0,null,0);fa.addProperty("Label",4,"String",1,!0,null,0);Pa=fa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Pa.addParameter("enabled","Boolean",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);fa.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Pa=fa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Pa.addParameter("key","String",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);fa=F.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");fa.addEnumField("Unknown",0);fa.addEnumField("Basic",1);fa.addEnumField("Premium",2);fa=F.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Pa=fa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Pa.addParameter("feature","String",1,null,0);Pa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Pa=fa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Pa.addParameter("feature","String",1,null,0);Pa=fa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Pa.addParameter("feature","String",
1,null,0);Pa.addParameter("fallbackValue","Boolean",1,null,0);fa.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Pa=fa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Pa.addParameter("experienceId","String",1,null,0);Pa=fa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Pa.addParameter("feature","String",1,null,0);fa=F.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);fa.addProperty("Id",5,"String",1,!0,null,0);fa.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);fa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);fa=F.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);fa.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);fa=F.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);fa.addMethod("Disable",3,"Void",0,1,"Disable",0);fa.addMethod("Enable",2,"Void",0,1,"Enable",0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function xa(F,fa,Pa,yb){this.menuItemId=F;this.bI=fa;this.uyj=Pa;this.duh=yb}function na(F){this.Mpi=F}function pa(F){this.cxa=F;this.Bjg=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Ia(){}function Ma(){}
function lb(){}function zb(F,fa){this.kgb=fa;this.Rz=F}function Ya(){this.f_d=null;this.nde=this.eUb=this.nD="";this.Aee=!0;this.options=null}function Wb(F,fa){this.ifb=F;this.Mhb=fa}function Zb(){}function da(){this.D3d=this.U2d=this.Iea=null;this.Mhb=0}function za(F){var fa=el.call(this)||this;fa.$=F;fa.dc();return fa}function hb(F,fa,Pa){this.ugg=null;this.wgg=0;this.ub=F;this.Og=fa;this.C0d=Pa}function Gb(){}function Sb(F,fa,Pa,yb,Cc){var Vc=$k.call(this)||this;Vc.Gbb={};Vc.k$c={};Vc.Fva=null;
Vc.L9a=null;Vc.IYh=function(rd,Hd,te,hf,ff){if(2!==te)return 32;rd=ff[pk.a.r7b];te=ff[pk.a.GGa];ff=ff[pk.a.iya];Hd=new Fj.a;Hd.C6h=ff.ni.InstanceToken;Hd.al=ff.ni[fe.al];Hd.PR=ff.ni[fe.PR];fe.taskPaneWidth in ff.ni&&(Hd.taskPaneWidth=ff.ni[fe.taskPaneWidth]);Hd.sourceLocationOverrideResourceId=ff.ni[fe.sourceLocationOverrideResourceId];Hd.DH=ff.Sq;Hd.onTaskPaneClose=ff.ni[fe.onTaskPaneClose];Hd.GGa=te;te=new ak.a(-859308420,0,2,0,"");hf=rd.getStoreType()===OSF.StoreType.Sdx;var lg=new Ce;lg.waa=ff.ni.HeaderCssClass||
Yc.a.tIa;lg.lyc=ff.ni.TitleCssClass;Vc.i0(te,rd.getId(),Hd,hf,lg);return 32};Vc.tYh=function(rd,Hd,te,hf,ff){if(2!==te)return 32;rd=ff[pk.a.r7b].getId();ff=ff[pk.a.iya].ni[fe.sourceLocationOverrideResourceId];return rd?(Vc.Ve.Gi.refreshOsfControl(rd,ff),32):8};Vc.vSi=function(rd){rd=rd.Result;if(rd=null===rd?null:rd.SolutionId)Vc.Ve.Wie(rd),gk.a(Vc.$).zma(3,rd)};Vc.kEf=function(rd,Hd){var te=(rd=rd.Result)?rd.AgaveData:null;if(te){Re.ULS.shipAssertTag(537170434,0,te.TaskpaneWidth===Sb.V8g,"Taskpane width is {0}, assetId is {1}.",
te.TaskpaneWidth,te.PrimaryMarketplace.SolutionId);var hf=Vc.k$c[te.PrimaryMarketplace.SolutionId];hf&&(hf.Mxc&&(te.TaskpaneTitle=hf.Mxc),hf.Kxc&&(te.TaskpaneIconId=hf.Kxc),hf.uSd&&(te.TaskpaneButtonTooltip=hf.uSd),0<hf.nr&&(te.TaskpaneWidth=hf.nr));Hd&&(te.FocusOnIframeWhenLoaded=Hd.focusOnIframeWhenLoaded,Hd.width&&(te.TaskpaneWidth=Hd.width),te.TaskpaneIconCssClass=Hd.Vj,te.TaskpaneHeaderCssClass=Hd.waa,te.TaskpaneTitleCssClass=Hd.lyc);Vc.Gbb[te.PrimaryMarketplace.SolutionId]&&(te.OsfPropertyBag=
Vc.hud(te.OsfPropertyBag,te.PrimaryMarketplace.SolutionId));dl.a(te)||(te.WebExtensionOsfControlType=1);te&&(Vc.Ve.Wie(rd.SolutionId),Vc.Ve.z_a(te))}else Re.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Vc.pth=function(rd){rd&&(Vc.q9c.Cff(rd),Vc.lue())};Vc.mEf=function(rd){rd=rd.toDataURL("image/jpeg");var Hd=Vc.Ve.T$(Sb.e5e+"."+Sb.F1e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Hd,"onScreenshot",{screenshot:rd},
function(){})};Vc.XWh=function(rd,Hd,te,hf,ff){if(2!==te)return 32;if(Ai.a.yj(ff)||ff[pk.a.wye]!==sj.a.action)return 8;Hd=ff[pk.a.iya];return Hd?(rd=(rd=Vc.KNh(ff))?Vc.Ve.T$(rd):null)?(ff=Vc.Ve.l_g(ff[pk.a.GGa],Hd.ni[fe.wRc]),ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(te=Vc.Ve.XY(rd),te.TaskpaneTitle!==Hd.ni[fe.al]&&(te.TaskpaneTitle=Hd.ni[fe.al],te.TaskpaneIconCssClass=Hd.ni.IconCssClass,te.TaskpaneIconUrl=Hd.ni.TaskPaneIconUrl,te.TaskpaneIconId=Hd.ni.TaskPaneIconId,
ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Hd=Vc.Ve.Gi,Hd.changeIframeTitle(rd,te.TaskpaneTitle),te=Hd.getOsfControl(rd),Hd.raiseOsfControlStatusChange(te)):(Hd=Vc.Ve.Gi.getOsfControl(rd),Vc.Ve.Gi.raiseOsfControlStatusChange(Hd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(rd,ff,Vc.SHb),32):8:8};Vc.SHb=function(rd,Hd){Vc.Ve.Xvh(rd,Hd)};Vc.$=F;Vc.viewBlockContainerHelpers=Pa;Vc.Ve=fa;Vc.q9c=yb;Vc.Di=Cc;Vc.Di.$b(Eh.a.r_f,ki.a.frame,Vc.IYh);
Vc.Di.$b(Eh.a.PPf,ki.a.frame,Vc.tYh);Vc.Di.$b(Eh.a.iOe,ki.a.frame,Vc.XWh);return Vc}function Fb(){var F=Rk.call(this)||this;F.fUa="calc(100% - 46px)";F.DPb="15px";F.gUa="0";F.njg="WACDialogPanel";F.xCa=695;F.ojg=462;F.Igb="80%";F.dhg=350;F.y_d="100%";F.kc=5;F.Me="AppsForOfficeInsertionDialog";F.SFc=!!fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return F}function wa(){var F=va.call(this)||this;F.isTable=!1;F.isPivotTable=!1;F.hasTableHeaders=
!1;F.tableName=null;F.userSelectedPivotTable=!1;return F}function va(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function sa(){this.uSd=this.Mxc=null;this.nr=0;this.Kxc=null}function sb(){var F=this;this.Ve=null;this.e$a=function(fa,Pa,yb,Cc,Vc){if(2===yb){fa=Vc?Vc:{};Pa=fa.callback;if(!Pa)return 16;F.Ve.vDd(Pa,fa.refresh?fa.refresh:!1)}return 32};this.f1i=function(fa,
Pa,yb,Cc,Vc){2===yb&&(fa=Vc?Vc.callback:null)&&F.Ve.Nzg(fa);return 32}}function Tb(F,fa){this.Njb=fa}function Da(F){return Pi.call(this,F)||this}function Sa(F){var fa=sk.call(this)||this;fa.$=F;fa.isFirstLaunch=!1;return fa}function Ra(F){Re.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Ikf=fg.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.dpi=fg.AFrameworkApplication.ga.Ua("SmartLookupApprovedOriginPattern");this.k7a=fg.AFrameworkApplication.ga.Ua("SmartLookupShredderServiceEndpoint");
this.Jpi=nk.a.oM(fg.AFrameworkApplication.ga.Ua("AppCatalogUrl")||"");this.j7a=new wb;this.j7a.EnableAllTabV2=!0;this.j7a.EnableIntentService=!0;this.j7a.EnableInDocumentSearch=fg.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.j7a.EnableLocalSearch=fg.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.j7a.IntentServiceEndpoint=Lb.fRh();this.Epi=new Ja(F,this.k7a)}function Lb(){}function Ja(F,fa,Pa){this.UCj=9E5;this.XCj=3E5;this.Zsd=null;this.dkf="";this.Wsd=0;
this.nDe=Date.now;this.cxa=F;this.k7a=fa;(void 0===Pa||Pa)&&this.jbd()}function wb(){}function Mb(){}function Eb(){}function Ic(){}function Zc(){}function Pc(F,fa,Pa,yb,Cc,Vc){this.$=F;this.agaveCommandManager=Vc}function vd(F){var fa=Oj.call(this)||this;fa.ddaFacade=null;fa.OIf=null;fa.$=F;F.da.Ha(106,fa);fa.dc();return fa}function Tc(){}function rb(){}function eb(F){this.IEa=F}function Ta(F,fa,Pa){this.iframe=F;this.onSuccess=fa;this.onError=Pa;$addHandler(window,"message",Object(Ri.a)(this,this.t3e,
"handleResponse"))}function fb(F,fa){return Ke.a.Erd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},fg.AFrameworkApplication.ga.zd("MaxRetriesForLoadingScript",0),F,fa)}function pb(F){var fa=Lh.call(this)||this;fa.$=F;fa.dc();return fa}function rc(F,fa){var Pa=this;this.fPa=this.gPa=null;this.P6f=function(yb,Cc){var Vc=null,rd=null,Hd=null;Cc?(Object(rj.a)(203,Cc)?(Vc=Cc.qFa,Hd=Cc.instanceId):Object(rj.a)(221,Cc)&&(Vc=Cc.get_element(),Hd=Cc.instanceId),Vc)?(rd=Object(Wi.a)(222,
yb),rd)?Pa.PIf(Hd,Vc,rd)||Hd in Pa.fPa||(Pa.gPa[Hd]=0,Pa.fPa[Hd]=Sh.a.instance.XB(function(){10<=Pa.gPa[Hd]||Pa.PIf(Hd,Vc,rd)?(delete Pa.gPa[Hd],Pa.fPa[Hd].dispose(),delete Pa.fPa[Hd]):Pa.gPa[Hd]+=1},500,si.a.WDg,!0,!1)):Re.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Re.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Re.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};
this.ariaLiveNotifier=F;this.$=fa;this.GVc=!1;this.$.da.Ha(224,this)}function vb(F){var fa=Hi.call(this)||this;fa.$=F;fa.dc();return fa}function E(F){var fa=Ui.call(this,F)||this;fa.handler=null;fa.Vug=function(){Re.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",fa.$.isEditMode,!!(fa.$.Fd&16384));var Pa=new nj.a;fa.$.da.Za(53,function(ff){Re.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Pa.setResult(ff)});var yb=Pa.task,Cc=new uf,Vc=Ik.a.getInstance(),rd=new je(fa.$,Vc),Hd=Zi.GetServiceTaskFactory.create(fa.$.da,203,fa.ma,fa.tb),te=fa.i0i(Cc),hf=Zi.GetServiceTaskFactory.Xa(fa.$.da,349,350,fa.tb);return Vg.TaskExtensions.Ba(Vg.TaskExtensions.ve([yb,Hd,te,hf],fa.ma),function(){Re.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(fa.$.da,106,fa.ma,fa.tb),function(ff){fa.handler=
new ka(fa.$,ff.result,Cc,new Lf,Vc,rd,dh.a.instance.Hh("Common.IExternalUICommandDefinitionMapping"));Re.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");fa.Ed([fa.handler]);fa.$.da.Ha(198,fa.handler)},fa.ma,3)},fa.ma,3)};fa.e8g=function(){void 0!==fa.handler&&null!==fa.handler?(fa.$.Ka.M$a(fa.handler),fa.$.da.fU(198),fa.handler=null):Re.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
fa.$.da.fU(204);$i.a(vi.a,21,fa.$.da,198)};return fa}function Nb(F,fa,Pa,yb){this.WNd=void 0===F?null:F;this.CRc=void 0===fa?null:fa;this.a4c=void 0===Pa?null:Pa;this.D7b=void 0===yb?0:yb}function ka(F,fa,Pa,yb,Cc,Vc,rd){var Hd=this;rd=void 0===rd?null:rd;this.disposed=!1;this.Ma=new Gj.a;this.vzj=3E5;this.GOd=!0;this.TTc="addinActivated";this.czi=function(te,hf){if(hf)if(hf)if(te=hf.Fg){hf=hf.nl;var ff=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(te.assetId in ff)hf=
ff[te.assetId];else if(hf=Hd.UFh(hf),void 0===hf||null===hf){Re.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}ff=new ak.a(Eh.a.c2,0,0,2,null);var lg={};Hd.executeCommand(0,ff,(lg.SourceControlId=hf,lg),null);te.isAutoLaunched=!0;Re.ULS.sendTraceTag(528098433,220,50,"OnAutoLaunchAddin succeed")}else Re.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Re.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Re.ULS.sendTraceTag(528098437,
220,15,"No args for OnAutoLaunchAddin event")};this.mGi=function(te,hf){te=null;hf&&(te=hf);(null===te||void 0===te?0:te.nl)&&Hd.Ikj(te.nl);Hd.$.Gf();ig.EwaSettings.la(87)&&te&&te.Fg&&Hd.EIg(te.Fg)};this.$=F;Re.ULS.shipAssertTag(537170659,0,!(void 0===fa||null===fa),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",wh.a.U2());this.Ve=fa;this.hze=Pa;this.gYb=yb;this.uga=Cc;this.Amb=Vc;this.hl=new Qh.a;this.tga=new nd;this.c9c=rd;bc.a.$vb=bc.a.eOe;this.k4c=new Gh.a;
this.p0a=new Gh.a}function bb(F){var fa=this;this.gFa=this.kFa=this.Fg=this.nl=null;this.lqc=0;this.lGi=function(){if(fa.Fg&&fa.gFa){var Pa=new ak.a(Eh.a.c2,0,0,2,null),yb={};fa.addinUICommandHandler.executeCommand(0,Pa,(yb.SourceControlId=fa.gFa,yb),null);Re.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.yrj=function(Pa,yb){Pa=null;if(yb)if(Pa=yb,fa.Fg=Pa.Fg,fa.nl=Pa.nl,fa.nl&&fa.nl.pK&&fa.nl.pK.fq&&(fa.kFa=fa.nl.pK.fq.na(0)),fa.kFa&&fa.kFa.id)if(fa.kFa.isOfficeTab)if(yb=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),fa.Fg.assetId in yb?fa.gFa=yb[fa.Fg.assetId]:(Re.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId)),fa.gFa=fa.qCh(fa.nl)),fa.gFa)if(Sj.a.contains(fa.kFa.id,Ni.a.dW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Kf.a.itb(fa.nl),function(){fa.t0f(fa.qed(fa.gFa))});else{if(yb=fa.$.Ka)yb.Vle(fa.fAf),
Re.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Re.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),yb={},yb=(yb.AppTeachingUICalloutAction="NoEnabledButtonFound",yb["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId),yb.AppTeachingUICalloutGoal="NewAdminDeployment",yb["SDX.AppInstallOrigin"]="Organization",yb),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(yb)}));else fa.v0f(fa.qed(fa.kFa.id),0);else Re.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),yb={},yb=(yb.AppTeachingUICalloutAction="NoTabFound",yb["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId),yb.AppTeachingUICalloutGoal="NewAdminDeployment",yb["SDX.AppInstallOrigin"]="Organization",yb),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(yb)}))};this.fAf=function(){if(Sj.a.contains(fa.kFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Pa=fa.$.Ka;Pa&&Pa.hNf(fa.fAf);fa.t0f(fa.qed(fa.gFa))}};this.$=F.$;this.addinUICommandHandler=F;this.hl=new Qh.a}function Ha(F,fa){this.LDa=F;this.oea=new Jb;this.yea=new $b(fa)}function Ga(F,fa,Pa,yb,Cc,Vc){F=jb.call(this,F,fa)||this;F.Z7=null;F.Bea=null;F.Eea=null;F.yea=Pa;F.hlg=yb;F.iDc=Cc;F.U0=Vc;return F}function Ua(F){this.kde=null;if(cj.c(F))throw Re.ULS.sendTraceTag(9041813,
220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.Oqg=F}function jb(F,fa){this.pfe=new Gh.a;this.Ew=this.qv=null;this.Zib=F;this.oea=fa}function $a(F){this.lde=this.u4d=this.lfe=null;this.isOfficeTab=!1;this.j2e=this.gSf=null;this._id=F;this.XRa[Sg.a.id]=this._id}function Yb(F){this.o1d=this.t4d=this.Skb=null;if(cj.c(F))throw Re.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),
Error.create("GroupDefinition id should not be null or undefined");this._id=F;this.ava[Sg.a.id]=this._id}function ec(F,fa,Pa,yb,Cc,Vc){this.BOb=new Gh.a;this.Z7=this.Ew=this.qv=null;this.Zib=F;this.oea=fa;this.yea=Pa;this.ms=yb;this.U0=Cc;this.r3d=Vc}function Za(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Wa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=
null}function Ca(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function db(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function $b(F){this.jCa=F}function Jb(){}function Hc(F,fa){this.Skb=new uc(F,fa)}function uc(F,fa){this.Rsg=F;this.Eig=fa}function Aa(F){this.LDa=F}function mb(F,fa,Pa){this.zI=this.oUa=null;this.Zib=F;this.yea=fa;this.oea=Pa;this.Sng=new Gh.a}function dc(F){this.Y7=null;
if(cj.c(F))throw Re.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=F}function Ac(F){this.pLc=null;if(cj.c(F))throw Re.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=F;this.QQ[Sg.a.id]=this._id}function bd(F,fa){this.hfa=this.n1d=null;if(cj.c(F)||cj.c(fa))throw Re.ULS.sendTraceTag(9175312,
220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.p1d=fa;this._id=F;this.hA[Sg.a.id]=this._id}function Kd(F,fa,Pa,yb,Cc,Vc,rd,Hd){Hd=void 0===Hd?null:Hd;this.Ya=new Mc.a;this.zoa=F;this.m1d=fa;this.Ml=Pa;this.Lqa=yb;this.P8=Cc;this.CZd=Vc;this.U0=rd;this.P$d=Hd;this.q8=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.see=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowAddinSurveyEnabled",
!1);this.wpa=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1)}function Yd(F,fa,Pa,yb,Cc,Vc,rd){this.Bda=new Dk.a;this.Fm=F;this.Gi=fa;this.hl=Pa;this.ribbonManager=yb;this.contextMenuManager=Cc;this.ZA=Vc;this.tga=rd;this.fI=fg.AFrameworkApplication.sa.fD}function qd(F,fa,Pa){this.DZd=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=F;this.eventBuilder=fa;
this.contextMenuBuilder=Pa}function Ie(F){this.Gjg=F.entitlement}function cc(F,fa,Pa,yb,Cc){fa=void 0===fa?null:fa;Pa=void 0===Pa?null:Pa;yb=void 0===yb?null:yb;Cc=void 0===Cc?0:Cc;if(cj.c(F)&&cj.c(fa))throw Re.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.NX=F;this.Fog=fa;this.$rg=Pa;this.mjb=
yb;this.Hkg=Cc}function Qd(F){this.K$d=null;if(cj.c(F))throw Re.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.egg=F}function Wd(){}function ee(){}function ne(F){this.I7d=null;this.F5d=F}function Bd(F,fa,Pa){this.Ya=F;this.p8=fa;this.EZd=Pa}function Pd(F,fa,Pa,yb,Cc,Vc,rd){this.Fm=F;this.Fg=fa;this.vR=Pa;this.oad=yb;this.pSe=Cc;this.displayName=Vc;this.Xff=rd}function ze(){var F=Nf.call(this)||this;
F.Fg=null;F.nl=null;return F}function Jf(){new oc(of.a.instance)}function oc(F){this.wDa=F}function hd(){this.Ver=1}function wc(){}function gb(F){this.Mog=F}function kd(F,fa,Pa){this.Ma=new Mc.a;this.context=new Xd;this.rVc=this.sga=this.Xca=this.EOb=null;this.contextActivationMgr=F;this.fDg=fa;this.hYb=Pa;this.appName=fg.AFrameworkApplication.ga.Ua("WebAppShortName")}function Lc(F){var fa=Ud.call(this)||this;fa.solutionId=F.solutionId;fa.assetId=F.assetId;fa.storeType=F.storeType;fa.storeId=F.storeId;
fa.assetStoreId=F.assetStoreId;fa.targetType=F.targetType;fa.width=F.width;fa.height=F.height;fa.displayName=F.displayName;fa.version=F.version;return fa}function Cb(){this.addinId=null;this.targetType=0;this.assetId=null}function Bb(F,fa,Pa,yb){this.bHb=fg.AFrameworkApplication.ga.Ua("RoamingServiceHandlerWebServiceBase");this.appName=F;this.yhb=fa;this.uhb=Pa;this.Gjb=void 0===yb?null:yb}function Hb(F){var fa=Nd.call(this)||this;fa.properties=F;return fa}function Pb(F){var fa=-1;switch(F.toLowerCase()){case "omex":fa=
0;break;case "spcatalog":fa=1;break;case "spapp":fa=2;break;case "filesystem":fa=3;break;case "exchange":fa=4;break;case "registry":fa=6;break;case "inmemory":fa=7;break;case "uploadfiledevcatalog":fa=8;break;case "hardcodedpreinstall":fa=9;break;case "excatalog":fa=10;break;case "wopicatalog":fa=16}return fa}function ed(F){var fa=null;switch(F){case 0:fa="omex";break;case 1:fa="spcatalog";break;case 2:fa="spapp";break;case 3:fa="filesystem";break;case 4:fa="exchange";break;case 6:fa="registry";break;
case 7:fa="inmemory";break;case 8:fa="uploadfiledevcatalog";break;case 9:fa="hardcodedpreinstall";break;case 10:fa="excatalog";break;case 16:fa="wopicatalog"}return fa}function Xc(F){var fa={};fa.solutionId=F.solutionId;fa.version=F.version;fa.storeType=F.storeType;fa.storeId=F.storeId;fa.assetId=F.assetId;fa.assetStoreId=F.storeType;fa.targetType=F.targetType;fa.requireConsent=F.requireConsent||!1;fa.isAddinCommands=!0;fa.id=F.solutionId;fa.appVersion=F.version;fa.currentStoreType=F.storeType;return fa}
function ce(){}function Xd(){this.Fm=this.x_=0;this.UTc=null;this.Uoc=this.xyc=0;this.Z1b=this.X1a=this.gra=null}function nd(){this.NXa=null}function je(F,fa){var Pa=ib.call(this)||this;Pa.statusBarManager=null;Pa.agaveCommandManager=null;Pa.hwe=function(){Pa.ZA&&Pa.ZA.Rve()};Pa.m2e=function(){Pa.raiseEvent("LAC")};Pa.Zc=function(yb,Cc){!yb.oc&&ua.b(Cc)&&Pa.statusBarManager&&(Pa.statusBarManager.iF(Pa),Pa.statusBarManager=null)};Pa.ZA=fa;Pa.$=F;Pa.Qxj=F.Ib+"OfficeAddinLabel-Medium14";Pa.$.da.Za(29,
function(yb){Pa.statusBarManager=yb;yb.$I(Pa)});Pa.$.fa.Sj(Pa.Zc);Pa.ZA.dzg(Pa.m2e);Pa.$.da.Za(206,function(yb){Pa.agaveCommandManager=yb;yb.HAg(Pa.hwe)});return Pa}function Xe(){}function Ne(){this.Bi=null;this.visible=!1}function Ig(F,fa){this.Sa=F;this.yYg=fa}function Lf(){this.j_d=this.nCc=null}function Hf(F){this.Cce=new ag(F)}function ag(F){this.Q8=F;this.oUb=this.Q8.ribbonBuilder}function Bg(){var F=Nj.call(this)||this;F.Xjd=null;F.Ejd=null;F.ribbon=null;return F}function uf(){this.zhg=new Gh.a}
function sf(F){return Gk.call(this,F)||this}function xg(F){var fa=this;this.Eqb=null;this.K3c=!1;this.QT=this.ee=null;this.$=F;Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,328,327,1),function(Pa){(Pa=Pa.result)?(Re.ULS.sendTraceTag(537163346,0,50,"DataFromPicturePaneCommandManager::Initialize - AugmentationLoopManager instantiated."),fa.Eqb=new sc(F,Pa),fa.K3c&&(fa.Eqb.YQf(fa.ee,fa.QT),fa.K3c=!1)):Re.ULS.sendTraceTag(537163347,0,10,"DataFromPicturePaneCommandManager::Initialize - Failed to instantiate AugmentationLoopManager.")},
this.$.ma,3)}function sc(F,fa){var Pa=Fk.call(this)||this;Pa.T6e=Sc.getTypeName();Pa.kwb=null;Pa.imageWidth=0;Pa.imageHeight=0;Pa.tableData=null;Pa.errorMessage=null;Pa.nwb=null;Pa.vRc=!1;Pa.gDe=function(yb){if(yb){var Cc={};if(function(){var ff=Bh.d(yb.data);Cc=ff.uu;return ff}().returnValue){var Vc=Object(Wi.a)(Object,Cc);if("."===Vc.DataFromPictureWildcard)if(Vc.SessionId!==Pa.nwb)Re.ULS.sendTraceTag(537163345,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");
else switch(Vc.CmdType){case "ACK":Pa.vRc=!0;Pa.sfj();0<Pa.errorMessage.length?Pa.wTf():0<Pa.tableData.length&&Pa.NTf();break;case "insert_html":Re.ULS.sendTraceTag(537163344,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane");var rd=Pa.$.qa.ta,Hd={},te=Rh.g(Pa.$).ha.va.Qd.clone();Hd.PasteId=bj.a.create().toString();Hd.DestinationRanges=Xj.s(Xj.v(te,Pa.$));Hd.SourceHtml=Vc.Parameters;Hd.CopyOperationId=null;var hf=rd.Oa(1,rd.Xb());
hf.pasteHtmlParameters=Hd;xk.a(Pa.$.userOperationManager,function(ff,lg,Og){return Oi.i(rd,"pasteHtmlContent",hf,ff,lg,Og,null,64)},function(ff){return new rk.a(204,0,ff,1)},null)}}}};Pa.M1h=function(yb,Cc){if(yb=Cc.aY)if(!Cc.parentPath||1>=Cc.parentPath.length||Cc.parentPath[1]!==Pa.nwb)Re.ULS.sendTraceTag(537163335,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{Cc=yb.errorCode;switch(Cc){case null:case -1:Pa.errorMessage=
De.a.instance.ea(2196);break;case 1:Pa.errorMessage=De.a.instance.ea(2197);break;case 2:Pa.errorMessage=De.a.instance.ea(2198)}0<Pa.errorMessage.length&&Re.ULS.sendTraceTag(537163334,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",Cc?Cc.toString():"null");Pa.tableData=yb.html;Pa.vRc&&(0<Pa.errorMessage.length?Pa.wTf():0<Pa.tableData.length&&Pa.NTf())}else Re.ULS.sendTraceTag(537163336,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};
Pa.$=F;Pa.augmentationLoopManager=fa;Pa.initialize();return Pa}function Sc(){var F=lk.call(this)||this;F.errorCode=null;F.errorDescription=null;F.html=null;F.H_=Object.assign(new Pk.a,{T_:Sc.getTypeName(),B_:Sc.qe()});return F}function Qc(F){var fa=Ok.call(this)||this;fa.$=F;fa.dc();return fa}function ie(F,fa){var Pa=Rc.call(this)||this;Pa.$=F;Pa.eta=new DOMParser;Pa.cache=new hj.a;Pa.indexedDB=fa;fa.og()&&Pa.indexedDB.initialize("Scripts","OfficeScriptingCache");Pa.o4=!1;Pa.Jm=new pe([],function(yb){Rc.p1f(yb)});
Pa.eg=new pe([],function(yb){Rc.kKb(yb)});Pa.ir=new pe([],function(yb){Rc.kKb(yb)});Pa.Lk=new pe([],function(){});return Pa}function ue(F,fa,Pa){var yb=this;this.U5a=!1;this.a8a=function(){yb.gZf()?(yb.sEf(),Rh.g(yb.$).Ca.AGd(yb.a8a)):yb.U5a&&Rh.g(yb.$).Ca.AGd(yb.a8a)};this.aBi=function(Cc,Vc){Object.getType(Vc)===String&&Vc.toString().endsWith(zf.a.Cub(yb.$))&&(yb.U5a=!1)};this.$=F;this.Bra=fa;this.Dv=Pa;this.enj()}function Ce(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.lyc=this.waa=this.Vj=
null}function Be(F,fa,Pa,yb,Cc,Vc,rd,Hd,te,hf){var ff=this;this.Zz=null;this.cache=new hj.a;this.G4d=this.Ube=this.Wbe=this.Tbe=this.Vbe=this.Sbe=this.$va=!1;this.sbe=this.cde=this.$$d=this.Cbe=null;this.pFa={};this.$=F;this.WNc=Pa;this.indexedDB=yb;this.Bnb=Cc;this.Dv=Vc;this.Bra=rd;this.Je=Hd;this.fP=zf.a.xq?te:new Wc(F,this);this.IIg=new bf(this,F);this.Slg=Hh.a.Ra.Kb;this.F2f="";this.businessBarManager=hf;this.o4=!1;this.Kmj(new pe([],function(lg){Rc.p1f(lg)}));this.Jmj(new pe([],function(lg){Rc.kKb(lg)}));
this.Nmj(new pe([],function(lg){Rc.kKb(lg)}));this.Lmj(new pe([],function(){}));yb.og()&&(this.$va=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));F=!0;if(uh.a.Lre){this.cache.og()&&(fa=this.tbd(zf.a.E9b(this.$)),fa.isSuccess&&(F=ji.getElapsedSeconds(fa.timeStamp,Hh.a.Ra.Kb),this.Dv.Gx=new kc(!0,!0),this.Zz=new kc(fa.value,!0),F=this.Zz.value?604800<F:86400<F,this.Avb=this.yJb(!0)));this.Lgi=ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery");
this.vCh();if("undefined"!==typeof makerstorage&&this.Ref)if(this.F2f=Bc(this.$),nc(this.$))ye(this.$,"localstorageToken"),this.Dv.Gx=new kc(!0,!0),this.Zz=new kc(!0,!0),this.Avb=this.yJb(!0);else if((fa=zf.a.XXe())&&makerstorage.setStorageEnvironmentOverride(fa),F)try{this.Avb=this.Dv.Ave().then(function(){return ff.Bra.W$b()}).then(function(lg){return ff.kZh(lg)}).then(function(){return ff.yJb(!1)}).catch(function(){return ff.yJb(!1)})}catch(lg){Re.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",
lg.message),this.Avb=Promise.resolve(!1)}ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Avb?this.Avb.then(function(lg){return ff.JHd(lg)}):this.JHd(!1)}else Re.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.JHd(!1)}function le(F,fa,Pa,yb,Cc){this.actionName=F;this.shapeId=fa;this.yza=Pa;this.Z0b=yb;this.aba=Cc}function hc(F,fa,Pa,yb){this.hid=F;this.xsh=
fa;this.iya=Pa;this.GGa=yb}function gd(F){return Of.a.Gd(F)?Yc.a.fLe:Yc.a.eLe}function xd(F){return Of.a.Gd(F)?F.isChromeRtl?Yc.a.gmh:Yc.a.fmh:Yc.a.tIa}function re(F){F=F.qa.ta.Oa(1);F.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return F}function Jc(F,fa,Pa,yb,Cc){function Vc(){function lg(Og,lh,Ih){return Oi.i(Hd.ta,"ExecuteRichApiRequest",
yb,oi.b(Og,fa),oi.a(lh,Pa),Ih,null,0)}if(rd.MGa()||0<Hd.ta.G3||0<Hd.Ek.G3)return!1;te&&rd.pz(te);hf&&Hd.Lt(hf);ff&&Hd.VC(ff);ig.EwaSettings.tc()?rd.tt(new rk.a(507,0,lg,80)):rd.tt(new Bj.a(507,0,lg,16));return!0}var rd=F.userOperationManager,Hd=F.qa,te=null,hf=null,ff=null;Vc()||(te=function(){Vc()},hf=function(){Vc()},ff=function(){Vc()},rd.uy(te),Hd.us(hf),Hd.FB(ff));return Cc.task}function Bc(F){if(nc(F))return ig.EwaSettings.getBooleanFeatureGate(zf.a.yAb,!1)?"makerservicelocal":"localstorage";
F=zf.a.XXe();return zf.a.dSh(F)}function ye(F,fa){nc(F)&&(ig.EwaSettings.getBooleanFeatureGate(zf.a.yAb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(F.ya.UserSessionId);makerstorage.setUserAccessInfo(new Nc(fa,null));ig.EwaSettings.getBooleanFeatureGate(zf.a.Hag,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function cb(F,fa){fa.WacTaskPaneInfra=Of.a.Gd(F);fa.PipeEnableExtractPermission=ig.EwaSettings.getBooleanFeatureGate(zf.a.NQi,
!1);fa.UseV1ServiceURLs=ig.EwaSettings.getBooleanFeatureGate(zf.a.Hag,!1);fa.TaskpanelessRFB=ig.EwaSettings.getBooleanFeatureGate(zf.a.y4f,!1)}function nc(F){return"TestHost"===F.ya.DocumentHostInfo.HostTier}function Nc(F,fa){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=F;this.currentUserMlapiToken=fa}function Rc(){this.Lk=null;this.o4=this.q6=this.Ss=this.p6=this.Qya=this.s$a=this.pEd=this.uca=this.iva=!1;this.ir=this.eg=this.Jm=null}function Wc(F,fa){this.Ux=null;
this.$=F;this.automateCommandManager=fa;return this}function fe(){}function ve(){this.Gx=null;return this}function kc(F,fa,Pa,yb,Cc){this.value=F;this.isSuccess=fa;this.timeStamp=void 0===Pa?null:Pa;this.errorCode=void 0===yb?"":yb;this.errorMessage=void 0===Cc?"":Cc}function ad(){this.Gx=null}function yd(F,fa){this.Ux=null;this.$=F;this.Je=fa;return this}function wd(F){this.i$=Cg.b(F)||{};this.cD=this.cD||null}function pe(F,fa){this.scripts=F;this.o1f=fa}function bf(F,fa){this.automateCommandManager=
F;this.$=fa}function Af(){this.Ux=null}function bg(F,fa,Pa){this.$=F;this.oAuthManager=fa;this.Dv=Pa;this.wnb=new og;this.hqe=this.oAuthManager&&null==this.oAuthManager.gLa()?!1:this.oAuthManager.gLa()}function og(){this.token=null;this.timeStamp=0}function Zf(F){return Ck.call(this,F)||this}function If(F,fa){this.automateCommandManager=F;this.$=fa}function qg(F){var fa=Mi.call(this)||this;fa.$=F;fa.dc();return fa}function Vf(F){this.Db=null;this.$=F}function Fe(){return Sd.call(this)||this}function zg(){return Sd.call(this)||
this}function Yf(){return Sd.call(this)||this}function jg(){return Sd.call(this)||this}function Ff(){return Sd.call(this)||this}function de(){return Sd.call(this)||this}function Tf(){return Sd.call(this)||this}function Ve(){return Sd.call(this)||this}function We(){return Sd.call(this)||this}function Sf(){return Sd.call(this)||this}function vg(){return Sd.call(this)||this}function kh(){return Sd.call(this)||this}function Pg(){return Sd.call(this)||this}function qf(){return Sd.call(this)||this}function ih(){return Sd.call(this)||
this}function Qa(){return Sd.call(this)||this}function qb(){return Sd.call(this)||this}function tc(){return Sd.call(this)||this}function fd(){return Sd.call(this)||this}function Rd(){return Sd.call(this)||this}function zd(){return Sd.call(this)||this}function xe(){return Sd.call(this)||this}function me(){return Sd.call(this)||this}function mf(){return Sd.call(this)||this}function df(){return Sd.call(this)||this}function rf(){return Sd.call(this)||this}function Mg(){return Sd.call(this)||this}function lf(){return Sd.call(this)||
this}function $f(){return Sd.call(this)||this}function dg(){return Sd.call(this)||this}function yf(){return Sd.call(this)||this}function Hg(){return Sd.call(this)||this}function Df(){return Sd.call(this)||this}function xc(){return Sd.call(this)||this}function dd(){return Sd.call(this)||this}function Cd(){return Sd.call(this)||this}function Ld(){return Sd.call(this)||this}function Od(){return Sd.call(this)||this}function ef(){return Sd.call(this)||this}function Xf(){return Sd.call(this)||this}function Qf(){return Sd.call(this)||
this}function gg(){return Sd.call(this)||this}function Ba(){return Sd.call(this)||this}function Ob(){return Sd.call(this)||this}function Ec(){return Sd.call(this)||this}function od(){return Sd.call(this)||this}function Md(){return Sd.call(this)||this}function He(){return Sd.call(this)||this}function Qe(){return Sd.call(this)||this}function Bf(){return Sd.call(this)||this}function Uf(){return Sd.call(this)||this}function Ea(){return Sd.call(this)||this}function ob(){return Sd.call(this)||this}function ac(){return Sd.call(this)||
this}function vc(){return Sd.call(this)||this}function nb(){return Sd.call(this)||this}function fc(){return Sd.call(this)||this}function $d(){return vf.call(this,195,16)||this}function Id(){return vf.call(this,194,8)||this}function Me(){return Sd.call(this)||this}function se(){return vf.call(this,198,2)||this}function td(){return vf.call(this,197,1)||this}function af(){return vf.call(this,196,32)||this}function Fd(){return Sd.call(this)||this}function wf(){return vf.call(this,193,4)||this}function vf(F,
fa){var Pa=Sd.call(this)||this;Pa.Pea=F;Pa.FWd=fa;return Pa}function pg(){return Sd.call(this)||this}function sg(){return Sd.call(this)||this}function Ze(){return Sd.call(this)||this}function Lg(){return Sd.call(this)||this}function hg(){return Sd.call(this)||this}function ud(){return Sd.call(this)||this}function xf(){return Cf.call(this,11,16)||this}function Nh(){return Cf.call(this,10,128)||this}function Fg(){return Sd.call(this)||this}function mh(){return Sd.call(this)||this}function ld(){return Sd.call(this)||
this}function mg(){return Sd.call(this)||this}function hh(){return Sd.call(this)||this}function $e(){return Sd.call(this)||this}function Qg(){return Sd.call(this)||this}function ch(){return Sd.call(this)||this}function wg(){return Sd.call(this)||this}function Gi(){return Cf.call(this,9,2)||this}function mi(){return Cf.call(this,8,1)||this}function ph(){return Cf.call(this,7,8)||this}function Ng(){return Cf.call(this,6,32)||this}function ai(){return Sd.call(this)||this}function Zg(){return Sd.call(this)||
this}function ni(){return Sd.call(this)||this}function yh(){return Sd.call(this)||this}function fh(){return Sd.call(this)||this}function yi(){return Sd.call(this)||this}function ei(){return Sd.call(this)||this}function la(){return Sd.call(this)||this}function kb(){return Sd.call(this)||this}function Xb(){return Sd.call(this)||this}function Dc(){return Sd.call(this)||this}function xb(){return Sd.call(this)||this}function jd(){return Sd.call(this)||this}function ke(){return Sd.call(this)||this}function Ge(){return Cf.call(this,
4,64)||this}function cf(){return Sd.call(this)||this}function kf(){return Sd.call(this)||this}function jf(){return Sd.call(this)||this}function Ef(){return Sd.call(this)||this}function ya(){return Sd.call(this)||this}function qa(){return Sd.call(this)||this}function ub(){return Sd.call(this)||this}function Dd(){}function be(){return Sd.call(this)||this}function Je(){return Cf.call(this,3,4)||this}function Cf(F,fa){var Pa=Sd.call(this)||this;Pa.Pea=F;Pa.FWd=fa;return Pa}function Jg(){return Sd.call(this)||
this}function $g(){return Sd.call(this)||this}function Tg(){return Sd.call(this)||this}function Dh(){return Sd.call(this)||this}function Mh(){return ha.call(this,185,18)||this}function Oh(){return Sd.call(this)||this}function Li(){return ha.call(this,181,14)||this}function Th(){return ha.call(this,169,2)||this}function Rg(){return ha.call(this,168,1)||this}function $h(){return Sd.call(this)||this}function gi(){return ha.call(this,182,15)||this}function Ae(){return Sd.call(this)||this}function Xh(){return Sd.call(this)||
this}function qi(){return ha.call(this,180,13)||this}function h(){return ha.call(this,186,19)||this}function Ab(){return ha.call(this,175,8)||this}function jc(){return ha.call(this,176,9)||this}function Oc(){return ha.call(this,187,20)||this}function sd(){return ha.call(this,174,7)||this}function we(){return ha.call(this,179,12)||this}function Ue(){return ha.call(this,178,11)||this}function qe(){return ha.call(this,177,10)||this}function ja(){return Sd.call(this)||this}function Ka(){return ha.call(this,
170,3)||this}function qc(){return ha.call(this,172,5)||this}function mc(){return ha.call(this,173,6)||this}function Ed(){return ha.call(this,183,16)||this}function pc(){return ha.call(this,184,17)||this}function K(){return ha.call(this,171,4)||this}function ha(F,fa){var Pa=Sd.call(this)||this;Pa.Pea=F;Pa.opType=fa;return Pa}function H(){return Sd.call(this)||this}function aa(){return Sd.call(this)||this}function ea(){return Sd.call(this)||this}function ab(){return Sd.call(this)||this}function Vb(){return Sd.call(this)||
this}function gc(){return Sd.call(this)||this}function $c(){return Sd.call(this)||this}function Zd(){return Sd.call(this)||this}function oe(){return Sd.call(this)||this}function Ee(){return Sd.call(this)||this}function pf(){return Sd.call(this)||this}function Le(){return Sd.call(this)||this}function ng(){return Sd.call(this)||this}function eg(){return Sd.call(this)||this}function eh(){return Sd.call(this)||this}function Yg(){return Sd.call(this)||this}function th(){return Sd.call(this)||this}function rh(){return Sd.call(this)||
this}function nf(){return Sd.call(this)||this}function bh(){return Sd.call(this)||this}function xh(){return Sd.call(this)||this}function Ag(){return kg.call(this)||this}function bi(){return Sd.call(this)||this}function Ti(){return Sd.call(this)||this}function Qi(){return Sd.call(this)||this}function jj(){return Sd.call(this)||this}function vh(){return Sd.call(this)||this}function Bi(){return Sd.call(this)||this}function li(){return Sd.call(this)||this}function T(){return Sd.call(this)||this}function Oa(){return Sd.call(this)||
this}function Kb(){return Xg.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function ic(){return Xg.call(this,79,[0,1,2,-102])||this}function pd(){return Xg.call(this,75,[-101])||this}function Td(){return Xg.call(this,81,[100,101,102,103,104,105,106])||this}function Gd(){return Sd.call(this)||this}function ge(){return Xg.call(this,85,[328,329,330,331,332,333,334,335])||
this}function Pe(){return kg.call(this)||this}function gf(F,fa,Pa){this.response=this.request=this.eventId=this.source=null;F&&(this.source=F.source,this.eventId=F.eventId,this.request=fa,this.response=Pa)}function kg(){return Sd.call(this)||this}function cg(){return Xg.call(this,83,[500,501,502])||this}function Wg(){return Xg.call(this,76,[-100])||this}function tg(){return Xg.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Jh(){return Xg.call(this,80,[-104,-103,300,301,
302,303,304,305,306,307,308,309,310,311])||this}function Fh(){return Xg.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Xg(F,fa){var Pa=Sd.call(this)||this;Pa.Pea=F;Pa.$Mj=fa;return Pa}function hi(){return Sd.call(this)||this}function Ci(){return Sd.call(this)||this}function Di(){return Sd.call(this)||this}function nh(){return Sd.call(this)||this}function Sd(){this.jGc=this.kGc=this.oMc=this.RQc=null}function Cj(F,fa,Pa){var yb=this;this.h8b=null;this.Qpi=function(Cc,
Vc){yb.hZf()&&yb.d$c(Vc)};this.hlf=fa;this.glf=Pa;this.$=F;this.$.Xaa&&this.$.xBg(this.Qpi);F.da.Ha(297,this)}function Pf(){}function X(){}function ta(){this.yfb=null}function tb(){this.rb=null}function Rb(F){this._initialized=!1;this.f9a={};this.Zwc={};this.fI=fg.AFrameworkApplication.sa.fD;this.gid=F}function Fc(F,fa,Pa){this.expiration=this.authority=this.accessToken=null;this.accessToken=F;this.authority=fa;this.expiration=Pa}function lc(){this.authority=this.email=this.displayName=null;this.authority=
this.email=this.displayName=""}function Jd(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function he(){}function Te(F,fa){this.requestCallback=this.requestParameters=null;this.requestParameters=F;this.requestCallback=fa}function yg(){}b.r(D);var Kg=b(514),Ug=b(1093),ae=b(0),Re=b(13),Ri=b(80),yj;(function(F){F[F.generalException=
0]="generalException";F[F.invalidArgument=1]="invalidArgument";F[F.notAllowed=2]="notAllowed";F[F.apiNotAvailable=3]="apiNotAvailable";F[F.unresolvedPendingRequest=4]="unresolvedPendingRequest";F[F.timeout=5]="timeout";F[F.adalTimeout=6]="adalTimeout";F[F.userNotSignedIn=7]="userNotSignedIn";F[F.userAborted=8]="userAborted";F[F.silentSignInFailed=9]="silentSignInFailed";F[F.invalidResourceUrl=10]="invalidResourceUrl";F[F.invalidGrant=11]="invalidGrant";F[F.connectionLost=12]="connectionLost";F[F.clientError=
13]="clientError";F[F.serverError=14]="serverError"})(yj||(yj={}));Object(ae.b)("ErrorCodes",yj);yg.qBf="OneDriveWOPI";Object(ae.a)(yg,"HostApplicationType",null,[]);Object(ae.a)(Te,"OutstandingRequest",null,[]);he.Kvi="AADSTS50058";he.invalidResourceUrl="AADSTS50001";he.Evi="AADSTS65001";he.Vvi="AADSTS70011";he.userAborted="13002";he.jSi="Popup Window is null";he.iSi="Popup Window closed";he.adalTimeout="Token renewal operation failed due to timeout";he.YCj="tokenRevoked";Object(ae.a)(he,"WopiHostErrorType",
null,[]);var fg=b(5),Dj=b(857),tj=b(592),Bh=b(38);Jd.iDh=function(F){switch(F){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(ae.a)(Jd,"WopiAuthContext",null,[257]);Object(ae.a)(lc,"WopiIdentityInfo",null,[256]);Object(ae.a)(Fc,"WopiIdentityToken",null,[255]);var uh=b(23),Ph=b(143),ah=b(371),zj=b(170),Rf=b(75),ti=b(338);Rb.prototype.R0a=function(F){this._initialized||(F.Pn(zj.a.gEf),F.Km(zj.a.gEf,Object(Ri.a)(this,this.JIi,"onReceivedAccessToken")),
this._initialized=!0)};Rb.prototype.getAccessToken=function(F,fa,Pa){var yb=this;Pa=void 0===Pa?null:Pa;this.VMa(F,fa);return new Promise(function(Cc,Vc){if(yb.Ekd(fa))if(fa in yb.f9a)Vc("unresolvedPendingRequest");else{var rd=window.setTimeout(function(){var te={};Re.ULS.sendTraceTag(37856032,344,10,Bh.c((te.error="Request timeout.",te.callerId=fa,te)));Vc("timeout")},12E4);yb.Vad(F,fa,Pa,function(te,hf){window.clearTimeout(rd);te?Cc(te):(te={},Re.ULS.sendTraceTag(37856033,369,15,Bh.c((te.error=
yj[hf],te))),Vc(hf))})}else{var Hd={};Re.ULS.sendTraceTag(37856034,344,10,Bh.c((Hd.error="Caller is not allowed.",Hd)));Vc("notAllowed")}})};Rb.prototype.getPrimaryIdentityInfo=function(F){var fa=this;return new Promise(function(Pa,yb){if(fa.Ekd(F))fa.LOh(function(Vc,rd){Vc?Pa(Vc):(Vc={},Re.ULS.sendTraceTag(37856064,369,10,Bh.c((Vc.error=rd.toString(),Vc))),yb(rd))});else{var Cc={};Re.ULS.sendTraceTag(37856065,344,10,Bh.c((Cc.error="Caller is not allowed.",Cc)));yb("notAllowed")}})};Rb.prototype.getAuthContext=
function(F){var fa=this;return new Promise(function(Pa,yb){var Cc=fa.getAuthContextSync(F);Cc?Pa(Cc):yb("notAllowed")})};Rb.prototype.getAuthContextSync=function(F){if(this.Ekd(F)){var fa=new Jd;fa.upn=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");fa.userId=fg.AFrameworkApplication.ga.Ua("LoggableUserId");fa.authority=fg.AFrameworkApplication.ga.Ua("HostAuthAuthority");fa.tenantId=fg.AFrameworkApplication.ga.Ua("TenantId");fa.isAnonymous=fg.AFrameworkApplication.ga.ra("IsAnonymousUser");fa.supportsAuthToken=
this.N0h(F);F=fg.AFrameworkApplication.ga.Ua("HostAuthType");fa.authorityType="aad"===F.toLowerCase()?2:"msa"===F.toLowerCase()?1:0;return fa}fa={};Re.ULS.sendTraceTag(40751647,344,10,Bh.c((fa.error="Caller is not allowed.",fa)));return null};Rb.prototype.N0h=function(F){var fa=Dj.a.awb;return uh.a.qka?fa&&Dj.a.D4f?Array.contains(Dj.a.D4f,F.toLowerCase()):!1:fa};Rb.prototype.Vad=function(F,fa,Pa,yb){var Cc=this,Vc=[];Array.add(Vc,Object.assign(new Rf.a,{name:"CallerId",string:fa}));Array.add(Vc,Object.assign(new Rf.a,
{name:ah.a.BQd,string:F.correlationId}));Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Vc}));Vc=tj.a.create().toString();var rd="getAccessToken_"+Vc,Hd=this.fI.Fc("ComponentAttach",rd);this.Zwc[rd]=Hd;var te={};te[ah.a.CQd]=Vc;te[ah.a.Ewj]=F.resource;te[ah.a.Fwj]=F.scope;te[ah.a.F1f]=fg.AFrameworkApplication.ga.Ua("HostAuthType");te[ah.a.Iwj]=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");te[ah.a.Gwj]=F.silentLogin;
te[ah.a.Bwj]=F.options;te[ah.a.BQd]=F.correlationId;te[ah.a.Cwj]=fa;Pa&&(te[ah.a.addinName]=Pa.AddinName,te[ah.a.Awj]=Pa.AddinTrustId);this.gid.execute(function(hf){Cc.R0a(hf);hf.Qj(zj.a.getAuthToken,te)});this.f9a[Vc]=new Te(F,yb)};Rb.prototype.LOh=function(F){var fa=fg.AFrameworkApplication.ga.Ua("UserName"),Pa=fg.AFrameworkApplication.ga.Ua("UserPrincipalName"),yb=fg.AFrameworkApplication.ga.Ua("LoggableUserIdSpace"),Cc=new lc;Cc.email=Pa;Cc.displayName=fa;switch(yb){case "OrgIdPuid":Cc.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Cc.authority="MicrosoftAccount";break;default:Cc.authority=yb}F(Cc,null)};Rb.prototype.JIi=function(F){var fa=null;try{var Pa=F.Values[ah.a.CQd],yb=F.Values[ah.a.zwj],Cc=F.Values[ah.a.F1f],Vc=F.Values[ah.a.Hwj],rd=null,Hd=null,te=this.f9a[Pa];if("undefined"!==typeof te&&te){var hf=[];Array.add(hf,Object.assign(new Rf.a,{name:ah.a.BQd,string:te.requestParameters.correlationId}));Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:hf}));fa=te.requestCallback;delete this.f9a[Pa];"undefined"!==typeof yb&&yb&&yb.length?Hd=new Fc(yb,Cc,Vc):rd=yj[this.Fqi(F)];Pa="getAccessToken_"+Pa;Pa in this.Zwc&&(this.Zwc[Pa].stop(),delete this.Zwc[Pa]);fa(Hd,rd)}else rd={},Re.ULS.sendTraceTag(37856066,344,10,Bh.c((rd.error="No matching outstanding request for request ID.",rd.requestId=Pa,rd)))}catch(ff){F=F.Values[ah.a.CQd],F in this.f9a&&delete this.f9a[F],this.oic(),F={},Re.ULS.sendTraceTag(37856067,344,10,Bh.c((F.error=ff.message,
F.stack=ff.stack,F))),fa&&fa(null,"generalException")}};Rb.prototype.Ekd=function(F){var fa=fg.AFrameworkApplication.lVh();F=F.toLowerCase();fa=yl(fa);for(var Pa=fa.next();!Pa.done;Pa=fa.next())if(F===Pa.value.toLowerCase())return!0;fa=Dj.a.EUc;for(var yb in fa)if(F===fa[yb].toLowerCase())return!0;return!1};Rb.prototype.Fqi=function(F){F=F.Values[ah.a.Dwj];this.oic();var fa={};Re.ULS.sendTraceTag(39068821,344,15,Bh.c((fa.error=F,fa)));return F?-1<F.indexOf(he.Kvi)?9:-1<F.indexOf(he.jSi)||-1<F.indexOf(he.iSi)?
12:-1<F.indexOf(he.invalidResourceUrl)?10:-1<F.indexOf(he.userAborted)?8:-1<F.indexOf(he.Vvi)||-1<F.indexOf(he.Evi)||F===he.YCj?11:-1<F.indexOf(he.adalTimeout)?6:0:13};Rb.prototype.VMa=function(F,fa){F=this.A_i(F.resource);var Pa={};Re.ULS.sendTraceTag(39921882,344,50,Bh.c((Pa.callerId=fa,Pa.resource=F,Pa)))};Rb.prototype.oic=function(){var F={};Re.ULS.sendTraceTag(39068822,344,50,Bh.c((F.userAgent=window.navigator.userAgent,F)))};Rb.prototype.A_i=function(F){return(F?F:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")};Object(ae.a)(Rb,"WopiIdentityManager",null,[233]);var Zj=b(274);tb.prototype.di=function(F){this.rb=F;F.register(Rb,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").zc().Ic(function(){return new Rb(F.mc("Postmessage.IHostPostmessenger"))})};tb.prototype.init=function(){fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.$v(Object(Ri.a)(this,this.QA,"onFullAppSettingsReady"))};tb.prototype.QA=function(){try{this.rb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(F){Re.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+F)}};tb.prototype.dispose=function(){};tb.main=function(){Zj.a.instance.mj(new tb)};tl.Object.defineProperties(tb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(ae.a)(tb,"WopiIdentityPackage",null,[4,5]);var uj=b(10),lj=b(216),Gh=b(185),fi=b(604);ta.prototype.Y8h=function(F){return this.iJg.contains(F.operation)};ta.prototype.yGj=function(F){for(var fa=[],Pa=yl(F.payload.batchedOperations),
yb=Pa.next();!yb.done;yb=Pa.next())fa.push(new fi.a(F.operation,yb.value));return fa};tl.Object.defineProperties(ta.prototype,{iJg:{configurable:!0,enumerable:!0,get:function(){this.yfb||(this.yfb=new Gh.a,this.yfb.add(12),this.yfb.add(11));return this.yfb}}});Object(ae.a)(ta,"MacroRecorderBatchedEventList",null,[]);var wi=b(52),ej=b(120),gj=b(686);X.prototype.equals=function(F,fa){return F===fa};X.prototype.getHashCode=function(F){return F};X.prototype.Via=function(F){return F};Object(ae.a)(X,"UserOperationNameComparer",
null,[22,23]);Pf.jVh=function(){Pf.Oc||(Pf.Oc=new gj.a(new X),Pf.Oc.add(507),Pf.Oc.add(10),Pf.Oc.add(576),Pf.Oc.add(563),Pf.Oc.add(564),Pf.Oc.add(565),Pf.Oc.add(566),Pf.Oc.add(567),Pf.Oc.add(568),Pf.Oc.add(569),Pf.Oc.add(570),Pf.Oc.add(571),Pf.Oc.add(572),Pf.Oc.add(573),Pf.Oc.add(574),Pf.Oc.add(575),Pf.Oc.add(501),Pf.Oc.add(520),Pf.Oc.add(1),Pf.Oc.add(1002),Pf.Oc.add(129),Pf.Oc.add(198),Pf.Oc.add(500),Pf.Oc.add(519),Pf.Oc.add(538),Pf.Oc.add(1E3),Pf.Oc.add(1003),Pf.Oc.add(144),Pf.Oc.add(502),Pf.Oc.add(505),
Pf.Oc.add(179),Pf.Oc.add(205),Pf.Oc.add(134),Pf.Oc.add(230),Pf.Oc.add(103),Pf.Oc.add(110),Pf.Oc.add(112),Pf.Oc.add(113),Pf.Oc.add(124),Pf.Oc.add(133),Pf.Oc.add(154),Pf.Oc.add(162),Pf.Oc.add(168),Pf.Oc.add(172),Pf.Oc.add(201),Pf.Oc.add(222),Pf.Oc.add(227),Pf.Oc.add(513),Pf.Oc.add(534),Pf.Oc.add(539),Pf.Oc.add(545),Pf.Oc.add(547),Pf.Oc.add(555),Pf.Oc.add(558),Pf.Oc.add(562),Pf.Oc.add(585),Pf.Oc.add(1001),Pf.Oc.add(1005),Pf.Oc.add(1008),Pf.Oc.add(1010),Pf.Oc.add(1011),Pf.Oc.add(1012),Pf.Oc.add(1018),
Pf.Oc.add(252),Pf.Oc.add(253),Pf.Oc.add(258),Pf.Oc.add(101),Pf.Oc.add(102),Pf.Oc.add(108),Pf.Oc.add(118),Pf.Oc.add(257),Pf.Oc.add(119),Pf.Oc.add(120),Pf.Oc.add(123),Pf.Oc.add(126),Pf.Oc.add(127),Pf.Oc.add(130),Pf.Oc.add(140),Pf.Oc.add(159),Pf.Oc.add(160),Pf.Oc.add(165),Pf.Oc.add(166),Pf.Oc.add(167),Pf.Oc.add(169),Pf.Oc.add(189),Pf.Oc.add(223),Pf.Oc.add(214),Pf.Oc.add(228),Pf.Oc.add(233),Pf.Oc.add(247),Pf.Oc.add(504),Pf.Oc.add(511),Pf.Oc.add(512),Pf.Oc.add(525),Pf.Oc.add(533),Pf.Oc.add(537),Pf.Oc.add(542),
Pf.Oc.add(544),Pf.Oc.add(548),Pf.Oc.add(550),Pf.Oc.add(551),Pf.Oc.add(552),Pf.Oc.add(554),Pf.Oc.add(577),Pf.Oc.add(584),Pf.Oc.add(586),Pf.Oc.add(587),Pf.Oc.add(588),Pf.Oc.add(592),Pf.Oc.add(1009),Pf.Oc.add(1016),Pf.Oc.add(1017));return Pf.Oc};Pf.Oc=null;Object(ae.a)(Pf,"MacroRecorderUnrecognizedEventList",null,[]);Cj.prototype.init=function(F){this.$.Xaa&&(F?this.h8b=F:Re.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Cj.prototype.d$c=
function(F){if(this.hZf())try{if(this.glf.Y8h(F))for(var fa=this.glf.yGj(F),Pa=yl(fa),yb=Pa.next();!yb.done;yb=Pa.next())this.QQe(yb.value);else this.QQe(F)}catch(Cc){F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",ej.a(F.operation),Cc.stack),Re.ULS.sendTraceTag(537155423,0,10,F)}};Cj.prototype.QQe=function(F){var fa=this.hlf.VXe(F,!0);fa?(this.h8b(fa.eventId,wi.a.Hc(F.payload)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
fa.eventId),Re.ULS.sendTraceTag(537155422,0,50,F)):(fa=this.hlf.VXe(F,!1))?(F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",fa.eventId),Re.ULS.sendTraceTag(537155421,0,50,F)):Pf.jVh().contains(F.operation)||(this.h8b(0,wi.a.Hc(F.operation)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",ej.a(F.operation)),Re.ULS.sendTraceTag(537155420,0,50,F))};Cj.prototype.hZf=function(){return this.$.gka&&this.h8b&&
this.$.Taa?!0:!1};Object(ae.a)(Cj,"MacroRecorderEventHandler",null,[287]);var ig=b(1);Sd.prototype.ng=function(){};Sd.prototype.bV=function(){};Sd.prototype.xd=function(F){this.CAc.add(F)};Sd.prototype.Tb=function(F){this.operations.contains(F)||this.operations.add(F)};Sd.prototype.Vlb=function(){this.featureGates.add(704)};Sd.prototype.WEa=function(F){this.jPe.add(F)};tl.Object.defineProperties(Sd.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.oMc||(this.oMc=new Gh.a,this.fc());
return this.oMc}},CAc:{configurable:!0,enumerable:!0,get:function(){this.RQc||(this.RQc=new Gh.a,this.ng());return this.RQc}},jPe:{configurable:!0,enumerable:!0,get:function(){this.jGc||(this.jGc=new Gh.a);return this.jGc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.kGc||(this.kGc=new Gh.a,this.bV());return this.kGc}}});Object(ae.a)(Sd,"MacroRecorderEventBase",null,[]);vm(nh,Sd);nh.prototype.fc=function(){this.Tb(100)};tl.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 130}}});Object(ae.a)(nh,"AccessibilityCheckRunEvent",Sd,[]);vm(Di,Sd);Di.prototype.fc=function(){this.Tb(241)};Di.prototype.ng=function(){this.xd(function(F){return F.addToPrintArea})};tl.Object.defineProperties(Di.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(ae.a)(Di,"AddedToPrintAreaEvent",Sd,[]);vm(Ci,Sd);Ci.prototype.fc=function(){this.Tb(516)};tl.Object.defineProperties(Ci.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 65}}});Object(ae.a)(Ci,"AutoFilterToggledEvent",Sd,[]);vm(hi,Sd);hi.prototype.fc=function(){this.Tb(502)};hi.prototype.ng=function(){this.xd(function(F){return!(F.d3a().FirstColumn===F.d3a().LastColumn&&F.d3a().FirstRow===F.d3a().LastRow)})};tl.Object.defineProperties(hi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(ae.a)(hi,"AutoSumEvent",Sd,[]);vm(Xg,Sd);Xg.prototype.fc=function(){this.Tb(529);this.Tb(594)};Xg.prototype.ng=function(){var F=
this;this.xd(function(fa){return Array.contains(F.$Mj,fa.Udd())})};tl.Object.defineProperties(Xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object(ae.a)(Xg,"ChartPropertyAppliedEventBase",Sd,[]);vm(Fh,Xg);Object(ae.a)(Fh,"ChartAxisChangedEvent",Xg,[]);vm(Jh,Xg);Object(ae.a)(Jh,"ChartAxisTitleChangedEvent",Xg,[]);vm(tg,Xg);Object(ae.a)(tg,"ChartDataLabelsChangedEvent",Xg,[]);vm(Wg,Xg);Object(ae.a)(Wg,"ChartDataSelectedEvent",Xg,[]);vm(cg,Xg);Object(ae.a)(cg,
"ChartDataTableChangedEvent",Xg,[]);var Hj=b(574),rj=b(408),Wi=b(84);vm(kg,Sd);Object(ae.a)(kg,"RichApiRequestExecutedEventBase",Sd,[]);tl.Object.defineProperties(gf.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(ae.a)(gf,"MacroRecorderRichApiRequestExecutedPayload",null,[98]);vm(Pe,kg);Pe.prototype.FE=function(F){Pe.u6||(Pe.u6=new gj.a(Hj.a.Ik()),Pe.u6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Pe.u6.add("fa000000014"));return!!F&&Pe.u6.contains(F.toLowerCase())};Pe.prototype.fc=function(){this.Tb(507);this.Tb(10);this.Tb(576)};Pe.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(rj.a)(gf,fa)&&(fa=Object(Wi.a)(gf,fa),fa.isValid&&F.FE(fa.source))?(Re.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",fa.eventId),!0):!1})};tl.Object.defineProperties(Pe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});Pe.u6=null;Object(ae.a)(Pe,"ChartFormatRichApiRequestExecutedEvent",kg,[]);vm(ge,Xg);Object(ae.a)(ge,"ChartGridlinesChangedEvent",Xg,[]);vm(Gd,Sd);Gd.prototype.fc=function(){this.Tb(528)};tl.Object.defineProperties(Gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(ae.a)(Gd,"ChartInsertedEvent",Sd,[]);vm(Td,Xg);Object(ae.a)(Td,"ChartLegendChangedEvent",Xg,[]);vm(pd,Xg);Object(ae.a)(pd,"ChartRowColumnSwitchedEvent",Xg,[]);vm(ic,Xg);
Object(ae.a)(ic,"ChartTitleChangedEvent",Xg,[]);vm(Kb,Xg);Object(ae.a)(Kb,"ChartTypeChangedEvent",Xg,[]);vm(Oa,Sd);Oa.prototype.fc=function(){this.Tb(521)};tl.Object.defineProperties(Oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(ae.a)(Oa,"ConnectorFloatingObjectResizedEvent",Sd,[]);vm(T,Sd);T.prototype.fc=function(){this.Tb(109)};tl.Object.defineProperties(T.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(ae.a)(T,"EntitySelectedEvent",
Sd,[]);vm(li,Sd);li.prototype.fc=function(){this.Tb(149);this.Tb(147)};tl.Object.defineProperties(li.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(ae.a)(li,"FindCellEvent",Sd,[]);vm(Bi,Sd);Bi.prototype.fc=function(){this.Tb(122)};tl.Object.defineProperties(Bi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(ae.a)(Bi,"FloatingObjectAltTextAppliedEvent",Sd,[]);vm(vh,Sd);vh.prototype.fc=function(){this.Tb(522)};tl.Object.defineProperties(vh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(ae.a)(vh,"FloatingObjectDeletedEvent",Sd,[]);vm(jj,Sd);jj.prototype.fc=function(){this.Tb(524)};tl.Object.defineProperties(jj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(ae.a)(jj,"FloatingObjectMovedAndResizedEvent",Sd,[]);vm(Qi,Sd);Qi.prototype.fc=function(){this.Tb(523)};tl.Object.defineProperties(Qi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});
Object(ae.a)(Qi,"FloatingObjectRotatedEvent",Sd,[]);vm(Ti,Sd);Ti.prototype.fc=function(){this.Tb(543)};tl.Object.defineProperties(Ti.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(ae.a)(Ti,"GroupDetailsShownOrHiddenEvent",Sd,[]);vm(bi,Sd);bi.prototype.fc=function(){this.Tb(125)};tl.Object.defineProperties(bi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(ae.a)(bi,"HyperlinksRemovedFromRangeEvent",Sd,[]);vm(Ag,kg);Ag.prototype.FE=
function(F){Ag.u6||(Ag.u6=new gj.a(Hj.a.Ik()),Ag.u6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ag.u6.add("fa000000005"));return!!F&&Ag.u6.contains(F.toLowerCase())};Ag.prototype.fc=function(){this.Tb(507);this.Tb(10);this.Tb(576)};Ag.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(rj.a)(gf,fa)?(fa=Object(Wi.a)(gf,fa),fa.isValid&&F.FE(fa.source)):!1})};tl.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Ag.u6=null;Object(ae.a)(Ag,
"IdeasRichApiRequestExecutedEvent",kg,[]);vm(xh,Sd);xh.prototype.fc=function(){this.Tb(115)};tl.Object.defineProperties(xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(ae.a)(xh,"LinkedEntityConvertedEvent",Sd,[]);vm(bh,Sd);bh.prototype.fc=function(){this.Tb(114)};tl.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(ae.a)(bh,"LinkedEntityDisambiguationPaneToggledEvent",Sd,[]);vm(nf,Sd);nf.prototype.fc=
function(){this.Tb(119)};tl.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(ae.a)(nf,"MovedToEdgeEvent",Sd,[]);vm(rh,Sd);rh.prototype.fc=function(){this.Tb(191)};rh.prototype.bV=function(){this.Vlb()};tl.Object.defineProperties(rh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(ae.a)(rh,"NamedSheetViewCreatedEvent",Sd,[]);vm(th,Sd);th.prototype.fc=function(){this.Tb(200)};th.prototype.bV=function(){this.Vlb()};
tl.Object.defineProperties(th.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(ae.a)(th,"NamedSheetViewDeletedEvent",Sd,[]);vm(Yg,Sd);Yg.prototype.fc=function(){this.Tb(192)};Yg.prototype.bV=function(){this.Vlb()};tl.Object.defineProperties(Yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(ae.a)(Yg,"NamedSheetViewExitedEvent",Sd,[]);vm(eh,Sd);eh.prototype.fc=function(){this.Tb(199)};eh.prototype.bV=function(){this.Vlb()};
tl.Object.defineProperties(eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(ae.a)(eh,"NamedSheetViewRenamedEvent",Sd,[]);vm(eg,Sd);eg.prototype.fc=function(){this.Tb(195)};eg.prototype.bV=function(){this.Vlb()};tl.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(ae.a)(eg,"NamedSheetViewSwitchedEvent",Sd,[]);vm(ng,Sd);ng.prototype.fc=function(){this.Tb(174)};tl.Object.defineProperties(ng.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(ae.a)(ng,"OutlineLevelSetEvent",Sd,[]);vm(Le,Sd);Le.prototype.fc=function(){this.Tb(244)};tl.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(ae.a)(Le,"PageBreakInsertedEvent",Sd,[]);vm(pf,Sd);pf.prototype.fc=function(){this.Tb(245)};tl.Object.defineProperties(pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(ae.a)(pf,
"PageBreakRemovedEvent",Sd,[]);vm(Ee,Sd);Ee.prototype.fc=function(){this.Tb(246)};tl.Object.defineProperties(Ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(ae.a)(Ee,"PageBreaksAllResetEvent",Sd,[]);vm(oe,Sd);oe.prototype.fc=function(){this.Tb(503)};oe.prototype.ng=function(){this.xd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&!F.isFromCurrentSession})};tl.Object.defineProperties(oe.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(ae.a)(oe,"PasteArtOtherWorkbookEvent",Sd,[]);vm(Zd,Sd);Zd.prototype.fc=function(){this.Tb(503)};Zd.prototype.ng=function(){this.xd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&F.isFromCurrentSession})};tl.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(ae.a)(Zd,"PasteArtSameWorkbookEvent",
Sd,[]);vm($c,Sd);$c.prototype.fc=function(){this.Tb(204)};tl.Object.defineProperties($c.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(ae.a)($c,"PasteHtmlEvent",Sd,[]);vm(gc,Sd);gc.prototype.fc=function(){this.Tb(506)};tl.Object.defineProperties(gc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(ae.a)(gc,"PasteRangeEvent",Sd,[]);vm(Vb,Sd);Vb.prototype.fc=function(){this.Tb(503)};Vb.prototype.ng=function(){this.xd(function(F){return 1===
F.pasteParameters.CopyPasteTargetType})};tl.Object.defineProperties(Vb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(ae.a)(Vb,"PasteShadowWorkbookRangeEvent",Sd,[]);vm(ab,Sd);ab.prototype.fc=function(){this.Tb(180)};tl.Object.defineProperties(ab.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(ae.a)(ab,"PasteStringEvent",Sd,[]);vm(ea,Sd);ea.prototype.fc=function(){this.Tb(220)};tl.Object.defineProperties(ea.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object(ae.a)(ea,"PendingMergeEvent",Sd,[]);vm(aa,Sd);aa.prototype.fc=function(){this.Tb(510)};tl.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(ae.a)(aa,"PictureInsertedEvent",Sd,[]);vm(H,Sd);H.prototype.fc=function(){this.Tb(161)};tl.Object.defineProperties(H.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(ae.a)(H,"PivotDrillToggledEvent",Sd,[]);vm(ha,
Sd);ha.prototype.fc=function(){this.Tb(225)};ha.prototype.ng=function(){var F=this;this.xd(function(fa){return fa.opType===F.opType})};tl.Object.defineProperties(ha.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object(ae.a)(ha,"PivotTableSettingsChangedEventBase",Sd,[]);vm(K,ha);Object(ae.a)(K,"PivotTableAllItemLabelsRepeatedEvent",ha,[]);vm(pc,ha);Object(ae.a)(pc,"PivotTableAltTextDescriptionChangedEvent",ha,[]);vm(Ed,ha);Object(ae.a)(Ed,"PivotTableAltTextTitleChangedEvent",
ha,[]);vm(mc,ha);Object(ae.a)(mc,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",ha,[]);vm(qc,ha);Object(ae.a)(qc,"PivotTableBlankLineAfterEachItemToggledEvent",ha,[]);vm(Ka,ha);Object(ae.a)(Ka,"PivotTableColumnGrandTotalShownEvent",ha,[]);vm(ja,Sd);ja.prototype.fc=function(){this.Tb(132)};tl.Object.defineProperties(ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(ae.a)(ja,"PivotTableCreatedEvent",Sd,[]);vm(qe,ha);Object(ae.a)(qe,"PivotTableDisplayErrorStringToggledEvent",
ha,[]);vm(Ue,ha);Object(ae.a)(Ue,"PivotTableDisplayNullStringToggledEvent",ha,[]);vm(we,ha);Object(ae.a)(we,"PivotTableErrorStringChangedEvent",ha,[]);vm(sd,ha);Object(ae.a)(sd,"PivotTableExpandCollapseButtonsShownEvent",ha,[]);vm(Oc,ha);Object(ae.a)(Oc,"PivotTableIndentChangedEvent",ha,[]);vm(jc,ha);Object(ae.a)(jc,"PivotTableItemsWithNoDataOnColumnsShownEvent",ha,[]);vm(Ab,ha);Object(ae.a)(Ab,"PivotTableItemsWithNoDataOnRowsShownEvent",ha,[]);vm(h,ha);Object(ae.a)(h,"PivotTableLayoutTypeSetEvent",
ha,[]);vm(qi,ha);Object(ae.a)(qi,"PivotTableNullStringChangedEvent",ha,[]);vm(Xh,Sd);Xh.prototype.fc=function(){this.Tb(219)};tl.Object.defineProperties(Xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(ae.a)(Xh,"PivotTablePivotLocationChangedEvent",Sd,[]);vm(Ae,Sd);Ae.prototype.fc=function(){this.Tb(145)};tl.Object.defineProperties(Ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(ae.a)(Ae,"PivotTablePivotedEvent",Sd,
[]);vm(gi,ha);Object(ae.a)(gi,"PivotTableRefreshDataOnLoadToggledEvent",ha,[]);vm($h,Sd);$h.prototype.fc=function(){this.Tb(50)};$h.prototype.ng=function(){this.xd(function(F){return!!F.pivotTableId&&!!F.pivotTableName})};tl.Object.defineProperties($h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(ae.a)($h,"PivotTableRefreshedEvent",Sd,[]);vm(Rg,ha);Object(ae.a)(Rg,"PivotTableRenamedEvent",ha,[]);vm(Th,ha);Object(ae.a)(Th,"PivotTableRowGrandTotalShownEvent",
ha,[]);vm(Li,ha);Object(ae.a)(Li,"PivotTableSaveSourceDataWithFileToggledEvent",ha,[]);var Nk=b(652);vm(Oh,Sd);Oh.prototype.fc=function(){this.Tb(131)};Oh.prototype.ng=function(){this.xd(function(F){F=Object(Wi.a)(Nk.a,F);return!!F&&!!F.AJa()&&!!F.hierarchyName})};tl.Object.defineProperties(Oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(ae.a)(Oh,"PivotTableSortedEvent",Sd,[]);vm(Mh,ha);Object(ae.a)(Mh,"PivotTableSubTotalsVisibilitySettingSetEvent",ha,[]);
vm(Dh,Sd);Dh.prototype.fc=function(){this.Tb(560)};tl.Object.defineProperties(Dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(ae.a)(Dh,"PivotValueFieldSettingAppliedEvent",Sd,[]);vm(Tg,Sd);Tg.prototype.fc=function(){this.Tb(243)};tl.Object.defineProperties(Tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(ae.a)(Tg,"PrintAreaClearedEvent",Sd,[]);vm($g,Sd);$g.prototype.fc=function(){this.Tb(241)};$g.prototype.ng=function(){this.xd(function(F){return!F.addToPrintArea})};
tl.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(ae.a)($g,"PrintAreaSetEvent",Sd,[]);vm(Jg,Sd);Jg.prototype.fc=function(){this.Tb(517)};tl.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(ae.a)(Jg,"RangeAutoFilterClearedEvent",Sd,[]);vm(Cf,Sd);Cf.prototype.fc=function(){this.Tb(11)};Cf.prototype.ng=function(){var F=this;this.xd(function(fa){return 16===fa.cellFormat.ValidMembers});
this.xd(function(fa){return fa.cellFormat.Font.ValidMembers===F.FWd})};tl.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object(ae.a)(Cf,"RangeFontFormattedEventBase",Sd,[]);vm(Je,Cf);Object(ae.a)(Je,"RangeBoldedEvent",Cf,[]);vm(be,Sd);be.prototype.fc=function(){this.Tb(11)};be.prototype.ng=function(){this.xd(function(F){return 128===F.cellFormat.ValidMembers})};tl.Object.defineProperties(be.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 2}}});Object(ae.a)(be,"RangeBorderedEvent",Sd,[]);Dd.b9a="Table";Dd.fnc="Sheet";Object(ae.a)(Dd,"MacroRecorderEventConstants",null,[]);vm(ub,Sd);ub.prototype.fc=function(){this.Tb(208)};ub.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===Dd.fnc})};tl.Object.defineProperties(ub.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(ae.a)(ub,"RangeCheckedItemsFilteredEvent",Sd,[]);vm(qa,Sd);qa.prototype.fc=function(){this.Tb(106);
this.Tb(105)};tl.Object.defineProperties(qa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(ae.a)(qa,"RangeConditionalFormattingChangedEvent",Sd,[]);vm(ya,Sd);ya.prototype.fc=function(){this.Tb(221)};tl.Object.defineProperties(ya.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(ae.a)(ya,"RangeConditionalFormattingRuleDeletedEvent",Sd,[]);vm(Ef,Sd);Ef.prototype.fc=function(){this.Tb(508)};Ef.prototype.ng=function(){this.xd(function(F){return 3===
F.xt()||1===F.xt()||4===F.xt()})};tl.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(ae.a)(Ef,"RangeContentClearedEvent",Sd,[]);vm(jf,Sd);jf.prototype.fc=function(){this.Tb(104)};tl.Object.defineProperties(jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(ae.a)(jf,"RangeCopiedCutCellsInsertedEvent",Sd,[]);vm(kf,Sd);kf.prototype.fc=function(){this.Tb(209)};kf.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
Dd.fnc})};tl.Object.defineProperties(kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(ae.a)(kf,"RangeCustomFilteredEvent",Sd,[]);vm(cf,Sd);cf.prototype.fc=function(){this.Tb(121)};tl.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(ae.a)(cf,"RangeDataValidationChangedEvent",Sd,[]);vm(Ge,Cf);Object(ae.a)(Ge,"RangeDoubleUnderlinedEvent",Cf,[]);vm(ke,Sd);ke.prototype.fc=function(){this.Tb(190)};
tl.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(ae.a)(ke,"RangeDuplicatesRemovedEvent",Sd,[]);vm(jd,Sd);jd.prototype.fc=function(){this.Tb(527);this.Tb(12)};tl.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(ae.a)(jd,"RangeEditedEvent",Sd,[]);vm(xb,Sd);xb.prototype.fc=function(){ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(255):this.Tb(232)};xb.prototype.ng=function(){this.xd(function(F){return 4===F.actionType})};xb.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(ae.a)(xb,"RangeExternalLinksBrokeAllLinksEvent",Sd,[]);vm(Dc,Sd);Dc.prototype.fc=function(){ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(255):this.Tb(232)};Dc.prototype.ng=function(){this.xd(function(F){return 3===F.actionType})};Dc.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(Dc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(ae.a)(Dc,"RangeExternalLinksBrokeLinkEvent",Sd,[]);vm(Xb,Sd);Xb.prototype.fc=function(){ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(256):this.Tb(249)};Xb.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};tl.Object.defineProperties(Xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(ae.a)(Xb,"RangeExternalLinksChangeSourceEvent",Sd,[]);vm(kb,Sd);kb.prototype.fc=function(){this.Tb(553)};kb.prototype.ng=function(){this.xd(function(F){return 1===F.actionType})};kb.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};
tl.Object.defineProperties(kb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(ae.a)(kb,"RangeExternalLinksRefreshedAllEvent",Sd,[]);vm(la,Sd);la.prototype.fc=function(){this.Tb(553)};la.prototype.ng=function(){this.xd(function(F){return!F.actionType})};la.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(la.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});
Object(ae.a)(la,"RangeExternalLinksRefreshedEvent",Sd,[]);vm(ei,Sd);ei.prototype.fc=function(){this.Tb(224)};ei.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(ei.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(ae.a)(ei,"RangeExternalLinksSetAutoRefreshEvent",Sd,[]);vm(yi,Sd);yi.prototype.fc=function(){this.Tb(11)};yi.prototype.ng=function(){this.xd(function(F){return 64===F.cellFormat.ValidMembers})};
tl.Object.defineProperties(yi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(ae.a)(yi,"RangeFillColoredEvent",Sd,[]);vm(fh,Sd);fh.prototype.fc=function(){this.Tb(155)};tl.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(ae.a)(fh,"RangeFilledEvent",Sd,[]);vm(yh,Sd);yh.prototype.fc=function(){this.Tb(176)};yh.prototype.ng=function(){this.xd(function(F){return F.AU().AutoFilterType===Dd.fnc&&!!F.AU().CriteriaType})};
tl.Object.defineProperties(yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(ae.a)(yh,"RangeFilterAppliedEvent",Sd,[]);vm(ni,Sd);ni.prototype.fc=function(){this.Tb(176)};ni.prototype.ng=function(){this.xd(function(F){return F.AU().AutoFilterType===Dd.fnc&&!F.AU().CriteriaType})};tl.Object.defineProperties(ni.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(ae.a)(ni,"RangeFilterClearedEvent",Sd,[]);vm(Zg,Sd);Zg.prototype.fc=
function(){this.Tb(518)};tl.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(ae.a)(Zg,"RangeFilterReappliedEvent",Sd,[]);vm(ai,Sd);ai.prototype.fc=function(){this.Tb(150)};tl.Object.defineProperties(ai.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(ae.a)(ai,"RangeFlashFilledEvent",Sd,[]);vm(Ng,Cf);Object(ae.a)(Ng,"RangeFontColoredEvent",Cf,[]);vm(ph,Cf);Object(ae.a)(ph,"RangeFontItalicizedEvent",
Cf,[]);vm(mi,Cf);Object(ae.a)(mi,"RangeFontNamedEvent",Cf,[]);vm(Gi,Cf);Object(ae.a)(Gi,"RangeFontSizedEvent",Cf,[]);vm(wg,Sd);wg.prototype.fc=function(){this.Tb(215)};tl.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(ae.a)(wg,"RangeFormattedAsTableEvent",Sd,[]);vm(ch,Sd);ch.prototype.fc=function(){this.Tb(188)};tl.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(ae.a)(ch,
"RangeGroupedOrUngroupedEvent",Sd,[]);vm(Qg,Sd);Qg.prototype.fc=function(){this.Tb(11)};Qg.prototype.ng=function(){this.xd(function(F){return 2===F.cellFormat.ValidMembers})};tl.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(ae.a)(Qg,"RangeHorizontallyAlignedEvent",Sd,[]);vm($e,Sd);$e.prototype.fc=function(){this.Tb(526)};tl.Object.defineProperties($e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(ae.a)($e,
"RangeHyperlinkAppliedEvent",Sd,[]);vm(hh,Sd);hh.prototype.fc=function(){this.Tb(11)};hh.prototype.ng=function(){this.xd(function(F){return 256===F.cellFormat.ValidMembers})};tl.Object.defineProperties(hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(ae.a)(hh,"RangeIndentChangedEvent",Sd,[]);vm(mg,Sd);mg.prototype.fc=function(){this.Tb(156)};mg.prototype.ng=function(){this.xd(function(F){return 2===F.xt()||5===F.xt()||6===F.xt()||7===F.xt()})};tl.Object.defineProperties(mg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(ae.a)(mg,"RangeMergedEvent",Sd,[]);vm(ld,Sd);ld.prototype.fc=function(){this.Tb(216)};tl.Object.defineProperties(ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(ae.a)(ld,"RangeNamedCellStyleAppliedEvent",Sd,[]);vm(mh,Sd);mh.prototype.fc=function(){this.Tb(11)};mh.prototype.ng=function(){this.xd(function(F){return 32===F.cellFormat.ValidMembers})};tl.Object.defineProperties(mh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(ae.a)(mh,"RangeNumberFormattedEvent",Sd,[]);var ek=b(1094);vm(Fg,Sd);Fg.prototype.fc=function(){this.Tb(141)};Fg.prototype.ng=function(){this.xd(function(F){return Object(rj.a)(ek.a,F)})};tl.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(ae.a)(Fg,"RangeSortedEvent",Sd,[]);vm(Nh,Cf);Object(ae.a)(Nh,"RangeStrikedThroughEvent",Cf,[]);vm(xf,Cf);Object(ae.a)(xf,
"RangeUnderlinedEvent",Cf,[]);vm(ud,Sd);ud.prototype.fc=function(){this.Tb(11)};ud.prototype.ng=function(){this.xd(function(F){return 1===F.cellFormat.ValidMembers})};tl.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(ae.a)(ud,"RangeVerticallyAlignedEvent",Sd,[]);vm(hg,Sd);hg.prototype.fc=function(){this.Tb(11)};hg.prototype.ng=function(){this.xd(function(F){return 8===F.cellFormat.ValidMembers})};tl.Object.defineProperties(hg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(ae.a)(hg,"RangeWrapTextToggledEvent",Sd,[]);vm(Lg,Sd);Lg.prototype.fc=function(){this.Tb(51)};tl.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(ae.a)(Lg,"RefreshedAllEvent",Sd,[]);vm(Ze,Sd);Ze.prototype.fc=function(){this.Tb(148)};tl.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(ae.a)(Ze,"ReplaceAllEvent",
Sd,[]);vm(sg,Sd);sg.prototype.fc=function(){this.Tb(532)};sg.prototype.ng=function(){this.xd(function(F){return 95!==F.getShapeType()&&96!==F.getShapeType()&&97!==F.getShapeType()&&98!==F.getShapeType()&&100!==F.getShapeType()&&102!==F.getShapeType()&&103!==F.getShapeType()})};tl.Object.defineProperties(sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(ae.a)(sg,"ShapeInsertedEvent",Sd,[]);vm(pg,Sd);pg.prototype.fc=function(){this.Tb(531)};tl.Object.defineProperties(pg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(ae.a)(pg,"ShapeStyleSetEvent",Sd,[]);var Yi=b(946);vm(vf,Sd);vf.prototype.fc=function(){this.Tb(581)};vf.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(rj.a)(Yi.a,fa)&&4===fa.getShapeTextFormat().ValidMembers});this.xd(function(fa){return Object(rj.a)(Yi.a,fa)&&fa.getShapeTextFormat().Font.ValidMembers===F.FWd})};tl.Object.defineProperties(vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});
Object(ae.a)(vf,"ShapeTextFontFormattedEventBase",Sd,[]);vm(wf,vf);Object(ae.a)(wf,"ShapeTextBoldedEvent",vf,[]);var Mj=b(1096);vm(Fd,Sd);Fd.prototype.fc=function(){this.Tb(581)};Fd.prototype.ng=function(){this.xd(function(F){return Object(rj.a)(Mj.a,F)})};tl.Object.defineProperties(Fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(ae.a)(Fd,"ShapeTextChangedEvent",Sd,[]);vm(af,vf);Object(ae.a)(af,"ShapeTextFontColorChangedEvent",vf,[]);vm(td,vf);Object(ae.a)(td,
"ShapeTextFontNameChangedEvent",vf,[]);vm(se,vf);Object(ae.a)(se,"ShapeTextFontSizeChangedEvent",vf,[]);vm(Me,Sd);Me.prototype.fc=function(){this.Tb(581)};Me.prototype.ng=function(){this.xd(function(F){return Object(rj.a)(Yi.a,F)&&2===F.getShapeTextFormat().ValidMembers})};tl.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(ae.a)(Me,"ShapeTextHorizontallyAlignedEvent",Sd,[]);vm(Id,vf);Object(ae.a)(Id,"ShapeTextItalicizedEvent",vf,[]);
vm($d,vf);Object(ae.a)($d,"ShapeTextUnderlinedEvent",vf,[]);vm(fc,Sd);fc.prototype.fc=function(){this.Tb(581)};fc.prototype.ng=function(){this.xd(function(F){return Object(rj.a)(Yi.a,F)&&1===F.getShapeTextFormat().ValidMembers})};tl.Object.defineProperties(fc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(ae.a)(fc,"ShapeTextVerticallyAlignedEvent",Sd,[]);vm(nb,Sd);nb.prototype.fc=function(){this.Tb(138)};tl.Object.defineProperties(nb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object(ae.a)(nb,"SheetAddedEvent",Sd,[]);var vj=b(9);vm(vc,Sd);vc.prototype.fc=function(){this.Tb(237)};vc.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==
vj.a.dz)||!F.DeltaColumn&&0>F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==vj.a.ew)})};tl.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(ae.a)(vc,"SheetCellsDeletedEvent",Sd,[]);vm(ac,Sd);ac.prototype.fc=function(){this.Tb(237)};ac.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});
this.xd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==vj.a.dz)||!F.DeltaColumn&&0<F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==vj.a.ew)})};tl.Object.defineProperties(ac.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(ae.a)(ac,"SheetCellsInsertedEvent",Sd,[]);vm(ob,Sd);ob.prototype.fc=function(){this.Tb(237)};
ob.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
vj.a.dz})};tl.Object.defineProperties(ob.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(ae.a)(ob,"SheetColumnDeletedEvent",Sd,[]);vm(Ea,Sd);Ea.prototype.fc=function(){this.Tb(237)};Ea.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===vj.a.dz})};tl.Object.defineProperties(Ea.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(ae.a)(Ea,"SheetColumnInsertedEvent",Sd,[]);vm(Uf,Sd);Uf.prototype.fc=function(){this.Tb(137)};tl.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(ae.a)(Uf,"SheetDeletedEvent",Sd,[]);vm(Bf,Sd);Bf.prototype.fc=function(){this.Tb(185)};tl.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(ae.a)(Bf,"SheetDirectionChangedEvent",Sd,[]);vm(Qe,Sd);Qe.prototype.fc=function(){this.Tb(139)};tl.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(ae.a)(Qe,"SheetDuplicatedEvent",Sd,
[]);vm(He,Sd);He.prototype.fc=function(){this.Tb(207)};tl.Object.defineProperties(He.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(ae.a)(He,"SheetNameEditedEvent",Sd,[]);vm(Md,Sd);Md.prototype.fc=function(){this.Tb(151)};tl.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(ae.a)(Md,"SheetPaneFrozenEvent",Sd,[]);vm(od,Sd);od.prototype.fc=function(){this.Tb(226)};tl.Object.defineProperties(od.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(ae.a)(od,"SheetPrintSettingsSavedEvent",Sd,[]);var Qj=b(997);vm(Ec,Sd);Ec.prototype.fc=function(){this.Tb(507)};Ec.prototype.bV=function(){this.WEa("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Ec.prototype.ng=function(){this.xd(function(F){return Object.getType(F)===Qj.a})};tl.Object.defineProperties(Ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(ae.a)(Ec,"SheetProtectionPausedResumedEvent",
Sd,[]);vm(Ob,Sd);Ob.prototype.fc=function(){this.Tb(557)};tl.Object.defineProperties(Ob.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(ae.a)(Ob,"SheetReorderedEvent",Sd,[]);vm(Ba,Sd);Ba.prototype.fc=function(){this.Tb(237)};Ba.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===vj.a.ew})};tl.Object.defineProperties(Ba.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(ae.a)(Ba,"SheetRowDeletedEvent",Sd,
[]);vm(gg,Sd);gg.prototype.fc=function(){this.Tb(237)};gg.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===vj.a.ew})};tl.Object.defineProperties(gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(ae.a)(gg,"SheetRowInsertedEvent",Sd,[]);vm(Qf,Sd);Qf.prototype.fc=function(){this.Tb(135)};tl.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(ae.a)(Qf,"SheetRowsColumnsAutoFitEvent",Sd,[]);
vm(Xf,Sd);Xf.prototype.fc=function(){this.Tb(136)};tl.Object.defineProperties(Xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(ae.a)(Xf,"SheetRowsColumnsResizedEvent",Sd,[]);vm(ef,Sd);ef.prototype.fc=function(){this.Tb(183)};tl.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(ae.a)(ef,"SheetShowGridlinesToggledEvent",Sd,[]);vm(Od,Sd);Od.prototype.fc=function(){this.Tb(184)};tl.Object.defineProperties(Od.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(ae.a)(Od,"SheetShowHeadingsToggledEvent",Sd,[]);vm(Ld,Sd);Ld.prototype.fc=function(){this.Tb(213)};tl.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(ae.a)(Ld,"SheetSpellCheckedEvent",Sd,[]);vm(Cd,Sd);Cd.prototype.fc=function(){this.Tb(515)};tl.Object.defineProperties(Cd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(ae.a)(Cd,
"SheetTabColoredEvent",Sd,[]);vm(dd,Sd);dd.prototype.fc=function(){this.Tb(157)};tl.Object.defineProperties(dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(ae.a)(dd,"SheetVisibilityChangedEvent",Sd,[]);vm(xc,Sd);xc.prototype.fc=function(){this.Tb(239)};tl.Object.defineProperties(xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(ae.a)(xc,"SheetsVisibilityChangedEvent",Sd,[]);vm(Df,Sd);Df.prototype.fc=function(){this.Tb(203)};
tl.Object.defineProperties(Df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(ae.a)(Df,"SlicerInsertedEvent",Sd,[]);vm(Hg,Sd);Hg.prototype.fc=function(){this.Tb(173)};Hg.prototype.ng=function(){this.xd(function(F){return!F.clearFilter})};tl.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(ae.a)(Hg,"SlicerSelectionAppliedEvent",Sd,[]);vm(yf,Sd);yf.prototype.fc=function(){this.Tb(173)};yf.prototype.ng=
function(){this.xd(function(F){return F.clearFilter})};tl.Object.defineProperties(yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(ae.a)(yf,"SlicerSelectionClearedEvent",Sd,[]);vm(dg,Sd);dg.prototype.fc=function(){this.Tb(208)};dg.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===Dd.b9a})};tl.Object.defineProperties(dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(ae.a)(dg,"TableCheckedItemsFilteredEvent",
Sd,[]);vm($f,Sd);$f.prototype.fc=function(){this.Tb(237)};$f.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};tl.Object.defineProperties($f.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(ae.a)($f,"TableColumnDeletedEvent",Sd,[]);vm(lf,Sd);lf.prototype.fc=function(){this.Tb(237)};lf.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
tl.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(ae.a)(lf,"TableColumnInsertedEvent",Sd,[]);var Aj=b(1095);vm(Mg,Sd);Mg.prototype.fc=function(){this.Tb(141)};Mg.prototype.ng=function(){this.xd(function(F){return Object(rj.a)(Aj.a,F)})};tl.Object.defineProperties(Mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(ae.a)(Mg,"TableColumnSortedEvent",Sd,[]);vm(rf,Sd);rf.prototype.fc=function(){this.Tb(193)};
tl.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(ae.a)(rf,"TableConvertedToRangeEvent",Sd,[]);vm(df,Sd);df.prototype.fc=function(){this.Tb(206)};tl.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(ae.a)(df,"TableCreatedEvent",Sd,[]);vm(mf,Sd);mf.prototype.fc=function(){this.Tb(209)};mf.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
Dd.b9a})};tl.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(ae.a)(mf,"TableCustomFilteredEvent",Sd,[]);vm(me,Sd);me.prototype.fc=function(){this.Tb(187)};me.prototype.ng=function(){this.xd(function(F){return 1===F.options.OperationType})};tl.Object.defineProperties(me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(ae.a)(me,"TableCustomSortedEvent",Sd,[]);vm(xe,Sd);xe.prototype.fc=function(){this.Tb(176)};
xe.prototype.ng=function(){this.xd(function(F){return F.AU().AutoFilterType===Dd.b9a});this.xd(function(F){return!F.AU().CriteriaType})};tl.Object.defineProperties(xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(ae.a)(xe,"TableFilterClearedEvent",Sd,[]);vm(zd,Sd);zd.prototype.fc=function(){this.Tb(176)};zd.prototype.ng=function(){this.xd(function(F){return F.AU().AutoFilterType===Dd.b9a});this.xd(function(F){var fa=new Gh.a;fa.add(1);fa.add(2);fa.add(8);fa.add(9);
fa.add(10);fa.add(11);fa.add(12);fa.add(13);fa.add(14);fa.add(15);fa.add(16);fa.add(17);fa.add(18);fa.add(19);fa.add(20);fa.add(21);fa.add(22);fa.add(23);fa.add(24);fa.add(25);fa.add(26);fa.add(27);fa.add(28);fa.add(29);fa.add(30);fa.add(31);fa.add(32);fa.add(33);fa.add(34);fa.add(35);fa.add(36);fa.add(37);fa.add(38);fa.add(39);return fa.contains(F.AU().CriteriaType)})};tl.Object.defineProperties(zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(ae.a)(zd,"TableItemFilteredEvent",
Sd,[]);vm(Rd,Sd);Rd.prototype.fc=function(){this.Tb(217)};tl.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(ae.a)(Rd,"TableRenamedEvent",Sd,[]);vm(fd,Sd);fd.prototype.fc=function(){this.Tb(211)};tl.Object.defineProperties(fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(ae.a)(fd,"TableResizedEvent",Sd,[]);vm(tc,Sd);tc.prototype.fc=function(){this.Tb(514)};tl.Object.defineProperties(tc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(ae.a)(tc,"TableRowColumnRearrangedEvent",Sd,[]);vm(qb,Sd);qb.prototype.fc=function(){this.Tb(237)};qb.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
tl.Object.defineProperties(qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(ae.a)(qb,"TableRowDeletedEvent",Sd,[]);vm(Qa,Sd);Qa.prototype.fc=function(){this.Tb(237)};Qa.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0<
F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};tl.Object.defineProperties(Qa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(ae.a)(Qa,"TableRowInsertedEvent",Sd,[]);vm(ih,Sd);ih.prototype.fc=function(){this.Tb(177)};ih.prototype.ng=function(){this.xd(function(F){return F.AU().AutoFilterType===Dd.b9a})};tl.Object.defineProperties(ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(ae.a)(ih,"TableSortedEvent",
Sd,[]);vm(qf,Sd);qf.prototype.fc=function(){this.Tb(212)};tl.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(ae.a)(qf,"TableStyleAppliedEvent",Sd,[]);vm(Pg,Sd);Pg.prototype.fc=function(){this.Tb(196)};tl.Object.defineProperties(Pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(ae.a)(Pg,"TableStyleOptionToggledEvent",Sd,[]);vm(kh,Sd);kh.prototype.fc=function(){this.Tb(210)};kh.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
Dd.b9a})};tl.Object.defineProperties(kh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(ae.a)(kh,"TableTop10FilteredEvent",Sd,[]);vm(vg,Sd);vg.prototype.fc=function(){this.Tb(238)};tl.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(ae.a)(vg,"TextToColumnsEvent",Sd,[]);vm(Sf,Sd);Sf.prototype.fc=function(){this.Tb(559)};tl.Object.defineProperties(Sf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(ae.a)(Sf,"ValuesSortedEvent",Sd,[]);vm(We,Sd);We.prototype.fc=function(){this.Tb(197)};tl.Object.defineProperties(We.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(ae.a)(We,"WorkbookCalculationModeSetEvent",Sd,[]);vm(Ve,Sd);Ve.prototype.fc=function(){this.Tb(181)};Ve.prototype.ng=function(){this.xd(function(F){return!!F.parentCommentId})};tl.Object.defineProperties(Ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(ae.a)(Ve,"WorkbookCommentRepliedEvent",Sd,[]);vm(Tf,Sd);Tf.prototype.fc=function(){this.Tb(181)};Tf.prototype.ng=function(){this.xd(function(F){return!F.parentCommentId})};tl.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(ae.a)(Tf,"WorkbookCommentedEvent",Sd,[]);vm(de,Sd);de.prototype.fc=function(){this.Tb(128)};tl.Object.defineProperties(de.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(ae.a)(de,
"WorkbookRecalculatedEvent",Sd,[]);vm(Ff,Sd);Ff.prototype.fc=function(){this.Tb(171)};tl.Object.defineProperties(Ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(ae.a)(Ff,"WorkbookRedoEvent",Sd,[]);vm(jg,Sd);jg.prototype.fc=function(){this.Tb(170)};tl.Object.defineProperties(jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(ae.a)(jg,"WorkbookUndoEvent",Sd,[]);vm(Yf,Sd);Yf.prototype.fc=function(){this.Tb(507);this.Tb(576);
this.Tb(10)};Yf.prototype.ng=function(){this.xd(function(F){if(Object(rj.a)(gf,F)&&(F=Object(Wi.a)(gf,F),void 0!==F.source&&null!==F.source&&void 0!==F.eventId&&null!==F.eventId))return Re.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",F.source,F.eventId),!0;Re.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};tl.Object.defineProperties(Yf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(ae.a)(Yf,"DefaultRichApiRequestExecutedEvent",Sd,[]);vm(zg,Sd);zg.prototype.fc=function(){this.Tb(1022)};tl.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(ae.a)(zg,"TablelAltTextEditedEvent",Sd,[]);vm(Fe,Sd);Fe.prototype.fc=function(){this.Tb(263)};tl.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(ae.a)(Fe,"FloatingObjectZOrderChangedEvent",
Sd,[]);Vf.prototype.VXe=function(F,fa){var Pa=this.WXe(F,this.macroRecorderEvents,fa);Pa||(Pa=this.WXe(F,Vf.eVh(),fa),!Pa&&this.Fbf(F,Vf.UDe,fa)&&(Pa=Vf.UDe));return Pa};Vf.prototype.WXe=function(F,fa,Pa){var yb=new Gh.a;fa=yl(fa);for(var Cc=fa.next();!Cc.done;Cc=fa.next())Cc=Cc.value,this.Fbf(F,Cc,Pa)&&yb.add(Cc);return 1===yb.count?yb.na(0):1<yb.count?Vf.xDh(yb):null};Vf.prototype.Fbf=function(F,fa,Pa){var yb=Vf.QNi(F,fa);return Pa?yb&&Vf.FNj(F,fa):yb};Vf.prototype.A2i=function(){for(var F=new Gh.a,
fa=yl(this.Db),Pa=fa.next();!Pa.done;Pa=fa.next()){Pa=Pa.value;for(var yb=!1,Cc=yl(Pa.featureGates),Vc=Cc.next();!Vc.done;Vc=Cc.next())if(!ig.EwaSettings.la(Vc.value)){F.add(Pa);yb=!0;break}if(!yb)for(yb=yl(Pa.jPe),Cc=yb.next();!Cc.done;Cc=yb.next())if(!ig.EwaSettings.getBooleanFeatureGate(Cc.value,!1)){F.add(Pa);break}}F=yl(F);for(fa=F.next();!fa.done;fa=F.next())this.Db.remove(fa.value)};Vf.eVh=function(){Vf.vAb||(Vf.vAb=new Gh.a,Vf.vAb.add(new Pe),Vf.vAb.add(new Ag));return Vf.vAb};Vf.QNi=function(F,
fa){return fa.operations.contains(F.operation)};Vf.FNj=function(F,fa){var Pa=fa.CAc;if(!Pa.count)return!0;fa=!0;Pa=yl(Pa);for(var yb=Pa.next();!yb.done;yb=Pa.next())if(yb=yb.value,!yb(F.payload)){fa=!1;break}return fa};Vf.xDh=function(F){var fa=F.na(0);F=yl(F);for(var Pa=F.next();!Pa.done;Pa=F.next())Pa=Pa.value,Pa.CAc.count>fa.CAc.count&&(fa=Pa);return fa};tl.Object.defineProperties(Vf.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Db||(this.Db=new Gh.a,this.Db.add(new jd),
this.Db.add(new be),this.Db.add(new Je),this.Db.add(new Ge),this.Db.add(new yi),this.Db.add(new Ng),this.Db.add(new ph),this.Db.add(new mi),this.Db.add(new Gi),this.Db.add(new Nh),this.Db.add(new xf),this.Db.add(new mh),this.Db.add(new nb),this.Db.add(new Uf),this.Db.add(new He),this.Db.add(new df),this.Db.add(new $f),this.Db.add(new lf),this.Db.add(new qb),this.Db.add(new Qa),this.Db.add(new Ea),this.Db.add(new ob),this.Db.add(new gg),this.Db.add(new Ba),this.Db.add(new me),this.Db.add(new ih),this.Db.add(new dg),
this.Db.add(new xe),this.Db.add(new Ef),this.Db.add(new mf),this.Db.add(new kh),this.Db.add(new zd),this.Db.add(new Tf),this.Db.add(new Ve),this.Db.add(new gc),this.Db.add(new Xf),this.Db.add(new vc),this.Db.add(new ac),this.Db.add(new Qf),this.Db.add(new jf),this.Db.add(new Zg),this.Db.add(new $e),this.Db.add(new ab),this.Db.add(new tc),this.Db.add(new Ff),this.Db.add(new jg),this.Db.add(new Ze),this.Db.add(new li),this.Db.add(new Zd),this.Db.add(new mg),this.Db.add(new Qe),this.Db.add(new We),this.Db.add(new de),
this.Db.add(new Jg),this.Db.add(new ni),this.Db.add(new fh),this.Db.add(new Qg),this.Db.add(new ud),this.Db.add(new hg),this.Db.add(new hh),this.Db.add(new Ob),this.Db.add(new Ci),this.Db.add(new Gd),this.Db.add(new Od),this.Db.add(new ef),this.Db.add(new ke),this.Db.add(new dd),this.Db.add(new Cd),this.Db.add(new fd),this.Db.add(new wg),this.Db.add(new pd),this.Db.add(new Wg),this.Db.add(new la),this.Db.add(new Kb),this.Db.add(new ic),this.Db.add(new Jh),this.Db.add(new Td),this.Db.add(new tg),this.Db.add(new cg),
this.Db.add(new Fh),this.Db.add(new ge),this.Db.add(new ai),this.Db.add(new qf),this.Db.add(new Pg),this.Db.add(new Ld),this.Db.add(new Md),this.Db.add(new sg),this.Db.add(new pg),this.Db.add(new vh),this.Db.add(new jj),this.Db.add(new Qi),this.Db.add(new Bi),this.Db.add(new ch),this.Db.add(new ja),this.Db.add(new ng),this.Db.add(new Ti),this.Db.add(new Rd),this.Db.add(new Ae),this.Db.add(new Lg),this.Db.add(new $h),this.Db.add(new rf),this.Db.add(new cf),this.Db.add(new ld),this.Db.add(new Fg),this.Db.add(new qa),
this.Db.add(new $c),this.Db.add(new Vb),this.Db.add(new oe),this.Db.add(new ub),this.Db.add(new kf),this.Db.add(new yh),this.Db.add(new hi),this.Db.add(new aa),this.Db.add(new Dc),this.Db.add(new od),this.Db.add(new Mg),this.Db.add(new ya),this.Db.add(new xc),this.Db.add(new nf),this.Db.add(new Sf),this.Db.add(new T),this.Db.add(new nh),this.Db.add(new Oa),this.Db.add(new Yg),this.Db.add(new ea),this.Db.add(new rh),this.Db.add(new xh),this.Db.add(new Bf),this.Db.add(new bh),this.Db.add(new Xh),this.Db.add(new H),
this.Db.add(new bi),this.Db.add(new Oh),this.Db.add(new Le),this.Db.add(new pf),this.Db.add(new Ee),this.Db.add(new $g),this.Db.add(new Di),this.Db.add(new Tg),this.Db.add(new eh),this.Db.add(new kb),this.Db.add(new xb),this.Db.add(new ei),this.Db.add(new th),this.Db.add(new eg),this.Db.add(new Rg),this.Db.add(new Th),this.Db.add(new Ka),this.Db.add(new K),this.Db.add(new qc),this.Db.add(new mc),this.Db.add(new sd),this.Db.add(new Ab),this.Db.add(new jc),this.Db.add(new qe),this.Db.add(new Ue),this.Db.add(new we),
this.Db.add(new qi),this.Db.add(new Li),this.Db.add(new gi),this.Db.add(new Ed),this.Db.add(new pc),this.Db.add(new Mh),this.Db.add(new h),this.Db.add(new Oc),this.Db.add(new Df),this.Db.add(new Hg),this.Db.add(new yf),this.Db.add(new Fd),this.Db.add(new wf),this.Db.add(new Id),this.Db.add(new $d),this.Db.add(new af),this.Db.add(new td),this.Db.add(new se),this.Db.add(new Me),this.Db.add(new fc),this.Db.add(new Xb),this.Db.add(new Dh),this.Db.add(new vg),this.Db.add(new Ec),this.Db.add(new zg),this.Db.add(new Fe),
ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.A2i());return this.Db}}});Vf.vAb=null;Vf.UDe=new Yf;Object(ae.a)(Vf,"MacroRecorderEventList",null,[]);var Mi=lj.a;vm(qg,Mi);qg.prototype.create=function(){this.Fb(this.$.da.Aa(297)||new Cj(this.$,new Vf(this.$),new ta))};qg.ja=function(F){F.da.Ha(298,new qg(F))};Object(ae.a)(qg,"MacroRecorderEventHandlerFactory",lj.a,[]);var Ad=b(817),Se=b(78),Vg=b(35);If.prototype.Xc=function(){return!1};If.prototype.executeCommand=
function(F,fa,Pa){F=Vg.TaskExtensions.om();fa=fa.command;switch(fa){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.Ce(2045014907,-1,0,null),this.automateCommandManager.Pji(fa,1904816141===fa?Pa[Se.a.hd].toString():null)}return F};If.prototype.Gc=function(F,fa){F=!1;switch(fa.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:F=this.$.Xaa}return F};If.prototype.fd=function(F,fa,Pa){return"PopulateAutomateGalleryMenu"===
fa&&this.$.Xaa?(this.automateCommandManager.fd(fa,Pa),!0):!1};Object(ae.a)(If,"AutomateCommandHandler",null,[147]);var Wj=b(457),Ck=Ad.a;vm(Zf,Ck);Zf.prototype.Md=function(){var F=this;Wj.a(this.$,374,375,this.tb,function(){var fa=F.$.da.Aa(352);fa?F.Ed([new If(fa,F.$)]):Re.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};Zf.ja=function(F){F.da.Ha(308,new Zf(F))};Object(ae.a)(Zf,"AutomateCommandHandlerFactory",Ad.a,[]);Object(ae.a)(og,
"AuthContext",null,[]);var zf=b(577),Vh=b(125),ji=b(107),Hh=b(26),Ij=b(947),ci=b(176);bg.prototype.getAuthContext=function(){return this.wnb};bg.prototype.W$b=function(){function F(Vc,rd){return(new Promise(function(Hd){window.setTimeout(function(){Hd(Vc)},rd)})).then(function(Hd){yb.push(Object.assign(new Rf.a,{name:"Error"+Cc,string:Hd.ErrorMessage}));yb.push(Object.assign(new Rf.a,{name:"ErrorCode"+Cc,string:Hd.ErrorCode}));Cc++;return fa.o7f()})}var fa=this,Pa=Hh.a.Ra.Kb,yb=[];if(this.oAuthManager)yb.push(Object.assign(new Rf.a,
{name:"IsAuthSupported",bool:this.hqe}));else return this.y7b(yb,Pa,"need_OAuthManager","No OAuthManager");if(!this.Dv.Gx||!this.Dv.Gx.value)return this.y7b(yb,Pa,"need_license","No License");if(fg.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.y7b(yb,Pa,"need_user","Anonymous User");if(33E5>Date.now()-this.wnb.timeStamp)return yb.push(Object.assign(new Rf.a,{name:"UsedCachedToken",bool:!0})),ci.a(Vh.a.Iwd,!0,0,yb),Promise.resolve(Object.assign(new Ij.a,{IsSuccess:!0,Token:this.wnb.token}));
yb.push(Object.assign(new Rf.a,{name:"UsedCachedToken",bool:!1}));var Cc=1;return this.o7f().catch(function(Vc){return F(Vc,200)}).catch(function(Vc){return F(Vc,400)}).then(function(Vc){Vc.IsSuccess?(fa.wnb.token=Vc.Token,fa.wnb.timeStamp=Date.now()):(yb.push(Object.assign(new Rf.a,{name:"Error"+Cc,string:Vc.ErrorMessage})),yb.push(Object.assign(new Rf.a,{name:"ErrorCode"+Cc,string:Vc.ErrorCode})));yb.push(Object.assign(new Rf.a,{name:"Attempts",int64:Cc}));yb.push(Object.assign(new Rf.a,{name:"Error",
string:Vc.ErrorMessage}));yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Vc.ErrorCode}));ci.a(Vh.a.Iwd,Vc.IsSuccess,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);return Promise.resolve(Vc)}).catch(function(Vc){yb.push(Object.assign(new Rf.a,{name:"Error"+Cc,string:Vc.ErrorMessage}));yb.push(Object.assign(new Rf.a,{name:"ErrorCode"+Cc,string:Vc.ErrorCode}));yb.push(Object.assign(new Rf.a,{name:"Attempts",int64:Cc}));return fa.y7b(yb,Pa,Vc.ErrorCode,Vc.ErrorMessage)})};bg.prototype.y7b=function(F,
fa,Pa,yb){F.push(Object.assign(new Rf.a,{name:"Error",string:yb}));F.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Pa}));ci.a(Vh.a.Iwd,!1,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),F);return Promise.resolve(Object.assign(new Ij.a,{IsSuccess:!1,ErrorMessage:yb,ErrorCode:Pa}))};bg.prototype.o7f=function(){var F=this,fa=zf.a.jTh(),Pa=0;fa=this.oAuthManager.XR("Maker",fa).then(function(yb){if(yb)return!yb.IsSuccess&&F.Xpj(yb)?Promise.reject(yb):Promise.resolve(yb);yb=Object.assign(new Ij.a,{IsSuccess:!1,
ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(yb)}).catch(function(yb){var Cc=new Ij.a;Object.getType(yb)===Object.getType(Cc)?Cc=yb:(Cc.ErrorMessage=yb.toString(),Cc.ErrorCode="exception");return Promise.reject(Cc)});return Promise.race([fa,new Promise(function(yb,Cc){Pa=window.setTimeout(function(){Cc(Object.assign(new Ij.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(yb){window.clearTimeout(Pa);
return yb})};bg.prototype.Xpj=function(F){return"interaction_required"===F.ErrorCode||"InitFailed"===F.ErrorCode||"invalid_resource"===F.ErrorCode||"login_required"===F.ErrorCode&&F.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(ae.a)(bg,"AutomateCommandAuth",null,[399]);var Ej=b(948);Object(ae.a)(Af,"AutomateCommandGalleryBase",null,[]);var L=b(845),Fa=b(28),Qb=b(864),yc=b(1368),Yc=b(16),Ke=b(51),De=b(14),tf=b(823),Mf=b(999);bf.prototype.jBh=function(F){var fa=this.automateCommandManager.Sa.zp().JB(),
Pa=bf.WT(F,De.a.instance.ea(2072));this.NSc(Pa,zf.a.ALi,this.automateCommandManager.eg,zf.a.hxi,De.a.instance.ea(2068),this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Pa);Pa=bf.WT(F,De.a.instance.ea(2073));this.NSc(Pa,zf.a.jui,zf.a.iK?this.automateCommandManager.Lk.HQe(this.automateCommandManager.eg):this.automateCommandManager.Jm.HQe(this.automateCommandManager.eg),zf.a.ppf,De.a.instance.ea(2069),this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Pa);Pa=bf.WT(F,De.a.instance.ea(2074));
this.NSc(Pa,zf.a.Mbj,this.automateCommandManager.ir,zf.a.ppf,"",this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Pa);Pa=Object.assign(new L.a,{Id:zf.a.Kme,ExternalId:zf.a.Kme,Command:"1606046412",LabelText:De.a.instance.ea(2065),Alt:De.a.instance.ea(2066),Image16by16:Ke.a.Be(16),Image16by16Class:Yc.a.ALe,Visible:!0});F=bf.WT(F,null);F.ControlsId="myScriptsSection.Controls";Array.add(F.ControlList,Pa);Array.add(fa.MenuSectionList,F);return fa};bf.prototype.NSc=function(F,fa,Pa,yb,Cc,Vc){if(Pa&&
0<Pa.length){fa=Vc.iA(fa,1,"Size150by20").m_b();Cc={};Vc={};Vc.root=bf.Asa(320,30);Vc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Vc.label={margin:"0px 3px"};Cc.galleryButtonInExpanded=Vc;fa.GalleryStyle=Cc;for(Cc=0;Cc<Pa.length&&Cc<yb;Cc++)Vc=Pa.IJ(Cc),Array.add(fa.GalleryItems,bf.S2b(Vc.id,Vc,!1));Array.add(F.ControlList,fa)}else Pa=Object.assign(new Mf.a,{Id:fa,ExternalId:fa,LabelText:Cc}),F.ControlsId=Pa.Id+".Controls",
Array.add(F.ControlList,Pa)};bf.dTe=function(F){if(F){var fa=String.format(zf.a.Y5h,F.isShared?zf.a.L6f:zf.a.ySf,Ke.a.Be(16));F=String.format(zf.a.Z5h,Fa.a.If(F.name));return String.format(zf.a.X5h,fa,F)}return""};bf.WT=function(F,fa){return Object.assign(new Qb.a,{Id:F,Title:fa,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};bf.S2b=function(F,fa,Pa){var yb=Pa?zf.a.qEj:zf.a.pEj,Cc=Pa?zf.a.ddj:zf.a.cdj,Vc=Pa?zf.a.L6f:zf.a.rEj,rd=Pa?zf.a.ySf:
zf.a.edj;return fa?bf.cBe(fa.cD||fa.id,fa.name,Pa,fa.isShared?yb:Cc,F,F,fa.isShared?Vc:rd):bf.cBe("","",Pa,"",F,F)};bf.cBe=function(F,fa,Pa,yb,Cc,Vc,rd){Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?null:Vc;rd=void 0===rd?null:rd;var Hd=void 0===Hd?null:Hd;var te={},hf={};Pa?(te.root=bf.Asa(32,32),hf.root=bf.Asa(32,32)):(te.root=bf.Asa(20,20),hf.root=bf.Asa(20,20));return Object.assign(new yc.a,{Id:F,ExternalId:Cc||F,MenuItemId:Vc||F,Command:"1904816141",Icon:yb,Image:Ke.a.Be(16),ImageClass:rd,LabelText:fa,
FullIconStyle:te,PreviewIconStyle:hf,Alt:Hd||fa})};bf.Asa=function(F,fa){var Pa={};Pa.width=F;Pa["min-width"]=F;Pa.height=fa;return Pa};Object(ae.a)(bf,"AutomateCommandRenderer",null,[]);pe.prototype.UJa=function(F){for(var fa=0;fa<this.scripts.length;fa++)if(this.scripts[fa].id===F||this.scripts[fa].cD===F)return fa;return-1};pe.prototype.sort=function(){this.o1f(this.scripts)};pe.prototype.Qn=function(F){return-1===this.UJa(F.id)?(this.scripts.push(F),!0):!1};pe.prototype.uXa=function(F){return-1===
this.UJa(F.id)?(this.scripts=[F].concat(this.scripts),!0):!1};pe.prototype.hnf=function(F){F=this.UJa(F.id);if(-1!==F){for(var fa=this.scripts[F].lha();0<F;)this.scripts[F]=this.scripts[F-1],F--;this.scripts[0]=fa}};pe.prototype.Xda=function(F){var fa=this.UJa(F.id);if(-1!==fa){var Pa=this.scripts[fa].cD;this.scripts[fa]=F;this.scripts[fa].cD=Pa}};pe.prototype.yfc=function(F){var fa=this.UJa(F.id);return-1!==fa?F.name===this.scripts[fa].name:!1};pe.prototype.Qha=function(F){F=this.UJa(F);return-1!==
F?(this.scripts.splice(F,1),!0):!1};pe.prototype.clear=function(){this.scripts=[]};pe.prototype.getScripts=function(){return this.scripts};pe.prototype.Ty=function(F){F=this.UJa(F);return-1!==F?this.scripts[F]:null};pe.prototype.IJ=function(F){return 0<=F&&this.length>F?this.scripts[F]:null};pe.prototype.HQe=function(F){for(var fa=new pe([],this.o1f),Pa=0;Pa<this.scripts.length;Pa++){var yb=this.scripts[Pa];F.Ty(yb.id)||fa.Qn(yb)}return fa};pe.prototype.edb=function(){for(var F=[],fa=yl(this.scripts),
Pa=fa.next();!Pa.done;Pa=fa.next())F.push(Pa.value.gTd());return F};tl.Object.defineProperties(pe.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(ae.a)(pe,"ScriptCollection",null,[]);var Cg=b(181);wd.prototype.lha=function(){return new wd(this.i$)};wd.prototype.gTd=function(){return this.i$};tl.Object.defineProperties(wd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.i$.id}},cD:{configurable:!0,enumerable:!0,get:function(){return this.i$.shareId},
set:function(F){this.i$.shareId=F||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.i$.name}},mDe:{configurable:!0,enumerable:!0,get:function(){return this.i$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.i$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.i$.description}},r$e:{configurable:!0,enumerable:!0,get:function(){return this.i$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.cD&&
0<this.cD.length}}});Object(ae.a)(wd,"ScriptCore",null,[]);var sh=b(57),Of=b(41);vm(yd,Af);yd.prototype.Cac=function(F){switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.Je.Lk.Ty(F)||this.Je.Jm.Ty(F)||this.Je.eg.Ty(F)||this.Je.ir.Ty(F)}};yd.prototype.D$b=function(F,fa,Pa){var yb=null;if(this.Je.oKa)switch(F){case "1":case "2":case "3":yb=this.Ux.IJ(parseInt(F)-1);break;default:yb=this.Ux.Ty(F)}Of.a.isReactRibbonEnabled()?(Pa=ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Pa:!sh.a.Qf.uC,fa[Ej.a.GalleryButtonProps]=bf.S2b(F,yb,Pa)):fa[Ej.a.InnerHTML]=bf.dTe(yb);fa[Ej.a.Alt]=yb?yb.name:""};yd.prototype.WA=function(F){this.Ux=this.nFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Rf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Rf.a,{name:"HasReadRecentCachedScripts",bool:this.Je.iva}));fa.push(Object.assign(new Rf.a,{name:"ReadScriptsDone",bool:this.Je.qKa}));fa.push(Object.assign(new Rf.a,{name:"ReadSamplesScriptsDone",bool:this.Je.q6}));fa.push(Object.assign(new Rf.a,
{name:"SamplesScriptCount",int64:this.Je.ir.length}));fa.push(Object.assign(new Rf.a,{name:"ReadRecentScriptsDone",bool:this.Je.uca}));fa.push(Object.assign(new Rf.a,{name:"RecentScriptCount",int64:this.Je.Lk.length}));fa.push(Object.assign(new Rf.a,{name:"ReadWorkbookScriptsDone",bool:this.Je.Ss}));fa.push(Object.assign(new Rf.a,{name:"WorkbookScriptCount",int64:this.Je.eg.length}));ci.a(Vh.a.Hwd,!0,0,fa)};yd.prototype.Ebc=function(F){var fa=!1,Pa="",yb=new wd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};
Cc.RefreshOperation=F.operationName;switch(F.operationName){case zf.a.cFd:F=this.jvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.aFd:F=this.hvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.$Ed:F=this.gvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.bFd:F=this.ivb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.TJf:F=this.Lgd(yb),Pa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Re.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",
Pa),this.WA("RefreshGallery")):Re.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Pa);Cc.Message=Pa;Re.ULS.sendTraceTag(537170320,0,50,Bh.c(Cc))};yd.prototype.nFb=function(){for(var F=new pe([],function(){}),fa=this.Je.eg?this.Je.eg.length:0,Pa=this.Je.Lk?this.Je.Lk.length:0,yb=this.Je.ir?this.Je.ir.length:0,Cc=0,Vc=0;Vc<zf.a.nCd;Vc++)if(Vc<fa)F.Qn(this.Je.eg.IJ(Vc));else if(Vc-fa+Cc<Pa){var rd=this.Je.Lk.IJ(Vc-fa+
Cc);this.Je.eg.Ty(rd.id)?(Cc++,Vc--):F.Qn(rd)}else Vc-fa-Pa+Cc<yb&&F.Qn(this.Je.ir.IJ(Vc-fa+Cc-Pa));return F};yd.prototype.jvb=function(F){if(this.Je.Lk.uXa(F))var fa="";else{fa="";var Pa=F.lha();this.Je.eg.Xda(Pa);this.Je.eg.sort();this.Je.Lk.Xda(F)}return{returnValue:!0,message:fa}};yd.prototype.hvb=function(F){this.Je.eg.Qha(F.id);return this.Je.Lk.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};yd.prototype.gvb=
function(F){var fa=F.lha();fa.cD=null;this.Je.Lk.uXa(fa);return this.Je.eg.Qn(F)?(this.Je.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};yd.prototype.ivb=function(F){return this.Je.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};yd.prototype.Lgd=function(F){var fa=F.lha(),Pa=!1;this.Je.eg.yfc(fa)&&(this.Je.eg.Xda(fa),this.Je.eg.sort(),
Pa=!0);this.Je.Lk.uXa(F)?Pa=!0:this.Je.Lk.yfc(F)&&(this.Je.Lk.Xda(F),this.Je.Lk.hnf(F),Pa=!0);return{returnValue:Pa,message:""}};Object(ae.a)(yd,"AutomateCommandGallery",Af,[]);var dh=b(86);Object(ae.a)(ad,"AutomateCommandLicensingBase",null,[]);Object(ae.a)(kc,"BoolResultWrapper",null,[]);vm(ve,ad);ve.prototype.Ave=function(){var F=this,fa=Hh.a.Ra.Kb,Pa=[];return new Promise(function(yb){dh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Cc){Cc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Vc){Pa.push(Object.assign(new Rf.a,{name:"IsLicensed",bool:Vc}));ci.a(Vh.a.Tpf,!0,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),Pa);F.Gx=new kc(Vc,!0);yb(Vc)}).catch(function(Vc){Pa.push(Object.assign(new Rf.a,{name:"IsLicensed",bool:!1}));Pa.push(Object.assign(new Rf.a,{name:"Error",string:Vc.toString()}));Pa.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"}));ci.a(Vh.a.Tpf,!1,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),Pa);F.Gx=new kc(!1,!1,void 0,"exception",Vc.toString());
yb(!1)})})})};Object(ae.a)(ve,"AutomateCommandLicensing",ad,[]);var xi=b(1288),ui=b(1286),zi=b(1285),mj=b(1287);fe.taskPaneWidth="TaskPaneWidth";fe.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";fe.al="TaskPaneTitle";fe.Vj="IconCssClass";fe.pSd="TaskPaneIconUrl";fe.PR="TaskPaneIconId";fe.DH="NonPersistedSettings";fe.onTaskPaneClose="OnTaskPaneClose";fe.wRc="ActionArgs";Object(ae.a)(fe,"PropertyNames",null,[]);var nj=b(139),bj=b(179),hj=b(304),Ni=b(4);vm(Wc,Af);Wc.prototype.Cac=
function(F){switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.automateCommandManager.Lk.Ty(F)||this.automateCommandManager.eg.Ty(F)||this.automateCommandManager.ir.Ty(F)}};Wc.prototype.D$b=function(F,fa,Pa){var yb=null;if(this.automateCommandManager.oKa)switch(F){case "1":case "2":case "3":yb=this.Ux.IJ(parseInt(F)-1);break;default:yb=this.Ux.Ty(F)}Of.a.isReactRibbonEnabled()?(Pa=ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Pa:!sh.a.Qf.uC,fa[Ej.a.GalleryButtonProps]=bf.S2b(F,yb,Pa)):fa[Ej.a.InnerHTML]=bf.dTe(yb);fa[Ej.a.Alt]=yb?yb.name:""};Wc.prototype.WA=function(F){this.Ux=this.nFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Rf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Rf.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.iva}));fa.push(Object.assign(new Rf.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.qKa}));fa.push(Object.assign(new Rf.a,{name:"ReadSamplesScriptsDone",
bool:this.automateCommandManager.q6}));fa.push(Object.assign(new Rf.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.ir.length}));fa.push(Object.assign(new Rf.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.uca}));fa.push(Object.assign(new Rf.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Lk.length}));fa.push(Object.assign(new Rf.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.Ss}));fa.push(Object.assign(new Rf.a,{name:"WorkbookScriptCount",
int64:this.automateCommandManager.eg.length}));ci.a(Vh.a.Hwd,!0,0,fa)};Wc.prototype.Ebc=function(F){var fa=!1,Pa="",yb=new wd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};Cc.RefreshOperation=F.operationName;switch(F.operationName){case zf.a.cFd:F=this.jvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.aFd:F=this.hvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.$Ed:F=this.gvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.bFd:F=this.ivb(yb);Pa=F.message;fa=F.returnValue;
break;case zf.a.TJf:F=this.Lgd(yb),Pa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Re.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Pa),this.WA("RefreshGallery")):Re.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Pa);Cc.Message=Pa;Re.ULS.sendTraceTag(537170317,0,50,Bh.c(Cc))};Wc.prototype.nFb=function(){for(var F=new pe([],function(){}),fa=this.automateCommandManager.eg?
this.automateCommandManager.eg.length:0,Pa=this.automateCommandManager.Lk?this.automateCommandManager.Lk.length:0,yb=this.automateCommandManager.ir?this.automateCommandManager.ir.length:0,Cc=0,Vc=0;Vc<zf.a.nCd;Vc++)if(Vc<fa)F.Qn(this.automateCommandManager.eg.IJ(Vc));else if(Vc-fa+Cc<Pa){var rd=this.automateCommandManager.Lk.IJ(Vc-fa+Cc);this.automateCommandManager.eg.Ty(rd.id)?(Cc++,Vc--):F.Qn(rd)}else Vc-fa-Pa+Cc<yb&&F.Qn(this.automateCommandManager.ir.IJ(Vc-fa+Cc-Pa));return F};Wc.prototype.jvb=
function(F){if(this.automateCommandManager.Lk.uXa(F))var fa="";else{fa="";var Pa=F.lha();this.automateCommandManager.eg.Xda(Pa);this.automateCommandManager.eg.sort();this.automateCommandManager.Lk.Xda(F)}return{returnValue:!0,message:fa}};Wc.prototype.hvb=function(F){this.automateCommandManager.eg.Qha(F.id);return this.automateCommandManager.Lk.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};Wc.prototype.gvb=
function(F){var fa=F.lha();fa.cD=null;this.automateCommandManager.Lk.uXa(fa);return this.automateCommandManager.eg.Qn(F)?(this.automateCommandManager.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Wc.prototype.ivb=function(F){return this.automateCommandManager.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Wc.prototype.Lgd=function(F){var fa=
F.lha(),Pa=!1;this.automateCommandManager.eg.yfc(fa)&&(this.automateCommandManager.eg.Xda(fa),this.automateCommandManager.eg.sort(),Pa=!0);this.automateCommandManager.Lk.uXa(F)?Pa=!0:this.automateCommandManager.Lk.yfc(F)&&(this.automateCommandManager.Lk.Xda(F),this.automateCommandManager.Lk.hnf(F),Pa=!0);return{returnValue:Pa,message:""}};Object(ae.a)(Wc,"AutomateCommandGalleryOld",Af,[]);var Sj=b(19);Rc.p1f=function(F){F.sort(function(fa,Pa){return Pa.mDe-fa.mDe})};Rc.kKb=function(F){F.sort(function(fa,
Pa){return Sj.a.compare(fa.name,Pa.name,!0)})};Rc.Z_e=function(F){var fa;var Pa=fa=null;if(F){var yb=F.indexOf(":");if(-1!==yb)return fa=F.substr(0,yb),Pa=F.substr(yb+1),{returnValue:!0,jRd:fa,cD:Pa}}return{returnValue:!1,jRd:fa,cD:Pa}};Rc.dRh=function(F,fa){var Pa={};Pa[zf.a.Fcg]=encodeURIComponent(F.workbookContext.WorkbookFileName);Pa[zf.a.BSf]=fa.edb();return Bh.c(Pa)};Rc.LIf=function(F,fa){return Vg.TaskExtensions.zha(fa.CJa(zf.a.Deb),function(Pa){Pa=Pa.result;if(""!==Pa){Pa=Bh.b(Pa);var yb=
Pa[zf.a.BSf];if(Pa[zf.a.Fcg]===encodeURIComponent(F.workbookContext.WorkbookFileName)){Pa=new pe([],function(Vc){Rc.kKb(Vc)});yb=yl(yb);for(var Cc=yb.next();!Cc.done;Cc=yb.next())Pa.Qn(new wd(Cc.value));Pa.sort();return Pa}}},F.ma,3)};tl.Object.defineProperties(Rc.prototype,{oKa:{configurable:!0,enumerable:!0,get:function(){var F=zf.a.iK?this.iva:this.o4;return this.q6||F||this.qKa}},qKa:{configurable:!0,enumerable:!0,get:function(){return(zf.a.iK?this.uca:this.p6)&&this.Ss&&this.q6}}});Object(ae.a)(Rc,
"AutomateCommandStorageBase",null,[]);Object(ae.a)(Nc,"UserInfo",null,[]);var Bj=b(519),rk=b(163),Oi=b(81),oi=b(273);Object(ae.a)(hc,"LaunchSDXParams",null,[]);Object(ae.a)(le,"RunfromButtonParameters",null,[]);var Qk=b(164),fk=b(126),Zk=b(27),uk=b(913),Jj=b(48),Dk=b(101),Ek=b(46),vk=b(168);Be.prototype.Kmj=function(F){zf.a.xq?this.Je.Jm=F:this.Cbe=F};Be.prototype.Jmj=function(F){zf.a.xq?this.Je.eg=F:this.$$d=F};Be.prototype.Nmj=function(F){zf.a.xq?this.Je.ir=F:this.cde=F};Be.prototype.Lmj=function(F){this.Je.Lk=
F};Be.prototype.yJb=function(F){var fa=fg.AFrameworkApplication.ga.ra("IsO365CommercialHost"),Pa="",yb="",Cc=!1;var Vc=!(this.Dv.Gx&&this.Dv.Gx.isSuccess&&this.Dv.Gx.value&&(!this.Zz||!this.Zz.isSuccess));this.Dv.Gx&&!this.Dv.Gx.isSuccess?(yb=this.Dv.Gx.errorCode,Pa=this.Dv.Gx.errorMessage):this.Zz&&!this.Zz.isSuccess&&(yb=this.Zz.errorCode,Pa=this.Zz.errorMessage);var rd=[];rd.push(Object.assign(new Rf.a,{name:"IsScriptingEnabled",bool:this.aba}));rd.push(Object.assign(new Rf.a,{name:"IsValidHost",
bool:fa}));rd.push(Object.assign(new Rf.a,{name:"IsUserLicensed",bool:this.Dv.Gx?this.Dv.Gx.value:!1}));rd.push(Object.assign(new Rf.a,{name:"IsAdminSwitchOn",bool:this.Zz?this.Zz.value:!1}));rd.push(Object.assign(new Rf.a,{name:"ShowTab",bool:this.aba}));rd.push(Object.assign(new Rf.a,{name:"ServiceChecked",bool:!F}));this.aba&&Of.a.mwa(this.$)&&(F=Qk.a(this.$),(null===F||void 0===F?0:F.Lm)?(rd.push(Object.assign(new Rf.a,{name:"RibbonType",string:"React"})),F.Lm.Ktj(Ni.a.iFb),fa=["AutomateRecorder",
"AutomateNewScript","AutomateGallery","AutomateAllScripts"],ig.EwaSettings.getBooleanFeatureGate(zf.a.xof,!1)?F.Lm.IIb(["AutomateAutomateTask"],!zf.a.Wpf):(F.Lm.IIb(fa,!1),zf.a.Wpf&&F.Lm.IIb(["AutomateAutomateTask"],!1)),ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Cc=!0)):(yb="ribbon_manager_error",Pa="The RibbonManager or RibbonUser is null"));rd.push(Object.assign(new Rf.a,
{name:"Error",string:Pa}));rd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:yb}));ci.a(Vh.a.Zxi,Vc,ji.getElapsedMilliseconds(this.initTime,Hh.a.Ra.Kb),rd);return Promise.resolve(Cc)};Be.prototype.fd=function(F,fa){if(!fa)return!1;fa.MenuItems=this.IIg.jBh(fa.MenuId);return!0};Be.prototype.yRi=function(){var F=this;if(this.$va)if(zf.a.iK)this.Je.IIf(this.fP).continueWith(function(yb){yb.result&&F.fP.WA(zf.a.kPa)});else if(zf.a.xq)this.Je.iZi(this.fP);else{var fa=Hh.a.Ra.Kb,Pa=[];Vg.TaskExtensions.Ba(this.indexedDB.CJa(zf.a.VOa),
function(yb){var Cc=!F.p6||!F.Jm.length;yb=yb.result;Pa.push(Object.assign(new Rf.a,{name:"ExistingScriptCount",int64:F.Jm.length}));if(""!==yb)if(yb=Bh.b(yb),Pa.push(Object.assign(new Rf.a,{name:"CachedScriptCount",int64:yb.length})),Cc){for(var Vc=yl(yb),rd=Vc.next();!rd.done;rd=Vc.next())F.Jm.Qn(new wd(rd.value));F.Jm.sort();F.o4=!0;F.s$a=0<yb.length;ci.a(Vh.a.HBb,Cc,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),Pa);F.WA("CachedScripts")}else ci.a(Vh.a.HBb,Cc,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),
Pa);else ci.a(Vh.a.HBb,Cc,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),Pa)},this.$.ma,3)}nc(this.$)?this.j_e(Object.assign(new Ij.a,{IsSuccess:!0,Token:"FakeToken"})):this.Bra.W$b().then(function(yb){F.j_e(yb)})};Be.prototype.D$b=function(F,fa,Pa){if(zf.a.iK)this.fP.D$b(F,fa,Pa);else{var yb=null;if(this.oKa)switch(F){case "1":case "2":case "3":yb=this.Ux.IJ(parseInt(F)-1);break;default:yb=this.Ux.Ty(F)}fa[Ej.a.GalleryButtonProps]=bf.S2b(F,yb,this.Lgi?2===Pa:!sh.a.Qf.uC);fa[Ej.a.Alt]=yb?yb.name:""}};Be.prototype.Ebc=
function(F){if(zf.a.iK)this.fP.Ebc(F);else{var fa=!1,Pa="",yb=new wd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};Cc.RefreshOperation=F.operationName;switch(F.operationName){case zf.a.cFd:F=this.jvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.aFd:F=this.hvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.$Ed:F=this.gvb(yb);Pa=F.message;fa=F.returnValue;break;case zf.a.bFd:F=this.ivb(yb),Pa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Re.ULS.sendTraceTag(537170313,0,
50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Pa),this.WA("RefreshGallery")):Re.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Pa);Cc.Message=Pa;Re.ULS.sendTraceTag(537170311,0,50,Bh.c(Cc))}};Be.prototype.FYh=function(F,fa,Pa){this.$.xs(null,!1,1023)&&(F=new le(zf.a.ybj,F,fa,Pa,this.aba),this.Bnb.kvb(F),ig.EwaSettings.getBooleanFeatureGate(zf.a.y4f,!1)&&this.zJb(fa,Pa.toString()))};
Be.prototype.z3e=function(F,fa,Pa){F=new le(zf.a.jOj,F,fa,Pa,this.aba);this.Bnb.kvb(F)};Be.prototype.wWh=function(F){this.Bnb.pgd(zf.a.Xtj,F)};Be.prototype.vWh=function(F){this.Bnb.pgd(zf.a.dYg,F)};Be.prototype.xWh=function(F){this.Bnb.pgd(zf.a.dyj,F)};Be.prototype.Pji=function(F,fa){var Pa=Jj.b().pi(F),yb=[];yb.push(Object.assign(new Rf.a,{name:"SessionId",string:this.$.ya.UserSessionId}));yb.push(Object.assign(new Rf.a,{name:"MenuItemId",string:fa}));yb.push(Object.assign(new Rf.a,{name:"WorkbookScriptCount",
int64:this.eg.length}));yb.push(Object.assign(new Rf.a,{name:"PublishedScriptCount",int64:this.Jm.length}));yb.push(Object.assign(new Rf.a,{name:"RecentScriptCount",int64:this.Lk.length}));yb.push(Object.assign(new Rf.a,{name:"Command",string:Pa}));fa=fa?this.Cac(fa):null;if(Pa=this.xLh(F,Pa,fa))yb.push(Object.assign(new Rf.a,{name:zf.a.S9,string:Pa.iya.Sq[zf.a.S9]})),xi.a.instance.CMa(Pa.xsh,"Taskpane",Pa.GGa,Pa.hid,Pa.iya),1904816141===F&&(yb.push(Object.assign(new Rf.a,{name:"ScriptId",string:fa.id})),
yb.push(Object.assign(new Rf.a,{name:"ShareId",string:fa.cD})),yb.push(Object.assign(new Rf.a,{name:"IsPreviewGallery",bool:zf.a.iK?!!this.fP.Ux.Ty(fa.id):!!this.Ux.Ty(fa.id)})),yb.push(Object.assign(new Rf.a,{name:"IsOwner",bool:fa.r$e||!!this.Jm.Ty(fa.id)})),this.$.Gf());ci.a(Vh.a.Wxi,void 0,void 0,yb)};Be.prototype.xLh=function(F,fa,Pa){var yb=null,Cc=zf.a.nr,Vc=new ui.a(zf.a.Z5e,zf.a.ZRe,zf.a.locale),rd=new zi.a(zf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,zf.a.Usc),Hd=new mj.a;Hd.Sq.AdminPolicyForFeedback=
Bh.c(this.pFa);Hd.Sq.DocumentHostInfo=wi.a.Hc(this.$.ya.DocumentHostInfo);Hd.Sq.CodeEditorUrl=zf.a.Ptb(this.$);Hd.Sq.MakerTestService=ig.EwaSettings.getBooleanFeatureGate(zf.a.yAb,!1);Hd.Sq[zf.a.sQf]=zf.a.j2a(this.$);Hd.Sq.StorageModePreference=this.F2f||"";Hd.Sq.Source="Ribbon";Hd.Sq.IsTeams=uh.a.qka;Hd.Sq[zf.a.x4f]=wi.a.Hc(Cc);Hd.Sq[zf.a.$qe]=this.$.Spf?"true":"false";Hd.Sq[zf.a.S9]=bj.a.create().toString();var te=xd(this.$),hf=gd(this.$);Hd.ni.HeaderCssClass=te;Hd.ni.TitleCssClass=hf;Hd.Sq[zf.a.X4e]=
te;Hd.Sq[zf.a.E5f]=hf;te={};te.ribbonCommand=fa;te[zf.a.E2f]=this.Bra.getAuthContext();te[zf.a.VOa]=this.s$a?this.Jm.edb():null;te[zf.a.Deb]=this.Qya?this.eg.edb():null;zf.a.iK&&(te[zf.a.kPa]=this.Je.pEd?this.Lk.edb():null);Hd.Sq[zf.a.Z8e]=wi.a.Hc(te);fa={};cb(this.$,fa);Hd.Sq[zf.a.jRe]=wi.a.Hc(fa);switch(F){case -45542983:Hd.Sq.Script="";Hd.Sq.Destination="Editor";Hd.Sq.IsOwner=!0;Hd.ni[fe.al]=De.a.instance.ea(2061);Hd.ni[fe.taskPaneWidth]=Cc;Hd.ni[fe.sourceLocationOverrideResourceId]=zf.a.Ptb(this.$);
yb=zf.a.y_c;break;case -1342227603:Hd.ni[fe.al]=De.a.instance.ea(2063);Hd.ni[fe.taskPaneWidth]=Cc;Hd.ni[fe.sourceLocationOverrideResourceId]=zf.a.xOh(this.$);break;case 971811139:case 1606046412:Hd.Sq.Script="";Hd.Sq.Destination="BackStage";Hd.Sq.IsOwner=!0;Hd.ni[fe.al]=De.a.instance.ea(2061);Hd.ni[fe.taskPaneWidth]=Cc;Hd.ni[fe.sourceLocationOverrideResourceId]=zf.a.Ptb(this.$);yb=zf.a.y_c;break;case 1845457202:Hd.ni[fe.al]=De.a.instance.ea(2062);Hd.ni[fe.taskPaneWidth]=Cc;Hd.ni[fe.sourceLocationOverrideResourceId]=
zf.a.NZe(this.$);yb=zf.a.jdj;break;case 1904816141:if(Pa)Hd.Sq.Script=wi.a.Hc(Pa.gTd()),Hd.Sq.Destination="Details",Hd.Sq.IsOwner=Pa.r$e||!!this.Jm.Ty(Pa.id),Hd.ni[fe.al]=De.a.instance.ea(2061),Hd.ni[fe.taskPaneWidth]=Cc,Hd.ni[fe.sourceLocationOverrideResourceId]=zf.a.Ptb(this.$),yb=zf.a.y_c;else return null;break;default:return null}return new hc(Vc,rd,Hd,yb)};Be.prototype.vCh=function(){var F=this;dh.a.instance.mc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(fa){F.pFa.FeedbackEnabled=
!0;F.pFa.ScreenshotEnabled=!0;F.pFa.EmailEnabled=!0;fa.AJ("Enabled").then(function(Pa){F.pFa.FeedbackEnabled=Pa},function(){});fa.AJ("IncludeScreenshot").then(function(Pa){F.pFa.ScreenshotEnabled=Pa},function(){});fa.AJ("IncludeEmail").then(function(Pa){F.pFa.EmailEnabled=Pa},function(){})})};Be.prototype.kZh=function(F){var fa=this,Pa=Hh.a.Ra.Kb,yb=[];if(!F||!F.IsSuccess){var Cc=F?F.ErrorCode:"need_token";F=F?F.ErrorMessage:"No Access Token";yb.push(Object.assign(new Rf.a,{name:"ServiceChecked",
bool:!1}));yb.push(Object.assign(new Rf.a,{name:"Error",string:F}));yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Cc}));ci.a(Vh.a.Fwd,!1,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);this.Zz=new kc(!1,!1,void 0,Cc,F);return Promise.resolve(!1)}yb.push(Object.assign(new Rf.a,{name:"ServiceChecked",bool:!0}));ye(this.$,F.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Vc){fa.Zz=new kc(Vc.OfficeScriptingEnabled,!0);fa.xXc(zf.a.E9b(fa.$),Vc.OfficeScriptingEnabled);
yb.push(Object.assign(new Rf.a,{name:"IsEnabled",bool:fa.Zz.value}));ci.a(Vh.a.Fwd,!0,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);return Promise.resolve(fa.Zz.value)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(yb.push(Object.assign(new Rf.a,{name:"Error",string:Vc.message})),yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Vc.errorCode.toString(),Vc.status.toString())}))):(yb.push(Object.assign(new Rf.a,{name:"Error",string:Vc.toString()})),
yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"})));ci.a(Vh.a.Fwd,!1,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);fa.Zz=new kc(!1,!1,void 0,"exception",Vc.toString());return Promise.resolve(!1)})};Be.prototype.qEd=function(F){var fa=this;if(zf.a.xq)return this.Je.qEd(F,this.fP);var Pa=new nj.a,yb=re(this.$);return Jc(this.$,function(Cc){if((Cc=Cc.Result)&&200===Cc.ResponseStatusCode)Cc=JSON.parse(Cc.ResponseBody.join("")),F(fa.FAd(Cc.value)),Pa.setResult(!0);else{Cc=Cc?"RichApi_"+
Cc.ResponseStatusCode:"RichApiError";var Vc=[];Vc.push(Object.assign(new Rf.a,{name:"Error",string:"Failed to read shared script ids from document"}));Vc.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Cc}));fa.Ss=!0;fa.MT(Hh.a.Ra.Kb,0,Vc);Pa.setResult(!1)}},function(Cc){Cc=fk.a.yg(Cc.data);Re.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",Zk.a.Uc(Cc));var Vc=[];Vc.push(Object.assign(new Rf.a,{name:"Error",string:"Failure using rich api: "+
Cc}));Vc.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"RichApiFailure"}));fa.Ss=!0;fa.MT(Hh.a.Ra.Kb,0,Vc);Pa.setResult(!1)},yb,Pa)};Be.prototype.j_e=function(F){var fa=this;this.Ded();zf.a.iK?this.Je.EPh(F,this.fP,this.cache):this.cPh(F);this.qEd(function(Pa){fa.Qed(Pa,F)})};Be.prototype.Ded=function(){if(zf.a.xq)this.Je.Ded(this.fP);else{var F={id:"samples-2"};F.name=De.a.instance.ea(2075);this.ir.Qn(new wd(F));F.id="samples-4";F.name=De.a.instance.ea(2076);this.ir.Qn(new wd(F));F.id="samples-5";
F.name=De.a.instance.ea(2077);this.ir.Qn(new wd(F));this.q6=!0;this.WA("SampleScripts")}};Be.prototype.cPh=function(F){var fa=this,Pa=Hh.a.Ra.Kb,yb=[];if(F&&F.IsSuccess){ye(this.$,F.Token);var Cc=tj.a.create().toString();yb.push(Object.assign(new Rf.a,{name:"CorrelationId",string:Cc}));makerstorage.getScripts(Cc).then(function(Vc){yb.push(Object.assign(new Rf.a,{name:"HasReadCachedScripts",bool:fa.o4}));fa.Jm.clear();Vc=yl(Vc);for(var rd=Vc.next();!rd.done;rd=Vc.next())fa.Jm.Qn(new wd(rd.value));
fa.Jm.sort();fa.s$a=!0;fa.p6=!0;fa.$va&&(Vc=wi.a.Hc(fa.Jm.edb()),fa.indexedDB.Sab(new uk.a(zf.a.VOa,Vc)));yb.push(Object.assign(new Rf.a,{name:"ScriptCount",int64:fa.Jm.length}));ci.a(Vh.a.IBb,!0,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);fa.WA(zf.a.VOa)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(yb.push(Object.assign(new Rf.a,{name:"Error",string:Vc.message})),yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Vc.errorCode.toString(),
Vc.status.toString())})),17===Vc.errorCode&&fa.cache.eGd(zf.a.E9b(fa.$))):(yb.push(Object.assign(new Rf.a,{name:"Error",string:Vc.toString()})),yb.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"})));ci.a(Vh.a.IBb,!1,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);fa.p6=!0;fa.WA(zf.a.VOa)})}else Cc=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:"No Access Token",yb.push(Object.assign(new Rf.a,{name:"ServiceChecked",bool:!1})),yb.push(Object.assign(new Rf.a,{name:"Error",string:F})),yb.push(Object.assign(new Rf.a,
{name:"ErrorCode",string:Cc})),ci.a(Vh.a.IBb,!1,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb),this.p6=!0,this.WA(zf.a.VOa)};Be.prototype.Qed=function(F,fa){var Pa=this;if(zf.a.xq)this.Je.Qed(F,fa,this.fP);else{var yb=Hh.a.Ra.Kb,Cc=0,Vc=0;this.Ss=Cc===F.count;var rd=[];rd.push(Object.assign(new Rf.a,{name:"ScriptIds",int64:F.count}));if(F.count)if(fa&&fa.IsSuccess){ye(this.$,fa.Token);var Hd={};fa=yl(F);for(var te=fa.next();!te.done;Hd={Oeb:Hd.Oeb},te=fa.next())te=te.value,Hd.Oeb=tj.a.create().toString(),
makerstorage.getSharedScript(te.value,Hd.Oeb).then(function(hf){return function(ff){var lg=[];lg.push(Object.assign(new Rf.a,{name:"BodySize",int64:ff.body.length}));lg.push(Object.assign(new Rf.a,{name:"CorrelationId",string:hf.Oeb}));ci.a(Vh.a.Gkc,!0,ji.getElapsedMilliseconds(yb,Hh.a.Ra.Kb),lg);Cc++;ff=new wd(ff);ff.cD=F.na(ff.id);Pa.eg.Qn(ff);Pa.Ss=Cc===F.count;Pa.Qya=!0;Pa.MT(yb,Vc,rd)}}(Hd)).catch(function(hf){return function(ff){var lg=[];Object.getType(ff)===makerstorage.StorageServiceError?
(rd.push(Object.assign(new Rf.a,{name:"Error",string:ff.message})),rd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",ff.errorCode.toString(),ff.status.toString())}))):(lg.push(Object.assign(new Rf.a,{name:"Error",string:ff.toString()})),lg.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"})));lg.push(Object.assign(new Rf.a,{name:"CorrelationId",string:hf.Oeb}));ci.a(Vh.a.Gkc,!1,ji.getElapsedMilliseconds(yb,Hh.a.Ra.Kb),lg);Cc++;Vc++;Pa.Ss=Cc===
F.count;Pa.MT(yb,Vc,rd)}}(Hd))}else Hd=fa?fa.ErrorCode:"need_token",fa=fa?fa.ErrorMessage:"No Access Token",rd.push(Object.assign(new Rf.a,{name:"Error",string:fa})),rd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Hd})),this.Ss=!0,this.MT(yb,Vc,rd);else this.Ss=this.Qya=!0,this.MT(yb,Vc,rd)}};Be.prototype.MT=function(F,fa,Pa){this.Ss&&(Pa.push(Object.assign(new Rf.a,{name:"ScriptCount",int64:this.eg.length})),Pa.push(Object.assign(new Rf.a,{name:"ScriptErrorCount",int64:fa})),ci.a(Vh.a.Vpf,
!fa,ji.getElapsedMilliseconds(F,Hh.a.Ra.Kb),Pa),this.eg.sort(),this.WA(zf.a.Deb))};Be.prototype.FAd=function(F){var fa=new Dk.a;if(F=Be.eta.parseFromString(F,"text/xml").querySelector('[id="script-ids-node-id"]')){F=F.getElementsByTagName("scriptId");for(var Pa={},yb=0;yb<F.length;Pa={iOb:Pa.iOb,fOb:Pa.fOb,$Nb:Pa.$Nb},yb++)Pa.iOb=F[yb].getAttribute("id"),Pa.iOb&&(Pa.fOb=void 0,Pa.$Nb=void 0,function(Cc){return function(){var Vc=Rc.Z_e(Cc.iOb);Cc.fOb=Vc.jRd;Cc.$Nb=Vc.cD;return Vc}}(Pa)().returnValue&&
fa.ia(Pa.fOb,Pa.$Nb))}return fa};Be.prototype.Cac=function(F){if(zf.a.iK)return this.fP.Cac(F);switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.Jm.Ty(F)||this.eg.Ty(F)||this.ir.Ty(F)}};Be.prototype.jvb=function(F){if(this.Jm.Qn(F)){this.Jm.sort();var fa=""}else{fa="";var Pa=F.lha();this.eg.Xda(Pa);this.eg.sort();this.Jm.Xda(F);this.Jm.sort()}return{returnValue:!0,message:fa}};Be.prototype.hvb=function(F){this.eg.Qha(F.id);return this.Jm.Qha(F.id)?{returnValue:!0,
message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};Be.prototype.gvb=function(F){var fa=F.lha();fa.cD=null;this.Jm.Qn(fa)&&this.Jm.sort();return this.eg.Qn(F)?(this.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Be.prototype.ivb=function(F){return this.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
Be.prototype.WA=function(F){if(zf.a.iK)this.fP.WA(F);else{this.nFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Rf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Rf.a,{name:"HasReadCachedScripts",bool:this.o4}));fa.push(Object.assign(new Rf.a,{name:"ReadScriptsDone",bool:this.qKa}));fa.push(Object.assign(new Rf.a,{name:"ReadSamplesScriptsDone",bool:this.q6}));fa.push(Object.assign(new Rf.a,{name:"SamplesScriptCount",int64:this.ir.length}));fa.push(Object.assign(new Rf.a,{name:"ReadPublishedScriptsDone",
bool:this.p6}));fa.push(Object.assign(new Rf.a,{name:"PublishedScriptCount",int64:this.Jm.length}));fa.push(Object.assign(new Rf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ss}));fa.push(Object.assign(new Rf.a,{name:"WorkbookScriptCount",int64:this.eg.length}));ci.a(Vh.a.Hwd,!0,0,fa)}};Be.prototype.nFb=function(){this.Ux=new pe([],function(){});for(var F=this.eg?this.eg.length:0,fa=this.Jm?this.Jm.length:0,Pa=this.ir?this.ir.length:0,yb=0,Cc=0;Cc<zf.a.nCd;Cc++)if(Cc<F)this.Ux.Qn(this.eg.IJ(Cc));else if(Cc-
F+yb<fa){var Vc=this.Jm.IJ(Cc-F+yb);this.eg.Ty(Vc.id)?(yb++,Cc--):this.Ux.Qn(Vc)}else Cc-F-fa+yb<Pa&&this.Ux.Qn(this.ir.IJ(Cc-F+yb-fa))};Be.prototype.xXc=function(F,fa){if(zf.a.xq)this.Je.xXc(F,fa);else if(this.cache.og()){var Pa={};Pa.TimeStamp=Hh.a.Ra.Kb;Pa.IsEnabled=fa;this.cache.quc(F,wi.a.Hc(Pa))}};Be.prototype.tbd=function(F){if(zf.a.xq)return this.Je.tbd(F);var fa=!1,Pa=!1,yb=null;this.cache.og()&&(F=Bh.b(this.cache.K2a(F)))&&(Pa=F.IsEnabled,yb=new Date(F.TimeStamp),fa=!0);return new kc(Pa,
fa,yb)};Be.prototype.zJb=function(F,fa){this.businessBarManager.zje(63,{Zca:"preparing",yza:F,Z0b:fa})};Be.prototype.JHd=function(F){ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(F?(Ek.PageLoadTrackingInfo.instance.gma(Ni.a.uR,["automateTab"]),Ek.PageLoadTrackingInfo.instance.L_(Ni.a.uR,["automateTab"]),Ek.PageLoadTrackingInfo.instance.oW(Ni.a.uR,["automateTab"])):
(Ek.PageLoadTrackingInfo.instance.GPa(Ni.a.uR,["automateTab"]),ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&vk.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Ni.a.iFb))))};tl.Object.defineProperties(Be.prototype,{Jm:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.Jm:this.Cbe}},eg:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.eg:this.$$d}},ir:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?
this.Je.ir:this.cde}},Lk:{configurable:!0,enumerable:!0,get:function(){return this.Je.Lk}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.WNc}},q6:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.q6:this.Ube},set:function(F){zf.a.xq?this.Je.q6=F:this.Ube=F}},Ss:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.Ss:this.Wbe},set:function(F){zf.a.xq?this.Je.Ss=F:this.Wbe=F}},uca:{configurable:!0,enumerable:!0,get:function(){return this.Je.uca}},iva:{configurable:!0,
enumerable:!0,get:function(){return this.Je.iva}},qKa:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.qKa:(zf.a.iK?this.uca:this.p6)&&this.Ss&&this.q6}},oKa:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.oKa:(zf.a.iK?this.iva:this.o4)||this.qKa}},Ux:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq||zf.a.iK?this.fP.Ux:this.sbe},set:function(F){zf.a.xq||zf.a.iK?this.fP.Ux=F:this.sbe=F}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Slg}},
aba:{configurable:!0,enumerable:!0,get:function(){var F=!!this.Dv.Gx&&this.Dv.Gx.isSuccess&&this.Dv.Gx.value,fa=!!this.Zz&&!this.Zz.isSuccess,Pa=!!this.Zz&&this.Dv.Gx.isSuccess&&this.Zz.value;return this.Ref&&F&&(Pa||fa&&!uh.a.uwa(11))}},s$a:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.s$a:this.Sbe},set:function(F){zf.a.xq?this.Je.s$a=F:this.Sbe=F}},Qya:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.Qya:this.Vbe},set:function(F){zf.a.xq?this.Je.Qya=F:
this.Vbe=F}},o4:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.o4:this.G4d},set:function(F){zf.a.xq?this.Je.o4=F:this.G4d=F}},p6:{configurable:!0,enumerable:!0,get:function(){return zf.a.xq?this.Je.p6:this.Tbe},set:function(F){zf.a.xq?this.Je.p6=F:this.Tbe=F}},Ref:{configurable:!0,enumerable:!0,get:function(){var F="TestHost"===this.$.ya.DocumentHostInfo.HostTier,fa=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");fa=!fg.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!fa&&
!fa.includes("ext#")&&!fa.includes("guest#");return!uh.a.fwa&&(F||this.Bra.hqe&&fa)}}});Be.eta=new DOMParser;Object(ae.a)(Be,"AutomateCommandManager",null,[397]);var Fj=b(1343),sj=b(1290),Kj=b(234);Ce.key="InsertAgaveClientSideParametersKey";Object(ae.a)(Ce,"InsertAgaveClientSideParameters",null,[]);var Zi=b(56),gk=b(103),Rh=b(20);ue.prototype.kvb=function(F){if(F.aba){var fa=[];fa.push(Object.assign(new Rf.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.U5a}));fa.push(Object.assign(new Rf.a,
{name:"actionName",string:F.actionName}));fa.push(Object.assign(new Rf.a,{name:zf.a.S9,string:F.Z0b.toString()}));this.U5a?this.rTf(F):this.dXh(F);ci.a(Vh.a.Xxi,void 0,void 0,fa)}};ue.prototype.pgd=function(F,fa){var Pa={};Pa[zf.a.S9]=fa;this.bLd(F,Pa)};ue.prototype.enj=function(){this.gZf()?this.sEf():Rh.g(this.$).Ca.oke(this.a8a)};ue.prototype.gZf=function(){if(this.U5a||nc(this.$))return!1;var F=gk.a(this.$);return Rh.g(this.$).Ca.DYb&&F.N8h()};ue.prototype.sEf=function(){var F=this;this.Dv.Gx?
this.Dv.Gx.value&&this.Bra.W$b():this.Dv.Ave().then(function(fa){fa&&F.Bra.W$b()});ci.a(Vh.a.Txi)};ue.prototype.ufj=function(){var F=bj.a.create().toString(),fa={};cb(this.$,fa);var Pa={};Pa[zf.a.E2f]=this.Bra.getAuthContext();var yb={};yb[zf.a.jRe]=wi.a.Hc(fa);yb[zf.a.Z8e]=wi.a.Hc(Pa);yb[zf.a.Dch]=wi.a.Hc(this.$.ya.DocumentHostInfo);yb[zf.a.kyj]=Bc(this.$);yb[zf.a.x4f]=wi.a.Hc(zf.a.nr);yb[zf.a.$qe]=this.$.Spf?"true":"false";yb[zf.a.sQf]=zf.a.j2a(this.$);yb[zf.a.X4e]=xd(this.$);yb[zf.a.E5f]=gd(this.$);
yb[zf.a.S9]=F;fa=[];fa.push(Object.assign(new Rf.a,{name:zf.a.S9,string:F}));ci.a(Vh.a.Vxi,void 0,void 0,fa);this.bLd(zf.a.K3h,yb)};ue.prototype.dXh=function(F){var fa=this;nc(this.$)&&ye(this.$,"localstorage");Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(Pa){fa.sli(Pa.result).continueWith(function(){fa.tfj(F)});fa.U5a=!0},this.$.ma,3)};ue.prototype.sli=function(F){var fa={};fa.SolutionId=zf.a.assetId;fa.Version=zf.a.Usc;fa.StoreType=OSF.StoreType.Sdx;fa.StoreId=
OSF.StoreType.Sdx;fa.AssetId=zf.a.assetId;fa.AssetStoreId=OSF.StoreType.Sdx;fa.TargetType=1;fa.SharedRuntimeId=zf.a.Cub(this.$);fa.SourceLocationOverrideResourceId=zf.a.Cub(this.$);fa.IsToBePersisted=!1;fa.Id=zf.a.assetId;fa.AppVersion=zf.a.Usc;fa.CurrentStoreType=OSF.StoreType.Sdx;var Pa=new Fj.a;Pa.al=De.a.instance.ea(2081);Pa.taskPaneWidth=zf.a.nr;var yb=new Ce;yb.lyc=gd(this.$);yb.waa=xd(this.$);return F.bKd(fa,Pa,void 0,void 0,yb)};ue.prototype.tfj=function(F){this.ufj();Kj.a(this.$)&&Kj.a(this.$).Bke(this.aBi);
this.rTf(F)};ue.prototype.rTf=function(F){var fa={};fa[zf.a.Abj]=F.shapeId;fa[zf.a.zbj]=F.yza;fa[zf.a.S9]=F.Z0b.toString();this.bLd(F.actionName,fa)};ue.prototype.bLd=function(F,fa){var Pa=new zi.a(zf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,zf.a.Usc),yb=new ui.a(zf.a.Z5e,zf.a.ZRe,this.$.ya.UICultureTag),Cc=new mj.a;Cc.ni[fe.al]=De.a.instance.ea(2081);Cc.ni[fe.sourceLocationOverrideResourceId]=zf.a.Cub(this.$);Cc.ni[fe.wRc]=fa;Cc.ni[fe.taskPaneWidth]=zf.a.nr;xi.a.instance.CMa(Pa,sj.a.action,
F,yb,Cc)};Object(ae.a)(ue,"AutomateCommandRunFromButton",null,[396]);vm(ie,Rc);ie.prototype.xXc=function(F,fa){if(this.cache.og()){var Pa={};Pa.TimeStamp=Hh.a.Ra.Kb;Pa.IsEnabled=fa;this.cache.quc(F,wi.a.Hc(Pa))}};ie.prototype.tbd=function(F){var fa=!1,Pa=!1,yb=null;this.cache.og()&&(F=Bh.b(this.cache.K2a(F)))&&(Pa=F.IsEnabled,yb=new Date(F.TimeStamp),fa=!0);return new kc(Pa,fa,yb)};ie.prototype.IIf=function(F){var fa=this,Pa=Hh.a.Ra.Kb,yb=[];return Vg.TaskExtensions.zha(this.indexedDB.CJa(zf.a.kPa),
function(Cc){var Vc=!fa.uca||!fa.Lk.length;Cc=Cc.result;yb.push(Object.assign(new Rf.a,{name:"ExistingScriptCount",int64:fa.Lk.length}));if(""!==Cc&&(Cc=Bh.b(Cc),yb.push(Object.assign(new Rf.a,{name:"CachedScriptCount",int64:Cc.length})),Vc)){for(var rd=yl(Cc),Hd=rd.next();!Hd.done;Hd=rd.next())fa.Lk.Qn(new wd(Hd.value));fa.iva=!0;fa.pEd=0<Cc.length;ci.a(Vh.a.Upf,Vc,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);fa.YEd(F);return!0}ci.a(Vh.a.Upf,Vc,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);return!1},
this.$.ma,3)};ie.prototype.iZi=function(F){ig.EwaSettings.getBooleanFeatureGate(zf.a.UVc,!1)&&this.lZi(F);zf.a.iK?this.IIf(F):this.hZi(F)};ie.prototype.EPh=function(F,fa,Pa){var yb=this,Cc=Hh.a.Ra.Kb,Vc=[];if(F&&F.IsSuccess){ye(this.$,F.Token);var rd=tj.a.create().toString();Vc.push(Object.assign(new Rf.a,{name:"CorrelationId",string:rd}));makerstorage.getRecentScripts(rd).then(function(Hd){Vc.push(Object.assign(new Rf.a,{name:"HasReadCachedScripts",bool:yb.iva}));yb.Lk.clear();Hd=yl(Hd);for(var te=
Hd.next();!te.done;te=Hd.next())yb.Lk.Qn(new wd(te.value));yb.pEd=!0;yb.uca=!0;yb.indexedDB.og()&&(Hd=wi.a.Hc(yb.Lk.edb()),yb.indexedDB.Sab(new uk.a(zf.a.kPa,Hd)));Vc.push(Object.assign(new Rf.a,{name:"ScriptCount",int64:yb.Lk.length}));ci.a(Vh.a.IBb,!0,ji.getElapsedMilliseconds(Cc,Hh.a.Ra.Kb),Vc);fa.WA(zf.a.kPa)}).catch(function(Hd){Object.getType(Hd)===makerstorage.StorageServiceError?(Vc.push(Object.assign(new Rf.a,{name:"Error",string:Hd.message})),Vc.push(Object.assign(new Rf.a,{name:"ErrorCode",
string:String.format("makerstorage_{0}_{1}",Hd.errorCode.toString(),Hd.status.toString())})),17===Hd.errorCode&&Pa.eGd(zf.a.E9b(yb.$))):(Vc.push(Object.assign(new Rf.a,{name:"Error",string:Hd.toString()})),Vc.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"})));ci.a(Vh.a.Uxi,!1,ji.getElapsedMilliseconds(Cc,Hh.a.Ra.Kb),Vc);yb.uca=!0;fa.WA(zf.a.kPa)})}else rd=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:"No Access Token",Vc.push(Object.assign(new Rf.a,{name:"ServiceChecked",bool:!1})),
Vc.push(Object.assign(new Rf.a,{name:"Error",string:F})),Vc.push(Object.assign(new Rf.a,{name:"ErrorCode",string:rd})),ci.a(Vh.a.IBb,!1,ji.getElapsedMilliseconds(Cc,Hh.a.Ra.Kb),Vc),this.uca=!0,fa.WA(zf.a.kPa)};ie.prototype.qEd=function(F,fa){var Pa=this,yb=new nj.a,Cc=re(this.$);return Jc(this.$,function(Vc){if((Vc=Vc.Result)&&200===Vc.ResponseStatusCode)Vc=JSON.parse(Vc.ResponseBody.join("")),F(Pa.FAd(Vc.value)),yb.setResult(!0);else{Vc=Vc?"RichApi_"+Vc.ResponseStatusCode:"RichApiError";var rd=[];
rd.push(Object.assign(new Rf.a,{name:"Error",string:"Failed to read shared script ids from document"}));rd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:Vc}));Pa.Ss=!0;Pa.MT(fa,Hh.a.Ra.Kb,0,rd);yb.setResult(!1)}},function(Vc){Vc=fk.a.yg(Vc.data);Re.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var rd=[];rd.push(Object.assign(new Rf.a,{name:"Error",string:"Failure using rich api: "+Vc}));rd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"RichApiFailure"}));
Pa.Ss=!0;Pa.MT(fa,Hh.a.Ra.Kb,0,rd);yb.setResult(!1)},Cc,yb)};ie.prototype.Qed=function(F,fa,Pa){var yb=this,Cc=Hh.a.Ra.Kb,Vc=0,rd=0;this.Ss=Vc===F.count;var Hd=[];Hd.push(Object.assign(new Rf.a,{name:"ScriptIds",int64:F.count}));if(F.count)if(fa&&fa.IsSuccess){ye(this.$,fa.Token);var te={};fa=yl(F);for(var hf=fa.next();!hf.done;te={Peb:te.Peb},hf=fa.next())hf=hf.value,te.Peb=tj.a.create().toString(),makerstorage.getSharedScript(hf.value,te.Peb).then(function(ff){return function(lg){var Og=[];Og.push(Object.assign(new Rf.a,
{name:"BodySize",int64:lg.body.length}));Og.push(Object.assign(new Rf.a,{name:"CorrelationId",string:ff.Peb}));ci.a(Vh.a.Gkc,!0,ji.getElapsedMilliseconds(Cc,Hh.a.Ra.Kb),Og);Vc++;lg=new wd(lg);lg.cD=F.na(lg.id);yb.eg.Qn(lg);yb.Ss=Vc===F.count;yb.Qya=!0;yb.MT(Pa,Cc,rd,Hd)}}(te)).catch(function(ff){return function(lg){var Og=[];Object.getType(lg)===makerstorage.StorageServiceError?(Hd.push(Object.assign(new Rf.a,{name:"Error",string:lg.message})),Hd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
lg.errorCode.toString(),lg.status.toString())}))):(Og.push(Object.assign(new Rf.a,{name:"Error",string:lg.toString()})),Og.push(Object.assign(new Rf.a,{name:"ErrorCode",string:"exception"})));Og.push(Object.assign(new Rf.a,{name:"CorrelationId",string:ff.Peb}));ci.a(Vh.a.Gkc,!1,ji.getElapsedMilliseconds(Cc,Hh.a.Ra.Kb),Og);Vc++;rd++;yb.Ss=Vc===F.count;yb.MT(Pa,Cc,rd,Hd)}}(te)).finally(function(){if(ig.EwaSettings.getBooleanFeatureGate(zf.a.UVc,!1)&&yb.indexedDB.og()&&yb.Ss){var ff=Rc.dRh(yb.$,yb.eg);
yb.indexedDB.Sab(new uk.a(zf.a.Deb,ff))}})}else te=fa?fa.ErrorCode:"need_token",fa=fa?fa.ErrorMessage:"No Access Token",Hd.push(Object.assign(new Rf.a,{name:"Error",string:fa})),Hd.push(Object.assign(new Rf.a,{name:"ErrorCode",string:te})),this.Ss=!0,this.MT(Pa,Cc,rd,Hd);else this.Ss=this.Qya=!0,this.MT(Pa,Cc,rd,Hd),ig.EwaSettings.getBooleanFeatureGate(zf.a.UVc,!1)&&Vg.TaskExtensions.zha(Rc.LIf(this.$,this.indexedDB),function(ff){ff.result&&(yb.indexedDB.D4c(zf.a.Deb),yb.eg.clear(),Pa.WA("CachedScripts"))},
this.$.ma,3)};ie.prototype.Ded=function(F){var fa={id:"samples-6"};fa.name=De.a.instance.ea(2078);this.ir.Qn(new wd(fa));fa.id="samples-8";fa.name=De.a.instance.ea(2079);this.ir.Qn(new wd(fa));fa.id="samples-2";fa.name=De.a.instance.ea(2075);this.ir.Qn(new wd(fa));fa.id="samples-4";fa.name=De.a.instance.ea(2076);this.ir.Qn(new wd(fa));fa.id="samples-5";fa.name=De.a.instance.ea(2077);this.ir.Qn(new wd(fa));this.q6=!0;F.WA("SampleScripts")};ie.prototype.FAd=function(F){var fa=new Dk.a;if(F=this.eta.parseFromString(F,
"text/xml").querySelector('[id="script-ids-node-id"]')){F=F.getElementsByTagName("scriptId");for(var Pa={},yb=0;yb<F.length;Pa={jOb:Pa.jOb,gOb:Pa.gOb,aOb:Pa.aOb},yb++)Pa.jOb=F[yb].getAttribute("id"),Pa.jOb&&(Pa.gOb=void 0,Pa.aOb=void 0,function(Cc){return function(){var Vc=Rc.Z_e(Cc.jOb);Cc.gOb=Vc.jRd;Cc.aOb=Vc.cD;return Vc}}(Pa)().returnValue&&fa.ia(Pa.gOb,Pa.aOb))}return fa};ie.prototype.lZi=function(F){var fa=this,Pa=Hh.a.Ra.Kb,yb=[];Vg.TaskExtensions.zha(Rc.LIf(this.$,this.indexedDB),function(Cc){var Vc=
Cc.result;yb.push(Object.assign(new Rf.a,{name:"ExistingScriptCount",int64:fa.eg.length}));if(Vc){yb.push(Object.assign(new Rf.a,{name:"CachedScriptCount",int64:Vc.length}));if(Cc=!fa.Ss||0===fa.eg.length){Vc=yl(Vc.getScripts());for(var rd=Vc.next();!rd.done;rd=Vc.next())fa.eg.Qn(rd.value);fa.eg.sort();ci.a(Vh.a.Gwd,Cc,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);fa.YEd(F);return!0}ci.a(Vh.a.Gwd,Cc,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb)}else ci.a(Vh.a.Gwd,!1,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),
yb);return!1},this.$.ma,3)};ie.prototype.hZi=function(F){var fa=this,Pa=Hh.a.Ra.Kb,yb=[];Vg.TaskExtensions.zha(this.indexedDB.CJa(zf.a.VOa),function(Cc){var Vc=!fa.p6||!fa.Jm.length;Cc=Cc.result;yb.push(Object.assign(new Rf.a,{name:"ExistingScriptCount",int64:fa.Jm.length}));if(""!==Cc&&(Cc=Bh.b(Cc),yb.push(Object.assign(new Rf.a,{name:"CachedScriptCount",int64:Cc.length})),Vc)){Cc=yl(Cc);for(var rd=Cc.next();!rd.done;rd=Cc.next())fa.Jm.Qn(new wd(rd.value));fa.Jm.sort();ci.a(Vh.a.HBb,Vc,ji.getElapsedMilliseconds(Pa,
Hh.a.Ra.Kb),yb);fa.YEd(F);return!0}ci.a(Vh.a.HBb,Vc,ji.getElapsedMilliseconds(Pa,Hh.a.Ra.Kb),yb);return!1},this.$.ma,3)};ie.prototype.MT=function(F,fa,Pa,yb){this.Ss&&(yb.push(Object.assign(new Rf.a,{name:"ScriptCount",int64:this.eg.length})),yb.push(Object.assign(new Rf.a,{name:"ScriptErrorCount",int64:Pa})),ci.a(Vh.a.Vpf,!Pa,ji.getElapsedMilliseconds(fa,Hh.a.Ra.Kb),yb),this.eg.sort(),F.WA(zf.a.Deb))};ie.prototype.YEd=function(F){this.o4=!0;F.WA("CachedScripts")};Object(ae.a)(ie,"AutomateCommandStorage",
Rc,[]);var Ok=lj.a;vm(Qc,Ok);Qc.prototype.create=function(){var F=this,fa=Zi.GetServiceTaskFactory.Xa(this.$.da,349,350,this.tb),Pa=Ke.a.loadScript(109,4,this.tb,void 0,void 0,351),yb=Zi.GetServiceTaskFactory.create(this.$.da,102,this.$.ma,this.tb),Cc=Zi.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.tb),Vc=Zi.GetServiceTaskFactory.Xa(this.$.da,5,4,this.tb);Vg.TaskExtensions.Ba(Vg.TaskExtensions.ve([fa,Pa,yb,Cc,Vc],this.ma,3),function(){var rd=fa.result,Hd=Cc.result,te=Vc.result,hf=new ve,
ff=new bg(F.$,rd,hf),lg=new ie(F.$,Hd),Og=new yd(F.$,lg),lh=new ue(F.$,ff,hf);F.Fb(F.$.da.Aa(352)||new Be(F.$,rd,yb.result,Hd,lh,hf,ff,lg,Og,te))},this.ma,3)};Qc.ja=function(F){F&&F.da.Ha(351,new Qc(F))};Object(ae.a)(Qc,"AutomateCommandManagerFactory",lj.a,[]);var wk=b(848),Pk=b(821),lk=wk.a;vm(Sc,lk);Sc.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};Sc.qe=function(){return["AugLoop_Core_Annotation"]};Object(ae.a)(Sc,"DetectedHtmlTableAnnotation",wk.a,[]);var Gj=
b(36),Xj=b(43),xk=b(368),ak=b(92),Fk=Gj.a;vm(sc,Fk);sc.prototype.dispose=function(){window.removeEventListener("message",this.gDe,!1);Fk.prototype.dispose.call(this)};sc.prototype.YQf=function(F,fa){this.nwb=bj.a.create().toString();this.kwb="";this.imageHeight=this.imageWidth=0;this.errorMessage=this.tableData="";this.vRc=!1;this.KNi(F,fa);this.cMj()};sc.prototype.cMj=function(){if(this.kwb.length){var F=window.self.atob(this.kwb);for(var fa=Array(F.length),Pa=0;Pa<F.length;Pa++)fa[Pa]=F.charCodeAt(Pa);
this.augmentationLoopManager.bMj(fa,this.nwb,this.imageWidth,this.imageHeight)}else Re.ULS.sendTraceTag(537163343,0,50,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};sc.prototype.KNi=function(F,fa){fa.SessionID=this.nwb;fa.DataFromPictureURL="ImageToDoc.Dogfood.Url";fa.DataFromPictureAssetId="FA000000050";fa.LoadDataFromPictureTaskpane=!0;F=new ak.a(-859308420,F.method,F.mode,F.df,F.tabName);this.$.Ka.Zb(F,fa)};sc.prototype.sfj=function(){if(this.kwb.length){var F=
Kj.a(this.$).T$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.imageData=this.kwb;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Pa){Pa&&Re.ULS.sendTraceTag(537163341,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else Re.ULS.sendTraceTag(537163342,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};
sc.prototype.NTf=function(){if(this.tableData.length){var F=Kj.a(this.$).T$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.tableHtml=this.tableData;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Pa){Pa&&Re.ULS.sendTraceTag(537163339,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else Re.ULS.sendTraceTag(537163340,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};
sc.prototype.wTf=function(){if(this.errorMessage.length){var F=Kj.a(this.$).T$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.errorMessage=this.errorMessage;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Pa){Pa&&Re.ULS.sendTraceTag(537163337,0,50,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else Re.ULS.sendTraceTag(537163338,0,50,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
sc.prototype.initialize=function(){window.addEventListener("message",this.gDe,!1);this.augmentationLoopManager.activateAnnotation(this.T6e);this.augmentationLoopManager.aT(this.T6e,this.M1h)};Object(ae.a)(sc,"DataFromPicturePaneCommandManager",Gj.a,[]);var hk=b(175),oj=b(55);xg.prototype.Xc=function(){return!1};xg.prototype.executeCommand=function(F,fa,Pa){F=!1;switch(fa.command){case 73979048:this.Eqb?this.Eqb.YQf(fa,Pa):(this.ee=fa,this.QT=Pa,this.K3c=!0),F=!0}return F?oj.Task.Ta(!0):hk.a(fa.command)};
xg.prototype.Gc=function(F,fa){return 73979048===fa.command&&ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};xg.prototype.fd=function(){return!1};xg.prototype.dispose=function(){this.Eqb.dispose()};Object(ae.a)(xg,"DataFromPictureCommandHandler",null,[147,3]);var Gk=Ad.a;vm(sf,Gk);sf.prototype.Md=function(){this.Ed([new xg(this.$)])};sf.ja=function(F){Ad.a.de(452,new sf(F))};Object(ae.a)(sf,"DataFromPictureCommandHandlerFactory",Ad.a,[]);var Gg=b(846),Hk=b(819);
uf.prototype.tNh=function(F){Re.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",F);for(var fa=new Gh.a,Pa=yl(this.E_b),yb=Pa.next();!yb.done;yb=Pa.next()){yb=yl(yb.value.EBb);for(var Cc=yb.next();!Cc.done;Cc=yb.next())Cc=Cc.value,Cc.id===F&&fa.add(Cc)}return fa};uf.prototype.Tie=function(F){this.E_b.add(F)};uf.prototype.w2i=function(F){for(var fa=yl(this.E_b),Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa=Pa.value,Pa.Gme===F.Gme){this.E_b.remove(Pa);break}};uf.Aah=function(F,fa,Pa){Pa=void 0===
Pa?null:Pa;F=uf.QFh(F);0<F.length&&(uf.duc(F,!1),Pa&&Pa(fa,F))};uf.QFh=function(F){var fa=[];if(F&&F.EBb&&0<F.EBb.count){F=yl(F.EBb);for(var Pa=F.next();!Pa.done;Pa=F.next())if(Pa=Pa.value,Pa.controls&&0<Pa.controls.count){Pa=yl(Pa.controls);for(var yb=Pa.next();!yb.done;yb=Pa.next())if(yb=yb.value,yb.menuItems&&0<yb.menuItems.count){yb=yl(yb.menuItems);for(var Cc=yb.next();!Cc.done;Cc=yb.next())Array.add(fa,Cc.value.id)}}}return fa};uf.duc=function(F,fa){if(F.length){F=yl(F);for(var Pa=F.next();!Pa.done;Pa=
F.next())Pa=document.querySelector('[id^="'+Pa.value+'"]'),Hk.a.ida(Pa,fa)}};tl.Object.defineProperties(uf.prototype,{E_b:{configurable:!0,enumerable:!0,get:function(){return this.zhg}}});Object(ae.a)(uf,"ContextMenuExtensibilityCache",null,[309,310]);var Ik=b(1417),yk=b(1014),bk=b(885),Sg=b(830),zk=b(893),Nj=zk.a;vm(Bg,Nj);Bg.prototype.clone=function(){var F=new Bg;F.Xjd=this.Xjd;F.Ejd=this.Ejd;F.ribbon=this.ribbon;return F};Object(ae.a)(Bg,"RibbonBuildContext",zk.a,[]);var cj=b(818);ag.prototype.kga=
function(F,fa,Pa){fa=void 0===fa?null:fa;Pa=void 0===Pa?null:Pa;var yb=bk.Builder.s2b(F);if(cj.c(yb))Pa&&Pa(!1);else if(F=new Bg,F.Ejd=this.Q8.homeTab.id,F.Xjd=this.Q8.homeTab,F.ribbon=this.Q8,yb=new Sg.a(yb),yb=Sg.a.JU(yb.node,Sg.a.$Yd),cj.c(yb))Pa&&Pa(!1);else{yb=Sg.a.Cm(yb);for(var Cc=0;Cc<yb.length;Cc++){var Vc=yb[Cc],rd=(new Sg.a(Vc)).attributes[Sg.a.id];if(this.Q8.eaa(rd))this.oUb.uRj(rd,Vc,F);else{var Hd=-1;fa&&(Hd=this.xvh(rd,fa));-1!==Hd?this.oUb.uyg(Vc,F,Hd):this.oUb.uyg(Vc,F)}}Pa&&Pa(!0)}};
ag.prototype.xvh=function(F,fa){F=Array.indexOf(fa,F);if(-1===F)return-1;--F;for(var Pa=-1;0<=F;){Pa=this.GKh(fa[F]);if(-1!==Pa)break;F--}return Pa+1};ag.prototype.GKh=function(F){for(var fa=0,Pa=!1,yb=yl(this.Q8.children),Cc=yb.next();!Cc.done;Cc=yb.next()){Cc=Cc.value;if(Cc.id===F){Pa=!0;break}Cc.visible&&fa++}return Pa?fa:-1};ag.prototype.O$a=function(F){F=bk.Builder.s2b(F);if(!cj.c(F)&&(F=new Sg.a(F),F=Sg.a.JU(F.node,Sg.a.$Yd),!cj.c(F))){F=Sg.a.Cm(F);for(var fa=0;fa<F.length;fa++){var Pa=F[fa],
yb=(new Sg.a(Pa)).attributes[Sg.a.id];Pa=Sg.a.JU(Pa,Sg.a.mOb);Pa=Sg.a.Cm(Pa);for(var Cc=0;Cc<Pa.length;Cc++){var Vc=Sg.a.EYe(Pa[Cc],Sg.a.id);cj.c(Vc)||this.oUb.LSj(yb,Vc)}}}};Object(ae.a)(ag,"RibbonExtensibilityBuilder",null,[]);Hf.prototype.kga=function(F,fa){fa=void 0===fa?null:fa;var Pa=F.wTe();this.Cce.kga(Pa,F.d9a,fa)};Hf.prototype.O$a=function(F){F=F.wTe();this.Cce.O$a(F)};Hf.Jah=function(F,fa,Pa){Pa=void 0===Pa?null:Pa;F=Hf.kQh(F);0<F.length&&(Hf.duc(F,!1),Pa&&Pa(fa,F))};Hf.kQh=function(F){var fa=
[];if(F){var Pa=F.pK;if(!Pa){if(F.tabs&&0<F.tabs.count)for(F=yl(F.tabs),Pa=F.next();!Pa.done;Pa=F.next())if(Pa=Pa.value,0<Pa.KJ.count){var yb=yl(Pa.KJ);for(Pa=yb.next();!Pa.done;Pa=yb.next())if(Pa=Pa.value,0<Pa.Aha.count){var Cc=yl(Pa.Aha);for(Pa=Cc.next();!Pa.done;Pa=Cc.next())Array.add(fa,Pa.value.id)}}}else if(Pa.fq&&0<Pa.fq.count)for(F=yl(Pa.fq),Pa=F.next();!Pa.done;Pa=F.next())if(Pa=Pa.value,Pa.groups&&0<Pa.groups.length)for(yb=yl(Pa.groups),Pa=yb.next();!Pa.done;Pa=yb.next())if(Pa=Pa.value,
Pa.controls&&0<Pa.controls.length)for(Cc=yl(Pa.controls),Pa=Cc.next();!Pa.done;Pa=Cc.next())Array.add(fa,Pa.value.id)}return fa};Hf.duc=function(F,fa){if(F.length){F=yl(F);for(var Pa=F.next();!Pa.done;Pa=F.next())Pa=document.querySelector('[id^="'+Pa.value+'"]'),Hk.a.ida(Pa,fa)}};Object(ae.a)(Hf,"RibbonExtensibilityManager",null,[333]);var ck=b(1070);Lf.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(F,fa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(F,
fa)};Lf.prototype.ngd=function(F,fa,Pa,yb,Cc,Vc,rd){Vc=void 0===Vc?null:Vc;rd=void 0===rd?null:rd;Re.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",F);if((F=fa.K3(Cc.ownerAddinInfo.storeType,Cc.ownerAddinInfo.solutionId))&&F.Ps&&!F.Ps.getIsUpgrading())if(fa=null,0<F.Ps.getNotificationParams().length&&(fa=this.Yre(F.Ps.getNotificationParams()[0]),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&fa&&2147758681===fa.errorCode&&(F.isUpgraded=
!0),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",!1)&&fa&&2147758681===fa.errorCode&&Re.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==F.Ps.getStatus()&&(1!==F.Ps.getStatus()||fa&&2147758681===fa.errorCode))fa&&this.RZf(F,fa,rd);else try{Pa.setOwnerAddinEToken(F.Ps.getEToken()),Cc.action(Pa,yb.Yba),Vc&&Vc()}catch(Hd){Re.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",fg.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
Hd.stack:Hd.message)),ck.a.Fvc(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Lf.prototype.RZf=function(F,fa,Pa){var yb=this;Pa=void 0===Pa?null:Pa;var Cc=F.Ps;if(1===Cc.getNotificationParams().length||fa.ucc){var Vc=fa.Wga,rd=fa.Tha;fa.Wga=function(){Cc.removeFirstNotification();if(0<Cc.getNotificationParams().length){var Hd=yb.Yre(Cc.getNotificationParams()[0]);yb.RZf(F,Hd)}2147758681===fa.errorCode&&(Hf.Jah(F.nl,Cc,Object(Ri.a)(yb,yb.I7e,"initUpgradeStateDetectTask")),
uf.Aah(F.Hpb,Cc,Object(Ri.a)(yb,yb.I7e,"initUpgradeStateDetectTask")));Vc&&Vc()};fa.Tha=function(){rd&&rd();Pa&&Pa()};ck.a.SOd(fa)}};Lf.prototype.I7e=function(F,fa){var Pa=null;Pa=function(){F.getIsUpgrading()?window.setTimeout(Pa,1E3):F.getUpgradingFailed()?Hf.duc(fa,!0):fg.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Pa,1E3)};Lf.prototype.Yre=function(F){var fa=new yk.a;fa.OKa=F.infoType;fa.id=F.id;fa.title=F.title;fa.description=F.description;fa.buttonText=F.buttonTxt;fa.Wga=F.buttonCallback;
fa.ucc=F.highPriority;fa.Tha=F.dismissCallback;fa.errorCode=F.errorCode;fa.I6e=F.iframeNotificationUrl;return fa};tl.Object.defineProperties(Lf.prototype,{Ahe:{configurable:!0,enumerable:!0,get:function(){return this.nCc||(this.nCc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(F){this.nCc=F}},FIg:{configurable:!0,enumerable:!0,get:function(){return this.j_d||(this.j_d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(ae.a)(Lf,"AddinCommandsActionHandler",
null,[304]);Ig.prototype.KAh=function(F){if(void 0!==F&&null!==F&&F===Ni.a.BYg)F="ContextMenuCell";else return null;var fa=this.Sa.Lc();this.bAh(fa,F);return fa};Ig.prototype.bAh=function(F,fa){fa=this.yYg.tNh(fa);fa=yl(fa);for(var Pa=fa.next();!Pa.done;Pa=fa.next()){Pa=yl(Pa.value.controls);for(var yb=Pa.next();!yb.done;yb=Pa.next())this.Pzh(F,yb.value)}};Ig.prototype.Pzh=function(F,fa){var Pa=fa.hA[Sg.a.id],yb=fa.hA[Sg.a.ATa],Cc=fa.hA[Sg.a.CTa],Vc="Image16by16",rd=fa.hA[Sg.a.ffb];cj.c(Cc)&&(Vc=
"None");0<fa.menuItems.count?(Pa=this.Sa.Kv(Pa,Pa,yb,798637440),Pa.tIb(Vc,Cc,null),this.IAh(Pa.menu,fa),Array.add(F.buttons,Pa)):Array.add(F.buttons,this.Sa.TGa(Pa,yb,rd,Cc,Vc,null,!1))};Ig.prototype.IAh=function(F,fa){var Pa,yb=this.Sa.Lc();fa=yl(fa.menuItems);for(Pa=fa.next();!Pa.done;Pa=fa.next()){var Cc=Pa.value;Pa=Cc.QQ[Sg.a.id];var Vc=Cc.QQ[Sg.a.ATa],rd=Cc.QQ[Sg.a.CTa],Hd="Image16by16";Cc=Cc.QQ[Sg.a.ffb];cj.c(rd)&&(Hd="None");Pa=this.Sa.TGa(Pa,Vc,Cc,rd,Hd,null,!1);Array.add(yb.buttons,Pa)}Array.add(F.yc,
yb)};Object(ae.a)(Ig,"AddInCommandsContextMenuExtensibilityHandler",null,[288]);var V=b(1001);Object(ae.a)(Ne,"AddinStatusCommandValues",null,[]);Xe.VVi=function(F){var fa=new Ne;fa.Bi=F.PXa;fa.visible=fa.Bi?!0:!1;return fa};Xe.Uvc=function(F,fa,Pa,yb,Cc){var Vc=document.getElementById(Pa);Vc?Xe.Osj(F,fa,Vc,yb,Cc):Re.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Pa))};Xe.Osj=function(F,fa,Pa,yb,Cc){Pa?F.PXa===CommonUIStrings.l_ErrorLoadingAddInsTitle?ck.a.wrj(fa,
Pa,yb,Cc):F.PXa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&ck.a.Tsj(fa,Pa):Re.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(ae.a)(Xe,"AddinCommandsStatusHandler",null,[]);var ua=b(219),ib=Gj.a;vm(je,ib);je.prototype.iq=function(F){this.addHandler("LAC",F)};je.prototype.zq=function(F){this.removeHandler("LAC",F)};je.prototype.Jr=function(F,fa){var Pa=this;if("QueryAddinLabel"!==F)return!1;fa[V.a.LabelText]!==this.ZA.PXa&&
(F=Xe.VVi(this.ZA),fa[V.a.LabelText]=F.Bi,fa[V.a.Visible]=F.visible,window.setTimeout(function(){Pa.Uvc()},0));return!0};je.prototype.gn=function(){return!0};je.prototype.Uvc=function(){this.$&&Xe.Uvc(this.ZA,this.$.domElement,this.Qxj,De.a.instance.ea(331),De.a.instance.ea(332))};je.prototype.dispose=function(){this.$.fa.kk(this.Zc);this.ZA.D3i(this.m2e);this.agaveCommandManager&&(this.agaveCommandManager.R4i(this.hwe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.iF(this),
this.statusBarManager=null);this.ZA=this.$=null;ib.prototype.dispose.call(this)};Object(ae.a)(je,"AddinCommandsStatusBarManager",Gj.a,[143,144]);var bc=b(1291),Kc=b(116),cd=b(144);nd.prototype.setErrorMessageForAddin=function(F,fa){this.NXa||(this.NXa={});this.NXa[F]=fa};nd.prototype.jWe=function(F){return this.NXa&&F in this.NXa?this.NXa[F]:null};Object(ae.a)(nd,"AddinCommandsErrorManager",null,[]);var zc=b(325),Mc=b(94);Object(ae.a)(Xd,"AddinCommandsListLoaderContext",null,[]);var md=b(951);Object(ae.a)(ce,
"AppsForOfficeEntitlementQueryInfo",null,[]);var Nd=Sys.EventArgs;vm(Hb,Nd);Object(ae.a)(Hb,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Bb.prototype.J8c=function(F){var fa=new Sys.StringBuilder(this.bHb);fa.append("RoamingServiceHandler.ashx?action=");fa.append("getAddinTeachingCalloutSettings");fa.append("&");fa.append(this.ped(F));fa.append("&");fa.append(fg.AFrameworkApplication.hj);fg.AFrameworkApplication.Hd.Ul(fa.toString(),1,null,null,!0,2,Object(Ri.a)(this,this.SJa,"getRequestSuccessCallback"),
Object(Ri.a)(this,this.fja,"getRequestFailureCallback"),null)};Bb.prototype.K8c=function(F){var fa=new Sys.StringBuilder(this.bHb);fa.append("RoamingServiceHandler.ashx?action=");fa.append("saveAddinTeachingCalloutSettings");fa.append("&");fa.append(fg.AFrameworkApplication.hj);fa=fa.toString();F=Bh.c(F);fg.AFrameworkApplication.Hd.Ul(fa,2,F,null,!0,4,null,Object(Ri.a)(this,this.JOa,"postRequestFailureCallback"),null)};Bb.prototype.SJa=function(F){var fa=!1,Pa=null;try{if(0<F.data.fe.length){var yb=
Object(Wi.a)(Object,Bh.a(F.data.fe)),Cc=yb?yb[this.appName]:null;Cc&&(Pa=Object(Wi.a)(Object,Bh.a(Cc.toString())))}fa=!0}catch(Vc){this.fja(null)}fa&&this.yhb&&this.yhb(Pa)};Bb.prototype.fja=function(F){this.uhb&&this.uhb(F?F.data:null)};Bb.prototype.JOa=function(F){this.Gjb&&this.Gjb(F?F.data:null)};Bb.prototype.ped=function(F){for(var fa=new Sys.StringBuilder("requestedsettings="),Pa=0;Pa<F.count;Pa++)fa.append(F.na(Pa)),Pa<F.count-1&&fa.append(";");return fa.toString()};Object(ae.a)(Bb,"AddinTeachingUIRoamingRequestHandler",
null,[]);Object(ae.a)(Cb,"MiniAddinInfo",null,[]);var Ud=Sys.EventArgs;vm(Lc,Ud);Object(ae.a)(Lc,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Oe=b(940);kd.prototype.bzg=function(F){this.Ma.addHandler(Gg.a.iYb,F)};kd.prototype.xCg=function(F){this.Ma.addHandler(Gg.a.YZf,F)};kd.prototype.UFj=function(F){var fa=this;null!==F&&(this.context.x_=F[Gg.a.k2],this.context.Fm=F[Gg.a.bJ],this.context.xyc=this.context.Uoc=0,F=Gg.a.iFa in F?F[Gg.a.iFa]:0,-1!==this.context.x_&&this.context.Fm&&
(this.context.gra=new Oe.a,this.context.X1a=new Oe.a,this.context.Z1b=new Oe.a,this.context.UTc=this.fDg.createAddinDataProvider(ed(this.context.x_),this.contextActivationMgr),this.context.UTc?this.context.UTc.getEntitlementsAsync(this.contextActivationMgr.Yba,!0,F,function(Pa){fa.AGi(Pa)}):Re.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.x_)))};kd.prototype.AGi=function(F){var fa=this;if(F&&0<F.length){this.context.xyc=F.length;for(var Pa=0;Pa<F.length;Pa++){var yb=
F[Pa];if(!yb||1!==yb.targetType&&-1!==yb.targetType)this.Twd();else{var Cc={};Cc.marketplaceId=yb.solutionId;Cc.marketplaceVersion=yb.version;Cc.storeType=yb.storeType;Cc.storeId=yb.storeId;Cc.targetData=yb;this.contextActivationMgr.isAddinCommandsAsync(Cc,function(Vc,rd,Hd){Vc?(rd&&fa.context.gra.add(Hd.targetData),10===fa.context.x_&&(Vc=Hd.targetData,rd=Vc.targetType,fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!cj.c(Hd.targetTypeForExp)&&(rd=Hd.targetTypeForExp,Vc.targetType=rd),fg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&fa.context.X1a.add(Vc),fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===rd&&fa.context.Z1b.add(Vc))):Re.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Hd.targetData.storeType,Hd.targetData.storeId,
Hd.targetData.assetId),Hd.targetData.storeType);fa.Twd()})}}}else this.Twd()};kd.prototype.Twd=function(){var F;(F=this.context).Uoc=F.Uoc+1;this.context.Uoc>=this.context.xyc&&(this.hYb.DLd(this.context.x_,!1),0<this.context.xyc&&10===this.context.x_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(fg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&this.Vli(),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)?this.rCh(this.context.gra):this.lXb(this.context.gra)):this.lXb(this.context.gra))};kd.prototype.lXb=function(F){var fa=new Gh.a;if(F){F=yl(this.context.gra);for(var Pa=F.next();!Pa.done;Pa=F.next())fa.add(Xc(Pa.value))}this.context.gra&&1>this.context.gra.count&&md.a.Gdb(Gg.a.zmb,"false",this.context.x_);F={};fa=(F.ack2=fa,F);fa[Gg.a.k2]=this.context.x_;fa[Gg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Gg.a.iYb,new Hb(fa),this)};kd.prototype.qRf=function(F){if(this.appName){var fa={},Pa={};Pa.LastTeachingUIShowTime=
(new Date).toUTCString();Pa.AddinHasShown=F;fa[this.appName]=Bh.c(Pa);this.EOb&&(this.EOb.K8c(fa),Re.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Re.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};kd.prototype.rCh=function(F){if(this.sga=F)F=new Gh.a,F.add(this.appName),this.EOb=new Bb(this.appName,Object(Ri.a)(this,this.SJa,"getRequestSuccessCallback"),Object(Ri.a)(this,
this.fja,"getRequestFailureCallback"),Object(Ri.a)(this,this.JOa,"postRequestFailureCallback")),this.EOb.J8c(F);else{F=new Gh.a;var fa={};F=(fa.ack2=F,fa);F[Gg.a.k2]=this.context.x_;F[Gg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Gg.a.iYb,new Hb(F),this)}};kd.prototype.SJa=function(F){F?this.xqj(F)?(Re.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Xca="AddinHasShown"in F&&F.AddinHasShown?F.AddinHasShown.toString():null,this.xye()):(Re.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.lXb(this.sga)):(Re.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Xca=null,this.xye())};kd.prototype.fja=function(F){Re.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",F?F.httpStatus:-1);this.lXb(this.sga)};kd.prototype.JOa=function(F){Re.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.httpStatus:-1)};kd.prototype.xye=function(){if(fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var F=
this.t$g();0===F.targetType?(F.assetId?(this.rVc=F.assetId,this.RVi()):this.rif("NoAssetId"),F.addinId&&this.qRf(this.Xca?this.Xca+","+F.addinId:F.addinId),this.wSc(null)):this.wSc(F.addinId);Re.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",F.addinId)}else F=this.s$g(),this.wSc(F),Re.ULS.sendTraceTag(538248464,306,50,"Show teaching callout for taskpane addin: {0}",F)};kd.prototype.RVi=function(){var F=this,fa=new ce;fa.callbackFunc=function(Pa){if(Pa.errorCode)F.rif("FailToGetAppDetails");
else if(Pa.value){Pa=yl(Pa.value);for(var yb=Pa.next();!yb.done;yb=Pa.next()){yb=yb.value;var Cc=yb[1];if(Cc===F.rVc){Pa={solutionId:Cc,assetId:Cc};Pa.storeType=yb[6];Pa.storeId=yb[11];Pa.assetStoreId=yb[6];Pa.targetType=yb[3];Pa.width=yb[7];Pa.height=yb[8];Pa.displayName=yb[0];Pa.version=yb[4];Pa=new Lc(Pa);F.Ma.raiseEvent(Gg.a.YZf,Pa);break}}}};fa.storeType=OSF.StoreTypeEnum.PrivateCatalog;fa.fromInsertDialog=!1;fa.refresh=!0;this.contextActivationMgr.queryEntitlementDetails(fa)};kd.prototype.xqj=
function(F){if("LastTeachingUIShowTime"in F){if(F=+new Date-+new Date(F.LastTeachingUIShowTime.toString()),F<fg.AFrameworkApplication.ga.lQ("AddinShowTeachingUIIntervalInMS",864E5))return Re.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",F),!1}else Re.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};kd.prototype.s$g=function(){for(var F=new zc.a("",0),fa=new zc.a("",0),Pa=0,yb=0,Cc=0,Vc=yl(this.sga),rd=Vc.next();!rd.done;rd=
Vc.next())if(rd=rd.value,!("excatalog"!==rd.storeType||cj.c(rd.installTimeInMS)||!rd.installTimeInMS||rd.installTimeInMS<=fg.AFrameworkApplication.ga.lQ("DateTimeInMSForNewAddin",16409664E5))){var Hd=this.ebd(rd);if(this.Xca){var te=this.Xca.split(",");if(0<te.length&&Array.contains(te,Hd)){Cc++;Re.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Hd.startsWith("private_")?(F.value<rd.installTimeInMS&&(F=new zc.a(Hd,rd.installTimeInMS)),yb++):(fa.value<rd.installTimeInMS&&
(fa=new zc.a(Hd,rd.installTimeInMS)),Pa++)}Re.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",yb,Pa,Cc);return 0<fa.value?fa.key:0<F.value?F.key:null};kd.prototype.t$g=function(){var F=new zc.a(new Cb,0),fa=new zc.a(new Cb,0),Pa=0,yb=0,Cc=0,Vc=this.sga;if(0<this.context.Z1b.count)for(var rd=yl(this.context.Z1b),Hd=rd.next();!Hd.done;Hd=rd.next())Vc.add(Hd.value);Vc=yl(Vc);for(rd=Vc.next();!rd.done;rd=Vc.next())if(rd=
rd.value,!("excatalog"!==rd.storeType||cj.c(rd.installTimeInMS)||!rd.installTimeInMS||rd.installTimeInMS<=fg.AFrameworkApplication.ga.lQ("DateTimeInMSForNewAddin",16409664E5))){Hd=this.ebd(rd);if(this.Xca){var te=this.Xca.split(",");if(0<te.length&&Array.contains(te,Hd)){Cc++;Re.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}Hd.startsWith("private_")?(F.value<rd.installTimeInMS&&(F=new zc.a(Object.assign(new Cb,{addinId:Hd,targetType:rd.targetType,assetId:rd.assetId}),
rd.installTimeInMS)),yb++):(fa.value<rd.installTimeInMS&&(fa=new zc.a(Object.assign(new Cb,{addinId:Hd,targetType:rd.targetType,assetId:rd.assetId}),rd.installTimeInMS)),Pa++)}Re.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",yb,Pa,Cc);return 0<fa.value?fa.key:0<F.value?F.key:Object.assign(new Cb,{addinId:null,targetType:-1,assetId:null})};kd.prototype.wSc=function(F){for(var fa=new Gh.a,Pa=yl(this.sga),yb=Pa.next();!yb.done;yb=
Pa.next()){var Cc=yb.value;yb=Xc(Cc);F&&(Cc=this.ebd(Cc),F===Cc&&(yb.showCallout=!0,this.qRf(this.Xca?this.Xca+","+F:F)));fa.add(yb)}this.sga&&1>this.sga.count&&md.a.Gdb(Gg.a.zmb,"false",this.context.x_);F={};fa=(F.ack2=fa,F);fa[Gg.a.k2]=this.context.x_;fa[Gg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Gg.a.iYb,new Hb(fa),this)};kd.prototype.ebd=function(F){return Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.storeId,F.assetId)?"private_"+F.installTimeInMS:F.assetId};kd.prototype.Vli=function(){if(!(this.context.X1a&&
1>this.context.X1a.count))if(this.hYb.kci()){var F=this.hYb.HOh();F?(F=this.wVe(this.context.X1a,F),Re.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(F=this.wVe(this.context.X1a,null),Re.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.hYb.rkj(F)}else Re.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};kd.prototype.wVe=function(F,fa){var Pa={},yb=!1;F=yl(F);for(var Cc=F.next();!Cc.done;Cc=F.next()){Cc=Cc.value;var Vc=Telemetry.PrivacyRules.GetAssetId(Cc.storeType,
Cc.storeId,Cc.assetId);Vc&&(!fa||Vc in fa||(this.Xwa(Cc,Vc),Re.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Vc.toLowerCase()?yb||(yb=!0,Pa[Vc]=null):Pa[Vc]=null)}return Pa};kd.prototype.Xwa=function(F,fa){var Pa=F.installTimeInMS?(new Date(F.installTimeInMS)).toISOString():"",yb={};Pa=(yb["SDX.Id"]=fa,yb["SDX.AppInstallOrigin"]="Organization",yb["SDX.TargetType"]=F.targetType,yb["SDX.AdminDeploymentTime"]=Pa,yb);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(Pa)}));1===F.targetType&&(F={},fa=(F["SDX.Id"]=fa,F["SDX.AppInstallOrigin"]="Organization",F["SDX.CommandPlacement"]="Ribbon",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)})))};kd.prototype.rif=function(F){var fa={};F=(fa.AppTeachingUICalloutAction=F,fa["SDX.Id"]=this.rVc,fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);
Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object(ae.a)(kd,"AddInCommandsListLoader",null,[]);gb.prototype.insertOsfControl=function(F){return this.Yba.insertOsfControl(F)};gb.prototype.getManifestInvaildErrorString=function(){return this.Yba.getManifestInvaildErrorString()};gb.prototype.isAddinCommandsAsync=function(F,fa){this.Yba.isAddinCommandsAsync(F,fa)};gb.prototype.ownerAddinControlRecreated=function(F,fa){this.Yba.ownerAddinControlRecreated(F,
fa)};gb.prototype.queryEntitlementDetails=function(F){this.Yba.queryEntitlementDetails(F)};tl.Object.defineProperties(gb.prototype,{Yba:{configurable:!0,enumerable:!0,get:function(){return this.Mog}}});Object(ae.a)(gb,"ContextActivationMgrWrapper",null,[297]);wc.prototype.createAddinDataProvider=function(F,fa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(F,fa.Yba)};tl.Object.defineProperties(wc,{instance:{configurable:!0,enumerable:!0,get:function(){wc.Na||(wc.Na=new wc);return wc.Na}}});
wc.Na=null;Object(ae.a)(wc,"OSFAddinDataProviderFactory",null,[298]);Object(ae.a)(hd,"CacheItem",null,[]);oc.prototype.jl=function(F){fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)&&Re.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var fa=this.wDa.getItem(F);if(fa){var Pa=new hd;try{Pa=Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0)}catch(yb){return this.wDa.removeItem(F),null}return Pa.Data?Pa.Data:Pa.data}return null};oc.prototype.$ya=
function(F){fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)&&Re.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem");this.wDa.removeItem(F)};Object(ae.a)(oc,"AppsDataCacheManager",null,[225]);var of=b(952);Jf.prototype.DLd=function(F,fa){F=Gg.a.DWe()+F;of.a.instance.setItem(F,fa.toString())};Jf.prototype.HOh=function(){var F=Gg.a.AZe();Re.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",F);F=of.a.instance.getItem(F);return Bh.a(F)};
Jf.prototype.rkj=function(F){var fa=Gg.a.AZe();Re.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",fa);of.a.instance.setItem(fa,Bh.c(F))};Jf.prototype.kci=function(){return!!of.a.instance.localStorage};tl.Object.defineProperties(Jf,{instance:{configurable:!0,enumerable:!0,get:function(){Jf.Na||(Jf.Na=new Jf);return Jf.Na}}});Jf.Na=null;Object(ae.a)(Jf,"AddInCommandsCacheManager",null,[307]);var Nf=Sys.EventArgs;vm(ze,Nf);Object(ae.a)(ze,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(ae.a)(Pd,
"PostLaunchAddinCommandsParameters",null,[]);Bd.prototype.twg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Ri.a)(this,this.nGi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Ri.a)(this,this.KBi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Ri.a)(this,this.qAi,"onCloseButtonClickedEventHandler"),!0)):Re.ULS.sendTraceTag(539353218,306,15,"AddEventListenerForTeachingCallout failed to get Window")};
Bd.prototype.nGi=function(){var F=this,fa={};fa=(fa.AppTeachingUICalloutAction="ClickOnLaunch",fa["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.p8.storeType,this.p8.storeId,this.p8.assetId),fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(fa)}));this.EZd?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.EZd,function(){var Pa=
new ze;Pa.Fg=F.p8;F.Ya.raiseEvent(Gg.a.Tgf,Pa)}):Re.ULS.sendTraceTag(539353219,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Bd.prototype.qAi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnClose",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.p8.storeType,this.p8.storeId,this.p8.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(F)}))};Bd.prototype.KBi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.p8.storeType,this.p8.storeId,this.p8.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object(ae.a)(Bd,"PrivateCatalogTeachingCalloutHandler",null,[]);ne.prototype.kga=
function(F,fa){this.F5d.kga(F,void 0===fa?null:fa);this.I7d=F};ne.prototype.O$a=function(F){this.F5d.O$a(F)};tl.Object.defineProperties(ne.prototype,{kba:{configurable:!0,enumerable:!0,get:function(){return this.I7d}}});Object(ae.a)(ne,"RibbonExtensibilityManagerWithChangeDetection",null,[333]);var Kf=b(942);ee.prototype.kga=function(F,fa){fa=void 0===fa?null:fa;if(F=Kf.a.itb(F)){appChrome.addInApi.dispatchActionsToInstallAddIn(F,fa);fa=yl(F.tabs);for(var Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(F,
function(){});break}}};ee.prototype.O$a=function(F){(F=Kf.a.itb(F))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(F)};Object(ae.a)(ee,"OneLineRibbonExtensibilityManager",null,[333]);var ug=b(1013);Wd.mXe=function(F){var fa=new Gh.a;if(Wd.kye)for(var Pa=yl(Wd.kye),yb=Pa.next();!yb.done;yb=Pa.next())fa.add(yb.value);yb=null;switch(F){case "Workbook":yb=Wd.CPj;break;case "Document":yb=Wd.Cch;break;case "Presentation":yb=Wd.JTi}if(yb)for(F=yl(yb),yb=F.next();!yb.done;yb=F.next())fa.add(yb.value);return fa};
Wd.kye=["PrimaryCommandSurface","ContextMenu"];Wd.CPj=null;Wd.Cch=null;Wd.JTi=null;Object(ae.a)(Wd,"ExtensionPointType",null,[]);tl.Object.defineProperties(Qd.prototype,{EBb:{configurable:!0,enumerable:!0,get:function(){return this.K$d||(this.K$d=new Gh.a)}},Gme:{configurable:!0,enumerable:!0,get:function(){return this.egg}}});Object(ae.a)(Qd,"ContextMenuExtensibility",null,[312]);cc.prototype.wTe=function(){for(var F=new Sys.StringBuilder,fa=yl(this.NX),Pa=fa.next();!Pa.done;Pa=fa.next())F.append(Pa.value.k7());
return this.Uxg(F.toString())};cc.prototype.Uxg=function(F){var fa=new Sys.StringBuilder;fa.append("<Ribbon><Tabs>");fa.append(F);fa.append("</Tabs></Ribbon>");return fa.toString()};tl.Object.defineProperties(cc.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.NX}},pK:{configurable:!0,enumerable:!0,get:function(){return this.Fog}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.$rg}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.mjb}},
FBh:{configurable:!0,enumerable:!0,get:function(){return this.Hkg}}});Object(ae.a)(cc,"RibbonExtensibility",null,[355]);Ie.prototype.createActionContext=function(F,fa){F={};F.ownerAddinInfo=this.entitlement;F.action=fa;return F};tl.Object.defineProperties(Ie.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Gjg}}});Object(ae.a)(Ie,"AddInCommandsContextProvider",null,[]);qd.prototype.K0g=function(F){return new Ie(F)};qd.prototype.createActionBuilder=function(F,fa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(F,
fa.entitlement,fa.manifest)};qd.prototype.startApplyAddin=function(F){this.DZd=F;var fa=this.K0g(F);this.actionBuilder=this.createActionBuilder(fa,F)};qd.prototype.endApplyAddin=function(){};qd.prototype.Pad=function(F,fa,Pa){Pa=void 0===Pa?0:Pa;return this.ribbonBuilder.zxc&&0<this.ribbonBuilder.zxc.count||this.ribbonBuilder.fq&&0<this.ribbonBuilder.fq.count?new cc(this.ribbonBuilder.zxc,this.UAh(F,fa),this.dme.startedNode,this.ribbonBuilder.x5.INh(),Pa):null};qd.prototype.TSe=function(){var F=void 0===
F?null:F;if(this.contextMenuBuilder.zjc&&0<this.contextMenuBuilder.zjc.count){F||(F=this.dme.entitlement.solutionId);F=new Qd(F);for(var fa=yl(this.contextMenuBuilder.zjc),Pa=fa.next();!Pa.done;Pa=fa.next())F.EBb.add(Pa.value);return F}return null};qd.prototype.UAh=function(F,fa){return this.ribbonBuilder.fq&&0<this.ribbonBuilder.fq.count?new Kf.a(this.ribbonBuilder.fq,F,fa):null};tl.Object.defineProperties(qd.prototype,{dme:{configurable:!0,enumerable:!0,get:function(){return this.DZd}}});Object(ae.a)(qd,
"AddinCommandsBuilder",null,[]);Yd.prototype.BMa=function(F,fa,Pa,yb,Cc,Vc,rd){function Hd(Og,lh,Ih,Ah){Cc(Og,lh,Ih,Ah);Og=ug.a[te.Fm]+lh.assetId;Ih=te.Bda.Ec(Og);lh=Ih.value;Ih.returnValue&&(lh.stop(),te.Bda.remove(Og))}var te=this;if(this.Fm&&F)for(Re.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",F.count),4===this.Fm&&(Re.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",yb)),this.oTg(F,yb),Vc()),F=yl(F),yb=F.next();!yb.done;yb=F.next())if(yb=yb.value,
yb.solutionId=yb.solutionId||yb.assetId,yb.storeType=yb.storeType||yb.currentStoreType,yb.version=yb.version||yb.appVersion,Re.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(yb.storeType,yb.storeId,yb.solutionId))),this.TWd(yb))if(rd&&yb.requireConsent)rd(yb,function(Og){try{if(te.fI){var lh=ug.a[te.Fm]+Og.solutionId,Ih=te.fI.Fc("ComponentAttach",lh);te.Bda.ia(lh,Ih)}var Ah=te.ZA.K3(Og.storeType,Og.solutionId);6!==te.Fm&&(Ah&&(te.N0b(Ah),
Ah.Ps.purge(!1)),te.Gi.insertOsfControl(te.AEb(Og,fa,Pa,Hd)),Ah&&te.Gi.ownerAddinControlRecreated(Og.solutionId,Og.storeType))}catch(Uh){Re.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",te.hl.xx,Telemetry.PrivacyRules.GetAssetId(Og.storeType,Og.storeId,Og.solutionId),Og.version,Og.storeType,Og.storeId,Uh.message)),Hd(!1,Og,null,null)}});else try{if(this.fI){var hf=ug.a[this.Fm]+yb.solutionId,
ff=this.fI.Fc("ComponentAttach",hf);this.Bda.ia(hf,ff)}var lg=this.ZA.K3(yb.storeType,yb.solutionId);6!==this.Fm&&(lg&&(this.N0b(lg),lg.Ps.purge(!1)),this.Gi.insertOsfControl(this.AEb(yb,fa,Pa,Hd)),lg&&this.Gi.ownerAddinControlRecreated(yb.solutionId,yb.storeType))}catch(Og){Re.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(yb.storeType,
yb.storeId,yb.solutionId),yb.version,yb.storeType,yb.storeId,Og.message)),Hd(!1,yb,null,null)}else Hd(!1,yb,null,null)};Yd.prototype.uji=function(F,fa,Pa,yb,Cc,Vc){var rd=this;if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var Hd=function(Ah,Uh,ii,ij){Vc(Ah,Uh,ii,ij);Ah=ug.a[rd.Fm]+Uh.solutionId;ii=rd.Bda.Ec(Ah);Uh=ii.value;ii.returnValue&&(Uh.stop(),rd.Bda.remove(Ah))};if(6===this.Fm&&F)if(F.solutionId=F.solutionId||F.assetId,F.storeType=
F.storeType||F.currentStoreType,F.version=F.version||F.appVersion,Re.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId))),this.TWd(F))try{if(this.fI){var te=ug.a[this.Fm]+F.solutionId,hf=this.fI.Fc("ComponentAttach",te);this.Bda.ia(te,hf)}var ff=this.ZA.K3(F.storeType,F.solutionId);ff||Hd(!1,F,null,null);fg.AFrameworkApplication.sa&&fg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?
this.k9b(F,fa,yb,Cc,Pa,function(Ah){Hd(Ah,F,Pa,ff.displayName)}):(this.k9b(F,fa,yb,Cc,Pa),Hd(!0,F,Pa,ff.displayName))}catch(Ah){Re.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,Ah.message)),Hd(!1,F,null,null)}else Hd(!1,F,null,null)}else{var lg=function(Ah,
Uh,ii,ij){Vc(Ah,Uh,ii,ij);Ah=ug.a[rd.Fm]+Uh.assetId;ii=rd.Bda.Ec(Ah);Uh=ii.value;ii.returnValue&&(Uh.stop(),rd.Bda.remove(Ah))};if(6===this.Fm&&F)if(F.solutionId=F.solutionId||F.assetId,F.storeType=F.storeType||F.currentStoreType,F.version=F.version||F.appVersion,Re.ULS.sendTraceTag(527279813,220,50,String.format("{0}: Install dynamic ribbon {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId))),this.TWd(F))try{if(this.fI){var Og=ug.a[this.Fm]+F.assetId,lh=this.fI.Fc("ComponentAttach",
Og);this.Bda.ia(Og,lh)}var Ih=this.ZA.K3(F.currentStoreType,F.id);Ih||lg(!1,F,null,null);fg.AFrameworkApplication.sa&&fg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.k9b(F,fa,yb,Cc,Pa,function(Ah){lg(Ah,F,Pa,Ih.displayName)}):(this.k9b(F,fa,yb,Cc,Pa),lg(!0,F,Pa,Ih.displayName))}catch(Ah){Re.ULS.sendTraceTag(527279815,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,
F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId,Ah.message)),lg(!1,F,null,null)}else lg(!1,F,null,null)}};Yd.prototype.yyi=function(F,fa,Pa,yb,Cc,Vc){if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1))if(Vc)if(Vc._isAddinCommandsManifest(this.hl.xx))try{fg.AFrameworkApplication.sa&&fg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.j9b(F,fa,Pa,Cc,Vc,function(rd){yb(rd,F,Vc,Vc.getDefaultDisplayName())}):(this.j9b(F,
fa,Pa,Cc,Vc),yb(!0,F,Vc,Vc.getDefaultDisplayName()))}catch(rd){Re.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,rd.message)),yb(!1,F,Vc,Vc.getDefaultDisplayName())}else Re.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),yb(!1,F,null,null);else Re.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),yb(!1,F,null,null);else if(Vc)if(Vc._isAddinCommandsManifest(this.hl.xx))try{fg.AFrameworkApplication.sa&&
fg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.j9b(F,fa,Pa,Cc,Vc,function(rd){yb(rd,F,Vc,Vc.getDefaultDisplayName())}):(this.j9b(F,fa,Pa,Cc,Vc),yb(!0,F,Vc,Vc.getDefaultDisplayName()))}catch(rd){Re.ULS.sendTraceTag(527279818,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,
F.storeId,rd.message)),yb(!1,F,Vc,Vc.getDefaultDisplayName())}else Re.ULS.sendTraceTag(527279819,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId)),yb(!1,F,null,null);else Re.ULS.sendTraceTag(527279820,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",
this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId)),yb(!1,F,null,null)};Yd.prototype.AEb=function(F,fa,Pa,yb){var Cc=this,Vc={},rd=document.createElement("div");rd.setAttribute("visible","false");Vc.div=rd;Vc.id=F.solutionId||F.id;Vc.solutionId=F.solutionId||F.id;Vc.version=F.version||F.appVersion;Vc.storeType=F.storeType||F.currentStoreType;Vc.storeId=F.storeId;Vc.assetId=F.assetId;Vc.assetStoreId=F.assetStoreId;Vc.isvirtualOsfControl=
!0;Vc.virtualOsfControlActivationCallback=function(Hd,te){var hf=Cc.ZA.K3(F.storeType||F.currentStoreType,F.solutionId||F.id);hf&&(hf.isUpgraded&&(F.isUpgraded=!0),Cc.N0b(hf));Cc.yyi(F,fa,Pa,yb,Hd,te)};Vc.reason=3===this.Fm?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;Vc.marketplaceID=F.id;Vc.marketplaceVersion=F.appVersion;Vc.store=F.storeId;return Vc};Yd.prototype.j9b=function(F,fa,Pa,yb,Cc,Vc){Vc=void 0===Vc?null:
Vc;var rd={};rd.solutionId=yb.getSolutionId();rd.version=yb.getVersion();rd.storeType=yb.getStoreType();rd.storeId=yb.getStoreId();rd.assetId=yb.getSolutionId();rd.assetStoreId=yb.getAssetStoreId();rd.targetType=yb.getOsfControlType();rd.appVersion=yb.getMarketplaceVersion();var Hd=null,te=null;if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Hd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.hl.xx,this.hl.formFactor)).parseExtensions(rd,
Cc,this.tga),te=Wd.mXe(this.hl.xx);else try{Hd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.hl.xx,this.hl.formFactor)).parseExtensions(rd,Cc,this.tga),te=Wd.mXe(this.hl.xx)}catch(Ji){throw Re.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ji.message),Ji;}if(te&&0<te.count){if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var hf=fa(F);var ff=Pa(F);Pa=!!fg.AFrameworkApplication.ga&&
fg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");hf=new qd(hf,null,ff);te=yl(te);for(ff=te.next();!ff.done;ff=te.next())hf.commandSurface=ff.value,Hd.apply(hf,this.tga,Pa)}else try{var lg=fa(F),Og=Pa(F),lh=!!fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");hf=new qd(lg,null,Og);var Ih=yl(te);for(ff=Ih.next();!ff.done;ff=Ih.next())hf.commandSurface=ff.value,Hd.apply(hf,this.tga,lh)}catch(Ji){throw Re.ULS.sendTraceTag(538752132,
220,10,"Exception encounter while building ribbon. Exception: "+Ji.message),Ji;}if(OSF.OUtil.checkFlight(14))try{var Ah=hf.Pad(F.solutionId||F.id,Cc.getDefaultDisplayName()),Uh=hf.TSe();Ah&&this.ribbonManager.kga(Ah,Vc);Uh&&this.contextMenuManager.Tie(Uh);this.ZA.tje(yb,Ah,Uh,Cc.getDefaultDisplayName());Re.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Cc.getDefaultDisplayName())}catch(Ji){throw OfficeExt.DevConsole.log(Ji),Re.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+
Ji.message),Ji;}else try{var ii=hf.Pad(F.solutionId||F.id,Cc.getDefaultDisplayName()),ij=hf.TSe();ii&&this.ribbonManager.kga(ii);ij&&this.contextMenuManager.Tie(ij);this.ZA.tje(yb,ii,ij,Cc.getDefaultDisplayName());Re.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Cc.getDefaultDisplayName())}catch(Ji){throw Re.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ji.message),Ji;}}};Yd.prototype.k9b=function(F,fa,Pa,yb,Cc,Vc){Vc=void 0===Vc?null:Vc;var rd={};
rd.solutionId=F.solutionId||F.assetId;rd.version=F.version||F.appVersion;rd.storeType=F.storeType||F.currentStoreType;rd.storeId=F.assetStoreId;rd.assetId=F.assetId;rd.assetStoreId=F.assetStoreId;rd.targetType=F.targetType;rd.appVersion=F.appVersion;var Hd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.hl.xx,this.hl.formFactor);try{var te=fa.getManifest(),hf=Hd.parse(rd,te,Cc,this.tga,fa.getSharedRuntimeId()),ff=Pa(F),lg=yb(F),Og=new qd(ff,null,lg);Og.commandSurface="PrimaryCommandSurface";
hf.apply(Og,this.tga,!0);if(Og.ribbonBuilder.fq&&0<Og.ribbonBuilder.fq.count){var lh=Og.Pad(F.solutionId||F.id,fa.getManifest().getDefaultDisplayName(),1);fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.kga(lh,Vc):lh&&this.ribbonManager.kga(lh,Vc);this.ZA.jxg(fa,lh,Cc,fa.getManifest().getDefaultDisplayName());Re.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",fa.getManifest().getDefaultDisplayName())}}catch(Ih){Re.ULS.sendTraceTag(592290768,
220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",fa.getManifest().getDefaultDisplayName(),Ih.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ih)}};Yd.prototype.N0b=function(F){F.nl&&this.ribbonManager.O$a(F.nl);F.Hpb&&this.contextMenuManager.w2i(F.Hpb);fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?this.ZA.UKf(F.Ps.getStoreType(),F.Ps.getSolutionId()):this.ZA.UKf(F.Ps.getStoreType(),F.Ps.getMarketplaceID())};
Yd.prototype.oTg=function(F,fa){fa=ed(fa);for(var Pa=yl(this.ZA.TKa),yb=Pa.next();!yb.done;yb=Pa.next())if(yb=yb.value,yb.Ps.getStoreType()===fa){for(var Cc=!0,Vc=yl(F),rd=Vc.next();!rd.done;rd=Vc.next())if((rd=rd.value)&&yb.tdf(rd.storeType||rd.currentStoreType,rd.solutionId||rd.id)){Cc=!1;break}Cc&&(this.N0b(yb),yb.Ps.purge(!1))}};Yd.prototype.TWd=function(F){F.solutionId!==F.assetId&&Re.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId");F.id!==F.assetId&&Re.ULS.sendTraceTag(540379093,
220,50,"VerifyInsertAgaveParameter Id != AssetId");return!!F&&!!F.solutionId&&!!F.version&&!!F.storeType&&!!F.storeId};Object(ae.a)(Yd,"AddInCommandsIntegration",null,[]);var qh=b(862);Kd.prototype.czg=function(F){this.Ya.addHandler(Gg.a.cme,F)};Kd.prototype.WAg=function(F){this.Ya.addHandler(Gg.a.Tgf,F)};Kd.prototype.wCg=function(F){this.Ya.addHandler(Gg.a.a_f,F)};Kd.prototype.izg=function(F){this.Ya.addHandler(Gg.a.QVc,F)};Kd.prototype.BMa=function(F,fa,Pa){var yb=this,Cc=Pa[Gg.a.hFa],Vc=void 0===
Pa[Gg.a.bJ]?0:Pa[Gg.a.bJ];if(Cc&&Vc)if(0>=Cc.count&&4!==Vc)this.ooc(new Pd(Vc,null,null,F,fa,null,!0));else{var rd=Cc.count,Hd=new ne(new Hf(F));Pa=void 0===Pa[Gg.a.k2]?-1:Pa[Gg.a.k2];(new Yd(Vc,this.Ml,this.zoa,Hd,this.m1d,this.P8,this.U0)).BMa(Cc,function(te){return fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?yb.Lqa.ese(te.solutionId,yb.U0,yb.zoa):yb.Lqa.ese(te.assetId,yb.U0,yb.zoa)},function(te){return fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)?yb.Lqa.l_b(te.solutionId):yb.Lqa.l_b(te.assetId)},Pa,function(te,hf,ff,lg){rd--;ff=new Pd(Vc,hf,Hd,F,fa,lg,0>=rd);te&&hf?yb.ooc(ff):(yb.wpa&&(3===Vc||hf&&hf.isUpgraded)&&(te="",hf&&(te=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(hf.storeType,hf.storeId,hf.solutionId):Telemetry.PrivacyRules.GetAssetId(hf.currentStoreType,hf.storeId,hf.assetId)),hf={},hf=(hf.SDX_AppInstallOrigin="User",hf.SDX_IsAutoLaunchEnabled=
yb.q8,hf.SDX_AppInstallErrorCode="onAddinCompleted.fail",hf.SDX_Id=te,hf),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(hf)}))),yb.noc(ff))},function(){yb.rBb();0>=Cc.count&&4===Vc&&yb.P8.euc()},this.P$d)}else this.wpa&&(Pa={},Pa=(Pa.SDX_AppInstallOrigin="User",Pa.SDX_IsAutoLaunchEnabled=this.q8,Pa.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",Pa.SDX_Id="",Pa),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Kc.a.Fk(Pa)}))),Re.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.zoa.xx)),this.noc(new Pd(Vc,null,null,F,fa,null,!0))};Kd.prototype.Lji=function(F,fa,Pa){var yb=this,Cc=Pa[Gg.a.hFa],Vc=void 0===Pa[Gg.a.bJ]?0:Pa[Gg.a.bJ];if(Cc&&Vc)if(0>=Cc.count&&4!==Vc)this.ooc(new Pd(Vc,null,null,null,fa,null,!0));else{var rd=Cc.count,Hd=new ne(new ee),te=void 0===Pa[Gg.a.k2]?-1:Pa[Gg.a.k2],hf=new Yd(Vc,this.Ml,this.zoa,Hd,this.m1d,this.P8,this.U0),
ff=function(Ah){return fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?yb.Lqa.Zre(Ah.solutionId,yb.U0,yb.zoa,F):yb.Lqa.Zre(Ah.assetId,yb.U0,yb.zoa,F)},lg=function(Ah){return fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?yb.Lqa.l_b(Ah.solutionId):yb.Lqa.l_b(Ah.assetId)},Og=function(Ah,Uh,ii){rd--;ii=new Pd(Vc,Uh,Hd,null,fa,ii,0>=rd);Ah&&Uh?yb.ooc(ii):(yb.wpa&&(3===Vc||Uh&&Uh.isUpgraded)&&
(Ah="",Uh&&(Ah=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(Uh.storeType,Uh.storeId,Uh.solutionId):Telemetry.PrivacyRules.GetAssetId(Uh.currentStoreType,Uh.storeId,Uh.assetId)),Uh={},Uh=(Uh.SDX_AppInstallOrigin="User",Uh.SDX_IsAutoLaunchEnabled=yb.q8,Uh.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",Uh.SDX_Id=Ah,Uh),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Kc.a.Fk(Uh)}))),yb.noc(ii));rd||fg.AFrameworkApplication.sa.updateCommandUI()},lh=function(Ah,Uh,ii,ij){Og(Ah,Uh,ij)},Ih=function(){yb.rBb();0>=Cc.count&&4===Vc&&yb.P8.euc()};6===Vc?(te=Pa[Gg.a.$Ha],Pa=Pa[Gg.a.aIa],hf.uji(Cc.na(0),te,Pa,ff,lg,function(Ah,Uh,ii,ij){Og(Ah,Uh,ij)})):hf.BMa(Cc,ff,lg,te,lh,Ih,this.P$d)}else this.wpa&&(hf={},hf=(hf.SDX_AppInstallOrigin="User",hf.SDX_IsAutoLaunchEnabled=this.q8,hf.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",hf.SDX_Id="",hf),
Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(hf)}))),Re.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.zoa.xx)),this.noc(new Pd(Vc,null,null,null,fa,null,!0))};Kd.prototype.noc=function(F){this.rBb(F);this.S_f(!1,F)};Kd.prototype.ooc=function(F){if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var fa=F.Fg,
Pa=null;null!==fa&&(Pa=fa.storeType||fa.currentStoreType,Pa=Pa.toLowerCase());if(this.wpa&&fa&&"omex"===fa.storeType&&F&&(3===F.Fm||fa.isUpgraded)){var yb={};yb=(yb.SDX_AppInstallOrigin="User",yb.SDX_IsAutoLaunchEnabled=this.q8,yb.SDX_AppInstallErrorCode="0",yb.SDX_Id=Telemetry.PrivacyRules.GetAssetId(Pa,fa.storeId,fa.solutionId),yb);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(yb)}))}this.rBb(F);this.see&&fa&&"omex"===fa.storeType&&
3===F.Fm&&"hardcodedpreinstall"!==Pa&&(yb=new ze,yb.Fg=fa,this.Ya.raiseEvent(Gg.a.UZf,yb));this.q8&&fa&&"omex"===fa.storeType&&F.vR&&(3===F.Fm&&"hardcodedpreinstall"!==Pa||fa.isUpgraded)&&(yb=new ze,yb.Fg=fa,yb.nl=F.vR.kba,this.Ya.raiseEvent(Gg.a.QVc,yb));fa&&(Jf.instance.DLd(Pb(Pa),!0),"uploadfiledevcatalog"===Pa&&(yb=this.CZd.createAddinDataProvider(Pa,this.Ml))&&yb.localCacheAddinCommands(this.Ml.Yba,fa.solutionId||fa.id,fa.version||fa.appVersion,fa.storeId),this.dSf(F.vR.kba,Pa,F.Fm,F.oad),md.a.Gdb(Gg.a.zmb,
"true",Pb(Pa)))}else fa=F.Fg,this.wpa&&fa&&"omex"===fa.storeType&&F&&(3===F.Fm||fa.isUpgraded)&&(Pa={},Pa=(Pa.SDX_AppInstallOrigin="User",Pa.SDX_IsAutoLaunchEnabled=this.q8,Pa.SDX_AppInstallErrorCode="0",Pa.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.currentStoreType,fa.storeId,fa.assetId),Pa),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(Pa)}))),this.rBb(F),this.see&&fa&&"omex"===fa.storeType&&3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType&&
(Pa=new ze,Pa.Fg=fa,this.Ya.raiseEvent(Gg.a.UZf,Pa)),this.q8&&fa&&"omex"===fa.storeType&&F.vR&&(3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType||fa.isUpgraded)&&(Pa=new ze,Pa.Fg=fa,Pa.nl=F.vR.kba,this.Ya.raiseEvent(Gg.a.QVc,Pa)),fa&&(Jf.instance.DLd(Pb(fa.currentStoreType.toLowerCase()),!0),"uploadfiledevcatalog"===fa.currentStoreType.toLowerCase()&&(Pa=this.CZd.createAddinDataProvider(fa.currentStoreType.toLowerCase(),this.Ml))&&Pa.localCacheAddinCommands(this.Ml.Yba,fa.solutionId||fa.id,fa.version||
fa.appVersion,fa.storeId),this.dSf(F.vR.kba,fa.currentStoreType,F.Fm,F.oad),md.a.Gdb(Gg.a.zmb,"true",Pb(fa.currentStoreType.toLowerCase())));this.S_f(!0,F)};Kd.prototype.S_f=function(F,fa){if(F)if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&fa.vR&&5===fa.Fm&&fa.vR.kba&&void 0!==fa.Fg.showCallout&&null!==fa.Fg.showCallout&&fa.Fg.showCallout)(new Bd(this.Ya,fa.Fg,Kf.a.itb(fa.vR.kba))).twg(),F=new ze,F.nl=fa.vR.kba,F.Fg=fa.Fg,
this.Ya.raiseEvent(Gg.a.a_f,F);else if(3!==fa.Fm)fa.Xff&&this.P8.euc();else{if(fa.vR&&fa.vR.kba)if(F=Object(Wi.a)(qh.Ribbon,fa.oad),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){if("hardcodedpreinstall"!==fa.Fg.storeType){var Pa=!1;this.q8&&(Pa=fa.Fg.isAutoLaunched);ck.a.ZZf(F,fa.pSe,fa.displayName,fa.vR.kba,Pa)}}else"hardcodedpreinstall"!==fa.Fg.currentStoreType&&(Pa=!1,this.q8&&(Pa=fa.Fg.isAutoLaunched),ck.a.ZZf(F,fa.pSe,fa.displayName,
fa.vR.kba,Pa))}else 3===fa.Fm?fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?fa.Fg&&"uploadfiledevcatalog"===fa.Fg.storeType.toLowerCase()?(fa=this.U0.jWe(fa.Fg.solutionId),ck.a.Fvc(fa?fa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.P8.ZLd():fa.Fg&&"uploadfiledevcatalog"===fa.Fg.currentStoreType.toLowerCase()?(fa=this.U0.jWe(fa.Fg.assetId),ck.a.Fvc(fa?fa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.P8.ZLd():fa.Xff&&this.P8.euc()};Kd.prototype.rBb=function(F){var fa=(F=void 0===F?null:F)?F.Fg:null,Pa=new ze;if(Pa.Fg=fa){var yb=6===F.Fm?1:0;fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(yb=this.P8.K3(fa.storeType||fa.currentStoreType,fa.solutionId||fa.id,yb))&&yb.nl&&(Pa.nl=yb.nl,this.wpa&&3===F.Fm&&"hardcodedpreinstall"!==fa.storeType)&&(F="",yb.nl.pK&&yb.nl.pK.fq&&(yb=yb.nl.pK.fq.na(0))&&(F=yb.id),yb={},fa=(yb.SDX_CommandPlacement=
F,yb.SDX_PinningAction="Pinning",yb.SDX_PinningActionErrorCode="0",yb.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.storeType,fa.storeId,fa.solutionId),yb),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)}))):(yb=this.P8.K3(fa.storeType||fa.currentStoreType,fa.solutionId||fa.id,yb))&&yb.nl&&(Pa.nl=yb.nl,this.wpa&&3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType)&&(F="",yb.nl.pK&&yb.nl.pK.fq&&(yb=yb.nl.pK.fq.na(0))&&(F=yb.id),yb=
{},fa=(yb.SDX_CommandPlacement=F,yb.SDX_PinningAction="Pinning",yb.SDX_PinningActionErrorCode="0",yb.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.currentStoreType,fa.storeId,fa.assetId),yb),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)})))}this.Ya.raiseEvent(Gg.a.cme,Pa)};Kd.prototype.dSf=function(F,fa,Pa,yb){yb=Object(Wi.a)(qh.Ribbon,yb);F&&yb&&(F=F.tabs.na(0).XRa[Sg.a.id],3===Pa&&"hardcodedpreinstall"!==fa&&yb.IKd(F),yb.Yei(F)&&
yb.Gcj())};Object(ae.a)(Kd,"LaunchAddinCommandsHandler",null,[302]);b(914);b(892);bd.prototype.k7=function(){return tf.k(this.p1d,this.nsi(),this.hA)};bd.prototype.nsi=function(){var F=null;if(this.hfa){F=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var fa=yl(this.hfa),Pa=fa.next();!Pa.done;Pa=fa.next())F.append(Pa.value.k7());F.append("</Controls></MenuSection></Menu>")}return F?F.toString():""};tl.Object.defineProperties(bd.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id||""}},hA:{configurable:!0,enumerable:!0,get:function(){return this.n1d||(this.n1d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.p1d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.hfa||(this.hfa=new Gh.a)}}});Object(ae.a)(bd,"ControlDefinition",null,[311]);Ac.prototype.k7=function(){return tf.k(Sg.a.button,null,this.pLc)};tl.Object.defineProperties(Ac.prototype,{QQ:{configurable:!0,enumerable:!0,get:function(){return this.pLc||
(this.pLc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(ae.a)(Ac,"MenuItemDefinition",null,[345]);dc.prototype.k7=function(){var F=null;if(this.Y7){F=new Sys.StringBuilder;for(var fa=yl(this.Y7),Pa=fa.next();!Pa.done;Pa=fa.next())F.append(Pa.value.k7())}return F?F.toString():""};tl.Object.defineProperties(dc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.Y7||(this.Y7=
new Gh.a)}}});Object(ae.a)(dc,"OfficeMenuDefinition",null,[308]);var Eh=b(29);mb.prototype.addButton=function(F){Re.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",F.actionType);this.zI=new bd(this.nP(F.id),Sg.a.button);this.zI.hA[Sg.a.nOb]=F.label;this.zI.hA[Sg.a.ATa]=F.label;this.zI.hA[Sg.a.CTa]=F.icon["16"];this.Dra(this.zI.hA[Sg.a.id],F.action);this.Y1(this.zI.hA);this.oUa.controls.add(this.zI);this.zI=null};mb.prototype.startBuildMenu=function(F){if(cj.c(this.oUa))this.oUa=
new dc(F.id);else{var fa=this.nP(F.id);this.zI=new bd(fa,Sg.a.N3);this.Qga(this.zI.hA,F);this.zI.hA[Sg.a.CTa]=F.icon["16"];this.zI.hA[Sg.a.ffb]=Eh.a.alwaysEnabled}};mb.prototype.addMenuItem=function(F){Re.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",F.actionType);var fa=new Ac(this.nP(F.id));this.Qga(fa.QQ,F);F.icon&&(fa.QQ[Sg.a.CTa]=F.icon["16"]);this.Dra(fa.QQ[Sg.a.id],F.action);this.Y1(fa.QQ);this.zI.menuItems.add(fa)};mb.prototype.endBuildMenu=function(){cj.c(this.zI)?
(this.zjc.add(this.oUa),this.oUa=null):(this.oUa.controls.add(this.zI),this.zI=null)};mb.prototype.Dra=function(F,fa){this.rlb.bindAction(F,fa)};mb.prototype.Y1=function(F){this.zGa.Y1(F)};mb.prototype.nP=function(F){return this.x5.wua(F)};mb.prototype.Qga=function(F,fa){F[Sg.a.nOb]=fa.label;F[Sg.a.ATa]=fa.label};tl.Object.defineProperties(mb.prototype,{x5:{configurable:!0,enumerable:!0,get:function(){return this.Zib}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}},rlb:{configurable:!0,
enumerable:!0,get:function(){return this.oea}},zjc:{configurable:!0,enumerable:!0,get:function(){return this.Sng}}});Object(ae.a)(mb,"ContextMenuExtensibilityCreator",null,[330,325]);Aa.prototype.wua=function(F){return this.tNa+F};tl.Object.defineProperties(Aa.prototype,{tNa:{configurable:!0,enumerable:!0,get:function(){return this.LDa}}});Object(ae.a)(Aa,"DefaultContextMenuNamingProvider",null,[329]);uc.prototype.XFh=function(F){return this.QYg+F};tl.Object.defineProperties(uc.prototype,{NAj:{configurable:!0,
enumerable:!0,get:function(){return this.Rsg}},QYg:{configurable:!0,enumerable:!0,get:function(){return this.Eig}}});Object(ae.a)(uc,"DefaultRibbonGroupTemplate",null,[346]);tl.Object.defineProperties(Hc.prototype,{Xcb:{configurable:!0,enumerable:!0,get:function(){return this.Skb}}});Object(ae.a)(Hc,"DefaultRibbonGroupTemplateResolver",null,[328]);var Yh=b(1292);Jb.prototype.bindAction=function(F,fa){OfficeExt.DefaultControlActionBinder.bindAction(F,fa)};Object(ae.a)(Jb,"DefaultUIControlActionBinder",
null,[327]);$b.prototype.Y1=function(F){F[Sg.a.ffb]=this.command};tl.Object.defineProperties($b.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.jCa}}});Object(ae.a)($b,"DefaultUIControlCommandBinder",null,[326]);var Fi=b(31);Object(ae.a)(db,"AddInControl",null,[]);Object(ae.a)(Ca,"AddInGroup",null,[]);Object(ae.a)(Wa,"AddInMenuItem",null,[]);Object(ae.a)(Za,"AddInTab",null,[]);ec.prototype.startBuildTab=function(F){var fa=F.isOfficeTab?F.id:this.x5.jfd(F.id),Pa=F.isOfficeTab?
null:F.label;this.qv=Object.assign(new Za,{id:fa,title:Pa,isOfficeTab:F.isOfficeTab,visible:F.visible,groups:[],tabType:F.tabType,insertBefore:F.insertBefore,insertAfter:F.insertAfter,autoFocus:F.autoFocus})};ec.prototype.startBuildGroup=function(F){var fa=this.nP(F.id);this.Ew=Object.assign(new Ca,{id:fa,mlrId:F.mlrId,title:F.label,controls:[],groupType:0})};ec.prototype.addNativeGroup=function(F){this.Ew=Object.assign(new Ca,{id:F.id,mlrId:F.mlrId,title:F.label,controls:[],groupType:1});this.qv.groups.push(this.Ew)};
ec.prototype.addButton=function(F){var fa=this.nP(F.id);fa&&(this.Dra(fa,F.action),Re.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new db,{id:fa,title:F.label,iconLocation:this.edd(F),enabled:F.enabled,controlType:0,attributes:this.Qga()}),this.r3d.Fie(new Fi.a(fa,this.zGa.command.toString())),this.Ew.controls.push(F))};ec.prototype.addNativeControl=function(F){F.id&&(Re.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
F.actionType),F=Object.assign(new db,{id:F.id,title:"",iconLocation:"",enabled:F.enabled,controlType:2,attributes:this.Qga()}),this.Ew.controls.push(F))};ec.prototype.startBuildMenu=function(F){var fa=this.nP(F.id);fa&&(this.Z7=Object.assign(new db,{id:fa,title:F.label,iconLocation:this.edd(F),controlType:1,attributes:{},menuItems:[]}))};ec.prototype.addMenuItem=function(F){var fa=this.nP(F.id);fa&&(this.Dra(fa,F.action),Re.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",
F.actionType),F=Object.assign(new Wa,{id:fa,title:F.label,iconLocation:this.edd(F),enabled:F.enabled,attributes:this.Qga()}),this.r3d.Fie(new Fi.a(fa,this.zGa.command.toString())),this.Z7.menuItems.push(F))};ec.prototype.endBuildMenu=function(){cj.c(this.Z7.id)||this.Ew.controls.push(this.Z7);this.Z7=null};ec.prototype.endBuildGroup=function(){cj.c(this.Ew.id)||this.qv.groups.push(this.Ew);this.Ew=null};ec.prototype.endBuildTab=function(){cj.c(this.qv.id)||this.BOb.add(this.qv);this.qv=null};ec.prototype.Qga=
function(){var F={};this.Y1(F);return F};ec.prototype.edd=function(F){return F.icon["80"]?F.icon["80"]:F.icon["32"]};ec.prototype.Y1=function(F){this.zGa.Y1(F)};ec.prototype.nP=function(F){return this.x5.wua(F)};ec.prototype.Dra=function(F,fa){this.rlb.bindAction(F,fa)};tl.Object.defineProperties(ec.prototype,{x5:{configurable:!0,enumerable:!0,get:function(){return this.Zib}},fq:{configurable:!0,enumerable:!0,get:function(){return this.BOb}},zxc:{configurable:!0,enumerable:!0,get:function(){return null}},
rlb:{configurable:!0,enumerable:!0,get:function(){return this.oea}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}}});Object(ae.a)(ec,"OneLineRibbonExtensibilityCreator",null,[324,325]);Yb.prototype.k7=function(){for(var F=new Gh.a,fa=yl(this.Aha),Pa=fa.next();!Pa.done;Pa=fa.next())F.add(Pa.value.k7());F=tf.e.apply(null,[Sg.a.gfb,null].concat(F.toArray()));return tf.e(Sg.a.GROUP,this.ava,F)};tl.Object.defineProperties(Yb.prototype,{Xcb:{configurable:!0,enumerable:!0,get:function(){return this.Skb},
set:function(F){this.Skb=F;this.ava[Sg.a.nfg]=this.Skb}},ava:{configurable:!0,enumerable:!0,get:function(){return this.t4d||(this.t4d={})}},Aha:{configurable:!0,enumerable:!0,get:function(){return this.o1d||(this.o1d=new Gh.a)}}});Object(ae.a)(Yb,"GroupDefinition",null,[]);$a.prototype.k7=function(){for(var F=new Gh.a,fa=new Gh.a,Pa=yl(this.ZJd),yb=Pa.next();!yb.done;yb=Pa.next())F.add(yb.value.k7());Pa=yl(this.KJ);for(yb=Pa.next();!yb.done;yb=Pa.next())fa.add(yb.value.k7());fa=this.lse(Sg.a.mOb,
this.j2e,fa.toArray());F=this.lse(Sg.a.XYd,this.gSf,F.toArray());return tf.e(Sg.a.lfg,this.XRa,F,fa)};$a.prototype.lse=function(F,fa,Pa){var yb={};yb[Sg.a.id]=fa;return tf.e.apply(null,[F,yb].concat(Pa))};tl.Object.defineProperties($a.prototype,{tAa:{configurable:!0,enumerable:!0,get:function(){return this._id}},XRa:{configurable:!0,enumerable:!0,get:function(){return this.lfe||(this.lfe={})}},KJ:{configurable:!0,enumerable:!0,get:function(){return this.u4d||(this.u4d=new Gh.a)}},ZJd:{configurable:!0,
enumerable:!0,get:function(){return this.lde||(this.lde=new Gh.a)}}});Object(ae.a)($a,"TabDefinition",null,[]);jb.prototype.startBuildTab=function(F){F=F.isOfficeTab?this.x5.vNh(F.id):this.x5.jfd(F.id);this.qv=new $a(F)};jb.prototype.startBuildGroup=function(F){F=this.nP(F.id);this.Ew=new Yb(F)};jb.prototype.addButton=function(F){var fa=this.nP(F.id);this.Dra(fa,F.action)};jb.prototype.startBuildMenu=function(){};jb.prototype.addMenuItem=function(F){var fa=this.nP(F.id);this.Dra(fa,F.action)};jb.prototype.endBuildMenu=
function(){};jb.prototype.endBuildGroup=function(){this.qv.KJ.add(this.Ew);this.Ew=null};jb.prototype.endBuildTab=function(){cj.c(this.qv.tAa)||this.pfe.add(this.qv);this.qv=null};jb.prototype.Dra=function(F,fa){this.rlb.bindAction(F,fa)};jb.prototype.nP=function(F){return this.x5.wua(F)};tl.Object.defineProperties(jb.prototype,{fq:{configurable:!0,enumerable:!0,get:function(){return null}},x5:{configurable:!0,enumerable:!0,get:function(){return this.Zib}},rlb:{configurable:!0,enumerable:!0,get:function(){return this.oea}},
zxc:{configurable:!0,enumerable:!0,get:function(){return this.pfe}}});Object(ae.a)(jb,"RibbonExtensibilityCreatorBase",null,[324,325]);Ua.prototype.k7=function(){return tf.k(this.Oqg,null,this.U_)};tl.Object.defineProperties(Ua.prototype,{U_:{configurable:!0,enumerable:!0,get:function(){return this.kde||(this.kde={})}}});Object(ae.a)(Ua,"ScalingDefinition",null,[]);vm(Ga,jb);Ga.prototype.startBuildTab=function(F){jb.prototype.startBuildTab.call(this,F);this.qv.isOfficeTab=F.isOfficeTab;if(!this.qv.isOfficeTab)this.qv.XRa[Sg.a.noa]=
this.g6b(F.label);else if(this.qv.tAa){var fa=this.x5.mLh(F.id);fa&&(this.qv.XRa[Sg.a.noa]=fa);(F=this.x5.kLh(F.id))&&(this.qv.XRa[Sg.a.Keg]=F)}F=this.qv.tAa;this.qv.gSf=F+"."+Sg.a.XYd;this.qv.j2e=F+"."+Sg.a.mOb};Ga.prototype.startBuildGroup=function(F){jb.prototype.startBuildGroup.call(this,F);this.Ew.ava[Sg.a.noa]=this.g6b(F.label)};Ga.prototype.addButton=function(F){jb.prototype.addButton.call(this,F);Re.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",F.actionType);
var fa=this.uT(F,Sg.a.button);this.Y1(fa.hA);fa.hA[Sg.a.BTa]=F.enabled;this.Ew.Aha.add(fa)};Ga.prototype.startBuildMenu=function(F){this.Z7=this.uT(F,Sg.a.N3)};Ga.prototype.addMenuItem=function(F){jb.prototype.addMenuItem.call(this,F);Re.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",F.actionType);var fa=this.nP(F.id);fa=new Ac(fa);this.Qga(fa.QQ,F);this.Y1(fa.QQ);fa.QQ[Sg.a.BTa]=F.enabled;this.Z7.menuItems.add(fa)};Ga.prototype.endBuildMenu=function(){this.Ew.Aha.add(this.Z7);
this.Z7=null};Ga.prototype.endBuildGroup=function(){this.SMg();this.qv.ZJd.add(this.Bea);this.Eea&&(this.qv.ZJd.add(this.Eea),this.Eea=null);this.Bea=null;jb.prototype.endBuildGroup.call(this)};Ga.prototype.Y1=function(F){this.zGa.Y1(F)};Ga.prototype.uT=function(F,fa){var Pa=this.nP(F.id);fa=new bd(Pa,fa);this.Qga(fa.hA,F);return fa};Ga.prototype.Qga=function(F,fa){F[Sg.a.nOb]=this.g6b(fa.label);F[Sg.a.ATa]=this.g6b(fa.label);F[Sg.a.CTa]=fa.icon["16"];F[Sg.a.Geg]=fa.icon["32"]};Ga.prototype.SMg=function(){var F=
this.jWh.Xcb;this.Ew.Xcb=F.NAj;var fa=this.Ew.Aha.count;Re.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",fa);var Pa=this.Ew.ava[Sg.a.id];this.Bea=new Ua(Sg.a.SYd);this.Bea.U_[Sg.a.id]=Pa+".Scaling."+Sg.a.SYd;this.Bea.U_[Sg.a.MYd]=this.Ew.ava[Sg.a.id];2<fa&&(this.Eea=new Ua(Sg.a.WYd),this.Eea.U_[Sg.a.id]=Pa+".Scaling."+Sg.a.WYd,this.Eea.U_[Sg.a.MYd]=this.Ew.ava[Sg.a.id]);this.Zkj(fa,F)};Ga.prototype.Zkj=function(F,fa){var Pa=1;switch(F){case 1:case 2:this.Bea.U_[Sg.a.KBa]=Sg.a.LARGE;break;
case 3:this.Bea.U_[Sg.a.KBa]=Sg.a.LARGE;this.Eea.U_[Sg.a.KBa]=Sg.a.aCc;break;case 4:this.Bea.U_[Sg.a.KBa]=Sg.a.aCc+"TwoRow";this.Eea.U_[Sg.a.KBa]=Sg.a.SMALL+"TwoRow";break;case 5:case 6:this.Bea.U_[Sg.a.KBa]=Sg.a.aCc;this.Eea.U_[Sg.a.KBa]=Sg.a.SMALL;break;default:throw Re.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",F),this.U0.setErrorMessageForAddin(this.iDc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",
F));}for(var yb=yl(this.Ew.Aha),Cc=yb.next();!Cc.done;Cc=yb.next())Cc.value.hA[Sg.a.ofg]=fa.XFh(Pa),Pa+=3!==F?1:2};Ga.prototype.g6b=function(F){return F?(F=Fa.a.replaceAll(F,"&","&amp;"),F=Fa.a.replaceAll(F,"'","&apos;"),F=Fa.a.replaceAll(F,'"',"&quot;"),F=Fa.a.replaceAll(F,">","&gt;"),F=Fa.a.replaceAll(F,"<","&lt;")):null};tl.Object.defineProperties(Ga.prototype,{jWh:{configurable:!0,enumerable:!0,get:function(){return this.hlg}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}}});
Object(ae.a)(Ga,"RibbonExtensibilityCreator",jb,[]);Ha.prototype.l_b=function(F){F=new Aa(F);return new mb(F,this.yea,this.oea)};Ha.prototype.ese=function(F,fa,Pa){Pa=new Yh.a(this.LDa,F,Pa,!0);var yb=new Hc(this.LDa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new Ga(Pa,this.oea,this.yea,yb,F,fa)};Ha.prototype.Zre=function(F,fa,Pa,yb){Pa=new Yh.a(this.LDa,F,Pa,!0);return new ec(Pa,this.oea,this.yea,F,fa,yb)};Object(ae.a)(Ha,"UIExtensibilityFactory",null,[296]);var Qh=b(950);
bb.prototype.B1i=function(F){this.Fo=F;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Ri.a)(this,this.oGi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(Ri.a)(this,this.LBi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Ri.a)(this,this.rAi,"onCloseButtonClicked_ContentAddin"),!0))};bb.prototype.qed=function(F){return"[id="+F+"]"};bb.prototype.v0f=function(F,fa){var Pa=this;fa>fg.AFrameworkApplication.ga.zd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.lqc),this.u0f("[data-unique-id='pivotOverflowButton']"),Re.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+F)?this.u0f(F):this.lqc=window.setTimeout(function(){Pa.v0f(F,fa+1)},1E3)};bb.prototype.t0f=function(F){var fa=document.querySelector("button[data-unique-id='RightPaddle']");if(fa)F={},F=(F.AppTeachingUICalloutAction="RightPaddlePresent",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,
this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));else if(fa=document.querySelector("button"+F),!fa&&(fa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!fa)){fa={};fa=(fa.AppTeachingUICalloutAction="NoAnchor",fa["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,
this.Fg.assetId),fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(fa)}));Re.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.M6f(fa,"ShowTeachingUIForAddinButton")};bb.prototype.u0f=function(F){F=document.querySelector("button"+F);if(!F&&(F=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!F)){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));Re.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.M6f(F,"ShowTeachingUIForAddinTab")};
bb.prototype.M6f=function(F,fa){F.setAttribute("lpp-id","latestAddin");var Pa=dh.a.instance.mc("Common.ISystemInitiatedFeedback");Pa&&F?(Pa.execute(function(yb){yb.logActivity(fa,null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(F)})),Re.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Re.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),F={},F=(F.AppTeachingUICalloutAction="NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})))};bb.prototype.qCh=function(F){if(!F)return null;F=F.pK;if((null===F||void 0===F?0:F.fq)&&0<F.fq.count){F=yl(F.fq);for(var fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.groups&&0<fa.groups.length){fa=yl(fa.groups);for(var Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa=Pa.value,Pa.controls&&0<Pa.controls.length){Pa=yl(Pa.controls);for(var yb=Pa.next();!yb.done;yb=Pa.next()){yb=yb.value;if(yb.attributes&&!yb.controlType&&
yb.enabled)return yb.id;if(yb.menuItems)for(var Cc=yl(yb.menuItems),Vc=Cc.next();!Vc.done;Vc=Cc.next())if(Vc=Vc.value,Vc.attributes&&Vc.enabled)return yb.id}}}}return null};bb.prototype.Ztj=function(){var F=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(null==F){F=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==F){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,
this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));Re.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}Re.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}else Re.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");
var fa=dh.a.instance.mc("Common.ISystemInitiatedFeedback");null==fa||null==F?(F={},F=(F.AppTeachingUICalloutAction="NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})),Re.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture")):
(fa.execute(function(Pa){Pa.logActivity("ShowTeachingUIForContentAddin",null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})),Re.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};
bb.prototype.oGi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnLaunch",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));var fa={};fa[Se.a.Kg]=this.Fo;F={};F.solutionId=this.Fo.solutionId;F.assetId=this.Fo.assetId;F.assetStoreId=
this.Fo.assetStoreId;F.height=0!=this.Fo.height?this.Fo.height:600;F.storeId=this.Fo.storeId;F.storeType=this.Fo.storeType;F.targetType=this.Fo.targetType;F.width=0!=this.Fo.width?this.Fo.width:600;F.displayName=this.Fo.displayName;F.version=this.Fo.version;F.isAddinCommands=!1;fa[Gg.a.OXa]=F;var Pa=new ak.a(-741808261,0,0,2,null);Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(yb){yb=yb.result;null!=yb&&yb.insertAgave(fa,Pa)},this.$.ma,3)};bb.prototype.rAi=function(){var F=
{};F=(F.AppTeachingUICalloutAction="ClickOnClose",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};bb.prototype.LBi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,
this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object(ae.a)(bb,"AddinTeachingCalloutHandler",null,[]);var Wh=b(1250),gh=b(374),zh=b(8),wh=b(37);ka.prototype.dispose=function(){void 0!==this.Amb&&null!==this.Amb&&(this.Amb.dispose(),this.Amb=null);this.Ve=this.$=null;this.disposed=!0};ka.prototype.zKi=
function(F){var fa=this;if(void 0!==F&&this.GOd&&isNullOrUndefined(this.RRd)){var Pa=F.solutionId;Re.ULS.sendTraceTag(526509831,220,50,"Start monitor addin {0}.",Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,Pa));this.RRd=Pa;this.lqc=window.setTimeout(function(){fa.GOd&&(dh.a.instance.mc("Common.ISystemInitiatedFeedback").execute(function(yb){yb.logActivity("Office_Excel_Addins_NoActivationFloodgate",null)}),fa.GOd=!1)},this.vzj)}};ka.prototype.p3i=function(F){fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",
!1)&&this.RRd===F&&(window.clearTimeout(this.lqc),this.RRd=void 0)};ka.prototype.Voj=function(F,fa){switch(F){case Eh.a.c2:F=this.Hoj(fa);break;default:F=!1}return F};ka.prototype.Xc=function(){return!1};ka.prototype.executeCommand=function(F,fa,Pa){var yb=this;F=Vg.TaskExtensions.om();fa=fa.command;switch(fa){case 843847158:break;case -2025863019:ck.a.Fvc(Pa[Gg.a.VTc].toString(),function(){Rh.g(yb.$).focus()});break;case -1777565636:Wh.a.showUILessDialog(Pa[Gg.a.Bmb].toString());this.Ve.Nrj(Pa[Gg.a.Bmb].toString());
break;case 1592314317:Wh.a.hideUILessDialog(Pa[Gg.a.Bmb].toString());this.Ve.N_h(Pa[Gg.a.Bmb].toString());break;case Eh.a.c2:F=this.ngd(Pa);break;case Eh.a.Fzb:this.BMa(Pa);break;case Eh.a.oma:this.oma(Pa);break;case Eh.a.ROd:this.Amb.Uvc();break;case Eh.a.refreshAddinCommands:this.C_i();break;case 1949669462:this.uga.ZLd(!0);break;case -1014260128:F=this.executeDynamicAddInCommandsAPI(Pa);break;default:F=hk.a(fa)}return F};ka.prototype.Gc=function(F,fa){F=!1;switch(fa.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Eh.a.oma:case Eh.a.ROd:case Eh.a.refreshAddinCommands:case 1949669462:case Eh.a.Fzb:case -1014260128:F=
!0;break;case Eh.a.c2:F=!fg.AFrameworkApplication.protectedFile}return F};ka.prototype.fd=function(){return!1};ka.prototype.UFh=function(F){if(!F)return Re.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((F=F.pK)&&F.fq&&0<F.fq.count){F=yl(F.fq);for(var fa=F.next();!fa.done;fa=F.next()){fa=fa.value;if(fa.groups&&1===fa.groups.length){var Pa=fa.groups[0];if(Pa.controls&&1===Pa.controls.length){var yb=Pa.controls[0];if(yb.attributes&&!yb.controlType&&yb.enabled)return yb.id}Pa.controls&&
Re.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}fa.groups&&Re.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};ka.prototype.C_i=function(){if(this.uga.Ird()){this.uga.Rve();var F=this.nbd();if(F&&0<F.count){F=yl(F);for(var fa=F.next();!fa.done;fa=F.next()){var Pa={};fa=(Pa[Gg.a.k2]=fa.value,Pa[Gg.a.bJ]=4,Pa[Gg.a.iFa]=(new Date).getTime(),Pa);this.oma(fa)}}}};ka.prototype.oma=function(F){var fa=this;Re.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
F[Gg.a.bJ],F[Gg.a.k2]);this.uga.chj();window.setTimeout(function(){if(void 0===fa.Ve||null===fa.Ve)Re.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",wh.a.U2()));else{var Pa=new kd(new gb(fa.Ve.Gi),wc.instance,Jf.instance);Pa.bzg(function(yb,Cc){fa.BMa(Cc.properties)});fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Pa.xCg(function(yb,Cc){null==Cc?(yb={},yb=(yb.AppTeachingUICalloutAction="InvalidEventArgs",yb.AppTeachingUICalloutGoal="NewAdminDeployment",yb["SDX.AppInstallOrigin"]="Organization",yb),Ph.a.sendTelemetryEvent(Object.assign(new ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(yb)}))):(fa.z4f=new bb(fa),fa.z4f.B1i(Cc),yb=fa.$.Ka,null!=yb&&(yb.Vle(Object(Ri.a)(fa,
fa.x8e,"onTabSwitched")),Re.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Pa.UFj(F)}},0)};ka.prototype.x8e=function(F,fa){"Insert"==fa.tabName&&(F=this.$.Ka,null!=F&&(F.hNf(Object(Ri.a)(this,this.x8e,"onTabSwitched")),Re.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.z4f.Ztj())};ka.prototype.BMa=function(F){var fa=this;if(!this.disposed){Re.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",F[Gg.a.bJ]);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",
!1))try{var Pa=F[Gg.a.hFa],yb=F[Gg.a.bJ];if(Pa&&0<Pa.count&&3==yb){var Cc=Pa.na(0);Cc.storeType==OSF.StoreType.OMEX&&this.zKi(Cc)}}catch(lg){Re.ULS.sendTraceTag(526509830,220,10,String.format("Monitor survey error message : {0}.",lg.message))}try{if(ig.EwaSettings.la(186)){var Vc=F[Gg.a.hFa];if(Vc&&0<Vc.count){var rd=Vc.count;for(Pa=rd-1;0<=Pa;Pa--){var Hd=Vc.na(Pa);ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Hd.currentStoreType)||
Vc.remove(Vc.na(Pa)):Hd.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&Vc.remove(Vc.na(Pa))}if(Vc.count<rd){var te=Zi.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Vg.TaskExtensions.Ba(te,function(){te.result.hg(35,null)},this.$.ma,3)}if(!Vc.count)return}}if(void 0===this.Ve||null===this.Ve)Re.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",wh.a.U2()));else{var hf=null;hf=fg.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?
new Kd(this.hl,this.hze,new gb(this.Ve.Gi),new Ha(this.$.Ib,Eh.a.c2),this.uga,wc.instance,this.tga,function(lg,Og){var lh={};lh.InstanceId=tj.a.create().toString();lh.PrimaryMarketplace={};lh.PrimaryMarketplace.MarketplaceRef=lg.storeId;lh.PrimaryMarketplace.MarketplaceType=lg.currentStoreType;lh.PrimaryMarketplace.SolutionId=lg.assetId;lh.PrimaryMarketplace.SolutionVersion=lg.appVersion;lh.WebExtensionType=1;fa.Ve.euj(lh,function(){Og(lg)})}):new Kd(this.hl,this.hze,new gb(this.Ve.Gi),new Ha(this.$.Ib,
Eh.a.c2),this.uga,wc.instance,this.tga);fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)&&hf.izg(this.czi);hf.czg(this.mGi);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var ff=new bb(this);hf.WAg(ff.lGi);hf.wCg(ff.yrj)}this.$.da.Aa(53).Lm&&cd.a.get_instance().xl(5,null).continueWith(function(){fa.disposed||hf.Lji(fa.c9c,fa.$.domElement,F)})}}catch(lg){Re.ULS.sendTraceTag(537170653,
220,10,String.format("LaunchAddinCommands error message : {0}.",lg.message))}}};ka.prototype.ngd=function(F){var fa=this,Pa=Vg.TaskExtensions.om();F=F[this.hl.Bha];var yb=this.gYb.Ahe(F),Cc=new Wh.a(this.$,this.Ve,yb.ownerAddinInfo,Pa);Cc.Yyg(function(){fa.p3i(yb.ownerAddinInfo.solutionId)});return this.l2e(Pa,F,yb,Cc)};ka.prototype.l2e=function(F,fa,Pa,yb){var Cc=this;this.gYb.ngd(fa,this.uga,yb,new gb(this.Ve.Gi),Pa,function(){F=yb.cYg()},function(){Rh.g(Cc.$).focus()});return F};ka.prototype.EIg=
function(F){var fa=this,Pa=Vg.TaskExtensions.om(),yb=this.Ve.T$(F.assetId);if(yb){var Cc=this.Ve.XY(yb);if(zh.HelperMethods.Vv(Cc)&&Cc.SharedRuntime.State)return}Cc=this.gYb.FIg;var Vc=F.assetId in Cc?Cc[F.assetId]:null;if(Vc){var rd=this.gYb.Ahe(Vc),Hd=new Wh.a(this.$,this.Ve,rd.ownerAddinInfo,Pa);Cc=function(hf){if(hf){var ff={};hf=yl(hf);for(var lg=hf.next();!lg.done;lg=hf.next())lg=lg.value,ff[lg[0]]=lg[1];(ff=Gg.a.bme in ff?ff[Gg.a.bme]:null)&&"true"===ff.toLowerCase()&&(Re.ULS.sendTraceTag(537170652,
220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",F.currentStoreType,F.storeId,Telemetry.PrivacyRules.GetAssetId(null!==rd.ownerAddinInfo?rd.ownerAddinInfo.storeType:F.currentStoreType,F.storeId,F.assetId)),fa.l2e(Pa,Vc,rd,Hd))}};Re.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",F.currentStoreType,F.storeId,Telemetry.PrivacyRules.GetAssetId(null!==rd.ownerAddinInfo?rd.ownerAddinInfo.storeType:
F.currentStoreType,F.storeId,F.assetId));if(yb)Cc(this.Ve.XY(yb).OsfPropertyBag);else if(yb=this.$.fa.workbookContext.WebExtensions){yb=yl(yb);for(var te=yb.next();!te.done;te=yb.next())if(te=te.value,(1===te.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===F.targetType&&te.PrimaryMarketplace.MarketplaceType.toLowerCase()===F.currentStoreType.toLowerCase()&&te.PrimaryMarketplace.MarketplaceRef.toLowerCase()===F.storeId.toLowerCase()&&te.PrimaryMarketplace.SolutionId.toLowerCase()===
F.assetId.toLowerCase()){Cc(te.OsfPropertyBag);break}}}};ka.prototype.QKb=function(F,fa,Pa){F&&(void 0===Pa||!Pa||fa||this.k4c.contains(F)||this.k4c.add(F),(Pa=this.p0a.contains(F))&&fa&&this.p0a.remove(F),Pa||fa||this.p0a.add(F))};ka.prototype.Ikj=function(F){var fa=F.pK;if(fa){if(fa.fq)for(F=yl(fa.fq),fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.groups){fa=yl(fa.groups);for(var Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa=Pa.value,Pa.controls){var yb=yl(Pa.controls);for(Pa=yb.next();!Pa.done;Pa=
yb.next())if(Pa=Pa.value,this.QKb(Pa.id,Pa.enabled,!0),1===Pa.controlType&&Pa.menuItems){var Cc=yl(Pa.menuItems);for(Pa=Cc.next();!Pa.done;Pa=Cc.next())Pa=Pa.value,this.QKb(Pa.id,Pa.enabled,!0)}}}}else if(F.tabs)for(F=yl(F.tabs),fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.KJ)for(fa=yl(fa.KJ),Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa=Pa.value,Pa.Aha)for(yb=yl(Pa.Aha),Pa=yb.next();!Pa.done;Pa=yb.next())if(Pa=Pa.value,this.QKb(Pa.id,Sg.a.BTa in Pa.hA?Pa.hA[Sg.a.BTa]:!0,!0),Pa.controlType===Sg.a.N3&&
Pa.menuItems)for(Cc=yl(Pa.menuItems),Pa=Cc.next();!Pa.done;Pa=Cc.next())Pa=Pa.value,this.QKb(Pa.id,Sg.a.BTa in Pa.QQ?Pa.QQ[Sg.a.BTa]:!0,!0)};ka.prototype.nbd=function(){var F=new Gh.a;ig.EwaSettings.la(53)&&(this.$.fa.jh.get(27)&&(F.add(0),F.add(16)),this.$.fa.jh.get(33)&&F.add(1),F.add(8));return F};ka.prototype.executeDynamicAddInCommandsAPI=function(F){var fa=!0;if(void 0===F||null===F||void 0===F[Gg.a.wrb]||null===F[Gg.a.wrb])return oj.Task.Ta(!1);switch(F[Gg.a.wrb]){case 1:fa=this.PIj(F);break;
case 2:fa=this.Mkj(F);break;case 4:this.p0a.clear();this.p0a.addRange(this.k4c);break;case 3:fa=this.installContextualTab(F);break;default:fa=!1}return oj.Task.Ta(fa)};ka.prototype.Hoj=function(F){return F&&this.hl.Bha in F?(F=F[this.hl.Bha])?this.p0a.contains(F):!1:!1};ka.prototype.PIj=function(F){var fa=null,Pa=null,yb=null,Cc=!0;void 0!==F[Gg.a.t3]&&null!==F[Gg.a.t3]&&void 0!==F[this.hl.Bha]&&null!==F[this.hl.Bha]&&void 0!==F[Gg.a.s3]&&null!==F[Gg.a.s3]&&(fa=F[Gg.a.t3],Pa=F[Gg.a.O5b],yb=F[this.hl.Bha],
Cc=F[Gg.a.s3]);if(!fa||!yb)return Re.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;F=(new Yh.a(this.$.Ib,fa,this.hl,!0)).wua(yb);fa={DynamicAddinCommandsApiName:"UpdateControlEnableState"};fa.AssetId=Pa;fa.MaskedTabId=F;fa.IsToEnable=Cc;Re.ULS.sendTraceTag(537170648,220,15,wi.a.Hc(fa));this.QKb(F,Cc);gh.a.sy.updateCommandUI();return!0};ka.prototype.Mkj=function(F){var fa,Pa,yb=null,Cc=null,Vc=null,rd=null,Hd=!0;void 0!==F[Gg.a.T5c]&&null!==
F[Gg.a.T5c]&&void 0!==F[Gg.a.t3]&&null!==F[Gg.a.t3]&&void 0!==F[this.hl.Bha]&&null!==F[this.hl.Bha]&&void 0!==F[Gg.a.s3]&&null!==F[Gg.a.s3]&&(yb=F[Gg.a.T5c],Cc=F[Gg.a.t3],Vc=F[Gg.a.O5b],rd=F[this.hl.Bha],Hd=F[Gg.a.s3]);if(!yb||!Cc||!rd)return Re.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;F=(new Yh.a(this.$.Ib,Cc,this.hl,!0)).jfd(rd);rd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};rd.StoreType=yb;rd.AssetId=Vc;rd.MaskedTabId=F;
rd.IsToShow=Hd;Re.ULS.sendTraceTag(537170646,220,15,wi.a.Hc(rd));Cc=this.uga.K3(yb,Cc,1);yb=!1;if(null===(Pa=null===(fa=null===Cc||void 0===Cc?void 0:Cc.nl)||void 0===fa?void 0:fa.pK)||void 0===Pa?0:Pa.fq)for(fa=yl(Cc.nl.pK.fq),Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa.value.id===F){yb=!0;break}if(!yb)return Re.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;fa=[];Hd?appChrome.selectors.getSelectedTabId()!==F&&fa.push(appChrome.actions.activateRibbonTab(F)):
(appChrome.selectors.getSelectedTabId()===F&&fa.push(appChrome.actions.setCurrentTab(Ni.a.dW)),fa.push(appChrome.actions.deactivateRibbonTab(F)));appChrome.api.dispatch(fa);return!0};ka.prototype.installContextualTab=function(F){var fa=null,Pa=null,yb=null,Cc=null;if(void 0!==F[Gg.a.t3]&&null!==F[Gg.a.t3]&&void 0!==F[Gg.a.s3]&&null!==F[Gg.a.s3]){var Vc=F[Gg.a.s3];fa=F[Gg.a.t3];void 0!==Vc[Gg.a.$Ha]&&null!==Vc[Gg.a.$Ha]&&void 0!==Vc[Gg.a.aIa]&&null!==Vc[Gg.a.aIa]&&(Pa=Vc[Gg.a.$Ha],yb=Vc[Gg.a.aIa],
Cc=Vc[Gg.a.U5c])}if(!(fa&&yb&&Pa&&Cc))return Re.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;F=this.uga.K3(Cc.PrimaryMarketplace.MarketplaceType,Cc.PrimaryMarketplace.SolutionId,1);if(null===F||void 0===F?0:F.nl)return Re.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;F={};F.solutionId=Cc.PrimaryMarketplace.SolutionId;F.version=Cc.PrimaryMarketplace.SolutionVersion;F.storeType=Cc.PrimaryMarketplace.MarketplaceType;
F.storeId=Cc.PrimaryMarketplace.MarketplaceRef;F.assetId=Cc.PrimaryMarketplace.SolutionId;F.assetStoreId=Cc.PrimaryMarketplace.MarketplaceRef;F.targetType=Cc.WebExtensionOsfControlType;F.width=Cc.TaskpaneWidth;F.height=0;F.isAddinCommands=!0;F.id=F.assetId;F.appVersion=Cc.PrimaryMarketplace.SolutionVersion;F.currentStoreType=Cc.PrimaryMarketplace.MarketplaceType;Cc=new Gh.a;Cc.add(F);F={};F[Gg.a.hFa]=Cc;F[Gg.a.bJ]=6;F[Gg.a.$Ha]=Pa;F[Gg.a.aIa]=yb;this.BMa(F);return!0};Object(ae.a)(ka,"AddinUICommandHandler",
null,[148,147,3]);var pi=b(70);Nb.prototype.fJb=function(){return this.WNd()};Nb.prototype.activate=function(){return this.CRc()};Nb.prototype.deactivate=function(){this.a4c()};Nb.prototype.dispose=function(){this.a4c=this.CRc=this.WNd=null};Object(ae.a)(Nb,"FeatureActivator",null,[51,3]);var vi=b(21),$i=b(17),Ui=Ad.a;vm(E,Ui);E.prototype.Md=function(){var F=this;Re.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");pi.a(this.$).add(Object.assign(new Nb,{WNd:function(){var fa=
F.$.fa.KE&&F.$.fa.oc&&!!(F.$.Fd&16384)&&F.$.isEditMode;F.$.fa.oc&&Re.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",fa,F.$.fa.KE,F.$.fa.oc,!!(F.$.Fd&16384),F.$.isEditMode);return fa},CRc:this.Vug,a4c:this.e8g,D7b:2}))};E.prototype.i0i=function(F){var fa=this,Pa=Zi.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb);return Vg.TaskExtensions.Ba(Pa,
function(){Re.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");fa.$.da.Ha(204,new Ig(Pa.result,F))},this.ma,3)};E.ja=function(F){Ad.a.de(199,new E(F))};Object(ae.a)(E,"AddinUICommandHandlerFactory",Ad.a,[]);var di=b(1237),ri=b(1239),Hi=lj.a;vm(vb,Hi);vb.prototype.create=function(){var F=this,fa;if(ig.EwaSettings.la(412)){var Pa=Zi.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,this.tb),yb=Zi.GetServiceTaskFactory.create(this.$.da,
396,this.$.ma,this.tb);Vg.TaskExtensions.Ba(oj.Task.WAA(Pa,yb),function(){F.Fb(F.$.da.Aa(278)||new di.CustomFunctionsInstaller(F.$,Pa.result,yb.result))},this.$.ma,3)}else(fa=this.$.da.Aa(278))||(fa=this.$.da.Ha(278,new ri.CustomFunctionsLegacyInstaller(this.$))),this.Fb(fa)};vb.ja=function(F){F.da.Ha(279,new vb(F))};Object(ae.a)(vb,"CustomFunctionsInstallerFactory",lj.a,[]);var Ii=b(88),Sh=b(44),si=b(42);rc.prototype.ja=function(F){this.GVc?Re.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.GVc=!0,this.fPa={},this.gPa={},F?F.Ozg(this.P6f):Re.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};rc.prototype.detach=function(F){if(F){F.f4i(this.P6f);F=this.fPa;for(var fa in F)Ii.a.Fa(F[fa]);this.gPa=this.fPa=null;this.GVc=!1}else Re.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};rc.prototype.PIf=function(F,fa,Pa){if(this.C8h(Pa,F))return!1;F=fa.querySelector("iframe");
if(!F)return Re.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;F=F.title;if(!F||!F.length)return Re.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(F);return!0};rc.prototype.C8h=function(F,fa){return(F=F.Gi.getOsfControl(fa))?F.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(ae.a)(rc,"AgaveOnSelectedReadoutHandler",null,[223]);var Lh=
lj.a;vm(pb,Lh);pb.prototype.create=function(){var F=this,fa=this.$.da;Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(fa,211,212,this.tb),function(Pa){Pa=fa.Aa(224)||new rc(Pa.result,F.$);F.Fb(Pa)},this.ma,3)};pb.ja=function(F){F.da.Ha(225,new pb(F))};Object(ae.a)(pb,"AgaveOnSelectedReadoutHandlerFactory",lj.a,[]);var jh=b(861),dj=b(233);Ta.prototype.t3e=function(F){try{if(F&&F.rawEvent&&F.rawEvent.origin&&this.iframe&&this.iframe.id){var fa=this.ECf(F.rawEvent.origin),Pa=this.ECf(document.domain);
if(Hj.a.Ik().equals(Pa,fa))if(F.rawEvent.source&&F.rawEvent.source.frameElement&&F.rawEvent.source.frameElement.id&&Hj.a.Ik().equals(F.rawEvent.source.frameElement.id,this.iframe.id)){fa=null;try{fa=JSON.parse(F.rawEvent.data)}catch(yb){Re.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",yb.message)}fa?(fa.statusCode!==dj.a.sO||void 0!==fa.error&&fa.error?(Re.ULS.sendTraceTag(23707648,344,50,
"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",fa.statusCode,fa.error),this.onError()):(Re.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(fa.authorizationCode?fa.authorizationCode:fa.signInUrl)),$removeHandler(window,"message",Object(Ri.a)(this,this.t3e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Re.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
Re.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Re.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Re.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Re.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Re.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(yb){Re.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",yb.message)}};Ta.prototype.ECf=function(F){var fa="";try{F&&(fa=-1<F.indexOf("//")?F.split("/")[2]:F.split("/")[0])&&(fa=fa.split(":")[0],fa=fa.split("?")[0])}catch(Pa){Re.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Pa.message)}return fa};Ta.ja=function(F,fa,Pa){new Ta(F,fa,Pa)};Object(ae.a)(Ta,
"ResponseHandler",null,[]);var dk=b(277);eb.prototype.tryAuthenticate=function(F,fa){this.y9a(eb.Glg,function(){F()},fa)};eb.prototype.tryAuthorize=function(F,fa){this.y9a(eb.Pgg,F,fa)};eb.prototype.getSignInUrl=function(F,fa){this.y9a(eb.yee,F,fa)};eb.prototype.signOut=function(F,fa){this.y9a(eb.Lrg,F,fa)};eb.prototype.y9a=function(F,fa,Pa){var yb=new dk.QueryStringBuilder("AuthenticationProxyHandler.aspx");yb.Ei("responseType",F);fg.AFrameworkApplication.Qlb(yb);yb=String.format("{0}{1}&{2}",this.IEa,
yb.toString(),fg.AFrameworkApplication.hj);var Cc=document.createElement("iframe");Cc.setAttribute("id","privateCatalogIframe");Cc.setAttribute("name","privateCatalogIframe");Cc.setAttribute("style","display: none");Hj.a.Ik().equals(F,eb.yee)||Cc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ta.ja(Cc,fa,Pa);Cc.setAttribute("src",yb);document.body.appendChild(Cc)};eb.Pgg="authcode";eb.Glg="identitytoken";eb.yee="signinurl";eb.Lrg="signout";Object(ae.a)(eb,
"AuthenticationProxy",null,[]);rb.getUserId="getUserId";rb.getLastStoreUpdate="laststoreupdate";rb.getEntitlement="getEntitlements";rb.getEToken="getEToken";rb.getManifest="getManifest";rb.getAppState="getAppState";rb.getKilledApps="getRemovedAddins";rb.getAppDetails="getAppDetails";rb.removeApps="removeAddin";rb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";rb.getPrivateCatalogAddIns="getAddIns";rb.getPrivateCatalogManifests="getAppManifests";rb.isStoreDisabled="isStoreDisabled";Object(ae.a)(rb,
"S2SWebRequestActions",null,[]);var mk=b(597);Tc.prototype.getUserId=function(F,fa){var Pa=new Gh.a;Pa.add(new zc.a("corr",F));this.yW(rb.getUserId,Pa,1,fa)};Tc.prototype.getLastStoreUpdate=function(F,fa,Pa){var yb=new Gh.a;yb.add(new zc.a("lc",F));yb.add(new zc.a("corr",fa));this.yW(rb.getLastStoreUpdate,yb,1,Pa)};Tc.prototype.getEntitlement=function(F,fa,Pa,yb){F=new Gh.a;F.add(new zc.a("av",fa));F.add(new zc.a("corr",Pa));this.yW(rb.getEntitlement,F,1,yb)};Tc.prototype.getEToken=function(F,fa,
Pa,yb,Cc,Vc){var rd=new Gh.a;rd.add(new zc.a("cmu",F));rd.add(new zc.a("cmf",fa));rd.add(new zc.a("assetid",Pa));rd.add(new zc.a("expver",yb));rd.add(new zc.a("corr",Cc));this.yW(rb.getEToken,rd,1,Vc)};Tc.prototype.getManifest=function(F,fa,Pa,yb){var Cc=new Gh.a;Cc.add(new zc.a("cmu",F));Cc.add(new zc.a("assetid",fa));Cc.add(new zc.a("corr",Pa));this.yW(rb.getManifest,Cc,1,yb)};Tc.prototype.getAppState=function(F,fa,Pa){var yb=new Gh.a;yb.add(new zc.a("ma",F));yb.add(new zc.a("corr",fa));this.yW(rb.getAppState,
yb,1,Pa)};Tc.prototype.getKilledApps=function(F,fa){var Pa=new Gh.a;Pa.add(new zc.a("corr",F));this.yW(rb.getKilledApps,Pa,1,fa)};Tc.prototype.getAppDetails=function(F,fa,Pa,yb){var Cc=new Gh.a;Cc.add(new zc.a("cmo",F));Cc.add(new zc.a("corr",Pa));this.fbb(rb.getAppDetails,Cc,fa,2,yb,!1)};Tc.prototype.removeApps=function(F,fa,Pa){var yb=new Gh.a;yb.add(new zc.a("corr",fa));this.fbb(rb.removeApps,yb,F,2,Pa,!1)};Tc.prototype.getLastPrivateCatalogUpdate=function(F,fa,Pa,yb,Cc,Vc){var rd=new Gh.a;rd.add(new zc.a("catalog",
"privatecatalog"));rd.add(new zc.a("clientCode",F));rd.add(new zc.a("clientVersion",fa));rd.add(new zc.a("corr",Cc));F=String.format("authorizationCode={0}&refreshToken={1}",Pa?Fa.a.qf(Pa):"",yb?Fa.a.qf(yb):"");this.fbb(rb.getLastPrivateCatalogUpdate,rd,F,2,Vc,!0)};Tc.prototype.getPrivateCatalogAddIns=function(F,fa,Pa,yb,Cc,Vc){var rd=new Gh.a;rd.add(new zc.a("catalog","privatecatalog"));rd.add(new zc.a("clientCode",F));rd.add(new zc.a("clientVersion",fa));rd.add(new zc.a("corr",Cc));F=String.format("authorizationCode={0}&refreshToken={1}",
Pa?Fa.a.qf(Pa):"",yb?Fa.a.qf(yb):"");this.fbb(rb.getPrivateCatalogAddIns,rd,F,2,Vc,!0)};Tc.prototype.getPrivateCatalogManifests=function(F,fa,Pa,yb,Cc){var Vc=new Gh.a;Vc.add(new zc.a("catalog","privatecatalog"));Vc.add(new zc.a("corr",yb));F=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Fa.a.qf(F),fa?Fa.a.qf(fa):"",Pa?Fa.a.qf(Pa):"");this.fbb(rb.getPrivateCatalogManifests,Vc,F,2,Cc,!0)};Tc.prototype.isStoreDisabled=function(F,fa){var Pa=new Gh.a;Pa.add(new zc.a("corr",F));
this.yW(rb.isStoreDisabled,Pa,2,fa)};Tc.prototype.yW=function(F,fa,Pa,yb){this.fbb(F,fa,null,Pa,yb,!1)};Tc.prototype.fbb=function(F,fa,Pa,yb,Cc,Vc){var rd=new dk.QueryStringBuilder("AddinServiceHandler.ashx");rd.Ei("action",F);rd.Ei("app",mk.a[fg.AFrameworkApplication.sa.Pa.Lj]);fa=yl(fa);for(var Hd=fa.next();!Hd.done;Hd=fa.next())Hd=Hd.value,rd.Ei(Hd.key,Hd.value);rd=String.format("{0}{1}&{2}",fg.AFrameworkApplication.sa.Pa.g_,rd.toString(),fg.AFrameworkApplication.hj);fg.AFrameworkApplication.Hd.Ul(rd,
yb,Pa,null,!1,2,function(te){var hf=null;te&&te.data&&(te.data.responseHeaders["X-BlockedForMinor"]&&"1"===te.data.responseHeaders["X-BlockedForMinor"].toString()&&(te.data.httpStatus=451),hf=te.data.fe);Cc(te.data.httpStatus,hf)},function(te){var hf=null;Vc&&te&&te.data&&te.data.fe&&(hf=te.data.fe);Cc(te.data.httpStatus,hf);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){hf={message:"AddinServiceHandler request failed"};hf.code=
te.data.httpStatus;hf.action=F;if(te.data.request||te.data.request.get_headers())hf["X-UserSessionId"]=te.data.request.get_headers()["X-UserSessionId"];408===te.data.httpStatus||503===te.data.httpStatus?Re.ULS.sendTraceTag(538784582,220,10,JSON.stringify(hf)):Re.ULS.sendTraceTag(18392345,220,50,JSON.stringify(hf))}else Re.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",te.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+F)};Object(ae.a)(Tc,"S2SWebRequestManager",
null,[]);var Oj=lj.a;vm(vd,Oj);vd.prototype.create=function(){var F=this;Re.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");fg.AFrameworkApplication.disableWholeAppsForOfficeFeature?Re.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",fg.AFrameworkApplication.disableWholeAppsForOfficeFeature):ig.EwaSettings.la(417)?dh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(fa){fa.isFeatureEnabled("mso_officeStore",
!0).then(function(Pa){jh.DdaFacade.T0c=Pa;F.hBe();return null})}):this.hBe()};vd.prototype.hBe=function(){var F=this,fa=Zi.GetServiceTaskFactory.Xa(this.$.da,224,225,this.tb),Pa=Ke.a.Erd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.ma,this.tb,106),yb=fb(this.ma,this.tb);Vg.TaskExtensions.Ba(Vg.TaskExtensions.ve([fa,Pa,yb],this.$.ma),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Re.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
wh.a.U2()):F.j3h();Re.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");F.OIf=fa.result;F.Fb(F.Ve);Re.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)};vd.prototype.j3h=function(){ig.EwaSettings.la(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Tc);this.$.ig.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Tc,new eb(fg.AFrameworkApplication.ga.appSettings.WebServiceBase),ig.EwaSettings.la(71),
ig.EwaSettings.la(448))};vd.prototype.dispose=function(){Ii.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;Oj.prototype.dispose.call(this)};vd.ja=function(F){new vd(F)};tl.Object.defineProperties(vd.prototype,{Ve:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new jh.DdaFacade(this.$,this.OIf))}}});Object(ae.a)(vd,"DdaFacadeServiceFactory",lj.a,[]);Pc.prototype.fd=function(){return!1};Pc.prototype.Xc=function(){return!1};Pc.prototype.Gc=function(F,fa,Pa,yb){var Cc=
!1;switch(fa.command){case -684355545:Cc=!0;break;case -741808261:Cc=!!Pa;break;case -859308420:Cc=!!yb&&1===yb.eA;break;case 418618014:Cc=1===F&&!!yb&&1===yb.eA;break;case -515602470:fa=ig.EwaSettings.la(235)&&2===F;Cc=(1===F||fa)&&!!yb&&1===yb.eA;break;case 2086613372:Cc=ig.EwaSettings.la(235)&&2===F&&!!yb&&1===yb.eA;break;case -1336341324:Cc=ig.EwaSettings.la(500)&&1===F&&!!yb&&1===yb.eA;break;case -1444574190:case -336193495:Cc=1===F&&!!yb&&1===yb.eA;break;case 1296389134:Cc=1===F&&!!yb&&1===
yb.eA;break;case 1221897806:Cc=ig.EwaSettings.la(166)&&2===F;break;case -1753056834:Cc=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Cc=!0;break;case 301511274:Cc=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Cc=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Cc=this.$.isEditMode&&this.$.fa.bJb}return Cc};
Pc.prototype.executeCommand=function(F,fa,Pa){var yb=Vg.TaskExtensions.om(),Cc=fa.command;switch(fa.command){case 1296389134:this.agaveCommandManager.dxj(Pa.SourceControlId,Pa.LabelText);break;case -684355545:this.agaveCommandManager.dYc();break;case -741808261:yb=this.agaveCommandManager.insertAgave(Pa,fa);break;case -1336341324:ig.EwaSettings.la(500)&&(yb=this.agaveCommandManager.P2e(Pa,F,fa));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:yb=
this.agaveCommandManager.P2e(Pa,F,fa);break;default:yb=hk.a(Cc)}return yb};Object(ae.a)(Pc,"AgaveCommandHandler",null,[147]);Object(ae.a)(Zc,"Selection",null,[]);Object(ae.a)(Ic,"SmartLookupApplicationInterface",null,[]);Object(ae.a)(Eb,"ApplicationProperties",null,[]);Object(ae.a)(Mb,"EnterpriseUserInfo",null,[]);Object(ae.a)(wb,"FeatureGates",null,[]);Ja.prototype.FRh=function(){var F=void 0===F?!0:F;var fa=this.nDe();if(fa<this.Wsd+this.UCj)return fa>this.Wsd+this.XCj&&this.jbd(),this.dkf;F&&this.jbd();
return""};Ja.prototype.jbd=function(){var F=this;this.Zsd=this.Zsd||new Promise(function(fa){F.GRh().then(function(Pa){F.dkf=Pa;F.Wsd=F.nDe();F.Zsd=null;fa(Pa)})})};Ja.prototype.GRh=function(){var F=this;return this.k7a&&this.k7a.length?new Promise(function(fa){F.cxa.XR("SmartLookup",F.k7a).then(function(Pa){Pa.IsSuccess?Pa.Token||(fa(""),Re.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Re.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Pa.ErrorCode+": "+Pa.ErrorMessage),fa(""));fa(Pa.Token)}).catch(function(Pa){Pa=Bh.c(Pa);Re.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Pa);fa("")})}):(Re.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(ae.a)(Ja,"SmartLookupAuthenticationManager",null,[265]);Lb.cIh=function(){switch(Object(Wi.a)(String,fg.AFrameworkApplication.Gb.AudienceGroup)||""){case "Dogfood":if(fg.AFrameworkApplication.ga){var F=
fg.AFrameworkApplication.ga.Ua("UserPrincipalName");F=Fa.a.Kl(F);var fa=fg.AFrameworkApplication.ga.Dy("SmartLookupINTEnabledForSKITeam")?fg.AFrameworkApplication.ga.Tv("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(fa,F)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Lb.fRh=function(){switch(fg.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":fg.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":fg.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?
"INT":Lb.cIh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(ae.a)(Lb,"Utils",null,[]);var nk=b(77),Ak=b(579);Ra.prototype.TCh=function(){return Promise.resolve(this.UCh())};Ra.prototype.UCh=function(){var F=new Eb;F.anid="";F.applicationVersion=fg.AFrameworkApplication.buildVersion;
F.appCorrelationId=bj.a.create().toString();F.themePlatform=Ra.JOj;F.lcid=fg.AFrameworkApplication.lcid;F.launchUtcTime=(new Date).toUTCString();F.featureGates=this.j7a;var fa=Ak.a.DJ(fg.AFrameworkApplication.lcid);fa=fa?fa.name:null;F.market=this.e$b(fa);F.uiLanguage=fa;F.sessionId=fg.AFrameworkApplication.userSessionId;F.themeId=0;F.parentalControl=Ra.ePi;var Pa=new Mb;Pa.CountryCode=this.e$b(fa);Pa.ServiceEndpoint=this.k7a;Pa.IsGoLocal=!1;Pa.IsEnabled=this.Ikf;Pa.IsEnterpriseEnabled=this.Ikf;Pa.TenantRoot=
this.Jpi;F.enterpriseUserInfo=Pa;F.accessToken=this.Epi.FRh();return F};Ra.prototype.e$b=function(F){F=F.split("-");return F[F.length-1]};tl.Object.defineProperties(Ra.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.dpi}}});Ra.JOj="web";Ra.ePi="yes";Object(ae.a)(Ra,"SmartLookupManager",null,[253]);var sk=Gj.a;vm(Sa,sk);Sa.prototype.fd=function(){return!1};Sa.prototype.Xc=function(){return!1};Sa.prototype.Gc=function(F,fa){F=ig.EwaSettings.la(134);return-983891024===
fa.command&&F};Sa.prototype.executeCommand=function(F,fa){F=Vg.TaskExtensions.om();-983891024===fa.command&&this.vji();return F};Sa.prototype.vji=function(){var F=this,fa=new Ra(null),Pa={},yb=Rh.g(this.$).sc(null).originalText;yb=Object.assign(new Zc,{neighborhood:yb,mentionStart:0,mentionLength:yb?yb.length:0});var Cc=Object.assign(new Ic,{selection:yb,entryPoint:0});fa.TCh().then(function(rd){rd.applicationName=Sa.appName;rd.isFirstLaunch=F.isFirstLaunch;rd.themeId=5;Pa[Sa.smartLookupApplicationInterface]=
JSON.stringify(Cc);Pa[Sa.iFg]=JSON.stringify(rd);F.isFirstLaunch=!1});fa=new ui.a("ExcelOnline","Web","en-Us");yb=new zi.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Vc=new mj.a;Vc.ni[fe.al]=De.a.instance.ea(1753);Vc.ni[fe.taskPaneWidth]=350;Vc.ni[fe.sourceLocationOverrideResourceId]="WAC.PROD.URL";Vc.Sq=Pa;xi.a.instance.CMa(yb,"Taskpane","SmartLookupSDXTaskpane",fa,Vc)};Sa.iFg="AppProperties";Sa.appName="Excel";Sa.smartLookupApplicationInterface="SmartLookupApplicationInterface";
Object(ae.a)(Sa,"SmartLookupCommandHandler",Gj.a,[147]);var Pi=Ad.a;vm(Da,Pi);Da.prototype.Md=function(){var F=this;Wj.a(this.$,374,375,this.tb,function(fa){F.Ed([new Pc(F.$,null,null,null,null,fa),new Sa(F.$)])})};Da.ja=function(F){Ad.a.de(76,new Da(F))};Object(ae.a)(Da,"AgaveCommandHandlerFactory",Ad.a,[]);Object(ae.a)(function(){},"AppInfoDetail",null,[]);b(1080);Object(ae.a)(function(){},"AppsForOfficeUtils",null,[]);Object(ae.a)(Tb,"AppsDataManager",null,[37]);var Vi=b(1294),ki=b(108);sb.prototype.initialize=
function(F){sb.initialized||(this.Ve=F,this.Mg(),sb.initialized=!0)};sb.prototype.Mg=function(){fg.AFrameworkApplication.Eb.jf(Eh.a.e$a,ki.a.frame,this.e$a,96);fg.AFrameworkApplication.Eb.$b(Eh.a.$_i,ki.a.frame,this.f1i)};tl.Object.defineProperties(sb,{instance:{configurable:!0,enumerable:!0,get:function(){sb.Na||(sb.Na=new sb);return sb.Na}}});sb.Na=null;sb.initialized=!1;Object(ae.a)(sb,"AgaveCommandActor",null,[]);var Ai=b(110),pj=b(353),Pj=b(350),jk=b(1264),ok=b(340);Object(ae.a)(sa,"FirstPartyAddinTaskpaneOverrides",
null,[]);Object(ae.a)(va,"IdeasSelectionContext",null,[]);vm(wa,va);Object(ae.a)(wa,"IdeasTableSelectionContext",va,[]);var Yj=b(59),Tk=b(153),dl=b(587),il=b(127),cl=b(140),Bk=b(172),Rk=cl.a;vm(Fb,Rk);Fb.prototype.KC=function(){Rk.prototype.KC.call(this);this.fp.style.width=this.y_d;this.fp.style.height=this.fUa;this.fp.style.marginTop=this.DPb;this.fp.style.padding=this.gUa};Fb.prototype.bPa=function(){this.fp.style.width=this.y_d;this.fp.style.height=this.fUa;this.fp.style.marginTop=this.DPb;this.fp.style.padding=
this.gUa;this.xCa>Bk.a.k9a?(this.Lb.style.width=String.format("{0}px",Bk.a.k9a),this.Lb.style.overflowX="scroll",fg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0"):(this.Lb.style.width=String.format("{0}px",this.xCa),this.Lb.style.overflowX="hidden");this.Lb.offsetHeight>Bk.a.j9a||this.ojg+50>Bk.a.j9a?(this.Lb.style.height=String.format("{0}px",Bk.a.j9a),this.Lb.style.overflowY="scroll",this.Lb.style.top="0",fg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left=
"0",this.SFc||(this.Lb.style.marginTop="-48px"),this.fp.style.minHeight=String.format("{0}px",this.dhg)):(this.Lb.style.overflowY="hidden",this.Lb.style.top="10%",this.Lb.style.height=this.Igb);this.zZa()};Fb.prototype.zZa=function(){if(this.Lb){var F=this.Lb.style.zIndex;this.Lb.style.zIndex="-9999";if(this.xCa>Bk.a.k9a)fg.AFrameworkApplication.isRtl?this.Lb.style.marginRight="0":this.Lb.style.marginLeft="0";else{var fa=String.format("{0}px",Math.floor(-this.Lb.offsetWidth/2));fg.AFrameworkApplication.isRtl?
this.Lb.style.marginRight=fa:this.Lb.style.marginLeft=fa;fg.AFrameworkApplication.isRtl?this.Lb.style.right="50%":this.Lb.style.left="50%"}this.Lb.style.zIndex=String(F)}else Re.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Fb.prototype.WN=function(){Rk.prototype.WN.call(this);var F=document.getElementById(this.mi(this.njg));F.style.width=String.format("{0}px",this.xCa);F.style.height=this.Igb};tl.Object.defineProperties(Fb.prototype,{k0a:{configurable:!0,enumerable:!0,
get:function(){return this.fp}}});Object(ae.a)(Fb,"AppsForOfficeInsertionDialog",cl.a,[340]);var pk=b(1100),$k=Gj.a;vm(Sb,$k);Sb.prototype.HAg=function(F){this.addHandler(Sb.Vzd,F)};Sb.prototype.R4i=function(F){this.removeHandler(Sb.Vzd,F)};Sb.prototype.dispose=function(){Ii.a.Fa(this.Fva);this.Fva=null;$k.prototype.dispose.call(this)};Sb.prototype.dYc=function(){this.Fva.hide()};Sb.prototype.dxj=function(F,fa){if(F){this.raiseEvent(Sb.Vzd);var Pa=F.split("|");this.qni(F,fa,Pa);this.Fva=new Fb;this.Fva.initializeAndShow("",
null,null);this.Ve.Nji(this.Fva.k0a,Pa)}};Sb.prototype.P2e=function(F,fa,Pa){var yb=Vg.TaskExtensions.om();if(-515602470===Pa.command||-336193495===Pa.command||2086613372===Pa.command||-1444574190===Pa.command||-1336341324===Pa.command)yb=this.qXh(F,fa,Pa);418618014===Pa.command&&(fa=new Fj.a,fa.al=De.a.instance.ea(1764),yb=this.i0(Pa,Sb.z_h,fa,!0));if((Pa.tabName===this.$.Ib+Ni.a.jQf||Pa.tabName===Ni.a.cW)&&2===Pa.df||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
F[Se.a.hd])||F[Se.a.hd]===Ni.a.WU)return this.a3e(F,Pa);if(7===Pa.df&&F.SourceControlId===this.$.Ib+Ni.a.hbc)return F.MenuItemId=Ni.a.uEd,this.a3e(F,Pa);1221897806===Pa.command&&(yb=this.Erj(Pa));-1753056834===Pa.command&&(yb=this.Msj(Pa));932597253===Pa.command&&(Re.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),ci.c(932597253,!0),fa=new Fj.a,fa.al=De.a.instance.ea(2092),fa.sourceLocationOverrideResourceId=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?Sb.FSi:Sb.GSi,fa.focusOnIframeWhenLoaded=!0,fa.taskPaneWidth=Sb.E6e,yb={},yb.LaunchSource=Object(Wi.a)(String,F.SourceControlId),yb.LaunchMode="Default",fa.DH=yb,yb=this.i0(Pa,Sb.ESi,fa,!0));301511274===Pa.command&&(yb=this.Wsj(Pa));515196233===Pa.command&&((fa=this.$.da.Aa(465))&&fa.n5e(),fa=new Fj.a,fa.al=De.a.instance.ea(2161),yb={},yb.SourceUILocation=pj.a[Pa.df],fa.DH=yb,yb=new Ce,yb.waa=Yc.a.tIa,yb=this.i0(Pa,Sb.RNi,fa,!0,yb,void 0,fa.al));1723441034===Pa.command&&(fa=new Fj.a,fa.al=De.a.instance.ea(2173),
fa.focusOnIframeWhenLoaded=!0,fa.taskPaneWidth=Sb.zVi,yb=new Ce,yb.waa=Yc.a.Gkh,yb=this.i0(Pa,Sb.yVi,fa,!0,yb));ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&F.LoadDataFromPictureTaskpane&&(fa={},yb=new Fj.a,yb.al="Data From Picture",yb.sourceLocationOverrideResourceId=F.DataFromPictureURL?F.DataFromPictureURL:"",fa.SessionID=F.SessionID,yb.DH=fa,yb.focusOnIframeWhenLoaded=!0,yb=this.i0(Pa,F.DataFromPictureAssetId,yb));return yb};Sb.prototype.insertAgave=
function(F,fa){var Pa=this,yb=Vg.TaskExtensions.om(),Cc=this.$,Vc=F[Gg.a.OXa];if("SourceControlId"in F){var rd={};var Hd=F.SourceControlId.split("|");if(8!==Hd.length||!(Hd[0]&&Hd[1]&&Hd[2]&&!isNaN(parseInt(Hd[2]))&&Hd[3]&&!isNaN(parseInt(Hd[3]))&&Hd[4]&&Hd[5]&&!isNaN(parseInt(Hd[5]))&&Hd[6]&&Hd[7]))return Vg.TaskExtensions.f4();Vc={};Vc.version=rd.Version=Hd[0];Vc.assetId=rd.AssetId=Hd[1];Vc.solutionId=rd.SolutionId=Hd[1];Vc.height=rd.Height=parseInt(Hd[2]);Vc.width=rd.Width=parseInt(Hd[3]);Vc.storeId=
rd.StoreId=Hd[4];Vc.targetType=rd.TargetType=parseInt(Hd[5]);Vc.assetStoreId=rd.AssetStoreId=Hd[6];Vc.storeType=rd.StoreType=Hd[7];Vc.appVersion=Hd[0];Vc.currentStoreType=Hd[7];Vc.id=Hd[1]}else rd=F[Se.a.Kg];Hd=null;Ce.key in F&&(Hd=F[Ce.key]);this.Fva&&this.Fva.hide();if(!rd||!Vc)return Re.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),yb;this.$.T4&&Ni.a.Ana in F&&(rd.EnabledInViewMode=F[Ni.a.Ana]);F=this.rFh(fa.command);if(!rd.EnabledInViewMode&&!Cc.xs(null,
!1,F))return yb;var te=void 0===rd.IsToBePersisted||null===rd.IsToBePersisted||rd.IsToBePersisted?0:16;if(1===rd.TargetType)yb=this.y6h(rd,Vc,fa,Hd,te);else{Vc=Rh.g(Cc);yb=this.viewBlockContainerHelpers.ueb(Vc);var hf=Cc.fa.isNamedObjectViewMode?Cc.oa.sheetName:Cc.oa.name;if(yb){Vc=yb.hf;var ff=Vc.Wf.top;var lg=Vc.Wf.left;var Og=yb.rI.x;var lh=yb.rI.y}else ff=lg=1,yb=this.viewBlockContainerHelpers.$Ja(Vc),Og=yb.x,lh=yb.y;var Ih=this.$.qa.ta.Xb();yb=function(Ah,Uh,ii){var ij=Cc.qa.ta,Ji=rd,tk=ff,Tj=
lg,kk=Og,Uj=lh;Ah=oi.b(Ah,Pa.vSi);var ik=ij.Oa(9,Ih);ik.sharedInfo=Ji;ik.sheetName=hf;ik.positionRow=tk;ik.positionCol=Tj;ik.positionOffsetX=kk;ik.positionOffsetY=Uj;return Oi.i(ij,"InsertWebExtension",ik,Ah,Uh,ii,null,0)};ig.EwaSettings.tc()?(te|=64,yb=xk.a(this.$.userOperationManager,yb,function(Ah){return new rk.a(534,0,Ah,te)},fa)):yb=xk.a(this.$.userOperationManager,yb,function(Ah){return new Bj.a(534,0,Ah,te)},fa)}return yb};Sb.prototype.VXg=function(){var F=dh.a.instance.mc("Common.App.ICustomerFeedbackUiWrapper"),
fa=dh.a.instance.mc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.q9c?this.q9c.kib?this.lue():fa.instance.B5c(this.pth):Re.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");fa={};fg.AFrameworkApplication.ga.nje(fa);F=F.instance.getContext(fa);fa={};"telemetryGroup"in F&&(fa=F.telemetryGroup);fa.processSessionId=F.sessionId;fa.officeBuild=F.build;F.telemetryGroup=fa;F.feedbackType=-1;F.userVoiceEnabled=!1;"disableIncludeScreenshot"in F||(F.disableIncludeScreenshot=
!1);"screenshot"in F||(F.screenshot=!1);F.disableScreenshotPreview=!1;F.includeScreenshotSelectedDefault=!0;return F};Sb.prototype.TSi=function(F){if(!this.L9a&&ig.EwaSettings.la(737)&&ig.EwaSettings.getBooleanFeatureGate(Sb.q1h,!1)){var fa=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";fa=this.Sre(fa);var Pa=new Ce;Pa.Vj=Yc.a.m8c;this.L9a=this.bKd(fa,null,!1,null,Pa);fa={};il.b(this.$).ae(Vh.a.USi,(fa.Location=
pj.a[F.df],fa.InputMethod=Pj.a[F.method],fa),void 0,!0)}};Sb.prototype.kVf=function(F){var fa=this.$.fa.jh.get(17);dh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Pa){Pa.isFeatureEnabled("mso_sendASmile",fa).then(function(yb){F.FeedbackEnabled=fa&&yb;return null})})};Sb.prototype.Erj=function(F){var fa=Rh.g(this.$),Pa=new Fj.a,yb={ActiveTab:"Format"};yb.DatapaneFlighting=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);yb.RangePickerFlighting=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);yb.AceFlighting=!0;yb.ChartNewSDXRecording=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);yb.ThemeColorsFlighting=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");yb.UOMirror=ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);this.kVf(yb);yb.startTimeMs=Date.now();yb.UserSessionId=this.$.ya.UserSessionId;(fa=fa.ha.Qa.Up)&&(yb.SubSelection=fa);Re.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",yb.UserSessionId,void 0===F.df||null===F.df?"Null":pj.a[F.df],fa||"ChartRoot");Pa.DH=yb;Pa.al=De.a.instance.ea(950);yb=new Ce;yb.waa=Yc.a.tIa;return this.i0(F,Sb.PRg,Pa,!0,yb)};Sb.prototype.Msj=function(F){var fa=new Fj.a;fa.DH={};fa.al=De.a.instance.ea(1752);
fa.PR=Sb.yhf;var Pa=new Ce;Pa.waa=Yc.a.tIa;return this.i0(F,Sb.yhf,fa,!0,Pa,void 0,fa.al)};Sb.prototype.Wsj=function(F){var fa=new Fj.a;fa.DH={};fa.al=De.a.instance.ea(2116);var Pa=new Ce;Pa.waa=Yc.a.tIa;return this.i0(F,Sb.Wui,fa,!0,Pa)};Sb.prototype.a3e=function(F,fa){var Pa=Sb.e5e,yb=F[Se.a.hd].toString(),Cc={},Vc=new Fj.a;Vc.al=De.a.instance.ea(9);switch(yb){case "A0":Cc.query=(F[Se.a.Kg]||"").split("|").slice(2,ok.a.gS).join("|");break;case "A1":Cc.query=F.CommandValueId;break;case "Help":Cc.gwdropdownflightinfo=
ig.EwaSettings.la(240);Cc.query="";break;case Ni.a.uEd:ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Vc.al=De.a.instance.ea(1718),Vc.sourceLocationOverrideResourceId=Sb.F1e,Cc.feedback=this.VXg()):Cc.query=yb;break;case "HelpArticle":Cc.query=F[Se.a.Kg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Cc.query=yb;break;default:return oj.Task.Ta(!0)}Vc.DH=Cc;yb=new Ce;yb.waa=Yc.a.tIa;return this.i0(fa,Pa,Vc,!1,yb,F[Ni.a.Ana]||!1)};
Sb.prototype.Sre=function(F){var fa={Version:"0.0.0.0"};fa.AssetId=Sb.zva;fa.SolutionId=Sb.zva;fa.AssetStoreId="";fa.StoreType=OSF.StoreType.Sdx;fa.Height=0;fa.Width=0;fa.StoreId=OSF.StoreType.Sdx;fa.TargetType=OSF.OsfControlTarget.TaskPane;fa.IsToBePersisted=!1;fa.SourceLocationOverrideResourceId=F;fa.SharedRuntimeId=F;fa.Id=Sb.zva;fa.CurrentStoreType=OSF.StoreType.Sdx;fa.AppVersion="0.0.0.0";return fa};Sb.prototype.qXh=function(F,fa,Pa){var yb=this,Cc=new Fj.a,Vc=new Ce,rd={};this.kVf(rd);rd.LaunchSource=
"";rd.StartTimeMs=Date.now();rd.CorrelationId=bj.a.create().toString();Cc.DH=rd;Cc.focusOnIframeWhenLoaded=!0;Cc.taskPaneWidth=Sb.E6e;Vc.waa=Yc.a.emh;Vc.lyc=Yc.a.dLe;switch(Pa.command){case -1444574190:var Hd,te;rd.LaunchMode="RecommendedPivotTables";rd.SelectionContext="";rd.LaunchSource="PivotTableHandRaise"===Object(Wi.a)(String,F.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&F.SourceSelection){var hf=
F.SourceSelection.split(",")[0];fa=ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var Og=Xj.Z(hf,yb.$.xa);Hd=Og.sheetName;te=Og.cFb;ff=Og.range;return Og}().returnValue&&!Rh.g(this.$).Vb.R4(ff))F=this.$.xa.getItemByName(Hd),rd.SelectionContext=JSON.stringify(Object.assign(new va,{address:te,addressWithSheet:Hd+"!"+ff.qE(!1),sheetId:Yj.d(F),sheetName:Hd,isSheetEmpty:!1,columnCount:ff.width,rowCount:ff.height,columnIndex:ff.left+fa,rowIndex:ff.top+
fa,selectionType:"Continuous"}));else if((F=this.$.xb.getItemByName(Object(Wi.a)(String,F.SourceSelection)))&&Yj.o(F)){var ff=Tk.a(F,!0);var lg=this.$.xa.getItemByName(F.sheetName);rd.SelectionContext=JSON.stringify(Object.assign(new wa,{tableName:F.name,hasTableHeaders:Tk.d(F),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:ff.qE(!1),addressWithSheet:lg.name+"!"+ff.qE(!1),sheetId:Yj.d(lg),sheetName:lg.name,isSheetEmpty:!1,columnCount:ff.width,rowCount:ff.height,columnIndex:ff.left+fa,
rowIndex:ff.top+fa,selectionType:"Continuous"}))}}ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Cc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Cc.al=De.a.instance.ea(1762);ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.PR=Sb.XQi);Cc.Vj=Yc.a.vNe;Vc.Vj=Yc.a.vNe;break;case -336193495:rd.LaunchMode="RecommendedCharts";ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Cc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Cc.al=De.a.instance.ea(1761);ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.PR=Sb.OZi);Cc.Vj=Yc.a.wNe;Vc.Vj=Yc.a.wNe;break;case -1336341324:if(!ig.EwaSettings.la(500))return oj.Task.Ta(!1);rd.LaunchMode="NL";ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.PR=Sb.xUc);ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Cc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(ig.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Cc.al=De.a.instance.ea(1766);rd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Cc.al=De.a.instance.ea(1767);rd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Cc.al=De.a.instance.ea(1765),rd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!ig.EwaSettings.la(235))return oj.Task.Ta(!1);
rd.LaunchMode="ChartDesigner";rd.LaunchSelectionMode=fa.toString();ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Cc.al=De.a.instance.ea(1768);ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.PR=Sb.xUc);break;default:rd.LaunchMode="Default",ig.EwaSettings.la(235)&&(rd.LaunchSelectionMode=fa.toString()),ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle",Cc.al=De.a.instance.ea(1763),ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.PR=Sb.xUc),Cc.Vj=Yc.a.m8c,Vc.Vj=Yc.a.m8c}return ig.EwaSettings.la(737)?(ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle",
this.L9a?this.L9a.CWR(function(){return yb.qTf(rd,Cc)}):this.I4h(Pa,Cc,Vc,rd)):this.i0(Pa,Sb.zva,Cc,!0,Vc)};Sb.prototype.I4h=function(F,fa,Pa,yb){var Cc=this;this.L9a=this.bKd(this.Sre(fa.sourceLocationOverrideResourceId),fa,!1,F,Pa,!1);return this.L9a.CWR(function(){return Cc.qTf(yb,fa)})};Sb.prototype.qTf=function(F,fa){var Pa=this.Ve.T$(this.Ve.kJa(Sb.zva,fa.sourceLocationOverrideResourceId));if(Pa){this.Gbb[Sb.zva]=F;var yb=this.hud(this.Ve.XY(Pa).OsfPropertyBag,Sb.zva);this.Ve.XY(Pa).OsfPropertyBag=
yb}this.CMa(Sb.zva,"LaunchIdeasAction",F,fa);return oj.Task.Ta(!0)};Sb.prototype.i0=function(F,fa,Pa,yb,Cc,Vc,rd){Pa=void 0===Pa?null:Pa;yb=void 0===yb?!1:yb;Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?!1:Vc;rd=void 0===rd?null:rd;Vg.TaskExtensions.om();Pa||(Pa=new Fj.a);var Hd={Version:"0.0.0.0"};Hd.AssetId=fa;Hd.SolutionId=fa;Hd.AssetStoreId="";Hd.StoreType=yb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Hd.Height=0;Hd.Width=0;Hd.StoreId=yb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Hd.TargetType=OSF.OsfControlTarget.TaskPane;
Hd.IsToBePersisted=!1;Hd.SourceLocationOverrideResourceId=Pa.sourceLocationOverrideResourceId;Hd.AppVersion="0.0.0.0";Hd.Id=fa;Hd.CurrentStoreType=yb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;if(Pa.al||rd)this.k$c[fa]=Object.assign(new sa,{Mxc:Pa.al,uSd:rd,Kxc:Pa.PR});ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Pa.DH||(Pa.DH={}),Pa.DH.ShowFeedback=this.$.isFeedbackEnabled,this.Gbb[fa]=Pa.DH):Pa.DH&&(this.Gbb[fa]=Pa.DH);
fa={};fa[Se.a.Kg]=Hd;rd={};rd.id=Hd.Id;rd.solutionId=Hd.SolutionId;rd.version=Hd.Version;rd.storeType=Hd.StoreType;rd.storeId=Hd.StoreId;rd.assetId=Hd.AssetId;rd.assetStoreId=Hd.AssetStoreId;rd.height=Hd.Height;rd.targetType=Hd.TargetType;rd.width=Hd.Width;rd.isAddinCommands=!yb;rd.appVersion=Hd.AppVersion;rd.currentStoreType=Hd.CurrentStoreType;fa[Gg.a.OXa]=rd;Cc||(Cc=new Ce);Cc.focusOnIframeWhenLoaded=Pa.focusOnIframeWhenLoaded;Cc.width=Pa.taskPaneWidth;fa[Ce.key]=Cc;fa[Ni.a.Ana]=Vc;return this.insertAgave(fa,
F)};Sb.prototype.y6h=function(F,fa,Pa,yb,Cc){function Vc(ff){Re.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(ff.storeType,ff.storeId,ff.solutionId),ff.storeType);var lg={},Og=new Gh.a;Og.add(ff);lg[Gg.a.hFa]=Og;lg[Gg.a.bJ]=3;ff=new ak.a(Eh.a.Fzb,0,Hd.$.ed,0,null);return Hd.$.Ka.Zb(ff,lg)}function rd(ff,lg){var Og=ff.SolutionId;var lh=ff.StoreType;ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(lh)&&
ff.SourceLocationOverrideResourceId&&(Og=Hd.Ve.kJa(Og,ff.SourceLocationOverrideResourceId)):lh!==OSF.StoreType.FirstParty&&lh!==OSF.StoreType.Sdx||!ff.SourceLocationOverrideResourceId||(Og=Hd.Ve.kJa(Og,ff.SourceLocationOverrideResourceId));var Ih=Hd.Ve.jve(Og,null,ff.SharedRuntimeId);if(ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(lh):lh===OSF.StoreType.FirstParty||lh===OSF.StoreType.Sdx)ig.EwaSettings.la(299)&&Ih&&(lh=Hd.Ve.T$(Og))&&
(Og=null,Og=Hd.hud(Hd.Ve.XY(lh).OsfPropertyBag,ff.SolutionId),(lh=Hd.Ve.Gi.getOsfControl(lh))&&lh.setSettings(Og)),ff.SharedRuntimeId&&Ih||Hd.Ve.Gi.refreshOsfControl(ff.SolutionId,ff.SourceLocationOverrideResourceId);if(!Ih){var Ah=Hd.$.qa.ta.Xb(),Uh=519;Ih=function(ii,ij,Ji){var tk=Hd.$.qa.ta;ii=oi.b(ii,Hd.kEf);var Tj=tk.Oa(9,Ah);Tj.sharedInfo=ff;return Oi.i(tk,"InsertAgaveTaskpane",Tj,ii,ij,Ji,yb,0)};void 0===ff.IsToBePersisted||null===ff.IsToBePersisted||ff.IsToBePersisted||(Uh=538,Ih=function(ii,
ij,Ji){Re.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",ff.StoreType,ff.StoreId,Telemetry.PrivacyRules.GetAssetId(ff.StoreType,ff.StoreId,ff.SolutionId));var tk=Hd.$.qa.ta;ii=oi.b(ii,Hd.kEf);var Tj=tk.Oa(9,void 0===Ah?null:Ah);Tj.sharedInfo=ff;return Oi.i(tk,"ShowAgaveTaskpane",Tj,ii,ij,Ji,yb,0)});return ig.EwaSettings.tc()?(Cc|=64,xk.a(Hd.$.userOperationManager,Ih,function(ii){return new rk.a(Uh,0,ii,Cc)},lg)):xk.a(Hd.$.userOperationManager,
Ih,function(ii){return new Bj.a(Uh,0,ii,Cc)},lg)}return Vg.TaskExtensions.f4()}var Hd=this;if(!ig.EwaSettings.la(53)||F.StoreId===OSF.StoreType.FirstParty)return rd(F,Pa,yb);if(fa.isAddinCommands)return Vc(fa);var te=new nj.a,hf={};hf.marketplaceId=F.SolutionId;hf.marketplaceVersion=F.Version;hf.storeType=F.StoreType;hf.storeId=F.StoreId;hf.targetData=F;ig.EwaSettings.la(93)&&(hf.clearCache=!0);this.Ve.Gi.isAddinCommandsAsync(hf,function(ff,lg,Og){te.setResult(lg);ff||(ff=Og.targetData,Re.ULS.sendTraceTag(537170438,
220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(ff.StoreType,ff.StoreId,ff.SolutionId),ff.StoreType))});return Vg.TaskExtensions.ts(te.task,function(ff){return ff.result?Vc(fa):rd(F,Pa,yb)},this.$.ma)};Sb.prototype.hud=function(F,fa){if(!this.Gbb[fa])return F;var Pa={};if(F){F=yl(F);for(var yb=F.next();!yb.done;yb=F.next())yb=yb.value,Pa[yb[0]]=yb[1]}F=this.Gbb[fa];yb=yl(Object.keys(F));for(fa=yb.next();!fa.done;fa=yb.next())fa=fa.value,
fa===Sb.rth&&ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Pa[fa]=Sys.Serialization.JavaScriptSerializer.serialize(F[fa]):Pa[fa]=Sys.Serialization.JavaScriptSerializer.serialize(F[fa].toString());fa=Object.keys(Pa).length;F=Array(fa);yb=0;var Cc=yl(Object.keys(Pa));for(fa=Cc.next();!fa.done;fa=Cc.next())fa=fa.value,F[yb]=[fa,Pa[fa].toString()],yb++;return F};Sb.prototype.qni=function(F,fa,Pa){var yb=this.$.ya.UserSessionId,Cc=this.$.ya.UICultureTag,
Vc=this.$.ya.UICultureTagLcid,rd=this.$.ya.WacHostId,Hd="",te="";5<=Pa.length&&(Hd=Pa[3],te=Pa[4]);this.rni(Hd,te,F,fa,Cc,Vc,yb,rd)};Sb.prototype.rni=function(F,fa,Pa,yb,Cc,Vc,rd,Hd){var te={};te.a=rd;te.b=Pa;te.c=yb;te.d=F;te.e=fa;te.f=Cc;te.g=Vc;te.h=Hd;Jj.b().Ne(36,te)};Sb.prototype.lue=function(){if(jk.a.Lpf())Re.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.mEf);return}catch(F){Re.ULS.sendTraceTag(537170432,1302,
15,"Failed to use createScreenshot "+(F?F.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.mEf)}catch(F){Re.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(F?F.toString():null))}}};Sb.prototype.bKd=function(F,fa,Pa,yb,Cc,Vc){fa=void 0===fa?null:fa;Pa=void 0===Pa?!1:Pa;yb=void 0===yb?null:yb;Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?!0:Vc;var rd=F.SolutionId,Hd=oj.Task.Ta(!1);F&&rd&&F.SharedRuntimeId&&(yb=yb||new ak.a(-859308420,0,2,0,""),rd={},rd.id=
F.Id,rd.solutionId=F.SolutionId,rd.version=F.Version,rd.storeType=F.StoreType,rd.storeId=F.StoreId,rd.assetId=F.AssetId,rd.assetStoreId=F.AssetStoreId,rd.height=F.Height,rd.targetType=F.TargetType,rd.width=0,rd.isAddinCommands=!1,rd.sharedRuntimeId=F.SharedRuntimeId,F.Preload=Vc,rd.appVersion=F.AppVersion,rd.currentStoreType=F.CurrentStoreType,Cc=Cc?Cc:new Ce,Cc.width=0,fa&&(Cc.focusOnIframeWhenLoaded=fa.focusOnIframeWhenLoaded,Vc=new sa,fa.al&&(Vc.Mxc=fa.al),0<fa.taskPaneWidth&&(Vc.nr=fa.taskPaneWidth),
fa.PR&&ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Vc.Kxc=fa.PR),this.k$c[F.SolutionId]=Vc),fa={},fa[Se.a.Kg]=F,fa[Gg.a.OXa]=rd,fa[Ce.key]=Cc,fa[Ni.a.Ana]=Pa,Hd=this.insertAgave(fa,yb));return Hd};Sb.prototype.CMa=function(F,fa,Pa,yb){yb=void 0===yb?null:yb;if(F&&fa){F=new zi.a(F,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Cc=new ui.a("ExcelOnline","Web",this.$.ya.UICultureTag),Vc=new mj.a;Vc.ni[fe.wRc]=Pa;yb&&(Pa=yb,Pa.sourceLocationOverrideResourceId&&(Vc.ni[fe.sourceLocationOverrideResourceId]=
Pa.sourceLocationOverrideResourceId),Pa.al&&(Vc.ni[fe.al]=Pa.al),Pa.Vj&&(Vc.ni.IconCssClass=Pa.Vj),Pa.pSd&&(Vc.ni.TaskPaneIconUrl=Pa.pSd),Pa.PR&&(Vc.ni.TaskPaneIconId=Pa.PR));xi.a.instance.CMa(F,sj.a.action,fa,Cc,Vc)}};Sb.prototype.KNh=function(F){if(!Ai.a.yj(F)){var fa=F[pk.a.r7b];if(fa&&(fa=fa.getId(),F=F[pk.a.iya],fa&&F))return this.kJa(fa,F.ni[fe.sourceLocationOverrideResourceId])}return null};Sb.prototype.kJa=function(F,fa){fa=void 0===fa?null:fa;return F&&fa?String.format("{0}.{1}",F,fa):F};
Sb.prototype.rFh=function(F){switch(F){case 1221897806:return 2;case -515602470:case 2086613372:return ig.EwaSettings.la(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Sb.q1h="Microsoft.Office.Excel.IdeasXLOPreload";Sb.Vzd="IDS";Sb.e5e="FA000000012";Sb.zva="FA000000005";Sb.z_h="HelloWorld";Sb.PRg="FA000000014";Sb.F1e="Help.GiveFeedback.Url";Sb.rth="feedback";Sb.yhf="FA000000066";Sb.GSi="PowerBi.Url";Sb.FSi="PowerBi.DevUrl";Sb.ESi=
"FA000000054";Sb.Wui="FA000000064";Sb.RNi="FA000000075";Sb.yVi="FA000000080";Sb.xUc="AnalyzeDataTaskPane";Sb.OZi="RecommendedChartsTaskPane";Sb.XQi="PivotTableTaskPane";Sb.V8g=350;Sb.E6e=320;Sb.zVi=320;Object(ae.a)(Sb,"AgaveCommandManager",Gj.a,[315,316]);tl.Object.defineProperties(Gb,{instance:{configurable:!0,enumerable:!0,get:function(){return Gb.Na}}});Gb.Na=new Gb;Object(ae.a)(Gb,"AppsDataManagerFactory",null,[]);Object(ae.a)(function(F,fa){this.httpStatus=F;this.data=fa},"AppData",null,[]);
hb.prototype.Wwb=function(F){this.ugg(this.wgg,F)};hb.prototype.yW=function(F,fa,Pa,yb){F?(fa={},Re.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(fa.dataType=F,fa))):this.ub&&this.Og&&fa?this.Og.Ul(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",this.ub.appSettings.WebServiceBase,fg.AFrameworkApplication.lcid,fa),1,"",null,!0,2,Pa,yb,null):Re.ULS.sendTraceTag(6070476,344,10,"The request objects are not available")};
Object(ae.a)(hb,"AppsDataProvider",null,[314]);var el=lj.a;vm(za,el);za.prototype.create=function(){var F=this,fa=this.$.da,Pa=Zi.GetServiceTaskFactory.create(fa,106,this.ma,this.tb),yb=Zi.GetServiceTaskFactory.create(fa,104,this.ma,this.tb),Cc=Ke.a.loadScript(36,0,this.tb,void 0,void 0,375);Vg.TaskExtensions.Ba(Vg.TaskExtensions.ve([yb,Pa,Cc],this.ma),function(){var Vc=new oc(of.a.instance),rd=new hb(fg.AFrameworkApplication.ga,fg.AFrameworkApplication.Hd,"WAC_Excel");new Tb(Vc,rd,"PreinstalledAppsData_Excel");
Vc=null;ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Vc=dh.a.instance.mc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);sb.instance.initialize(Pa.result);Vc=new Sb(F.$,Pa.result,yb.result,Vc,fg.AFrameworkApplication.Eb);fa.Ha(206,Vc);F.Fb(fa.Aa(374)||fa.Ha(374,Vc))},this.ma,3);dh.a.instance.register(Vi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").zc().Ic(function(){return new Vi.a(F.$.Ey)})};za.ja=function(F){F.da.Ha(375,
new za(F))};Object(ae.a)(za,"AgaveCommandManagerFactory",lj.a,[]);var Xi=b(859);da.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};da.prototype.invokePropertyGet=function(F){switch(F){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};da.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
da.prototype.invokePropertySet=function(F,fa){switch(F){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};da.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};da.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};da.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};da.R1g=function(F){var fa=new da;fa.displayName=F.displayName;fa.email=F.email;switch(F.authority){case yg.qBf:fa.identityType=
1;break;default:fa.identityType=0}fa.federationProvider="";return fa};tl.Object.defineProperties(da.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.Iea},set:function(F){this.Iea=F}},email:{configurable:!0,enumerable:!0,get:function(){return this.U2d},set:function(F){this.U2d=F}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.D3d},set:function(F){this.D3d=F}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Mhb},set:function(F){this.Mhb=
F}}});Object(ae.a)(da,"OfficeIdentityInfo",null,[]);Zb.t$b=function(F){return F in Zb.uJe?Zb.uJe[F].toString():F};tl.Object.defineProperties(Zb,{uJe:{configurable:!0,enumerable:!0,get:function(){return Zb.Kjg}}});Zb.map=null;var wj={};Zb.Kjg=(wj.GeneralException=Xi.a.generalException,wj.AccessDenied=Xi.a.sRc,wj.ApiNotAvailable=Xi.a.apiNotAvailable,wj.UserNotSignedIn=Xi.a.userNotSignedIn,wj.UserAborted=Xi.a.userAborted,wj.UnsupportedUserIdentity=Xi.a.VHj,wj.InvalidResourceUrl=Xi.a.invalidResourceUrl,
wj.InvalidGrant=Xi.a.invalidGrant,wj.AddinIsAlreadyRequestingToken=Xi.a.hDg,wj.ResourceNotAllowed=Xi.a.x$i,wj.ClientError=Xi.a.clientError,wj.ServerError=Xi.a.serverError,wj);Object(ae.a)(Zb,"SingleSignOnErrorCodeMap",null,[]);Wb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};Wb.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};Wb.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Wb.prototype.invokePropertySet=function(F,fa){switch(F){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Wb.prototype.invokePropertySetAsync=
function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Wb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Wb.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(Wb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.ifb},set:function(F){this.ifb=
F}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Mhb},set:function(F){this.Mhb=F}}});Object(ae.a)(Wb,"SingleSignOnToken",null,[]);Ya.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};Ya.prototype.invokePropertyGet=function(F){switch(F){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};Ya.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Ya.prototype.invokePropertySet=function(F,fa){switch(F){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Ya.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
Ya.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Ya.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(Ya.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.f_d},set:function(F){this.f_d=F}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.nD},set:function(F){this.nD=F}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.eUb},set:function(F){this.eUb=F}},scope:{configurable:!0,enumerable:!0,get:function(){return this.nde},set:function(F){this.nde=F}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Aee},set:function(F){this.Aee=F}}});Object(ae.a)(Ya,"TokenParameters",null,[350]);zb.prototype.getAccessToken=function(F){var fa=this,Pa=this.kgb.getOsfControl(this.Rz),
yb=Pa.getManifest(),Cc=yb.getMarketplaceID();this.VMa(F,Cc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Vc,rd){Pa.isFirstParty()&&fa.kgb._enableFirstPartySSO?fa.T8h(yb,F)?dh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(F,Cc).then(function(Hd){Vc(Hd)},function(Hd){rd(Hd)}):rd(Xi.a.sRc):rd(Xi.a.apiNotAvailable)}).then(function(Vc){switch(Vc.authority){case yg.qBf:var rd=1;break;default:rd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Wb(Vc.accessToken,
rd))},function(Vc){fa.logErrorResponse(F,Cc,Vc);return Vc?OfficeExtension.WacRuntime.Utility.createPromise(function(rd,Hd){Hd(OfficeExtension.WacRuntime.Utility.createRichApiException(Vc,Zb.t$b(Vc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(rd,Hd){Hd(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Zb.t$b(Xi.a.generalException)))})})};zb.prototype.getAuthContext=function(){return null};zb.prototype.getPrimaryIdentityInfo=function(){var F=this.kgb.getOsfControl(this.Rz);
F.getManifest();var fa=F.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,yb){dh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(fa).then(function(Cc){Pa(Cc)},function(Cc){yb(Cc.toString())})}).then(function(Pa){Pa=da.R1g(Pa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Pa)},function(Pa){return Pa?OfficeExtension.WacRuntime.Utility.createPromise(function(yb,Cc){Cc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pa,
Zb.t$b(Pa)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(yb,Cc){Cc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Zb.t$b(Xi.a.generalException)))})})};zb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};zb.prototype.invokePropertyGet=function(F){switch(F){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};zb.prototype.invokePropertyGetAsync=function(F){F=
this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};zb.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};zb.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};zb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};zb.prototype.invokeMethodAsync=
function(F,fa){switch(F){case 1:return this.QBh(fa);case 3:return this.gDh();case 2:return this.KOh()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};zb.prototype.QBh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,Ya);return this.getAccessToken(F)};zb.prototype.gDh=function(){return this.getAuthContext()};zb.prototype.KOh=function(){return this.getPrimaryIdentityInfo()};zb.prototype.T8h=function(F,fa){var Pa=!1,yb=F.getWebApplicationAuthorizations();
F=null;yb=yl(yb);for(var Cc=yb.next();!Cc.done;Cc=yb.next())if(Cc=Cc.value,Cc.getResource().toLowerCase()===fa.resource.toLowerCase()){F=Cc;Pa=!0;break}if(!Pa)return!1;fa=fa.scope.split(" ,+");fa=yl(fa);for(Pa=fa.next();!Pa.done;Pa=fa.next())if((Pa=Pa.value)&&Pa.length){yb=!1;Cc=yl(F.getScopes());for(var Vc=Cc.next();!Vc.done;Vc=Cc.next())Pa.toLowerCase()===Vc.value.toLowerCase()&&(yb=!0);if(!yb)return!1}return!0};zb.prototype.VMa=function(F,fa){F=this.Epf(F.resource);var Pa={};Re.ULS.sendTraceTag(538572831,
369,50,"{0}",(Pa.manifestId=fa,Pa.resource=F,Pa))};zb.prototype.logErrorResponse=function(F,fa,Pa){F=this.Epf(F.resource);var yb={};Re.ULS.sendTraceTag(538572830,369,10,"{0}",(yb.manifestId=fa,yb.resource=F,yb.error=Pa,yb))};zb.prototype.Epf=function(F){return F.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};tl.Object.defineProperties(zb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(ae.a)(zb,"AuthenticationService",null,
[]);lb.prototype.create=function(F,fa){return new zb(F,fa)};Object(ae.a)(lb,"AuthenticationServiceFactory",null,[]);var J=b(989),oa=b(1121),Va=b(1083);Ma.generalException="generalException";Ma.invalidArgument="invalidArgument";Ma.notAllowed="notAllowed";Ma.apiNotAvailable="apiNotAvailable";Ma.unresolvedPendingRequest="unresolvedPendingRequest";Ma.timeout="timeout";Ma.adalTimeout="adalTimeout";Ma.userNotSignedIn="userNotSignedIn";Ma.userAborted="userAborted";Ma.silentSignInFailed="silentSignInFailed";
Ma.invalidResourceUrl="invalidResourceUrl";Ma.invalidGrant="invalidGrant";Ma.connectionLost="connectionLost";Ma.clientError="clientError";Ma.serverError="serverError";Object(ae.a)(Ma,"WopiHostErrorCodes",null,[]);Object(ae.a)(Ia,"OAuthCallerMetadata",null,[]);pa.prototype.Gug=function(F,fa,Pa,yb,Cc,Vc){var rd=this;if(!this.cxa)return yb=new oa.a,yb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(yb);var Hd=new Ia;Hd.AddinName=Cc;Hd.AddinTrustId=Vc;var te=-1;Vc=null;
if(yb&&this.fbf())Vc=this.cxa.t7f(Gg.a.ayc,F,yb,pa.CZe(Cc),Hd);else{var hf=Date.now();Vc=this.cxa.XR(Gg.a.ayc,F,Hd).then(function(ff){te=Date.now()-hf;var lg=(fa||Pa)&&"login_required"===ff.ErrorCode;return(fa&&("interaction_required"===ff.ErrorCode||"consent_required"===ff.ErrorCode||"invalid_grant"===ff.ErrorCode)||lg)&&rd.fbf()?rd.cxa.t7f(Gg.a.ayc,F,null,pa.CZe(Cc),Hd):Promise.resolve(ff)})}return Vc.then(function(ff){var lg=new oa.a;ff.IsSuccess?(lg.token=ff.Token,ff.Telemetry&&(lg.mSa=ff.Telemetry.fromCache,
lg.expiresOn=ff.Telemetry.expiresOn)):(lg.errorCode=rd.Eqi(ff),lg.ySd=rd.gPi(ff));return lg}).catch(function(){var ff=new oa.a;ff.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ff)}).then(function(ff){ff.Iga="OauthManager";0<=te&&(ff.Uub=te);return ff})};pa.prototype.bai=function(F){var fa=(fg.AFrameworkApplication.ga.Ua(fg.AFrameworkApplication.Pna)||"").toLowerCase();return(uh.a.qka||"teams"===fa&&Dj.a.awb)&&!pa.G$h(F)||!this.cxa||!this.cxa.gLa()?!1:!0};pa.prototype.fbf=
function(){return this.Bjg||1!==Va.a.w9b()};pa.prototype.Eqi=function(F){switch(F.ErrorCode){case "UserCancelled":case "interaction_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:F=F.ErrorCode===Ma.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:F.ErrorCode===Ma.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:F.ErrorCode===Ma.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:F.ErrorCode===Ma.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:F.ErrorCode===Ma.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return F};pa.prototype.gPi=function(F){var fa="";(F=RegExp("AADSTS(\\d+)").exec(F.ErrorMessage))&&1<F.length&&(fa=F[1]);return fa};pa.CZe=function(F){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,F)};pa.G$h=function(F){if(!F)return!1;F=F.toLowerCase();for(var fa=
yl(J.AppsForOfficeSingleSignOnManager.XQe),Pa=fa.next();!Pa.done;Pa=fa.next())if(Pa.value===F)return!0;return!1};Object(ae.a)(pa,"AppsforOfficeTokenFromOauthManager",null,[67]);na.Nna=function(){if(fg.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var F=null;try{F=dh.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(fa){Re.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+fa)}F=new pa(F);na.Na=new na(F)}};na.getInstance=function(){na.x5d||(na.Nna(),na.x5d=
!0);return na.Na};na.Na=null;na.x5d=!1;Object(ae.a)(na,"AppsForOfficeOauthManagerFactory",null,[39]);var Ub=b(128);Object(ae.a)(xa,"NewDocumentParameters",null,[]);var e=b(156);ma.prototype.createAndOpenWorkbook=function(F){var fa=this;if(F&&F.length>this.Mng)throw Re.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",F.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,e.a.ea(1712));var Pa=new xa("blank","agave",F?"streamBase64":"streamEmpty",F),
yb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Cc,Vc){var rd=new Ub.StandardDialog;rd.kc=4;rd.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Hd){2!==Hd&&Hd?(yb=window.open(""),fa.jog.create(Cc,Vc,Pa).y_a()):Vc("Cancelled")})}).then(function(Cc){if(!Cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,e.a.ea(1708));try{yb.top.location.href=Cc}catch(Vc){Re.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",uh.a.Po,Vc),Re.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),yb.location.replace(Cc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Cc){if("Cancelled"===Cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.Yzd,e.a.ea(1711));yb.close();fa.ABj();return null})};
ma.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ma.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ma.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ma.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ma.prototype.invokePropertySetAsync=function(F,
fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ma.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ma.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.E_g(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ma.prototype.E_g=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.createAndOpenWorkbook(F)};
ma.prototype.ABj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,e.a.ea(1708));};Object(ae.a)(ma,"WacWorkbook",null,[]);var C=b(858),M=b(868);tl.Object.defineProperties(ca.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(ae.a)(ca,"RichApiPreviewExecutionContext",null,[]);var ra=b(24),Na=b(1015),Ib=b(201),Gc=b(203),id=b(114),Uc=b(11),Vd=Gc.a;vm(ba,Vd);ba.prototype.start=function(F,fa){var Pa="<div class='"+id.a.ojh+
" "+Yc.a.Ir+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+id.a.uU+"' /></div>";Pa=String.format(Pa,Fa.a.If(this.$3c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Ob.innerHTML=Pa;this.Knb=Uc.DOMElementExtensions.getElementById(this.Ob,"bindingText");F=fa?F.z1a(fa,this.$3c.DdaBindingsMethod.BindingId):null;(null===F||void 0===F?0:F.IsValidRef)?(fa=new ra.Range(F.Reference.FirstRow+1,F.Reference.FirstColumn+1,F.Reference.LastRow+
1,F.Reference.LastColumn+1,!1,!1),this.Knb.value=F.Reference.SheetName+"!"+fa):(F=Rh.g(this.$).ha,this.Knb.value=Yj.f(this.$.oa)||!F.va.Dh?"":F.Lha);this.initialize();this.nf()};ba.prototype.lm=function(){this.yZc();this.addButton(0);this.addButton(1);Vd.prototype.lm.call(this)};ba.prototype.setFocus=function(){Uc.DOMElementExtensions.setFocus(this.Knb)};ba.prototype.validate=function(){return!0};ba.prototype.commit=function(){var F=this.Knb.value.trim(),fa=F.indexOf("!");-1!==fa&&(F=this.yRh(F.substring(0,
fa))+F.substr(fa));this.qDe.addBinding(this.$3c,F,0,this.callback);return!0};ba.prototype.dGa=function(){this.qDe.ZP.vf(C.a.internalError,this.callback);Vd.prototype.dGa.call(this)};ba.prototype.yRh=function(F){F=Sj.a.trimStart(F.trim(),"=");return F.length?F.startsWith("'")&&F.endsWith("'")?F:zh.HelperMethods.B6b(F):""};tl.Object.defineProperties(ba.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(ae.a)(ba,"DdaBindingPrompt",Gc.a,[]);O.prototype.vf=
function(F,fa){if(fa){var Pa={};Pa.Error=F;Pa.Version=this.fa.rf;fa(Pa)}};O.prototype.jJa=function(F,fa){this.vf(F,fa)};O.prototype.JG=function(F,fa){this.vf(C.a.sSe(F.Errors[0].MessageId),fa)};O.prototype.Au=function(F){F&&F(this.BP())};O.prototype.BP=function(){var F={Error:0};F.Version=this.fa.rf;return F};Object(ae.a)(O,"DdaErrorGenerator",null,[]);var Ye=b(302),Gf=b(105);Q.prototype.dvd=function(F,fa){function Pa(Hd){var te=yb.$.xa.getItemByName(Hd.SheetName);(null===te||void 0===te?0:te.visible)?
(Rh.g(yb.$).yi(Hd,null,null,null,3,Gf.a.a8g,void 0,void 0,void 0,void 0,!0),yb.ZP.Au(fa)):yb.ZP.vf(C.a.AQg,fa)}var yb=this,Cc=F.DdaGoToByIdMethod.GoToType,Vc=F.DdaGoToByIdMethod.SelectionMode,rd=F.DdaGoToByIdMethod.Id.toString().trim();Cc?1===Cc?this.Qui(rd,Vc,Pa,fa):this.ZP.vf(C.a.SHj,fa):this.Mui(rd,Vc,F.DdaMethod.ControlId,Pa,fa)};Q.prototype.Mui=function(F,fa,Pa,yb,Cc){var Vc=this;this.Ez.ddaGetBinding(Pa,F,function(rd){if(!Ye.a(rd)&&rd.Result&&rd.Result.Reference){rd=rd.Result;var Hd={};Hd.SheetName=
rd.Reference.SheetName;Hd.FirstRow=rd.Reference.FirstRow;Hd.FirstColumn=rd.Reference.FirstColumn;Hd.LastRow=rd.Reference.LastRow;Hd.LastColumn=rd.Reference.LastColumn;Q.kUc(Hd,fa);1!==rd.BindingType?yb(Hd):Vc.Ez.ddaGetBindingData(Pa,F,1,0,2,0,0,-1,-1,function(te){Ye.a(te)||!te.Result?Vc.ZP.JG(te,Cc):(te=te.Result,2!==fa&&(Hd.FirstRow-=te.Headers.length,0>Hd.FirstRow&&(Hd.FirstRow=0)),yb(Hd))},Cc)}else Vc.ZP.jJa(C.a.w1f,Cc)},Cc)};Q.prototype.Qui=function(F,fa,Pa,yb){var Cc=this,Vc=Xj.z(F);Vc?(Vc=Xj.v(Vc,
this.$),Q.kUc(Vc,fa),Pa(Vc)):this.$.fa.isNamedObjectViewMode&&this.$.xb.tj(F)?this.$.xb.oa=this.$.xb.getItemByName(F):(Vc=function(rd){Ye.a(rd)||!rd.Result?Cc.$.xa.contains(F)?(rd={},rd.SheetName=F,rd.FirstRow=0,rd.FirstColumn=0,rd.LastRow=0,rd.LastColumn=0,Pa(rd)):Cc.ZP.jJa(C.a.w1f,yb):(rd=rd.Result,Q.kUc(rd,fa),Pa(rd))},this.$.xa.oa?this.Ez.parseRangeForGoto(F,this.$.xa.oa.name,Vc,yb):this.Ez.parseRange(F,Vc,yb))};Q.kUc=function(F,fa){F.LastRow=2===fa?F.FirstRow:F.LastRow;F.LastColumn=2===fa?F.FirstColumn:
F.LastColumn};Object(ae.a)(Q,"DdaNavigator",null,[]);var rg=b(287),Dg;(function(F){F[F.unsupported=0]="unsupported";F[F.surface=1]="surface";F[F.combo=2]="combo";F[F.column=3]="column";F[F.column3D=4]="column3D";F[F.bar=5]="bar";F[F.bar3D=6]="bar3D";F[F.line=7]="line";F[F.line3D=8]="line3D";F[F.pie=9]="pie";F[F.pie3D=10]="pie3D";F[F.scatter=11]="scatter";F[F.bubble=12]="bubble";F[F.area=13]="area";F[F.area3D=14]="area3D";F[F.doughnut=15]="doughnut";F[F.radar=16]="radar";F[F.stock=17]="stock";F[F.waterfall=
18]="waterfall";F[F.funnel=19]="funnel";F[F.treemap=20]="treemap";F[F.sunburst=21]="sunburst";F[F.boxWhisker=22]="boxWhisker";F[F.histogram=23]="histogram";F[F.pareto=24]="pareto";F[F.regionMap=25]="regionMap";F[F.noVisibleSeries=26]="noVisibleSeries";F[F.complexDataSource=27]="complexDataSource";F[F.pivotChart=28]="pivotChart"})(Dg||(Dg={}));Object(ae.b)("ChartCategory",Dg);Object(ae.a)(R,"MacroRecorderEventData",null,[]);W.prototype.ZPh=function(F){var fa;if(void 0===F||null===F||void 0===F.RequestBody||
null===F.RequestBody)return null;var Pa=JSON.parse(F.RequestBody);if(void 0!==F.ActiveChartId&&null!==F.ActiveChartId){Pa.ActiveChartId=F.ActiveChartId;var yb=Rh.g(this.$).ha.Qa.nc;if(null===(fa=null===yb||void 0===yb?void 0:yb.floatingObject)||void 0===fa?0:fa.Yc)Pa.ActiveChartType=Dg[yb.floatingObject.Yc.ChartCategory]}void 0!==F.SheetMultiRange&&null!==F.SheetMultiRange&&(Pa.SheetName=F.SheetMultiRange.SheetName);return Pa};W.prototype.gQh=function(F){if(void 0===F||null===F||void 0===F.Result||
null===F.Result)return null;F=F.Result;return void 0===F.ResponseBody||null===F.ResponseBody||F.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(F.ResponseBody.join(""))};W.prototype.cei=function(F){return!!F&&!(void 0===F.eventId||null===F.eventId)&&0<F.eventId.length};W.prototype.Wl=function(F){var fa=this;return function(){if(fa.$.Taa){var Pa=fa.KMg(fa.request);if(fa.cei(Pa)){var yb=fa.ZPh(fa.request),Cc=fa.gQh(F);if(yb&&!Ai.a.isEmpty(yb)&&Cc&&!Ai.a.isEmpty(Cc))return Re.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new gf(Pa,yb,Cc);Pa=String.format("requestInfo: {0}; responseInfo: {1}",yb?"(not null)":"(null)",Cc?"(not null)":"(null)");Re.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Pa)}}return new gf(null,null,null)}};W.prototype.KMg=function(F){var fa=this.dei(F.SolutionId),Pa=W.GPh(F);if(Pa&&fa)return fa={},Re.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(fa.recorderEventId=Pa,fa["request.SolutionId"]=F.SolutionId,fa)),new R(F.SolutionId,Pa);var yb={};Re.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(yb.recorderEventId=Pa,yb.isRecorderAwareAddin=fa,yb["request.SolutionId"]=F.SolutionId,yb));return null};W.prototype.dei=function(F){if(!F)return!1;F=F.toLowerCase();return W.gVh().contains(F)};W.gVh=function(){W.Sya||(W.Sya=new gj.a(Hj.a.Ik()),W.Sya.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),W.Sya.add("fa000000005"),
W.Sya.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),W.Sya.add("fa000000014"),W.Sya.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return W.Sya};W.GPh=function(F){var fa=null,Pa=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Pa.test(F.RequestBody))fa=Pa.exec(F.RequestBody)[1];else{F=F.RequestHeaders;if(!F)return fa;Pa=vj.a.Qxi.toLowerCase();for(var yb=0;yb<F.length;yb++)if(F[yb].Name.toLowerCase()===Pa){fa=F[yb].Value;break}}return fa};W.Sya=null;Object(ae.a)(W,"DdaRichApiRequestRecorder",
null,[]);var Eg=b(63),Ch=rg.a;vm(ia,Ch);ia.prototype.t2=function(F){return Ch.prototype.t2.call(this,F)||this.wPg(F)};ia.prototype.Wl=function(){return this.rJd.Wl(this.yd)};ia.prototype.fdb=function(){var F={OperationType:3};F.RichApiRequest=this.request;return F};ia.prototype.wPg=function(F){var fa=this;return function(Pa,yb,Cc){return I(F,fa.request,oi.b(Pa,fa.Nkb),oi.a(yb,fa.chb),Cc,fa.e3)}};tl.Object.defineProperties(ia.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ig.EwaSettings.tc()?
Object(Eg.a)(ia.prototype,this,"operationWorkingState"):2}},pAc:{configurable:!0,enumerable:!0,get:function(){return this.DEa}},lr:{configurable:!0,enumerable:!0,get:function(){return this.Nkb}},I3:{configurable:!0,enumerable:!0,get:function(){return this.chb}}});Object(ae.a)(ia,"DdaRichApiRequestBatchOperation",rg.a,[]);var kj=rk.a;vm(P,kj);P.prototype.Wl=function(){return this.rJd.Wl(this.yd)};tl.Object.defineProperties(P.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ig.EwaSettings.tc()?
Object(Eg.a)(P.prototype,this,"operationWorkingState"):0}}});Object(ae.a)(P,"DdaRichApiRequestOperation",rk.a,[]);N.prototype.ddaAddBinding=function(F,fa,Pa,yb,Cc,Vc,rd){var Hd=this;this.tJ(function(te,hf,ff){var lg=Hd.$.qa.ta,Og=Hd.Qia();te=oi.b(te,Vc);hf=oi.a(hf,Hd.JH);var lh=lg.Oa(9);lh.controlId=F;lh.bindingId=fa;lh.bindingType=Pa;lh.currentSheetName=Og;lh.formula=yb;lh.options=Cc;return Oi.i(lg,"DdaAddBinding",lh,te,hf,ff,rd,0)},rd,563)};N.prototype.ddaReleaseBinding=function(F,fa,Pa,yb){var Cc=
this;this.tJ(function(Vc,rd,Hd){var te=Cc.$.qa.ta;Vc=oi.b(Vc,Pa);rd=oi.a(rd,Cc.JH);var hf=te.Oa(9);hf.controlId=F;hf.bindingId=fa;return Oi.i(te,"DdaReleaseBinding",hf,Vc,rd,Hd,yb,0)},yb,564)};N.prototype.ddaGetBinding=function(F,fa,Pa,yb){var Cc=this;this.tJ(function(Vc,rd,Hd){var te=Cc.$.qa.ta;Vc=oi.b(Vc,Pa);rd=oi.a(rd,Cc.JH);var hf=te.Oa(1);hf.controlId=F;hf.bindingId=fa;return Oi.i(te,"DdaGetBinding",hf,Vc,rd,Hd,yb,0)},yb,565,16)};N.prototype.ddaGetAllBindings=function(F,fa,Pa){var yb=this;this.tJ(function(Cc,
Vc,rd){var Hd=yb.$.qa.ta;Cc=oi.b(Cc,fa);Vc=oi.a(Vc,yb.JH);var te=Hd.Oa(1);te.controlId=F;return Oi.i(Hd,"DdaGetAllBindings",te,Cc,Vc,rd,Pa,0)},Pa,566,16)};N.prototype.ddaGetBindingData=function(F,fa,Pa,yb,Cc,Vc,rd,Hd,te,hf,ff){var lg=this;this.tJ(function(Og,lh,Ih){var Ah=lg.$.qa.ta,Uh=lg.Qia();Og=oi.b(Og,hf);lh=oi.a(lh,lg.JH);var ii=Ah.Oa(1);ii.controlId=F;ii.bindingId=fa;ii.coerceType=Pa;ii.valueFormat=yb;ii.filterType=Cc;ii.startRow=Vc;ii.startCol=rd;ii.rowCount=Hd;ii.colCount=te;ii.currentSheetName=
Uh;return Oi.i(Ah,"DdaGetBindingData",ii,Og,lh,Ih,ff,0)},ff,567,16)};N.prototype.ddaSetBindingData=function(F,fa,Pa,yb,Cc,Vc,rd){var Hd=this;this.tJ(function(te,hf,ff){var lg=Hd.$.qa.ta,Og=Hd.Qia();te=oi.b(te,Vc);hf=oi.a(hf,Hd.JH);var lh=lg.Oa(9);lh.controlId=F;lh.bindingId=fa;lh.startRow=Pa;lh.startCol=yb;lh.currentSheetName=Og;lh.bindingData=Cc;return Oi.i(lg,"DdaSetBindingData",lh,te,hf,ff,rd,0)},rd,568)};N.prototype.ddaGetSelectedData=function(F,fa,Pa,yb,Cc,Vc,rd){var Hd=this;this.tJ(function(te,
hf,ff){var lg=Hd.$.qa.ta,Og=Hd.Qia();te=oi.b(te,Vc);hf=oi.a(hf,Hd.JH);var lh=lg.Oa(1);lh.controlId=F;lh.coerceType=fa;lh.valueFormat=Pa;lh.filterType=yb;lh.currentSheetName=Og;lh.formula=Cc;return Oi.i(lg,"DdaGetSelectedData",lh,te,hf,ff,rd,0)},rd,569,16)};N.prototype.ddaSetSelectedData=function(F,fa,Pa,yb,Cc){var Vc=this;this.tJ(function(rd,Hd,te){var hf=Vc.$.qa.ta,ff=Vc.Qia();rd=oi.b(rd,yb);Hd=oi.a(Hd,Vc.JH);var lg=hf.Oa(9);lg.controlId=F;lg.currentSheetName=ff;lg.formula=fa;lg.bindingData=Pa;return Oi.i(hf,
"DdaSetSelectedData",lg,rd,Hd,te,Cc,0)},Cc,570)};N.prototype.ddaLoadSettings=function(F,fa,Pa){var yb=this;this.tJ(function(Cc,Vc,rd){var Hd=yb.$.qa.ta;Cc=oi.b(Cc,fa);Vc=oi.a(Vc,yb.JH);var te=Hd.Oa(1);te.controlId=F;return Oi.i(Hd,"DdaLoadSettings",te,Cc,Vc,rd,Pa,0)},Pa,501,16)};N.prototype.ddaSaveSettings=function(F,fa,Pa,yb,Cc){var Vc=this;this.tJ(function(rd,Hd,te){var hf=Vc.$.qa.ta;rd=oi.b(rd,yb);Hd=oi.a(Hd,Vc.JH);var ff=hf.Oa(9);ff.controlId=F;ff.settings=fa;ff.overwriteIfStale=Pa;return Oi.i(hf,
"DdaSaveSettings",ff,rd,Hd,te,Cc,0)},Cc,571)};N.prototype.ddaAddRowsColumns=function(F,fa,Pa,yb,Cc,Vc){var rd=this;this.tJ(function(Hd,te,hf){var ff=rd.$.qa.ta,lg=rd.Qia();Hd=oi.b(Hd,Cc);te=oi.a(te,rd.JH);var Og=ff.Oa(9);Og.controlId=F;Og.bindingId=fa;Og.isRow=Pa;Og.currentSheetName=lg;Og.bindingData=yb;return Oi.i(ff,"DdaAddRowsColumns",Og,Hd,te,hf,Vc,0)},Vc,572)};N.prototype.ddaDeleteAllDataValues=function(F,fa,Pa,yb){var Cc=this;this.tJ(function(Vc,rd,Hd){var te=Cc.$.qa.ta,hf=Cc.Qia();Vc=oi.b(Vc,
Pa);rd=oi.a(rd,Cc.JH);var ff=te.Oa(9);ff.controlId=F;ff.bindingId=fa;ff.currentSheetName=hf;return Oi.i(te,"DdaDeleteAllDataValues",ff,Vc,rd,Hd,yb,0)},yb,573)};N.prototype.ddaClearBindingFormats=function(F,fa,Pa,yb){var Cc=this;this.tJ(function(Vc,rd,Hd){var te=Cc.$.qa.ta,hf=Cc.Qia();Vc=oi.b(Vc,Pa);rd=oi.a(rd,Cc.JH);var ff=te.Oa(9);ff.controlId=F;ff.bindingId=fa;ff.currentSheetName=hf;return Oi.i(te,"DdaClearBindingFormats",ff,Vc,rd,Hd,yb,0)},yb,574)};N.prototype.ddaSetBindingFormats=function(F,fa,
Pa,yb,Cc,Vc){var rd=this;this.tJ(function(Hd,te,hf){var ff=rd.$.qa.ta,lg=rd.Qia();Hd=oi.b(Hd,Cc);te=oi.a(te,rd.JH);var Og=ff.Oa(9);Og.controlId=F;Og.bindingId=fa;Og.currentSheetName=lg;Og.bindingData=Pa;Og.isSetFormats=yb;return Oi.i(ff,"DdaSetBindingFormats",Og,Hd,te,hf,Vc,0)},Vc,575)};N.prototype.parseRange=function(F,fa,Pa){var yb=this;this.tJ(function(Cc,Vc,rd){var Hd=yb.$.qa.ta.Xb();return Oi.P(yb.$.qa.ta,F,-1,oi.b(Cc,fa),oi.a(Vc,yb.JH),rd,Pa,Hd)},Pa,162,16)};N.prototype.parseRangeForGoto=function(F,
fa,Pa,yb){var Cc=this;this.tJ(function(Vc,rd,Hd){var te=Cc.$.qa.ta.Xb();return Oi.Q(Cc.$.qa.ta,F,fa,oi.b(Vc,Pa),oi.a(rd,Cc.JH),Hd,yb,te)},yb,562,16)};N.prototype.executeRichApiRequest=function(F,fa,Pa){var yb=this;ig.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(F.RequestFlags&=8191);if(ig.EwaSettings.la(259))this.csh(this.$.qa.ta.Xb(),fa,function(){yb.ZP.jJa(C.a.internalError,Pa)},Pa,F);else{var Cc=jh.DdaFacade.Tdd(F);!ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.XJ||Cc&16?(ig.EwaSettings.tc()&&(Cc|=64),this.$.userOperationManager.tt(new P(this.$,F,function(Vc,rd,Hd){return I(yb.$.qa.ta,F,oi.b(Vc,fa),oi.a(rd,yb.JH),Hd,Pa)},Cc))):(this.ZP.jJa(C.a.mBc,Pa),Re.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};N.prototype.Qia=function(){return this.$.fa.isNamedObjectViewMode?this.$.oa.sheetName:this.$.activeItemName};N.prototype.tJ=function(F,fa,Pa,yb){yb=void 0===yb?0:yb;!ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.XJ||yb&16?ig.EwaSettings.tc()?this.$.userOperationManager.tt(new rk.a(Pa,0,F,yb|64)):this.$.userOperationManager.tt(new Bj.a(Pa,0,F,yb)):(this.ZP.jJa(C.a.mBc,fa),Re.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};N.prototype.csh=function(F,fa,Pa,yb,Cc){var Vc=jh.DdaFacade.Tdd(Cc);if(!ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.XJ||Vc&16){var rd=this.$.Ub.Fc("UserAction","Rich Api request");ig.EwaSettings.tc()&&
(Vc|=64);this.$.userOperationManager.ic(new ia(this.$,F,fa,Pa,yb,rd,Cc,Vc),null)}else this.ZP.jJa(C.a.mBc,yb),Re.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(ae.a)(N,"DdaWebServiceHelper",null,[]);Object(ae.a)(U,"DocumentFile",null,[]);B.generalException="GeneralException";B.YEg="ApiNotFound";B.Yzd="OperationCancelled";B.invalidArgument="InvalidArgument";Object(ae.a)(B,"ErrorCodes",null,[]);w.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
w.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};w.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(ae.a)(w,"WacApiDelegates",null,[]);var Lj=b(661);vm(G,w);G.prototype.replaceShortcuts=function(F){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,F,this.Qdf)};G.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
G.prototype.checkShortcutsInUse=function(F){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(F,this.Qdf)};G.A2g=function(F,fa){var Pa=document.createEvent("KeyboardEvent");if(uh.a.ME)Pa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(F&8),!!(F&32),!!(F&4),!!(F&256));else{var yb=[];F&4&&yb.push("Shift");F&8&&yb.push("Control");F&32&&yb.push("Alt");Pa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,yb,!1,"en-US")}F=new Sys.UI.DomEvent(Pa);F.keyCode=fa;return F};G.fZg=function(F,
fa){if(uh.a.zf)switch(fa){case 189:fa=173;break;case 187:fa=61;break;case 186:fa=59}return G.A2g(F,fa)};Object(ae.a)(G,"ExcelWacApiDelegates",w,[]);r.prototype.pwg=function(F,fa){this.Pbc(F)||(this.THa[F]={});if(this.F$h(F))return Re.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",F),C.a.Xri;this.THa[F][fa.Uth.toString()]=fa;return C.a.success};r.prototype.CHh=function(F,fa){var Pa=null;this.Pbc(F)&&(Pa=this.THa[F][fa.toString()]);Pa||Re.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",F,fa);return Pa};r.prototype.Pbc=function(F){return F in this.THa};r.prototype.Y1i=function(F,fa){if(this.Pbc(F)){var Pa=this.THa[F];delete Pa[fa.toString()];1>Object.keys(Pa).length&&delete this.THa[F];return fa.toString()in Pa?C.a.internalError:C.a.success}return C.a.internalError};r.prototype.F$h=function(F){return this.Pbc(F)?Object.keys(this.THa[F]).length>=this.qri:!1};r.getInstance=function(F){return F.da.Aa(200)||F.da.Ha(200,
new r(r.rri))};r.wvi=function(){return++r.MOg};r.Xqi=4194304;r.rri=1;r.MOg=0;Object(ae.a)(r,"GetFileApiHelper",null,[]);z.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Rz)};z.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};z.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};z.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(F){switch(F){case 1:return this.ewi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokeMethodAsync=
function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};z.prototype.ewi=function(){this.notifyActionHandlerReady();return null};Object(ae.a)(z,"AddinInternalService",null,[]);t.prototype.getAppRuntimeState=function(){return this.AI.getAppRuntimeState(this.Rz)?2:1};t.prototype.setAppRuntimeState=function(F){switch(F){case 2:F=!0;break;case 1:F=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,
e.a.ea(1712));}this.AI.setAppRuntimeState(this.Rz,F)};t.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};t.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};t.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(F,fa){switch(F){case 2:return this.VCh();case 1:return this.Ugj(fa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.VCh=function(){return this.getAppRuntimeState()};
t.prototype.Ugj=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");this.setAppRuntimeState(F);return null};Object(ae.a)(t,"AppRuntimeService",null,[]);var Rj=b(1122);x.prototype.disable=function(){try{if(!e.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qAe();if(!this.sdf())return this.rAe();this.e1.$Gj(this.ms)}catch(F){return Re.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
F.message||"Unknown"),this.oAe()}return null};x.prototype.enable=function(){try{if(!e.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qAe();if(!this.sdf())return this.rAe();this.e1.e0i(this.ms)}catch(F){return Re.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",F.message||"Unknown"),this.oAe()}return null};x.prototype._OnAccess=function(){};x.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
x.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};x.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
x.prototype.invokeMethod=function(F){switch(F){case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokeMethodAsync=function(F,fa){switch(F){case 3:return this.Fah();case 2:return this.Zfh()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};x.prototype.Fah=function(){return this.disable()};x.prototype.Zfh=function(){return this.enable()};x.prototype.LBa=function(){this._OnAccess();return null};
x.prototype.qAe=function(){return Rj.a(Xi.a.notImplemented,e.a.ea(1713))};x.prototype.rAe=function(){return Rj.a(Xi.a.sharedRuntimeNotAvailable,e.a.ea(1717))};x.prototype.oAe=function(){return Rj.a(Xi.a.generalException,e.a.ea(1708))};x.prototype.sdf=function(){var F=this.ly.getSharedRuntimeId();return!!F&&0<F.length};Object(ae.a)(x,"BeforeDocumentCloseNotification",null,[]);A.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};A.prototype.invokePropertyGet=
function(F){switch(F){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};A.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};A.prototype.invokePropertySet=function(F,fa){switch(F){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};A.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};A.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(A.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Mz},set:function(F){this.Mz=F}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.$9d},set:function(F){this.$9d=F}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Zee},set:function(F){this.Zee=F}}});Object(ae.a)(A,
"CustomFunctionEngineStatus",null,[]);m.prototype.register=function(F){return OfficeExtension.WacRuntime.Utility.createPromise(this.Wpg(F))};m.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};m.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
m.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.U0i(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
m.prototype.U0i=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"string");return this.register(fa,F)};tl.Object.defineProperties(m.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var F=new A;F.enabled=this.dmg;F.streamingEnabled=this.emg;F.nativeRuntime=!1;return F}}});Object(ae.a)(m,"CustomFunctionManager",null,[]);var Jk=b(1079);v.prototype._RegisterStateChange=function(){var F=
this;this.KQb||this.uO.execute(function(fa){F.W_d=fa.Vya(F._id,function(Pa){F.AI.$vh(F.Rz,F._id,JSON.stringify(Pa))})});this.KQb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype._UnregisterStateChange=function(){var F=this;this.KQb--;this.KQb||this.uO.execute(function(fa){fa.YFd(F._id,F.W_d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};v.prototype.invokePropertyGet=
function(F){switch(F){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};v.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
v.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokeMethodAsync=function(F,fa){switch(F){case 6:return this.Mfg();case 7:return this.Ofg()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};v.prototype.Mfg=function(){return this._RegisterStateChange()};v.prototype.Ofg=function(){return this._UnregisterStateChange()};tl.Object.defineProperties(v.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(ae.a)(v,"LicenseFeature",null,[]);u.prototype.getFeatureTier=function(F,fa){var Pa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(yb){var Cc=1===fa?1:2===fa?2:0;Pa.uO.execute(function(Vc){Vc.getFeatureTier(F,Cc).then(function(rd){yb(Pa.HLh(rd))},function(){yb(fa)})})})};u.prototype.getLicenseFeature=function(F){F=new v(this.uO,F,this.Rz,this.AI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.isFeatureEnabled=
function(F,fa){var Pa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(yb){Pa.uO.execute(function(Cc){Cc.isFeatureEnabled(F,fa).then(function(Vc){yb(Vc)},function(){yb(fa)})})})};u.prototype.isFreemiumUpsellEnabled=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(fa){F.uO.execute(function(Pa){Pa=Pa.isFreemiumUpsellEnabled();fa(Pa)})})};u.prototype.launchUpsellExperience=function(F){var fa=this;if(this.Nog.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){fa.uO.execute(function(Pa){Pa.launchUpsellExperience(F)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.sRc,"");};u.prototype._TestFireStateChangedEvent=function(){};u.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};u.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};u.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(F,fa){switch(F){case 6:return this.Nfg(fa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokeMethodAsync=function(F,fa){switch(F){case 2:return this.wIh(fa);case 5:return this.GLh(fa);case 1:return this.sai(fa);case 3:return this.Wai();case 4:return this.Vji(fa)}F=this.invokeMethod(F,
fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.wIh=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");return this.getFeatureTier(fa,F)};u.prototype.GLh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getLicenseFeature(F)};u.prototype.sai=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"boolean");return this.isFeatureEnabled(fa,F)};u.prototype.Wai=function(){return this.isFreemiumUpsellEnabled()};u.prototype.Vji=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.launchUpsellExperience(F)};u.prototype.Nfg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");this._TestFireStateChangedEvent(F);return null};u.prototype.HLh=function(F){switch(F){case 1:return 1;
case 2:return 2;default:return 0}};Object(ae.a)(u,"License",null,[]);var Sk=b(147);l.prototype.areShortcutsInUse=function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,yb){fa.std.checkShortcutsInUse(F).then(function(Cc){Pa(Cc)}).catch(function(Cc){yb(Cc)})})};l.prototype.getShortcuts=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(fa,Pa){F.std.getShortcuts().then(function(yb){fa(yb)}).catch(function(yb){Pa(yb)})})};l.prototype.replaceShortcuts=
function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,yb){fa.std.replaceShortcuts(F).then(function(){Pa(null)}).catch(function(Cc){yb(Cc)})})};l.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};l.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
l.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokeMethodAsync=function(F,fa){switch(F){case 3:return this.IGg(fa);case 1:return this.CRh();case 2:return this.B7i(fa)}F=
this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};l.prototype.IGg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");return this.areShortcutsInUse(F)};l.prototype.CRh=function(){return this.getShortcuts()};l.prototype.B7i=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"any");return this.replaceShortcuts(F)};Object(ae.a)(l,"ActionService",null,[]);var al=b(524);n.prototype.sRh=function(){this.Kfa||
(this.Kfa=al.a.Fq(dh.a.instance.mc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Kfa};n.prototype.getSharedFilePickerResponse=function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Pa,yb){try{var Cc=fa.sRh();oj.Task.WAA.call(null,Cc).continueWith(function(){var Vc=Cc.result;if(Vc){var rd={};(function(){var Hd=Bh.d(F);rd=Hd.uu;return Hd})().returnValue?Vc.y$b(rd).then(function(Hd){Hd&&0<Hd.length?Pa(Hd):yb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Hd){yb(Hd)}):yb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else yb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Vc){yb(Vc)}})};n.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};n.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};n.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};n.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.rRh(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.rRh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getSharedFilePickerResponse(F)};Object(ae.a)(n,"SharedFilePicker",null,[]);k.prototype.createInstance=function(F,fa){switch(F){case "Microsoft.Office.ActionService":return new l(fa);case "Microsoft.Office.SharedFilePicker":return new n}return null};
Object(ae.a)(k,"WacApiHost",null,[]);c.prototype.hostName=function(){return"ExcelOnline"};c.prototype.appId=function(){return this.POb};c.prototype.createInstance=function(F){switch(F){case "Microsoft.Authentication.AuthenticationService":return dh.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.Rz,this.AI.Gi);case "Microsoft.Authentication.TokenParameters":return new Ya;case "Microsoft.ExcelServices.CustomFunctionManager":F=this.vb.la(121);
var fa=this.vb.la(122);return new m(F,fa,f(this.POb,this.vb,this.AI));case "Microsoft.AppRuntime.AppRuntimeService":return new t(this.Rz,this.AI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return F=Kj.a(this.vb),new x(this.POb,this.Rz,F,this.AI);case "Microsoft.DynamicRibbon.DynamicRibbon":return F=Kj.a(this.vb),new Jk.DynamicRibbon(this.POb,this.Rz,this.AI,F,F.an(this.Rz).cl);case "Microsoft.Office.Licensing.License":return new u(this.Rz,this.AI);case "Microsoft.InternalService.AddinInternalService":return new z(this.Rz);
default:if(this.ZQc||(this.ZQc=new k),fa=this.ZQc.createInstance(F,this.Ztg))return fa}Re.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",F);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Xi.a.generalException);};Object(ae.a)(c,"RichApiHost",null,[]);var fl=b(382),gl=b(113),bl=b(32),kl=b(95),Uk=b(278),hl=b(39),jl=b(246),ll=b(6),ol=b(64),ml=b(193);d.prototype.dispose=function(){this.$=this.A7b=
null};d.prototype.Xc=function(){return!1};d.prototype.fd=function(){return!1};d.prototype.executeCommand=function(F,fa,Pa){F=fa.command;switch(F){case 451041795:this.we.vf(Pa[Se.a.Kg],Pa[Se.a.e3]);break;case 974713501:this.GXh(Pa[Se.a.Kg],Pa[Se.a.e3]);break;case 1237877382:this.we.Au(Pa[Se.a.e3]);break;default:return hk.a(F)}return oj.Task.Ta(!0)};d.prototype.Gc=function(F,fa,Pa){if(F=!!Pa)switch(fa.command){case 974713501:case 1237877382:case 451041795:break;default:F=!1}return F};d.prototype.GXh=
function(F,fa){var Pa=F.DdaMethod;if("undefined"===typeof Pa.DispatchId)this.we.vf(C.a.internalError,fa);else if(d.z$h(F)||this.$.Fd&1){if(Pa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new ba(this.$,this,F,fa)).start(this.Ve,F.DdaMethod.ControlId):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.RQh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.mlj(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(F,this.Zbd(F.DdaMethod.ControlId),0,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.zDh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.dhj(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.yDh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.X1i(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.zCh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Frd(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(F.DdaAddRowsColumns.IsRow=!0,this.Nje(F,fa)):Pa.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(F.DdaAddRowsColumns.IsRow=!1,this.Nje(F,fa)):Pa.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.o9g(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.tTg(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(F.DdaSetBindingFormats.IsSetFormats=!0,this.wUf(F,fa)):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(F.DdaSetBindingFormats.IsSetFormats=!1,this.wUf(F,fa)):Pa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(F,F.DdaBindingsMethod.ItemName,F.DdaBindingsMethod.FailOnCollision?2:1,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.AIh(fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.dvd(F,fa):Pa.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.zHh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.AHh(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Z1i(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(F.DdaMethod.ControlId,F),this.we.Au(fa)):
Pa.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?ig.EwaSettings.la(24)?this.we.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fa):this.Esi(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?ig.EwaSettings.la(24)?this.we.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fa):this.Asi(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(F,fa):Pa.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(F,fa):this.we.vf(C.a.aAd,fa),ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Pa.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){F=this.Ve.XY(F.DdaMethod.ControlId);fa="";if(F){fa=jh.DdaFacade.getSolutionId(F,this.$);var yb=F.PrimaryMarketplace.MarketplaceType;yb===OSF.StoreType.InMemory?F.OwnerAddinAssetId&&F.AssetMarketplace&&(yb=F.AssetMarketplace.MarketplaceType):yb===OSF.StoreType.WopiCatalog&&(yb=OSF.StoreType.OMEX);
fa=Telemetry.PrivacyRules.GetAssetId(yb,F.PrimaryMarketplace.MarketplaceRef,fa)}Re.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Pa.DispatchId,fa)}}else this.we.vf(C.a.nGe,fa)};d.prototype.zDh=function(F,fa){var Pa=this;F.DdaGetBindingData.CoerceType=d.l1b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.FilterType=d.fQe(F.DdaGetBindingData.FilterType);F.DdaGetBindingData.ValueFormat=d.pbg(F.DdaGetBindingData.ValueFormat);if(this.Qgc(F.DdaGetBindingData.CoerceType,fa)){if(F.DdaGetBindingData){var yb=
F.DdaGetBindingData;yb.FilterType||(yb.FilterType=2);yb.StartCol|=0;yb.StartRow|=0;yb.ColCount=void 0===yb.ColCount?-1:yb.ColCount;yb.RowCount=void 0===yb.RowCount?-1:yb.RowCount}this.Ez.ddaGetBindingData(F.DdaMethod.ControlId,F.DdaGetBindingData.BindingId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,F.DdaGetBindingData.StartRow,F.DdaGetBindingData.StartCol,F.DdaGetBindingData.RowCount,F.DdaGetBindingData.ColCount,function(Cc){if(Ye.a(Cc)||!Cc.Result)Pa.we.JG(Cc,
fa);else{var Vc=Pa.we.BP();Vc.Data=d.Qre(Cc.Result);fa(Vc)}},fa)}};d.prototype.dhj=function(F,fa){var Pa=this;F.DdaSetBindingData.CoerceType=d.l1b(F.DdaSetBindingData.CoerceType);if(this.Qgc(F.DdaSetBindingData.CoerceType,fa)){var yb=d.XWc(F.DdaSetBindingData.CoerceType,F.DdaSetBindingData.Data);d.Zdc(yb)?this.we.vf(C.a.jzc,fa):(1===yb.CoerceType&&(yb.CellFormat||(yb.CellFormat=F.DdaSetBindingData.CellFormat),yb.TableOptions||(yb.TableOptions=F.DdaSetBindingData.TableOptions)),F.DdaSetBindingData&&
(F.DdaSetBindingData.StartCol|=0,F.DdaSetBindingData.StartRow|=0),this.Ez.ddaSetBindingData(F.DdaMethod.ControlId,F.DdaSetBindingData.BindingId,F.DdaSetBindingData.StartRow,F.DdaSetBindingData.StartCol,yb,function(Cc){Ye.a(Cc)?Pa.we.JG(Cc,fa):Pa.we.Au(fa)},fa))}};d.prototype.RQh=function(F,fa){var Pa=this;F.DdaGetBindingData.CoerceType=d.l1b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.ValueFormat=d.pbg(F.DdaGetBindingData.ValueFormat);F.DdaGetBindingData.FilterType=d.fQe(F.DdaGetBindingData.FilterType);
if(this.Qgc(F.DdaGetBindingData.CoerceType,fa)){var yb=this.Zbd(F.DdaMethod.ControlId);yb?this.Ez.ddaGetSelectedData(F.DdaMethod.ControlId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,yb,function(Cc){if(Ye.a(Cc))Pa.we.JG(Cc,fa);else{var Vc=Pa.we.BP();Vc.Data=d.Qre(Cc.Result);fa(Vc)}},fa):this.we.vf(C.a.v_e,fa)}};d.prototype.zHh=function(F,fa){var Pa=this;if(uh.a.Gmd)this.we.vf(C.a.SKg,fa);else{var yb=F[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
Cc=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Vc=F.DdaMethod.ControlId,rd=r.getInstance(this.$);if(0>=Cc)Re.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.we.vf(C.a.y7h,fa);else if(Cc>r.Xqi)Re.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.we.vf(C.a.GVe,fa);else{var Hd=null;switch(yb){case 1:Hd="Compressed";break;case 0:Hd="Text";break;case 2:Hd="Pdf";break;default:Re.ULS.sendTraceTag(537163219,
344,15,"Requested file type {0} is not supported.",yb);this.we.vf(C.a.TPe,fa);return}if("Text"===Hd)Re.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Hd),this.we.vf(C.a.TPe,fa);else{ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(F=new Sys.StringBuilder,F.append(Na.a(this.$,Hd)),"Pdf"===Hd&&Ib.a.Vf(F,vj.a.yDd,"WholeWorkbook"),F=F.toString()):F=Na.a(this.$,Hd);var te=null,hf=new XMLHttpRequest;hf.onreadystatechange=function(){if(4===
hf.readyState)if(200===hf.status){var ff=hf.response;if(ff){te=new Uint8Array(ff);ff=Pa.we.BP();for(var lg=te.length,Og=r.wvi(),lh={},Ih=0,Ah=0;Ah<lg;Ah+=Cc){for(var Uh=[],ii=Ah+Cc<lg?Ah+Cc:lg,ij=0,Ji=Ah;Ji<ii;ij++,Ji++)Uh[ij]=te[Ji];lh[(Ih++).toString()]=Uh}lh=new U(Og,lg,Cc,lh);lh=rd.pwg(Vc,lh);lh!==C.a.success?Pa.we.vf(lh,fa):(ff[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Og,ff[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=lg,Re.ULS.sendTraceTag(537163216,344,
50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Hd,lg),fa(ff))}else Re.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Hd),Pa.we.vf(C.a.internalError,fa)}else 500===hf.status?Pa.we.vf(C.a.sSe(parseInt(hf.statusText)),fa):(Re.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",Hd),Pa.we.vf(C.a.evi,fa))};hf.open("GET",F,!0);hf.responseType="arraybuffer";hf.setRequestHeader("If-Modified-Since",
"0");hf.send(null)}}}};d.prototype.AHh=function(F,fa){var Pa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],yb=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];F=F.DdaMethod.ControlId;(Pa=r.getInstance(this.$).CHh(F,Pa))?(Pa=Pa.Tuj,0>yb||yb>=Object.keys(Pa).length?this.we.vf(C.a.n2h,fa):(yb=Pa[yb.toString()],Pa=this.we.BP(),Pa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=yb,Pa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=yb.length,fa(Pa))):
this.we.vf(C.a.internalError,fa)};d.prototype.Z1i=function(F,fa){var Pa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];F=F.DdaMethod.ControlId;Pa=r.getInstance(this.$).Y1i(F,Pa);Pa===C.a.success?this.we.Au(fa):this.we.vf(Pa,fa)};d.prototype.mlj=function(F,fa){var Pa=this;F.DdaSetBindingData.CoerceType=d.l1b(F.DdaSetBindingData.CoerceType);if(this.Qgc(F.DdaSetBindingData.CoerceType,fa)){var yb=this.Zbd(F.DdaMethod.ControlId);if(yb){var Cc=d.XWc(F.DdaSetBindingData.CoerceType,F.DdaSetBindingData.Data),
Vc=Rh.g(this.$).ha;1===Cc.CoerceType&&(!Cc.Data&&Vc.va.nV&&(Cc.Headers||(Cc.Headers=[]),Cc.Headers.length||Array.add(Cc.Headers,[]),Cc.Headers[0].length||Array.add(Cc.Headers[0],"")),d.Zdc(Cc)||(Cc.CellFormat||(Cc.CellFormat=F.DdaSetBindingData.CellFormat),Cc.TableOptions||(Cc.TableOptions=F.DdaSetBindingData.TableOptions)));if(d.Zdc(Cc))this.we.vf(C.a.jzc,fa);else{var rd=Vc.va.Qd.clone(),Hd=Vc.va.activeCell.clone();this.Ez.ddaSetSelectedData(F.DdaMethod.ControlId,yb,Cc,function(te){var hf;if(Ye.a(te))Pa.we.JG(te,
fa);else{te=rd.clone();var ff=Cc.Headers?Cc.Headers[0].length:Cc.Data[0].length;1!==Cc.CoerceType||Cc.Data?1===Cc.CoerceType&&(null===(hf=Cc.TableOptions)||void 0===hf?0:hf.length)&&0==Cc.TableOptions[0]?(te.top+=1,te.bottom=te.top+Cc.Data.length-1):te.bottom=te.top+Cc.Data.length-(1===Cc.CoerceType?0:1):te.bottom=te.top+1;te.right=te.left+ff-1;hf=te.contains(Hd)?Hd:te.topLeft;Vc.updateSelection(te,hf,0);Pa.we.Au(fa)}},fa)}}else this.we.vf(C.a.iue,fa)}};d.prototype.addBinding=function(F,fa,Pa,yb){var Cc=
this;fa?this.Ez.ddaAddBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,F.DdaBindingsMethod.BindingType,fa,Pa,function(Vc){if(Ye.a(Vc))Cc.we.JG(Vc,yb);else{var rd=Cc.we.BP();rd.Bindings=Array(1);rd.Bindings[0]=Cc.Ve.UZb(Vc.Result);yb(rd)}},yb):this.we.vf(C.a.yej,yb)};d.prototype.yDh=function(F,fa){var Pa=this;this.Ez.ddaGetBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(yb){if(Ye.a(yb)||!yb.Result)Pa.we.JG(yb,fa);else{var Cc=Pa.we.BP();Cc.Bindings=Array(1);Cc.Bindings[0]=
Pa.Ve.UZb(yb.Result);fa(Cc)}},fa)};d.prototype.AIh=function(F){var fa=this.we.BP(),Pa={};Pa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;fa[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Pa;F(fa)};d.prototype.X1i=function(F,fa){var Pa=this;this.Ez.ddaReleaseBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(yb){Ye.a(yb)?Pa.we.JG(yb,fa):Pa.we.Au(fa)},fa)};d.prototype.zCh=function(F,fa){var Pa=this;this.Ez.ddaGetAllBindings(F.DdaMethod.ControlId,
function(yb){if(Ye.a(yb))Pa.we.JG(yb,fa);else{var Cc=Pa.we.BP();if(yb.Result){yb=yb.Result;Cc.Bindings=Array(yb.length);for(var Vc=0;Vc<yb.length;Vc++)Cc.Bindings[Vc]=Pa.Ve.UZb(yb[Vc])}else Cc.Bindings=null;fa(Cc)}},fa)};d.prototype.Frd=function(F,fa){var Pa=this;this.Ez.ddaLoadSettings(F.DdaMethod.ControlId,function(yb){if(Ye.a(yb))Pa.we.JG(yb,fa);else{var Cc=Pa.we.BP();Cc.Properties=yb.Result;fa(Cc)}},fa)};d.prototype.saveSettings=function(F,fa){for(var Pa=this,yb={Settings:[]},Cc=0;Cc<F.DdaSettingsMethod.Properties.length;Cc++){var Vc=
{};Vc.Name=F.DdaSettingsMethod.Properties[Cc][0];Vc.Value=F.DdaSettingsMethod.Properties[Cc][1];yb.Settings[Cc]=Vc}this.Ez.ddaSaveSettings(F.DdaMethod.ControlId,yb,F.DdaSettingsMethod.OverwriteIfStale,function(rd){Ye.a(rd)?Pa.we.JG(rd,fa):Pa.we.Au(fa)},fa)};d.prototype.Nje=function(F,fa){var Pa=this,yb=d.XWc(1,F.DdaAddRowsColumns.Data);d.Zdc(yb)?this.we.vf(C.a.jzc,fa):this.Ez.ddaAddRowsColumns(F.DdaMethod.ControlId,F.DdaAddRowsColumns.BindingId,F.DdaAddRowsColumns.IsRow,yb,function(Cc){Ye.a(Cc)?Pa.we.JG(Cc,
fa):Pa.we.Au(fa)},fa)};d.prototype.o9g=function(F,fa){var Pa=this;this.Ez.ddaDeleteAllDataValues(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(yb){Ye.a(yb)?Pa.we.JG(yb,fa):Pa.we.Au(fa)},fa)};d.prototype.tTg=function(F,fa){var Pa=this;this.Ez.ddaClearBindingFormats(F.DdaMethod.ControlId,F.DdaClearBindingFormats.BindingId,function(yb){Ye.a(yb)?Pa.we.JG(yb,fa):Pa.we.Au(fa)},fa)};d.prototype.wUf=function(F,fa){var Pa=this,yb={},Cc=F.DdaSetBindingFormats.IsSetFormats;Cc?yb.CellFormat=F.DdaSetBindingFormats.CellFormat:
yb.TableOptions=F.DdaSetBindingFormats.TableOptions;this.Ez.ddaSetBindingFormats(F.DdaMethod.ControlId,F.DdaSetBindingFormats.BindingId,yb,Cc,function(Vc){Ye.a(Vc)?Pa.we.JG(Vc,fa):Pa.we.Au(fa)},fa)};d.prototype.executeRichApiRequest=function(F,fa){var Pa=this,yb=F.ArrayData,Cc={},Vc=Rh.g(this.$).ha;if(yb){if("WacPartition"===yb[0]){this.Mrh(F,fa);return}var rd=Object(Wi.a)(jh.DdaFacade,Kj.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===yb[0]){var Hd=rd.an(F.DdaMethod.ControlId);Hd&&
(Hd.nnd=!0,Hd.cGf())}Cc.HttpMethod=yb[1];Cc.PathAndQuery=yb[2];Cc.RequestHeaders=d.cXe(yb[3]);Cc.RequestBody=yb[4];Cc.AppPermission=yb[5];Hd=yb[6];Cc.RequestFlags=Hd;var te=0;if(Yj.i(this.$.oa))switch(Vc.Te){case 1:te=2;break;case 2:te=3;break;case 128:te=4;break;default:te=1}var hf=null;Vc.Qa.ZB&&(hf=Vc.Qa.ZB.pj);Cc.SheetMultiRange=Xj.r(Vc.va.selectedRanges,this.$);Cc.ActiveCell=Xj.v(Vc.va.activeCell,this.$);Cc.ActiveChartId=hf;Cc.SelectionState=te;te=this.Ve.XY(F.DdaMethod.ControlId);Cc.InstanceId=
te?te.InstanceId:"";if(te&&te.PrimaryMarketplace){hf=jh.DdaFacade.getSolutionId(te,this.$);var ff=te.PrimaryMarketplace.MarketplaceType;if(ff===OSF.StoreType.InMemory){if(!te.OwnerAddinSolutionId){this.we.vf(C.a.Twb,fa);return}if(te.AssetMarketplace)ff=te.AssetMarketplace.MarketplaceType;else{this.we.vf(C.a.Twb,fa);return}}else ff===OSF.StoreType.WopiCatalog&&(ff=OSF.StoreType.OMEX);var lg=Telemetry.PrivacyRules.GetAssetId(ff,te.PrimaryMarketplace.MarketplaceRef,hf);Cc.CompliantSolutionId=lg;Cc.SolutionId=
hf;Cc.MarketplaceType=ff;Cc.SolutionVersion=te.PrimaryMarketplace.SolutionVersion;Cc.StoreLocation=te.PrimaryMarketplace.MarketplaceRef}else Cc.SolutionId=Cc.MarketplaceType="",Cc.CompliantSolutionId="";Cc.IsEventsEnabled=void 0===rd||null===rd||rd.dj.gZb(Cc.InstanceId);Cc.RequestGuid=bj.a.create().toString();rd=Cc.RequestBody.length;if(ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&rd>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.we.vf(C.a.X8i,fa);Re.ULS.sendTraceTag(537163213,
0,50,"Request payload size:{0} exceeded the limit",rd);return}ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Hd&4096&&(rd=new ca(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(rd,S,yb),Cc.RequestBody=yb[4])}var Og=d.b_e(Cc.RequestHeaders);d.RAd++;var lh=Hh.a.Ra.Kb;ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Cc&&Cc.RequestBody&&Re.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",
Cc.RequestBody.length));this.Ez.executeRichApiRequest(Cc,function(Ih){var Ah;Pa.HTf(lh,!0,Ih.ServerCorrelationId);var Uh=null,ii=null,ij=Ih.ServerCorrelationId;if(null===(Ah=null===Ih||void 0===Ih?void 0:Ih.Errors)||void 0===Ah?0:Ah[0])Uh=Ih.Errors[0].MessageIdName,ii=Ih.Errors[0].Description,ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&ol.a(Pa.$).nd.AD(Ih.Errors[0].MessageId);if(Ye.a(Ih)||!Ih.Result)Pa.UMa(ij,Og,"Server error",Uh,ii),Pa.we.JG(Ih,fa);else{var Ji=
null;if(ig.EwaSettings.la(259))if((Ah=Ih.Result)&&Ah.length){for(var tk=0;tk<Ah.length;tk++)if(Ah[tk].RequestGuid===Cc.RequestGuid){Ji=Ah[tk];break}Ji||Pa.we.JG(Ih,fa)}else Ji=Ih.Result;else Ji=Ih.Result;if(!Uh&&Ji&&Ji.ResponseBody&&Ji.ResponseBody[0])if(Ih=Ji.ResponseBody[0],Ih.startsWith('{"Error":')){1<Ji.ResponseBody.length&&(Ih=Ih.substring(0,Ih.indexOf("}")+1),Ih+="}");try{var Tj=wi.a.li(Ih);Tj.Error&&Pa.UMa(ij,Og,"Pipeline error",Tj.Error.Code,Tj.Error.Message)}catch(aj){Pa.UMa(ij,Og,"Json deserialize error",
null,"Error info cannot be deserialized.")}}else Pa.UMa(ij,Og);else Pa.UMa(ij,Og,"Server error",Uh,ii);var kk=(Tj=Ji.SheetMultiRange)?Tj.SheetName:null;Ih=Ji.ActiveChartId;var Uj=Ji.SelectionState;Uh=5===Uj&&!!Tj||6===Uj||7===Uj||8===Uj;if(ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Pa.$.Ab.XJ&&Uh)Pa.we.vf(C.a.mBc,fa),Re.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Uj.toString()));else if(5===Uj&&Tj){if(Pa.$.xa&&kk)if(Pa.$.xa.tj(kk))Pa.QRc(kk);
else{var ik=null;ik=function(){Pa.$.xa.tj(kk)&&(Re.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Pa.QRc(kk),Pa.$.xa.X$a(ik))};Pa.$.xa.FXa(ik);if(ig.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Kk=null;Kk=function(){Pa.$.xa.tj(kk)&&(Pa.QRc(kk),Pa.$.xa.dma(Kk))};Pa.$.xa.pga(Kk)}}}else if(6===Uj||7===Uj||8===Uj||9===Uj){if(Tj){var Wk=Xj.g(Tj.Ranges);if(kk&&Xj.cb(Wk,!0))if(ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!Pa.$.xa.tj(kk)){var Xk=null;Xk=function(){Pa.R$f(Vc,Wk,kk,Uj);Pa.$.xa.dma(Xk)};Pa.$.xa.pga(Xk)}else Pa.R$f(Vc,Wk,kk,Uj)}7===Uj?(Ih="38.{"+ml.c(Ih)+"}",gk.a(Pa.$).zma(0,Ih,!0)):8===Uj&&gk.a(Pa.$).zma(2,Ih,!0);9===Uj&&(Pa.$.ya.ApiCallToSetPageLayout=!0)}Ji.PostProcessActions?Pa.$.Jcf?(ij=wi.a.li(Ji.PostProcessActions),Pa.ASi(ij).then(function(){Pa.dbb(Ji,fa);Pa.e$c(F.DdaMethod.ControlId,Cc);return Promise.resolve(null)},function(aj){Pa.dbb(Ji,fa,aj);return Promise.reject(aj)})):(Pa.UMa(ij,Og,"Promise not supported",
null,"Promise is not supported on this browser."),Pa.we.vf(C.a.internalError,fa)):Pa.dbb(Ji,fa)}},function(Ih){Pa.HTf(lh,!1,null);Pa.UMa(null,Og,"Web service error");fa(Ih)})};d.prototype.e$c=function(F,fa){var Pa=Object(Wi.a)(jh.DdaFacade,Kj.a(this.$));(null===Pa||void 0===Pa?0:Pa.qJd)&&Pa.an(F)&&d.dpj(fa.RequestHeaders)&&(Re.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",F,fa.SolutionId),Pa.qJd.ghh(F))};
d.prototype.Mrh=function(F,fa){var Pa=this,yb=this.Ve.XY(F.DdaMethod.ControlId),Cc=jh.DdaFacade.getSolutionId(yb,this.$),Vc=null;Vc=jh.DdaFacade.nua(yb,this.$);Vc=new G(Vc,this.$);Vc=new c(Cc,F.DdaMethod.ControlId,this.Ve,this.$,Vc);var rd={ResponseHeaders:[]};rd.ResponseBody=Array(1);yb=d.cXe(F.ArrayData[3]);var Hd=d.b_e(yb);yb=new ma(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.bof);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Vc,Z,yb,F.ArrayData).then(function(te){if(!te)return Pa.osd(!1,
"The rich api executor call failed",Hd),Re.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),rd.ResponseStatusCode=500,Pa.dbb(rd,fa),null;Pa.osd(!0,"The rich api executor call succeeded",Hd);rd.ResponseStatusCode=te[0];rd.ResponseBody[0]=te[2];Pa.dbb(rd,fa);return null},function(te){rd.ResponseStatusCode=400;rd.ResponseBody[0]=te.toString();Pa.osd(!1,"The rich api executor call failed",Hd);Re.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",
Cc);Pa.dbb(rd,fa);return null})};d.prototype.HTf=function(F,fa,Pa){d.RAd--;F=gl.a(Hh.a.Ra,F);Re.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",F,d.RAd,fa?"success":"false",Pa)};d.prototype.dbb=function(F,fa,Pa){Pa=void 0===Pa?null:Pa;var yb=Array(3);yb[0]=F.ResponseStatusCode;yb[1]=d.gSh(F.ResponseHeaders);var Cc=[],Vc=!1;if(Pa&&F.ResponseBody){var rd=wi.a.li(F.ResponseBody.join(""));rd.Error||
(Vc={},Vc.Error=Pa,Vc.TraceIds=rd.TraceIds,Vc.ProcessedResults={},Vc.ProcessedResults.Results=rd.Results,Cc[0]=wi.a.Hc(Vc),Vc=!0)}yb[2]=Vc?Cc:F.ResponseBody;F=this.we.BP();F.Data=yb;fa(F)};d.prototype.dvd=function(F,fa){(new Q(this.$,this.we,this.Ez)).dvd(F,fa)};d.prototype.Esi=function(F,fa){Re.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Pa=F[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],yb=F[Gg.a.WTc],Cc=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];F=this.$.da.Aa(232).l0a.Fsi(F.DdaMethod.ControlId,
Pa,yb,Cc);F===C.a.success?this.we.Au(fa):(Re.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.we.vf(F,fa))};d.prototype.Asi=function(F,fa){Re.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Pa=F[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],yb=F[Gg.a.WTc],Cc=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).l0a.yfj(F.DdaMethod.ControlId,Pa,yb,Cc);this.we.Au(fa)};d.prototype.getAccessToken=function(F,fa){function Pa(Vc,rd){if(Vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Vc=
yb.we.BP(),Vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=rd.accessToken,fa(Vc);else{rd=yb.Ve.XY(F.DdaMethod.ControlId);var Hd=null!==rd.OwnerAddinSolutionId?rd.OwnerAddinSolutionId:rd.PrimaryMarketplace.MarketplaceType,te={};Re.ULS.sendTraceTag(537163202,0,10,"{0}.",(te.errorCode=Vc.toString(),te.appId=Telemetry.PrivacyRules.GetAssetId(Hd,rd.PrimaryMarketplace.MarketplaceRef,jh.DdaFacade.getSolutionId(rd,yb.$)),te.storeType=Hd,te));yb.we.vf(Vc,fa)}}var yb=this;Re.ULS.sendTraceTag(537163203,
0,50,"GetAccessToken API called!");var Cc=!ig.EwaSettings.la(24);Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(Vc){var rd=yb.Ve.Gi,Hd=na.getInstance();J.AppsForOfficeSingleSignOnManager.getInstance(rd,Vc.result,Hd).getAccessToken(F.DdaMethod.ControlId,Cc,F,Pa)},this.$.ma)};d.prototype.getAuthContext=function(F,fa){var Pa=this;Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(){var yb=Pa.Ve.Gi.getOsfControl(F.DdaMethod.ControlId);
if(!ig.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||yb.isFirstParty()){yb=yb.getManifest();var Cc=yb.getMarketplaceID(),Vc=yb.getWebApplicationId(),rd=yb.getWebApplicationMsaId();dh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Cc).then(function(Hd){var te=Pa.we.BP(),hf={};hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=rd||Vc;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Hd.upn;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Hd.userId;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Hd.authority;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Jd.iDh(Hd.authorityType);hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Hd.isAnonymous;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Hd.tenantId;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Hd.supportsAuthToken;
te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=hf;fa(te)},function(Hd){var te=Pa.we.BP(),hf={},ff=new Jd;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=rd||Vc;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ff.upn;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ff.userId;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ff.authority;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
ff.authorityType;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ff.isAnonymous;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ff.tenantId;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Hd;hf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ff.supportsAuthToken;te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=hf;te.Error=1;fa(te)})}},this.$.ma)};d.prototype.p$h=function(F){var fa=Rh.g(this.$).ha;return 16===
fa.Te&&!!fa.Qa.nc&&!!fa.Qa.nc.floatingObject&&Sj.a.equals(fa.Qa.nc.floatingObject.id,F,!0)};d.prototype.Zbd=function(F){var fa=Rh.g(this.$).ha;return fa.va.Dh?1===fa.Te||this.p$h(F)?fa.Lha:null:null};d.prototype.Qgc=function(F,fa){return 1!==F&&2!==F&&3!==F?(this.we.vf(C.a.vxe,fa),!1):!0};d.prototype.osd=function(F,fa,Pa){var yb={};yb.a=this.$.ya.UserSessionId;yb.b=F;yb.c=fa;yb.d=null;yb.e=Pa;Jj.b().Ne(37,yb)};d.prototype.UMa=function(F,fa,Pa,yb,Cc){Pa=void 0===Pa?null:Pa;yb=void 0===yb?null:yb;Cc=
void 0===Cc?null:Cc;var Vc={};F&&(Vc.ServerCorrelationId=F);void 0!==fa&&null!==fa&&(Vc.Source=fa);Pa&&(Vc.ErrorType=Pa);yb&&(Vc.MessageId=yb);Cc&&(Vc.StatusDescription=Cc);Re.ULS.sendTraceTag(50688452,0,50,wi.a.Hc(Vc))};d.prototype.ASi=function(F){for(var fa=new Promise(function(yb){yb(null)}),Pa=0;Pa<F.length;Pa++)fa=this.zSi(fa,F[Pa]);return fa};d.prototype.zSi=function(F,fa){var Pa=this;if(!fa)return Re.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),F.then(function(){return Promise.reject(d.d2a(B.generalException,
De.a.instance.ea(1708),null))});switch(fa.actionType){case 1:case 2:F=F.then(function(){var yb=Object(Wi.a)(jh.DdaFacade,Kj.a(Pa.$));if(yb.an(fa.controlId))switch(yb.dj.WWh(fa),fa.messageType){case 14:case 100:yb.pJd.CZb(fa);break;case 11:case 12:yb.Laj.tnb(fa);break;case 51:case 52:yb.Jaj.tnb(fa);break;case 2101:case 2102:yb.Kaj.tnb(fa);break;case 2E3:yb.Maj.CZb(fa);break;case 2201:Pa.$.gka&&yb.qJd.EHg(fa);break;case 2203:yb.Naj.FHg(fa);break;case 2700:ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
yb.oJd.CZb(fa)}else Re.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",fa.controlId);return Promise.resolve(null)});break;case 3:F=F.then(function(){Pa.KWh(fa);return Promise.resolve(null)});break;case 15:ig.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(F=F.then(function(){Pa.kYh(fa);return Promise.resolve(null)}));break;case 4:F=F.then(function(){if(ig.EwaSettings.la(104)){var yb=Rh.g(Pa.$).ha.va.activeCell;yb.top!==fa.row+1&&yb.left!==fa.column+
1&&(yb=Xj.v(ra.Range.ld(fa.row+1,fa.column+1),Pa.$),Rh.g(Pa.$).yi(yb,null,null,null,3,Gf.a.Z7g));Wj.a(Pa.$,243,242,0,function(Cc){Cc.BJb(fa.row+1,fa.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:F=F.then(function(){Object(Wi.a)(jh.DdaFacade,Kj.a(Pa.$)).dj.kIe(fa.controlId,fa.isEnableEvents);return Promise.resolve(null)});break;case 5:F=F.then(function(){return Pa.u6g(fa)});break;case 6:F=F.then(function(){return Pa.LNi(fa)});break;case 8:F=F.then(function(){ig.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(Wi.a)(jh.DdaFacade,Kj.a(Pa.$)).sTg();var yb=new jl.a(ll.a.Ck,5,null);hl.a(Pa.$).Rs(yb);return Promise.resolve(null)});break;case 9:F=F.then(function(){return Pa.ghj(fa)});break;case 10:F=F.then(function(){return Pa.JPj(fa)});break;case 11:F=F.then(function(){return Pa.IPj()});break;case 12:F=F.then(function(){return Pa.FPj()});break;case 13:F=F.then(function(){return Pa.GPj(fa)});break;case 14:F=F.then(function(){return Pa.HPj(fa)});break;case 16:F=F.then(function(){return Promise.resolve(fa)});
break;case 17:F=F.then(function(){return Pa.xdj(fa,Object(Wi.a)(jh.DdaFacade,Kj.a(Pa.$)))});break;case 18:Rh.g(this.$).focus();break;case 19:this.q2e(fa.entryType,!1,fa.options);break;case 20:this.q2e(fa.entryType,!0,fa.options);break;default:F=F.then(function(){return Promise.reject(d.d2a(B.YEg,De.a.instance.ea(1709),null))})}return F};d.prototype.kYh=function(F){var fa=Object(Wi.a)(jh.DdaFacade,Kj.a(this.$)).an(F.controlId);if(fa&&!(!F.operationType^!fa.Wca)){Rh.g(this.$).jgc=!0;switch(F.operationType){case 0:var Pa=
new Uk.a(document.createElement("input"));Pa.text=F.range;fa.m5h(Rh.g(this.$).Bh.P4g(Pa,new fl.a(this.$)));fa.Wca.startEdit(!0);break;case 1:fa.DLf();this.rangePicker=null;break;case 2:fa.Wca.gag(F.range);break;case 3:fa.Wca.gag(F.startingRange);fa=F.expandSelection;Pa=F.getNextDataRegionCell;var yb=0;switch(F.keyboardDirectionValue){case 2:yb=38;F=fa&&Pa?105288353:fa?-31900117:Pa?542791952:137938150;break;case 3:yb=40;F=fa&&Pa?-1297307319:fa?-1603798598:Pa?1713663844:-798660877;break;case 0:yb=37;
F=fa&&Pa?-403586027:fa?2039316657:Pa?-2012742350:-1470715894;break;case 1:yb=39;F=fa&&Pa?784916030:fa?589730764:Pa?1324884057:-1231471547;break;default:F=1461300262}fa=this.V2b("keydown",yb,fa,Pa);Rh.g(this.$).dHb(fa,new ak.a(F,1,0,8,null))}Rh.g(this.$).jgc=!1}};d.prototype.V2b=function(F,fa,Pa,yb){var Cc=document.createEvent("KeyboardEvent");if(uh.a.ME)Cc.initKeyboardEvent(F,!1,!1,window.self,"A",0,yb,!1,Pa,!1);else{var Vc="";Pa&&(Vc+="Shift");yb&&(Vc+=0<Vc.length?" Control":"Control");Cc.initKeyboardEvent(F,
!1,!1,window.self,"A",0,Vc,!1,"en-US")}F=new Sys.UI.DomEvent(Cc);F.keyCode=fa;return F};d.prototype.KWh=function(F){switch(F.operationType){case 1:Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1),function(fa){fa.result.lId()},this.$.ma,3);break;case 2:if(F=Object(Wi.a)(jh.DdaFacade,Kj.a(this.$)).an(F.controlId))F.nnd=!0,F.cGf()}};d.prototype.u6g=function(F){var fa=this,Pa=F.fileBase64;return Pa&&Pa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(d.d2a(B.invalidArgument,
De.a.instance.ea(1712),"Application.CreateWorkbook")):(new Promise(function(yb,Cc){var Vc=new Ub.StandardDialog;Vc.kc=4;Vc.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(rd){2!==rd&&rd||Cc(d.d2a(B.Yzd,De.a.instance.ea(1711),"Application.CreateWorkbook"));rd=new xa("blank","agave",Pa?"streamBase64":"streamEmpty",Pa);fa.bof.create(yb,Cc,rd).y_a()})})).then(function(yb){fa.A7b.set(F.fakeFileId,yb);return Promise.resolve(null)},function(yb){return yb?
Promise.reject(yb):Promise.reject(d.d2a(B.generalException,De.a.instance.ea(1708),"Application.CreateWorkbook"))})};d.prototype.LNi=function(F){var fa=this;return new Promise(function(Pa,yb){if(fa.A7b.has(F.fakeFileId)){var Cc=fa.A7b.get(F.fakeFileId);yb=new Ub.StandardDialog;yb.kc=4;yb.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Vc){1===Vc&&zh.HelperMethods.sf(Cc,void 0,void 0,"DdaMethodHandler.fileUrl");Pa(null)})}else yb(d.d2a(B.generalException,
De.a.instance.ea(1708),"Document.Open"))})};d.prototype.ghj=function(F){var fa=this;return new Promise(function(Pa){Object(Wi.a)(jh.DdaFacade,Kj.a(fa.$)).oQf=F.runtimeCalculationMode;var yb=fa.$.da.Aa(268);yb&&yb.dwd(3===F.runtimeCalculationMode);Pa(null)})};d.prototype.JPj=function(F){Of.a.Ryb(this.$)&&this.$.da.Aa(331).ebb(0,F.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.IPj=function(){Of.a.Ryb(this.$)&&this.$.da.Aa(331).ebb(1,null,!0,!0,null);return Promise.resolve(null)};d.prototype.FPj=
function(){Of.a.Ryb(this.$)&&this.$.da.Aa(331).hIe();return Promise.resolve(null)};d.prototype.GPj=function(F){Of.a.Ryb(this.$)&&this.$.da.Aa(331).ebb(5,F.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.HPj=function(F){if(Of.a.Ryb(this.$)){var fa=this.$.da.Aa(331);fa=yl(fa.J$);for(var Pa=fa.next();!Pa.done;Pa=fa.next())Pa=Pa.value,Pa.IsActive&&Pa.HostEditUrl&&Pa.UrlStr===F.hostEditUrlStr&&zh.HelperMethods.sf(Pa.HostEditUrl,"_blank")}return Promise.resolve(null)};d.prototype.xdj=function(F,
fa){var Pa=M.a.uW;F=wi.a.li(F.payload);var yb={};"eventId"in F&&"payload"in F&&(yb.eventId=F.eventId,yb.payload=F.payload);fa.jM(2201,Pa,wi.a.Hc(yb));return Promise.resolve(null)};d.prototype.q2e=function(F,fa,Pa){var yb=this.$.da.Aa(5);yb&&(F=this.ZDh(F))&&(fa?yb.removeEntry(F):yb.zje(F,Pa))};d.prototype.ZDh=function(F){switch(F){case 0:return 63}};d.prototype.QRc=function(F){F=Object(Wi.a)(kl.a,this.$.xa.getItemByName(F));(null===F||void 0===F?0:F.visible)&&F.activate(!0)};d.prototype.R$f=function(F,
fa,Pa,yb){var Cc=F.va.wA,Vc=Cc<fa.length&&fa[Cc].contains(F.va.activeCell);F=Vc?F.va.activeCell:fa[0].topLeft;Cc=Vc?Cc:0;Rh.g(this.$).OU(fa,Cc,Pa,null,F,null,null,3,Gf.a.$7g,void 0,void 0,void 0,6===yb)};d.cXe=function(F){if(!F||!F.length)return null;for(var fa=Array(F.length/2),Pa=0;Pa<F.length/2;Pa++)fa[Pa]={},fa[Pa].Name=F[2*Pa],fa[Pa].Value=F[2*Pa+1];return fa};d.gSh=function(F){if(!F||!F.length)return null;for(var fa=Array(2*F.length),Pa=0;Pa<F.length;Pa++)fa[2*Pa]=F[Pa].Name,fa[2*Pa+1]=F[Pa].Value;
return fa};d.r$c=function(F){if(!F||!F.length)return null;for(var fa=Array(F.length),Pa=0,yb=F.length;Pa<yb;Pa++){var Cc=F[Pa].length;if(Cc){fa[Pa]=Array(Cc);for(var Vc=0;Vc<Cc;Vc++)fa[Pa][Vc]=null==F[Pa][Vc]?null:F[Pa][Vc].toString()}else return null}return fa};d.l1b=function(F){return"string"===typeof F?bl.a.Jn(d.V7g,F,0):F};d.fQe=function(F){return"string"===typeof F?bl.a.Jn(d.Y7g,F,0):F};d.pbg=function(F){return"string"===typeof F?bl.a.Jn(d.b8g,F,0):F};d.z$h=function(F){switch(F.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
d.XWc=function(F,fa){var Pa={};Pa.CoerceType=F;1===Pa.CoerceType?(Pa.Data=d.r$c(fa.Rows),Pa.Headers=d.r$c(fa.Headers)):Pa.Data=d.r$c(fa);return Pa};d.Qre=function(F){if(1===F.CoerceType){var fa={};return fa.Headers=F.Headers,fa.Rows=F.Data,fa}return F.Data};d.Zdc=function(F){return 1===F.CoerceType?!F.Data&&!F.Headers:!F.Data};d.b_e=function(F){var fa="Unknown";if(!F)return fa;for(var Pa=0;Pa<F.length;Pa++)if(F[Pa].Name.toLowerCase()===vj.a.Oaj){fa=F[Pa].Value;break}return fa};d.dpj=function(F){if(!F)return!1;
for(var fa=vj.a.Rxi.toLowerCase(),Pa=0;Pa<F.length;Pa++)if(F[Pa].Name.toLowerCase()===fa)return!0;return!1};d.d2a=function(F,fa,Pa){var yb={};yb.Code=F;yb.Message=fa;yb.Location=Pa;yb.ActionIndex=0;return yb};tl.Object.defineProperties(d.prototype,{ZP:{configurable:!0,enumerable:!0,get:function(){return this.we}}});tl.Object.defineProperties(d,{V7g:{configurable:!0,enumerable:!0,get:function(){d.Woa||(d.Woa={},d.Woa[Microsoft.Office.WebExtension.CoercionType.Table]=1,d.Woa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,d.Woa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,d.Woa[Microsoft.Office.WebExtension.CoercionType.Html]=4,d.Woa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return d.Woa}},Y7g:{configurable:!0,enumerable:!0,get:function(){d.xgb||(d.xgb={},d.xgb[Microsoft.Office.WebExtension.FilterType.All]=1,d.xgb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return d.xgb}},b8g:{configurable:!0,enumerable:!0,get:function(){d.ygb||(d.ygb={},d.ygb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,d.ygb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return d.ygb}}});d.Woa=null;d.xgb=null;d.ygb=null;d.RAd=0;Object(ae.a)(d,"DdaMethodHandler",null,[147,3]);var Vk=Ad.a;vm(a,Vk);a.prototype.Md=function(){var F=this,fa=Zi.GetServiceTaskFactory.create(this.$.da,106,this.ma,this.tb),Pa=Zi.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb),yb=fb(this.ma,this.tb);Vg.TaskExtensions.Ba(Vg.TaskExtensions.ve([fa,Pa,yb],this.ma),function(){var Vc=fa.result,rd=dh.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
F.Ed([new d(F.$,Vc,rd)])},this.ma,3);var Cc=dh.a.instance;Vg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,this.tb),function(){Cc.register(lb,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").zc().Ic(function(){return new lb})},this.$.ma)};a.ja=function(F){Ad.a.de(82,new a(F))};Object(ae.a)(a,"DdaCommandHandlerFactory",Ad.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");Kg.a.Yi("");Kg.a.Yi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ug.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");
tb.main();(function(){uj.a.Ga(function(F){qg.ja(F)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){uj.a.Ga(function(F){Zf.ja(F);Qc.ja(F)})})();(function(){uj.a.Ga(function(F){sf.ja(F)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){uj.a.Ga(function(F){ig.EwaSettings.la(53)&&E.ja(F)})})();(function(){uj.a.Ga(function(F){ig.EwaSettings.la(121)&&vb.ja(F)})})();uj.a.Ga(pb.ja);uj.a.Ga(vd.ja);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(function(){uj.a.Ga(function(F){Da.ja(F);za.ja(F)})})();uj.a.Ga(a.ja)},1417:function(y,D,b){function a(){this.DCc=null;this.kHc=0;this.RIc=!1;this.Ya=new k.a;this.Ylg=new c.a}function d(){this.hHe=this.displayName=this.Hpb=this.nl=this.Ps=null;this.isUpgraded=!1}y=b(0);var c=b(185),k=b(94),n=b(5);d.prototype.tdf=function(l,f){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?this.Ps.getStoreType().toLowerCase()===
l.toLowerCase()&&this.Ps.getSolutionId().toLowerCase()===f.toLowerCase():this.Ps.getStoreType().toLowerCase()===l.toLowerCase()&&this.Ps.getMarketplaceID().toLowerCase()===f.toLowerCase()};Object(y.a)(d,"AddinCommandsResourceItem",null,[]);b.d(D,"a",function(){return a});a.prototype.dzg=function(l){this.Ya.addHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.D3i=function(l){this.Ya.removeHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.Ebb=function(l){l!==this.DCc&&(this.DCc=
l,this.Ya.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.chj=function(){this.kHc++;this.PXa||this.Ebb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.euc=function(){this.kHc--;this.Ird()&&(this.RIc?this.PXa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Ebb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Ebb(null))};a.prototype.ZLd=function(l){this.RIc=!0;this.Ebb((void 0===l?0:l)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};
a.prototype.Rve=function(){this.RIc=!1;this.Ird()?this.Ebb(null):this.Ebb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Ird=function(){return 0>=this.kHc};a.prototype.K3=function(l,f,u){u=void 0===u?0:u;for(var v=yl(this.TKa),m=v.next();!m.done;m=v.next())if(m=m.value,m.tdf(l,f)&&(!m.nl||m.nl.FBh===u))return m;return null};a.prototype.tje=function(l,f,u,v){var m=new d;m.Ps=l;m.nl=f;m.Hpb=u;m.displayName=v;this.TKa.add(m)};a.prototype.jxg=function(l,f,u,v){var m=new d;m.Ps=l;m.nl=f;m.Hpb=null;
m.hHe=u;m.displayName=v;this.TKa.add(m)};a.prototype.UKf=function(l,f){for(var u=0,v=yl(this.TKa),m=v.next();!m.done;m=v.next())m=m.value,n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?m.Ps.getStoreType()===l&&m.Ps.getSolutionId()===f?this.TKa.removeAt(u):u++:m.Ps.getStoreType()===l&&m.Ps.getMarketplaceID()===f?this.TKa.removeAt(u):u++};a.getInstance=function(){a.Na||(a.Na=new a);return a.Na};tl.Object.defineProperties(a.prototype,{PXa:{configurable:!0,
enumerable:!0,get:function(){return this.DCc}},TKa:{configurable:!0,enumerable:!0,get:function(){return this.Ylg}}});a.Na=null;Object(y.a)(a,"AddinCommandsResourceManager",null,[])},858:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);var d=b(32);a.sSe=function(c){return d.a.Jn(a.Csi,c.toString(),a.internalError)};tl.Object.defineProperties(a,{Csi:{configurable:!0,enumerable:!0,get:function(){var c={};return a.x9d||(a.x9d=(c["-2002156328"]=a.vxe,c["-1954750170"]=a.v_e,c["317650254"]=
a.iVg,c["-1005263101"]=a.r7h,c["1353664579"]=a.Rej,c["159671765"]=a.s7h,c["1446690022"]=a.GVe,c["1150069548"]=a.jzc,c["-1409306331"]=a.iue,c["338507772"]=a.hDe,c["-457159301"]=a.FOi,c["-1037701970"]=a.u7g,c["-1893322318"]=a.x7h,c["965579896"]=a.w7g,c["93287890"]=a.v7g,c["358088857"]=a.Ohj,c["-1223650923"]=a.hDe,c["2007306190"]=a.hRg,c["1549955423"]=a.Wqe,c["-1275974171"]=a.w7h,c["382101082"]=a.ONi,c["-898776235"]=a.pui,c["335464256"]=a.eui,c["1677378049"]=a.v7h,c["-261992848"]=a.TGj,c["-980820954"]=
a.Wqe,c["-931375837"]=a.NNi,c["929186550"]=a.Eeh,c["-982144310"]=a.xVi,c["-785741187"]=a.p7h,c["2125217573"]=a.z7h,c["299124955"]=a.q7h,c["1669853884"]=a.abj,c["-1515932330"]=a.jVg,c["314621024"]=a.eyh,c["-300049690"]=a.lRg,c["14766835"]=a.Wmj,c["-1251992761"]=a.nGe,c["-2087635043"]=a.invalidOrTimedOutSession,c["2100961153"]=a.invalidOrTimedOutSession,c["-1218744139"]=a.invalidSheetName,c["-1468309555"]=5006,c["-315732528"]=a.invalidOrTimedOutSession,c["611268539"]=a.invalidOrTimedOutSession,c["1531005923"]=
5006,c["1593924569"]=5006,c["299476328"]=a.PEa,c["49173765"]=a.PEa,c["-907155566"]=a.PEa,c["-1201603824"]=a.PEa,c["1541165282"]=a.PEa,c["-1347753427"]=a.PEa,c["134912532"]=a.PEa,c["1780971550"]=a.responsePayloadSizeLimitExceeded,c))}}});a.success=0;a.vxe=1E3;a.v_e=1001;a.iVg=1002;a.r7h=1003;a.Rej=1004;a.s7h=1005;a.GVe=1008;a.TPe=1009;a.invalidSheetName=1014;a.jzc=2E3;a.iue=2001;a.hDe=2002;a.FOi=2003;a.u7g=2004;a.x7h=2005;a.w7g=2007;a.v7g=2008;a.Ohj=2009;a.hRg=2014;a.yej=3E3;a.Wqe=3002;a.w7h=3004;
a.ONi=3005;a.pui=3006;a.eui=3007;a.v7h=3008;a.TGj=3009;a.NNi=3010;a.Wmj=4002;a.aAd=5E3;a.internalError=5001;a.nGe=5002;a.Twb=5004;a.SHj=5007;a.n2h=5008;a.SKg=5009;a.invalidOrTimedOutSession=5012;a.mBc=5016;a.PEa=5102;a.X8i=5103;a.responsePayloadSizeLimitExceeded=5104;a.AQg=7001;a.w1f=7002;a.Eeh=8E3;a.xVi=8001;a.p7h=8010;a.z7h=8011;a.q7h=8012;a.abj=8020;a.jVg=8021;a.eyh=8022;a.lRg=8023;a.Xri=11E3;a.evi=11001;a.y7h=11002;a.x9d=null;Object(y.a)(a,"DdaErrorIds",null,[])},859:function(y,D,b){function a(){}
b.d(D,"a",function(){return a});y=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.sRc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.Yzd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.VHj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.hDg="AddinIsAlreadyRequestingToken";a.x$i="ResourceNotAllowed";
a.clientError="ClientError";a.serverError="ServerError";a.PYg="ControlIdNotFound";a.oaj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(y.a)(a,"ErrorCodes",null,[])},861:function(y,D,b){function a(cb,nc){var Nc=ye.call(this)||this;Nc.fa=null;Nc.Ml=null;Nc.Uh=null;Nc.Cf=[];Nc.hIa=null;Nc.OCe=!1;Nc.uNb=!1;Nc.initialized=!1;Nc.disposed=!1;Nc.rBa=null;Nc.inc=[];Nc.JCe=[];
Nc.yOa=[];Nc.$_a=null;Nc.bBd=new Pc.a(vd.a.Ik());Nc.fYb=new Tc.a(vd.a.Ik());Nc.ZDb=[];Nc.jDf=[];Nc.k4b=350;Nc.vea=null;Nc.Fwa=null;Nc.cRc=!1;Nc.Hce=null;Nc.Ece=null;Nc.Ice=null;Nc.Gce=null;Nc.Kce=null;Nc.yqg=null;Nc.Fce=null;Nc.Jce=null;Nc.Lce=null;Nc.Mce=null;Nc.Nce=null;Nc.Kf=function(){Nc.rBa=Nc.fa.yn.WebExtensions;for(var Rc=Nc.Cf.length-1;0<=Rc;--Rc){var Wc=Nc.Cf[Rc],fe;if(fe=!Nc.Tvh(Wc.controlId))fe=Wc,fe=$a.EwaSettings.la(121)?!fe.rHa:!0;fe&&(Wc.jlc(),Array.removeAt(Nc.Cf,Rc))}if(Nc.rBa)for(Rc=
0,Wc=Nc.rBa.length;Rc<Wc;Rc++){fe=Nc.rBa[Rc];var ve=Nc.an(fe.WebExtensionId);ve&&ve.Iyd(fe)}};Nc.wla=function(Rc){Nc.raiseEvent("csc",Rc.getID())};Nc.Vwf=function(Rc,Wc,fe){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Wc===OSF.AgaveHostAction.KeyboardShortcuts){var ve=Object(rb.a)(Object,fe);Wc={};Wc.keyCode=ve.keyCode;Wc.type="keydown";Wc.ctrlKey=ve.ctrlKey;Wc.shiftKey=ve.shiftKey;Wc.altKey=ve.altKey;Wc.metaKey=ve.metaKey;Rc=Nc.an(Rc);ve=Rc.Ega;Wc.srcElement=
Object(eb.a)(203,ve)?ve.qFa:Yb.g(Nc.$).Jb;Wc=new Sys.UI.DomEvent(Wc);Rc={focusedAddinId:a.nua(Rc.cl,Nc.$)};ve=new Ac.a(1461300262,1,Nc.$.ed,6,null);Yb.g(Nc.$).dHb(Wc,ve,Rc)}else if(Wc===OSF.AgaveHostAction.Select)Nc.n2e(!0);else if(Wc===OSF.AgaveHostAction.UnSelect)Nc.n2e(!1);else if(Wc===OSF.AgaveHostAction.CancelDialog)Nc.LJ(-684355545,null);else if(Wc===OSF.AgaveHostAction.InsertAgave)Rc={},fe&&(Rc[Ja.a.OXa]=fe,Rc[bb.a.Kg]=a.lqb(fe),Nc.LJ(-741808261,Rc));else if(Wc===OSF.AgaveHostAction.InsertDevManifest)Rc=
{},fe&&(Rc[Ja.a.OXa]=fe,Rc[bb.a.Kg]=a.lqb(fe),Nc.LJ(-741808261,Rc));else if(Wc===OSF.AgaveHostAction.InsertDevManifestError)Rc=Object(rb.a)(Object,fe),Wc={},Rc=(Wc[Ja.a.VTc]=Nc.Ml.getDevManifestInvalidUrlErrorString(Rc.manifestUrl),Wc),Nc.LJ(-2025863019,Rc);else if(Wc===OSF.AgaveHostAction.NotifyHostError)Rc={},Rc=(Rc[Ja.a.VTc]=Nc.Ml.getManifestInvaildErrorString(),Rc),Nc.LJ(-2025863019,Rc);else if(Wc===OSF.AgaveHostAction.RefreshAddinCommands)$a.EwaSettings.la(53)&&Nc.LJ(Bc.a.refreshAddinCommands,
null);else if(Wc===OSF.AgaveHostAction.CtrlF6Exit||Wc===OSF.AgaveHostAction.CtrlF6ExitShift){if(ve=Nc.$.da.Aa(15)){(Rc=Nc.an(Rc).Ega)&&Rc.Vwc();Gb.a.zf&&document.activeElement.blur();var kc={keyCode:117,type:"keydown",ctrlKey:!0};kc.shiftKey=Wc===OSF.AgaveHostAction.CtrlF6ExitShift;kc.srcElement=Object(eb.a)(203,Rc)?Rc.qFa:Yb.g(Nc.$).Jb;Rc=new Sys.UI.DomEvent(kc);ve.IV(Rc)}}else if(Wc===OSF.AgaveHostAction.PageIsReady){if((Rc=Nc.an(Rc).Ega)&&Rc.VXa===OSF.OsfControlTarget.TaskPane&&(Rc=Nc.$.da.Aa(183))&&
Nc.Cf)for(Wc=Hc.a.Gd(Nc.$),ve=yl(Nc.Cf),kc=ve.next();!kc.done;kc=ve.next())a.nLa(kc.value.VT)&&(Wc?Rc.Qe(!0,!1):Rc.setFocusOnToolbarFirstElement())}else if(Wc===OSF.AgaveHostAction.TabExit){Wc=Nc.an(Rc);var ad=Wc.Ega;if(ad)if(ad.VXa===OSF.OsfControlTarget.InContent)ad.Lff();else{if(ad.VXa===OSF.OsfControlTarget.TaskPane)if(Hc.a.Gd(Nc.$))Gb.a.zf&&document.activeElement.blur(),wb.UISurfaces.Hk().then(function(pe){var bf=Object(eb.a)(203,ad)?ad:null;bf?bf.isResizable?pe.focusResizeHandle():pe.focusTabbedTaskPaneArea():
pe.focusTabbedTaskPaneArea();return null});else if(Rc=Nc.$.da.Aa(183))Gb.a.zf&&document.activeElement.blur(),(Wc=document.getElementById(Nc.$.Ib+rc.a.wkc))&&bd.DOMElementExtensions.isVisible(Wc)?bd.DOMElementExtensions.setFocus(Wc):Rc.setFocusOnToolbarFirstElement()}else Wc&&4===Wc.osfControlType&&Nc.Ml.notifyAgave(Rc,OSF.AgaveHostAction.TabIn)}else if(Wc===OSF.AgaveHostAction.TabExitShift)(Wc=Nc.an(Rc),ve=Wc.Ega)?ve.VXa===OSF.OsfControlTarget.InContent?ve.Mff():ve.VXa===OSF.OsfControlTarget.TaskPane&&
(Rc=Object(eb.a)(203,ve)?ve:null)&&(Gb.a.zf&&document.activeElement.blur(),Rc.sVf()):Wc&&4===Wc.osfControlType&&Nc.Ml.notifyAgave(Rc,OSF.AgaveHostAction.TabIn);else if(Wc===OSF.AgaveHostAction.EscExit||Wc===OSF.AgaveHostAction.ExitNoFocusable||Wc===OSF.AgaveHostAction.ExitNoFocusableShift)if(ve=Nc.an(Rc).Ega)ve.Vwc();else{if(Wc===OSF.AgaveHostAction.EscExit){Wc=null;ve=yl(ba.RUh());for(kc=ve.next();!kc.done;kc=ve.next())if(kc=kc.value,kc.value.Me===Rc){kc.value.dialog.hide();Wc=kc.key;break}Wc&&(Rc=
Nc.an(Wc))&&4!==Rc.osfControlType&&Nc.Gi.notifyAgave(Wc,OSF.AgaveHostAction.TabIn)}}else if(Wc===OSF.AgaveHostAction.InstallCustomFunctions)if($a.EwaSettings.la(121)){sc.a(Nc.$).SRe(function(){return!1});var yd=Nc.$.da;uc.TaskExtensions.Ba($b.GetServiceTaskFactory.Xa(yd,278,279,1),function(pe){pe=pe.result;yd.Aa(278)||yd.Ha(278,pe);var bf=fe.osfControl.getStoreType();pe.C8e(fe.osfControl.getSolutionId(),bf,a.EGh(fe.osfControl),fe).tma()},Nc.ma,3)}else zb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");
else if(Wc===OSF.AgaveHostAction.UninstallCustomFunctions)if($a.EwaSettings.la(121)){sc.a(Nc.$).SRe(function(){return!1});var wd=Nc.$.da;uc.TaskExtensions.Ba($b.GetServiceTaskFactory.Xa(wd,278,279,1),function(pe){pe=pe.result;wd.Aa(278)||wd.Ha(278,pe);pe.l8f(fe.solutionId,fe.storeType).tma()},Nc.ma,3)}else zb.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Wc===OSF.AgaveHostAction.SendTelemetryEvent?c(fe):Wc===
OSF.AgaveHostAction.SendCustomerContent?d(fe):Wc===OSF.AgaveHostAction.LaunchExtensionComponent?Ya.a.instance.xji(fe):Wc===OSF.AgaveHostAction.RefreshRibbonGallery?(Rc=Nc.$.da.Aa(352))&&Rc.Ebc(fe):Wc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Nc.f3i(fe.assetId),Hc.a.Gd(Nc.$)||(Rc=Nc.$.da.Aa(183))&&Rc.ap()):Wc===OSF.AgaveHostAction.GetOriginalControlId&&(Rc=new Sa.a(Nc.$.Ib,fe.ownerAssetId,new vb.a,!0),fe.originalControlId=Rc?Rc.$Ce(fe.controlId):fe.controlId)};Nc.EMi=function(){Nc.$.oa&&Xc.p(Nc.$.oa)&&
Nc.$.da.Aa(34).Jjd()};Nc.od=function(){Nc.Lhf()};Nc.bR=function(Rc,Wc){var fe,ve;1===Wc.Wx&&(Rc=Wc.Sg)&&(Wc=new n(xg.toTimestamp(Rc.enqueueUtcTime),xg.toTimestamp(Rc.processUtcTime),xg.toTimestamp(Rc.dequeueUtcTime),xg.getElapsedMilliseconds(Rc.enqueueUtcTime,Rc.processUtcTime),xg.getElapsedMilliseconds(Rc.processUtcTime,Rc.dequeueUtcTime),Rc.operationCount,(null===(ve=null===(fe=Rc.operation)||void 0===fe?void 0:fe.yd)||void 0===ve?0:ve.ServerCorrelationId)?Rc.operation.yd.ServerCorrelationId:null,
Rc.operation?Enum.toString(Ig.a,Rc.operation.operationName):null,le.a.eH(xg.getElapsedMilliseconds(Rc.enqueueUtcTime,Sc.a.Ra.Kb))),fe=Sys.Serialization.JavaScriptSerializer.serialize(Wc),zb.ULS.sendTraceTag(50872916,0,50,fe))};Nc.Zc=function(Rc,Wc){!Nc.fa.oc&&je.a(Wc)?(Array.forEach(Nc.Cf,Nc.Gsf),Array.clear(Nc.Cf),Nc.uNb=!1):(Wc.aH&&(zb.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),Nc.rPf()),Nc.GK(),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(Nc.uNb=!1))};Nc.vq=function(){$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(zb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Nc.rPf());Nc.GK();$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Nc.uNb=!1)};Nc.Gsf=function(Rc){Rc.jlc();Nc.raiseEvent("cd",Rc.controlId)};Nc.vb=cb;Nc.oUc=nc;Nc.initialize();W.ja(Nc);Nc.oQf=0;(cb=(cb=!(Gb.a.Pr||Gb.a.fwa))&&(!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!Gb.a.zf))&&OfficeExt.ShortcutKeyDispatchManager.init();Nc.Zlg={};return Nc}function d(cb){gd.a.sendOtelCustomerContent(Object.assign(new xd.a,{otelEvent:cb}))}function c(cb){gd.a.sendOtelEvent(Object.assign(new xd.a,{otelEvent:cb}))}function k(cb,nc,Nc){var Rc=nd.call(this,Nc,cb)||this;Rc.hashCode=null;Rc.Xua=null;Rc.a2b=!1;Rc.Hm=function(Wc,fe){fe.$c.hash===Rc.hashCode&&Rc.Xua&&Object(rb.a)(b(861).DdaFacade,Rc.$.da.Aa(35)).ssj(Rc.Xua.InstanceId)};Rc.Pe=function(Wc,fe){switch(fe.$c.block.state){case 1:case 3:case 5:Rc.Qma(fe)}};
Rc.Hg=function(){Rc.ZEb(!0)};Rc.ko=function(Wc,fe){Rc.isVisible&&Rc.CSa(fe.xK);Rc.clearCache()};Rc.Oe=function(Wc,fe){Rc.KRa(fe.oa,!!fe.xK)};Rc.iN=function(){Rc.$.fa.Ala()};Rc.kTa=nc;Rc.domElement.classList.add(Cb.a.Y6b);Rc.domElement.classList.add(Bb.a.Ir);Nc.tabIndex=0;Rc.KRa(Rc.$.oa,!1);Rc.wc.ja("mousedown",Rc.iN);Rc.wc.ja("contextmenu",function(Wc){Xd.g(Wc)});Rc.$.xa.aJ(Rc.ko);Rc.$.xb.aJ(Rc.ko);Rc.$.xb.Pf(Rc.Oe);Rc.$.xa.Pf(Rc.Oe);Rc.Ca.gq(Rc.Pe);Rc.Ca.gG(Rc.Hm);Rc.Ca.np(Rc.Hg);$a.EwaSettings.tc()&&
Rc.Nq(Rc.Kxa);return Rc}function n(cb,nc,Nc,Rc,Wc,fe,ve,kc,ad){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=cb;this.processUtcTime=nc;this.dequeueUtcTime=Nc;this.inQueueDurationInMS=Rc;this.executionDurationInMS=Wc;this.operationCount=fe;this.ServerCorrelationId=ve;this.UserOperationName=kc;this.IsDocumentHidden=
ad}function l(cb,nc,Nc){this.$=cb;this.dj=nc;this.runtimeCalculationMode=Nc}function f(){}function u(cb,nc,Nc){var Rc=this;this.TBf=null;this.d$c=function(Wc,fe){var ve=cc.a.uW,kc={};kc.eventId=Wc;kc.payload=fe;Rc.dj.BZ(2201,ve)&&Rc.Uh.jM(2201,ve,Ie.a.Hc(kc))};this.$=cb;this.dj=nc;this.Uh=Nc;this.R4h()}function v(cb,nc,Nc){var Rc=this;this.IFb=0;this.Gcg=!0;this.A8b=0;this.$nd=!0;this.uve=function(){var Wc=document.hasFocus();if(Rc.Gcg!==Wc){if(Wc){var fe=Ie.a.Hc({});Rc.Uh.jM(2203,cc.a.uW,fe)}Rc.Gcg=
Wc}};this.vve=function(Wc){(0<Wc.timeRemaining()||Wc.didTimeout)&&Rc.uve();window.requestIdleCallback(Rc.vve)};this.$=cb;this.dj=nc;this.Uh=Nc;window.requestIdleCallback||(this.$nd=!1)}function m(cb,nc,Nc){var Rc=this;this.HFb=0;this.J9a=this.Q9a=null;this.cBf=function(){var Wc=Yb.g(Rc.$).ha.Qa.ZB;if(Wc)if(Rc.Vef(Wc)){var fe=Rc.Ria();Rc.f$c(fe);Rc.Q9a=Wc.floatingObject.id;Rc.J9a=fe}else Rc.Q9a&&(Rc.f$c(Rc.J9a),Rc.Q9a=null,Rc.J9a=null);else Rc.Q9a&&(Rc.f$c(Rc.J9a),Rc.Q9a=null,Rc.J9a=null)};this.$=
cb;this.dj=nc;this.Uh=Nc}function A(cb,nc,Nc){var Rc=this;this.b1b=null;this.Lgc=!1;this.onPointerDown=function(Wc){var fe;Rc.dbi?3===Wc.zb?(function(){var ve=Rc.gridView.I9b(Wc.clientPoint);fe=ve.oGa;return ve}(),Rc.Lgc=!!fe&&Rc.gridView.ha.va.x5c(fe)):Rc.Lgc=!1:(function(){var ve=Rc.gridView.I9b(Wc.clientPoint);fe=ve.oGa;return ve}(),Rc.Lgc=3===Wc.zb&&!!fe&&Rc.gridView.ha.va.x5c(fe));Rc.b1b=Wc.clientPoint;return!1};this.Vc=function(Wc){if(Rc.gridView.inRangePicker||Rc.gridView.zi||Rc.Lgc||Wc.shiftKey||
Wc.ctrlKey||Wc.Ea.button||!Rc.b1b||!Wc.clientPoint||Wc.clientPoint.x!==Rc.b1b.x||Wc.clientPoint.y!==Rc.b1b.y)return!1;var fe=Rc.gridView.I9b(Wc.clientPoint);Wc=fe.oGa;fe=fe.returnValue;var ve=Object(rb.a)(ee.a,Rc.$.xa.oa);if(fe&&ve&&!ve.$H){if(!Rc.gridView.ha.va.T3.contains(Wc))return!1;Wc=new x(ve,Wc,Kd.HelperMethods.kBd(fe.x),Kd.HelperMethods.kBd(fe.y));Rc.$Mi(Wc)}return!1};this.$=cb;this.gridView=Yb.g(cb);this.dj=nc;this.Uh=Nc;this.dbi=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetCellOffSetPointFromEventPointOptimization",
!1);this.E1i()}function x(cb,nc,Nc,Rc){var Wc=wc.call(this)||this;Wc.sheet=cb;Wc.eRg=nc;Wc.offsetX=Nc;Wc.offsetY=Rc;return Wc}function t(cb,nc,Nc){var Rc=this;this.FKf=this.EKf=this.GKf=this.DKf=0;this.WMi=function(Wc,fe){Wc=Object(rb.a)(ee.a,fe.oa);Rc.l6a(Wc)&&(fe={},fe.worksheetId=Wc.sheetId,fe=Ie.a.Hc(fe),Rc.wia(11,Wc.sheetId,fe))};this.ZMi=function(Wc,fe){Wc=Object(rb.a)(ee.a,fe.xK);Rc.l6a(Wc)&&(fe={},fe.worksheetId=Wc.sheetId,fe=Ie.a.Hc(fe),Rc.wia(12,Wc.sheetId,fe))};this.XMi=function(Wc,fe){Wc=
Object(rb.a)(ee.a,fe.oa);Rc.l6a(Wc)&&(fe={},fe.worksheetId=Wc.sheetId,Wc=Ie.a.Hc(fe),Rc.wia(11,null,Wc,!0))};this.YMi=function(Wc,fe){Wc=Object(rb.a)(ee.a,fe.xK);Rc.l6a(Wc)&&(fe={},fe.worksheetId=Wc.sheetId,Wc=Ie.a.Hc(fe),Rc.wia(12,null,Wc,!0))};this.$=cb;this.dj=nc;this.Uh=Nc}function z(cb,nc,Nc){var Rc=this;this.sPa=this.rPa=0;this.ZFa=this.Zga=null;this.Stf=function(){var Wc=Yb.g(Rc.$).ha.Qa.ZB;if(0<Rc.sPa&&Rc.Zga&&Rc.ZFa){var fe={};fe.shapeId=Rc.Zga;fe.worksheetId=Rc.ZFa;fe=Ie.a.Hc(fe);Rc.fireEvent(2102,
Rc.Zga,fe)}Rc.lfi(Wc)?(Rc.Zga=Rc.sFj(Wc),Rc.ZFa=Rc.Ria(),Rc.Zga&&Rc.ZFa)?0<Rc.rPa&&(Wc={},Wc.shapeId=Rc.Zga,Wc.worksheetId=Rc.ZFa,Wc=Ie.a.Hc(Wc),Rc.fireEvent(2101,Rc.Zga,Wc)):zb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",Rc.Zga,Rc.ZFa):(Rc.Zga=null,Rc.ZFa=null)};this.$=cb;this.dj=nc;this.Uh=Nc}function r(cb,nc,Nc){cb=G.call(this,cb,nc,Nc)||this;cb.igf=null;cb.hgf=null;return cb}function G(cb,
nc,Nc){var Rc=Pd.call(this)||this;Rc.Yya=0;Rc.iU=0;Rc.kd=function(Wc,fe){if(Rc.enabled&&!(Rc.ibf()||null!==fe&&void 0!==fe&&fe.vef)&&(Wc=Object(rb.a)(ee.a,Rc.$.xa.oa))&&!Wc.$H){var ve=Wc.sheetId,kc=Rc.AVe(),ad=null,yd=null;Rc.dj.jef()&&(ad=Rc.grid.Vb.vk(Rc.grid.ha.va.activeCell),yd=ve in Rc.yhc?Rc.yhc[ve]:null);Rc.cpe(ve,kc)&&uc.TaskExtensions.Ba(Bd.Task.Ta(!0),function(){Rc.fZh(ve,kc);Rc.QYh(ve,kc,ad,yd)},Rc.ma);Rc.iGe(ve,kc,ad)}};Rc.$=cb;Rc.dj=nc;Rc.Uh=Nc;Rc.grid=Yb.g(cb);Rc.sMa={};Rc.yhc={};return Rc}
function w(cb,nc,Nc){var Rc=this;this.CKf=this.BKf=0;this.aJb=this.T9a=null;this.Ozi=function(){var Wc=Yb.g(Rc.$).ha.Qa.ZB;if(Rc.bld(Wc)&&(Wc=Rc.L9b(Wc))){var fe={chartId:Wc};fe.worksheetId=Rc.Ria();fe=Ie.a.Hc(fe);Rc.wia(51,Wc,fe);Rc.wia(51,Rc.Ria(),fe)}};this.Pzi=function(){if(Rc.T9a){var Wc={};Wc.chartId=Rc.T9a;Wc.worksheetId=Rc.aJb;Wc=Ie.a.Hc(Wc);Rc.wia(52,Rc.T9a,Wc);Rc.wia(52,Rc.aJb,Wc)}Wc=Yb.g(Rc.$).ha.Qa.ZB;Rc.bld(Wc)?(Rc.T9a=Rc.L9b(Wc),Rc.aJb=Rc.Ria()):(Rc.T9a=null,Rc.aJb=null)};this.$=cb;
this.dj=nc;this.Uh=Nc}function B(){this.RXa={}}function U(cb,nc,Nc,Rc){Rc=void 0===Rc?!1:Rc;var Wc=qd.call(this)||this;Wc.hbb=0;Wc.aE=null;Wc.uva=!1;Wc.Loc=null;Wc.iU=0;Wc.e_d=null;Wc.iFc=null;Wc.qUa=null;Wc.T3b=null;Wc.U6d=!1;Wc.vXd=null;Wc.Wca=null;Wc.pMc=null;Wc.kd=function(){Wc.enabled&&(Wc.Ifj(),Wc.Loc=db.d(Yb.g(Wc.$).ha.va.selectedRanges))};Wc.y2e=function(fe){fe.controlId===Wc.Kd.InstanceId&&Array.forEach(Wc.aE,function(ve){ve.Vqi(fe)&&ve.O_b(fe)})};Wc.vqf=function(fe){if((fe=Object(rb.a)(203,
fe))&&!fe.Jp())if(!Wc.Kd||OSF.OsfControl.isFirstPartyStoreString(Wc.Kd.PrimaryMarketplace.MarketplaceType)||Wc.$.Aga){fe.gf=Wc.Kd;fe.sh=Wc.Xg;Wc.vXd=fe;Wc.wuc(fe.qFa);var ve=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Hc.a.Gd(Wc.$)&&Kd.HelperMethods.Vv(Wc.Kd)&&Wc.Kd.Preload&&!Wc.Kd.TaskpaneVisible;ve?fe.ryd():$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(fe.ryd(),(Wc.Kd.SharedRuntime&&1===Wc.Kd.SharedRuntime.LifeTime||
Wc.Kd.SharedRuntimeId)&&!Wc.Kd.TaskpaneVisible&&fe.Lf(!1)):((Wc.Kd.SharedRuntime&&1===Wc.Kd.SharedRuntime.LifeTime||Wc.Kd.SharedRuntimeId)&&!Wc.Kd.TaskpaneVisible&&fe.Lf(!1),fe.ryd());Wc.F4a||(Hc.a.Gd(Wc.$)?ve||fe.eR():Jb.a(Wc.$).result.WC(fe,!0));Wc.$.da.Aa(77).ULf(Wc.vqf);Wc.Ega=Object(rb.a)(352,fe)}else zb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Wc.onFloatingObjectControlAdded=function(fe,ve){3===ve.control.floatingObject.type&&ve.control.floatingObject.cl.InstanceId===
Wc.O0.WebExtensionId&&(Wc.Ega=Object(rb.a)(352,ve.control),Wc.wuc(ve.control.Pd.firstChild),Yd.a(Wc.$).KGd(Wc.onFloatingObjectControlAdded))};Wc.vb=cb.$;Wc.Xg=cb;Wc.Kd=Nc;Wc.Kd.InstanceId=Nc.SrcLocationOverrideResourceId?cb.kJa(Nc.InstanceId,Nc.SrcLocationOverrideResourceId):Nc.InstanceId;Wc.Uh=nc;Wc.O0={};Wc.O0.WebExtensionId=Nc.InstanceId;Wc.SBf="osfControl_"+Nc.InstanceId;Wc.a5c="disabled_"+Nc.InstanceId;Wc.O0.BindingData=Nc.BindingData;Wc.F4a=Wc.Xg.F4a(Nc.InstanceId);Wc.Sdc=Wc.Xg.Sdc(Nc.InstanceId);
Wc.pae=Nc.WebExtensionOsfControlType;Wc.YEf=Rc;return Wc}function N(cb,nc,Nc,Rc,Wc,fe,ve,kc){cb=Za.call(this,cb,nc,Nc)||this;cb.startRow=0;cb.startColumn=0;cb.rowCount=0;cb.columnCount=0;cb.startColumn=fe-Rc.Reference.FirstColumn;cb.columnCount=kc;fe=Math.max(Wc,Rc.Reference.FirstRow);Wc=Math.min(Wc+ve-1,Rc.Reference.LastRow);fe>Wc?cb.startRow=cb.rowCount=void 0:(cb.startRow=fe-Rc.Reference.FirstRow,cb.rowCount=Wc-fe+1);return cb}function P(cb){var nc=this;this.aE=null;this.uva=!1;this.kd=function(){nc.aE.forEach(function(Nc){Nc.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Nc.O_b(new Ga.a(Nc.eventId,"",null))})};this.Xg=cb}function ia(cb,nc){this.jA=null;this.Pea=cb;this.Bsg=nc}function W(cb){var nc=this;this.Gi=this.VUc=null;this.YGi=function(Nc,Rc){nc.handlers.wb(Rc.controlId)&&(Nc=new I(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Rc.controlId,null,Rc.messageType,Rc.messageContent,Rc.messageOrigin,Rc.targetOrigin),nc.handlers.na(Rc.controlId)(Nc),Rc.messageType===OSF.DialogMessageType.DialogClosed&&
nc.handlers.remove(Rc.controlId))};this.XGi=function(Nc,Rc){nc.Bjc.wb(Rc.controlId)&&(Nc=new R(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Rc.controlId,null,Rc.messageType,Rc.messageContent,Rc.messageOrigin,Rc.targetOrigin),nc.Bjc.na(Rc.controlId)(Nc))};this.handlers=new Tb.a;this.Bjc=new Tb.a;this.Xg=cb;this.l0a.ABg(this.YGi);this.l0a.zBg(this.XGi)}function R(cb,nc,Nc,Rc,Wc,fe,ve){cb=jb.call(this,cb,nc,Nc)||this;cb.messageType=0;cb.messageContent=null;cb.messageOrigin=null;cb.targetOrigin=
null;cb.messageType=Rc;cb.messageContent=Wc;cb.messageOrigin=fe;cb.targetOrigin=ve;return cb}function I(cb,nc,Nc,Rc,Wc,fe,ve){cb=Ua.call(this,cb,nc,Nc)||this;cb.messageType=0;cb.messageContent=null;cb.messageOrigin=null;cb.targetOrigin=null;cb.messageType=Rc;cb.messageContent=Wc;cb.messageOrigin=fe;cb.targetOrigin=ve;return cb}function Q(cb,nc){var Nc=Ha.call(this)||this;Nc.requests=[];Nc.h0b=!1;Nc.disposed=!1;Nc.Rh=function(){if(!Nc.disposed){Nc.grid.Kc.Rp(Nc.Rh);Nc.h0b=!1;var Rc=Nc.requests;Nc.requests=
[];Rc=yl(Rc);for(var Wc=Rc.next();!Wc.done;Wc=Rc.next())Wc=Wc.value,Nc.ddaFacade.LJ(Wc.command,Wc.properties)}};Nc.ddaFacade=cb;Nc.grid=nc;return Nc}function O(){this.command=0;this.properties=null}function ba(cb){this.Ya=new Zb.a;this.Ml=cb}function ca(cb,nc,Nc,Rc,Wc){Nc=void 0===Nc?null:Nc;Rc=void 0===Rc?"":Rc;Wc=void 0===Wc?"":Wc;var fe=wa.call(this)||this;fe.controlId=cb;fe.messageType=nc;fe.messageContent=Nc;fe.messageOrigin=Rc;fe.targetOrigin=Wc;return fe}function S(cb,nc,Nc,Rc,Wc){Nc=void 0===
Nc?null:Nc;Rc=void 0===Rc?"":Rc;Wc=void 0===Wc?"":Wc;var fe=Fb.call(this)||this;fe.controlId=cb;fe.messageType=nc;fe.messageContent=Nc;fe.messageOrigin=Rc;fe.targetOrigin=Wc;return fe}function Y(){this.height=this.width=0;this.Me=this.controlId=this.pageUrl=null;this.tcc=this.g5c=!1}function ma(){}function Z(){this.dialog=this.Me=null}function xa(cb,nc,Nc){var Rc=Sb.call(this)||this;Rc.W8=null;Rc.uQc="WACDialogTitleText";Rc.gUa="0";Rc.DPb="15px";Rc.tig="0px";Rc.fUa="calc(100% - 30px)";Rc.sig="100%";
Rc.fce=0;Rc.Ya=new Zb.a;Rc.agg=new pa;Rc.kc=5;Rc.uCa=Nc;Rc.Me=Nc;Rc.EFc=cb;Rc.j2d=nc;Rc.SFc=!!za.AFrameworkApplication.ga&&za.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return Rc}function na(){}function pa(){}function Ia(cb,nc){cb=Ma.call(this,1,cb,nc)||this;cb.i9e=OfficeExt.CommandInvokeMode.ExclusiveForNew;return cb}function Ma(cb,nc,Nc){this._id=cb;this.Zfg=nc;this.eig=Nc;this.i9e=OfficeExt.CommandInvokeMode.Default}b.r(D);var lb=b(0),zb=b(13),Ya=b(1288),Wb=b(80),
Zb=b(94);Ma.prototype.execute=function(cb,nc,Nc){var Rc=this;Nc=Nc||{};Nc.commandMode=this.i9e;nc.invokeAppCommand(this.gDg,this.LVg,Nc,function(){cb.iHi(Rc.id)})};tl.Object.defineProperties(Ma.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},gDg:{configurable:!0,enumerable:!0,get:function(){return this.Zfg}},LVg:{configurable:!0,enumerable:!0,get:function(){return this.eig}}});Object(lb.a)(Ma,"AddinNativeActionBase",null,[395]);vm(Ia,Ma);Object(lb.a)(Ia,"AddinTakeSnapshotAction",
Ma,[]);pa.prototype.p_g=function(cb){return new Ma(3,cb,this.oCh().getNativeActionName(3))};pa.prototype.oCh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(lb.a)(pa,"AddinNativeActionManager",null,[383]);var da=b(140);na.prototype.invokeAppCommand=function(cb,nc,Nc,Rc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(cb,nc,Nc,Rc)};na.getInstance=function(){na.Na||(na.Na=new na);return na.Na};na.Na=null;Object(lb.a)(na,"OSFAddinCommandsRuntimeManager",null,
[382]);var za=b(5),hb=b(172),Gb=b(23),Sb=da.a;vm(xa,Sb);xa.prototype.tBg=function(cb){this.Ya.addHandler("OnDialogClosedEventKey",cb)};xa.prototype.Gjj=function(){this.EDa=null};xa.prototype.KC=function(){Sb.prototype.KC.call(this);this.fp.style.width="100%";this.fp.style.height=this.Ubc?this.fUa:this.sig;this.fp.style.marginTop=this.Ubc?this.DPb:this.tig;this.fp.style.padding=this.gUa};xa.prototype.WN=function(){Sb.prototype.WN.call(this);this.Lb.style.width=String.format("{0}px",this.EFc*window.innerWidth/
100);this.Lb.style.height=String.format("{0}px",this.j2d*window.innerHeight/100);this.Lb.style.minWidth="0px";this.SFc&&za.AFrameworkApplication.isRtl&&100===this.EFc&&(this.Lb.style.right="0px",this.Lb.style.marginRight="0px");this.W8=document.getElementById(this.mi(this.uQc));this.W8.style.position="absolute";this.W8.style.whiteSpace="nowrap";this.W8.style.textOverflow="ellipsis";za.AFrameworkApplication.isRtl?(this.W8.style.right="14px",this.W8.style.left="44px"):(this.W8.style.right="44px",this.W8.style.left=
"14px")};xa.prototype.$u=function(cb){Sb.prototype.$u.call(this,cb);this.W8&&this.W8.setAttribute("title",cb)};xa.prototype.rId=function(){this.Lb.style.width=String.format("{0}px",this.EFc*window.innerWidth/100);this.Lb.style.height=String.format("{0}px",this.j2d*window.innerHeight/100);this.Lb.style.overflowY="hidden";this.Lb.style.overflowX="hidden";this.Lb.style.marginTop="";this.Lb.style.top="";Gb.a.zQ&&za.AFrameworkApplication.isRtl?(this.Lb.style.right="",this.Lb.style.marginRight=""):(this.Lb.style.left=
"",this.Lb.style.marginLeft="")};xa.prototype.hide=function(){var cb=this;this.agg.p_g(this.uCa).execute(this,na.getInstance(),{});this.fce=window.setTimeout(function(){cb.Ya.raiseEvent("OnDialogClosedEventKey",cb.uCa);hb.a.prototype.hide.call(cb)},500)};xa.prototype.iHi=function(cb){3===cb&&(window.clearTimeout(this.fce),this.Ya.raiseEvent("OnDialogClosedEventKey",this.uCa),Sb.prototype.hide.call(this))};tl.Object.defineProperties(xa.prototype,{k0a:{configurable:!0,enumerable:!0,get:function(){return this.fp}}});
Object(lb.a)(xa,"AppsForOfficeDialog",da.a,[373,374]);Object(lb.a)(Z,"DialogInfo",null,[]);ma.url="url";ma.height="height";ma.width="width";ma.g5c="displayInIframe";ma.tcc="hideTitle";Object(lb.a)(ma,"DialogSettings",null,[]);Object(lb.a)(Y,"DisplayDialogParams",null,[]);var Fb=Sys.EventArgs;vm(S,Fb);Object(lb.a)(S,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var wa=Sys.EventArgs;vm(ca,wa);Object(lb.a)(ca,"OnMessageParentEventArgs",Sys.EventArgs,[]);var va=b(38),sa=b(28),sb=b(179),Tb=b(101);ba.prototype.ABg=
function(cb){this.Ya.addHandler("OnMessageParentEventKey",cb)};ba.prototype.zBg=function(cb){this.Ya.addHandler("OnMessageDialogEventKey",cb)};ba.prototype.showDialog=function(cb,nc,Nc,Rc){if(ba.I7.wb(nc))zb.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var Wc=va.b(cb),fe=Wc[ma.url];if(this.Ml.getOsfControl(nc).checkAppDomains(fe)){var ve=new Y;ve.width=Wc[ma.width];ve.height=
Wc[ma.height];ve.pageUrl=fe;ve.g5c=Wc[ma.g5c];ve.tcc=Wc[ma.tcc];ve.controlId=nc;ve.Me=sb.a.create().toString();var kc=new Z;kc.Me=ve.Me;var ad=this.Ml.getOsfControl(ve.controlId).getManifest().getDefaultDisplayName(),yd=this.Ml.getOsfControl(ve.controlId).getStoreType().toLowerCase();cb=null;cb=4===za.AFrameworkApplication.sa.Pa.Lj&&"hardcodedpreinstall"===yd&&ve.tcc?this.createAndShowAppsForOfficeDialog(ve.width,ve.height,ve.Me,!0,ad):this.createAndShowAppsForOfficeDialog(ve.width,ve.height,ve.Me,
!1,ad);var wd=this.Ml.getOsfControl(ve.controlId),pe=wd.getManifest();nc={};za.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(nc.id=ve.Me,nc.solutionId=wd.getSolutionId(),nc.version=wd.getVersion(),nc.storeType=yd,nc.storeId=wd.getStoreId()):(nc.id=ve.Me,nc.solutionId=pe.getMarketplaceID(),nc.version=pe.getMarketplaceVersion(),nc.storeType=yd,nc.storeId=wd.getStoreLocator());nc.assetId=wd.getAssetId();nc.assetStoreId=wd.getAssetStoreId();
nc.ownerAddinSolutionId=wd.getOwnerAddinSolutionId();nc.ownerAddinStoreType=wd.getOwnerAddinStoreType();nc.appDomains=pe.getAppDomains();nc.dialogUrl=fe;nc.osfControlType=1;nc.marketplaceID=pe.getMarketplaceID();nc.marketplaceVersion=pe.getMarketplaceVersion();nc.store=wd.getStoreLocator();nc.ownerAddinAssetId=wd.getOwnerAddinAssetId();nc.agaveName=ad;nc.div=cb.k0a;za.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?zb.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==nc.ownerAddinStoreType?nc.ownerAddinStoreType:nc.storeType,nc.storeId,nc.solutionId),sa.a.lu(ve.pageUrl)):zb.ULS.sendTraceTag(527279822,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==nc.ownerAddinStoreType?nc.ownerAddinStoreType:nc.storeType,nc.store,nc.solutionId),sa.a.lu(ve.pageUrl));this.Ml.insertDialogControl(nc);cb.tBg(Object(Wb.a)(this,this.FBi,"onDialogClosed"));
kc.dialog=cb;ba.I7.ia(ve.controlId,kc);Rc&&Rc(nc);Nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else zb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(bf){zb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",bf.message),Nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};ba.prototype.Fsi=function(cb,nc,Nc,Rc){za.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Rc&&(Rc=Nc);try{var Wc=this.wua(cb);Wc&&this.Ya.raiseEvent("OnMessageParentEventKey",new ca(Wc,OSF.DialogMessageType.DialogMessageReceived,nc,Nc,Rc))}catch(fe){return zb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",fe.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};ba.prototype.m_c=function(cb,nc){if(ba.I7.wb(cb))try{var Nc=ba.I7.na(cb);Nc.dialog&&Nc.dialog.hide();this.Ml.purgeDialogControl(Nc.Me);
ba.I7.remove(cb);nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Rc){zb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Rc.message),nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else zb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};ba.prototype.yfj=function(cb,nc,Nc,Rc){za.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Rc&&(Rc=Nc);if(ba.I7.wb(cb)&&(cb=ba.I7.na(cb),cb.dialog))try{this.Ya.raiseEvent("OnMessageDialogEventKey",new S(cb.Me,OSF.DialogMessageType.DialogParentMessageReceived,nc,Nc,Rc))}catch(Wc){zb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Wc.message)}};ba.prototype.wua=function(cb){for(var nc=null,Nc=yl(ba.I7),Rc=Nc.next();!Rc.done;Rc=Nc.next())if(Rc=Rc.value,Rc.value.Me===cb){nc=Rc.key;break}return nc};ba.prototype.FBi=function(cb,nc){if(cb=
this.wua(nc))this.Ml.purgeDialogControl(nc),ba.I7.remove(cb),this.Ya.raiseEvent("OnMessageParentEventKey",new ca(cb,OSF.DialogMessageType.DialogClosed,null,null,"*"))};ba.prototype.createAndShowAppsForOfficeDialog=function(cb,nc,Nc,Rc,Wc){cb=new xa(cb,nc,Nc);Wc=Rc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Wc);Rc&&(cb.Ubc=!1,cb.Gu=!1);cb.initializeAndShow(Wc,null,null);cb.Gjj();return cb};ba.RUh=function(){return ba.I7};ba.getInstance=function(cb){ba.Na||(ba.Na=new ba(cb));
return ba.Na};ba.Na=null;ba.I7=new Tb.a;Object(lb.a)(ba,"AppsForOfficeDialogManager",null,[359]);var Da=b(989),Sa=b(1292),Ra=b(1369),Lb=b(1070),Ja=b(846),wb=b(187),Mb=b(1294),Eb=b(157),Ic=b(86),Zc=b(88),Pc=b(686),vd=b(574),Tc=b(805),rb=b(84),eb=b(408),Ta=b(139),fb=b(185),pb=b(36),rc=b(4),vb=b(950),E=b(1250),Nb=b(74);Object(lb.a)(O,"DdaRequestInfo",null,[]);var ka=b(858),bb=b(78),Ha=Nb.a;vm(Q,Ha);Q.prototype.e9g=function(cb,nc){this.disposed||(this.h0b||(this.grid.Kc.hq(this.Rh),this.h0b=!0),this.requests.push(Object.assign(new O,
{command:cb,properties:nc})))};Q.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.h0b&&this.grid.Kc.Rp(this.Rh);var cb=this.requests;this.requests=null;cb=yl(cb);for(var nc=cb.next();!nc.done;nc=cb.next())nc=nc.value,(nc=nc.properties?nc.properties[bb.a.e3]:null)&&this.ddaFacade.vf(ka.a.Twb,nc);this.ddaFacade=this.grid=null;Ha.prototype.dispose.call(this)}};Q.OVg=function(cb,nc){var Nc=!1;974713501===cb&&(nc=(cb=nc?nc[bb.a.Kg]:null)?cb.DdaMethod:null)&&nc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(Nc=cb.ArrayData,Nc=!!Nc&&64===(Nc[6]&64));return Nc};Object(lb.a)(Q,"DdaCellEditDelayRequestHandler",Nb.a,[]);var Ga=b(895),Ua=Ga.a;vm(I,Ua);Object(lb.a)(I,"DialogMessageReceivedEventArgs",Ga.a,[]);var jb=Ga.a;vm(R,jb);Object(lb.a)(R,"DialogParentMessageReceivedEventArgs",Ga.a,[]);var $a=b(1);W.prototype.addHandler=function(cb,nc,Nc,Rc){var Wc=this;if($a.EwaSettings.la(24))this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Nc);else{zb.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var fe=function(ve){ve===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Wc.handlers.ia(cb,nc),Wc.Xg.Au(Nc)):(zb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),Wc.Xg.vf(ve,Nc))};this.handlers.wb(cb)?fe(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(cb,Rc,fe)}};W.prototype.bxg=function(cb,nc,Nc){$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Nc):(zb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.Bjc.ia(cb,nc),this.Xg.Au(Nc))};W.prototype.removeHandler=function(cb,nc){var Nc=this;$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,nc):this.handlers.wb(cb)?(zb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.l0a.m_c(cb,function(Rc){Nc.handlers.remove(cb);Rc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Nc.Xg.Au(nc):(zb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
Nc.Xg.vf(Rc,nc))})):this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,nc)};W.prototype.Z2i=function(cb,nc){$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,nc):(zb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Bjc.remove(cb),this.Xg.Au(nc))};W.prototype.showDialog=function(cb,nc,Nc){var Rc=this;try{this.l0a.showDialog(nc,cb,Nc,function(Wc){Rc.Xg.sxg(Rc.ENg(Wc))})}catch(Wc){zb.ULS.sendTraceTag(537170496,
0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",Wc.message),Nc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};W.prototype.ENg=function(cb){var nc={};nc.InstanceId=cb.id;nc.WebExtensionType=cb.osfControlType===OSF.OsfControlTarget.InContent?0:1;nc.PrimaryMarketplace={};nc.PrimaryMarketplace.SolutionId=cb.solutionId;nc.PrimaryMarketplace.SolutionVersion=cb.version;nc.PrimaryMarketplace.MarketplaceRef=cb.storeId;nc.PrimaryMarketplace.MarketplaceType=cb.storeType;
return nc};W.ja=function(cb){if(!cb.$.da.Aa(232)){var nc=new W(cb);cb.$.da.Ha(232,nc)}};tl.Object.defineProperties(W.prototype,{l0a:{configurable:!0,enumerable:!0,get:function(){this.VUc||(this.VUc=ba.getInstance(this.contextActivationMgr));return this.VUc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Gi&&this.Xg&&(this.Gi=this.Xg.Gi);return this.Gi}}});Object(lb.a)(W,"DialogMessageReceivedEventManager",null,[354]);ia.prototype.PXb=function(cb){cb&&(this.jA||(this.jA=
[]),Array.add(this.jA,cb))};ia.prototype.Oqc=function(cb){this.jA&&Array.remove(this.jA,cb)};ia.prototype.Vqi=function(cb){return this.eventId!==cb.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===cb.ddaBinding.Name:!0};ia.prototype.O_b=function(cb){this.jA&&Array.forEach(this.jA,function(nc){nc(cb)})};ia.prototype.ama=function(){this.jA=[]};tl.Object.defineProperties(ia.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.Pea}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Bsg}},JZh:{configurable:!0,enumerable:!0,get:function(){return 0<this.jA.length}}});Object(lb.a)(ia,"DdaEventRegistration",null,[]);var Yb=b(20);P.prototype.invokeDdaMethod=function(cb,nc){var Nc={};Nc[bb.a.Kg]=cb;Nc[bb.a.e3]=nc;this.Xg.LJ(974713501,Nc)};P.prototype.registerDdaEventAsync=function(cb,nc,Nc,Rc,Wc){P.yxb(cb)?(P.sld(cb)&&this.Uhd(),this.aE||(this.aE=[]),nc=this.vsb(cb,Nc),
nc||(nc=new ia(cb,Nc),Array.add(this.aE,nc)),nc.PXb(Rc),this.Xg.Au(Wc)):this.Xg.vf(-1,Wc)};P.prototype.unregisterDdaEventAsync=function(cb,nc,Nc,Rc,Wc){P.yxb(cb)?((cb=this.vsb(cb,Nc))&&cb.Oqc(Rc),this.Xg.Au(Wc)):this.Xg.vf(-1,Wc)};P.prototype.Uhd=function(){this.uva||(Yb.g(this.Xg.$).ha.iG(this.kd),this.uva=!0)};P.prototype.vsb=function(cb,nc){if(!this.aE)return null;for(var Nc=0;Nc<this.aE.length;Nc++){var Rc=this.aE[Nc];if(Rc.eventId===cb&&Rc.targetId===nc)return Rc}return null};P.yxb=function(cb){return cb===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};P.sld=function(cb){return cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(lb.a)(P,"EmbeddingPage",null,[292]);var ec=b(195),Za=Ga.a;vm(N,Za);N.prototype.getStartRow=function(){return this.startRow};N.prototype.getStartColumn=function(){return this.startColumn};N.prototype.getRowCount=function(){return this.rowCount};N.prototype.getColumnCount=function(){return this.columnCount};Object(lb.a)(N,"DdaBindingSelectionEventArgs",
Ga.a,[]);var Wa=b(188),Ca=b(24),db=b(43),$b=b(56),Jb=b(409),Hc=b(41),uc=b(35),Aa=b(587),mb=b(106),dc=b(51),Ac=b(92),bd=b(11),Kd=b(8),Yd=b(103),qd=ec.a;vm(U,qd);U.prototype.m5h=function(cb){this.Wca||(this.Wca=cb)};U.prototype.DLf=function(){this.Wca&&(this.Wca.dispose(),this.Wca=null)};U.prototype.ujd=function(){var cb=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Kd.PrimaryMarketplace.MarketplaceType)&&$a.EwaSettings.la(186)){var nc=$b.GetServiceTaskFactory.Xa(this.$.da,5,4,0);uc.TaskExtensions.Ba(nc,
function(){nc.result.hg(35,null)},this.ma,3);return this}if(1===this.Kd.WebExtensionType)uc.TaskExtensions.Ba(Jb.a(this.$),function(Wc){Wc.result.$pb(cb.$.da,77,6,cb.vqf,1)},this.ma,3);else{var Nc=this.mQe(),Rc=Yd.a(this.$);Nc||(Nc={Type:3},Nc.Id=this.O0.WebExtensionId,Nc.WebExtensionData=this.Kd,Nc.ContentHtml="<div/>",Nc.Version=0,Nc.AbsoluteLeft=0,Nc.AbsoluteTop=0,Nc.AbsoluteRight=0,Nc.AbsoluteBottom=0,Nc.Width=0,Nc.Height=0,Nc.ZOrder=0,Nc.OriginDeltaX=0,Nc.OriginDeltaY=0,Nc=new Wa.a(Nc),Rc.B2b(Nc,
null),Nc=Rc.Hp(Nc.Eg()));Nc?(this.wuc(Nc.Pd.firstChild),this.Ega=Object(rb.a)(352,Nc)):Rc.gTc(this.onFloatingObjectControlAdded)}return this};U.prototype.C7e=function(cb){this.wuc(cb);return this};U.prototype.jlc=function(){this.YEf||this.Xg.Gi.purgeOsfControl(this.controlId,!1);this.i8f(!0);var cb=this.mQe();cb&&Yd.a(this.$).deleteFloatingObject(cb);this.Xg.dj.I2i(this.controlId);this.Xg.dj.kIe(this.controlId,!0);this.pMc=null};U.prototype.Iyd=function(cb){this.O0=cb};U.prototype.invokeDdaMethod=
function(cb,nc){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Nc={};Nc[bb.a.Kg]=cb;Nc[bb.a.e3]=nc;this.Xg.LJ(974713501,Nc)}else this.Xg.vf(ka.a.Twb,nc)};U.prototype.k0i=function(cb,nc,Nc,Rc){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!U.Lch(cb)||void 0!==nc&&null!==nc&&void 0!==this.z1a(nc)&&null!==this.z1a(nc))if(zb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",cb,nc),U.E$e(cb)&&this.x0h(),
U.sld(cb)&&this.Uhd(),U.C$e(cb))$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rc):this.Xg.$.da.Aa(232).addHandler(this.controlId,Nc,Rc,nc);else if(U.D$e(cb))$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rc):this.Xg.$.da.Aa(232).bxg(this.controlId,Nc,Rc);else{U.B$e(cb)&&this.A2e(-1777565636,Rc);this.aE||(this.aE=[]);var Wc=this.vsb(cb,nc);Wc||(Wc=new ia(cb,nc),Array.add(this.aE,Wc));Wc.ama();Wc.PXb(Nc);
this.Xg.Au(Rc);cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.qUa&&(this.T3b=Nc)}else this.Xg.vf(3002,Rc);else this.Xg.vf(-1,Rc)};U.prototype.dHj=function(cb,nc,Nc,Rc){U.C$e(cb)?$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rc):this.Xg.$.da.Aa(232).removeHandler(this.controlId,Rc):U.D$e(cb)?$a.EwaSettings.la(24)?this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Rc):this.Xg.$.da.Aa(232).Z2i(this.controlId,Rc):(U.B$e(cb)&&
this.A2e(1592314317,Rc),nc=this.vsb(cb,nc),this.enabled?(nc&&(nc.Oqc(Nc),nc.JZh||Array.remove(this.aE,nc),this.aE.length?U.E$e(cb)&&this.j8f(!1):this.i8f(!1)),this.Xg.Au(Rc)):this.Xg.vf(-1,Rc))};U.prototype.ja=function(cb){bd.DOMElementExtensions.getElementById(cb,this.SBf)||cb.appendChild(bd.DOMElementExtensions.Sf(this.Px))};U.prototype.showHide=function(cb){bd.DOMElementExtensions.setVisible(this.Px,cb)};U.prototype.resize=function(cb,nc){bd.DOMElementExtensions.Gq(this.Px,cb);bd.DOMElementExtensions.HF(this.Px,
nc)};U.prototype.fFe=function(cb){if(!this.iU&&!bd.DOMElementExtensions.getElementById(this.Px,this.a5c)&&this.Px){var nc=document.createElement("div");nc.id=this.a5c;nc.className="ewa-wx-disabled-div";nc.style.backgroundImage="url("+dc.a.current.co(81)+")";nc.style.opacity=cb?"1":"0";nc.style.backgroundRepeat="no-repeat";nc.style.backgroundPosition="center";this.Px.insertBefore(nc,this.Px.firstChild)}this.iU++};U.prototype.Wfh=function(){0<this.iU&&this.iU--;this.iU||(bd.DOMElementExtensions.Sf(bd.DOMElementExtensions.getElementById(this.Px,
this.a5c)),this.uva&&!db.Q(this.Loc,Yb.g(this.$).ha.va.selectedRanges)&&this.kd(null,null))};U.prototype.z1a=function(cb){if(!this.O0||!this.O0.BindingData)return null;for(var nc=0;nc<this.O0.BindingData.length;nc++)if(this.O0.BindingData[nc].Name===cb)return this.O0.BindingData[nc];return null};U.prototype.getDefaultIconUrl=function(){var cb=this.$Ye();return cb?cb.getDefaultIconUrl():null};U.prototype.getDefaultDisplayName=function(){if(this.Kd.TaskpaneTitle)return this.Kd.TaskpaneTitle;var cb=
this.$Ye();return cb?cb.getDefaultDisplayName():null};U.prototype.cGf=function(){if(this.qUa&&this.T3b){var cb=new Ga.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.qUa);this.T3b(cb);this.T3b=this.qUa=null}};U.prototype.Lf=function(cb){this.vXd&&this.vXd.Lf(cb)};U.prototype.Bhj=function(){var cb=this;this.$.fa.isNamedObjectViewMode&&this.Edi()&&(this.$.da.Aa(34).Ahj(this.Px),this.showHide(!1));if(this.Xg.WOj){if(!this.YEf){var nc={};nc.div=this.Px;nc.id=this.Kd.InstanceId;
nc.solutionId=this.Kd.PrimaryMarketplace.SolutionId;nc.version=this.Kd.PrimaryMarketplace.SolutionVersion;nc.storeId=this.Kd.PrimaryMarketplace.MarketplaceRef;nc.storeType=this.Kd.PrimaryMarketplace.MarketplaceType;nc.ownerAddinSolutionId=this.Kd.OwnerAddinSolutionId;nc.ownerAddinStoreType=this.Kd.OwnerAddinStoreType;this.Kd.AssetMarketplace&&(nc.assetId=this.Kd.AssetMarketplace.SolutionId,nc.assetStoreId=this.Kd.AssetMarketplace.MarketplaceRef,nc.alternateReference={},nc.alternateReference.marketplaceID=
this.Kd.AssetMarketplace.SolutionId,nc.alternateReference.marketplaceVersion=this.Kd.AssetMarketplace.SolutionVersion,nc.alternateReference.store=this.Kd.AssetMarketplace.MarketplaceRef,nc.alternateReference.storeType=this.Kd.AssetMarketplace.MarketplaceType);nc.marketplaceID=this.Kd.PrimaryMarketplace.SolutionId;nc.marketplaceVersion=this.Kd.PrimaryMarketplace.SolutionVersion;nc.store=this.Kd.PrimaryMarketplace.MarketplaceRef;nc.ownerAddinAssetId=this.Kd.OwnerAddinAssetId;nc.settings=this.Kd.OsfPropertyBag;
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?nc.reason=this.F4a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Sdc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:nc.reason=this.F4a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;nc.osfControlType=this.Kd.WebExtensionType?
OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent;nc.isForUILessAction=4===this.Kd.WebExtensionOsfControlType;nc.sourceLocationOverrideResourceId=this.Kd.SrcLocationOverrideResourceId;nc.focusOnIframeWhenLoaded=this.Kd.FocusOnIframeWhenLoaded;Aa.a(this.Kd)&&(nc.featureGates=za.AFrameworkApplication.ga.ZIh(nc.solutionId));nc.hostInfoFlags=0;this.rHa&&(nc.hostInfoFlags|=2);Kd.HelperMethods.Vv(this.Kd)&&(nc.hostInfoFlags|=1);this.$.Aga||(zb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),
nc.hostInfoFlags|=4);$a.EwaSettings.la(664)&&(nc.hostInfoFlags|=8);$a.EwaSettings.la(53)&&$a.EwaSettings.la(93)&&!this.iFc&&(nc.virtualOsfControlActivationCallback=function(){cb.Xg.Fzd(cb.Kd)});nc.sharedRuntimeId=this.Kd.SharedRuntime?this.Kd.SharedRuntime.Resid:this.Kd.SharedRuntimeId;!Kd.HelperMethods.Vv(this.Kd)||this.Kd.Preload||Aa.a(this.Kd)||this.Xg.Gi.getOsfControl(b(861).DdaFacade.getSolutionId(this.Kd,this.$))||($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.Xg.Fzd(this.Kd):this.Xg.Fzd(this.Kd));nc.initialDisplayMode=this.Kd.TaskpaneVisible?2:1;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(nc.titleOverride=this.cl.TaskpaneTitle);this.Xg.Gi.insertOsfControl(nc)}this.iU=0}else this.fFe(!0)};U.prototype.i8f=function(cb){this.j8f(cb);this.MGj()};U.prototype.x0h=function(){this.hbb||this.Uh.PXb(this.y2e);this.hbb++};U.prototype.j8f=function(cb){0<this.hbb&&(cb?this.hbb=0:this.hbb--,this.hbb||this.Uh.Oqc(this.y2e))};
U.prototype.Uhd=function(){if(!this.uva){var cb=Yb.g(this.$).ha;this.Loc=db.d(Yb.g(this.$).ha.va.selectedRanges);cb.iG(this.kd);this.uva=!0}};U.prototype.MGj=function(){this.uva&&(Yb.g(this.$).ha.DK(this.kd),this.uva=!1)};U.prototype.zej=function(cb){var nc=new Ca.Range(cb.Reference.FirstRow+1,cb.Reference.FirstColumn+1,cb.Reference.LastRow+1,cb.Reference.LastColumn+1,!1,!1);1===cb.BindingType&&(cb.HasHeaders&&--nc.top,cb.HasTotals&&(nc.bottom+=1));var Nc=Yb.g(this.$).ha.va.selectedRanges;cb=nc.Swb(this.Loc);
Nc=nc.Swb(Nc);return(nc=nc.Jf(Yb.g(this.$).ha.va.activeRange))&&(mb.e(cb)&&!mb.e(Nc)||!mb.e(cb)&&!mb.e(Nc)&&!db.Q(cb,Nc))?nc:null};U.prototype.Ifj=function(){var cb=this;Array.forEach(this.aE,function(nc){if(nc.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&nc.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb.Xg.dj.gZb(cb.controlId))if(nc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)nc.O_b(new Ga.a(nc.eventId,cb.controlId,null));else if(nc.eventId===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Nc=cb.z1a(nc.targetId);if((null===Nc||void 0===Nc?0:Nc.IsValidRef)&&(cb.$.fa.isNamedObjectViewMode?cb.$.xb.oa.sheetName:cb.$.xa.oa.name)===Nc.Reference.SheetName){var Rc=cb.zej(Nc);Rc&&nc.O_b(new N(nc.eventId,cb.controlId,cb.Xg.UZb(Nc),Nc,Rc.top-1,Rc.left-1,Rc.height,Rc.width))}}})};U.prototype.vsb=function(cb,nc){if(!this.aE)return null;for(var Nc=0;Nc<this.aE.length;Nc++){var Rc=this.aE[Nc];if(Rc.eventId===cb&&Rc.targetId===nc)return Rc}return null};
U.prototype.mQe=function(){for(var cb=Yd.a(this.$).Py,nc=cb.length-1;0<=nc;--nc){var Nc=cb[nc];if(3===Nc.floatingObject.type&&Nc.floatingObject.cl.InstanceId===this.O0.WebExtensionId)return Nc}return null};U.prototype.Edi=function(){for(var cb=0;cb<this.$.xb.count;cb++)if(this.$.xb.getItem(cb).Eja===this.O0.WebExtensionId)return!0;return!1};U.prototype.wuc=function(cb){this.pMc=cb;this.Px.id=this.SBf;this.Px.className="ewa-wx-container-div";this.Px.dir=this.$.isChromeRtl?"rtl":"ltr";this.Bhj()};U.prototype.$Ye=
function(){if(!this.enabled)return null;var cb=Aa.a(this.cl)?"":this.cl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.cl.PrimaryMarketplace.SolutionId,cb)};U.prototype.A2e=function(cb,nc){if($a.EwaSettings.la(24))this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,nc);else try{if(zb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.pae)this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,
nc);else{var Nc={};Nc[Ja.a.Bmb]=this.controlId;var Rc=new Ac.a(cb,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Zb(Rc,Nc);this.Xg.Au(nc)}}catch(Wc){zb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",Wc.message),this.Xg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,nc)}};U.Lch=function(cb){return cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};U.E$e=function(cb){return cb===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent||cb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent};U.sld=function(cb){return cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};U.C$e=function(cb){return cb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};U.D$e=function(cb){return cb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};U.B$e=function(cb){return cb===
OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};tl.Object.defineProperties(U.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Kd.WebExtensionType}},ownerAddinAssetId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.OwnerAddinAssetId}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.OwnerAddinSolutionId}},$:{configurable:!0,
enumerable:!0,get:function(){return this.vb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.iU}},Px:{configurable:!0,enumerable:!0,get:function(){return this.pMc}},VT:{configurable:!0,enumerable:!0,get:function(){return this.Kd.SrcLocationOverrideResourceId?this.Xg.kJa(this.Kd.PrimaryMarketplace.SolutionId,this.Kd.SrcLocationOverrideResourceId):this.Kd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.SrcLocationOverrideResourceId}},
cl:{configurable:!0,enumerable:!0,get:function(){return this.Kd}},Ega:{configurable:!0,enumerable:!0,get:function(){return this.e_d},set:function(cb){this.e_d=cb}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.pae}},rHa:{configurable:!0,enumerable:!0,get:function(){return this.iFc},set:function(cb){this.iFc=cb}},y3c:{configurable:!0,enumerable:!0,get:function(){return this.qUa},set:function(cb){this.qUa=cb}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Kd.FocusOnIframeWhenLoaded}},
nnd:{configurable:!0,enumerable:!0,get:function(){return this.U6d},set:function(cb){this.U6d=cb}}});Object(lb.a)(U,"OsfControl",ec.a,[353]);B.prototype.add=function(cb){this.RXa[cb]=!0};B.prototype.remove=function(cb){delete this.RXa[cb]};B.prototype.clear=function(){for(var cb=yl(Object.keys(this.RXa)),nc=cb.next();!nc.done;nc=cb.next())delete this.RXa[nc.value]};B.prototype.S3e=function(){return 0<Object.keys(this.RXa).length};B.prototype.nCh=function(){return Object.keys(this.RXa)};Object(lb.a)(B,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Ie=b(52);w.prototype.tnb=function(cb){51===cb.messageType?this.BKf=this.HFa(cb.actionType,this.BKf,this.Ozi):52===cb.messageType&&(this.CKf=this.HFa(cb.actionType,this.CKf,this.Pzi))};w.prototype.HFa=function(cb,nc,Nc){if(1===cb)nc||Yb.g(this.$).ha.Qa.hTc(Nc),nc++,this.llj();else if(2===cb){if(1>nc)return nc;1===nc&&Yb.g(this.$).ha.Qa.LGd(Nc);nc--}return nc};w.prototype.wia=function(cb,nc,Nc){nc&&this.dj.BZ(cb,nc)&&this.Uh.jM(cb,
nc,Nc)};w.prototype.L9b=function(cb){return cb&&cb.floatingObject?(cb=cb.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===cb.length?cb[0]:null:null};w.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};w.prototype.llj=function(){var cb=Yb.g(this.$).ha.Qa.ZB;this.bld(cb)&&(this.T9a=this.L9b(cb),this.aJb=this.Ria())};w.prototype.bld=function(cb){return!!cb&&!!cb.floatingObject&&!cb.floatingObject.type};Object(lb.a)(w,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var cc=b(868),Qd=b(181),Wd=b(657),ee=b(95),ne=b(339),Bd=b(55),Pd=Nb.a;vm(G,Pd);G.prototype.CZb=function(cb){Object(rb.a)(ne.a,this.$.xa);1===cb.actionType?(this.Yya||this.grid.ha.iG(this.kd),this.Yya++):2!==cb.actionType||1>this.Yya||(1===this.Yya&&this.grid.ha.DK(this.kd),this.Yya--)};G.prototype.buc=function(cb){cb?this.iU++:(0<this.iU&&this.iU--,this.iU||this.kd(null,new Wd.a(!1)))};G.prototype.AVe=function(){return this.grid.ha.va.selectedRanges};G.prototype.cpe=function(cb,nc){return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!cb&&Qd.e(this.sMa)||cb in this.sMa)&&!db.Q(this.sMa[cb],nc):cb in this.sMa&&!db.Q(this.sMa[cb],nc)};G.prototype.iGe=function(cb,nc,Nc){this.sMa[cb]=db.d(nc);this.yhc[cb]=Nc};G.prototype.ibf=function(){return this.grid.isEditing||this.grid.zi};G.prototype.MQe=function(cb,nc){this.dj.BZ(14,cb)&&this.Uh.jM(14,cb,nc);this.dj.BZ(14,cc.a.uW)&&this.Uh.jM(14,cc.a.uW,nc)};G.prototype.fZh=function(cb,nc){var Nc={};Nc.worksheetId=cb;Nc.address=this.ued(nc);nc=Ie.a.Hc(Nc);this.MQe(cb,nc)};G.prototype.QYh=
function(cb,nc,Nc,Rc){if(this.dj.jef()){var Wc="",fe="";Rc&&(Wc=Rc.pj);Nc&&(fe=Nc.pj);Rc?Nc?(nc=Nc.usedRange.Swb(nc),Wc!==fe&&this.k8b(Wc,"",cb),this.k8b(fe,this.ued(nc),cb)):this.k8b(Wc,"",cb):Nc&&(Wc=Nc.usedRange.Swb(nc),this.k8b(fe,this.ued(Wc),cb))}};G.prototype.k8b=function(cb,nc,Nc){if(this.dj.BZ(100,cb)){var Rc={};Rc.address=nc;Rc.worksheetId=Nc;this.Uh.jM(100,cb,Ie.a.Hc(Rc))}};G.prototype.ued=function(cb){return db.i(cb,",",this.$,!1)};G.prototype.dispose=function(){0<this.Yya&&this.grid.ha.DK(this.kd);
this.yhc=this.sMa=null;this.Yya=0;this.Uh=this.dj=this.$=this.grid=null};tl.Object.defineProperties(G.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.iU&&0<this.Yya}}});Object(lb.a)(G,"RichApiEventSelectionChangedHandler",Nb.a,[]);var ze=b(336);vm(r,G);r.prototype.AVe=function(){return ze.a.aHa(this.grid.ha.rangePicker.uK)};r.prototype.cpe=function(cb,nc){return this.igf!==cb||!db.Q(this.hgf,nc)};r.prototype.iGe=function(cb,nc){this.igf=cb;this.hgf=db.d(nc)};r.prototype.ibf=
function(){return!this.grid.isEditing&&!this.grid.zi};r.prototype.MQe=function(cb,nc){this.dj.BZ(2700,cc.a.uW)&&this.Uh.jM(2700,cc.a.uW,nc)};Object(lb.a)(r,"RichApiEventPickedRangesChangedHandler",G,[]);z.prototype.tnb=function(cb){var nc=Yb.g(this.$).ha;1===cb.actionType?(this.rPa||this.sPa||nc.Qa.hTc(this.Stf),2101===cb.messageType?this.rPa++:2102===cb.messageType&&this.sPa++):2===cb.actionType&&(2101===cb.messageType?this.rPa=0<this.rPa?this.rPa-1:0:2102===cb.messageType&&(this.sPa=0<this.sPa?
this.sPa-1:0),this.rPa||this.sPa||nc.Qa.LGd(this.Stf))};z.prototype.lfi=function(cb){return!!cb&&!!cb.floatingObject&&(!cb.floatingObject.type||7===cb.floatingObject.type||1===cb.floatingObject.type||3===cb.floatingObject.type||5===cb.floatingObject.type)};z.prototype.sFj=function(cb){if(!cb||!cb.floatingObject)return null;cb=cb.floatingObject.id;var nc=cb.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));nc=nc&&1===nc.length?nc[0]:null;return nc?nc:(zb.ULS.sendTraceTag(537170457,344,10,
"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",cb),null)};z.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};z.prototype.fireEvent=function(cb,nc,Nc){nc&&this.dj.BZ(cb,nc)&&this.Uh.jM(cb,nc,Nc)};Object(lb.a)(z,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);t.prototype.tnb=function(cb){11===cb.messageType?cb.targetId===cc.a.uW?this.HHg(cb.actionType):this.GHg(cb.actionType):12===cb.messageType&&(cb.targetId===cc.a.uW?this.IHg(cb.actionType):
this.JHg(cb.actionType))};t.prototype.GHg=function(cb){this.DKf=this.HFa(cb,this.DKf,this.WMi)};t.prototype.JHg=function(cb){this.GKf=this.HFa(cb,this.GKf,this.ZMi)};t.prototype.HHg=function(cb){this.EKf=this.HFa(cb,this.EKf,this.XMi)};t.prototype.IHg=function(cb){this.FKf=this.HFa(cb,this.FKf,this.YMi)};t.prototype.HFa=function(cb,nc,Nc){1===cb?nc=this.EVc(nc,Nc):2===cb&&(nc=this.M4c(nc,Nc));return nc};t.prototype.EVc=function(cb,nc){cb||this.$.xa.Pf(nc);cb++;return cb};t.prototype.M4c=function(cb,
nc){if(1>cb)return cb;1===cb&&this.$.xa.rg(nc);cb--;return cb};t.prototype.l6a=function(cb){return!!cb&&!cb.$H};t.prototype.wia=function(cb,nc,Nc,Rc){nc=(void 0===Rc?0:Rc)?cc.a.uW:nc;this.dj.BZ(cb,nc)&&this.Uh.jM(cb,nc,Nc)};Object(lb.a)(t,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Jf=b(169),oc=b(12),hd=b(276),wc=Sys.EventArgs;vm(x,wc);Object(lb.a)(x,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);A.prototype.dispose=function(){this.yHj()};A.prototype.E1i=function(){for(var cb=yl(this.gridView.jn),
nc=cb.next();!nc.done;nc=cb.next())nc=nc.value.domElement,Jf.a.instance.pa(oc.a.pointerDown,nc,this.onPointerDown),hd.a.instance.pa(oc.a.click,nc,this.Vc)};A.prototype.yHj=function(){for(var cb=yl(this.gridView.jn),nc=cb.next();!nc.done;nc=cb.next())nc=nc.value.domElement,Jf.a.instance.za(oc.a.pointerDown,nc,this.onPointerDown),hd.a.instance.za(oc.a.click,nc,this.Vc)};A.prototype.$Mi=function(cb){var nc=cb.sheet;if(this.l6a(nc)){var Nc={};Nc.worksheetId=nc.sheetId;Nc.address=cb.eRg.toString();Nc.offsetX=
cb.offsetX;Nc.offsetY=cb.offsetY;cb=nc.sheetId;this.dj.BZ(21,cb)&&(nc=Ie.a.Hc(Nc),this.Uh.jM(21,cb,nc));cb=cc.a.uW;this.dj.BZ(21,cb)&&(Nc=Ie.a.Hc(Nc),this.Uh.jM(21,cb,Nc))}};A.prototype.l6a=function(cb){return!!cb&&!cb.$H};Object(lb.a)(A,"RichApiEventSingleClickedHandler",null,[]);m.prototype.CZb=function(cb){2E3===cb.messageType&&(1===cb.actionType?(this.HFb||Yb.g(this.$).ha.Qa.hTc(this.cBf),this.HFb++,this.Ihj()):2===cb.actionType&&this.HFb&&(1===this.HFb&&Yb.g(this.$).ha.Qa.LGd(this.cBf),this.HFb--))};
m.prototype.f$c=function(cb){var nc,Nc={};Nc.worksheetId=cb;Nc.revisionLoad=!1;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&($a.EwaSettings.la(749)||$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var Rc=Yb.g(this.$).ha.Qa.ZB;(null===(nc=null===Rc||void 0===Rc?void 0:Rc.floatingObject)||void 0===nc?0:nc.Yc)?Nc.selectedVisualId=Rc.floatingObject.Yc.VisualID:Nc.selectedVisualId=null}nc=
Ie.a.Hc(Nc);cb&&this.dj.BZ(2E3,cb)&&this.Uh.jM(2E3,cb,nc)};m.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};m.prototype.Ihj=function(){var cb=Yb.g(this.$).ha.Qa.ZB;this.Vef(cb)&&(this.Q9a=cb.floatingObject.id,this.J9a=this.Ria())};m.prototype.Vef=function(cb){return!!cb&&cb.upd()};Object(lb.a)(m,"RichApiEventVisualSelectionChangedHandler",null,[]);v.prototype.FHg=function(cb){1===cb.actionType?(this.IFb||this.$Hg(),this.IFb++):2!==cb.actionType||1>this.IFb||(1===this.IFb&&
this.k$g(),this.IFb--)};v.prototype.$Hg=function(){if(this.dj.BZ(2203,cc.a.uW))if(this.$nd){var cb={};cb.timeout=this.$.ya.CheckFocusTimeout;this.A8b=window.requestIdleCallback(this.vve,cb)}else this.A8b=window.setInterval(this.uve,this.$.ya.CheckFocusTimeInterval)};v.prototype.k$g=function(){this.$nd?window.cancelIdleCallback(this.A8b):window.clearInterval(this.A8b)};Object(lb.a)(v,"RichApiEventWorkbookActivatedHandler",null,[]);var gb;(function(cb){cb[cb.none=0]="none";cb[cb.registerEvent=1]="registerEvent";
cb[cb.unregisterEvent=2]="unregisterEvent";cb[cb.customFunction=3]="customFunction";cb[cb.showCard=4]="showCard";cb[cb.createWorkbook=5]="createWorkbook";cb[cb.openWorkbook=6]="openWorkbook";cb[cb.enableEvents=7]="enableEvents";cb[cb.closeWorkbook=8]="closeWorkbook";cb[cb.setCalculationMode=9]="setCalculationMode";cb[cb.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";cb[cb.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";cb[cb.workbookLinksEnableContent=12]="workbookLinksEnableContent";
cb[cb.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";cb[cb.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";cb[cb.rangePicker=15]="rangePicker";cb[cb.enableRichApiRecording=16]="enableRichApiRecording";cb[cb.recordAction=17]="recordAction";cb[cb.focus=18]="focus";cb[cb.businessBarShow=19]="businessBarShow";cb[cb.businessBarHide=20]="businessBarHide"})(gb||(gb={}));Object(lb.b)("PostProcessActionType",gb);var kd=b(234);u.prototype.EHg=function(cb){1===cb.actionType?(this.$.Taa=
!0,Object(rb.a)(b(861).DdaFacade,kd.a(this.$)).e$c(!0)):2===cb.actionType&&(this.$.Taa=!1);this.TBf=cb.controlId;zb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",gb[cb.actionType],this.TBf,this.$.Taa)};u.prototype.ghh=function(cb){Object(rb.a)(b(861).DdaFacade,kd.a(this.$)).PQe(cb,this.$.Taa)};u.prototype.R4h=function(){var cb=this;this.$.Xaa&&uc.TaskExtensions.Ba($b.GetServiceTaskFactory.Xa(this.$.da,
297,298,1),function(nc){(nc=nc.result)&&nc.init(cb.d$c)},this.$.ma,3)};Object(lb.a)(u,"RichApiMacroRecorderEventHandler",null,[]);Object(lb.a)(f,"SessionRecreationInfo",null,[]);l.prototype.Yui=function(){return $a.EwaSettings.la(260)?this.dj.SZh()||!!this.runtimeCalculationMode:!1};l.prototype.PMg=function(){var cb={};cb.eventRegistrationInfos=this.dj.mIh();cb.runtimeCalculationMode=this.runtimeCalculationMode;cb=Object.assign(new f,{runtimeState:cb});var nc={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};nc.RequestBody=JSON.stringify(cb);nc.RequestFlags=1;return nc};Object(lb.a)(l,"RichApiRuntimeStateHandler",null,[]);Object(lb.a)(n,"UserOperationQueueItemsStatisticsData",null,[]);var Lc=b(322),Cb=b(30),Bb=b(16),Hb=b(286),Pb=b(45),ed=b(610),Xc=b(59),ce=b(57),Xd=b(69),nd=Lc.a;vm(k,nd);k.prototype.dispose=function(){this.$&&(this.$.xa.kF(this.ko),this.$.xb.kF(this.ko),this.$.xb.rg(this.Oe),this.$.xa.rg(this.Oe));this.kTa&&(this.kTa.Zo(this.Pe),this.kTa.LH(this.Hm),this.kTa.yq(this.Hg));
$a.EwaSettings.tc()&&this.Us(this.Kxa);this.clearCache();Zc.a.Fa(this.kTa);this.kTa=null;bd.DOMElementExtensions.Sf(this.domElement);nd.prototype.dispose.call(this)};k.prototype.Ahj=function(cb){bd.DOMElementExtensions.Sf(bd.DOMElementExtensions.getElementById(this.domElement,cb.id));this.domElement.appendChild(cb)};k.prototype.Jjd=function(){if(this.Xua&&!this.a2b){var cb=Object(rb.a)(b(861).DdaFacade,kd.a(this.$)).an(this.Xua.InstanceId);cb&&(cb.resize(this.Xua.Width,this.Xua.Height),cb.ja(this.domElement),
cb.showHide(!0),this.a2b=!0)}};k.prototype.n6a=function(){return!0};k.prototype.Qma=function(cb){this.Xua=cb.$c.block.re;this.a2b=!1;this.Jjd()};k.prototype.CSa=function(cb){this.$.fa.xZ&&cb&&(cb.cu||(cb.cu=new Hb.a),cb.cu.Ng=new Pb.a(this.domElement.scrollLeft,this.domElement.scrollTop),cb.cu.sEb=20)};k.prototype.clearCache=function(){this.Ca.$ya(this.hashCode);this.Xua=this.hashCode=null;this.a2b=!1};k.prototype.KRa=function(cb,nc){if(this.isVisible=!!cb&&Xc.p(cb))this.hashCode=this.Ca.hga(cb,ce.a.Hqb,
this.hashCode),this.Iuc(nc)};k.IFa=function(cb){if(!cb.da.Aa(34)){var nc=cb.Ue;cb.da.Ha(34,new k(cb,new ed.a(cb,cb.fa,cb.qa.Ek,3,0),nc.appendChild(nc.ownerDocument.createElement("div"))))}};tl.Object.defineProperties(k.prototype,{Ca:{configurable:!0,enumerable:!0,get:function(){return this.kTa}}});Object(lb.a)(k,"WebExtensionView",Lc.a,[323,151,3]);var je=b(219),Xe=b(519),Ne=b(368),Ig=b(434),Lf=b(163),Hf=b(81),ag=b(126),Bg=b(44),uf=b(42),sf=b(147),xg=b(107),sc=b(70),Sc=b(26),Qc=b(27),ie=b(302),ue=
b(19),Ce=b(14),Be=b(273),le=b(879),hc=b(48),gd=b(143),xd=b(1120),re=b(193),Jc=b(1014),Bc=b(29);b.d(D,"DdaFacade",function(){return a});var ye=pb.a;vm(a,ye);a.prototype.Bke=function(cb){this.addHandler("cd",cb)};a.prototype.e4i=function(cb){this.removeHandler("cd",cb)};a.prototype.Cke=function(cb){this.addHandler("csc",cb)};a.prototype.Eqc=function(cb){this.removeHandler("csc",cb)};a.prototype.Mzg=function(cb){this.addHandler("ca",cb)};a.prototype.d4i=function(cb){this.removeHandler("ca",cb)};a.prototype.Nzg=
function(cb){this.addHandler("ci",cb)};a.prototype.Ozg=function(cb){this.addHandler("ekros",cb)};a.prototype.f4i=function(cb){this.removeHandler("ekros",cb)};a.prototype.GAd=function(cb,nc){try{return JSON.parse(cb)[nc].toLowerCase()}catch(Nc){return""}};a.prototype.foj=function(cb){var nc=this.GAd(cb,"AudienceGroup"),Nc=this.GAd(cb,"SessionOrigin");try{var Rc=parseInt(this.GAd(cb,"Ring"));if("automation"!==nc&&"bluechicken"!==Nc&&-2<=Rc)return!0}catch(Wc){if("automation"!==nc&&"bluechicken"!==Nc)return!0}return!1};
a.prototype.UZb=function(cb){var nc={};nc.Name=cb.Name;nc.BindingType=cb.BindingType;nc.HasHeaders=cb.HasHeaders;cb.IsValidRef&&(nc.ColCount=cb.Reference.LastColumn-cb.Reference.FirstColumn+1,nc.RowCount=cb.Reference.LastRow-cb.Reference.FirstRow+1);return nc};a.prototype.Nji=function(cb,nc){this.Ml.launchInsertDialog(cb,null,this.VLg(nc))};a.prototype.vDd=function(cb,nc){var Nc={};Nc.callbackFunc=cb;Nc.storeType=OSF.StoreTypeEnum.MarketPlace;Nc.fromInsertDialog=!1;Nc.refresh=nc;this.Ml.queryEntitlementDetails(Nc)};
a.prototype.invokeDdaMethod=function(cb,nc){var Nc=this.an(cb.DdaMethod.ControlId);Nc?Nc.invokeDdaMethod(cb,nc):this.vf(ka.a.internalError,nc)};a.prototype.registerDdaEventAsync=function(cb,nc,Nc,Rc,Wc){(nc=this.an(nc))?a.yxb(cb)?nc.k0i(cb,Nc,Rc,Wc):this.vf(ka.a.aAd,Wc):this.vf(ka.a.internalError,Wc)};a.prototype.unregisterDdaEventAsync=function(cb,nc,Nc,Rc,Wc){(nc=this.an(nc))?a.yxb(cb)?nc.dHj(cb,Nc,Rc,Wc):this.vf(ka.a.aAd,Wc):this.vf(ka.a.internalError,Wc)};a.prototype.dispose=function(){this.disposed||
(this.$.ml(this.od),this.fa.kk(this.Zc),this.fa.lW(this.vq),this.fa.mw(this.Kf),this.oUc.detach(this),this.$.userOperationManager.pz(this.bR),this.inc=this.Cf=this.Uh=this.oUc=this.vb=null,this.hIa&&(this.hIa.dispose(),this.hIa=null),Zc.a.Fa(this.pJd),Zc.a.Fa(this.oJd),this.$_a&&(this.$_a.dispose(),this.$_a=null),ye.prototype.dispose.call(this),this.disposed=!0,zb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.i$b=function(cb){return(cb=this.an(cb))?cb.getDefaultIconUrl():
null};a.prototype.buc=function(cb){if(this.OCe!==cb){this.OCe=cb;for(var nc=0,Nc=this.Cf.length;nc<Nc;nc++){var Rc=this.Cf[nc];cb?Rc.fFe(!1):Rc.Wfh()}this.pJd.buc(cb);this.oJd.buc(cb)}};a.prototype.ZGh=function(cb){return(cb=this.an(cb))?cb.getDefaultDisplayName():null};a.prototype.vf=function(cb,nc,Nc){var Rc={};Rc[bb.a.Kg]=cb;Rc[bb.a.e3]=nc;this.LJ(451041795,Rc,void 0===Nc?!0:Nc)};a.prototype.Au=function(cb){var nc={};nc[bb.a.e3]=cb;this.LJ(1237877382,nc)};a.prototype.LJ=function(cb,nc,Nc){var Rc=
this;Nc=void 0===Nc?!0:Nc;var Wc=new Ac.a(cb,0,this.$.ed,0,null),fe=nc?nc[bb.a.e3]:null;this.$_a&&Yb.g(this.$).isEditing&&Q.OVg(cb,nc)?this.$_a.e9g(cb,nc):(cb=this.$.Ka.Zb(Wc,nc),Nc&&uc.TaskExtensions.Ba(cb,function(ve){sf.a(ve)?Rc.vf(ka.a.internalError,fe,!1):ve.result||(Yb.g(Rc.$).isEditing?Rc.vf(ka.a.Twb,fe,!1):Rc.vf(ka.a.internalError,fe,!1))},this.ma,8))};a.prototype.kYg=function(cb){var nc=this;return!!this.via(function(Nc){return a.getSolutionId(Nc.cl,nc.$)===a.getSolutionId(cb,nc.$)&&Nc.cl.PrimaryMarketplace.MarketplaceType===
cb.PrimaryMarketplace.MarketplaceType&&Nc.cl.PrimaryMarketplace.MarketplaceRef===cb.PrimaryMarketplace.MarketplaceRef&&Nc.cl.PrimaryMarketplace.SolutionVersion===cb.PrimaryMarketplace.SolutionVersion})};a.prototype.an=function(cb){return this.via(function(nc){return nc.controlId.startsWith(cb)})};a.prototype.Gvh=function(cb){return this.via(function(nc){return nc.rHa===cb})};a.prototype.nQe=function(cb){return this.via(function(nc){return nc.VT===cb&&!!nc.rHa})};a.prototype.EQe=function(cb,nc,Nc,
Rc){return this.via(function(Wc){return Wc.VT===cb&&Wc.cl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===nc.toLowerCase()&&Wc.cl.PrimaryMarketplace.MarketplaceType.toLowerCase()===Nc.toLowerCase()&&!!Wc.cl.SharedRuntime&&!!Wc.cl.SharedRuntime.Resid&&!!Rc&&!!Rc.Resid&&Wc.cl.SharedRuntime.Resid.toLowerCase()===Rc.Resid.toLowerCase()})};a.prototype.rHg=function(cb,nc){if(cb=this.an(cb))cb.ja(nc),cb.showHide(!0)};a.prototype.ssj=function(cb){(cb=this.an(cb))&&cb.showHide(!1)};a.prototype.z_a=function(cb){if(1!==
cb.WebExtensionType||this.$.Fd&8388608&&cb.TaskpaneVisible||this.$.Fd&8388608&&!cb.TaskpaneVisible&&Kd.HelperMethods.Vv(cb)){var nc=null;Kd.HelperMethods.Vv(cb)&&(nc=a.nua(cb,this.$),cb.TaskpaneWidth||(cb.TaskpaneWidth=this.k4b));var Nc=(new U(this,this.Uh,cb)).ujd();zb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.SolutionId),
cb.PrimaryMarketplace.MarketplaceType,Kd.HelperMethods.Vv(cb));nc&&(Nc.rHa=nc);Array.add(this.Cf,Nc);this.Fwa=null;this.F4a(cb.InstanceId)||(cb=String.format("{0}|{1}|{2}|{3}|{4}",cb.PrimaryMarketplace.SolutionId,cb.PrimaryMarketplace.SolutionVersion,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.MarketplaceType,cb.WebExtensionType),this.raiseEvent("ci",cb))}};a.prototype.euj=function(cb,nc){function Nc(){Rc.xPa(fe.controlId);Rc.Gi.purgeOsfControl(fe.controlId,!1);nc()}var Rc=this;cb.TaskpaneWidth=
this.k4b;cb.TaskpaneVisible=!0;var Wc={};Wc.SolutionId=cb.PrimaryMarketplace.SolutionId;Wc.TargetType=cb.WebExtensionType;Wc.Version=cb.PrimaryMarketplace.SolutionVersion;Wc.StoreType=cb.PrimaryMarketplace.MarketplaceType;Wc.StoreId=cb.PrimaryMarketplace.MarketplaceRef;Wc.AssetId=cb.PrimaryMarketplace.SolutionId;Wc.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef;Wc.Width=cb.TaskpaneWidth;Wc.Id=cb.PrimaryMarketplace.SolutionId;Wc.AppVersion=cb.PrimaryMarketplace.SolutionVersion;Wc.CurrentStoreType=
cb.PrimaryMarketplace.MarketplaceType;var fe=new U(this,this.Uh,cb,!0);fe.ujd();Array.add(this.Cf,fe);var ve=null;ve=Bg.a.instance.XB(function(){fe.Px&&(Zc.a.Fa(ve),ve=null,Rc.Gi.insertBlankControlWithErrorUX(Rc.AEb(fe,Wc),Nc))},100,uf.a.X7g)};a.prototype.R0g=function(cb){var nc=this;if(cb&&cb.length){var Nc=[];cb.forEach(function(Rc){if(Rc.ContainsCustomFunctions){var Wc=a.nua(Rc,nc.$);nc.bBd.contains(Wc)||(nc.bBd.add(Wc),Array.add(nc.jDf,Rc));nc.kYg(Rc)||Array.add(Nc,Rc)}});Nc.length&&this.hAe(Nc)}};
a.prototype.YBe=function(cb,nc){this.an(cb.InstanceId)||(nc=nc(),cb=(new U(this,this.Uh,cb)).C7e(nc),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.Nrj=function(cb){a.S_a.wb(cb)&&a.S_a.na(cb).initializeAndShowWithTitle()};a.prototype.N_h=function(cb){a.S_a.wb(cb)&&a.S_a.na(cb).hide()};a.prototype.FNh=function(cb){var nc=this,Nc=null,Rc,Wc=null;var fe=a.Rfd(cb,!0);if(!fe)return zb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Bd.Task.Ta(null);
(Rc=this.Ml.getOsfControl(a.getSolutionId(fe,this.$)))&&(Nc=Rc.getManifest())&&(Wc=Nc.getSharedRuntimeForCustomFunctions("Workbook"));if(Nc=Wc&&1===Wc.LifeTime?this.EQe(fe.PrimaryMarketplace.SolutionId,fe.PrimaryMarketplace.MarketplaceRef,fe.PrimaryMarketplace.MarketplaceType,Wc):this.Gvh(cb))return Bd.Task.Ta(Nc.controlId);var ve=new Ta.a;Kd.HelperMethods.Tgc(Wc)&&(fe.SharedRuntime=Wc);cb=Rc?Rc.getNotificationParams():[];if(!cb.length)return this.JAe(fe);this.TZf(cb,function(){uc.TaskExtensions.Ba(ve.task,
function(){nc.JAe(fe)},nc.ma,3)},function(){});return ve.task};a.prototype.lCh=function(cb){cb=a.Rfd(cb,!1);if(!cb)return zb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var nc=null,Nc=this.Ml.getOsfControl(a.getSolutionId(cb,this.$));Nc&&(Nc=Nc.getManifest())&&(nc=Nc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Kd.HelperMethods.Tgc(nc)&&(cb=this.EQe(cb.PrimaryMarketplace.SolutionId,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.MarketplaceType,
nc))?cb.controlId:null};a.prototype.o_g=function(cb,nc){var Nc=this,Rc=a.Rfd(cb,!1);if(Rc){var Wc=null,fe=this.Ml.getOsfControl(a.getSolutionId(Rc,this.$));fe&&(fe=fe.getManifest())&&(Wc=fe.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Kd.HelperMethods.Tgc(Wc)){Rc.SharedRuntime=Wc;var ve=Rc.PrimaryMarketplace.SolutionId;fe=Rc.PrimaryMarketplace.SolutionVersion;var kc=OSF.OsfManifestManager.getCachedManifest(ve,fe);if(kc)if(this.fYb.wb(cb))Wc=this.fYb.na(cb),uc.TaskExtensions.Ba(Wc,function(wd){(wd=
wd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wd,nc,Nc.Uh.SHb)},this.ma,3);else{var ad={solutionId:ve,version:fe};ad.storeType=Rc.PrimaryMarketplace.MarketplaceType;ad.storeId=Rc.PrimaryMarketplace.MarketplaceRef;ad.assetId=ve;ad.assetStoreId=null;ad.targetType=OSF.OsfControlTarget.TaskPane;var yd=new Ta.a;Rc=uc.TaskExtensions.om();Rc=new E.a(this.$,this,ad,Rc);Wc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(ve,Wc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(kc,
Wc,fe);Rc.createUILessSandbox(ad,kc,function(wd,pe){wd&&!pe?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wd,nc,Nc.Uh.SHb),yd.setResult(wd)):yd.setResult(null);Nc.fYb.remove(cb)});this.fYb.ia(cb,yd.task)}}}else zb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.gve=function(cb){(cb=this.nQe(cb))&&(cb.cl.SharedRuntime||this.QFb(cb.controlId))};a.prototype.QFb=function(cb){(cb=this.nQe(cb))&&this.xPa(cb.controlId)};
a.prototype.gch=function(cb,nc){if(!this.Cf||!cb||!nc)return!1;if(cb.toLowerCase()===nc.toLowerCase())return!0;for(var Nc=null,Rc=null,Wc=0,fe=this.Cf.length;Wc<fe;Wc++){var ve=this.Cf[Wc];if(ve.ownerAddinSolutionId&&(ve.controlId===cb&&(Nc=ve.ownerAddinSolutionId.toLowerCase()),ve.controlId===nc&&(Rc=ve.ownerAddinSolutionId.toLowerCase()),Nc&&Rc))break}return Nc&&Nc===Rc?!0:!1};a.prototype.sxg=function(cb){this.an(cb.InstanceId)||(cb=new U(this,this.Uh,cb),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.xLf=
function(cb){if(this.Cf&&0<=cb&&cb<this.Cf.length){var nc=this.Cf[cb],Nc=nc.Px;Array.removeAt(this.Cf,cb);this.Gsf(nc);bd.DOMElementExtensions.Sf(Nc)}};a.prototype.xPa=function(cb){if(this.Cf)for(var nc=0,Nc=this.Cf.length;nc<Nc;nc++)if(this.Cf[nc].controlId===cb){this.xLf(nc);break}};a.prototype.f3i=function(cb){if(this.Cf){cb=cb.toLowerCase();for(var nc=0,Nc=this.Cf.length;nc<Nc;nc++)if(cb===this.Cf[nc].ownerAddinSolutionId.toLowerCase()){this.xLf(nc);break}}};a.prototype.ZHg=function(cb){cb.Bt&&
(this.an(cb.floatingObject.cl.InstanceId)||(this.Sdc(cb.floatingObject.cl.InstanceId)||Array.add(this.inc,cb.floatingObject.cl.InstanceId),this.z_a(cb.floatingObject.cl)),this.fa.isNamedObjectViewMode&&this.rHg(cb.floatingObject.cl.InstanceId,cb.Pd))};a.prototype.T$=function(cb){if(this.Cf)for(var nc=0,Nc=this.Cf.length;nc<Nc;nc++)if(1===this.Cf[nc].controlType&&ue.a.equals(this.Cf[nc].VT,cb,!0))return this.Cf[nc].controlId;return null};a.prototype.fvh=function(cb){var nc=[];if(this.Cf)for(var Nc=
0,Rc=this.Cf.length;Nc<Rc;Nc++)ue.a.equals(this.Cf[Nc].VT,cb,!0)&&nc.push(this.Cf[Nc].controlId);return nc};a.prototype.Nvh=function(cb,nc){if(!nc||!cb)return null;if(this.Cf)for(var Nc=0,Rc=this.Cf.length;Nc<Rc;Nc++)if(1===this.Cf[Nc].controlType&&ue.a.equals(this.Cf[Nc].VT,cb,!0)&&this.Cf[Nc].cl.SharedRuntime&&ue.a.equals(this.Cf[Nc].cl.SharedRuntime.Resid,nc.Resid,!0))return this.Cf[Nc].controlId;return null};a.prototype.kJa=function(cb,nc){nc=void 0===nc?null:nc;return cb?nc?String.format("{0}.{1}",
cb,nc):cb:""};a.prototype.jve=function(cb,nc,Nc){if(this.Fwa===cb)return!0;this.Fwa=cb;var Rc=null,Wc=!1;if(!Rc&&this.Cf)for(var fe=0,ve=this.Cf.length;fe<ve;fe++)if(1===this.Cf[fe].controlType&&ue.a.equals(this.Cf[fe].VT,cb,!0)){var kc=!1,ad=!1;nc?(kc=!0,ad=!!this.Cf[fe].cl.SharedRuntime&&ue.a.equals(this.Cf[fe].cl.SharedRuntime.Resid,nc.Resid,!0)):Nc&&(kc=!0,ad=ue.a.equals(this.Cf[fe].cl.SharedRuntimeId,Nc,!0));if(!kc||ad){ad&&this.Cf[fe].Lf(!0);Rc=this.Cf[fe].controlId;Wc=!0;this.Fwa=null;break}}Rc&&
this.raiseEvent("ca",Rc);return Wc};a.prototype.setAppRuntimeState=function(cb,nc){var Nc;if(cb){var Rc=this.an(cb);if(Rc&&Kd.HelperMethods.Vv(Rc.cl))Rc.Lf(nc),nc&&(this.raiseEvent("ca",cb),(null===(Nc=Rc.Px)||void 0===Nc?0:Nc.firstChild)&&(cb=Rc.Px.firstChild.title)&&0<cb.length&&this.nZb.Afj(cb));else throw zb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ce.a.instance.ea(2174));}else throw zb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ce.a.instance.ea(2175));};a.prototype.getAppRuntimeState=function(cb){if(cb)if((cb=this.an(cb))&&Kd.HelperMethods.Vv(cb.cl))cb=cb.cl.TaskpaneVisible;else throw zb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ce.a.instance.ea(2174));else throw zb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ce.a.instance.ea(2175));return cb};a.prototype.z1a=function(cb,nc){return(cb=
this.an(cb))?cb.z1a(nc):null};a.prototype.F4a=function(cb){return this.lve(this.inc,cb)};a.prototype.Sdc=function(cb){return this.lve(this.JCe,cb)};a.prototype.Wie=function(cb){Array.add(this.JCe,cb)};a.prototype.XY=function(cb){return(cb=this.an(cb))?cb.cl:null};a.prototype.fwd=function(cb){this.raiseEvent("ekros",cb,this)};a.prototype.Fzd=function(cb){if(cb){var nc=this.an(cb.InstanceId);nc&&(cb.SharedRuntime||cb.SharedRuntimeId||(this.xPa(nc.controlId),this.Gi.purgeOsfControl(nc.controlId,!1)),
nc={},nc.SolutionId=cb.PrimaryMarketplace.SolutionId,nc.TargetType=cb.WebExtensionType,nc.Version=cb.PrimaryMarketplace.SolutionVersion,nc.StoreType=cb.PrimaryMarketplace.MarketplaceType,nc.StoreId=cb.PrimaryMarketplace.MarketplaceRef,nc.AssetId=cb.PrimaryMarketplace.SolutionId,nc.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef,nc.Width=cb.TaskpaneWidth,nc.SharedRuntimeId=cb.SharedRuntimeId,nc.Id=cb.PrimaryMarketplace.SolutionId,nc.AppVersion=cb.PrimaryMarketplace.SolutionVersion,nc.CurrentStoreType=
cb.PrimaryMarketplace.MarketplaceType,this.N6f(nc))}};a.prototype.cia=function(){this.Uh.cia()};a.prototype.jM=function(cb,nc,Nc){this.Uh.jM(cb,nc,Nc)};a.prototype.Jfj=function(cb,nc){var Nc=Array(2);Nc[0]=nc;Nc[1]=null;this.Uh.bwh(cb,JSON.stringify(Nc))};a.prototype.PQe=function(cb,nc){nc=a.z4g(nc);cb=this.XY(cb);this.Uh.j8b(cb.InstanceId,2202,cc.a.uW,nc)};a.prototype.e$c=function(cb){for(var nc=0,Nc=this.Cf.length;nc<Nc;nc++)this.PQe(this.Cf[nc].controlId,cb)};a.prototype.Yvh=function(cb,nc){nc=
a.U_g(nc);this.Uh.j8b(cb,65539,"",nc)};a.prototype.$vh=function(cb,nc,Nc){this.Uh.j8b(cb,1,nc,Nc)};a.prototype.Xvh=function(cb,nc){this.Uh.awh(cb,nc)};a.prototype.l_g=function(cb,nc){return[[2,1E3,"",JSON.stringify([cb,nc]),0,!1]]};a.prototype.Z8h=function(){return!!this.qma&&this.qma.S3e()};a.prototype.sTg=function(){this.qma&&this.qma.clear()};a.prototype.Zvh=function(){if(this.qma&&this.qma.S3e()){var cb=this.qma.nCh();cb=yl(cb);for(var nc=cb.next();!nc.done;nc=cb.next()){nc=this.fvh(nc.value);
nc=yl(nc);for(var Nc=nc.next();!Nc.done;Nc=nc.next())this.Uh.j8b(Nc.value,65540,"","{}")}}};a.prototype.e0i=function(cb){this.qma.add(cb)};a.prototype.$Gj=function(cb){this.qma.remove(cb)};a.prototype.via=function(cb){if(!this.Cf)return null;for(var nc=yl(this.Cf),Nc=nc.next();!Nc.done;Nc=nc.next())if(Nc=Nc.value,cb(Nc))return Nc;return null};a.prototype.JAe=function(cb){var nc=this,Nc=new Ta.a,Rc=a.nua(cb,this.$);if(Kd.HelperMethods.Vv(cb))zb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.gDf(cb,function(fe){fe?(cb.InstanceId=fe.InstanceId,cb.WebExtensionOsfControlType=3,cb.TaskpaneVisible=!1,nc.z_a(cb),Nc.setResult(cb.InstanceId)):(zb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.SolutionId)),Nc.setException(Error.create("Null insert data")))});else{a.S_a.ia(cb.InstanceId,new Ra.a);var Wc=a.S_a.na(cb.InstanceId).k0a;
this.Q0g(cb,Wc,Rc);this.gDf(cb,null);Nc.setResult(cb.InstanceId)}return Nc.task};a.prototype.Q0g=function(cb,nc,Nc){this.an(cb.InstanceId)||(cb=new U(this,this.Uh,cb),cb.rHa=Nc,cb.C7e(nc),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.gDf=function(cb,nc){var Nc=a.nua(cb,this.$);if(!this.bBd.contains(Nc))this.ZDb.push(cb),1<=this.ZDb.length&&this.hDf(cb,nc);else if(nc){cb=yl(this.jDf);for(var Rc=cb.next();!Rc.done;Rc=cb.next())if(Rc=Rc.value,a.nua(Rc,this.$)===Nc){nc(Rc,0);break}}};a.prototype.hDf=
function(cb,nc){function Nc(wd){wd&&!ie.a(wd)||zb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(ve.StoreType,ve.StoreId,ve.SolutionId),Qc.a.Uc(wd.Errors));Wc.ZDb.shift();0<Wc.ZDb.length&&Wc.hDf(Wc.ZDb[0],nc)}function Rc(wd){wd=ag.a.yg(wd.data);zb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",Qc.a.Uc(wd))}var Wc=this,
fe=null,ve={};ve.SolutionId=a.getSolutionId(cb,this.$);ve.TargetType=cb.WebExtensionType;ve.Version=cb.PrimaryMarketplace.SolutionVersion;ve.StoreType=cb.PrimaryMarketplace.MarketplaceType;ve.StoreId=cb.PrimaryMarketplace.MarketplaceRef;ve.AssetId=cb.PrimaryMarketplace.SolutionId;ve.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef;ve.Width=cb.TaskpaneWidth;ve.ContainsCustomFunctions=!0;ve.Id=a.getSolutionId(cb,this.$);ve.AppVersion=cb.PrimaryMarketplace.SolutionVersion;ve.CurrentStoreType=cb.PrimaryMarketplace.MarketplaceType;
Kd.HelperMethods.Vv(cb)&&(ve.SharedRuntimeId=cb.SharedRuntime.Resid);var kc=this.$.qa.ta;cb=this.$.qa.ta.Xb();var ad=kc.Oa(9,cb);ad.sharedInfo=ve;if(nc){var yd=function(wd){var pe=wd.Result;(fe=pe?pe.AgaveData:null)||nc(null,wd.Errors?wd.Errors[0].ErrorCause:5001);nc(fe,0)};cb=function(wd,pe,bf){return Hf.i(kc,"InsertAgaveTaskpane",ad,Be.b(wd,Nc,yd),Be.a(pe,Rc),bf,null,0)}}else cb=function(wd,pe,bf){return Hf.i(kc,"InsertAgaveTaskpane",ad,Be.b(wd,Nc),Be.a(pe,Rc),bf,null,0)};$a.EwaSettings.tc()?Ne.a(this.$.userOperationManager,
cb,function(wd){return new Lf.a(519,0,wd,64)},null):Ne.a(this.$.userOperationManager,cb,function(wd){return new Xe.a(519,0,wd)},null)};a.prototype.Xoj=function(){return this.$.ig.get(35)};a.prototype.pGd=function(cb){cb=this.an(cb);(null===cb||void 0===cb?0:cb.Wca)&&cb.DLf()};a.prototype.jwi=function(cb){var nc=this.via(function(Nc){return a.nLa(Nc.VT)});nc&&(nc=this.Gi.getOsfControl(nc.controlId))&&nc.notifyAgave(OSF.AgaveHostAction.SendMessage,cb)};a.prototype.H9h=function(){return!!this.via(function(cb){return 1===
cb.controlType&&a.nLa(cb.VT)})};a.prototype.G9h=function(){var cb=this.via(function(nc){return a.nLa(nc.VT)});return cb?cb.Px?bd.DOMElementExtensions.isVisible(cb.Px):!1:!1};a.prototype.zij=function(){var cb=this.via(function(nc){return a.nLa(nc.VT)});cb&&(cb.Lf(!0),this.raiseEvent("ca",cb.controlId))};a.prototype.initialize=function(){var cb=b(1346).DdaEventDispatch,nc=void 0===this.$||null===this.$||$a.EwaSettings.la(260);void 0!==this.$&&null!==this.$||zb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");
nc&&zb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(k.IFa(this.$),this.fa=this.$.fa,this.Uh=new cb(this.$),this.$.Rk(this.od),this.fa.Sj(this.Zc),this.fa.aP(this.vq),this.fa.jt(this.Kf),this.$.userOperationManager.uy(this.bR),this.Lhf(),this.EGi(),this.e4h(),this.$.da.Ha(35,this),this.oUc.ja(this),nc&&zb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Hce=new cc.a,nc&&zb.ULS.sendTraceTag(537170521,
0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Kce=new t(this.$,this.dj,this.Uh),this.yqg=new A(this.$,this.dj,this.Uh),this.Ice=new G(this.$,this.dj,this.Uh),this.Gce=new r(this.$,this.dj,this.Uh),this.Fce=new w(this.$,this.dj,this.Uh),this.Jce=new z(this.$,this.dj,this.Uh),this.Lce=new m(this.$,this.dj,this.Uh),this.Mce=new v(this.$,this.dj,this.Uh),this.$.Xaa&&(this.Nce=new u(this.$,this.dj,this.Uh)),$a.EwaSettings.la(190)&&(this.$_a=new Q(this,Yb.g(this.$))),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.Ece=new B),this.initialized=!0,zb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.Tvh=function(cb){if(!this.rBa)return null;for(var nc=0,Nc=this.rBa.length;nc<Nc;nc++)if(cb.startsWith(this.rBa[nc].WebExtensionId))return this.rBa[nc];return null};a.prototype.Lhf=function(){var cb,nc=this.fa;if(nc.oc&&!this.uNb){if(nc.workbookContext){if(this.cRc=this.$.fa.jh.get(22),null===(cb=nc.workbookContext.WebExtensions)||void 0===cb?0:cb.length){cb=nc.workbookContext.WebExtensions;
nc=!1;for(var Nc={},Rc=cb.length-1;0<=Rc;Nc={ONb:Nc.ONb},Rc--){if(!this.fa.isNamedObjectViewMode){Array.add(this.inc,cb[Rc].InstanceId);if(1!==cb[Rc].WebExtensionType){Array.removeAt(cb,Rc);continue}if(Kd.HelperMethods.Vv(cb[Rc])&&cb[Rc].SharedRuntime.State)1===cb[Rc].SharedRuntime.State?cb[Rc].TaskpaneVisible=!1:2===cb[Rc].SharedRuntime.State?cb[Rc].TaskpaneVisible=!0:zb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!cb[Rc].ContainsCustomFunctions&&!cb[Rc].TaskpaneVisible&&
!Aa.a(cb[Rc])){Array.removeAt(cb,Rc);continue}}var Wc=OSF.OsfControl.isFirstPartyStoreString(cb[Rc].PrimaryMarketplace.MarketplaceType);$a.EwaSettings.la(186)&&!Wc&&(Array.removeAt(cb,Rc),nc||(nc=!0,Nc.ONb=$b.GetServiceTaskFactory.Xa(this.$.da,5,4,3),uc.TaskExtensions.Ba(Nc.ONb,function(fe){return function(){fe.ONb.result.hg(35,null)}}(Nc),this.ma,3)));$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&cb[Rc].PrimaryMarketplace&&a.nLa(cb[Rc].PrimaryMarketplace.SolutionId)&&
(zb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(cb,Rc))}this.hAe(cb)}}else this.cRc=!1;this.uNb=!0}};a.prototype.n2e=function(cb){var nc=Yb.g(this.$),Nc=nc.ha.Qa.nc;if(Nc&&cb){cb=!1;if(this.Cf)for(var Rc=yl(this.Cf),Wc=Rc.next();!Wc.done;Wc=Rc.next())if(Wc=Wc.value,a.nLa(Wc.VT)||a.Cbi(Wc.VT)){cb=!0;break}cb||nc.ha.Qa.wG(Nc)}};a.prototype.EGi=function(){this.Gi&&this.fa.isNamedObjectViewMode&&this.$.oa&&Xc.p(this.$.oa)&&(this.$.da.Aa(34).uQ?
this.$.da.Aa(34).Jjd():this.$.da.Aa(34).Nq(this.EMi))};a.prototype.hAe=function(cb){var nc=this,Nc=null;Nc=function(fe){function ve(){nc.yOa.shift();0<nc.yOa.length&&Nc(nc.yOa[0])}var kc=fe.WebExtensionData,ad=fe.IsTaskPane,yd=fe.RecordHandler;if(nc.T$(kc.PrimaryMarketplace.SolutionId))ve();else{ad&&(kc.WebExtensionOsfControlType=1);var wd=Aa.a(kc);if(!ad||kc.TaskpaneVisible||wd||kc.SharedRuntime&&kc.SharedRuntime.State||kc.ContainsCustomFunctions){var pe=new U(nc,nc.Uh,kc,!ad);zb.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(kc.PrimaryMarketplace.MarketplaceType,kc.PrimaryMarketplace.MarketplaceRef,kc.PrimaryMarketplace.SolutionId),kc.PrimaryMarketplace.MarketplaceType,Kd.HelperMethods.Vv(kc));pe.ujd();Kd.HelperMethods.Vv(kc)&&(pe.rHa=a.nua(kc,nc.$),kc.TaskpaneWidth=nc.k4b);wd&&(kc.WebExtensionToolTip="");ad&&kc.TaskpaneVisible&&!wd&&(kc.TaskpaneWidth=nc.k4b);Array.add(nc.Cf,pe);var bf=nc.Fwa=
null;bf=Bg.a.instance.XB(function(){pe.Px&&(Zc.a.Fa(bf),bf=null,yd&&yd(fe,pe),ve())},100,uf.a.W7g)}else ve()}};for(var Rc={},Wc=0;Wc<cb.length;Rc={R0:Rc.R0},Wc++)if(!this.an(cb[Wc].InstanceId))if(1!==cb[Wc].WebExtensionType)this.z_a(cb[Wc]);else if(!$a.EwaSettings.la(53))this.zlb(cb[Wc],Nc);else if(this.$.Fd&8388608||cb[Wc].TaskpaneVisible)Rc.R0={},Rc.R0.marketplaceId=cb[Wc].PrimaryMarketplace.SolutionId,Rc.R0.marketplaceVersion=cb[Wc].PrimaryMarketplace.SolutionVersion,Rc.R0.storeType=cb[Wc].PrimaryMarketplace.MarketplaceType,
Rc.R0.storeId=cb[Wc].PrimaryMarketplace.MarketplaceRef,Rc.R0.targetData=cb[Wc],this.Gi.isAddinCommandsAsync(Rc.R0,function(fe){return function(ve,kc,ad){if(ve){var yd=ad.targetData;if(kc){if($a.EwaSettings.la(87))if(fe.R0.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())ve=fe.R0.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),kc=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&fe.R0.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(ve||kc)&&Kd.HelperMethods.Vv(yd)&&nc.zlb(yd,Nc);else if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))nc.SXh(ad,Nc);else{var wd=!1;nc.vDd(function(pe){if(!pe.errorCode){if(pe.value){pe=yl(pe.value);for(var bf=pe.next();!bf.done&&!wd;bf=pe.next())wd=re.c(bf.value[1])===re.c(yd.PrimaryMarketplace.SolutionId)}wd?Kd.HelperMethods.Vv(yd)&&nc.zlb(yd,Nc):(pe={},pe.SolutionId=ad.marketplaceId,pe.TargetType=yd.WebExtensionType,pe.Version=ad.marketplaceVersion,
pe.StoreType=yd.PrimaryMarketplace.MarketplaceType,pe.StoreId=ad.storeId,pe.AssetId=ad.marketplaceId,pe.AssetStoreId=ad.storeId,pe.Width=yd.TaskpaneWidth,yd.TaskpaneVisible=!0,pe.Id=ad.marketplaceId,pe.AppVersion=ad.marketplaceVersion,pe.CurrentStoreType=yd.PrimaryMarketplace.MarketplaceType,nc.Ehe(pe,yd,Nc))}},!0)}}else nc.zlb(yd,Nc)}else ve=ad.targetData,zb.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(ve.PrimaryMarketplace.MarketplaceType,
ve.PrimaryMarketplace.MarketplaceRef,ve.PrimaryMarketplace.SolutionId),ve.PrimaryMarketplace.MarketplaceType)}}(Rc))};a.prototype.SXh=function(cb,nc){var Nc=this,Rc=!1;this.vDd(function(Wc){var fe=cb.targetData;if(!Wc.errorCode){if(Wc.value){Wc=yl(Wc.value);for(var ve=Wc.next();!ve.done&&!Rc;ve=Wc.next())Rc=re.c(ve.value[1])===re.c(fe.PrimaryMarketplace.SolutionId)}Rc?Kd.HelperMethods.Vv(fe)&&Nc.zlb(fe,nc):(Wc={},Wc.SolutionId=cb.marketplaceId,Wc.TargetType=fe.WebExtensionType,Wc.Version=cb.marketplaceVersion,
Wc.StoreType=fe.PrimaryMarketplace.MarketplaceType,Wc.StoreId=cb.storeId,Wc.AssetId=cb.marketplaceId,Wc.AssetStoreId=cb.storeId,Wc.Width=fe.TaskpaneWidth,Wc.Id=cb.marketplaceId,Wc.AppVersion=cb.marketplaceVersion,Wc.CurrentStoreType=fe.PrimaryMarketplace.MarketplaceType,fe.TaskpaneVisible=!0,Nc.Ehe(Wc,fe,nc))}},!0)};a.prototype.zlb=function(cb,nc){var Nc={};Nc.WebExtensionData=cb;Nc.IsTaskPane=!0;this.yOa.push(Nc);1===this.yOa.length&&nc(Nc)};a.prototype.Ehe=function(cb,nc,Nc){var Rc=this,Wc={};Wc.ActivationInfo=
cb;Wc.WebExtensionData=nc;Wc.IsTaskPane=!1;Wc.RecordHandler=function(fe,ve){var kc=fe.ActivationInfo;Rc.Gi.insertBlankControlWithErrorUX(Rc.AEb(ve,kc),function(){Rc.xPa(ve.controlId);Rc.Gi.purgeOsfControl(ve.controlId,!1);Rc.N6f(kc)})};this.yOa.push(Wc);1===this.yOa.length&&Nc(Wc)};a.prototype.N6f=function(cb){var nc={};nc.solutionId=cb.SolutionId;nc.version=cb.Version;nc.storeType=cb.StoreType;nc.storeId=cb.StoreId;nc.assetId=cb.AssetId;nc.assetStoreId=cb.AssetStoreId;nc.targetType=cb.TargetType;
nc.sharedRuntimeId=cb.SharedRuntimeId;nc.id=cb.Id;nc.currentStoreType=cb.CurrentStoreType;nc.appVersion=cb.AppVersion;cb=new fb.a;cb.add(nc);nc={};nc[Ja.a.hFa]=cb;nc[Ja.a.bJ]=3;cb=new Ac.a(Bc.a.Fzb,0,this.$.ed,0,null);this.$.Ka.Zb(cb,nc)};a.prototype.AEb=function(cb,nc){var Nc={};Nc.div=cb.Px;Nc.id=cb.controlId;Nc.solutionId=nc.SolutionId;Nc.version=nc.Version;Nc.storeId=nc.StoreId;Nc.storeType=nc.StoreType;Nc.osfControlType=OSF.OsfControlTarget.TaskPane;Nc.marketplaceID=nc.Id;Nc.marketplaceVersion=
nc.AppVersion;Nc.store=nc.StoreId;return Nc};a.prototype.rPf=function(){var cb=this;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var nc=[],Nc=0;Nc<this.Cf.length;Nc++){var Rc=this.Cf[Nc];Rc.osfControlType&&3!==Rc.osfControlType&&4!==Rc.osfControlType||Array.add(nc,Rc)}Nc=!1;for(Rc=0;Rc<nc.length;Rc++){var Wc=nc[Rc];this.xPa(Wc.controlId);!Nc&&Wc&&Wc.cl&&(Nc=Kd.HelperMethods.Vv(Wc.cl))}Nc&&(nc={},nc=(nc.DynamicAddinCommandsMethodDispatchId=4,nc),
this.LJ(-1014260128,nc))}$a.EwaSettings.la(412)&&uc.TaskExtensions.Ba($b.GetServiceTaskFactory.Xa(this.$.da,278,279,3),function(fe){fe&&(fe=fe.result)&&(cb.$.da.Aa(278)||cb.$.da.Ha(278,fe),fe.F8e().tma())},this.ma,3)};a.prototype.GK=function(){var cb=this,nc=new l(this.$,this.dj,this.oQf);void 0===this.$||null===this.$?zb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):$a.EwaSettings.la(260)&&zb.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.dj||null===this.dj));if(nc.Yui()){var Nc=function(){},Rc=function(ve){ve=ag.a.yg(ve.data);zb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",Qc.a.Uc(ve))},Wc=nc.PMg();nc=function(ve,kc,ad){return Hf.i(cb.$.qa.ta,"ExecuteRichApiRequest",cb.QMg(Wc),Be.b(ve,Nc),Be.a(kc,Rc),ad,null,0)};var fe=a.Tdd(Wc);$a.EwaSettings.tc()?this.$.userOperationManager.tt(new Lf.a(507,0,nc,fe|64)):this.$.userOperationManager.tt(new Xe.a(507,
0,nc,fe))}};a.prototype.QMg=function(cb){var nc=this.$.qa.ta.Oa(1);nc.request=cb;return nc};a.prototype.lve=function(cb,nc){if(cb)for(var Nc=0;Nc<cb.length;Nc++)if(ue.a.equals(cb[Nc],nc,!0))return!0;return!1};a.prototype.VLg=function(cb){var nc={};nc.navigationMode=OSF.OsfNavigationMode.DefaultMode;nc.assetId=null;nc.category=null;if(!cb||3>cb.length)return nc;if(cb[0]){var Nc=parseInt(cb[0]);isNaN(parseInt(Nc))||(nc.navigationMode=Nc)}cb[1]&&(nc.assetId=cb[1]);cb[2]&&(nc.category=cb[2]);return nc};
a.prototype.e4h=function(){if($a.EwaSettings.la(61)){var cb=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(cb&&"*"!==cb.trim()){this.hIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new P(this),cb,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.ig.get(2));try{this.hIa.init()}catch(nc){try{this.hIa.dispose()}catch(Nc){}this.hIa=null;zb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+nc.message)}cb={};cb.a=this.$.ya.UserSessionId;
hc.b().Ne(39,cb)}}};a.prototype.TZf=function(cb,nc,Nc){var Rc=this,Wc=a.iLg(cb[0]),fe=Wc.Wga,ve=Wc.Tha;Wc.Wga=function(){fe&&fe();var kc=Wc.OKa!==OSF.InfoType.Error?nc:null;cb.shift();cb.length?Rc.TZf(cb,kc,Nc):kc&&kc()};Wc.Tha=function(){ve&&ve();Nc&&Wc.OKa!==OSF.InfoType.Error&&Nc()};Lb.a.SOd(Wc)};a.prototype.sKh=function(){var cb={};cb.AddinRibbonControlsOverriddenByApi=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();cb.AddinActionDefinitionHybridMode=
$a.EwaSettings.la(667).toString();cb.UseActionIdForUILessCommand=$a.EwaSettings.la(671).toString();cb.AllowStorageAccessByUserActivationOnIFrame=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();cb.RequirementSetRibbonApiOnePointTwo=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();cb.flightingTreatmentVariables=za.AFrameworkApplication.ga.s8b;cb.ShortcutInfoArrayInUserPreferenceData=
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return cb};a.getSolutionId=function(cb){var nc=cb.PrimaryMarketplace.SolutionId;$a.EwaSettings.la(297)&&cb.OwnerAddinSolutionId&&(nc=cb.OwnerAddinSolutionId);return nc};a.Tdd=function(cb){var nc=0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?cb.RequestFlags&1&&256!==(cb.RequestFlags&256)||(nc=16):nc=cb.RequestFlags&1?0:16;return nc};a.nua=function(cb,
nc){nc=a.getSolutionId(cb,nc);return a.DVe(nc,cb.PrimaryMarketplace.SolutionVersion,cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef)};a.z4g=function(cb){var nc={};cb=(nc.recording=cb,nc);return JSON.stringify(cb)};a.U_g=function(cb){var nc={};nc.visibility=cb?"Visible":"Hidden";return JSON.stringify(nc)};a.EGh=function(cb){var nc=cb.getSolutionId(),Nc=cb.getVersion(),Rc=cb.getStoreType();cb=cb.getStoreId();return a.DVe(nc,Nc,Rc,cb)};a.DVe=function(cb,nc,Nc,Rc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",cb,nc,a.eSh(Nc).toString(),Rc)};a.Rfd=function(cb,nc){var Nc=cb.split("|");if(7>Nc.length)return zb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Nc[0])return zb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Nc[0]),null;var Rc=Nc[1],Wc=Nc[2],fe=a.fSh(Nc[3]),ve=Nc[4];Nc=Nc[5];Rc&&Rc.length||(Rc=Nc);Nc={};Nc.InstanceId=String.format("{{{0}}}",sb.a.create().toString());
Nc.WebExtensionOsfControlType=4;Nc.WebExtensionType=1;Nc.PrimaryMarketplace={};Nc.PrimaryMarketplace.SolutionId=Rc;Nc.PrimaryMarketplace.SolutionVersion=Wc;Nc.PrimaryMarketplace.MarketplaceRef=ve;Nc.PrimaryMarketplace.MarketplaceType=fe;Nc.ContainsCustomFunctions=nc?!0:!1;nc&&(Nc.OsfPropertyBag=[["customFunctionAddinId",cb]]);return Nc};a.fSh=function(cb){cb=parseInt(cb);return cb===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:cb===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:cb===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:cb===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:cb===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:cb===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:cb===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:cb===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:cb===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:cb===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:cb===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.eSh=function(cb){return cb===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:cb===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:cb===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:cb===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:cb===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:cb===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:cb===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:cb===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
cb===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:cb===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:cb===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.lqb=function(cb){var nc={};nc.Version=cb.appVersion;nc.AssetId=cb.assetId;nc.AssetStoreId=null!==cb.assetStoreId?cb.assetStoreId.toString():null;nc.StoreType=cb.storeType;nc.Height=cb.height;nc.SolutionId=cb.solutionId;nc.StoreId=cb.storeId;nc.TargetType=cb.targetType;nc.Width=1===nc.TargetType?
0:cb.width;nc.SharedRuntimeId=cb.sharedRuntimeId;nc.AppVersion=cb.appVersion;nc.CurrentStoreType=cb.currentStoreType;nc.Id=cb.id;return nc};a.yxb=function(cb){return cb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent||cb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
cb===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||cb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.iLg=function(cb){return Object.assign(new Jc.a,{OKa:cb.infoType,id:cb.id,title:cb.title,description:cb.description,buttonText:cb.buttonTxt,Wga:cb.buttonCallback,ucc:cb.highPriority,Tha:cb.dismissCallback,errorCode:cb.errorCode,I6e:cb.iframeNotificationUrl})};a.nLa=function(cb){var nc="FA000000014"===cb;nc||(nc="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===cb);
return nc};a.Cbi=function(cb){return"FA000000005"===cb};tl.Object.defineProperties(a.prototype,{nZb:{configurable:!0,enumerable:!0,get:function(){return this.vea||(this.vea=new Mb.a(this.$.Ey))}},Gi:{configurable:!0,enumerable:!0,get:function(){if(!this.Ml){var cb={},nc=!(this.$.Fd&1),Nc=dc.a.current.vK,Rc=this.$.workbookContext,Wc=Eb.a.KW+Eb.a.B1b,fe=0;$a.EwaSettings.la(509)&&(fe|=2);cb.pageBaseUrl=Nc.LayoutsContentUrlPrefix;cb.appName=OSF.AppName.ExcelWebApp;cb.appVersion="16";cb.appSettings=this.sKh();
cb.singleSignOnSettings=Da.AppsForOfficeSingleSignOnManager.LRh();cb.clientMode=nc?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;cb.appUILocale=this.$.ya.UICultureTag;cb.dataLocale=this.$.ya.DataCultureTag;cb.docUrl=Rc.ClientUrl;cb.hostControl=this;cb.formFactor=OSF.FormFactor.Default;cb.lcid=this.$.pI.toString();cb.localizedScriptsUrl=Eb.a.KW+Eb.a.h0c;cb.localizedImagesUrl=Wc;cb.localizedStylesUrl=Eb.a.KW+Eb.a.jye;cb.localizedResourcesUrl=Wc;cb.osfOmexBaseUrl=Nc.OsfOmexBaseUrl;cb.firstPartyManifestCDNUrl=
Nc.FirstPartyAddInManifestCDN;cb.sdxAssetsToPrefetchMapping=za.AFrameworkApplication.ga.Ua("SdxAssetsToPrefetchMapping");cb.sdxCdnUrl=Nc.SdxCdnUrl;cb.sdxDmsUrl=Nc.SdxDmsUrl;cb.devCatalogUrl=Nc.DevCatalogUrl;cb.controlStatusChanged=this.wla;cb.notifyHost=this.Vwf;cb.allowExternalMarketplace=this.$.fa.jh.get(27)&&a.T0c;cb.enableAddinCommands=$a.EwaSettings.la(53);cb.enableBlackForestRedirect=$a.EwaSettings.la(88);cb.enableMyOrg=this.$.fa.jh.get(33);cb.enableMyApps=this.$.fa.jh.get(34);cb.enableDevCatalog=
$a.EwaSettings.la(45);cb.enablePrivateCatalog=this.Xoj();cb.enableTaskpaneUpgradeToAppCommand=$a.EwaSettings.la(93);cb.showSignOutFromPrivateCatalogMessage=this.$.fa.jh.get(36);cb.enableUploadFileDevCatalog=$a.EwaSettings.la(53)&&!$a.EwaSettings.la(285);cb.userNameHashCode=sa.a.lu(za.AFrameworkApplication.userName);cb.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();cb.enableSingleSignOnForAddin=!$a.EwaSettings.la(24)&&za.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
cb.enableDisplayBlockedMinorError=$a.EwaSettings.la(183);cb.hideAppsExtensionUrl=za.AFrameworkApplication.hideAppsExtensionUrl;cb.enableAnonymousUseLegacyCatalogService=$a.EwaSettings.la(173);cb.enableInsertDialogAccessibilityFix=$a.EwaSettings.la(180);cb.disableAppsForOfficeThirdParty=$a.EwaSettings.la(186);cb.enableFirstPartySSO=$a.EwaSettings.la(198);cb.wacSessionId=this.$.ya.UserSessionId;cb.disableLogging=!this.$.ya.AriaLoggingIsEnabled;cb.enableFirstPartySDXErrorMessages=$a.EwaSettings.la(211);
cb.enableRichApiCellEditDelay=$a.EwaSettings.la(190);cb.isHostDocumentDomain=$a.EwaSettings.la(227);cb.loggableUserId=za.AFrameworkApplication.ga.Ua("LoggableUserId");cb.sessionStartInfoJson=za.AFrameworkApplication.ga.Ua("SessionStartInfoJson");cb.wopiHostOriginFromPostMessage=za.AFrameworkApplication.wopiHostOriginFromPostMessage;cb.wopiHostOriginFromWacPropBag=za.AFrameworkApplication.ga.Ua("PostMessageOrigin");cb.wacIsEmbedded=za.AFrameworkApplication.ga.ra("IsEmbedded");cb.accessibilityAllowFocusAddinTaskpane=
za.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");cb.enableRemoveAppCommandsAddin=za.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");cb.isHostFrameTrustCheckEnabledForAddIns=za.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");cb.isHostFrameTrusted=za.AFrameworkApplication.isHostFrameTrusted;cb.agaveAddinUploadEnabled=$a.EwaSettings.la(47);cb.hostAllowedOfficeStore=za.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");cb.hostAllowedSdxEmbedding=
za.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");cb.hostInstallAddIns=za.AFrameworkApplication.ga.Ua("HostInstallAddIns");cb.hostInstallAddInsIsEnabled=za.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");cb.approvedAddIns=za.AFrameworkApplication.ga.Ua("ApprovedAddIns");cb.addinEnforceHttpsIsEnabled=this.foj(cb.sessionStartInfoJson);cb.hostFeatureGateFlag=fe;cb.isUpnCheckEnabled=za.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");cb.wacUpn=za.AFrameworkApplication.ga.Ua("UserPrincipalName");
cb.isReactRibbonEnabled=Hc.a.isReactRibbonEnabled();cb.enableSetFocusOnTaskpaneOnUserAction=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);cb.isSafariWithIndexedDBDisabled=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Gb.a.N5a;cb.isIndexedDBDisabled=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Gb.a.N5a||$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Gb.a.zf;cb.enableCustomShortcuts=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");cb.changeGetModifierKeyStringOutputOrder=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.Ml=new OSF.ContextActivationManager(cb);cb={};this.Ml.setIframeAttributeBag((cb.frameborder=0,cb.marginheight=0,cb.marginwidth=0,cb));this.Ml.setWSA(za.AFrameworkApplication.Pm);this.Ml&&"undefined"!==typeof this.Ml.hostCheckReadyHandler&&za.AFrameworkApplication.MAg(Object(Wb.a)(this.Ml,
this.Ml.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var ve=Ic.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Ml.setOAuthManager(ve)}catch(kc){}}return this.Ml}},WOj:{configurable:!0,enumerable:!0,get:function(){return this.cRc}},dj:{configurable:!0,enumerable:!0,get:function(){return this.Hce}},qma:{configurable:!0,enumerable:!0,get:function(){return this.Ece}},pJd:{configurable:!0,enumerable:!0,get:function(){return this.Ice}},oJd:{configurable:!0,enumerable:!0,get:function(){return this.Gce}},
Laj:{configurable:!0,enumerable:!0,get:function(){return this.Kce}},Jaj:{configurable:!0,enumerable:!0,get:function(){return this.Fce}},Kaj:{configurable:!0,enumerable:!0,get:function(){return this.Jce}},Maj:{configurable:!0,enumerable:!0,get:function(){return this.Lce}},Naj:{configurable:!0,enumerable:!0,get:function(){return this.Mce}},qJd:{configurable:!0,enumerable:!0,get:function(){return this.Nce}},dV:{configurable:!0,enumerable:!0,get:function(){return this.Zlg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.vb}}});tl.Object.defineProperties(a,{T0c:{configurable:!0,enumerable:!0,get:function(){return a.q1d},set:function(cb){a.q1d=cb}}});a.S_a=new Tb.a;a.q1d=!0;Object(lb.a)(a,"DdaFacade",pb.a,[179,290,222,291,292,3])},868:function(y,D,b){function a(){this.JFd=0;this.kW={};this.nsa={}}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(110);a.prototype.LNh=function(k,n){return this.kW[a.ZWc(k,n)]};a.prototype.kIe=function(k,n){n||void 0!==this.nsa[k]&&null!==this.nsa[k]?n&&
void 0!==this.nsa[k]&&null!==this.nsa[k]&&delete this.nsa[k]:this.nsa[k]=1};a.prototype.gZb=function(k){return void 0===this.nsa[k]||null===this.nsa[k]};a.prototype.WWh=function(k){var n=a.ZWc(k.messageType,k.targetId);1===k.actionType?this.oYh(k.controlId,k.messageType,n):2===k.actionType&&this.ZYh(k.controlId,k.messageType,n)};a.prototype.I2i=function(k){if(k){var n=Object.keys(this.kW);if(!(void 0===n||null===n||0>=n.length)){n=yl(n);for(var l=n.next();!l.done;l=n.next()){l=l.value;var f=this.kW[l];
f[k]&&(delete f[k],Object.keys(f).length||delete this.kW[l])}}}};a.prototype.BZ=function(k,n){k=a.ZWc(k,n);k=this.kW[k];return!!k&&0<Object.keys(k).length};a.prototype.SZh=function(){return!c.a.isEmpty(this.kW)};a.prototype.jef=function(){return 0<this.JFd};a.prototype.mIh=function(){var k=[],n=this.kW,l;for(l in n){var f=l,u=n[l],v;for(v in u){u=v;var m={};m.eventType=parseInt(f.split("#")[0]);m.targetId=f.split("#")[1];m.addinId=u;k.push(m)}}return k};a.prototype.oYh=function(k,n,l){if(this.kW[l])l=
this.kW[l],l[k]=l[k]?l[k]+1:1;else{var f={};f[k]=1;this.kW[l]=f}100===n&&this.JFd++};a.prototype.ZYh=function(k,n,l){if(this.kW[l]){var f=this.kW[l];if(k){var u=f[k];1===u?(delete f[k],Object.keys(f).length||delete this.kW[l]):f[k]=u-1;100===n&&this.JFd--}else d.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",k,l)}else d.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",l)};a.ZWc=function(k,n){return String.format("{0}#{1}",
k,n)};a.uW="Workbook";Object(y.a)(a,"RichApiEventRegistration",null,[])},895:function(y,D,b){function a(d,c,k,n){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=d;this.controlId=c;this.ddaBinding=k;this.ArrayData=void 0===n?null:n}b.d(D,"a",function(){return a});y=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(y.a)(a,"DdaEventArgs",null,[])},942:function(y,D,b){function a(c,k,n){this.BOb=
c;this.Wfg=k;this.Xfg=n}function d(){this.title=this.id=this.tabs=null}y=b(0);Object(y.a)(d,"AddInDataTransferObject",null,[]);b.d(D,"a",function(){return a});a.itb=function(c){return(c=c.pK)?Object.assign(new d,{tabs:c.fq.toArray(),id:c.Owg,title:c.Pwg}):null};tl.Object.defineProperties(a.prototype,{fq:{configurable:!0,enumerable:!0,get:function(){return this.BOb}},Owg:{configurable:!0,enumerable:!0,get:function(){return this.Wfg}},Pwg:{configurable:!0,enumerable:!0,get:function(){return this.Xfg}}});
Object(y.a)(a,"OneLineRibbonExtensibility",null,[])},950:function(y,D,b){function a(){var c={};this.D8c=(c.tabhome="Ribbon.Home",c.tabinsert="Ribbon.Insert",c.tabdata="Ribbon.Data",c.tabreview="Ribbon.Review",c.tabview="Ribbon.View",c);c={};this.B8c=(c.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",d.a.instance.ea(1581),d.a.instance.ea(1585)],c.tabformulas=["Ribbon.Formulas",d.a.instance.ea(1582),d.a.instance.ea(1586)],c.tabdeveloper=["Ribbon.Developer",d.a.instance.ea(1583),d.a.instance.ea(1587)],
c.tabaddins=["Ribbon.AddIns",d.a.instance.ea(1584),d.a.instance.ea(1588)],c);this.Frh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.j1a=null}b.d(D,"a",function(){return a});y=b(0);var d=b(14);a.prototype.oMh=function(){if(this.j1a)return this.j1a;this.j1a={};for(var c=yl(Object.keys(this.D8c)),k=c.next();!k.done;k=c.next())k=k.value,this.j1a[k]=this.D8c[k];c=yl(Object.keys(this.B8c));for(k=c.next();!k.done;k=
c.next())k=k.value,this.j1a[k]=this.B8c[k][0];return this.j1a};tl.Object.defineProperties(a.prototype,{Bha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},xx:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},yxc:{configurable:!0,enumerable:!0,get:function(){return this.D8c}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.Frh}},dti:{configurable:!0,enumerable:!0,
get:function(){return this.B8c}}});Object(y.a)(a,"AddinCommandsStringProvider",null,[344])},989:function(y,D,b){function a(P,ia){this.CCc=new m.a;this.Ml=P;this.ktg=ia}function d(P,ia,W,R){this.FS=new u.a;this.UF=new u.a;this.Ioa=null;this.Ujb=new u.a;this.e8d=Promise.resolve(null);this.wee=!1;this.eUb=ia;this.Dig=P;this.Yee=W;this.$fg=R}function c(){var P=k.call(this)||this;P.errorCode=0;return P}function k(){this.hPb=new u.a;this.q9=this.p9=!1;this.Fna=this.authChallenge=null;this.startTime=this.retryCount=
0;this.fme=null}function n(){this.token=null;this.expiresOn=0;this.Iga=this.authChallenge=null}function l(){this.accessToken=null}function f(){this.startTime=0;this.callback=null}b.r(D);y=b(0);var u=b(185),v=b(13),m=b(101);Object(y.a)(f,"SSOCallbackInfo",null,[]);Object(y.a)(l,"AccessTokenInformation",null,[120]);var A=b(1121);Object(y.a)(n,"CachedTokenInfo",null,[]);tl.Object.defineProperties(k.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.hPb}}});Object(y.a)(k,"SSORequestInfo",
null,[]);vm(c,k);Object(y.a)(c,"SSOFailedRequestInfo",k,[]);var x=b(5);d.prototype.Zpj=function(P){if(this.Ioa&&this.Ioa.authChallenge===P.authChallenge){if(Date.now()/1E3+d.hri>this.Ioa.expiresOn)return this.Ioa=null,!1;P=new A.a;P.token=this.Ioa.token;P.expiresOn=this.Ioa.expiresOn;P.Iga=this.Ioa.Iga;P.mSa=!0;P.Uub=0;this.lvb(P);return!0}return!1};d.prototype.Doj=function(P){for(var ia=0;ia<this.UF.count;ia++)if(this.UF.na(ia).authChallenge===P.authChallenge&&this.UF.na(ia).Fna===P.Fna){var W=void 0;
(W=this.UF.na(ia)).retryCount=W.retryCount+1;P.retryCount=this.UF.na(ia).retryCount;if(this.UF.na(ia).retryCount<d.Fri||!this.UF.na(ia).p9&&P.p9||!this.UF.na(ia).q9&&P.q9){if(!this.UF.na(ia).p9&&P.p9||!this.UF.na(ia).q9&&P.q9)P.retryCount=0;this.UF.removeAt(ia);break}P=new A.a;P.errorCode=this.UF.na(ia).errorCode;this.lvb(P);return!0}return!1};d.prototype.Cyg=function(P,ia){for(var W=0;W<this.UF.count;W++)if(this.UF.na(W).Fna===P.Fna&&this.UF.na(W).authChallenge===P.authChallenge)return;this.UF.add(Object.assign(new c,
{p9:P.p9,q9:P.q9,authChallenge:P.authChallenge,Fna:P.Fna,errorCode:ia,retryCount:P.retryCount}))};d.prototype.Uad=function(P,ia,W,R,I,Q){var O=this,ba=b(989).AppsForOfficeSingleSignOnManager;""===W&&(W=null);if(this.wee)ba.l5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var ca=null,S=yl(this.FS),Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,Y.p9===P&&Y.q9===ia&&Y.authChallenge===W&&Y.Fna===I){ca=Y;break}ca||(ca=Object.assign(new k,{p9:P,q9:ia,authChallenge:W,fme:R,Fna:I,
retryCount:0,startTime:ba.Sv()}),this.FS.add(ca));ca.retryCount=0;ca.callbacks.add(Q);this.e8d=this.e8d.then(function(){var ma=b(989).AppsForOfficeSingleSignOnManager;if(0<O.FS.count){var Z=O.FS.na(0);if(O.Zpj(Z)||O.Doj(Z))return null;for(var xa=0;xa<O.Ujb.count;)O.Ujb.na(xa)+d.tBj<ma.Sv()?O.Ujb.removeAt(xa):xa++;if(O.Ujb.count>=d.Ari||O.FS.count>=d.eri)return Z=new A.a,Z.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,O.lvb(Z),null;var na=null;x.AFrameworkApplication.sa&&(ma=x.AFrameworkApplication.sa.fD)&&
(na=ma.Fc("ComponentAttach",O.Dig+d.gsg));return Z.Fna.Gug(O.resource,Z.p9,Z.q9,Z.authChallenge,O.$fg,Z.fme).then(function(pa){na&&na.stop();O.lvb(pa)},function(){na&&na.stop();var pa=new A.a;pa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;O.lvb(pa)})}return null})}};d.prototype.lvb=function(P){var ia=b(989).AppsForOfficeSingleSignOnManager;try{if(this.FS.count){var W=this.FS.na(0);this.FS.removeAt(0);var R=null;P.errorCode||(R=new l,R.accessToken=P.token);P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Cyg(W,P.errorCode);var I={};null!=P.Uub&&(I.getTokenSilentTime=P.Uub.toString());null!=P.wfd&&(I.getTokenPopupTime=P.wfd.toString());null!=P.ddd&&(I.getIDTokenTime=P.ddd.toString());null!=P.mSa&&(I.tokenCached=P.mSa.toString());P.ySd&&(I.detailedError=P.ySd);P.Iga&&(I.authLibrary=P.Iga);
W.retryCount&&(I.retryCount=W.retryCount);for(var Q=yl(W.callbacks),O=Q.next();!O.done;O=Q.next())ia.l5(O.value,P.errorCode,R,I);null!=P.mSa&&P.mSa||this.Ujb.add(W.startTime);if(!P.errorCode)for(null!=P.expiresOn&&(this.Ioa=Object.assign(new n,{token:P.token,expiresOn:P.expiresOn,authChallenge:W.authChallenge,Iga:P.Iga})),this.UF.clear(),Q=0;Q<this.FS.count;)if(this.FS.na(Q).authChallenge===W.authChallenge){var ba=yl(this.FS.na(Q).callbacks);for(O=ba.next();!O.done;O=ba.next())ia.l5(O.value,P.errorCode,
R,I);this.FS.removeAt(Q)}else Q++}}catch(ca){v.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ca.message)}};d.prototype.shutdown=function(){this.wee=!0;this.FS.clear()};tl.Object.defineProperties(d.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.eUb}}});d.tBj=6E4;d.Ari=6;d.eri=6;d.Fri=3;d.hri=300;d.gsg="GetAccessToken";Object(y.a)(d,"SSOCallbackManager",null,[]);var t=b(846),z=b(857),r=b(116),G=b(77),w=b(23),B=b(28),U=b(143),N=b(338);
b.d(D,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Vad=function(P,ia,W,R,I,Q,O,ba,ca,S){S=Object.assign(new f,{startTime:a.Sv(),callback:S});try{var Y=!!W&&""!==W,ma=S.startTime,Z=this.getOsfControl(P),xa=Z.getStoreType()||"",na=Z.getOwnerAddinStoreType()||"";if(x.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var pa=Z.getSolutionId()||"";var Ia=Z.getVersion()||""}else pa=Z.getMarketplaceID()||"",Ia=Z.getMarketplaceVersion()||
"";xa=xa.toLowerCase();na=na.toLowerCase();pa=pa.toLowerCase();var Ma=G.a.cdd(ia)||"",lb=G.a.cdd(Z.getIframeUrl())||"",zb=Ma.toLowerCase()===lb.toLowerCase();Ma=xa;"inmemory"===xa&&(Ma=na);var Ya=x.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(Ma,Z.getStoreId(),pa):Telemetry.PrivacyRules.GetAssetId(Ma,Z.getStoreLocator(),pa);Z={};var Wb=(Z.callInstanceId=ma.toString(),Z.controlAssetId=Ya,Z.controlVersion=
Ia,Z.storeType=xa,Z.ownerStoreType=na,Z.allowConsentPrompt=R.toString(),Z.forMSGraphAccess=I.toString(),Z.allowSignInPrompt=Q.toString(),Z.hasAddinAuthChallenge=Y.toString(),Z.securityOriginEqualsSourceLocation=zb.toString(),Z.singleSignOnEnabled=O.toString(),Z.accountTypeFilter=ba||"",Z);v.ULS.sendTraceTag(51401115,344,50,"{0}",Wb);U.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:r.a.Fk(Wb)}));ma=!0;var Zb=x.AFrameworkApplication.ga.Ua("HostAuthType");
switch(ba){case "aad":ma="aad"===Zb;break;case "msa":ma="msa"===Zb;break;default:ma=!ba||"noFilter"===ba}if(ma){ba=null;if(O)for(var da=yl(this.ktg),za=da.next();!za.done;za=da.next()){var hb=za.value;if(hb.bai(pa)){ba=hb;break}}ba?this.isSSOAddin(P)?(O=!0,"omex"===Ma&&(O=!1),"spapp"===Ma||"spcatalog"===Ma?(v.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):I&&!O?(v.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(I&&"exchange"===Ma&&(R=!1),this.Uad(P,ia,W,Ma,R,Q,ca,ba,S))):(v.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Gb){this.oic(),v.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Gb.message),a.l5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(P,ia,W,R){this.Vad(P,W[t.a.WTc]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,ia,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,R)};a.prototype.Uad=function(P,ia,W,R,I,Q,O,ba,ca){this.CCc.wb(P)?R=this.CCc.na(P):(R=new d(P,this.getWebApplicationResource(P).split(",")[0],R,this.getDefaultDisplayName(P)),this.CCc.add(P,R));var S=R.resource;P=a.fQh(S,this.getWebApplicationId(P));var Y=OfficeExt.WACUtils.getHostSecure(ia);
P&&Y?P.toLowerCase()===Y.toLowerCase()?R.Uad(I,Q,W,O,ba,ca):(a.WMa('SSO Resource "'+S+'" cannot be used from "'+ia+'" origin due to domain mismatch.'),v.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.l5(ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(P||v.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Y||v.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.l5(ca,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.oic=function(){var P={};v.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(P.UserAgent=window.navigator.userAgent,P))};a.prototype.getOsfControl=function(P){return this.Ml.getOsfControl(P)};a.prototype.isSSOAddin=function(P){return this.getOsfControl(P).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(P){return this.getOsfControl(P).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=
function(P){return this.getOsfControl(P).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(P){return this.getOsfControl(P).getManifest().getDefaultDisplayName()};a.LRh=function(){try{var P={};w.a.qka&&z.a.awb&&(P.UiHostSupportsAuthTokenAddinList=a.XQe);P.UiHostSupportsAuthToken=z.a.awb;return P}catch(ia){v.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ia.message)}return null};a.getInstance=function(P,ia,W){W=void 0===
W?null:W;a.Na||(ia=new u.a,W&&ia.add(W.Mpi),a.Na=new a(P,ia));return a.Na};a.WMa=function(P){window.console.warn&&window.console.warn(P)};a.fQh=function(P,ia){if(!P)return"";ia||(ia="");var W=P.toLowerCase(),R=ia.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(R)||(a.WMa('SSO App Id "'+ia+'" is not a valid format. It will be rejected from store submission.'),v.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));W.endsWith(R)||(a.WMa('SSO Resource "'+
P+'" does not end with App Id "'+ia+'". It will be rejected from store submission.'),v.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!W.startsWith("https://")&&!W.startsWith("api://"))return a.WMa('SSO Resource "'+P+'" must be https:// or api:// protocol.'),v.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ia=0;ia<P.length;ia++){R=P.charAt(ia);var I=B.a.charCodeAt(P,ia);if(33>I||126<I||"&"===R||"?"===R||"#"===R||"%"===R||"\\"===R)return a.WMa('SSO Resource "'+
P+'" contains an invalid character "'+R+'".'),v.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+R+"' in resource URI."),""}if(0<=P.indexOf("::"))return a.WMa('SSO Resource "'+P+'" contains an invalid string "::".'),v.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<P.length)return a.WMa('SSO Resource "'+P+'" is '+P.length+" characters and exceeds the max length of 120 characters."),v.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+P.length+"."),"";W.startsWith("api://")&&
(W="https://"+W.substring(6,W.length));return 8===W.length?"":OfficeExt.WACUtils.getHostSecure(W)||""};a.l5=function(P,ia,W,R){var I=P.startTime,Q=0;0<I&&(Q=a.Sv()-I);var O={};I=(O.callInstanceId=I.toString(),O.callDuration=Q.toString(),O.errorCode=ia.toString(),O);if(R)for(var ba in R)I[ba]=R[ba];v.ULS.sendTraceTag(51401116,344,50,"{0}",I);U.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:r.a.Fk(I)}));P.callback(ia,W)};a.Sv=function(){try{if(window.performance&&
window.performance.now)return window.performance.now()}catch(P){}return Date.now()};a.XQe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Na=null;Object(y.a)(a,"AppsForOfficeSingleSignOnManager",null,[88])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/44c51eca1e91bfa7d129cf0049092311/EwaDS.agave.js.map