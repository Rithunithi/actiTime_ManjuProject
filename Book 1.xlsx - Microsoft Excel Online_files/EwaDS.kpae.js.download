(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1046:function(y,D,b){function a(f,u){var v=l.call(this,u.textBox.domElement)||this;v.MVc=null;v.azi=function(){v.Zwd()};v.jtf=function(m,A){v.Rh(m,A)};v.otf=function(m,A){v.Mj(m,A)};v.vb=f;v.yI=u;u.eP&&(u.eP.add(v),u.wm(v.otf),u.hq(v.jtf));return v}b.d(D,"a",function(){return a});y=b(0);var d=b(88);D=b(83);var c=b(44),k=b(42),n=b(69),l=D.a;vm(a,l);a.prototype.dispose=function(){var f=this.yI;if(null===f||void 0===f?0:f.eP)f.eP.remove(this),
f.im(this.otf),f.Rp(this.jtf);d.a.Fa(this.MVc);this.yI=null;l.prototype.dispose.call(this)};a.prototype.ki=function(f,u){switch(u){case -1470715894:case -1231471547:this.NT(!1);break;default:if(this.lDd(f,u))return n.g(f),!0;a.Nci(u)||this.NT(!1)}return!1};a.prototype.NT=function(){d.a.Fa(this.MVc);this.MVc=c.a.instance.create(this.azi,10,k.a.Jki)};a.prototype.Mj=function(){this.NT(!1)};a.Nci=function(f){switch(f){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};tl.Object.defineProperties(a.prototype,
{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI}}});Object(y.a)(a,"ListAutoCompleteBehavior",D.a,[626,3])},1189:function(y,D,b){function a(v){var m=u.call(this,document.createElement("div"))||this;m.KHa=!1;m.LHa=!1;m.JHa=!1;m.HHa=!1;m.IHa=!1;m.KQ=!1;m.yI=null;m.Blc=function(A,x){m.Ns(A,x)};m.JKa=function(){m.qb.textBox.QJ=!0};m.Zxa=function(){m.wy(!0)};m.Oqf=function(){m.qb.textBox.focus()};m.Gh=function(){l.g(m.$).inRangePicker||
(m.isListVisible=!1)};m.$=v;l.g(v)&&l.g(v).ha&&l.g(m.$).ha.fG(m.Gh);m.Naa=c.a.AM(v)&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return m}b.d(D,"a",function(){return a});y=b(0);D=b(232);var d=b(4),c=b(41),k=b(1),n=b(8),l=b(20),f=b(34),u=D.a;vm(a,u);a.prototype.Ns=function(){this.XAa(!1);this.mt.Ns()};a.prototype.dispose=function(){this.$&&l.g(this.$)&&l.g(this.$).ha&&l.g(this.$).ha.vN(this.Gh);this.$=null;u.prototype.dispose.call(this)};a.prototype.ki=
function(v,m,A){v=!1;if((this.rqb||(void 0===A?0:A))&&!this.JLa()&&this.get_visible()&&this.isListVisible)switch(this.Naa&&this.rzc(m),m){case 1872288872:this.isListVisible=!1;v=!0;break;case -798660877:this.mt.MA(1);v=!0;break;case 137938150:this.mt.MA(-1);v=!0;break;case 2091832999:this.mt.MA(this.xH-1);v=!0;break;case 742457698:this.mt.MA(-(this.xH-1));v=!0;break;case 125627505:v=this.wy(!1);break;case 267796030:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(v=this.wy(!1))}return v};a.prototype.XAa=function(v){if(this.isListVisible||v){var m=l.g(this.$);v=m.domElement;var A=this.yI.textBox.domElement,x=f.a(this.$).Fi(A.offsetHeight),t=f.a(this.$).Fi(A.offsetTop),z=f.a(this.$).Fi(A.offsetWidth);A=f.a(this.$).Fi(A.offsetLeft);m=m.xj;var r=$get(this.$.Ib+d.a.MZa,this.$.domElement),G=new Sys.UI.Point(m?this.mt.S8b:0,m?this.wyh:a.gWh);x=r.offsetTop+G.y+(c.a.GM(this.$)&&m?0:x+t);this.$.I4||(t=$get(d.a.xFa,this.$.domElement),x+=t?t.offsetHeight:0);t=this.domElement;
t.style.top=n.HelperMethods.Qb(x);A=r.offsetLeft+A+G.x;!c.a.GM(this.$)&&this.$.isChromeRtl?t.style.right=n.HelperMethods.Qb(m?this.mt.S8b:v.offsetLeft+v.offsetWidth-A-z):t.style.left=n.HelperMethods.Qb(A)}};a.prototype.QRa=function(v){this.mt&&(v&&!this.KQ?(this.mt.j9(this.Oqf),this.mt.LXb(this.JKa),this.mt.umb(this.Zxa),this.KQ=!0):this.KQ&&(this.mt.Kca(this.Oqf),this.mt.Lqc(this.JKa),this.mt.rGb(this.Zxa),this.KQ=!1))};a.prototype.rzc=function(v){switch(v){case -798660877:case 137938150:case 2091832999:case 742457698:this.KHa=
!0;break;case 125627505:this.JHa=!0;break;case 267796030:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HHa=!0)}};tl.Object.defineProperties(a.prototype,{xH:{configurable:!0,enumerable:!0,get:function(){return this.mt.xH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.mt.isListVisible},set:function(v){this.mt.isListVisible=v}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI},set:function(v){(this.yI=
v)&&this.yI.iNb.add(this)}},wyh:{configurable:!0,enumerable:!0,get:function(){return c.a.GM(this.$)?-5:-40}}});a.S8b=0;a.gWh=1;Object(y.a)(a,"AutoCompleteControl",D.a,[595])},1190:function(y,D,b){function a(c,k,n,l){k=void 0===k?0:k;n=void 0===n?"":n;l=void 0===l?"":l;var f=d.call(this)||this;f.length=c;f.selectedIndex=k;f.XH=n;f.description=l;return f}b.d(D,"a",function(){return a});y=b(0);var d=Sys.EventArgs;vm(a,d);Object(y.a)(a,"ListEventArgs",Sys.EventArgs,[])},1191:function(y,D,b){function a(z,
r){z=t.call(this,z,r,new x.a(k.a.listItem,k.a.Qzb,k.a.Tzb,k.a.Uzb))||this;z.pbc=!1;z.Kr=null;z.qkb=null;z.lSe=!1;z.oAa(!0);z.lSe=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return z}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(23);D=b(978);var k=b(929),n=b(4),l=b(78),f=b(41),u=b(11),v=b(1),m=b(118),A=b(20),x=b(1045),t=D.a;vm(a,t);a.prototype.qxa=function(){var z=460,r=A.g(this.$),G=r.domElement,w=this.nSa.style,B=this.dg.offsetTop+this.Nk.offsetHeight*
this.Nk.sectionRowIndex-this.dg.scrollTop;w.width="auto";w.whiteSpace="nowrap";w.position=c.a.hfc?"relative":"absolute";var U=G.offsetLeft+G.offsetWidth-(this.domElement.offsetLeft+this.dg.offsetLeft+this.dg.offsetWidth+3);G=this.domElement.offsetLeft-3-(G.offsetLeft+this.S8b);z=Math.min(this.nSa.offsetWidth,z,Math.max(U,G));u.DOMElementExtensions.Gq(this.nSa,z);w.whiteSpace="";w.position="absolute";B+3>this.dg.offsetTop+this.dg.offsetHeight||B<this.dg.offsetTop||(z=this.dg.offsetLeft-3-this.nSa.offsetWidth,
w=this.dg.offsetLeft+this.dg.offsetWidth+3,u.DOMElementExtensions.updatePosition(this.nSa,G>U!==r.rtl?z:w,B,!1))};a.prototype.MA=function(z){t.prototype.MA.call(this,z);this.qxa()};a.prototype.Ns=function(){this.qxa()};a.prototype.hra=function(){var z=this.zn,r=this.dg,G=3===l.a.Wb||c.a.Pr,w=G?this.CAb:this.xH;this.isListVisible=!0;r.style.height="auto";this.JFa.set_visible(!0);this.Zlb(z,G);this.Kr.length>w?(u.DOMElementExtensions.HF(r,Math.floor(r.offsetHeight*w/this.Kr.length)),r.style.overflowY=
"auto"):(r.style.height="auto",r.style.overflowY="hidden");u.DOMElementExtensions.Gq(r,z.offsetWidth+(this.Kr.length>w?m.a.Sp:0))};tl.Object.defineProperties(a.prototype,{S8b:{configurable:!0,enumerable:!0,get:function(){if(f.a.GM(this.$)){var z=document.getElementById(this.$.Ib+n.a.kSe);return!this.lSe||z?u.DOMElementExtensions.getBoundingClientRect(z).x:0}z=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(n.a.Yud):document.getElementById(this.$.Ib+
n.a.Yud+"-"+n.a.Bnf);d.ULS.shipAssertTag(537170323,0,!!z||this.$.lV,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return z?z.offsetWidth:0}},pe:{configurable:!0,enumerable:!0,get:function(){return this.qkb},set:function(z){this.qkb=z}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return u.DOMElementExtensions.isVisible(this.dg)&&0<this.Kr.length},set:function(z){u.DOMElementExtensions.setVisible(this.dg,z);u.DOMElementExtensions.setVisible(this.nSa,
z);var r=A.g(this.$).view;z?this.pbc||(r.it(this.JFa.Blc),this.pbc=!0):(Array.clear(this.Kr),this.pbc&&(r.Wr(this.JFa.Blc),this.pbc=!1))}}});Object(y.a)(a,"AutoCompleteListBox",D.a,[])},1244:function(y,D,b){function a(Tc,rb,eb,Ta){var fb=vd.call(this,Tc,"PopulateGridContextMenu",1247109494,-2064931494,a.TVh,!0,!1,a.cHb,rb,eb,!0,Ta)||this;fb.bAa=!1;fb.qva=!1;fb.UY=!1;fb.refresh=!1;fb.expandCollapse=!1;fb.Igc=!1;fb.qBe=!0;fb.grid=zb.g(Tc);fb.tjc=!0;fb.cmd=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5558478_disableHideUnHideRowColumnForMobileWhenEntireGridSelected")&&
Tc.isMobileMode;fb.kld=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(fb.kld){var pb=Zb.GetServiceTaskFactory.Xa(fb.$.da,309,310,3),rc=Zb.GetServiceTaskFactory.create(fb.$.da,18,fb.ma,3);na.TaskExtensions.Ba(na.TaskExtensions.ve([pb,rc],fb.ma),function(){fb.$.da.Za(268,function(vb){fb.p3a=new d(Tc,pb.result,rc.result,vb)})},fb.ma,3)}return fb}function d(Tc,rb,eb,Ta){this.QUc=this.gdb=this.idb=0;this.$=Tc;this.gridView=zb.g(this.$);this.namedSheetViewPublic=
rb;this.hi=eb;this.instantaneousSupportInformationManager=Ta;this.SLa=wb.a.Kkd()}function c(Tc){this.ranges=null;this.ranges=Tc}function k(Tc,rb,eb,Ta,fb,pb,rc,vb){this.$=rb;this.Sa=eb;this.jm=Ta;this.selectedRanges=fb;this.grid=pb;this.bB=vb;this.Iaa=rc;this.mra=v.a.all(fb,function(E){return E.isRow});this.lra=v.a.all(fb,function(E){return E.Lh});this.nBb=v.a.all(fb,function(E){return!E.isRow&&!E.Lh});rb=pb.Vb.lfd(fb);this.X2b=!!rb;this.UNf=!!rb&&rb.hasActiveFilter;this.menuSection=eb.Lc();Array.add(Tc.yc,
this.menuSection);this.Pja=this.mra||this.lra?this.menuSection:eb.Lc();this.Vsa=this.mra||this.lra?this.menuSection:eb.Lc()}b.r(D);y=b(0);var n=b(13),l=b(269),f=b(97),u=b(47),v=b(308),m=b(571),A=b(5),x=b(84),t=b(408),z=b(843),r=b(9),G=b(30),w=b(16),B=b(58),U=b(4),N=b(921),P=b(1172),ia=b(977),W=b(14);k.prototype.Had=function(){this.rAh();this.Xzh();var Tc=this.bB.Q5a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Sa.yb(Tc?149:148))};k.prototype.wAh=function(){var Tc=0;this.X2b?
this.Iaa.xn(942362098)?Tc=this.bB.xn(this.jm,942362098,this.selectedRanges,this.grid)?161:169:this.UNf&&(Tc=this.bB.xn(this.jm,-1113896058,this.selectedRanges,this.grid)?177:181):this.Iaa.xn(-1113896058)&&(Tc=this.mra?this.bB.xn(this.jm,-1113896058,this.selectedRanges,this.grid)?49:116:this.bB.xn(this.jm,-1113896058,this.selectedRanges,this.grid)?177:181);Tc&&Array.add(this.Pja.buttons,this.Sa.yb(Tc))};k.prototype.sAh=function(){var Tc=0;this.X2b?this.Iaa.xn(622604322)&&(Tc=this.grid.rtl?this.bB.xn(this.jm,
622604322,this.selectedRanges,this.grid)?191:192:this.bB.xn(this.jm,622604322,this.selectedRanges,this.grid)?162:170):this.Iaa.xn(1415868706)&&(Tc=this.lra?this.bB.xn(this.jm,1415868706,this.selectedRanges,this.grid)?50:117:this.bB.xn(this.jm,1415868706,this.selectedRanges,this.grid)?178:182);Tc&&Array.add(this.Pja.buttons,this.Sa.yb(Tc))};k.prototype.qAh=function(){this.Iaa.xn(1035996630)&&(this.bB.xn(this.jm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Pja.buttons,this.Sa.yb(this.grid.rtl?
187:165)),Array.add(this.Pja.buttons,this.Sa.yb(166))):(Array.add(this.Pja.buttons,this.Sa.yb(this.grid.rtl?188:173)),Array.add(this.Pja.buttons,this.Sa.yb(174))))};k.prototype.rAh=function(){var Tc=b(1244).GridContextMenu,rb=null;this.nBb&&(rb=this.Sa.Kv("ContextMenu.InsertCells",null,W.a.instance.ea(343),1896159024),Array.add(rb.menu.yc,this.Pja));Tc.tAh(this.Pja,this.Sa,this.$);this.wAh();this.sAh();this.qAh();rb&&0<this.Pja.buttons.length&&Array.add(this.menuSection.buttons,rb)};k.prototype.Zzh=
function(){var Tc=0;this.X2b?this.Iaa.xn(1405456548)?Tc=this.bB.xn(this.jm,1405456548,this.selectedRanges,this.grid)?163:171:this.UNf&&(Tc=this.bB.xn(this.jm,1554436520,this.selectedRanges,this.grid)?179:183):this.Iaa.xn(1554436520)&&(Tc=this.mra?this.bB.xn(this.jm,1554436520,this.selectedRanges,this.grid)?51:118:this.bB.xn(this.jm,1554436520,this.selectedRanges,this.grid)?179:183);Tc&&Array.add(this.Vsa.buttons,this.Sa.yb(Tc))};k.prototype.Yzh=function(){var Tc=0;this.X2b?this.Iaa.xn(284490184)&&
(Tc=this.bB.xn(this.jm,284490184,this.selectedRanges,this.grid)?164:172):this.Iaa.xn(674605324)&&(Tc=this.lra?this.bB.xn(this.jm,674605324,this.selectedRanges,this.grid)?52:119:this.bB.xn(this.jm,674605324,this.selectedRanges,this.grid)?180:184);Tc&&Array.add(this.Vsa.buttons,this.Sa.yb(Tc))};k.prototype.Wzh=function(){this.Iaa.xn(1035996630)&&(this.bB.xn(this.jm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Vsa.buttons,this.Sa.yb(this.grid.rtl?189:167)),Array.add(this.Vsa.buttons,this.Sa.yb(168))):
(Array.add(this.Vsa.buttons,this.Sa.yb(this.grid.rtl?190:175)),Array.add(this.Vsa.buttons,this.Sa.yb(176))))};k.prototype.Xzh=function(){var Tc=null;this.nBb&&(Tc=this.Sa.Kv("ContextMenu.DeleteCells",null,W.a.instance.ea(403),-1554384558),Array.add(Tc.menu.yc,this.Vsa));this.Zzh();this.Yzh();this.Wzh();Tc&&0<this.Vsa.buttons.length&&Array.add(this.menuSection.buttons,Tc)};Object(y.a)(k,"CellsContextMenuGenerator",null,[]);Object(y.a)(c,"MacroRecorderRangeHyperlinkRemovedPayload",null,[98]);var R=
b(552),I=b(24),Q=b(96),O=b(78),ba=b(73),ca=b(43),S=b(163),Y=b(81),ma=b(650),Z=b(41),xa=b(141),na=b(35),pa=b(575),Ia=b(578),Ma=b(1),lb=b(175),zb=b(20),Ya=b(370),Wb=b(34),Zb=b(56),da=b(238),za=b(19),hb=b(28),Gb=b(1183),Sb=b(1044),Fb=b(125),wa=b(519),va=b(368),sa=b(153),sb=b(148),Tb=b(337),Da=b(92),Sa=b(27),Ra=b(302),Lb=b(273),Ja=b(127),wb=b(901),Mb=b(902),Eb=b(132),Ic=b(38),Zc=b(55),Pc;(function(Tc){Tc[Tc.none=0]="none";Tc[Tc.once=1]="once";Tc[Tc.twice=2]="twice"})(Pc||(Pc={}));Object(y.b)("ToggleState",
Pc);d.prototype.fch=function(){var Tc=this.AU(),rb={};Tc=(rb.CommandValueId=Ic.c(Tc),rb);rb=new Da.a(-2058042992,2,this.$.ed,19,null);n.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Zb(rb,Tc)};d.prototype.wch=function(){var Tc=new Da.a(644342024,2,this.$.ed,19,null);n.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Zb(Tc)};
d.prototype.lch=function(){var Tc=this.gridView.ha.va.activeCell,rb=this.$.da.Aa(66).Wg;return rb?this.nch(rb,Tc):this.mch(Tc)};d.prototype.nch=function(Tc,rb){if(this.dSg(Tc,rb))return n.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Zc.Task.Ta(!1);if(Tc.hasAutoFilter)return this.idb=Pc.none,this.OUc();this.idb=Pc.once;return this.r5b(Pc.once)};d.prototype.mch=function(Tc){var rb=ca.v(this.gridView.ha.va.Qd,this.$);
rb=this.gridView.$.xa.getItemByName(rb.SheetName);var eb=ca.D(rb.h0);if(this.cSg(eb,Tc))return n.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Zc.Task.Ta(!1);if(rb.hasAutoFilter){if(eb&&eb.contains(this.gridView.ha.va.activeCell))return this.idb=Pc.none,this.OUc();this.idb=Pc.twice;return this.r5b(Pc.twice)}this.idb=Pc.once;return this.r5b(Pc.once)};d.prototype.r5b=function(Tc){function rb(vb){Ra.a(vb)?n.ULS.sendTraceTag(527500297,
0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",Sa.a.Uc(vb.Errors)):(n.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Tc===Pc.twice?Ta.r5b(Pc.once):Ta.OUc())}function eb(){return new Gb.a(fb)}var Ta=this,fb=ca.v(this.gridView.ha.va.Qd,this.$);if(!fb)return Zc.Task.Ta(!1);this.gdb||(this.gdb=Date.now());var pb=new Da.a(368460465,2,this.$.ed,19,null),rc=this.$.qa.ta.Xb();return Ma.EwaSettings.tc()?va.a(this.$.userOperationManager,
function(vb,E,Nb){return Y.jb(Ta.$.qa.ta,fb,Lb.b(vb,rb),E,Nb,null,rc)},function(vb){return new S.a(516,0,vb,64,eb)},pb):va.a(this.$.userOperationManager,function(vb,E,Nb){return Y.jb(Ta.$.qa.ta,fb,Lb.b(vb,rb),E,Nb,null,rc)},function(vb){return new wa.a(516,0,vb,void 0,eb)},pb)};d.prototype.dSg=function(Tc,rb){return sa.d(Tc)&&rb.top===Tc.usedRange.top?(this.gpc(this.$,224),!0):sa.g(Tc)&&rb.top===Tc.usedRange.bottom?(this.gpc(this.$,225),!0):!1};d.prototype.cSg=function(Tc,rb){if(Tc&&Tc.contains(rb)&&
rb.top===Tc.top||!Tc&&this.fRg(rb.top,rb.left))return this.gpc(this.$,226),!0;Tc=new I.Range(rb.top,rb.left,rb.top+1,rb.left+1,!1,!1);return this.gridView.Vb.agc(Tc)?(this.gpc(this.$,227),!0):!1};d.prototype.gpc=function(Tc,rb){rb=Sa.a.jd(1,1,735,rb,0,147079615,"ContextMenuFilterByCellValueError");Ma.EwaSettings.az()?new Tb.a(Tc,rb):(Tc=new sb.ErrorDialog(Tc,rb),Tc.initialize(),Tc.nf())};d.prototype.OUc=function(){function Tc(vb){var E={};E=(E.ToggleFilterOperationCount=rb.idb,E.ApplyFilterTime=rb.QUc?
Date.now()-rb.QUc:-1,E.ToggleAndApplyFilterTime=rb.gdb?Date.now()-rb.gdb:-1,E.FilterByValueType=Ta.AutoFilterType,E);n.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(E));rb.gdb&&(rb.gdb=0);wb.a.tvc(vb)&&(E=wb.a.x9b(vb),rb.SLa?wb.a.DPa(Mb.a.filterByCellValue,E.MessageIdName,Eb.a.Ara,!0,wb.a.isSessionEndingError(E.MessageId)):n.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",
E.MessageIdName));Ra.a(vb)?n.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",Sa.a.Uc(vb.Errors)):(n.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Ja.b(rb.$).ae(Fb.a.luf,rb.dm(),void 0,!0),vb={},vb.FirstRow=rb.KIh(),vb.FirstColumn=Ta.Column,-1!==vb.FirstRow&&(vb=ca.C(vb),rb.ZK(vb)))}var rb=this;this.QUc=Date.now();var eb=this.oUh();if(!eb)return n.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),
Zc.Task.Ta(!1);var Ta=this.AU(),fb={FirstRow:0};fb.FirstColumn=Ta.Column;fb.SheetName=Ta.SheetName;Ja.b(this.$).ae(Fb.a.Dqf,this.dm(),void 0,!0);var pb=this.H1c(Ta,fb),rc=new S.a(208,0,function(vb,E,Nb){return Y.a(rb.$.qa.ta,pb,eb,Lb.b(vb,Tc),E,Nb,null,null)},6,function(){return new Sb.a(eb,pb)});this.namedSheetViewPublic?this.namedSheetViewPublic.dAa().continueWith(function(vb){vb.result&&rb.$.userOperationManager.ic(rc,null)}):this.$.userOperationManager.ic(rc,null);return Zc.Task.Ta(!0)};d.prototype.ZK=
function(Tc){Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&na.TaskExtensions.Ba(Zb.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(rb){rb.result.Pda(Tc);n.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ma,3)};d.prototype.dm=function(){if(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var Tc={};return Tc.Location=
"contextMenu",Tc}return{}};d.prototype.AU=function(){var Tc=0,rb=this.$.da.Aa(66).Wg;if(rb){var eb="Table";Tc=rb.objectId}else eb="Sheet";var Ta=this.gridView.ha.va.activeCell.left;rb={};rb.AutoFilterType=eb;rb.Column=Ta;rb.Id=Tc;eb={};this.$.wj(eb);eb.FirstRow=0;eb.FirstColumn=rb.Column;Tc=this.$.fa.isNamedObjectViewMode;rb.NamedObjectView=Tc;rb.SheetName=Tc?eb.NamedObjectName:eb.SheetName;rb.ItemListOptions=null;return rb};d.prototype.fRg=function(Tc,rb){Tc=I.Range.ld(Tc,rb);return this.gridView.Ca.E9(Tc,
this.$.oa.name)&&(Tc=this.gridView.Ca.oub(Tc))&&Tc.autoFilterMenu?!0:!1};d.prototype.oUh=function(){var Tc=null,rb=this.gridView.sc(this.gridView.ha.va.activeCell);if(!rb)return null;var eb=rb.cell.FQd;var Ta=this.instantaneousSupportInformationManager.Ddb(eb,!1).category;if(1===rb.aL.type)if(3===Ta){if(!rb.cell.T7a)return n.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",Ta),null;Tc=(rb.cell.T7a.Start+rb.cell.T7a.End).trim()}else if(!Ta&&
(za.a.n_a(rb.aL.value,"E")||za.a.n_a(rb.originalText,"E"))){Tc=this.hi.ayh(rb.aL.value,eb,rb.cell.Fsa);if(!Tc.success)return n.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",Ta),null;Tc=Tc.mM}Tc||(Tc=rb.originalText);return hb.a.nZc(Tc)?["[Blanks]"]:["i"+Tc.trim()]};d.prototype.KIh=function(){var Tc=this.$.da.Aa(66).Wg;if(Tc)return Tc.usedRange.top;Tc=this.$.xa.getItemByName(this.$.oa.sheetName);return(Tc=ca.D(Tc.h0))&&
Tc.contains(this.gridView.ha.va.activeCell)?Tc.top:-1};d.prototype.H1c=function(Tc,rb){var eb={};eb.Location=rb;eb.FieldId=Tc.Id.toString();eb.DataSourceIndex=-1;eb.FilterType=Tc.AutoFilterType;eb.AnchorType=0;eb.ChartId=null;eb.AnchorValue1=-1;eb.AnchorValue2=-1;eb.Property=Tc.RichProperty;return eb};Object(y.a)(d,"GridContextMenuFilter",null,[]);b.d(D,"GridContextMenu",function(){return a});var vd=z.a;vm(a,vd);a.prototype.dispose=function(){vd.prototype.dispose.call(this);this.grid=null};a.prototype.Xc=
function(Tc,rb){Tc=!this.cod(Tc,rb);if(!Tc)switch(rb){case -1977666927:Tc=null==this.p3a||this.Koj();break;case 1549396389:Tc=null==this.p3a||this.Qoj();break;case 1803952894:Tc=null==this.p3a||!this.$.isEditMode&&!this.y9h()}return Tc};a.prototype.cod=function(Tc,rb){var eb=this.grid.ha.va.selectedRanges;return(new xa.a(this.$.xa)).xn(Tc,rb,eb,this.grid)};a.prototype.executeCommand=function(Tc,rb,eb){var Ta=rb.command;Tc=null;switch(Ta){case -1396319072:if(rb=this.grid.sc(null))l.a.instance.eYc(!0),
f.EventHandlerManager.instance.U$c(),a.kNi(rb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.va.selectedRanges,rb);break;case 324156914:Tc=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(eb);break;case -1977666927:Tc=this.p3a.fch();break;case 1549396389:Tc=this.p3a.wch();break;case 1803952894:Tc=this.p3a.lch();break;default:Tc=lb.a(Ta)}return Tc||na.TaskExtensions.f4()};a.prototype.Gc=function(Tc,rb,eb){Tc=!1;switch(rb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Tc=
!0;break;case 1441131127:Tc=!!eb}return Tc};a.prototype.yY=function(Tc){Tc=void 0===Tc?!1:Tc;var rb=!1,eb=!1,Ta=0;Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ta=u.a.me());var fb=this.Sa.zp(this.menuId),pb=this.grid.ha.va,rc=pb.Dh,vb=rc&&pb.Qd.Lh,E=rc&&pb.Qd.isRow;pb=pb.selectedRanges;var Nb=v.a.all(pb,function(Ga){return Ga.Lh}),ka=v.a.all(pb,function(Ga){return Ga.isRow}),bb=ca.O(pb),Ha=ca.P(pb);this.wcf(vb,E)?(rb=!0,this.ZAh(fb)):this.$.isEditMode?
Ya.a(this.$)?this.$Ah(fb,vb,E):(this.$zh(fb,!(E||vb||!this.Igc)),this.uAh(fb,pb,Tc),this.kAh(fb,Nb,ka,bb,Ha),this.sTe(fb,rc,vb,E),this.rBh(fb),this.SSe(fb,vb,E),this.QAh(fb,rc,vb,E,pb),this.cAh(fb),this.aAh(fb,pb),this.BAh(fb),this.mBh(fb,rc),Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.oAh(fb)):(eb=!0,Ya.a(this.$)?this.lTe(fb):this.HBh(fb,rc,vb,E,pb));Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Tc=u.a.me()-
Ta,n.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",Tc,rb,eb,this.qBe));this.qBe=!1;return fb};a.prototype.BJa=function(Tc){var rb=[];if(Ya.a(this.$))return rb;if(3===Tc){Tc=this.grid.ha.va;var eb=Tc.Dh,Ta=eb&&Tc.Qd.Lh,fb=eb&&Tc.Qd.isRow,pb=!1,rc=!1,vb=!1;this.cmd&&(rc=Tc.selectedRanges,pb=ca.O(rc),rc=ca.P(rc));if(eb){var E=zb.e(this.grid);E&&E.range.contains(Tc.Qd)&&this.hV(E)&&(vb=!0)}this.$.isEditMode?
this.wcf(Ta,fb)?Array.addRange(rb,[ia.a.uDf,ia.a.wDf]):Ta||fb?(Array.add(rb,ia.a.clipboard),fb?Array.add(rb,ia.a.cbj):Ta&&Array.add(rb,ia.a.zVg)):(Array.addRange(rb,[ia.a.edit,ia.a.clipboard]),vb?Array.add(rb,ia.a.hyperlink):Array.add(rb,ia.a.color),eb&&Array.add(rb,ia.a.sIg)):(Array.add(rb,ia.a.copy),vb&&Array.add(rb,ia.a.openHyperlink),!fb||this.cmd&&rc?!Ta||this.cmd&&pb||Array.add(rb,ia.a.gOj):Array.add(rb,ia.a.hOj));Array.add(rb,ia.a.KVh)}else 2===Tc&&Array.add(rb,ia.a.Cue);return rb};a.prototype.wcf=
function(Tc,rb){return(this.bAa||this.qva||this.UY||this.refresh||this.expandCollapse)&&!(Tc||rb)};a.prototype.showGridContextMenu=function(Tc){this.expandCollapse=this.refresh=this.UY=this.qva=this.bAa=!1;var rb=this.$,eb=pa.a(rb).PJa(),Ta=this.grid.ha.va,fb=Ta.Dh,pb=fb&&Ta.Qd.Lh;Ta=fb&&Ta.Qd.isRow;if(eb&&!pb&&!Ta){pb=Ia.a(rb);if(null===pb||void 0===pb?0:pb.gOd)this.bAa=pb=Q.f(rb.kg),this.qva=!pb;pb=rb.lc;this.UY=eb.supportsBIExplore&&!!N.a(rb)&&pb.m2(32768);pb.allowInteractivity&&(rb=this.grid.sc(null),
(null===rb||void 0===rb?0:rb.cell)&&(rb.cell.UXc||rb.cell.yZf)&&(this.expandCollapse=!0),pb.allowManualDataRefresh&&(this.refresh=!0))}rb=null;eb=1;pb=Object(x.a)(m.a,Tc.eventArgs);Tc=Object(x.a)(P.a,Tc.creationParams);Ta=this.PFh();Tc?(rb=Tc.clientPoint,eb=Tc.inputMethod):pb&&1!==pb.zb?(rb=new Sys.UI.Point(pb.clientPoint.x,pb.clientPoint.y),eb=pb.zb):Ta&&(rb=new Sys.UI.Point(Ta.x+(this.$.isChromeRtl?0:Ta.width),Ta.y+Ta.height));O.a.Wb=eb;this.Igc=3===eb;Tc=G.a.hsb;this.so(rb,!pb||pb.Ea.target.className!==
Tc,eb)};a.prototype.removeHyperlinksFromRange=function(Tc,rb){var eb=this;if(!Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.xs(Tc,!0)){var Ta=ca.r(Tc,this.$),fb=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new S.a(125,0,function(pb,rc,vb){eb.$.Xu();return Y.c(eb.$.qa.ta,Ta,"","",!0,!1,127,pb,rc,vb,null,fb)},void 0,function(){return new c(Ta)}),rb);this.grid.Bh.qG(!1)}};a.prototype.PFh=function(){var Tc=this.grid.sc(null);if((null===
Tc||void 0===Tc?0:Tc.cell.tk)&&this.Hbf(Tc))return this.grid.getCellBounds(Tc.cell);Tc=this.grid.ha.va.activeCell;return(Tc=this.d8b(new I.Range(Tc.top,Tc.left,r.a.Fh,Tc.left,!1,!1),2,!0)||this.d8b(new I.Range(1,Tc.left,Tc.top,Tc.left,!1,!1),2,!1)||this.d8b(new I.Range(Tc.top,Tc.right,Tc.top,r.a.Qh,!1,!1),1,!0)||this.d8b(new I.Range(Tc.top,1,Tc.top,Tc.right,!1,!1),1,!1)||null)&&Tc.tk?this.grid.getCellBounds(Tc):Sys.UI.DomElement.getBounds(this.grid.Jvb.Jb)};a.prototype.Hbf=function(Tc){var rb=this.grid.rtl,
eb=this.$.isChromeRtl;Tc=Tc.cell;var Ta=zb.g(this.$).BJ(Tc);return Ta?(Ta=Ta.topLeft,rb=Ta.x+=rb===eb?Tc.offsetWidth:0,eb=Ta.y+=Tc.offsetHeight,this.grid.view.visibleArea.contains(new B.a(rb,eb,0,0))):!1};a.prototype.d8b=function(Tc,rb,eb){Tc=this.grid.sl("GridContextMenu.FindFirstCellInViewportArea",Tc,rb,eb);try{for(Tc.$$rst();Tc.$$mn();){var Ta=Tc.$$cu();if(Ta&&this.Hbf(Ta))return Ta.cell}}finally{Tc&&Tc.dispose()}return null};a.prototype.ZAh=function(Tc){var rb=this.Sa,eb=rb.Lc();this.refresh&&
Array.add(eb.buttons,rb.yb(100));this.UY&&Array.add(eb.buttons,rb.yb(99));this.bAa?Array.add(eb.buttons,rb.yb(59)):this.qva&&Array.add(eb.buttons,rb.yb(58));if(this.expandCollapse){var Ta=rb.Kv("ContextMenu.PivotExpandCollapse",null,W.a.instance.ea(1117),589118293);var fb=rb.Lc();Array.add(fb.buttons,rb.yb(243));Array.add(fb.buttons,rb.yb(244));Array.add(fb.buttons,rb.yb(245));Array.add(fb.buttons,rb.yb(246));Array.add(Ta.menu.yc,fb);Ta&&0<fb.buttons.length&&Array.add(eb.buttons,Ta)}Array.add(Tc.yc,
eb)};a.prototype.sTe=function(Tc,rb,eb,Ta){if(rb&&!eb&&!Ta){rb=this.Sa.Lc();this.kld&&!this.$.lV&&this.$Se(rb);this.Qad(rb);this.vBh(rb);if(Ma.EwaSettings.la(500)&&zb.g(this.$).ha.va.zM()&&zb.g(this.$).ha.va.nV)switch(Ma.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Array.add(rb.buttons,this.Sa.yb(237));break;case 2:Array.add(rb.buttons,this.Sa.yb(238));break;default:Array.add(rb.buttons,this.Sa.yb(236))}Array.add(Tc.yc,
rb)}};a.prototype.Qad=function(Tc){if(!Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new xa.a(this.$.xa)).te(2048)){var rb=this.Sa.Lc();Array.add(rb.buttons,this.Sa.yb(223));Array.add(rb.buttons,this.Sa.yb(224));this.$.isMobileMode||Array.add(rb.buttons,this.Sa.yb(225));var eb=this.Sa.Kv("ContextMenu.sort",null,W.a.instance.ea(228),-864298118);Array.add(eb.menu.yc,rb);Array.add(Tc.buttons,eb)}};a.prototype.$Se=function(Tc){var rb=
this.Sa.Kv("ContextMenu.filter",null,W.a.instance.ea(1903),2045563128),eb=this.Sa.Lc(),Ta=this.lKh(),fb=this.Sa.yb(234);fb.label=Ta;Array.add(eb.buttons,fb);Array.add(eb.buttons,this.Sa.yb(235));Ta=this.Sa.Lc();Array.add(Ta.buttons,this.Sa.yb(233));Array.add(rb.menu.yc,eb);Array.add(rb.menu.yc,Ta);Array.add(Tc.buttons,rb)};a.prototype.vBh=function(Tc){if(zb.g(this.$).ha.va.zM()){var rb=this.Sa.Lc();Array.add(rb.buttons,this.Sa.yb(232));Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",
!1)&&(Array.add(rb.buttons,this.Sa.yb(285)),Array.add(rb.buttons,this.Sa.yb(286)));var eb=this.Sa.Kv("ContextMenu.table",null,W.a.instance.ea(1902),-697806646);Array.add(eb.menu.yc,rb);Array.add(Tc.buttons,eb)}};a.prototype.fTe=function(Tc,rb,eb,Ta,fb){if(rb){var pb=ca.K(fb),rc=zb.e(this.grid);if(rc&&!eb&&!Ta){eb=new xa.a(this.$.xa);if(rc.range.contains(pb)&&this.hV(rc)){(rb=!rc.ELa&&!eb.ik)&&this.$.isEditMode&&Array.add(Tc.buttons,this.Sa.yb(45));rc.vaa&&Array.add(Tc.buttons,this.Sa.yb(53));rb&&
this.$.isEditMode&&Array.add(Tc.buttons,this.Sa.yb(47));return}!rc.ELa&&this.$.isEditMode&&(rc=eb.te(128),Array.add(Tc.buttons,this.Sa.yb(rc?46:121)))}}this.VXi(fb)&&Array.add(Tc.buttons,this.Sa.yb(48));rb&&Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode&&(rb=ca.K(fb),this.UXi(rb)?Array.add(Tc.buttons,this.Sa.yb(276)):rb.Lh||rb.isRow||Array.add(Tc.buttons,this.Sa.yb(275)))};a.prototype.VXi=function(Tc){Tc=yl(Tc);for(var rb=Tc.next();!rb.done;rb=
Tc.next()){rb=this.grid.getRangeInformation(rb.value);for(var eb=0;eb<rb.length;eb++)if(Object(t.a)(R.HyperlinkRange,rb[eb])){var Ta=this.grid.sc(rb[eb]);if(Ta&&this.hV(Ta)&&!Ta.ELa)return!0}}return!1};a.prototype.UXi=function(Tc){if(zb.g(this.$).ha.va.zM()){var rb=zb.g(this.$).Vb.vk(Tc);if(rb&&rb.usedRange.equals(Tc))return!0}return!1};a.prototype.SSe=function(Tc,rb,eb){var Ta,fb;if(1===zb.g(this.$).ha.Te&&!rb&&!eb){rb=Ya.a(this.$);eb=this.Sa;var pb=eb.Lc(),rc=this.$.da.Aa(65);(null===(Ta=null===
rc||void 0===rc?void 0:rc.Bn)||void 0===Ta?0:Ta.uE)&&!rb&&Array.add(pb.buttons,eb.yb(227));rc&&rc.isCommentOperationEnabled(3)&&Array.add(pb.buttons,eb.yb(221));(null===(fb=null===rc||void 0===rc?void 0:rc.Bn)||void 0===fb?0:fb.y4e)&&!rb&&Array.add(pb.buttons,eb.yb(228));(null===rc||void 0===rc?0:rc.hasCommentAtActiveCell)?rc.QB.isResolved||Array.add(pb.buttons,eb.yb(159)):rc&&rc.hasCommentAtActiveCell||(rc&&rc.Bn&&rc.Bn.uE?rb||(Array.add(pb.buttons,eb.yb(229)),Array.add(pb.buttons,eb.yb(230))):(Array.add(pb.buttons,
eb.yb(160)),rb||Array.add(pb.buttons,eb.yb(226))));Array.add(Tc.yc,pb)}};a.prototype.rBh=function(Tc){if(Ma.EwaSettings.la(134)){var rb=this.Sa,eb=rb.Lc();Array.add(eb.buttons,rb.yb(250));Array.add(Tc.yc,eb)}};a.prototype.uAh=function(Tc,rb,eb){if(!eb){eb=this.$.Ka.LG();var Ta=new xa.a(this.$.xa),fb=new ma.a(eb,rb,this.grid);(new k(Tc,this.$,this.Sa,eb,rb,this.grid,fb,Ta)).Had()}};a.prototype.kAh=function(Tc,rb,eb,Ta,fb){var pb=(new xa.a(this.$.xa)).te(8),rc=this.Sa,vb=rc.Lc();rb&&Array.add(vb.buttons,
rc.yb(pb?152:153));eb&&Array.add(vb.buttons,rc.yb(pb?150:151));rb&&(Ta||Array.add(vb.buttons,rc.yb(pb?109:155)),Array.add(vb.buttons,rc.yb(pb?111:157)));eb&&(fb||Array.add(vb.buttons,rc.yb(pb?108:154)),Array.add(vb.buttons,rc.yb(pb?110:156)));Array.add(Tc.yc,vb)};a.prototype.$zh=function(Tc,rb){var eb=this.Sa,Ta=eb.Lc();Array.add(Tc.yc,Ta);rb&&Array.add(Ta.buttons,eb.yb(102));Array.add(Ta.buttons,eb.yb(42));Array.add(Ta.buttons,eb.yb(43));rb=this.WAh(eb);Array.add(Tc.yc,rb)};a.prototype.WAh=function(Tc){var rb=
Tc.Lc();rb.title=W.a.instance.ea(1097);rb.z0f=!1;rb.y0f=!1;rb.F5f=!1;var eb=5,Ta=Z.a.wpd(this.$);Ta&&(eb=6);Tc=Tc.iA("PasteOptionsGallery",eb,"Size24by24",rb.title);Array.add(rb.buttons,Tc);Tc.ht("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1098,void 0,"Paste_24",1,w.a.Lnh);Tc.ht("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1099,void 0,"PasteValues_24",1,w.a.Qnh);Tc.ht("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",
1100,void 0,"PasteFormulas_24",1,w.a.Nnh);Tc.ht("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1101,void 0,"PasteTranspose_24",1,w.a.Pnh);Tc.ht("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1102,void 0,"PasteFormatting_24",1,w.a.Mnh);Ta&&Tc.ht("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1103,void 0,"PasteLink_24",1,w.a.Onh);return rb};a.prototype.HBh=function(Tc,rb,eb,Ta,fb){var pb,rc=this.Sa,
vb=rc.Lc();Array.add(vb.buttons,rc.yb(43));Array.add(Tc.yc,vb);this.kld&&!this.$.lV&&(vb=this.Sa.Lc(),this.$Se(vb),Array.add(Tc.yc,vb));Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.fa.lc.isMobileMode&&this.$.fa.lc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(vb=this.Sa.Lc(),this.Qad(vb),Array.add(Tc.yc,vb),n.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));
vb=this.$.da.Aa(65);if(null===(pb=null===vb||void 0===vb?void 0:vb.Bn)||void 0===pb?0:pb.uE)pb=this.Sa.Lc(),Array.add(pb.buttons,rc.yb(229)),Array.add(Tc.yc,pb);pb=this.Sa.Lc();this.fTe(pb,rb,eb,Ta,fb);Array.add(Tc.yc,pb);A.AFrameworkApplication.isMobileMode&&!ba.a(this.$.ya,30)&&(rb=rc.Lc(),Array.add(rb.buttons,rc.yb(272)),Array.add(Tc.yc,rb))};a.prototype.QAh=function(Tc,rb,eb,Ta,fb){var pb=this.Sa.Lc();this.RAh(pb);this.fTe(pb,rb,eb,Ta,fb);0<pb.buttons.length&&Array.add(Tc.yc,pb)};a.prototype.RAh=
function(Tc){Array.add(Tc.buttons,this.Sa.yb(135))};a.prototype.oAh=function(Tc){var rb=this.Sa.Lc();Array.add(rb.buttons,this.Sa.yb(185));Array.add(Tc.yc,rb)};a.prototype.mBh=function(Tc,rb){Ma.EwaSettings.la(501)&&rb&&(rb=this.Sa.Lc(),Array.add(rb.buttons,this.Sa.yb(262)),Array.add(Tc.yc,rb))};a.prototype.BAh=function(Tc){var rb=this.grid.ha.va.selectedRanges;if(rb&&rb.length){for(var eb=!1,Ta=0;Ta<rb.length;Ta++)if(this.grid.Vb.YLa(rb[Ta])){eb=!0;break}if(eb){var fb=this.Sa;eb=fb.Lc();Ta=fb.Lc();
for(var pb=1===rb.length&&(rb[0].isSingle||this.grid.Vb.xyb(rb[0])),rc=!1,vb=!1,E=!1,Nb=!1,ka=0;ka<rb.length&&!(rc&&E&&vb&&Nb);ka++)!rc&&this.grid.Vb.Rci(rb[ka])&&(rc=!0),!E&&this.grid.Vb.zbf(rb[ka],!1)&&(E=!0),!vb&&this.grid.Vb.Und(rb[ka])&&(vb=!0),!Nb&&this.grid.Vb.A9h(rb[ka])&&(Nb=!0);Ma.EwaSettings.la(104)&&pb&&!this.grid.Vb.Tdc(rb[0])&&(Nb?Array.add(eb.buttons,fb.yb(217)):Array.add(eb.buttons,fb.yb(216)));Nb=rc;Nb=!(new xa.a(this.$.xa)).ik&&Nb;E&&(Ma.EwaSettings.la(130)&&Q.l(this.$.kg)&&(Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Ta.buttons,fb.yb(220)):Array.add(Ta.buttons,fb.yb(Nb?220:271))),vb&&Array.add(Ta.buttons,fb.yb(Nb?218:269)),pb&&(this.grid.Vb.Und(rb[0])||this.grid.Vb.Tdc(rb[0]))&&Array.add(Ta.buttons,fb.yb(Nb?219:270))),Array.add(Ta.buttons,fb.yb(Nb?215:268)));0<Ta.buttons.length&&(rb=fb.Kv(rc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,W.a.instance.ea(1726),
798637440),Array.add(rb.menu.yc,Ta),Array.add(eb.buttons,rb));0<eb.buttons.length&&Array.add(Tc.yc,eb)}}};a.prototype.aAh=function(Tc,rb){this.grid.Vb.Z$e(rb)&&(rb=this.Sa.Lc(),this.grid.ha.va.wwa()?(Array.add(rb.buttons,this.Sa.yb(241)),Array.add(rb.buttons,this.Sa.yb(239))):Array.add(rb.buttons,this.Sa.yb(240)),Array.add(Tc.yc,rb))};a.prototype.hV=function(Tc){return Tc.cell.hasHyperlink};a.prototype.lTe=function(Tc){this.aBh(Tc);var rb=this.Sa.Lc();this.Qad(rb);Array.add(Tc.yc,rb)};a.prototype.$Ah=
function(Tc,rb,eb){this.lTe(Tc);this.SSe(Tc,rb,eb)};a.prototype.aBh=function(Tc){if(this.grid.ha.va.Dh&&!this.grid.$a.Zi){var rb=this.Sa,eb=rb.Lc();Wb.a(this.$).KOd()?Array.add(eb.buttons,rb.yb(265)):Array.add(eb.buttons,rb.yb(264));Array.add(Tc.yc,eb)}};a.kNi=function(Tc){var rb=Tc.GJa(a.wid);rb&&rb.nkd&a.wid&&Tc.invoke(a.wid,null)};a.tAh=function(Tc,rb,eb){if(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(eb=eb.da.Aa(254),!eb){n.ULS.sendTraceTag(537167044,
0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(eb=eb.da.Aa(254,!0),!eb)return;eb.Cmd()&&eb.sgf()&&Array.add(Tc.buttons,rb.yb(212));eb.Cmd()&&eb.Bhc()&&Array.add(Tc.buttons,rb.yb(213))};a.prototype.Koj=function(){var Tc=this.grid.ha.va.activeCell;return da.c(this.$,Tc)||!this.z9h(Tc)};a.prototype.z9h=function(Tc){var rb=Tc.left,eb=this.m0e();if(null!=eb&&null!=eb.gQe&&Array.contains(eb.gQe,rb-1))return!0;eb=this.Ued();return null!=
eb&&ca.D(eb).contains(Tc)&&null!=eb.FilteredColumns&&Array.contains(eb.FilteredColumns,rb-1)?!0:!1};a.prototype.Qoj=function(){var Tc=this.$.da.Aa(66).Wg;if(null!=Tc)return!Tc.hasAutoFilter||!Tc.znb;Tc=this.$.xa.getItemByName(this.$.oa.sheetName);return!Tc.hasAutoFilter||!Tc.znb};a.prototype.y9h=function(){if(null!=this.m0e())return!0;var Tc=ca.D(this.Ued());return null!=Tc&&Tc.contains(this.grid.ha.va.activeCell)?!0:!1};a.prototype.m0e=function(){var Tc=this.$.da.Aa(66);Tc.eo(this.grid.ha.va.activeCell);
return Tc.eUe(this.grid.ha.va.activeCell)};a.prototype.Ued=function(){return this.$.xa.getItemByName(this.$.oa.sheetName).h0};a.prototype.lKh=function(){var Tc=this.grid.ha.va.activeCell,rb=0,eb=!1,Ta=this.$.da.Aa(66).Wg;null!=Ta?(rb=Ta.usedRange.top,eb=!0):(Ta=this.Ued(),null!=Ta&&ca.D(Ta).contains(Tc)&&(rb=Ta.FirstRow+1,eb=!0));return eb?(Tc=Tc.left,rb=I.Range.ld(rb,Tc),rb=this.grid.sc(rb),eb="",null!=rb&&(eb=rb.text),this.HLg(eb,Tc)):W.a.instance.ea(221)};a.prototype.HLg=function(Tc,rb){null==
Tc||za.a.yj(Tc.trim())?Tc=String.format(W.a.instance.Cb(156),I.Range.rY(rb)):Tc.length>a.TYd?(Tc=Tc.substring(0,a.TYd),Tc=String.format(W.a.instance.Cb(154),Tc)):Tc=String.format(W.a.instance.Cb(155),Tc);return Tc};tl.Object.defineProperties(a.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return U.a.qIf}}});a.cHb="GridContextMenuRootName";a.TVh="gridMenuId";a.wid=192;a.TYd=26;Object(y.a)(a,"GridContextMenu",
z.a,[])},1245:function(y,D,b){function a(pa,Ia){var Ma=na.call(this,pa)||this;Ma.pCa=null;Ma.IYc=[];Ma.T1d=null;Ma.tva=!1;Ma.ycc=!1;Ma.Wp=null;Ma.B8d=null;Ma.VGe=function(){Ma.lY.NIa(Ma.items,Ma.pCa);Ma.raiseEvent("ACLBUpdated",new x.a(Ma.items.length));Ma.show()};Ma.tableManager=Ia;Ma.domElement.className=m.a.TJe;Ma.domElement.innerHTML="<div id='suggested_cells_list_box' class='ewa-lb ewa-scrollbars' ></div>";W.DOMElementExtensions.setVisible(Ma.domElement,!1);xa.d(Ma.style,Ma.$.isChromeRtl);Ma.xue=
$get(n.$yj,Ma.domElement);Ma.lY=new d(Ma.$,Ma.xue);Ma.QRa(!0);Ma.$.domElement.appendChild(Ma.domElement);Ma.rnb(pa,S.a(pa));Ma.rnb(pa,N.g(pa).Kc);Ma.$.da.Ha(1,Ma);return Ma}function d(pa,Ia){pa=O.call(this,pa,Ia)||this;pa.cellAutoCompleteControl=null;pa.Bqa=null;pa.Kr=[];return pa}function c(pa,Ia){var Ma=P.call(this,pa,Ia)||this;Ma.k0d=null;Ma.mqd=0;Ma.J6a=null;Ma.t0=null;Ma.kLa=!1;Ma.WBb=function(lb,zb){if(lb=Ma.cellAutoCompleteControl.items)if(1===lb.length&&Ma.cellAutoCompleteControl.rqb.length<
lb[0].zra.length&&Ma.cellAutoCompleteControl.tva&&U.a.eI(lb[0].zra,Ma.cellAutoCompleteControl.rqb)&&(zb.newValue=lb[0].zra),Ma.qb&&B.EwaSettings.la(135)){var Ya=-1;1<lb.length?Ya=Ma.cellAutoCompleteControl.Jac(Ma.qb.text,!0):1===lb.length&&(Ma.cellAutoCompleteControl.tva||Ma.cellAutoCompleteControl.ycc)&&(Ya=0);if(0<=Ya&&lb.length>Ya&&lb[Ya].LVc){var Wb=w.C(lb[Ya].LVc);Wb&&N.g(Ma.$).Vb.YLa(Wb)&&(zb.X9e=!0,zb.yue=lb[Ya].LVc)}}};Ma.hDb=function(){Ma.kLa&&(Ma.cellAutoCompleteControl.tva=!1)};Ma.qb.EXb(Ma.WBb);
Ma.kLa=B.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");Ma.kLa&&(Ma.t0=Ma.Nd.Cd(Ma.qb.textBox.domElement),Ma.t0.ja("mousedown",Ma.hDb));return Ma}function k(pa,Ia){this.Rgg=pa;this.Qgg=Ia}function n(){}b.r(D);y=b(0);var l=b(13),f=b(88),u=b(1189),v=b(9),m=b(929);n.$yj="suggested_cells_list_box";Object(y.a)(n,"CssElementIds",null,[]);var A=b(4),x=b(1190);tl.Object.defineProperties(k.prototype,{zra:{configurable:!0,enumerable:!0,get:function(){return this.Rgg}},
LVc:{configurable:!0,enumerable:!0,get:function(){return this.Qgg}}});Object(y.a)(k,"CellAutoCompleteItem",null,[620]);var t=b(5),z=b(84),r=b(1046),G=b(381),w=b(43),B=b(1),U=b(19),N=b(20),P=r.a;vm(c,P);c.prototype.dispose=function(){this.qb.FGd(this.WBb);P.prototype.dispose.call(this)};c.prototype.NT=function(pa){pa&&!this.cellAutoCompleteControl.isListVisible||P.prototype.NT.call(this,pa)};c.prototype.ki=function(pa,Ia){this.cellAutoCompleteControl.qb=this.qb;this.mqd=pa.keyCode;if(this.qb.isEditing){var Ma=
this.qb.text;U.a.equals(this.J6a,Ma,!1)||(this.J6a=Ma)}else this.J6a=null;if(237279923===Ia)return this.cellAutoCompleteControl.isListVisible=!1;B.EwaSettings.la(135)&&17===this.mqd&&this.cellAutoCompleteControl.tva&&(this.cellAutoCompleteControl.ycc=!0);return P.prototype.ki.call(this,pa,Ia)};c.prototype.Zwd=function(){B.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")&&t.AFrameworkApplication.Gg||(this.cellAutoCompleteControl.qb=this.qb,this.cellAutoCompleteControl.tva=
!1,this.qb.isEditing?U.a.equals(this.J6a,this.qb.text,!0)||this.cellAutoCompleteControl.gHg(this.mqd):this.J6a=null)};c.prototype.Mj=function(){};c.prototype.Rh=function(){this.kV=!1;this.cellAutoCompleteControl.set_visible(!1);this.J6a=null;this.cellAutoCompleteControl.tva=!1;this.cellAutoCompleteControl.ycc=!1;this.cellAutoCompleteControl.S6a&&this.cellAutoCompleteControl.S6a.cancel()};c.prototype.lDd=function(pa,Ia){return this.cellAutoCompleteControl.ki(pa,Ia)};tl.Object.defineProperties(c.prototype,
{qxb:{configurable:!0,enumerable:!0,get:function(){return!1}},kV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(pa){this.cellAutoCompleteControl.isListVisible=pa}},swb:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return G.a.JYc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){var pa=b(1245).CellAutoCompleteControl;return this.k0d||(this.k0d=Object(z.a)(pa,
this.$.da.Aa(1)))}}});Object(y.a)(c,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var ia=b(28);r=b(1191);var W=b(11),R=b(8),I=b(118),Q=b(63),O=r.a;vm(d,O);d.prototype.dispose=function(){O.prototype.dispose.call(this);this.Bqa=null};d.prototype.uxc=function(pa){this.d7(!1);var Ia=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.rba);for(var Ma=0,lb=this.Kr.length;Ma<lb;Ma++){var zb=ia.a.If(pa[this.Kr[Ma]].zra);zb=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.QZ,d.KYc,A.a.ane,zb,ia.a.f6b(zb));Ia+=zb}this.dg.innerHTML=Ia+"</tbody></table>";this.zn=W.DOMElementExtensions.vj(this.domElement,this.rba);this.d7(!0);this.hra()};d.prototype.NIa=function(pa,Ia){if(pa&&pa.length){var Ma=[];if(Ia)for(var lb=0,zb=pa.length;lb<zb;lb++)U.a.eI(pa[lb].zra,Ia)&&Array.add(Ma,lb);this.Kr=Ma;this.uxc(pa)}else this.isListVisible=!1,this.Bqa=null};d.prototype.qxa=function(){};d.prototype.ROg=function(pa,Ia,Ma){var lb=Math.min(pa,Math.max(200,Ma));Ia&&pa<Ma&&(lb+=I.a.Sp);
W.DOMElementExtensions.Gq(this.dg,lb);Ia&&(lb-=I.a.Sp);return lb};d.prototype.hra=function(){O.prototype.hra.call(this);var pa=W.DOMElementExtensions.vj(this.get_element(),this.rba),Ia=this.Kr.length>this.xH,Ma=N.g(this.$);if(Ma=Ma.sc(Ma.ha.va.activeCell))for(pa=this.ROg(pa.offsetWidth,Ia,Ma.width),Ia=this.dg.getElementsByClassName(d.KYc),Ma=0;Ma<Ia.length;Ma++)Ia[Ma].style.maxWidth=R.HelperMethods.Qb(pa);else l.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
d.prototype.Klc=function(pa){if(pa=O.prototype.Klc.call(this,pa)){var Ia=N.g(this.$);Ia.Dq(!1);Ia.focus()}return pa};tl.Object.defineProperties(d.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this.Bqa},set:function(pa){this.GAa(this.Nk);this.Bqa=pa;var Ia=this.GAa(this.Nk);this.pe=pa?Ia.innerText:null;this.Psc(pa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Q.a)(d.prototype,this,"isListVisible")},set:function(pa){Object(Q.b)(d.prototype,this,"isListVisible",
pa);pa||(this.Nk=null)}},nSa:{configurable:!0,enumerable:!0,get:function(){return null}},JFa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});d.KYc="ewa-suggested-cell-name";Object(y.a)(d,"CellAutoCompleteListBox",r.a,[]);var ba=b(24),ca=b(59),S=b(119),Y=b(186),ma=b(42),Z=b(32),xa=b(247);b.d(D,"CellAutoCompleteControl",function(){return a});var na=u.a;vm(a,na);a.prototype.tTc=function(pa){this.addHandler("ACLBUpdated",
pa)};a.prototype.UGd=function(pa){this.removeHandler("ACLBUpdated",pa)};a.prototype.h2=function(pa){this.addHandler("ACLBSelectionChanged",pa)};a.prototype.Mca=function(pa){this.removeHandler("ACLBSelectionChanged",pa)};a.prototype.PAg=function(pa){this.addHandler("ACLBMatchedItem",pa)};a.prototype.U4i=function(pa){this.removeHandler("ACLBMatchedItem",pa)};a.prototype.K2f=function(pa){for(var Ia=0;Ia<pa.length;Ia++){var Ma=pa.charCodeAt(Ia);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
U.a.isLetter(Ma):U.a.Nmd(Ma))return!0}return!1};a.prototype.JLa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.QRa(!1);var pa=N.g(this.$);pa&&pa.view.Wr(this.Blc)}f.a.pc([this.lY,this.S6a]);f.a.pc(this.IYc);this.IYc=this.xue=this.lY=this.qb=null;na.prototype.dispose.call(this)};a.prototype.ki=function(pa,Ia){var Ma=!1,lb=B.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(this.rqb&&!this.JLa()&&this.get_visible()&&this.isListVisible||
!lb&&267796030===Ia)switch(Ia){case -798660877:if(1===this.items.length&&this.pe)break;this.mt.MA(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.Jac(this.pe),this.pe));Ma=this.wy(!1);break;case 137938150:if(1===this.items.length&&this.pe)break;this.mt.MA(-1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.Jac(this.pe),this.pe));Ma=this.wy(!1);break;case 2091832999:this.mt.MA(this.xH-1);Ma=this.wy(!1);break;case 742457698:this.mt.MA(-(this.xH-1));Ma=
this.wy(!1);break;case 125627505:this.qb.textBox.caretPosition=this.qb.text.length;this.isListVisible=!1;Ma=!0;break;case 267796030:lb||1!==this.items.length?this.wy(!0):this.$cc(!0);break;default:Ma=na.prototype.ki.call(this,pa,Ia)}return Ma};a.prototype.show=function(){this.items&&this.items.length&&(this.lY.Nk=this.pe?this.mt.zn.rows[this.Jac(this.pe)]:null,this.isListVisible=0<this.lY.Kr.length,this.XAa(!0),this.lY.qxa())};a.prototype.gHg=function(pa){var Ia=!!this.qb&&!ca.f(this.$.oa);this.ycc=
this.tva=!1;this.qb&&!this.qb.isEditing?this.set_visible(!1):Ia&&!this.H7g(this.activeCell)&&this.Nsj(pa)};a.prototype.H7g=function(pa){return!!this.dataValidationControl&&this.dataValidationControl.y5c(pa)};a.prototype.wy=function(pa){if(!this.qb||!this.isListVisible)return!1;var Ia=this.pCa;if(this.pe){var Ma=W.DOMElementExtensions.dZ(W.DOMElementExtensions.vj(this.lY.Nk,d.KYc),A.a.ane,""),lb=Ma.substring(Ia.length,Ma.length);pa?this.qb.text=Ma:this.qb.insertTextAt(lb,Ia.length,this.qb.text.length)}Ma=
N.g(this.$);Ma.xj&&(Ma=Ma.Kc,Ma.text=this.qb.text,Ma.setCaretPosition(this.qb.textBox.caretPosition));pa?this.isListVisible=!1:this.qb.textBox.selectRange(Ia.length,this.qb.text.length);return!0};a.prototype.Jac=function(pa,Ia){Ia=void 0===Ia?!1:Ia;if(!this.lY.zn)return-1;for(var Ma=this.lY.zn.children[0],lb=Ma.children.length,zb,Ya=0;Ya<lb;++Ya)if(zb=Ma.children[Ya],U.a.equals(zb.innerText.trim(),pa,Ia))return Ya;return-1};a.prototype.Xvg=function(pa,Ia,Ma,lb,zb,Ya,Wb){var Zb=Ma.originalText.replace(a.zof,
String.fromCharCode(32)),da=new ba.Range(pa.top-1,pa.left,pa.bottom-1,pa.right,!1,!1),za=Wb?Wb.eo(Ma.range):null;(!Ma.VJ||Ma.range.left===pa.left)&&1<Zb.length&&!lb.wb(Zb.toUpperCase())&&U.a.eI(Zb,Ia)&&!U.a.equals(Zb,Ia,!0)&&!a.UQe(Ia)&&this.K2f(Zb)&&(!zb&&!za||!zb&&za.equals(Wb.eo(da))||zb&&Ma.range.Rd(Ya)&&Ma.range.top!==Ya.top)&&(pa=Ma.formulaBarText,U.a.equals(pa,Ma.text,!1)||!pa)&&(pa={},pa.FirstRow=Ma.range.top-1,pa.FirstColumn=Ma.range.left-1,Ma=new k(Zb,pa),lb.add(Zb.toUpperCase(),Ma))};a.prototype.Nsj=
function(pa){this.Wp=this.sSh();this.S6a&&this.S6a.cancel();0<this.qb.text.length&&229!==pa&&pa?this.items&&((1<this.items.length||this.isListVisible)&&this.vdh(),8!==pa&&127!==pa&&46!==pa&&(1===this.items.length?this.$cc(!1):this.lY.Nk&&this.wy(!1))):this.isListVisible=!1};a.prototype.vdh=function(){this.isListVisible?this.VGe():this.B8d=Y.AsyncMethodContext.Ky(this.VGe,500,ma.a.dRg,this.S6a)};a.prototype.$cc=function(pa){l.ULS.shipAssertTag(537167966,0,!this.JLa()&&1===this.items.length,"Invalid Items");
var Ia=this.items[0].zra,Ma=this.qb.text,lb=Ia.substring(Ma.length,Ia.length);if(pa&&!lb.length)this.qb.text=Ia;else if(!pa&&0<lb.length)this.qb.appendText(lb),this.qb.textBox.selectRange(Ma.length,this.qb.text.length);else return;this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,0,Ia));this.tva=!0};a.prototype.sSh=function(){this.Wp=null;var pa=new Z.a(!1),Ia=this.activeCell;this.pCa=this.qb.text.replace(a.zof,String.fromCharCode(32));var Ma=this.tableManager.eo(Ia),lb=Ia.Rd(Ma);if(a.UQe(this.pCa)||
!this.K2f(this.pCa))return this.items;var zb=new ba.Range(1,Ia.left,Ia.top-1,Ia.left,!1,!1),Ya=new ba.Range(Ia.top+1,Ia.left,v.a.Fh,Ia.left,!1,!1),Wb=N.g(this.$);Ya=Wb.sl("CellAutoCompleteControl.GetSuggestedCells",Ya);try{var Zb=Wb.sl("CellAutoCompleteControl.GetSuggestedCells2",zb);try{for(var da=yl([Zb,Ya]),za=da.next();!za.done;za=da.next())for(var hb=za.value;hb.$$mn();){var Gb=hb.$$cu();this.Xvg(Ia,this.pCa,Gb,pa,lb,Ma,this.tableManager)}}finally{Zb&&Zb.dispose()}}finally{Ya&&Ya.dispose()}this.Wp=
Array(pa.values.length);for(Ia=0;Ia<this.items.length;Ia++)this.items[Ia]=pa.values[Ia];this.items.sort(function(Sb,Fb){return Sb.zra.localeCompare(Fb.zra)});return this.items};a.prototype.rnb=function(pa,Ia){pa&&Ia&&Array.add(this.IYc,new c(pa,Ia))};a.UQe=function(pa){pa=0<pa.length?pa.charCodeAt(0):-1;return 35===pa||61===pa||43===pa||45===pa||64===pa};tl.Object.defineProperties(a.prototype,{mt:{configurable:!0,enumerable:!0,get:function(){return this.lY}},rqb:{configurable:!0,enumerable:!0,get:function(){return this.pCa}},
pe:{configurable:!0,enumerable:!0,get:function(){return this.lY.pe}},items:{configurable:!0,enumerable:!0,get:function(){return this.Wp}},S6a:{configurable:!0,enumerable:!0,get:function(){return this.B8d}},activeCell:{configurable:!0,enumerable:!0,get:function(){return N.g(this.$).ha.va.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.T1d||(this.T1d=this.$.da.Aa(14))}}});tl.Object.defineProperties(a,{zof:{configurable:!0,enumerable:!0,get:function(){return a.j$d||
(a.j$d=new RegExp(String.fromCharCode(160),"g"))}}});a.j$d=null;Object(y.a)(a,"CellAutoCompleteControl",u.a,[598,595,599,3])},1377:function(y,D,b){function a(){this.rb=null;this.Hw=!1}function d(e,C){var M=Ub.call(this)||this;M.vpa=$k.a.KBh;M.WMc=!!window.PointerEvent;M.Yfe=window.hasOwnProperty("ontouchstart");M.ijb=null;M.TUa=null;M.k8=!1;M.zS=new Nj.a;M.Djb=new Nj.a;M.Jkg=new mc.a;M.Roa=null;M.flb=!1;M.w0d=!1;M.qce=!1;M.NKc=!1;M.fEc=!1;M.q0d=!1;M.hHc=!1;M.YTa=!1;M.Jib=-1;M.FPc=null;M.session=null;
M.handlers=null;M.element=null;M.curRecognizer=null;M.Ud=Fc.EventHandlerManager.instance;M.WMc?(Fd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),M.ijb=Object(xb.a)(M,M.omc,"onPointerEvent"),M.TUa=Te.a.MBh):M.Yfe?(Fd.ULS.sendTraceTag(593893140,310,50,"Using touch events"),M.ijb=Object(xb.a)(M,M.cya,"onTouchEvent"),M.TUa=Te.a.touchEvents):(Fd.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),M.ijb=Object(xb.a)(M,M.$lc,"onMouseEvent"),M.TUa=Te.a.LBh);M.vh=C;M.Kea=e;jd.AFrameworkApplication.ga&&
(M.flb=jd.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),M.w0d=jd.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),M.qce=jd.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),M.NKc=jd.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),M.fEc=jd.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),M.q0d=jd.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),M.hHc=jd.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),
M.YTa=M.flb&&jd.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&jd.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return M}function c(){}function k(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=
this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function n(e,C,M,ra,Na,Ib,Gc,id,Uc){e=oa.call(this,e,M,ra,Ib)||this;e.Xfb=C;e.Lfa=Gc;e.oX=id;e.gRj=Uc;e.Ikg=Na;return e}function l(){this.wFc=null}function f(){this.yca=this.xTe=null}function u(e){var C=pk.call(this)||this;C.$=e;C.dc();return C}function v(e,C,M,ra,Na){var Ib=Rk.call(this)||this;Ib.jO=null;Ib.R_=null;Ib.NEa=null;Ib.Wsc=null;Ib.OLc=null;Ib.uWa=null;Ib.FCc=!1;Ib.Sh=function(){Ib.Nva&&(Ib.gridView?1===Ib.gridView.ha.Te?
(Ib.gridView.ha.va.activeCell.equals(Ib.NEa)||Ib.KM||Ib.wx(),Ib.mnb.Bq()):Ib.wx():Fd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};Ib.Mj=function(){Ib.wx()};Ib.od=function(){Ib.DW()};Ib.qd=function(){Ib.wx()};Ib.Vc=function(){Ib.showCallout()};Ib.Oxa=function(){if(Ib.wi.Tk&&Ib.wi.Tk.length)if(Ib.jXc)Ib.wi.Cli||(Ib.FCc=Ib.wi.Tk[0].BlockingDataForExpand),Ib.wi.zIh&&Fd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),
Ib.showCallout();else if(Ib.gridView.ha.va.Dh){var Gc=Ib.gridView.ha.va.activeCell;if(Gc&&Ib.R_){var id=Ib.tableManager.eo(Gc);Ib.BJc=!!id;var Uc=Ib.gridView.ha.va.Qd;id=Ib.KM&&Ib.R_.Rd(id);var Vd=Ib.jgd&&!Ib.KM&&Uc.equals(Ib.selectedRange);id||Vd?(Fd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),Ib.J7b=!0,ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Ib.KM&&Ib.tableManager.NJa(Gc)?Fd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?Ib.KM?Ib.Nh.aAa(Ib.R_,Ib.KM):Ib.Nh.aAa(Uc,Ib.KM):Ib.Nh.aAa(Ib.R_,Ib.KM),Ib.Jrc())):Fd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};Ib.aj=function(){Ib.v5a()&&Ib.Nh.hide();1===Ib.gridView.ha.Te&&Ib.DW()};Ib.ZQ=function(){var Gc=Ib.gridView.ha.Te;Ib.gridView.ha.va.activeCell&&1===Gc&&Ib.DW()};Ib.Ns=function(){if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(Ib.KM){if(Ib.R_&&
Ib.NEa){var Gc=Ib.tableManager.eo(Ib.NEa);Gc&&1<Gc.bottom-Gc.top&&(--Gc.bottom,Ib.gridView.GZ(Gc)&&Ib.mnb.Bq())}}else Ib.gridView.ha.va.Dh&&Ib.gridView.GZ(Ib.gridView.ha.va.Qd)&&Ib.mnb.Bq();else Ib.R_&&Ib.NEa&&Ib.KM&&(Gc=Ib.tableManager.eo(Ib.NEa))&&1<Gc.bottom-Gc.top&&(--Gc.bottom,Ib.gridView.GZ(Gc)&&Ib.mnb.Bq())};Ib.DW=function(){if(Ib.$&&Ib.gridView){if(Ib.J7b&&Ib.KM){var Gc=Ib.gridView.ha.va.activeCell;Ib.R_=Ib.CQe();var id=!!Ib.Wsc&&Ib.Wsc.contains(Gc);if(Ib.R_&&(Gc.equals(Ib.NEa)||id)){Ib.Nh.aAa(Ib.R_,
Ib.KM);return}}Ib.J7b=!1;Ib.R_=Ib.CQe();Ib.R_&&Ib.zxa&&Ib.gridView&&Ib.gridView.Ca.Mr(Ib.zxa)?(Ib.jXc=!1,Ib.gZ()):Ib.wi.gYc();Ib.J7b||Ib.Nh.hide()}};Ib.$=e;Ib.tableManager=M;Ib.contextMenuManager=ra;Ib.Nh=new m(e,Ib.Vc,C,Na);Ib.wi=C.X1c(e,M);Ib.jXc=!1;Ib.J7b=!1;Ib.jgd=ld.EwaSettings.la(135);Ib.BJc=!0;Ib.gridView=$e.g(Ib.$);Ib.gridView.Kc.wm(Ib.Mj);Ib.gridView.Nq(Ib.ZQ);Ib.$.Rk(Ib.od);Ib.$.Vl(Ib.qd);Ib.$.Yz(Ib.aj);Ib.gridView.view.it(Ib.Ns);Ib.gridView.ha.j2(Ib.Sh);Ib.mnb=Nd.a.instance.create(Ib.DW,
250,Ud.a.CVi);Fd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");Ib.wi.JXb(Ib.Oxa);Ib.DW();e.da.Ha(261,Ib);return Ib}function m(e,C,M,ra){var Na=Bk.call(this)||this;Na.isMac=Mf.a.isMac;Na.$=e;Na.ariaLiveNotifier=ra;Na.xp=M.Z2b(e,null,C,pc.a.Xnh,rh.a.Be(9),Ae.a.instance.ea(1684),"PulloutPointerDown");return Na}function A(e){var C=cl.call(this)||this;C.b3b=null;C.$=e;C.dc();return C}function x(e){var C=dl.call(this)||this;C.$=e;return C}function t(){}function z(e,C,M,ra,Na){M=void 0===
M?null:M;ra=void 0===ra?null:ra;Na=void 0===Na?0:Na;e=G.call(this,e,C)||this;e.OMa=null;e.Zcc=M||rh.a.current.co(82);e.fif=Na;e.v3c=ra;e.Xwg();return e}function r(e,C,M,ra){e=G.call(this,e,C)||this;e.Zzb=null;e.ljg=M;e.G_h=ra;e.Ywg();return e}function G(e,C){e=Tk.call(this,e)||this;e.$zb=null;e.r2h=Math.max(1,C);return e}function w(e,C,M,ra,Na,Ib,Gc,id){id=void 0===id?"":id;var Uc=ok.call(this)||this;Uc.Eva=null;Uc.i6e=!1;Uc.Njc=null;Uc.Mjc=null;Uc.buttons={};Uc.JJe={};Uc.$=e;Uc.svgIconProvider=C;
Uc.oAi=M;Uc.Rid=ra;Uc.Qid=Na;Uc.altText=Ib;Uc.mEb=Gc;Uc.buttonText=id;return Uc}function B(e,C,M,ra,Na,Ib,Gc,id){function Uc(Ye){$h.g(Ye)}var Vd=Pj.call(this,document.createElement("div"))||this;Vd.rgf=null;Vd.OPd=!1;Vd.tRa=null;Vd.fLb=null;Vd.ZE=function(){Vd.raiseEvent("OnObjectButtonMouseOver")};Vd.HH=function(){Vd.raiseEvent("OnObjectButtonMouseOut")};Vd.quj=function(){Vd.Lhe()};Vd.Vc=function(Ye){Vd.raiseEvent(Vd.mEb,Ye);Vd.lEb();return!0};Vd.Mxa=function(Ye){100<nk.a(Wg.a.Ra,Vd.rgf)&&Vd.Ggd(new Sys.UI.Point(Math.round(Ye.clientX),
Math.round(Ye.clientY)))};Vd.dN=function(Ye){$h.g(Ye.Ea,!1);return!1};Vd.LY=Vd.Nd.ysa();Vd.set_visible(!1);Vd.wgc=Na;Vd.mEb=Ib;Vd.pkc=e;Vd.X0b=C;Vd.wgc&&(Vd.tRa=Nd.a.instance.create(Vd.quj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));e&&Vd.domElement.classList.add(e);Vd.aZa=document.createElement("div");Vd.domElement.appendChild(Vd.aZa);M&&Vd.aZa.classList.add(M);ra&&(Vd.aZa.innerHTML=ra);Gc&&(Vd.fLb=document.createElement("div"),Vd.domElement.appendChild(Vd.fLb),Vd.fLb.classList.add(id),Vd.fLb.innerText=
Gc,Vd.domElement.style.padding="3px",oj.a.instance.pa(Te.a.pointerDown,Vd.domElement,Vd.dN));Vd.TYa=new pj.a(Vd.domElement,7);Kg.a.instance.pa(Te.a.click,Vd.domElement,Vd.Vc);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&oj.a.instance.pa(Te.a.pointerDown,Vd.domElement,Vd.dN);Vd.wc.ja("mouseup",Uc);Vd.wc.ja("click",Uc);Vd.wc.ja("dblclick",Uc);return Vd}function U(){}function N(e,C,M,ra){var Na=P.call(this,e,C)||this;Na.F0a=null;Na.Gtf=function(){Na.Iqc(Na.Gtf);
if(Na.Tk&&Na.Tk.length&&Na.contextMenuManager){var Ib=Na.contextMenuManager.Qbd("autoFilterRichFieldList"),Gc=window.document.getElementById(Na.F0a);Ib.VN(null,Gc,Na,null,!0)}};Na.Sgg=M;Na.contextMenuManager=ra;return Na}function P(e,C){var M=Ai.call(this)||this;M.k1=null;M.Vtb=null;M.TGb=null;M.HKc=!1;M.FDi=function(ra,Na,Ib){Fd.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Ib);M.TGb&&M.TGb.stop();M.k1=null;M.raiseEvent("GetFieldInfoListContextOperationFailed")};
M.GDi=function(ra){yh.a(ra)||(M.TGb&&M.TGb.stop(),M.HKc=!1,M.k1=ra.Result,M.k1&&0<M.k1.length&&Fd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",M.k1.length),M.JRb=!0,M.mHf())};M.JRb=!1;M.vb=e;M.tableManager=C;return M}function ia(e){var C=Pi.call(this)||this;C.firstElement=null;C.ho=null;C.yLa=!1;C.ds=null;C.koj=Mf.a.zf||Mf.a.xA;C.Hvf=function(M){var ra=M.Ea.keyCode;return ra===Oa.a.$h?C.mCi():ra===Oa.a.hD&&M.Ea.shiftKey?C.hsh(C.firstElement):!1};C.jBf=
function(M){if(!C.yLa||M.Ea.keyCode!==Oa.a.lO)return!1;ia.I5e();wg.Task.delay(1).CWRCC(function(){C.ho.focus();return!0},C.ma);return!0};C.QMi=function(){document.activeElement&&document.activeElement.id===C.ho.id||(ia.I5e(),wg.Task.delay(1).CWRCC(function(){C.ho.focus();return!0},C.ma))};C.Ntf=function(){C.x6f(C.ho)};C.Gvf=function(M){M.stopPropagation();M.preventDefault();C.yLa&&(C.yLa=!1)};C.$=e;(e=C.$.fa.lc)&&Fd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",
e.d$,e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)");e&&(e.inWebPart||e.inEmbedView)?Fd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)"):(C.E1g(),C.D2g(),hk.KeyInputManager.instance.pa(Te.a.Rb,C.$.domElement,C.jBf));C.$.da.Ha(238,
C);return C}function W(e,C,M,ra,Na){Na=void 0===Na?null:Na;var Ib=Ak.call(this)||this;Ib.Fmb=null;Ib.hOa=null;Ib.nXc=0;Ib.dnc=null;Ib.tJi=function(){var Gc=Ib.hOa.cWe();Fd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Ib.Kka,Gc);Ib.dnc=Nd.a.instance.create(Ib.yla,Math.max(Ib.Gse-Gc,0),Ud.a.yhe)};Ib.yla=function(){Fd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",
Ib.Kka,Ib.hOa.cWe(),Ib.D4a);Ib.nXc++;Ib.nXc>Ib.Fse&&Fd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Ib.Kka);Ib.hOa.Ww.C();Ib.LQe()};Ib.Nxa=function(){Ib.D4a&&Fd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",Ib.Kka,Ib.$Ka,Ib.D4a);Ib.qkd()};Ib.Hug=e;Ib.Iug=C;Ib.documentVisibilityObserver=M;Ib.Kka=ra;Ib.aO=Na;M&&Ib.documentVisibilityObserver.imb(Ib.Nxa);
Ib.mXc=!!M&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Ib.Fse=ld.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);C=ld.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Ib.Gse=e.ptb(C);e=ld.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);Ib.fOg=Math.max(Ib.Gse-C,0)+e;return Ib}
function R(){this.startTime=Wg.a.Ra.Kb;this.Ww=new Kc.a}function I(e){var C=dk.call(this)||this;C.$=e;C.dc();return C}function Q(e,C,M,ra,Na,Ib){var Gc=this;this.$=e;this.functionInfoManager=C;this.calcManager=M;this.pluginScheduler=ra;this.formulaAssistanceUIControl=Na;this.wi=Ib;this.fRa=!0;this.wMa=null;this.vMa=-1;this.Gh=function(){$e.g(Gc.$).isEditing||$e.g(Gc.$).zi||Gc.qBb()};this.onFunctionInfoLoaded=function(){Gc.aLj();Gc.jza()};this.Fqf=function(){Gc.fRa=!1};this.Nqf=function(){var id=Gc.qb,
Uc=id.text;id=id.textBox.caretPosition;ka.instance.Y6(["argumentAssistanceComputation"]);Gc.pluginScheduler.requester().argumentAssistance({content:Uc,caretPosition:id}).then(function(Vd){0===Vd.kind&&Gc.o2e(Vd.payload)})};this.Rh=function(){Gc.fRa=!0};this.Hg=function(){Gc.pluginScheduler.notifier().setDefinedNamesInfo(Gc.n4b.dEe)};this.$=e;this.functionInfoManager=C;this.formulaAssistanceUIControl=Na;this.pluginScheduler=ra;ka.instance.$=e;this.Wbf=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");
this.Maa=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.cwd=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.Wbf&&(this.n4b=new wb(e),$e.g(this.$).Ca.np(this.Hg));this.TCa=new S(this.$,this.formulaAssistanceUIControl);this.ppa=new ca(this.$,this.formulaAssistanceUIControl);this.functionInfoManager.mmb(this.onFunctionInfoLoaded);e.da.Ha(464,this);this.calcManager=M;cg.a.bka()&&this.Sjd();this.Maa&&($e.g(this.$).rc.hq(this.Rh),
this.TCa.Vzg(this.Fqf));this.H4a=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function O(e,C){var M=this;this.wi=e;this.$=C;this.Oxa=function(){M.I7b.resolve(M.wi.Tk);M.a8f();M.ktf||($e.g(M.$).rc.hq(M.Rh),M.ktf=!0)};this.quf=function(){M.I7b.reject(null);M.a8f()};this.Rh=function(){M.wi.uab();$e.g(M.$).rc.Rp(M.Rh);M.ktf=!1}}function ba(){var e=this;this.promise=new Promise(function(C,M){e.oqg=C;e.Ypg=M})}function ca(e,C){var M=dj.call(this,ca.lJa())||
this;M.qb=null;M.Uq=null;M.KHa=!1;M.LHa=!1;M.JHa=!1;M.HHa=!1;M.IHa=!1;M.Cv=null;M.$_=0;M.Aq=null;M.visible=!1;M.bfa=!1;M.wcb=!1;M.gKb=!1;M.fKb=!1;M.WLb=jh.Dismissed;M.dismiss=function(){M.visible=!1;M.Naa&&M.Prd();M.DM&&M.qb.isEditing&&M.Hca();M.Aq=null;M.formulaAssistanceUIControl&&(M.formulaAssistanceUIControl.dismiss(M.domElement),M.Vja&&(M.Uq.canReceiveFocus=!1),M.WLb=jh.Dismissed)};M.ogd=function(){M.ALa&&M.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};M.NBi=function(){M.dismiss();$e.g(M.$).Jj.textBox.focus()};
M.tQa=function(){var ra={};ra[Je.a.N$]="FunctionSuggestions";M.$.Ce(802602464,0,8,ra)};M.Axd=function(ra,Na){M.aeb(Na);M.Naa&&(M.LHa=!0)};M.kd=function(){M.set_visible(!1)};M.zxd=function(ra){M.Naa&&(M.IHa=!0);M.f_a(ra.textEdit)};M.Yh=function(){M.dismiss()};M.Ns=function(){void 0!==M.Aq&&null!==M.Aq&&M.Aq()};M.visible=M.get_visible;M.visible=M.set_visible;M.$=e;M.formulaAssistanceUIControl=C;M.Vja=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");M.Vja&&(M.Uq=
new Sa(M.$,M.formulaAssistanceUIControl,1,Nf.a.dad,M.ogd));$e.g(M.$).view.it(M.Ns);$e.g(M.$).ha.jG(M.kd);M.$.xa.Pf(M.Yh);M.AM=cg.a.AM(M.$);M.imd=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");M.Old=M.AM&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");M.Naa=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");M.ALa=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");
M.yld=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");M.zLa=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");return M}function S(e,C){var M=Lh.call(this,S.lJa())||this;M.n2=0;M.Uq=null;M.Aq=null;M.Bka=null;M.visible=!1;M.wQ=!1;M.kd=function(){M.set_visible(!1)};M.onCardModeChange=function(ra){M.fMb(ra);1===ra?ka.instance.Fia.argumentAssistanceCollapseCounter++:ka.instance.Fia.argumentAssistanceExpandCounter++};M.tQa=function(ra){var Na=
{};Na[Je.a.N$]="ArgumentAssistanceCard";var Ib={};Ib.FunctionName=ra.functionName;Na[Je.a.k9c]=Ib;M.$.Ce(802602464,0,8,Na)};M.Ns=function(){void 0!==M.Aq&&null!==M.Aq&&M.Aq()};M.onDismissClick=function(){ka.instance.Fia.argumentAssistanceDismissCounter++;M.dismiss();M.raiseEvent("DC");M.wQ&&M.VM.clear();ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!M.n2&&M.fMb(1)};M.Rh=function(){M.wQ&&M.VM.clear()};M.$=e;M.formulaAssistanceUIControl=
C;M.Wm=cg.a.AM(e);M.Maa=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);M.lMd();M.Uq=new Sa(M.$,M.formulaAssistanceUIControl,0,Nf.a.bad);$e.g(M.$).view.it(M.Ns);$e.g(M.$).ha.jG(M.kd);M.wQ=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);M.wQ&&(M.VM=new wa(M.formulaAssistanceUIControl),$e.g(M.$).rc.hq(M.Rh));return M}function Y(e,
C,M,ra,Na,Ib,Gc,id){var Uc=si.call(this,e)||this;Uc.ccc=!1;Uc.Uq=null;Uc.KFa=null;Uc.Wg=null;Uc.rV=null;Uc.Cpd=null;Uc.b5=null;Uc.Z1a=0;Uc.$8b=0;Uc.o3=0;Uc.uGe=0;Uc.irb=0;Uc.Qcb=0;Uc.D3b=0;Uc.rvc=!1;Uc.qia=null;Uc.Jnc=null;Uc.columnName="";Uc.z4c=!1;Uc.Tte=!1;Uc.aJa=[];Uc.MP=null;Uc.BRa=[];Uc.Aq=null;Uc.Dad=null;Uc.L7=null;Uc.bfa=!1;Uc.wcb=!1;Uc.gKb=!1;Uc.fKb=!1;Uc.wMa=null;Uc.vMa=0;Uc.b_d=null;Uc.Jkd=!1;Uc.ogd=function(){Uc.ALa&&Uc.raiseEvent(Y.J$c,null)};Uc.XPe=function(){Uc.qia=!1;Uc.rV=Uc.qb.text;
Uc.Rf.NIa(Uc.Cv,Uc.rV,!0,Uc.columnName,void 0,!1);1===Uc.Rf.Kr.length&&1===Uc.Rf.XV.length?(Uc.set_visible(!1),Uc.Tte||Uc.$cc()):Uc.show()};Uc.LEi=function(Vd){if(yh.a(Vd))-315732528!==Vd.Errors[0].MessageId&&Fd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",mh.a.Uc(Vd.Errors));else if((Vd=Vd.Result)&&Vd.length){Uc.Wg.q0||(Uc.Wg.q0={},Uc.Wg.q0.HeadersList=[]);Uc.Wg.q0.IsFullTableHeaders=!0;for(var Ye=0;Ye<
Vd.length;++Ye)Uc.Wg.q0.HeadersList[Ye]={},Uc.Wg.q0.HeadersList[Ye].Index=Ye,Uc.Wg.q0.HeadersList[Ye].Name=Vd[Ye];Uc.$Df(!0);Uc.rV=Uc.l0e();Uc.Rf.NIa(Uc.Cv,Uc.rV,!0,void 0,void 0,!0);Uc.show()}else Fd.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Uc.KEi=function(Vd){Vd=Li.a.yg(Vd.data);Fd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",mh.a.Uc(Vd))};
Uc.Pwd=function(){$e.g(Uc.$).isEditing||$e.g(Uc.$).zi||Uc.qBb()};Uc.kd=function(){(ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||Uc.Wm)&&Uc.set_visible(!1)};Uc.iuf=function(){Uc.KFa=null;Uc.L7=null};Uc.Yh=function(){Uc.Wm&&Uc.q0a()};Uc.onFunctionInfoLoaded=function(){Uc.jnb()};Uc.Oxa=function(){Uc.Hja?(Uc.L7=null,Uc.KFa=null,Uc.jnb()):Uc.wi.Tk&&Uc.zpe()};Uc.Qba=function(){Uc.MP&&Nb(Uc.$,Uc.MP.HelpId,Uc.MP.IsDynamicUdf);return!0};Uc.q0a=function(){Uc.Naa&&
Uc.Prd();Uc.DM&&Uc.qb.isEditing&&Uc.Hca();Uc.Aq=null;Uc.formulaAssistanceUIControl&&(Uc.formulaAssistanceUIControl.dismiss(Uc.domElement),Uc.Vja&&(Uc.Uq.canReceiveFocus=!1));Uc.Jkd=!1};Uc.$yf=function(){Uc.DM&&Uc.Hca();Uc.e0f();1===Uc.dTf.type&&ld.EwaSettings.kgc()&&!Uc.qb.text.includes("\n")&&(Uc.mCd(Uc.dTf),Uc.gKb=!0)};Uc.onDismiss=function(){Uc.isListVisible=!1;$e.g(Uc.$).Jj.textBox.focus()};Uc.tQa=function(){var Vd={};Vd[Je.a.N$]="FunctionSuggestions";Uc.$.Ce(802602464,0,8,Vd)};Uc.Axd=function(Vd,
Ye){Uc.Rf.Q$f(Ye);Uc.Naa&&(Uc.LHa=!0)};Uc.zxd=function(Vd){Uc.Naa&&(Uc.IHa=!0);Uc.DM?(Uc.cye(),$e.g(Uc.$).Jj.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Vd.textEdit?Uc.f_a(Vd.textEdit):Uc.wy(!0)};Uc.gridView=$e.g(e);Uc.functionInfoManager=C;Uc.domElement.className=of.a.TJe;Uc.wi=Ib.X1c(e,M);Uc.n4b=new wb(e);Uc.Asg=M;Uc.formulaAssistanceUIControl=Gc;Uc.pluginScheduler=id;ka.instance.$=e;Uc.Wm=cg.a.AM(e);Y.nid||(Y.nid=Y.lJa());Uc.domElement.innerHTML=Y.nid;Uc.zwd=RegExp("\\d+");
Wj.d(Uc.style,Uc.$.isChromeRtl);Uc.Dia=new Fb(Uc.$,Uc.domElement,Uc.functionInfoManager,Uc.formulaAssistanceUIControl,Uc.pluginScheduler);C=$get(Za.Aad,Uc.domElement);M=$get(Za.vad,Uc.domElement);Ib=$get(Za.Cad,Uc.domElement);Uc.ykg=new Ya(Uc.$,C,Ib,M,Uc);Uc.wi.JXb(Uc.Oxa);Uc.functionInfoManager.mmb(Uc.onFunctionInfoLoaded);Uc.functionInfoManager.rAg(Uc.iuf);Uc.Wm&&(Uc.$.xa.Pf(Uc.Yh),Uc.Rf.Hle(Uc.$yf));Uc.QRa(!0);Uc.m3f(!0);Uc.$.domElement.appendChild(Uc.domElement);Uc.BOc=0;(M=mj.a(e))&&Array.add(Uc.aJa,
new Gb(e,M,Uc));Array.add(Uc.aJa,new Gb(e,Uc.gridView.Kc,Uc));Uc.Zsb=Uc.aJa[0];Uc.Eob=Uc.aJa[Uc.aJa.length-1];e.da.Ha(221,Uc);Uc.calcManager=ra;Uc.instantaneousSupportInformationManager=Na;Uc.instantaneousSupportInformationManager||Uc.$.da.Za(268,function(Vd){Uc.instantaneousSupportInformationManager=Vd});Uc.dPe=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Uc.hAa=cg.a.jmd();Uc.vwc=cg.a.Xdf();Uc.cwd=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
Uc.yld=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");cg.a.bka()&&Uc.Sjd();cg.a.GM(Uc.$)&&C.classList.add("ewa-fb-refactor");Uc.Wm?$e.g(Uc.$).ha.jG(Uc.kd):$e.g(Uc.$).ha.j2(Uc.kd);Uc.Vja=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");Uc.Vja&&(Uc.Uq=new Sa(Uc.$,Uc.formulaAssistanceUIControl,1,Nf.a.dad,Uc.ogd));Uc.ALa=Uc.Wm&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");Uc.zLa=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");
return Uc}function ma(){}function Z(){this.caretPosition=this.content=null}function xa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function na(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function pa(){this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function Ia(){this.X8=this._name=null}function Ma(){this._name=null}function lb(){this._name=null}function zb(){this.X8=
this._name=null}function Ya(e,C,M,ra,Na){C=Hi.call(this,e,C)||this;C.Bqa=null;C.htc=0;C.eKb=0;C.p0c=null;C.DSe=M;C.etb=ra;C.formulaAssistanceControl=Na;C.Kr=[];C.XV=[];C.Wm=cg.a.AM(e);C.Ybf=C.Wm&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return C}function Wb(){this.textEdit=this.label=null;this.kind=0;this.isPrefixed=this.detail=this.type=null}function Zb(e,C){this.$=e;this.items=C}function da(e,C){this.NTi=e;this.cof=C}function za(){}function hb(e){this.index=e}
function Gb(e,C,M){var ra=$i.call(this,e,C)||this;ra.tBf=!1;ra.jRa=null;ra.cjd=0;ra.VDc=null;ra.oHa=null;ra.NP=0;ra.formulaAssistanceControl=M;ra.tYa=C.textBox;ra.H4a=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");ra.Wm=cg.a.AM(e);ra.P2i=ld.EwaSettings.gH();return ra}function Sb(){this.pha=this.csa=this.dsa=!1;this.FBf=40;this.Zwe=41;this.PZa=this.fAd=this.gAd=this.ODb=0;this.zsf=!0;this.Ryd=!1;this.VQe=this.wKd=-1}function Fb(e,C,M,ra,Na){var Ib=pi.call(this,
Fb.lJa(cg.a.AM(e)))||this;Ib.B0a=null;Ib.n2=0;Ib.Uq=null;Ib.cVc=!1;Ib.Aq=null;Ib.Bka=null;Ib.fRa=!0;Ib.wQ=!1;Ib.onCardModeChange=function(Gc){Ib.fMb(Gc);1===Gc?ka.instance.Fia.argumentAssistanceCollapseCounter++:ka.instance.Fia.argumentAssistanceExpandCounter++};Ib.tQa=function(Gc){var id={};id[Je.a.N$]="ArgumentAssistanceCard";var Uc={};Uc.FunctionName=Gc.functionName;id[Je.a.k9c]=Uc;Ib.$.Ce(802602464,0,8,id)};Ib.onDismissClick=function(){ka.instance.Fia.argumentAssistanceDismissCounter++;Ib.fRa=
!1;Ib.Wqb();Ib.wQ&&Ib.VM.clear();ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!Ib.n2&&Ib.fMb(1)};Ib.Rh=function(){Ib.fRa=!0;Ib.wQ&&Ib.VM.clear()};Ib.fDi=function(Gc){!Gc.button&&Gc.target&&($h.g(Gc),Ib.B0a&&Ib.B0a.ona(Gc))};Ib.Ns=function(){void 0!==Ib.Aq&&null!==Ib.Aq&&Ib.Aq()};Ib.$=e;Ib.Ui=C;Ib.functionInfoManager=M;Ib.formulaAssistanceUIControl=ra;Ib.pluginScheduler=Na;Ib.Wm=cg.a.AM(e);Ib.Maa=Ib.Wm&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);Ib.Wm?(Ib.lMd(),Ib.Uq=new Sa(Ib.$,Ib.formulaAssistanceUIControl,0,Nf.a.bad),Ib.Maa&&$e.g(Ib.$).rc.hq(Ib.Rh),Ib.wQ=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!Ib.formulaAssistanceUIControl,Ib.wQ&&(Ib.VM=new wa(Ib.formulaAssistanceUIControl))):(Ib.B0a=new Tb(Ib.domElement,Ib.$.Ay,void 0,cg.a.GM(Ib.$)),Ib.wc.ja("mousedown",Ib.fDi),e=$get(Za.Aad,Ib.Ui),Ib.Ui.insertBefore(Ib.domElement,
e));$e.g(Ib.$).view.it(Ib.Ns);return Ib}function wa(e){this.Bt=!1;this.Q8b=e;this.cBc=this.Q8b.getWindowEdgeBuffer()+1}function va(){this.content=null;this.caretPosition=0}function sa(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function sb(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function Tb(e,C,M,ra){ra=void 0===ra?!1:ra;C=zh.call(this,e,C,!1,void 0===M?null:M)||this;C.SQa(ra);C.fj=K.a.equals("rtl",e.dir,!0);return C}function Da(e,C){var M=
Wh.call(this)||this;M.Dkg=[];M.Ead={};M.GSe={};M.tS=null;M.j8=[];M.hJa={};M.xuf=function(ra,Na){Fd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");M.juf(ra,!!Na&&1!==Na.FilterType,!0)};M.wuf=function(){Fd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");M.tS=null};M.guf=function(ra){Fd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
M.XEd(ra.Jia,!0,!1)};M.vuf=function(ra){Fd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");M.juf(ra,!0,!1)};M.YIc=!1;M.WIc=!1;M.vb=e;M.pluginScheduler=C;M.$.da.Ha(19,M);return M}function Sa(e,C,M,ra,Na){this.XXc=!1;this.$=e;this.formulaAssistanceUIControl=C;this.gSe=M;this.aej=ra;this.R2e=void 0===Na?null:Na}function Ra(e,C,M){var ra=Yh.call(this)||this;ra.Bad=e;ra.LKd=C;ra.VOi=M;return ra}function Lb(e){var C=Eh.call(this)||this;C.LKd=e;return C}function Ja(e,
C){var M=qh.call(this)||this;M.functionName=e;M.Bad=C;return M}function wb(e){this.eEe={};this.$=e}function Mb(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Eb(){this.wS=0;this.h6d=!1;this.SUa=this.D7d=null;this.k7d=!1;this.textEdit=null}function Ic(e){var C=this;this.pqb=this.Yga=this.calcManager=this.qb=null;this.l8a=function(){C.W3a(!1,!1)};this.$=e;this.Ysb=new Pc(e);this.O8b=new Tc(e);this.P8b=new Zc(this);$e.g(e).Kc.hq(this.l8a);this.$.da.Ha(317,this)}function Zc(e){this.j7=
0;this.cad=e}function Pc(e){this.Lpa=this.SRa=this.Z0a=this.zP=this.g$=this.qb=null;this.dhd=!1;this.Nc=e}function vd(){}function Tc(e){var C=this;this.nri=30;this.calcManager=null;this.Ld=!1;this.iOa=this.aEb=this.w9a=null;this.Nx=function(){C.$ga.tZ()};this.$=e;this.$ga=new eb;this.WOf=-1;this.$.fa.ED(this.Nx)}function rb(e,C,M,ra,Na,Ib,Gc){Gc=e.Oa(1,void 0===Gc?null:Gc);Gc.getPartialCalcResultsParameters=C;return vf.i(e,"GetPartialCalcResults",Gc,M,ra,Na,Ib,4)}function eb(){this.RPa={}}function Ta(e){var C=
bc.call(this)||this;C.$=e;C.dc();return C}function fb(e,C){var M=this;this.gJa=this.dua=this.Eia=null;this.Pxf=function(ra,Na){M.YYi(Na.functionName,Na.Bad)};this.Rxf=function(ra,Na){M.XYi(Na.Bad,Na.LKd,Na.VOi)};this.Qxf=function(ra,Na){ra=[];Na=yl(Na.LKd);for(var Ib=Na.next();!Ib.done;Ib=Na.next())Ib=Ib.value,(!M.G4a||void 0!==Ib&&null!==Ib)&&(Ib=Ib.trim())&&Array.add(ra,Ib);if(!M.G4a||ra.length){Na="";for(Ib=0;Ib<ra.length;Ib++){var Gc=M.dXc(ra[Ib]),id=fb.DBd(Ib,ra.length);Na+=Gc+id;id&&(Na+=M.ariaLiveNotifier.Zwa)}M.ariaLiveNotifier.readText(Na)}};
this.Sxf=function(ra,Na){M.ariaLiveNotifier.$Yi(Na.XH,Na.description,Na.selectedIndex.toString(),Na.length.toString(),M.zLa)};this.Lxf=function(ra,Na){M.ariaLiveNotifier.GIf(Na.description,Na.length)};this.cuf=function(){M.ariaLiveNotifier.r$a(Ae.a.instance.ea(862),Je.a.FFa)};this.Wtf=function(){M.ariaLiveNotifier.readText(Ae.a.instance.ea(863))};this.Ztf=function(){M.ariaLiveNotifier.readText(Ae.a.instance.ea(864))};this.$=C;this.ariaLiveNotifier=e;this.$.da.Ha(219,this);this.G4a=cg.a.AM(C);this.ALa=
cg.a.AM(C)&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");this.zLa=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout")}function pb(e){return ib.call(this,e)||this}function rc(e,C,M){var ra=this;this.lzh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){ra.menuId&&Array.contains(ra.lzh,
ra.menuId)&&ra.frame.Aw(ra.menuId)};this.$=e;this.functionInfoManager=M;this.Sa=C;this.LL={};this.frame=this.$.frame;this.functionInfoManager.mmb(this.onFunctionInfoLoaded)}function vb(e,C){var M=ua.call(this,e,Ae.a.instance.ea(1E3),void 0,void 0,void 0,ld.EwaSettings.la(406))||this;M.fJa=null;M.Iia=null;M.eJa=null;M.gtb=null;M.ASe=null;M.Hia=null;M.BSe=null;M.ESe=null;M.hif=null;M.ftb=null;M.nhd=!1;M.f0b=null;M.u5=null;M.Ovb=null;M.onFunctionInfoLoaded=function(){if(!M.eJa.count){for(var ra=M.functionInfoManager.vSe,
Na=0,Ib=ra.length;Na<Ib;++Na)M.eJa.AL(ra[Na],ra[Na],!1).className=bk.a.Ejh;M.eJa.selectedIndex=0;jf.a.pc([M.f0b,M.u5,M.Ovb]);M.f0b=M.Nd.Cd(M.fJa);M.u5=M.Nd.Cd(M.Iia);M.Ovb=M.Nd.Cd(M.ftb);M.f0b.ja("change",M.huf);M.u5.ja("change",M.gDi);M.u5.ja("dblclick",M.hDi);M.Ovb.ja("click",M.Qba);M.Ovb.ja("keyup",M.eFi);Le.DOMElementExtensions.setVisible(M.Iia,!0);Le.DOMElementExtensions.setVisible(M.ASe,!1);M.$.M3c&&Le.DOMElementExtensions.setVisible(M.hif,!0)}M.huf(null);M.getButton(0).get_element().disabled=
!1;M.fJa.disabled=!1;M.AIb();M.nhd=!0};M.Qba=function(){M.n$&&Nb(M.$,M.n$.HelpId,M.n$.IsDynamicUdf)};M.eFi=function(ra){13!==ra.keyCode&&32!==ra.keyCode||M.Qba(ra)};M.huf=function(){var ra=M.functionInfoManager.RWe(M.eJa.pe.value);M.kua(ra);M.Iia.scrollTop=0;M.VUf()};M.gDi=function(){M.VUf()};M.hDi=function(ra){M.n$&&($h.g(ra),M.close(0))};M.Zc=function(ra,Na){Sg.b(Na)&&M.ou()};M.functionInfoManager=e.da.Aa(19);M.formulaAssistanceControl=e.da.Aa(221);M.cIa=C;M.BYc=C.textBox.caretPosition;return M}
function E(e){var C=Mi.a.Fba,M=e.da.Aa(368);M&&!$e.g(e).xj&&(C=M.zoom);return C}function Nb(e,C,M){if(e)if(ka.instance.Fia.argumentAssistanceLearnMoreCounter++,M){if(C&&(!C||C.startsWith("http://")||C.startsWith("https://"))){if(e.la(156)&&(e=e.da.Aa(269))&&e.PAa(C))return;ab.HelperMethods.sf(C,"_blank",V.a)}}else{M=new Rg.a(-859308420,pg.a.Wb,e.ed,0,null);var ra={};C=(ra[pg.a.hd]=Je.a.WU,ra[pg.a.Kg]="HelpID="+C,ra);e.Ka.Zb(M,C)}}function ka(){var e=this;this.Fia=new ec;this.T8b=new Yb;this.p2=new $a;
this.Anb=new jb;this.vb=null;this.Ftc=new Ua;this.qd=function(){e.plj();e.vb.sendBeaconTraceTag(88392384,50,!1,"{0}",e.getJsonForLogging())};this.x9a=new Nj.a}function bb(e){var C=this;this.Gmf=e;this.r_=new Ga;this.M5b=[];this.rjc=-1;(this.Fmf=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&e&&(this.r_.countAboveThresholds={},e.forEach(function(M){return C.r_.countAboveThresholds[M]=0}))}function Ha(){this.P95=this.P75=this.median=this.max=this.average=0}
function Ga(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=null}function Ua(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=this.argumentAssistanceFlight=null}function jb(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function $a(){this.commitByMouseClickCounter=this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=
0}function Yb(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=0}function ec(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceDismissCounter=this.argumentAssistanceLearnMoreCounter=this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function Za(){}function Wa(e){var C=yk.call(this)||this;C.$=e;C.dc();return C}function Ca(e){var C=Ik.call(this,document.createElement("div"))||this;C.KQ=!1;C.pQ=!1;
C.u_b=!1;C.Eh=null;C.Oh=null;C.x$h=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConditionalHideAll",!1);C.y$h=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConstButtonWidth",!1);C.mci=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5862418_LogDataValidationButtonWidth");C.hhi=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VisibilityOptimizationOnTaggedElements",!1);C.Pmd=!1;C.Lnd=!1;C.Skd=!1;C.Z3b=[];C.Gh=function(){C.l_f(!1)};
C.VNa=function(ra,Na){C.show(C.BQ,!C.isListVisible,!0,Mf.a.Pr||3===Na.zb||3===pg.a.Wb);C.Fxd(null,null)};C.Fxd=function(){C.gridView.setFocus()};C.JKa=function(){C.qb.textBox.QJ=!0};C.Ns=function(){C.w$f()};C.onContentReady=function(){C.l_f(C.isListVisible)};C.qd=function(){C.wx()};C.Zxa=function(){C.CQa()};C.htf=function(){C.w$f()};C.$=e;C.gridView=$e.g(C.$);C.yI=C.gridView.Kc;var M="<div id='dv_reader_description' class='"+fk.a.NKe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+
Aa.Ujh+" "+pc.a.yu+"'></div>\r\n<div id='dv_list_box' class='"+Aa.$ih+" "+pc.a.Ir+" "+pc.a.yu+"'></div>\r\n<div id='dv_prompt_box' class='"+Aa.Sjh+" "+pc.a.yu+"'></div>";C.domElement.className=Aa.Tjh;C.domElement.innerHTML=M;Wj.d(C.style,C.isGridRtl);C.dg=$get("dv_list_box",C.domElement);C.ZV=$get("dv_prompt_box",C.domElement);C.Vga=$get("dv_list_button",C.domElement);C.T6a=$get("dv_reader_description",C.domElement);C.hhi&&(C.domElement.setAttribute(Gg.a.CYa,"true"),C.dg.setAttribute(Gg.a.CYa,"true"),
C.ZV.setAttribute(Gg.a.CYa,"true"),C.Vga.setAttribute(Gg.a.CYa,"true"),C.T6a.setAttribute(Gg.a.CYa,"true"));(M=mj.a(e))&&Array.add(C.Z3b,new Jb(e,M,C));Array.add(C.Z3b,new Jb(e,C.gridView.Kc,C));C.gridView.ha.fG(C.Gh);C.gridView.Nq(C.onContentReady);C.gridView.rc.Zzg(C.htf);C.$.Vl(C.qd);M=C.gridView.Ui;M.insertBefore(C.domElement,M.firstChild);C.onContentReady(null,null);e.da.Ha(14,C);return C}function db(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd){var Ye=Gk.call(this,document.createElement("a"))||this;Ye.pl=!1;
Ye.Vc=function(Gf){Ye.raiseEvent("ClickButton",Gf);return!0};Ye.onKeyDown=function(Gf){Ye.raiseEvent("KeyDown",Gf);return!1};Ye.hw=function(){Ye.hovered=!0;Ye.raiseEvent("PointerOver");return!1};Ye.kN=function(){Ye.hovered=!1;Ye.raiseEvent("PointerOut");return!1};Ye.onBlur=function(Gf){$h.g(Gf);Ye.focused=!1;Ye.raiseEvent("Blur")};Ye.onFocus=function(Gf){$h.g(Gf);Ye.focused=!0;Ye.raiseEvent("Focus")};Ye.dgh=id;Ye.Oah=Uc;Ye.EI=db.yb(Ye.domElement,C,M,ra,Na,Ib,Gc,Vd);Ye.wc.ja("contextmenu",function(Gf){$h.g(Gf)});
Ye.enable();Ye.hovered=!1;Ye.focused=!1;e.appendChild(Ye.domElement);return Ye}function $b(e,C,M){e=ak.call(this,e,C,new xk.a(Aa.listItem,Aa.Qzb,Aa.Tzb,Aa.Uzb))||this;e.rkb=null;e.pe=null;e.bda=null;e.wV=null;e.tHa=null;e.Swa=0;e.DDb=[];e.M9f=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateDvListHeightUsingItemHeight",!1);e.Dmi=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858877_logDvListBoxHeight");e.T6a=M;return e}function Jb(e,C,M){e=Gj.call(this,e,C)||this;e.dataValidationControl=
M;return e}function Hc(e,C,M){var ra=wk.call(this,e)||this;ra.s$=null;ra.rU=null;ra.idf=!1;ra.errorMessage=null;ra.g5e=null;ra.xm=null;ra.zda=null;ra.lDe=function(Na){var Ib=ra.$,Gc=ra.idf;ra.hide();var id=$e.g(Ib);id.isEditing&&id.Kc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Na&&Gc&&xf.TaskExtensions.Ba(id.startEdit(!1,1),function(){var Vd=id.Kc.textBox;Vd.text&&Vd.selectRange(0,Vd.text.length)},ra.ma,11,Se.a.current);if(1===Na&&!Gc){if(Gc=id.sc(null)){id.Ca.fV();
var Uc=Object.assign(new Jh.a,{Text:ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?Gc.cell.userInput:Gc.originalText});id.setCell(Uc,Gc.range,0,63,null)}Ib.Ce(-798660877,pg.a.Wb,8,null)}2===Na&&xf.TaskExtensions.Ba(id.startEdit(!1,0),function(){var Vd=id.Kc.textBox;Vd.text&&Vd.selectRange(0,Vd.text.length)},ra.ma,11,Se.a.current)};ra.n8a=function(){ab.HelperMethods.Xba(ra.$.pI,ra.error.HelpTopicId,ra.$.$W)};ra.XEi=function(){ra.Yvb();ra.$.Ce(802602464,
2,8,ra.rU)};ra.yDi=function(){Fd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};ra.zDi=function(Na){!Na||yh.a(Na)?Fd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Na=ra.AQh(Na.Result),ra.s$.errorInformation=Na,ra.Dzc(ra.oIa,ra.Eed(ra.lDe),ra.s$))};ra.Uxd=function(){ra.show(ra.lQb)};ra.xJe=M;ra.sqmManager=
Ok.a(ra.$);ra.error=Hc.iQ(C,e,M);ra.Ab.Ap=ra;e=e.da.Aa(14);ra.su=e.v2a(ra.xJe);ra.oIa=ra.su&&ra.su.oIa?ra.su.oIa:Ae.a.instance.ea(1680);ra.Whj();ra.initializeAndShow(ra.oIa,ra.lDe,ra.s$);return ra}function uc(e,C,M){var ra=gk.call(this,e,uc.iQ(C,e,M))||this;ra.kd=function(){ra.setFocus()};$e.g(ra.$).ha.jG(ra.kd);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&(e=e.da.Aa(14).v2a(M))&&e.options&1&&Fd.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");
return ra}function Aa(){}function mb(e){var C=vk.call(this)||this;C.$=e;C.dc();return C}function dc(e,C){var M=this;this.zYa=null;this.Mxf=function(ra,Na){1<Na.length&&(ra=Ae.a.instance.ea(837),M.ariaLiveNotifier.GIf(ra,Na.length))};this.Nxf=function(ra,Na){Fd.ULS.shipAssertTag(537167961,0,0<=Na.selectedIndex&&0<=Na.length&&Na.selectedIndex<Na.length,"Invalid ListEventArgs: SelectedIndex/Length");Fd.ULS.shipAssertTag(537167960,0,!!Na.XH,"ListEventArgs: SelectedValue should not be null");M.ariaLiveNotifier.ZYi(Na.XH,
Na.selectedIndex+1,Na.length)};this.Oxf=function(ra,Na){M.ariaLiveNotifier.ePa(Na.XH)};this.ariaLiveNotifier=e;C.Ha(213,this)}function Ac(e){var C=Ek.call(this)||this;C.$=e;C.dc();return C}function bd(e){var C=Jj.call(this)||this;C.$=e;C.dc();return C}function Kd(e,C){var M=this;this.xMa=1;this.aga=[];this.active=!1;this.iw=function(){var ra=M.gridView.Afd();if(!(0>=ra||ra===M.xMa||M.gridView.Cq)){for(var Na=!1,Ib=[],Gc=[],id=M.aga.length-1;0<=id;id--){var Uc=M.aga[id];if(M.zfd(Uc)>ra||Uc.bottom<
ra)Array.add(Ib,Uc),Array.removeAt(M.aga,id),Na=!0}for(id=M.tableManager.rangeList.length-1;0<=id;id--){Uc=M.tableManager.rangeList[id];var Vd=M.zfd(Uc);Vd<=ra&&Uc.bottom>=ra&&!(Vd<=M.xMa&&Uc.bottom>=M.xMa)&&Uc.mva&&(Array.add(Gc,Uc),Na=!0)}if(Na)for(Uc=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?M.gridView.ync:[M.gridView.J2],id=yl(Uc),Uc=id.next();!Uc.done;Uc=id.next())for(Vd=yl(Uc.value),Uc=Vd.next();!Uc.done;Uc=Vd.next()){var Ye=yl(Uc.value);
for(Uc=Ye.next();!Uc.done;Uc=Ye.next()){for(var Gf=Uc.value,rg=Gf.No,Dg=uk.a(Gf.p4),Eg=Ib.length-1;0<=Eg;Eg--)Uc=Ib[Eg],M.nyc(Uc,!1,Dg,rg)&&Array.removeAt(Ib,Eg);for(Eg=Gc.length-1;0<=Eg;Eg--)Uc=Gc[Eg],M.nyc(Uc,!0,Dg,rg)&&Array.add(M.aga,Uc);Na&&Gf.kMd(Dg)}}else Fd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");M.xMa=ra}};this.Yuf=function(ra,Na){Na.isRow||Na.STc(M.rKa)};this.Zuf=function(ra,Na){Na.isRow||(M.tableManager.rangeList.length||
M.deactivate(),Na.qHd(M.rKa))};this.rKa=function(ra,Na){if(M.te())M.activate();else if(ra=M.active,M.deactivate(),!ra){Fd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(Na=Na.VU)&&M.l1f(Na.No[0],Na.No[Na.No.length-1],Na.p4,Na.No)};this.Gxf=function(ra,Na){!M.gridView.Cq&&(M.te()?M.activate():(ra=M.active,M.deactivate(),ra||Fd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),
Na=Na.VU)&&(ra=uk.a(Na.p4),M.l1f(Na.No[0],Na.No[Na.No.length-1],ra,Na.No)&&Na.kMd(ra))};this.Oe=function(){M.gridView.$a.m4?M.deactivate():M.activate()};this.tableManager=e;this.gridView=C;this.$=C.$;e.wle(this.Gxf);C.xAg(this.Yuf);C.yAg(this.Zuf);this.$.xa.Pf(this.Oe);this.$.xb.Pf(this.Oe);this.Poe(function(ra){ra.STc(M.rKa)});this.te()&&(this.activate(),this.iw(this,null));this.$.da.Ha(68,this)}function Yd(e){return Qk.call(this,e)||this}function qd(e,C,M,ra,Na,Ib){var Gc=this;this.LD=null;this.hZa=
1461300262;this.zB=this.dZa=this.t7a=this.N8b=null;this.FFi=function(id,Uc){if(!yh.a(id)&&Uc){var Vd=!!id&&!!id.RequestTelemetryData;$e.g(Gc.$).Ji.Pka(Uc,id.StateId,Vd?id.RequestTelemetryData.EcsOperationDuration:0,Vd?id.RequestTelemetryData.EcsRequestDuration:0,Vd?id.RequestTelemetryData.WfeRequestDuration:0)}};this.Yob=function(){if(Gc.gridView.c5a){var id=Gc.$.da.Aa(254,!0);id&&id.B5i(Gc.Yob);Gc.gridView.c5a=!1;Gc.gridView.Bh.Rt(Je.a.saa);Gc.gridView.ha.K_(Gc.$$c);$e.g(Gc.$).$.Gf()}};this.$$c=
function(){var id=Gc.N8b;Gc.N8b=eh.d(Gc.$.xa.oa);if(id===Gc.N8b)if(Gc.gridView.ha.K_(Gc.$$c),(id=Gc.$.da.Aa(254,!0))&&id.WXc(36,$e.g(Gc.$).ha.va.selectedRanges)){id=new Rg.a(1804571062,2,2,0,null);var Uc={};Gc.$.Ka.Zb(id,(Uc[Je.a.skipClipboardAccess]=!0,Uc[Je.a.BZc]=!0,Uc[Je.a.isFormatPainter]=!0,Uc)).continueWith(function(){Gc.Yob()})}else Gc.gridView.Bh.qG(!1)};this.$=e;this.gridView=C;this.hi=M;this.UA=ra;this.borderFormatManager=Na;this.moreColorsHelper=Ib;this.Jxh=new ze(this.$);this.zg=ld.EwaSettings.zg();
this.Ajc=new Ie(this.$,M);this.qH=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}function Ie(e,C){this.$=e;this.hi=C;this.fY=new Xd($e.g(this.$).Ca,this.$);this.Mcf=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.lxb=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Umd=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.tfc=
ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand")}function cc(){this.scenario=0;this.RIa=null}function Qd(){this.XPa=this.RFa=this.FMa=this.pSa=0}function Wd(e,C,M,ra){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=e;this.targetSheetRange=C;this.fillRangeType=M;this.fillRangeDirection=ra}function ee(e,C,M){var ra=Sj.call(this,e)||this;ra.Wn=null;ra.V4c=0;ra.h6h=function(Na,Ib){if(Na){Na=
{};var Gc="",id=1035996630;switch(Ib.selectedKey){case 0:Gc=1896159024===ra.$o?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Gc=1896159024===ra.$o?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===ra.$o?(Gc="InsertRows",id=-1113896058):(Gc="DeleteRows",id=1554436520);break;case 3:1896159024===ra.$o?(Gc="InsertColumns",id=1415868706):(Gc="DeleteColumns",id=674605324)}Fd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",
Gc);Ib=new Rg.a(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5933270_RespectProtectionSettingsInInsertDeleteDialog")?id:1035996630,1,2,8,null);Na[pg.a.hd]=Gc;ra.$.Ka.Zb(Ib,Na)}else Fd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel")};ra.$o=C;ra.selectedRanges=M;e=Object(qc.a)(hi.a,ra.$.xa.oa);ra.isRtl=e.displayRtl;return ra}function ne(e,C,M,ra,Na,Ib){var Gc=this;this.uYd=!1;this.vYd=null;this.GBc=0;this.ej=null;this._state=0;this.moveNext=
function(){try{for(Gc._state=1;1===Gc._state;)Gc.hu=Gc.hu()}catch(id){Gc.dispose(),Gc._state=3}};this.wf=e;this.EBa=C;this.DBa=this.iYd=Na;this.BNb=Ib;this.hu=this.fL;this.moveNext()}function Bd(e,C,M,ra,Na,Ib,Gc,id){var Uc=this;this.DBc=0;this.xYd=this.HBc=!1;this.ej=this.zYd=null;this._state=0;this.moveNext=function(){try{for(Uc._state=1;1===Uc._state;)Uc.hu=Uc.hu()}catch(Vd){Uc.dispose(),Uc._state=3}};this.wf=e;this.EBa=C;this.$cg=Na;this.DBa=this.iYd=Ib;this.BNb=Gc;this.hYd=id;this.hu=this.fL;
this.moveNext()}function Pd(e,C,M,ra){this.wkg=e;this.xkg=C;this.msg=M;this.hVb=ra}function ze(e){var C=this;this.oIi=function(M){C.Bcf=!0;C.NOg=null;C.$.rE(function(ra){ra.IOa("FontName_New")});Fd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",M))};this.$=e;this.l9h=!!String.fromCodePoint&&!Mf.a.Af&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Bcf=!1;this.NOg=null}function Jf(e){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=
e}function oc(e){var C=De.call(this)||this;C.$=e;C.dc();return C}function hd(e){return Yc.call(this,e)||this}function wc(e,C){var M=this;this.W8b=this.iDd=null;this.duf=function(){ld.EwaSettings.la(691)||M.Mrc();if(M.W8b){var ra=Fa.a(Wg.a.Ra.se,M.W8b);Fd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",ra);M.W8b=null}M.JBf()};this.$=e;this.gridView=$e.g(e);this.RE=C.B_a(this.$.domElement,500,
null,null);this.hKa=this.gKa=-1}function gb(e){this.freezeOptions=null;this.freezeOptions=e}function kd(){}function Lc(e){var C=Ij.call(this)||this;C.idj="formulaAssistance";C.$=e;C.dc();return C}function Cb(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Bb(e){var C=Hh.call(this)||this;C.$=e;C.dc();return C}function Hb(e){var C=this;this.fY=this.calcManager=this.Al=this.wRa=null;this.$Ci=function(M,ra){if(M&&!yh.a(M)&&ra){var Na=!!M&&!!M.RequestTelemetryData;$e.g(C.$).Ji.Pka(ra.toString(),
M.StateId,Na?M.RequestTelemetryData.EcsOperationDuration:0,Na?M.RequestTelemetryData.EcsRequestDuration:0,Na?M.RequestTelemetryData.WfeRequestDuration:0)}};this.$=e;this.$.da.Za(268,function(M){C.Al=M});this.Vxh=new ce($e.g(this.$).Ca,this.$);this.w2=new je(this.$,$e.g(this.$),this);this.$.da.Za(266,function(M){C.calcManager=M});this.eec=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CSEPlainTextOptimization",!1);this.zg=ld.EwaSettings.Uld();this.Cod=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5841057_SimplifyFormattedTextForPlainText_2")}
function Pb(e,C){this.success=e;this.mM=C}function ed(){this.rbg=this.TOj=!1;this.source=0;this.UKa=this.Zfc=!1}function Xc(e,C,M,ra,Na){M=void 0===M?null:M;ra=void 0===ra?null:ra;Na=void 0===Na?null:Na;Fd.ULS.shipAssertTag(537162128,0,!!(!!(null!=M^!(void 0===ra||null===ra))^!(void 0===Na||null===Na))&&!(null!=M&&void 0!==ra&&null!==ra&&void 0!==Na&&null!==Na),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=M&&0>M&&(Fd.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),
M=null);this.Al=e;this.Np=C;this.vkg=M;this.W7a=ra;this.$pa=Na}function ce(e,C){this.fY=null;this.Ca=e;this.r1a=C}function Xd(e,C){this.Ca=e;this.r1a=C}function nd(e,C,M){this.success=e;this.Akc=void 0===C?null:C;this.reason=void 0===M?"":M}function je(e,C,M){var ra=this;this.wca=[];this.calcManager=this.nxc=this.lastSetCellInstantaneousOperation=null;this.$=e;this.grid=C;this.hi=M;this.qca=je.TDe;this.$.da.Za(268,function(Na){ra.nxc=Na});this.$.da.Za(266,function(Na){ra.calcManager=Na})}function Xe(e,
C,M,ra){this.rangeDelta=e;this.stateId=C;this.isFinished=M;this.priorityGroup=ra}function Ne(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd,Ye,Gf,rg,Dg,Eg,Ch,kj,Lj,Rj,Jk,Sk,al,fl,gl,bl){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=
this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;
this.totalNumberOfCellsInBatch=void 0===e?0:e;this.numberOfNonUpdatedCells=void 0===C?0:C;this.numberOfUpdatedCells=void 0===M?0:M;this.numberOfCellsUpdatedAlreadyByServer=void 0===ra?0:ra;this.numberOfCellsSkippedDueToTimeout=void 0===Na?0:Na;this.numberOfCellsWithNoFormattedCell=void 0===Ib?0:Ib;this.numberOfUnsupportedErrorCellTypes=void 0===Gc?0:Gc;this.numberOfUnsupportedBlankCellTypes=void 0===id?0:id;this.numberOfUnsupportedRichCellTypes=void 0===Uc?0:Uc;this.numberOfSkippedCellsDueToMissingLocaleInfo=
void 0===Vd?0:Vd;this.totalExecutionTime=void 0===Ye?0:Ye;this.originalProcessingTimeLimit=void 0===Gf?0:Gf;this.newProcessingTimeLimit=void 0===rg?0:rg;this.numberOfEditedRecalcedCellsInBatch=void 0===Dg?0:Dg;this.numberOfDependentRecalcedCellsInBatch=void 0===Eg?0:Eg;this.isNewTask=void 0===Ch?!1:Ch;this.lastSetCellInstantaneousOperation=void 0===kj?"":kj;this.taskId=void 0===Lj?0:Lj;this.isNewNumberFormatter=void 0===Rj?null:Rj;this.numberOfRecalcedCellsWithFormattedValue=void 0===Jk?null:Jk;this.numberOfRecalcedCellsWithoutFormattedValue=
void 0===Sk?null:Sk;this.totalNumberFormatterTime=void 0===al?null:al;this.newNumberFormatterFinalizeFailures=void 0===fl?null:fl;this.numberOfMeasureTextWidthCalls=void 0===gl?null:gl;this.numberOfHashFormattedValues=void 0===bl?null:bl}function Ig(){}function Lf(e,C,M,ra,Na){this.HT=void 0===e?0:e;this.cellValue=void 0===C?"":C;this.ifmt=void 0===M?0:M;this.priorityGroup=void 0===ra?"":ra;this.mM=void 0===Na?"":Na}function Hf(e){if(e.priorityGroup===Sc.editCell)return 0;if(e.priorityGroup===Sc.dependentCell)return 1;
Fd.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function ag(e,C){var M=Hf(C),ra=!(void 0===C.rangeDelta.data.format||null===C.rangeDelta.data.format);Fd.ULS.shipAssertTag(537162187,0,!M||!ra,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",C.priorityGroup);e=Math.max(e.cell.Gm,0);ra&&(ra=excelOnlineCalc.calc.getCellFormatKind(C.rangeDelta.data.format.format),"number"===ra?e=C.rangeDelta.data.format.format:
"string"===ra?Fd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ra?Fd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Fd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return e}function Bg(e){var C=e.value;switch(e.type){case 2:return void 0===C||null===C?"":C;case 1:return e=parseFloat(C),isNaN(e)?null:e;case 3:return e=
parseFloat(C),isNaN(e)?null:1===e;case 4:return e=parseFloat(C),isNaN(e)?null:excelOnlineCalc.calc.errorValue(e);default:return excelOnlineCalc.calc.blankValue}}function uf(e){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);var C=0;switch(e){case "number":C=1;break;case "string":C=2;break;case "boolean":C=3;break;case "Error":C=4;break;case "Blank":C=0;break;default:Fd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",e)}return C}
function sf(e,C){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);switch(e){case "number":case "string":case "boolean":return!0;case "Blank":if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;C.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;C.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return C.numberOfUnsupportedRichCellTypes++,
!1;default:return Fd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",e),!1}}function xg(e){if(e=e.color){if("String"===Object.getType(e).getName())return Aj.a.Gp(e);if("Number"===Object.getType(e).getName())return null}else return null;Fd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function sc(e){switch(e.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return Fd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Sc(){}function Qc(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd,Ye,Gf,rg){Gf=void 0===Gf?null:Gf;rg=void 0===rg?null:rg;id=vj.call(this,11,0,id,Ye)||this;id.Uxh=e;id.Z$c=C;id.format=ra;id.activeCell=M;id.Koe=Na;id.ADf=Ib;id.vDf=Gc;id.DEa=Uc;id.clientCorrelationId=Vd;id.Nkb=Gf;id.chb=rg;return id}function ie(){}function ue(e){var C=gj.call(this)||
this;C.MQb=null;C.$=e;C.dc();return C}function Ce(e){var C=ej.call(this)||this;C.iFf=0;C.AG=null;C.oVg=function(M,ra){if(1===M&&C.AG.FileCollectionErrorStateId){M=C.$.qa.ta;var Na=C.AG.MessageId,Ib=C.AG.OriginalEcsServerId,Gc=C.AG.FileCollectionErrorStateId,id=M.Oa(0);id.errorMessageId=Na;id.ecsServerId=Ib;id.fileCollectionErrorStateId=Gc;id.userComment=ra;M.PXc("CollectFile",id,null,null,null,null,0)}C.raiseEvent("fileCollectionComplete",null,C)};C.$=e;return C}function Be(e){var C=wi.call(this,
!1,!1,Be.gy)||this;C.dtd=!1;C.Wkf=!0;C.kkf=0;C.kc=1;C.Cc(1,CommonUIStrings.l_Send);C.Cc(0,CommonUIStrings.l_NoThanks);C.xf=le.Ceg;C.ekf=e;C.Me=Be.pOg;return C}function le(){}function hc(e){return Gh.call(this,e)||this}function gd(){}function xd(e,C,M,ra){var Na=lj.call(this,e)||this;Na.$Ab=null;Na.Cjc=null;Na.xdc=null;Na.R2=null;Na.Xja=!1;Na.disposed=!1;Na.lMa=!1;Na.dh=null;Na.Exd=function(Ib){Fd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Na.disposed)Fd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(yh.a(Ib)){Fd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Ib?mh.a.Uc(Ib.Errors):null);if(Ib.Errors&&1===Ib.Errors.length){var Gc=Ib.Errors[0].MessageId,id=Na.acd(Gc);if(id){Na.Pqj(Gc)?Na.emj(id):Na.St(id);Na.Hka("OkInvalidByServer",
Ib.Errors[0].MessageIdName);return}}Fd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",mh.a.Uc(Ib.Errors))}Na.Hka("OkValid","None");Na.hide()}};Na.N3c=function(Ib){Na.nW(Ib);2!==Ib&&(Na.dh=Na.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Ib?Na.G8a():2===Ib?Na.Lxa():Na.jla()};Na.Sba=function(){Na.CIj();Na.lMa?Na.uwe():Na.M0b();return Na.Xja=!1};Na.selectedRanges=C;Na.kQb=M;Na.command=
ra;3===ra&&(Na.Xja=!0);Na.kc=2;Na.gu=!1;Na.xf=Rc.xf;return Na}function re(e,C){this.options=this.cellRange=null;this.cellRange=e;this.options=C}function Jc(e,C){var M=Zj.call(this,e)||this;M.m9=null;M.Nga=null;M.iTa=null;M.o9=null;M.n9=null;M.Hlc=function(){M.m9.checked?(M.Nga.disabled=!1,M.iTa.disabled=!1,M.o9.disabled=!1,M.n9.disabled=!1):(M.Nga.disabled=!0,M.iTa.disabled=!0,M.o9.disabled=!0,M.n9.disabled=!0);return!1};M.get_visible=M.oja;M.set_visible=M.Uma;M.xk=C;M.Kja();return M}function Bc(e,
C){var M=ti.call(this,e)||this;M.Eaa=null;M.q8e=null;M.Gaa=null;M.Faa=null;M.Ilc=function(){M.Eaa.checked?(M.Gaa.disabled=!1,M.Faa.disabled=!1):(M.Gaa.disabled=!0,M.Faa.disabled=!0);return!1};M.get_visible=M.oja;M.set_visible=M.Uma;M.xk=C;M.Kja();return M}function ye(){}function cb(e,C,M,ra){var Na=zj.call(this,e)||this;Na.Bsb=null;Na.yKd=null;Na.Xja=!1;Na.disposed=!1;Na.lMa=!1;Na.dh=null;Na.lNj=function(Ib,Gc){Na.k$b(Ib);var id=Na.KWd();Ib=id.errorString;var Uc=id.lq;if(id.returnValue)return Na.C4a(121,
Na.MGh(Na.$,Gc),0,Na.Vaa,!1),"";Na.Hka("OkInvalidByClient",Uc);return Ib};Na.N3c=function(Ib){Na.nW(Ib);Na.dh=Na.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogTryClose");Ib||Na.jla()};Na.selectedRanges=C;Na.kQb=M;Na.command=ra;3===ra&&(Na.Xja=!0);Na.kc=2;Na.gu=!1;return Na}function nc(e,C,M,ra,Na,Ib,Gc,id){id=e.Oa(9,void 0===id?null:id);id.selectedRanges=C;id.ruleOptions=M;return vf.i(e,"CreateOrEditDataValidation",id,ra,Na,Ib,Gc,0)}function Nc(e,C,M){var ra=Ph.call(this,C)||this;ra.Ava=null;
ra.adc=null;ra.mT=null;ra.qK=null;ra.gya=null;ra.hya=null;ra.p4a=null;ra.KMa=null;ra.c9a=null;ra.oOa=null;ra.gnc=null;ra.bAd=null;ra.lwh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];ra.Rdj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];ra.Glc=function(Na){var Ib=!1;(null===Na||void 0===Na?0:Na.Ea)&&(Na.Ea.keyCode===Oa.a.iBa||Na.Ea.keyCode===Oa.a.$h)&&(Ib=ra.Sba(Na),ra.mT.blur(),
ra.qK.blur());return Ib};ra.Sba=function(){var Na=ra.mT.selectedIndex,Ib=ra.qK.selectedIndex;ra.gnc.innerText=ra.Wtb(Na,Ib);ra.bAd.innerText=ra.Jed(Na,Ib);switch(Na){case 0:return ra.qK.disabled=!0,Le.DOMElementExtensions.setVisible(ra.c9a,!1),Le.DOMElementExtensions.setVisible(ra.oOa,!1),Le.DOMElementExtensions.setVisible(ra.p4a,!1),Le.DOMElementExtensions.setVisible(ra.KMa,!1),ra.Ava.disabled=!0,!1;case 3:return ra.qK.disabled=!0,Le.DOMElementExtensions.setVisible(ra.c9a,!0),Le.DOMElementExtensions.setVisible(ra.oOa,
!1),Le.DOMElementExtensions.setVisible(ra.p4a,!0),Le.DOMElementExtensions.setVisible(ra.KMa,!0),ra.Ava.disabled=!1;case 7:return ra.qK.disabled=!0,Le.DOMElementExtensions.setVisible(ra.c9a,!0),Le.DOMElementExtensions.setVisible(ra.oOa,!1),Le.DOMElementExtensions.setVisible(ra.p4a,!1),Le.DOMElementExtensions.setVisible(ra.KMa,!1),ra.Ava.disabled=!1;default:ra.Ava.disabled=!1,Le.DOMElementExtensions.setVisible(ra.c9a,!0),Le.DOMElementExtensions.setVisible(ra.KMa,!1)}switch(Ib){case 0:case 1:Le.DOMElementExtensions.setVisible(ra.oOa,
!0);break;default:Le.DOMElementExtensions.setVisible(ra.oOa,!1)}ra.qK.disabled=!1;ra.gnc.disabled=!1;Le.DOMElementExtensions.setVisible(ra.p4a,!1);Le.DOMElementExtensions.setVisible(ra.KMa,!1);return!1};ra.get_visible=ra.oja;ra.set_visible=ra.Uma;ra.JQ=new mc.a;ra.JQ.add(Ae.a.instance.ea(1620));ra.JQ.add(Ae.a.instance.ea(1621));ra.JQ.add(Ae.a.instance.ea(1624));ra.JQ.add(Ae.a.instance.ea(1622));ra.JQ.add(Ae.a.instance.ea(1623));ra.JQ.add(Ae.a.instance.ea(1625));ra.JQ.add(Ae.a.instance.ea(1626));ra.JQ.add(Ae.a.instance.ea(1627));
ra.JQ.add(Ae.a.instance.ea(1628));ra.JQ.add(Ae.a.instance.ea(1629));ra.JQ.add(Ae.a.instance.ea(1630));ra.JQ.add(Ae.a.instance.ea(1631));ra.JQ.add("");ra.$=e;ra.xk=M;ra.Kja();return ra}function Rc(){}function Wc(e,C){var M=this;this.iB=this.X_a=this.selectedRanges=null;this.cHe=!1;this.dh=null;this.xDi=function(ra){Fd.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ra||yh.a(ra)?Fd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(M.X_a=ra.Result,M.yTi())};this.lsh=function(ra){M.nW("DataValidationEdit.ExpandExisitngDialog",ra);M.iB.c=Wc.Rha(ra);1===ra?M.UGa(new fe(M.X_a)):2===ra?M.UGa(new fe):M.wjf()};this.BOi=function(ra){M.nW("DataValidationEdit.OverrideExisitngDialog",ra);M.iB.c=Wc.Rha(ra);1===ra?M.UGa(new fe):M.wjf()};this.$=e;this.O3c=C}function fe(e){this.J4=(e=void 0===e?null:e)?e.IsIgnoreBlank:!0;this.K4=e?e.IsInCellDropDown:!0;this.nN=e?e.LowerBoundary:"";this.oN=e?e.UpperBoundary:"";this.$A=e?e.ConditionType:0;
this.ruleType=e?e.RuleType:0;this.vZ=e?e.IsAlertBlocking:!0;this.lT=e?e.AlertTitle:"";this.kT=e?e.AlertMessage:"";this.cV=e?e.InputMessage:"";this.yE=e?e.InputTitle:"";this.W4=e?e.IsShowErrorAlert:!0;this.X4=e?e.IsShowInputMessage:!0}function ve(e){switch(e){case 0:e="AnyValue";break;case 1:e="WholeNumber";break;case 2:e="Decimal";break;case 3:e="List";break;case 4:e="Date";break;case 5:e="Time";break;case 6:e="TextLength";break;case 7:e="Custom";break;default:e="Unknown"}return e}function kc(e){switch(e){case 0:e=
"Between";break;case 1:e="NotBetween";break;case 2:e="Equal";break;case 3:e="NotEqual";break;case 4:e="GreaterThan";break;case 5:e="LessThan";break;case 6:e="GreaterThanOrEqual";break;case 7:e="LessThanOrEqual";break;default:e="Unknown"}return e}function ad(e){var C=Ri.call(this)||this;C.$=e;C.dc();return C}function yd(e,C,M){var ra=this;this.kwc={};this.Ld=!1;this.Zk=function(Na,Ib){ra.showContextMenu(void 0===Ib?null:Ib)};this.vsf=function(Na,Ib){Ib.osi===yd.LVh&&$e.g(ra.$).focus()};this.Jxa=function(Na,
Ib){Na=ra.$.Ka.gaa(Ib.ee.command);(null===Na||void 0===Na?0:Na.dismissesContextualUI)&&ra.i3()};this.I5=function(){ra.$.da.fU(342);xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.create(ra.$.da,338,ra.$.ma,3),function(Na){Na=Na.result;for(var Ib=yl(ra.kwc),Gc=Ib.next();!Gc.done;Gc=Ib.next())Gc.value.gKf(Na)},ra.$.ma)};this.$=e;this.contextMenuController=M;this.J3d=new wd(this.$);e.da.Ha(8,this);for(M=0;M<C.length;M++)this.kwc[yd.EYg[M]]=C[M];this.ha=$e.g(e).ha;this.ha.GXb(this.Zk);this.$.Ka.cFa(this.vsf);
he.a.instance.ulj();ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.gmb(this.Jxa);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.i9(this.I5)}function wd(e){this.cQe=null;this.$=e;this.nxa=new Af;ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.cQe=new pe(this.$))}function pe(e){var C=
this;this.AYa=null;this.vOd=!1;this.Hzb=0;this.q7c=1;this.MJe=0;this.nCb=function(M){C.WGf(M.domElement,M.hashCode)};this.vKf=function(M){for(var ra=0;window.performance.now()-M<C.Xhh&&0<C.AYa.length;)C.Fje(C.AYa.shift()),ra++;Fd.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",C.q7c,ra,C.AYa.length);0<C.AYa.length?C.Hzb=window.requestAnimationFrame(C.vKf):(Fd.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",C.q7c,window.performance.now()-C.MJe),C.q7c++,C.Hzb=0)};this.onPointerDown=function(M){kg.a.slim(M.Ea.rawEvent);return!1};this.$=e;this.gridView=$e.g(this.$);this.J2h();this.Xhh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function bf(){this.Xd=this.qqe=this.cell=null}function Af(){this.Zbc={}}function bg(){this.menuModel=null;this.zCe=0}function og(){this.dictionary=this.ee=null}function Zf(e){var C=
Jd.call(this)||this;C.H7e=!1;C.wjd=function(){var M;(M=C.$.da.Aa(342))?C.Fb(M):C.$.rE(function(ra){ra.vjd().then(function(Na){(M=C.$.da.Aa(342))?C.Fb(M):(M=new If(C.$,Na),C.Fb(C.$.da.Ha(342,M)))})})};C.$=e;C.dc();return C}function If(e,C){this.Ipb=C;this.$=e}function qg(e){return ta.call(this,e)||this}function Vf(e,C,M,ra){e=Sd.call(this,e,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Vf.TBj,!0,!1,Vf.cHb,C,M,!1,ra)||this;e.L_a=0;e.Tra=null;e.IJa=null;e.sHe=null;return e}function Fe(e,C,M){this.type=
e;this.DYg=C;this.$o=M}function zg(e,C,M,ra){return nh.call(this,e,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",C,M,!0,ra)||this}function Yf(e,C,M,ra){e=Ci.call(this,e,"PopulateSheetOpsContextMenu",274207288,-1497523576,"SheetOpsContextMenu",!0,!1,"SheetTabContextMenuRootName",C,M,!1,ra)||this;e.Zec=!1;e.xgc=!1;return e}function jg(e,C,M,ra){C=Xg.call(this,e,"PopulateRichTextContextMenu",679816325,1151222423,"RichTextContextMenu",!0,!1,"RichTextContextMenu",
C,M,!0,ra)||this;C.grid=$e.g(e);return C}function Ff(e,C,M,ra){C=Fh.call(this,e,"PopulateTableFieldListContextMenu",-751848458,-1085236154,"TableFieldListContextMenu",!0,!1,"TableFieldListContextMenuRoot",C,M,!1,ra)||this;C.B3b=null;C.twd=0;C.HTb=null;C.grid=$e.g(e);return C}function de(){}function Tf(e,C,M,ra){var Na=tg.call(this,e,"PopulatePivotTableContextMenu",-1475408662,1114549926,"PivotTableContextMenu",!0,!1,"PivotTableContextMenuRootName",C,M,!0,ra)||this;Na.Wc=null;Na.activeCell=null;Na.aBc=
null;Na.Igc=!1;Na.Zld=!1;Na.expandCollapse=!1;Na.refresh=!1;Na.UY=!1;Na.Yf=null;Na.Cz=null;Na.q_a=null;Na.Bb=null;Na.O9a=null;Na.Uaa=!1;Na.lEi=function(Ib){Ib&&!mh.a.ih(Ib.Errors)&&Na.Wc&&(Na.Wc.Do=Ib.Result,Na.oIb());Na.showPivotTableContextMenu()};Na.kEi=function(){};Na.bIi=function(){Na.sab()};Na.aIi=function(){Na.sab()};Na.$yi=function(){Na.sab()};Na.Zyi=function(){Na.sab()};Na.Jt=function(){Na.XUd();Na.Uaa=!1};Na.Ms=function(){if(Na.Uaa){Fd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var Ib=Na.Wc;Na.grid.Vb.nq(Na.grid.ha.va.activeCell)!==Ib&&(Na.sab(),Na.X_h())}};Na.Rch=new DOMParser;Na.Coj=!0;Na.grid=$e.g(e);Na.tjc=!0;return Na}function Ve(e,C,M,ra){return mf.call(this,e,"PopulatePivotContextMenu",2123758504,912277356,C,M,ra)||this}function We(e,C,M,ra){e=Gd.call(this,e,"PopulateFieldWellContextMenu",1374696078,495005930,"FieldWellContextMenu",!0,!1,"FieldWellContextMenu",C,M,!1,ra)||this;e.cell=null;e.Zn=null;e.mo=null;e.externalSourceIndex=-1;e.XXd=-1;e.ERa=0;e.Awc=-1;e.bL=
null;e.isOlap=!1;e.lH=!1;e.t1a=!1;return e}function Sf(e,C,M,ra,Na,Ib,Gc,id,Uc){var Vd=Td.call(this,Na,Ae.a.instance.Cb(60),!0,2,!0)||this;Vd.PZf=!0;Vd.Kge=null;Vd.sRa=null;Vd.kfa=null;Vd.Dqb=null;Vd.I3c=null;Vd.OPc=null;Vd.Uyi=function(Ye){ai.a.any(Ye.Errors,function(Gf){return-103190598===Gf.MessageId})&&Vd.URa.K$i()};Vd.VEi=function(Ye){Ye&&!yh.a(Ye)&&(Ye=Ye.Result,Vd.I3c.innerHTML=Ae.a.instance.ea(1051)+bh.a.If(Ye.ValueFieldSourceName),Vd.isOlap&&!Vd.lH?(Vd.URa.enabled=!1,Vd.kfa.activeTab=Vd.kfa.xxc-
1):(Vd.URa.enabled=!0,Vd.kfa.activeTab=0),Vd.URa.kkj(Ye.PivotValueFieldSettingsSummarizeValueByInfo),Vd.sRa.lkj(Ye.PivotValueFieldShowValueAsInitialInfo),Vd.nf())};Vd.cell=e;Vd.mo=C;Vd.externalSourceIndex=M;Vd.nbg=ra;Vd.ee=Ib;Vd.Cha=Gc;Vd.isOlap=id;Vd.lH=Uc;return Vd}function vg(e,C,M){M=void 0===M?null:M;this.Pkb=this.Zkb=null;this.S0=-1;this.Ci=e;this.NX=(void 0===C?null:C)||new mc.a;this.zsg=M||new qf;this.uEa=new mc.a;e=0;C=yl(this.NX);for(M=C.next();!M.done;M=C.next()){M=M.value;this.npd(this.S0)||
(this.S0=e);var ra=e++;this.uEa.add(new kh(document.createElement("li"),M.title,this.t1g(ra)))}}function kh(e,C,M){this.Ci=e;this.lp=C;this.nEc=M;this.$ea=document.createElement("a");ic.a.cuc(this.$ea,this.lp);Sys.UI.DomElement.addCssClass(this.$ea,Pg.Yzj);Sys.UI.DomElement.addCssClass(this.Ci,Pg.Xzj);this.Ci.appendChild(this.$ea);this.$ea.tabIndex=0;this.qzc();T.a.addHandler(this.Ci,"click",this.nEc);T.a.addHandler(this.Ci,"keyup",Object(xb.a)(this,this.R8a,"onTitleKeyUp"))}function Pg(){}function qf(){}
function ih(e){e=vh.call(this,e)||this;e.Xae=null;e.get_visible=e.oja;e.set_visible=e.Uma;e.Kja();return e}function Qa(){}function qb(e,C,M,ra,Na,Ib,Gc,id){var Uc=jj.call(this,e)||this;Uc.RE=null;Uc.X3b=null;Uc.OZb=null;Uc.o_d=null;Uc.p_d=null;Uc.Q1d=null;Uc.Csf=function(){var Vd=parseInt(Uc.d3.pe.value);Uc.cQg(Vd)?(Uc.qT.Gn.disabled=!0,Uc.gP.Gn.disabled=!0,Uc.gP.clear(),qb.L9e(Vd)?(Uc.qT.Gn.disabled=!1,Uc.dMb(!0)):qb.M9e(Vd)?(Uc.qT.Gn.disabled=!1,Uc.gP.Gn.disabled=!1,Uc.dMb(!0),Uc.Hhf()):Uc.dMb(!1)):
(Vd=mh.a.jd(1,0,0,1081,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Qi.a(Uc.$).St([Vd]),Uc.d3.O$i())};Uc.ezi=function(){0>Uc.qT.selectedIndex||Uc.gP.Gn.disabled||(Uc.dMb(!0),Uc.Hhf())};Uc.WEi=function(Vd){Uc.RE.NRa();Uc.gP.Gn.style.overflowY="scroll";if(Vd&&!yh.a(Vd)){Vd=Vd.Result;Uc.gP.clear();for(var Ye=yl(Vd.BaseItems),Gf=Ye.next();!Gf.done;Gf=Ye.next())Gf=Gf.value,Uc.gP.AL(Gf.DisplayString,Gf.Id.toString(),Gf.Id===Vd.SelectedBaseItem);Uc.dMb(!1)}};Uc.get_visible=Uc.oja;Uc.set_visible=Uc.Uma;
Uc.$=C;Uc.cell=M;Uc.mo=ra;Uc.externalSourceIndex=Na;Uc.ee=Ib;Uc.Cha=Gc;Uc.Mci=id;Uc.qKj=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Uc.Kja();return Uc}function tc(){}function fd(e,C,M,ra,Na){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=e;this.activeCell=C;this.pivotFieldTitle=M;this.summarizeBy=ra;this.showAsValueParameters=Na}function Rd(e,C,M){this.baseItemIndex=
this.baseFieldIndex=this.dataFormat=0;this.dataFormat=e;this.baseFieldIndex=C;this.baseItemIndex=M}function zd(){}function xe(){}function me(e,C,M,ra){return mf.call(this,e,"PopulateFieldListPivotMenu",-1793121409,1378457149,C,M,ra,"FieldListPivotFilterContextMenu")||this}function mf(e,C,M,ra,Na,Ib,Gc,id){var Uc=nf.call(this,e,C,M,ra,void 0===id?"PivotFilterContextMenu":id,!0,!1,"PivotFilterMenuRootName",Na,Ib,!1,Gc)||this;Uc.w3b=null;Uc.agf=null;Uc.nlb=null;Uc.pivotData=null;Uc.Bwd=null;Uc.Fkc=null;
Uc.CBb=0;Uc.y0b=0;Uc.$X=0;Uc.M_a=null;Uc.$Di=function(Vd,Ye){if(Ye)if(yh.a(Vd))Uc.Ctd(Ye,!1);else if(Vd=Vd.Result){Uc.$qb=rf.Bdd(Ye,Uc.$,Uc.pivotData.cell,Uc.$X);var Gf=Uc.eud(Vd.MenuModel.Sections);Uc.M_a=Gf;mf.TM.set(Uc.pivotData.cell,Ye,Gf,Uc.$X);th.a(Uc.$).myj(Vd);Uc.Ctd(Ye,!0)}};Uc.ZDi=function(Vd,Ye){Uc.Ctd(Ye,!1)};Uc.Pe=function(Vd,Ye){mf.TM.rrb(Ye.$c.hash)};Uc.Hm=function(Vd,Ye){mf.TM.rrb(Ye.$c.hash)};Uc.vca=null;Uc.Cwd=Uc.CBb=-1;Uc.ave=Uc.y0b=-1;Uc.fne=Uc.$X=0;Uc.aw=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
mf.TM||(mf.TM=new rf(Uc.$),$e.g(Uc.$).Ca.gq(Uc.Pe),$e.g(Uc.$).Ca.gG(Uc.Hm),$e.g(Uc.$).Ca.nga(Uc.Pe));return Uc}function df(){this.cell=null;this.dataSourceIndex=0;this.mo=this.pivotName=null}function rf(e){this.$=e;this.TM={}}function Mg(e,C,M,ra){e=ng.call(this,e,"PopulateFieldListContextMenu",-1045020714,-170383950,"FieldListContextMenu",!0,!1,"FieldListContextMenu",C,M,!1,ra)||this;e.Zn=null;e.bL=null;e.wZ=!1;e.lH=!1;e.isOlap=!1;e.JRd=!1;return e}function lf(e,C,M,ra){e=$f.call(this,e,C,M,ra,"PopulateChartContextMenu",
-498523270,1640762262,"ChartContextMenu")||this;e.bAa=!1;e.qva=!1;e.UY=!1;e.refresh=!1;e.isPivotChart=!1;return e}function $f(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd){id=void 0===id?Je.a.AYg:id;e=$c.call(this,e,void 0===Na?"PopulateFloatingObjectContextMenu":Na,void 0===Ib?-2017893763:Ib,void 0===Gc?1350204367:Gc,id,void 0===Uc?!0:Uc,void 0===Vd?!1:Vd,id,C,M,!0,ra)||this;e.floatingObject=null;e.zb=0;e.tjc=!0;return e}function dg(e,C,M,ra){e=H.call(this,e,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,
dg.Eth,!0,!1,dg.cHb,C,M,!1,ra)||this;e.am=null;return e}function yf(){}function Hg(){}function Df(e,C){e=xc.call(this,e,2,0,null)||this;e.pqe=C;return e}function xc(e,C,M,ra){this.Vng=e;this.Jig=C;this.Nig=M;this.ssg=ra}function dd(){}function Cd(e,C,M,ra){var Na=ja.call(this,e,"PopulateAutoFilterContextMenu",1675506831,1651433993,"AutoFilterContextMenu",!0,!1,"AutoFilterContextMenuRoot",C,M,!1,ra)||this;Na.M_a=null;Na.sheetName=null;Na.qSa=null;Na.PUc=null;Na.cif=!1;Na.w1a=!1;Na.HBd=null;Na.iKb=
null;Na.C8c=null;Na.pac=null;Na.zOa=null;Na.PCe=null;Na.q9a=null;Na.g3c=null;Na.aN=function(){Na.ywc();Na.$.fa.hr(Na.aN)};Na.MDi=function(Ib){function Gc(Dg,Eg,Ch){Na.g3c=vf.t(Na.$.qa.ta,Vd,hh.b(Dg,Ye),Na.w1a?hh.a(Eg,Gf):Eg,Ch,null,rg);return Na.g3c}Na.w1a||qi.b(Na.$).ae(Dh.a.ruf,Na.dm(),void 0,!0);var id={};Na.$.wj(id);var Uc=Na.$.fa.isNamedObjectViewMode,Vd=$g.a.li(Na.PUc);Vd.SheetName=Uc?id.NamedObjectName:id.SheetName;Vd.NamedObjectView=Uc;id=!!Ib.searchText;Uc=586;Na.w1a&&(id&&(Vd.ItemListOptions=
Na.c0g(Ib.searchText),Uc=597),Ib={},qi.b(Na.$).ae(Dh.a.ruf,(Ib.UserOperation=Uc.toString(),Ib),void 0,!0));var Ye=Na.dyd(id),Gf=Na.NDi(),rg=Na.$.qa.ta.Xb();Na.PCe=rg.RequestId;Na.w1a&&Na.pac&&!Na.pac.dequeueUtcTime&&(Na.$.userOperationManager.CHa(Na.pac),Na.oQg());Ib=ld.EwaSettings.tc()?new hg.a(Uc,0,Gc,80):new Ze.a(Uc,0,Gc,16);Na.pac=Na.$.userOperationManager.ic(Ib,null);Na.q9a=Na.g3c;Na.zOa=Na.PCe};Na.onMenuItemClick=function(Ib,Gc,id){qi.b(Na.$).ae(Dh.a.CIi,Na.dm(),void 0,!0);var Uc={};Gc=(Uc.CommandValueId=
Gc,Uc.MenuItemId=Gc,Uc.InputMethod=id,Uc.TopCellAddress=Na.qSa,Uc);Uc=new Rg.a(Ib,id,Na.$.isEditMode?2:1,19,null);Na.$.Ka.Zb(Uc,Gc);Fd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Ib,id)};Na.Qyi=function(Ib){if(Ib.checkedItems&&Ib.checkedItems.length){qi.b(Na.$).ae(Dh.a.Dqf,Na.dm(),void 0,!0);var Gc=$g.a.li(Na.PUc),id={};Na.$.wj(id);id.FirstRow=0;id.FirstColumn=Gc.Column;var Uc=Na.$.fa.isNamedObjectViewMode;Gc.NamedObjectView=Uc;Gc.SheetName=Uc?id.NamedObjectName:
id.SheetName;var Vd=function(rg){if(Ab.a.tvc(rg)){var Dg=Ab.a.x9b(rg);Na.SLa?Ab.a.DPa(jc.a.applyItemFilter,Dg.MessageIdName,Oc.a.Ara,!0,Ab.a.isSessionEndingError(Dg.MessageId)):Fd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Dg.MessageIdName)}yh.a(rg)||(Fd.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),qi.b(Na.$).ae(Dh.a.luf,Na.dm(),void 0,!0),rg=Object.assign(new Ba,{isSuccess:!0}),
Na.iKb.onApplyFilterByValueFinish(rg),Na.ZK(Na.qSa))},Ye=Na.H1c(Gc,id),Gf=new hg.a(208,0,function(rg,Dg,Eg){return vf.a(Na.$.qa.ta,Ye,Ib.checkedItems,hh.b(rg,Vd),Dg,Eg,null,null)},6,function(){return new Tg.a(Ib.checkedItems,Ye)});Na.P_f(function(){Na.$.userOperationManager.ic(Gf,null)})}else Fd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Na.gGg=function(Ib){var Gc=sg.o(Na.qSa,Na.$),id=sg.v(Na.qSa,Na.$),Uc=Object.assign(new He,
{SortConditionType:Ib.type,RowColOffset:Gc.FirstColumn-id.FirstColumn,SortColor:Ib.color,SortIconSet:Ib.icon.IconSet,SortIcon:Ib.icon.Icon,IsAscending:!0}),Vd={SortOptions:Object.assign(new Md,{OperationType:1,ActiveCell:Gc,SelectedRange:id,SortConditions:[Uc],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:id,OriginalActiveCell:Gc,ShouldRestoreSelection:!1};Fd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",Ib.type);Na.P_f(function(){var Ye=
{};Na.$.Ce(1659552324,pg.a.Wb,19,(Ye.CustomSortCommandData=Vd,Ye))})};Na.SLa=Ab.a.Kkd();Na.aw=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return Na}function Ld(){this.top=this.left=0}function Od(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function ef(){this.autoFilterMenu=this.targetPoint=null}function Xf(){this.filterByValueItems=null;this.hasMoreRecords=!1;
this.searchText=null}function Qf(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function gg(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function Ba(){this.isSuccess=!1}function Ob(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Ec(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=
this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function od(){this.Sections=this.Id=null}function Md(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function He(){this.RowColOffset=0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=
this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Qe(){}function Bf(e,C,M,ra){var Na=this;this.L_d=this.X0=this.Ri=this.pD=this.P7=null;this.fVb=e;this.xrg=ra;this.fVb.hLa&&(this.Ri=new cf.a(3,2,5E3,Object(xb.a)(this,this.kIg,"authenticationCheckTask"),2),jd.AFrameworkApplication.oj.gh(this.Ri),this.Mg(C,M));this.fVb.cmb(function(){Na.Lqf()});this.fVb.zXa(function(){Na.Mqf()})}function Uf(){}function Ea(e){return ei.call(this,e)||this}
function ob(e,C,M){var ra=yi.call(this)||this;ra.hAi=function(Na,Ib){if(!yh.a(Na)&&Ib){var Gc=!!Na&&!!Na.RequestTelemetryData;$e.g(ra.$).Ji.Pka(Ib.toString(),Na.StateId,Gc?Na.RequestTelemetryData.EcsOperationDuration:0,Gc?Na.RequestTelemetryData.EcsRequestDuration:0,Gc?Na.RequestTelemetryData.WfeRequestDuration:0)}};ra.$=e;ra.tableManager=C;ra.hi=M;return ra}function ac(e,C){this.command=0;this.selectedRanges=null;this.command=e;this.selectedRanges=C}function vc(e){return mi.call(this,e)||this}function nb(e){var C=
Gi.call(this)||this;C.Pqf=function(M){var ra=$e.g(C.$);if(M=M.Result){var Na=sg.D(M.NewSelection),Ib=sg.D(M.NewActiveCell);if(Na&&Ib)if(!M.Committed&&M.AutoSumFormula){var Gc=ra.sc(Ib);Gc&&(ra.ha.updateSelection(Na,Ib,60),Na=Ib=sg.D(M.MarkedArea),ra.gC=2,$d(ra.rc,Gc,M.AutoSumFormula,!!Na,M.FormulaMarkStart,M.FormulaMarkEnd),Na&&Ib&&ra.ha.updateSelection(Na,Ib,0),ra.rc.Knd=!1,xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.create(C.$.da,153,C.ma,0),function(id){id.result.Krb(null)},C.ma,3))}else ra.ha.updateSelection(Na,
Ib,60)}};C.$=e;return C}function fc(e,C){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=e;this.type=C}function $d(e,C,M,ra,Na,Ib){if(C){var Gc=e.textBox;e.isEditing||e.startEdit(C,!0);e.Knd=!0;e.text=M;Gc.caretPosition=Na;Na<Ib&&(ra&&e.kAa(),Gc.selectRange(0,Ib+1),Gc.selectRange(Na,Ib))}}function Id(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd){Vd=e.Oa(9,Vd);Vd.selectedRange=C;Vd.activeCell=M;Vd.autoSumType=ra;Vd.topLeftCell=Na;return vf.i(e,"AutoSum",Vd,Ib,Gc,id,Uc,0)}function Me(e,C,M,ra,Na,Ib){if(0===
ra)return Object(Vg.a)(ji.UnsupportedZeroResize);if(0>ra||0===M.length)return Object(Vg.a)(ji.InvalidInput);if(e.XZh())return Object(Vg.a)(ji.UnsupportedSkeletonInView);var Gc=e.tf;if(!Gc)return Object(Vg.a)(ji.NullSPD);var id=Gc.iXe(M);if(id&&0<id.length)return Object(Vg.a)(id.length.toString()+" "+ji.UnsupportedHiddenInRange);a:{id=yl(M);for(var Uc=id.next();!Uc.done;Uc=id.next())Uc=Uc.value,Na?Uc.right=Mi.a.Qh:Uc.bottom=Mi.a.Fh;id=e.l$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",M);try{for(id.$$rst();id.$$mn();)if(id.Vn.ewj){var Vd=
!0;break a}}finally{id&&id.dispose()}Vd=!1}if(Vd)return Object(Vg.a)(ji.UnsupportedMergeCell);if(ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Na&&"undefined"!==typeof gridRenderer)for(Vd=yl(M),id=Vd.next();!id.done;id=Vd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(id.value.left);e=e.Ca;Vd=Ng.a.create().toString();Gc.M$f(M,ra,Na);Ib=e.n9f(Na,Ib);C.z_i(M,Na);e.dHf(Ib,Vd);return Object(Vg.d)(ra)}b.r(D);var se=b(514),td=b(0),af=b(817),
Fd=b(13),wf=b(195),vf=b(81),pg=b(78);fc.prototype.d3a=function(){return this.sharedSheetRange};Object(td.a)(fc,"MacroRecorderAutoSumPayload",null,[98]);var sg=b(43),Ze=b(519),Lg=b(368),hg=b(163),ud=b(56),xf=b(35),Nh=b(148),Fg=b(337),mh=b(27),ld=b(1),mg=b(175),hh=b(273),$e=b(20),Qg=b(154),ch=b(585),wg=b(55),Gi=wf.a;vm(nb,Gi);nb.prototype.Xc=function(){return!1};nb.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 1220954656:C=this.bGe(0,C);break;case -1537138325:C=this.bGe(parseInt(M[pg.a.hd].toString()),
C);break;default:C=mg.a(e)}return C};nb.prototype.Gc=function(e,C){if(e=1===e)switch(C.command){case 1220954656:case -1537138325:break;default:e=!1}return e};nb.prototype.fd=function(){return!1};nb.prototype.bGe=function(e,C){function M(){return new fc(Gc,e)}var ra=this,Na=$e.g(this.$);Na.Bh.qG(!1);if(!$e.g(this.$).ha.va.Dh)return Fd.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",e,$e.g(this.$).ha.va.nK),
this.wya(),wg.Task.Ta(!1);var Ib=Na.QG();if(!Ib)return null;var Gc=sg.v(Na.ha.va.Qd,this.$),id=sg.o(Na.ha.va.activeCell,this.$),Uc=sg.o(Ib,this.$),Vd=this.$.qa.ta.Xb();return this.$.xs(Na.ha.va.selectedRanges,!0)?ld.EwaSettings.tc()?Lg.a(this.$.userOperationManager,function(Ye,Gf,rg){return Id(ra.$.qa.ta,Gc,id,e,Uc,hh.b(Ye,ra.Pqf),Gf,rg,e,Vd)},function(Ye){return new hg.a(502,0,Ye,64,M)},C):Lg.a(this.$.userOperationManager,function(Ye,Gf,rg){return Id(ra.$.qa.ta,Gc,id,e,Uc,hh.b(Ye,ra.Pqf),Gf,rg,e,
Vd)},function(Ye){return new Ze.a(502,0,Ye,void 0,M)},C):wg.Task.Ta(!1)};nb.prototype.wya=function(){ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")&&ch.a(Qg.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var e=mh.a.jd(1,1,735,2121,0,371863010,"DiscontinuousSelectionBlocking");ld.EwaSettings.az()?new Fg.a(this.$,e):(e=new Nh.ErrorDialog(this.$,e),e.initialize(),e.nf())};Object(td.a)(nb,"AutoSumCommandHandler",wf.a,[147]);var mi=af.a;vm(vc,
mi);vc.prototype.Md=function(){this.Ed([new nb(this.$)])};vc.ja=function(e){af.a.de(96,new vc(e))};Object(td.a)(vc,"AutoSumCommandHandlerFactory",af.a,[]);var ph=b(10),Ng=b(179),ai=b(308),Zg=b(36),ni=b(318);ac.prototype.xt=function(){return this.command};Object(td.a)(ac,"MacroRecorderRangeOperationAppliedPayload",null,[98]);var yh=b(302),fh=b(67),yi=Zg.a;vm(ob,yi);ob.prototype.xzg=function(e){this.addHandler("ekcvc",e)};ob.prototype.R3i=function(e){this.removeHandler("ekcvc",e)};ob.prototype.Xc=function(){return!1};
ob.prototype.executeCommand=function(e,C){e=C.command;switch(e){case -730106152:C=this.sgd(C,3);break;case -1228228458:C=this.sgd(C,4);break;case -848953656:case 2045211913:if(this.zdi()){C=wg.Task.Ta(!0);break}C=this.sgd(C,1);break;default:C=mg.a(e)}return C};ob.prototype.Gc=function(e,C){if(e=1===e)switch(C.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:e=!1}return e};ob.prototype.fd=function(){return!1};ob.prototype.sgd=function(e,C){function M(){return new ac(C,
Vd)}function ra(Gf,rg,Dg){Na.$.Xu();return vf.f(Na.$.qa.ta,C,Vd,!1,hh.b(Gf,Na.hAi),rg,Dg,Uc,Ye)}var Na=this,Ib=$e.g(this.$),Gc=Ib.ha.va.selectedRanges,id=e.command,Uc=Ng.a.create().toString();if(!this.$.xs(Gc,!0)&&-730106152!==id)return wg.Task.Ta(!0);var Vd=sg.r(Gc,this.$);this.Fsj(id,Ib,Gc,Uc);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.GWi();var Ye=this.$.qa.ta.Xb(!0);return ld.EwaSettings.tc()?Lg.a(this.$.userOperationManager,ra,function(Gf){return new hg.a(508,
0,Gf,67,M)},e):Lg.a(this.$.userOperationManager,ra,function(Gf){return new Ze.a(508,0,Gf,3,M)},e)};ob.prototype.Fsj=function(e,C,M,ra){var Na=this;if(-848953656!==e&&2045211913!==e&&-730106152!==e&&-1228228458!==e)Fd.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",e);else if(!ai.a.any(M,function(Gc){return 0<C.getRangeInformation(Gc).length})){var Ib=ai.a.any(M,function(Gc){return Na.tableManager.Uod(Gc)});if(-730106152!==e&&-1228228458!==e||!Ib)this.Lwj(C,
e,ra,M),-730106152!==e&&-1228228458!==e||this.hi.gna(C,-730106152,{}),-1228228458!==e&&2045211913!==e&&-848953656!==e||this.hi.YTg(M,ra),C.Ji.m0(ra,fh.BasicTelemetryCalculator.sQ)}};ob.prototype.Lwj=function(e,C,M,ra){var Na="";switch(C){case -1228228458:Na="ClearAll";break;case 2045211913:case -848953656:Na="ClearContent";break;case -730106152:Na="ClearFormat";break;default:Fd.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",C)}C=ra.length;
ra=sg.b(ra);e.Ji.X6(15,M,Na+(", ranges to clear: "+C+", cells to clear: "+ra))};ob.prototype.GWi=function(){this.raiseEvent("ekcvc",new ni.a)};ob.prototype.zdi=function(){if($e.g(this.$).Xy){var e=this.$.da.Aa(296);return!!e&&e.kU.yA}return!1};Object(td.a)(ob,"ClearCommandHandler",Zg.a,[147,616]);var ei=af.a;vm(Ea,ei);Ea.prototype.Md=function(){var e=this,C=ud.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb),M=ud.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([C,
M],this.ma),function(){var ra=new ob(e.$,C.result,M.result);e.Ed([ra]);e.$.da.Ha(313,ra)},this.ma,3)};Ea.ja=function(e){af.a.de(101,new Ea(e))};Object(td.a)(Ea,"ClearCommandHandlerFactory",af.a,[]);var la=b(914),kb=b(892),Xb=b(864),Dc=b(1149);Uf.prototype.j4g=function(e,C){if(e&&!(1>e.length)&&C){var M=Object.assign(new Xb.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.I1g(e,M.ControlList);C.push(M)}};Uf.prototype.I1g=function(e,C){var M=Object.assign(new la.a,{ExternalId:"ContextCoauthors",
LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new kb.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(C,M);C=Object.assign(new Xb.a,{Title:"",ControlList:[]});Array.add(M.Menu.MenuSectionList,C);this.R3g(e,C.ControlList)};Uf.prototype.R3g=function(e,C){for(var M=0;M<e.length;M++){var ra=Object.assign(new Dc.a,{ExternalId:String.format("CoauthorPersona_{0}",M),Command:"336231556",DisplayName:e[M].userName,LabelText:e[M].userName,
ImageBackColor:e[M].color,PersonaId:e[M].email,IsAnonymous:e[M].isAnonymous});Array.add(C,ra)}};Object(td.a)(Uf,"PresenceContextMenuSectionBuilder",null,[617]);var xb=b(80),jd=b(5),ke=b(171),Ge=b(581),cf=b(109),kf=b(128),jf=b(88),Ef=b(86),ya=b(108),qa=b(29);Bf.prototype.Mg=function(e,C){var M=jd.AFrameworkApplication.Eb;M.jf(qa.a.authenticationLost,ya.a.frame,e,96);M.jf(qa.a.iqe,ya.a.frame,C,96);M.$b(qa.a.due,ya.a.frame,ke.ActionManager.r5c);M.$b(qa.a.eue,ya.a.frame,ke.ActionManager.r5c);M.$b(qa.a.Vqd,
ya.a.frame,ke.ActionManager.r5c)};Bf.prototype.Lqf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);jd.AFrameworkApplication.Eb.processAction(qa.a.authenticationLost,2)};Bf.prototype.Mqf=function(){this.DAj();jd.AFrameworkApplication.Eb.processAction(qa.a.iqe,2)};Bf.prototype.kIg=function(){this.fVb.authenticationCheck()};Bf.prototype.DAj=function(){this.pD&&(this.pD.hide(),this.pD.dispose(),this.pD=null);this.P7&&this.businessBar&&(jd.AFrameworkApplication.Gg||this.businessBar.removeEntry(this.P7),
this.P7.dispose(),this.P7=null)};Bf.prototype.showDialog=function(e){jf.a.Fa(this.pD);this.pD=new kf.StandardDialog;this.xrg||(this.pD.Gu=!1,this.pD.kc=0);this.pD.Cc(1,CommonUIStrings.l_SignIn);this.pD.GW(CommonUIStrings.l_DefaultDialogTitle,e,Object(xb.a)(this,this.Ov,"dialogHandler"))};Bf.prototype.Ov=function(e){1===e?(Ge.a.a6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),jd.AFrameworkApplication.Eb.processAction(qa.a.Vqd,2)):(this.zJb(),jd.AFrameworkApplication.Eb.processAction(qa.a.eue,
2))};Bf.prototype.zJb=function(){this.businessBar&&this.sse&&(this.P7=this.sse.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.P7.closeable=!0,this.P7.addButton(CommonUIStrings.l_SignIn,Bf.KNg,""),this.P7.U9=Object(xb.a)(this,this.NNg,"businessBarEntryCloseHandler"),this.businessBar.BD(this.P7,!1))};Bf.prototype.NNg=function(){this.Mah();jd.AFrameworkApplication.Eb.processAction(qa.a.due,2)};Bf.prototype.Mah=function(){this.Ri&&(jd.AFrameworkApplication.oj.Bp(this.Ri),
this.Ri=null)};Bf.prototype.dispose=function(){this.Ri=this.pD=this.P7=null};Bf.KNg=function(){Ge.a.a6();jd.AFrameworkApplication.Eb.processAction(qa.a.Vqd,2)};tl.Object.defineProperties(Bf.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.X0||(this.X0=Ef.a.instance.Hh("CommonUI.IBusinessBar"))}},sse:{configurable:!0,enumerable:!0,get:function(){return this.L_d||(this.L_d=Ef.a.instance.Hh("CommonUI.IBusinessBarEntryFactory"))}}});Object(td.a)(Bf,"SignOutResponseUI",
null,[3]);var ub=b(274);Qe.prototype.di=function(e){e.register(Uf,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").zc()};Qe.prototype.init=function(){};Qe.prototype.dispose=function(){jf.a.Fa(Qe.C1);Qe.C1=null};Qe.main=function(){ub.a.instance.mj(new Qe)};tl.Object.defineProperties(Qe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Qe.C1=null;Object(td.a)(Qe,"CommonAppUIPackage",null,[4,5]);var Dd=b(142);
Object(td.a)(He,"SharedSortCondition",null,[]);Object(td.a)(Md,"SharedSortOptions",null,[]);var be=b(843),Je=b(4),Cf=b(462),Jg=b(589),$g=b(52),Tg=b(1044),Dh=b(125),Mh=b(876),Oh=b(141),Li=b(126),Th=b(202),Rg=b(92),$h=b(69),gi=b(32),Ae=b(14),Xh=b(62),qi=b(127),h=b(211),Ab=b(901),jc=b(902),Oc=b(132),sd=b(48),we=b(34),Ue=b(414);Object(td.a)(od,"AutoFilterMenu",null,[]);Object(td.a)(Ec,"MenuItem",null,[]);Object(td.a)(Ob,"MenuSection",null,[]);Object(td.a)(Ba,"ApplyFilterByValueResponse",null,[]);Object(td.a)(gg,
"FilterByValueItem",null,[]);Object(td.a)(Qf,"GetColorsAndIconsResponse",null,[]);Object(td.a)(Xf,"GetFilterByValueItemsResponse",null,[]);Object(td.a)(ef,"ShowSortFilterMenuParams",null,[]);Object(td.a)(Od,"SortFilterControllerFactoryParams",null,[]);Object(td.a)(Ld,"TargetPoint",null,[]);var qe=b(335),ja=be.a;vm(Cd,ja);Cd.prototype.executeCommand=function(e,C,M){var ra=this;e=C.command;switch(e){case 1701016594:be.a.Prh(M);break;case 966232027:var Na=M.domEvent;if($h.e(Na.rawEvent)&&$h.e(Na.rawEvent)&&
($h.g(Na),Na.target&&(e=new Oh.a(this.$.xa),e.te(4096)||e.te(2048)))){var Ib=$g.a.li(M[pg.a.Kg]);this.nZf(Ib)&&(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.cif?(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5680883_trackInteractivityFilterMenuOnlySync")&&h.b(this.$).Jna(Na.rawEvent,"open_menu_auto_filter"),this.grc(Na,Na.target,Ib,C)):(this.HBd=function(){ra.nZf(Ib)&&(ra.t5h(),ra.grc(Na,Na.target,Ib,C),ra.w1a=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),ra.cif=!0)},this.ywc()):this.VN(Na,Na.target,Ib,C,!0))}break;default:return mg.a(e)}return wg.Task.Ta(!0)};Cd.prototype.Gc=function(e,C,M){if(e=!!M)switch(C.command){case 1701016594:case 966232027:Cf.a(this.$)||(e=!1,Fd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",sd.b().pi(C.command)));break;default:e=!1}return e};Cd.prototype.VN=function(e,C,M){Fd.ULS.shipAssertTag(537167136,0,!!M,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");
this.M_a=this.nDh(M);this.aw&&!M.IsHeaderSnapped?this.so(be.a.a$b(this.$,M.Cell,!0),!0):ja.prototype.VN.call(this,e,C,M,null,!0)};Cd.prototype.tBd=function(e){Array.addRange(e.MenuSectionList,this.M_a)};Cd.prototype.t5h=function(){var e=this;Ue.a(function(){e.iKb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Od,{getFilterByValueItemsRequest:e.MDi,applyFilterByValueRequest:e.Qyi,onMenuItemClick:e.onMenuItemClick,autoFilterMenuWidth:Cd.oqe,applySortByColorOrIconRequest:e.gGg}))});
this.C8c=Ef.a.instance.Hh("Common.IExternalUICommandDefinitionMapping")||new Jg.a(this.$.Ib,this.$)};Cd.prototype.grc=function(e,C,M){qi.b(this.$).ae(Dh.a.grc,this.dm(),void 0,!0);Fd.ULS.shipAssertTag(537167135,0,!!M,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");e=this.mDh(M);var ra=Sys.UI.DomElement.getBounds(C),Na=ra.x+ra.width;ra=ra.y;this.aw&&!M.IsHeaderSnapped&&(M=be.a.a$b(this.$,M.Cell,!0),Na=M.x,ra=M.y);M=$e.g(this.$).rtl?new Sys.UI.Point(Na-we.a(this.$).nFa(Cd.oqe),
ra):new Sys.UI.Point(Na,ra);this.ISa(M,C);M=we.a(this.$).OJa(M);C=Object.assign(new ef,{targetPoint:Object.assign(new Ld,{left:M.x,top:M.y}),autoFilterMenu:e});this.iKb.showSortFilterMenu(C);this.$.Ce(-544117314,-1,0,null)};Cd.prototype.nZf=function(e){return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&e.Cell.SheetName?$e.g(this.$).O4?e.Cell.SheetName===this.$.oa.name:e.Cell.SheetName===this.$.oa.sheetName:!0};Cd.prototype.mDh=function(e){return(e=
this.dUe(e))?this.TFf(e):null};Cd.prototype.TFf=function(e){for(var C=[],M=yl(e.Sections),ra=M.next();!ra.done;ra=M.next())ra=this.AUi(ra.value),Array.add(C,ra);return Object.assign(new od,{Id:e.Id,Sections:C})};Cd.prototype.AUi=function(e){for(var C=[],M=yl(e.MenuItems),ra=M.next();!ra.done;ra=M.next())if(ra=ra.value,2===ra.Identifier)this.PUc=ra.CommandData;else switch(ra.Type){case 3:case 2:Array.add(C,this.yUi(ra,2===ra.Type));break;case 1:Array.add(C,this.zUi(ra))}return Object.assign(new Ob,
{MenuItems:C,DisplayType:e.DisplayType,Id:this.LAh(e)})};Cd.prototype.zUi=function(e){var C=this.mTe(e);var M=C.label;var ra=C.HKa;C=this.TFf(e.SubMenu);var Na=this.aTe(e);ra=this.C8c.w$b(ra);M=M||e.Label;return Object.assign(new Ec,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Na,CommandData:e.CommandData,Label:M,SubMenu:C,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===ra?null:ra})};Cd.prototype.yUi=function(e,C){var M=this.g9b(e,C&&e.IsChecked);C=M.label;var ra=M.HKa;M=M.$o;var Na=
this.Lad(e,C);ra=this.C8c.w$b(ra);return Object.assign(new Ec,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Na,RibbonCommand:M,CommandData:e.CommandData,Label:C||e.Label,SubMenu:null,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===ra?null:ra})};Cd.prototype.dUe=function(e){var C;this.qSa=C=sg.C(e.Cell);this.sheetName=this.$.oa.sheetName;if(e.IsHeaderSnapped)C=Cf.a(this.$).U7b.nKh(C);else{var M=$e.g(this.$).Ca.oub(C);if(!M)return this.SLa?Ab.a.DPa(jc.a.hIf,Qg.a.UVh,Oc.a.BYa,!0,!1):
Fd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",C,$e.g(this.$).view.visibleArea),null;C=M.autoFilterMenu}if(!C)return this.SLa?Ab.a.DPa(jc.a.hIf,Qg.a.jsi,Oc.a.BYa,!0,!1):Fd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.$qb=e.Cell.FirstRow+"_"+e.Cell.FirstColumn;
return C};Cd.prototype.nDh=function(e){return(e=this.dUe(e))?this.eud(e.Sections):null};Cd.prototype.ywc=function(){var e=this;if(this.$.fa.Mh){var C=ud.GetServiceTaskFactory.Xa(this.$.da,283,284,1);xf.TaskExtensions.Ba(C,function(){e.SLa?C.result.wo.loadScript("sortFilter").then(function(){e.HBd()},function(M){Xh.a.km(M,"AutoFilterContextMenu.SortFilterScriptLoad");Ab.a.DPa(jc.a.ywc,Qg.a.Ovj,Oc.a.BYa,!1,!1)}):xf.TaskExtensions.Ba(qe.c(C.result.wo.loadScript("sortFilter")),function(){e.HBd()},e.$.ma,
3)},this.$.ma,3)}else this.$.fa.sn(this.aN)};Cd.prototype.c0g=function(e){var C={};C.SearchText=e;C.Page=1;C.DateNodeType=-1;return C};Cd.prototype.oQg=function(){this.zOa&&(Fd.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.zOa),vf.j(this.$.qa.ta,this.zOa,null,null,null),this.zOa=null);this.q9a&&(jd.AFrameworkApplication.Hd.Zt(this.q9a.kt),this.q9a=null)};Cd.prototype.dyd=function(e){var C=
this;return function(M){C.zOa=null;C.q9a=null;if(Ab.a.tvc(M)){var ra=Ab.a.x9b(M);C.SLa?Ab.a.DPa(e?jc.a.searchAutoFilterItemList:jc.a.getAutoFilterItemList,ra.MessageIdName,Oc.a.BYa,!0,!0):Fd.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",ra.MessageIdName)}if(!yh.a(M)){Fd.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");M=M.Result;ra=new gi.a(!0);var Na=M.AutoFilterDateNodes?
!0:!1;M.AutoFilterItems&&ra.add("AutoFilterItemsCount",M.AutoFilterItems.length);Na&&ra.add("AutoFilterDateItemsCount",M.AutoFilterDateNodes.length);ra.add("Location","contextMenu");qi.b(C.$).ae(Dh.a.dyd,ra.Nu,void 0,!0);ra=C.w1a?Object.assign(new Xf,{filterByValueItems:C.uze(M),hasMoreRecords:M.ItemListMaxExceeded,searchText:M.SearchText}):Object.assign(new Xf,{filterByValueItems:C.uze(M),hasMoreRecords:M.ItemListMaxExceeded});C.iKb.onGetFilterByValueItemsFinish(ra);!e&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",
!1)&&(Fd.ULS.shipAssertTag(529063959,0,null!==M.FontColors&&null!==M.CellColors&&null!==M.Icons&&null!==M.SelectedSortFontColors&&null!==M.SelectedSortCellColors&&null!==M.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),M=Object.assign(new Qf,{fontColors:M.FontColors,cellColors:M.CellColors,icons:M.Icons,selectedSortFontColor:0<M.SelectedSortFontColors.length?M.SelectedSortFontColors[0]:null,selectedSortCellColor:0<M.SelectedSortCellColors.length?
M.SelectedSortCellColors[0]:null,selectedSortIcon:0<M.SelectedSortIcons.length?M.SelectedSortIcons[0]:null,getColorName:C.getColorName}),C.iKb.onGetColorsAndIconsFinish(M))}}};Cd.prototype.NDi=function(){var e=this;return function(C){e.zOa=null;e.q9a=null;C=Li.a.yg(C.data);Fd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",mh.a.Uc(C))}};Cd.prototype.uze=function(e){var C=this.TYg(e),M=this.$Yg(e.AutoFilterItems),ra=[],Na=0;e.HasBlanks&&
(e=Cd.Y1c(Ae.a.instance.ea(762),e.IsBlanksSelected?1:0,Je.a.nqe),ra[Na++]=e);C=yl(C);for(e=C.next();!e.done;e=C.next())e=e.value,ra[Na++]=e;M=yl(M);for(e=M.next();!e.done;e=M.next())C=e.value,ra[Na++]=C;return ra};Cd.prototype.TYg=function(e){var C=[];if(!e.AutoFilterDateNodes||!e.AutoFilterDateNodes.length)return C;for(var M=[this.L2a(e.YearKeys,e.YearValues),this.L2a(e.MonthKeys,e.MonthValues),this.L2a(e.DayKeys,e.DayValues),this.L2a(e.HourKeys,e.HourValues),this.L2a(e.MinuteKeys,e.MinuteValues),
this.L2a(e.SecondKeys,e.SecondValues)],ra=!1,Na=!1,Ib=0,Gc=null,id=Array(6),Uc=null,Vd=yl(e.AutoFilterDateNodes),Ye=Vd.next();!Ye.done;Ye=Vd.next()){Ye=Ye.value;id[0]&&(Uc.Year!==Ye.Year?(ra=!0,Ib=0,Gc=null):Uc.Month!==Ye.Month?(Na=!0,Ib=1,Gc=id[0]):Uc.Day!==Ye.Day?(Ib=2,Gc=id[1]):e.ShowTime&&(Uc.Hour!==Ye.Hour?(Ib=3,Gc=id[2]):Uc.Minute!==Ye.Minute?(Ib=4,Gc=id[3]):(Ib=5,Gc=id[4])));for(;6>Ib;){switch(Ib){case 0:var Gf=Ye.Year;Uc=M[0].getItem(Gf.toString());break;case 1:Gf=Ye.Month;Uc=M[1].getItem(Gf.toString());
break;case 2:Gf=Ye.Day;Uc=M[2].getItem(Gf.toString());break;case 3:Gf=Ye.Hour;Uc=M[3].getItem(Gf.toString());break;case 4:Gf=Ye.Minute;Uc=M[4].getItem(Gf.toString());break;case 5:Gf=Ye.Second;Uc=M[5].getItem(Gf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Uc=Cd.Y1c(Uc,-1!==Ye.NodeType&&Ib>=Ye.NodeType?1:0,Gc?Gc.key+";"+Gf:Je.a.OVc+Gf,!1,[]);Gc=Gc?Gc.children:C;Gc=Gc[Gc.length]=Uc;id[Ib]=Uc;switch(Ib){case 5:Ib=6;break;case 2:Ib=e.ShowTime?Ib+1:6;break;
default:Ib++}}Uc=Ye}ra||(id[0].expanded=!0,Na||(id[1].expanded=!0));return C};Cd.prototype.$Yg=function(e){var C=[];if(!e)return C;var M=0;e=yl(e);for(var ra=e.next();!ra.done;ra=e.next())ra=ra.value,C[M++]=Cd.Y1c(ra.DisplayString,ra.Selected?1:0,Je.a.PVc+ra.DisplayString);return C};Cd.prototype.L2a=function(e,C){var M=new gi.a(!0);if(!e||!C)return M;for(var ra=e.length<C.length?e.length:C.length,Na=0;Na<ra;Na++)M.add(e[Na].toString(),C[Na]);return M};Cd.prototype.H1c=function(e,C){var M={};M.Location=
C;M.FieldId=e.Id.toString();M.DataSourceIndex=-1;M.FilterType=e.AutoFilterType;M.AnchorType=0;M.ChartId=null;M.AnchorValue1=-1;M.AnchorValue2=-1;M.Property=e.RichProperty;return M};Cd.prototype.ZK=function(e){ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(C){C.result.Pda(e);Fd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.ma,3)};Cd.prototype.dm=function(){var e={};return e.Location="contextMenu",e};Cd.prototype.getColorName=function(e){return Mh.a.JJa(Th.a.GG(e))};Cd.prototype.P_f=function(e){xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(this.$.da,309,310,3),function(C){C.result.dAa().continueWith(function(M){M.result&&e()})},this.$.ma,3)};Cd.Y1c=function(e,C,M,ra,Na){e=void 0===e?null:e;C=void 0===C?0:C;M=void 0===M?null:M;ra=void 0===ra?!1:ra;Na=void 0===Na?null:Na;return Object.assign(new gg,{displayText:e?
be.a.ym(e):e,state:C,key:M,parent:null,children:Na,indentationLevel:0,expanded:ra})};tl.Object.defineProperties(Cd.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.fIf}}});Cd.oqe=268;Object(td.a)(Cd,"AutoFilterContextMenu",be.a,[]);var Ka=b(850),qc=b(84),mc=b(185),Ed=b(66),pc=b(16);dd.YPe=26;dd.N9c=[229,230,0,98,0,94,93];Object(td.a)(dd,"Constants",null,[]);tl.Object.defineProperties(xc.prototype,
{uci:{configurable:!0,enumerable:!0,get:function(){return 3===this.k3b}},Pfi:{configurable:!0,enumerable:!0,get:function(){return 4===this.k3b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.ssg}},rmf:{configurable:!0,enumerable:!0,get:function(){return this.Vng}},k3b:{configurable:!0,enumerable:!0,get:function(){return this.Jig}},w3c:{configurable:!0,enumerable:!0,get:function(){return this.Nig}}});Object(td.a)(xc,"FiltersMenuData",null,[]);vm(Df,xc);Object(td.a)(Df,
"AutoFilterFiltersMenuData",xc,[]);Hg.UAj=[new xc(99,2,0,null),new xc(100,2,1,null),new xc(0,3,0,null),new xc(171,2,2,null),new xc(173,2,4,null),new xc(0,3,0,null),new xc(175,2,6,null),new xc(176,2,7,null),new xc(0,3,0,null),new xc(107,0,0,null)];Hg.jxi=[new xc(99,2,0,null),new xc(100,2,1,null),new xc(0,3,0,null),new xc(101,2,8,null),new xc(102,2,10,null),new xc(103,2,12,null),new xc(0,3,0,null),new xc(104,1,0,null),new Df(105,1),new Df(106,2),new xc(0,3,0,null),new xc(107,0,0,null)];Hg.M7g=[new xc(99,
2,0,null),new xc(0,3,0,null),new xc(111,2,10,null),new xc(112,2,8,null),new xc(103,2,12,null),new xc(0,3,0,null),new Df(109,8),new Df(108,9),new Df(110,10),new xc(0,3,0,null),new Df(114,11),new Df(113,12),new Df(115,13),new xc(0,3,0,null),new Df(116,14),new Df(117,15),new Df(118,16),new xc(0,3,0,null),new Df(119,17),new Df(120,18),new Df(121,19),new xc(0,3,0,null),new Df(122,20),new Df(123,21),new Df(124,22),new xc(0,3,0,null),new Df(125,23),new xc(126,2,12,[new Df(127,24),new Df(128,25),new Df(129,
26),new Df(130,27),new xc(0,3,0,null),new Df(131,28),new Df(132,29),new Df(133,30),new Df(134,31),new Df(135,32),new Df(136,33),new Df(137,34),new Df(138,35),new Df(139,36),new Df(140,37),new Df(141,38),new Df(142,39)]),new xc(0,3,0,null),new xc(107,0,0,null)];Object(td.a)(Hg,"Constants",null,[]);var K=b(19);yf.prototype.compare=function(e,C){return K.a.compare(e,C,!0)};Object(td.a)(yf,"IgnoreCaseComparer",null,[623]);var ha=b(72),H=be.a;vm(dg,H);dg.prototype.executeCommand=function(e,C,M){e=C.command;
switch(e){case -699941697:this.applyAutoFilterFieldList(C,M);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return mg.a(e)}return wg.Task.Ta(!0)};dg.prototype.Hbd=function(e,C){return!e||e.length<=C?(Fd.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(e[C])};dg.prototype.WCd=function(e,C,M,ra,Na,Ib){var Gc=this.Hbd(Na,Ib);0>Gc&&Fd.ULS.sendTraceTag(537167116,
0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(dd.N9c[Gc]){case 98:e=new Rg.a(-2058042992,C.method,C.mode,C.df,C.tabName);this.am.lG.lsb(this.$,ra,0,e);break;case 229:e=new Rg.a(504133448,C.method,C.mode,C.df,C.tabName);this.am.lG.lsb(this.$,ra,0,e);break;case 230:e=new Rg.a(-798968736,C.method,C.mode,C.df,C.tabName);this.am.lG.lsb(this.$,ra,0,e);break;case 231:e=new Rg.a(-1677817820,C.method,C.mode,C.df,C.tabName);this.am.lG.lsb(this.$,ra,0,e);break;case 94:this.gGf(e,
C,ra,M,Na,Ib+1);break;case 93:this.am.lG.Aji(this.$,ra)}};dg.prototype.gGf=function(e,C,M,ra,Na,Ib){var Gc=this.Hbd(Na,Ib);0>Gc&&Fd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ra||Gc>=ra.length)Fd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(ra=ra[Gc],ra.k3b){case 1:this.am.lG.Sji(this.$,M);break;case 2:(Na=Object(qc.a)(Df,ra))?(e=new Rg.a(-2058042992,C.method,
C.mode,C.df,C.tabName),this.am.lG.lsb(this.$,M,Na.pqe,e)):this.am.lG.Ugf(this.$,e,M,ra.w3c);break;case 0:this.am.lG.Ugf(this.$,e,M,ra.w3c);break;case 4:this.gGf(e,C,M,ra.subMenu,Na,Ib+1)}};dg.prototype.applyAutoFilterFieldList=function(e,C){var M=C[Ka.a.bI];if(M)if(M=M.split(Ed.a.jU),3>M.length)Fd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var ra=this.Hbd(M,1),Na=this.AJa(ra),Ib=this.lmf(ra).returnValue;Ib?
this.WCd(C,e,Ib,Na,M,2):Fd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+ra.toString()+Ed.a.jU)}else Fd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};dg.prototype.Gc=function(e,C){if(e=this.$.isEditMode)switch(C.command){case 216058793:break;case -699941697:break;case -1494291901:e=!0;break;default:e=!1}return e};dg.prototype.VN=function(e,
C,M){this.$.isEditMode&&((this.am=Object(qc.a)(615,M))||Fd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.yY(),H.prototype.VN.call(this,e,C,null,null,!0))};dg.prototype.Q1c=function(){if(!this.am||!this.am.Tk||1!==this.am.Tk.length)return Fd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var e=this.am.Tk[0],C=new mc.a;C.add(Ae.a.instance.ea(247));C=ha.OBc(ha.concat(C,
ha.select(ha.asEnumerable(e.FieldInfoDataList),function(M){return M.Name})),function(M){return M},new yf);return ha.toArray(C)};dg.prototype.fieldIndex=function(e){if(!this.am||!this.am.Tk||1!==this.am.Tk.length||!this.am.Tk[0].FieldInfoDataList)return-1;for(var C=0;C<this.am.Tk[0].FieldInfoDataList.length;++C)if(this.am.Tk[0].FieldInfoDataList[C].Name===e)return C;return-1};dg.prototype.AJa=function(e){return 0>e||!this.am||!this.am.Tk||1!==this.am.Tk.length||!this.am.Tk[0].FieldInfoDataList||this.am.Tk[0].FieldInfoDataList.length<
e?null:this.am.Tk[0].FieldInfoDataList[e].Name};dg.prototype.yY=function(){var e=this,C=this.Q1c();if(!C||!C.length)return null;for(var M=this.Sa,ra=M.Lc(),Na={},Ib=0;Ib<C.length;Na={Ueb:Na.Ueb},++Ib){var Gc=C[Ib];Na.Ueb=0<Ib?this.fieldIndex(Gc):-1;for(var id=dg.q1f+Na.Ueb.toString()+Ed.a.jU,Uc=null,Vd=this.am.lG.CZh(0<Ib?Gc:null),Ye=this.a2c(M,Vd,dg.q1f+Na.Ueb.toString(),Gc),Gf={},rg=0;rg<dd.N9c.length;Gf={LNb:Gf.LNb,Teb:Gf.Teb},++rg){var Dg=dd.N9c[rg],Eg=id+rg.toString();Uc||(Uc=M.Lc());switch(Dg){case 229:Array.add(Uc.buttons,
M.dd(223,Eg,-699941697,this.am.lG.Bfi(0<Ib?Gc:null)?pc.a.Hta:pc.a.D3,8,229,!1,null));break;case 230:Array.add(Uc.buttons,M.dd(224,Eg,-699941697,this.am.lG.Cfi(0<Ib?Gc:null)?pc.a.Ita:pc.a.E3,8,230,!1,null));break;case 231:Array.add(Uc.buttons,M.dd(225,Eg,-699941697,pc.a.T6b,1,231,!1,null));break;case 98:Dg=this.LMg(Gc);Eg=M.TGa(Eg+(Vd?".enabled":".disabled"),Dg,-699941697,null,"None",null,!Vd,void 0,!0);Eg.ER("Image16by16",8,pc.a.g1a);Array.add(Uc.buttons,Eg);break;case 94:Gf.LNb=void 0;Gf.Teb=void 0;
var Ch=function(kj,Lj){return function(){var Rj=e.lmf(kj.Ueb);Lj.LNb=Rj.hQe;Lj.Teb=Rj.isChecked;return Rj}}(Na,Gf)().returnValue;if(!Ch)return null;Dg=this.a2c(M,Gf.Teb&&Vd,Eg,Gf.LNb);Eg=this.tTe(Dg.menu,M,Eg+Ed.a.jU,Ch,Gf.Teb&&Vd);Array.add(Dg.menu.yc,Eg);Array.add(Uc.buttons,Dg);break;case 0:Uc&&(Array.add(Ye.menu.yc,Uc),Uc=null);break;default:Eg=M.TGa(Eg,Ae.a.instance.ea(Dg),-699941697,null,"None",null,!1,void 0,!0),this.GUf(Eg,Vd&&93===Dg&&this.am.lG.filter(),Ae.a.instance.ea(Dg)),Array.add(Uc.buttons,
Eg)}}Array.add(Ye.menu.yc,Uc);Array.add(ra.buttons,Ye)}C=M.zp(this.menuId);Array.add(C.yc,ra);return C};dg.prototype.tTe=function(e,C,M,ra,Na){for(var Ib=null,Gc=0;Gc<ra.length;++Gc){var id=ra[Gc],Uc=M+Gc.toString(),Vd=!1;switch(id.k3b){case 1:Vd=Na&&this.am.lG.Ih.IsTop10;break;case 2:Vd=Object(qc.a)(Df,id);Vd=Na&&this.am.lG.m$h(Vd?Vd.pqe:0,id.w3c);break;case 0:Vd=Na&&this.am.lG.Ih.IsCustomSupportedAndNotPresent}Ib||(Ib=C.Lc());if(id.uci)Ib&&(Array.add(e.yc,Ib),Ib=null);else if(id.Pfi){var Ye=Ae.a.instance.ea(id.rmf);
Ye=this.a2c(C,Vd,Uc,Ye);Array.add(Ye.menu.yc,this.tTe(Ye.menu,C,Uc+Ed.a.jU,id.subMenu,Vd));Array.add(Ib.buttons,Ye)}else id=Ae.a.instance.ea(id.rmf),Uc=C.TGa(Uc,id,-699941697,null,"None",null,!1,void 0,!0),this.GUf(Uc,Vd,id),Array.add(Ib.buttons,Uc)}return Ib};dg.prototype.GUf=function(e,C,M){C?e.ER("Image16by16",8,pc.a.jia):e.ER("None",0,null);e.CR(M);e.label=M};dg.prototype.a2c=function(e,C,M,ra){return C?e.S1c(M,this.menuId,ra,798637440,8,pc.a.jia):e.Kv(M,this.menuId,ra,798637440)};dg.prototype.yj=
function(e){return!e||!e.length};dg.prototype.lmf=function(e){var C=0>e?0:this.am.Tk[0].FieldInfoDataList[e].MajorityDataTypeForField;var M=null;e=this.am.lG.BZh(C);switch(C){case 0:M=95;C=Hg.UAj;break;case 1:M=94;C=Hg.jxi;break;case 2:M=96;C=Hg.M7g;break;default:return Fd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,hQe:M,isChecked:e}}M=Ae.a.instance.ea(M);return{returnValue:C,hQe:M,isChecked:e}};dg.prototype.LMg=function(e){!e||
this.yj(e.trim())?e=Ae.a.instance.ea(97):e.length>dd.YPe?(e=e.substring(0,dd.YPe),e=String.format(Ae.a.instance.Cb(154),e)):e=String.format(Ae.a.instance.Cb(155),e);return e};tl.Object.defineProperties(dg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.gIf}}});dg.Eth="AutoFilterFieldsContextMenu";dg.cHb="AutoFilterFieldListContextMenuRoot";dg.q1f="ApplyAutoFilterFieldList.";Object(td.a)(dg,
"AutoFilterFieldListContextMenu",be.a,[]);var aa=b(571),ea=b(977),ab=b(8),Vb=b(115),gc=b(370),$c=be.a;vm($f,$c);$f.prototype.executeCommand=function(e,C,M){e=Object(qc.a)(aa.a,M.eventArgs);switch(C.command){case -1372040782:M=$e.g(this.$).ha.Qa.nc;Fd.ULS.shipAssertTag(537167048,0,!!M);M&&(this.floatingObject=M.floatingObject,this.zb=C.method,C=this.$9b(e),this.so(C,!0,e.zb));break;case 848910589:e&&(C=[ea.a.QXf],e=new Sys.UI.Point(e.Ea.clientX,e.Ea.clientY),this.showFloatie(C,new Sys.UI.Bounds(e.x,
e.y,0,0),2))}return wg.Task.Ta(!0)};$f.prototype.Gc=function(e,C,M){switch(C.command){case -1372040782:return!!M&&this.eef(e);case 848910589:return e=$e.g(this.$).ha.Qa.nc,!!M&&!!e&&e.isEditing;default:return!1}};$f.prototype.eef=function(e){switch(e){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};$f.prototype.lSc=function(e,C,M){gc.a(this.$)?$e.g(this.$).$a.Zi||(we.a(this.$).KOd()?Array.add(M.buttons,e.yb(265)):Array.add(M.buttons,e.yb(264))):(this.$.isEditMode&&3===this.zb&&!this.w8b()&&
Array.add(M.buttons,e.yb(101)),5!==this.floatingObject.type||Vb.a.dH(this.floatingObject.Hb)||this.floatingObject.Hb.IsGroup||(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.mod()?Array.add(M.buttons,e.yb(186)):Array.add(M.buttons,e.yb(147))),this.w8b()||this.mod()||Array.add(M.buttons,e.yb(146)),ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.Nzh(M),this.kBh(M)),ld.EwaSettings.la(166)&&!this.floatingObject.type&&Array.add(M.buttons,
e.yb(249)),5===this.floatingObject.type&&$e.g(this.$).ha.Qa.nc.U4()&&this.$.gka&&this.$.Aga&&Array.add(M.buttons,e.yb(273)))};$f.prototype.BJa=function(e){var C=[];if(gc.a(this.$))return C;3===e?(e=!!this.$.ig.get(5)&&this.floatingObject.HRd(),this.w8b()||(this.$.isEditMode?(e&&Array.add(C,ea.a.Mwh),5===$e.g(this.$).ha.Qa.ZB.floatingObject.type&&Array.add(C,ea.a.mnj)):e&&Array.add(C,ea.a.copy)),Array.add(C,ea.a.Nwh)):2===e&&(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
$e.g(this.$).ha.Qa.nc&&this.jYe($e.g(this.$).ha.Qa.nc,C):this.jYe($e.g(this.$).ha.Qa.ZB,C));return C};$f.prototype.yY=function(){var e=this.Sa,C=e.zp(this.menuId),M=gc.a(this.$);if(this.$.isEditMode){var ra=e.Lc();this.lSc(e,C,ra);Array.add(C.yc,ra)}this.$.ig.get(5)&&this.floatingObject.HRd()&&!this.w8b()&&!M&&(ra=e.Lc(),this.kwg(e,ra),Array.add(C.yc,ra));!ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.floatingObject.type||this.$.fa.isNamedObjectViewMode||
M||(M=e.Lc(),this.dyg(e,M),Array.add(C.yc,M));return C};$f.prototype.$9b=function(e){var C=$e.g(this.$).ha.Qa.nc;e=e&&1!==e.zb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);var M=this.$.domElement,ra=$e.g(this.$).rtl;(C=ab.HelperMethods.sA(C.Bg.domElement,M,ra))?(e.y=Math.max(e.y,C.y),e.x=Math.max(e.x,C.x)):Fd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",
jd.AFrameworkApplication.Gg);return e};$f.prototype.mod=function(){var e=$e.g(this.$).ha.Qa.nc;return!!e&&e.isEditing};$f.prototype.kwg=function(e,C){if(this.$.isEditMode){Array.add(C.buttons,e.yb(42));Array.add(C.buttons,e.yb(43));var M=this.$.da.Aa(254,!0);(M&&2===M.vzb()||ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.mod())&&Array.add(C.buttons,e.yb(44))}else Array.add(C.buttons,e.yb(43))};$f.prototype.dyg=function(e,C){Array.add(C.buttons,e.yb(274))};$f.prototype.w8b=
function(){return ld.EwaSettings.la(486)&&!!$e.g(this.$).ha.Qa.Up};$f.prototype.jYe=function(e,C){5===e.floatingObject.type?ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&e.isEditing?Array.add(C,ea.a.QXf):Array.add(C,ea.a.inj):Array.add(C,be.a.kRe)};$f.prototype.Nzh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(282));Array.add(C.buttons,this.Sa.yb(281));var M=this.Sa.Kv("BringToFront","BringToFrontMenuId",Ae.a.instance.ea(802),-1777747317);Array.add(M.menu.yc,
C);Array.add(e.buttons,M)};$f.prototype.kBh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(284));Array.add(C.buttons,this.Sa.yb(283));var M=this.Sa.Kv("SendToBack","SendToBackMenuId",Ae.a.instance.ea(803),-1777747317);Array.add(M.menu.yc,C);Array.add(e.buttons,M)};tl.Object.defineProperties($f.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.oIf}}});Object(td.a)($f,"FloatingObjectContextMenu",
be.a,[]);var Zd=b(921),oe=b(96),Ee=b(578),pf=b(522);vm(lf,$f);lf.prototype.executeCommand=function(e,C,M){var ra=this.$;this.zb=C.method;C=M[lf.$Yc];if(!(e&68)){if(!C){if(8===e)C=pf.a(ra).Yc;else{var Na=$e.g(ra).ha.Qa.nc;if(null===Na||void 0===Na?0:Na.floatingObject)C=Na.floatingObject.Yc}if(!C)return wg.Task.Ta(!0)}this.isPivotChart=!!(C.Attributes&4)}if(this.isPivotChart||ra.isEditMode)if(this.refresh=this.UY=this.qva=this.bAa=!1,Na=$e.g(this.$).ha.Qa.nc,Fd.ULS.shipAssertTag(537167107,0,!!Na),Na){this.floatingObject=
Na.floatingObject;Na=Ee.a(ra);if(null===Na||void 0===Na?0:Na.gOd)this.bAa=Na=oe.f(ra.kg),this.qva=!Na;Na=ra.lc;this.UY=!!Zd.a(ra)&&!!C&&!!(C.Attributes&512)&&!(e&8)&&Na.m2(32768);Na.allowManualDataRefresh&&Na.allowInteractivity&&(this.refresh=!0);e=this.$9b(Object(qc.a)(aa.a,M.eventArgs));this.so(e,!0)}return wg.Task.Ta(!0)};lf.prototype.Gc=function(e,C,M){return-149612405===C.command&&!!M&&this.eef(e)};lf.prototype.lSc=function(e,C,M){this.isPivotChart&&(this.refresh&&Array.add(M.buttons,e.yb(100)),
this.UY&&Array.add(M.buttons,e.yb(99)),this.bAa?Array.add(M.buttons,e.yb(59)):this.qva&&Array.add(M.buttons,e.yb(58)));$f.prototype.lSc.call(this,e,C,M)};tl.Object.defineProperties(lf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.iIf}}});tl.Object.defineProperties(lf,{$Yc:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(td.a)(lf,"ChartContextMenu",$f,[]);var Le=
b(11),ng=be.a;vm(Mg,ng);Mg.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 330754562:C=M.domElement;this.isOlap=M.isOlap;this.bL=M.versionkey;this.Zn=M.fieldItem;this.wZ=M.isChart;this.lH=M.isPpm;this.JRd="supportsImplicitMeasures"in M?M.supportsImplicitMeasures:!1;$e.g(this.$).Dq(!0);e=Le.DOMElementExtensions.getBounds(C);e=new Sys.UI.Point(e.x+e.width,e.y+e.height/2);this.ISa(e,C);"isKeyboardInput"in M&&M.isKeyboardInput?this.so(e,!1,1):this.so(e,!1);break;case 926905850:this.JRd&&
this.Zn&&5===this.Zn.TypeTag&&!this.Zn.IsCollapsible&&Fd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Ee.a(this.$).xG(this.Zn,8,-1,this.bL,C);break;case -67292059:Ee.a(this.$).xG(this.Zn,1,-1,this.bL,C);break;case 745182485:Ee.a(this.$).xG(this.Zn,2,-1,this.bL,C);break;case 359279088:Ee.a(this.$).xG(this.Zn,4,-1,this.bL,C);break;case 547535945:Ee.a(this.$).nYi(this.Zn);break;default:return mg.a(e)}return wg.Task.Ta(!0)};Mg.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 330754562:e=
!!M;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:e=!0}return e};Mg.prototype.yY=function(){var e=this.Sa.zp(this.menuId);this.ZRi(e);this.wZ||this.isOlap||this.YRi(e);return e};Mg.prototype.ZRi=function(e){var C=this.Sa,M=C.Lc(),ra=!1;ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ra=this.isOlap&&!this.lH&&this.JRd&&5===this.Zn.TypeTag&&!this.Zn.IsCollapsible);3!==this.Zn.TypeTag&&37!==this.Zn.TypeTag||this.Zn.IsSet?17===
this.Zn.TypeTag||this.lH?(Array.add(M.buttons,C.yb(79)),Array.add(M.buttons,C.yb(this.wZ?91:80)),Array.add(M.buttons,C.yb(this.wZ?92:81)),Array.add(M.buttons,C.yb(82))):13===this.Zn.TypeTag||this.Zn.IsSet?(Array.add(M.buttons,C.yb(83)),Array.add(M.buttons,C.yb(this.wZ?91:80)),Array.add(M.buttons,C.yb(this.wZ?92:81)),Array.add(M.buttons,C.yb(86))):(Array.add(M.buttons,C.yb(79)),Array.add(M.buttons,C.yb(this.wZ?91:80)),Array.add(M.buttons,C.yb(this.wZ?92:81)),Array.add(M.buttons,C.yb(ra?82:86))):(Array.add(M.buttons,
C.yb(83)),Array.add(M.buttons,C.yb(this.wZ?93:84)),Array.add(M.buttons,C.yb(this.wZ?94:85)),Array.add(M.buttons,C.yb(82)));Array.add(e.yc,M)};Mg.prototype.YRi=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(78));Array.add(e.yc,C)};tl.Object.defineProperties(Mg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.dEd}}});Object(td.a)(Mg,"FieldListContextMenu",be.a,[]);var eg=b(408),
eh=b(59);rf.prototype.get=function(e,C,M){var ra=this.l7f(e,"PivotFilterContextMenuCache.Get");return ra&&this.TM[ra]?this.TM[ra][rf.Bdd(C,this.$,e,M)]:null};rf.prototype.set=function(e,C,M,ra){var Na=this.l7f(e,"PivotFilterContextMenuCache.Set");Na&&(this.TM[Na]||(this.TM[Na]={}),this.TM[Na][rf.Bdd(C,this.$,e,ra)]=M)};rf.prototype.rrb=function(e){e in this.TM&&this.TM[e]&&(this.TM[e]=null)};rf.prototype.l7f=function(e,C){return eh.f(this.$.oa)?this.$.activeItemName:(e=this.iFj(e,C))?e.Xd:null};rf.prototype.iFj=
function(e,C){e=sg.C(e);e=$e.g(this.$).Ca.Eua(e,this.$.activeItemName);Fd.ULS.shipAssertTag(537167008,0,!!e,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",C);return e};rf.Bdd=function(e,C,M,ra){return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&!ra?C.oa.index+"_"+e.id+"_"+M.FirstRow.toString()+"_"+M.FirstColumn.toString():C.oa.index+"_"+e.id};Object(td.a)(rf,
"PivotFilterContextMenuCache",null,[]);Object(td.a)(df,"ShowPivotFilterData",null,[]);var Yg=b(575),th=b(1278),rh=b(51),nf=be.a;vm(mf,nf);mf.prototype.L8c=function(e,C){var M=this,ra=e.rawEvent,Na=e.cell,Ib=e.requiresConfirmation;Yg.a(this.$).pu(Ib,function(Gc){if(Gc){Gc=ra?new Sys.UI.DomEvent(ra):null;M.pivotData=new df;M.pivotData.pivotName=e.pivotName;M.pivotData.dataSourceIndex=e.dataSourceIndex;M.pivotData.cell=Na;M.pivotData.mo=e.optionalPivotMenuAnchorParameter;if(M.pivotData.mo&&0<M.pivotData.mo.AnchorType){M.Fkc=
e.objectId;M.CBb=e.objectVersion;var id=M.pivotData.mo.AnchorType;if(4===id||5===id||6===id||11===id||9===id||10===id||8===id)M.nlb=e.location}else M.Bwd=M.Fkc=null,M.Cwd=M.CBb=-1;$e.g(M.$).Dq(!0);M.$.wj(Na);M.VN(Gc,Gc?Gc.target:e.domElement,M.pivotData,C,M.rLa())}});return!0};mf.prototype.VN=function(e,C,M,ra){var Na=this;if(Object(eg.a)(df,M)){this.pivotData=M;this.w3b=C;this.agf=e;this.y0b=this.pivotData.mo?this.pivotData.mo.AnchorValue1:-1;this.$X=this.pivotData.mo?this.pivotData.mo.AnchorType:
0;var Ib=!1,Gc=null;Gc=mf.TM.get(this.pivotData.cell,C,this.$X);Ib=!!Gc;var id=!0;switch(this.$X){case 4:case 5:case 6:this.vca=new Sys.UI.Point(this.nlb.x,this.nlb.y);id=!1;break;case 7:var Uc=Sys.UI.DomElement.getBounds(C);id=Uc.x+(0<=Uc.x?0:Uc.width);Uc=Uc.y+(0<=Uc.y?0:Uc.height);this.vca=new Sys.UI.Point(0<=id?id:0,0<=Uc?Uc:0);id=!1;break;case 8:case 10:case 9:case 11:this.vca=new Sys.UI.Point(this.nlb.x,this.nlb.y);break;default:this.vca=null}Ib&&this.Fkc===this.Bwd&&this.CBb===this.Cwd&&this.y0b===
this.ave&&this.$X===this.fne?(Fd.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.M_a=Gc,this.vca?(this.ISa(this.vca,C),this.so(this.vca,this.rLa())):this.aw?this.so(be.a.a$b(this.$,this.pivotData.cell,!1),this.rLa()):nf.prototype.VN.call(this,e,C,M,ra,this.rLa())):1!==mf.yIh(C)&&(id&&(C.parentNode.menuFetchStates=1,this.Ghj(C),this.pUf(!0)),this.$.userOperationManager.ic(new hg.a(126,0,function(Vd,Ye,Gf){var rg=Na.$;
return vf.z(rg.qa.ta,Na.pivotData.cell,Na.pivotData.dataSourceIndex,Na.pivotData.pivotName,rg.domElement.id,rg.isChromeRtl,rg.workbookContext.NovMode,hh.b(Vd,Na.$Di),hh.a(Ye,Na.ZDi),Gf,C,Na.pivotData.mo)},16),ra))}};mf.prototype.tBd=function(e){Array.addRange(e.MenuSectionList,this.M_a)};mf.prototype.Ctd=function(e,C){e.parentNode.menuFetchStates=2;this.pUf(!1);C&&(this.w3b!==e||this.ksi()?(this.ISa(this.vca,e),this.so(this.vca,this.rLa())):this.aw&&!this.vca?this.so(be.a.a$b(this.$,this.pivotData.cell,
!1),this.rLa()):nf.prototype.VN.call(this,this.agf,e,null,null,this.rLa()),this.Bwd=this.Fkc,this.Cwd=this.CBb,this.fne=this.$X,this.ave=this.y0b)};mf.prototype.rLa=function(){return 8!==this.$X&&9!==this.$X&&10!==this.$X&&11!==this.$X};mf.prototype.ksi=function(){switch(this.pivotData.mo?this.pivotData.mo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};mf.prototype.pUf=function(e){var C=this.w3b;if(C){if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var M=
Le.DOMElementExtensions.dZ(C,"ewaprevsrc","");M=!!M&&"null"!==M}else M=!!Le.DOMElementExtensions.dZ(C,"ewaprevsrc","");e&&M||!e&&!M||(e?(C.setAttribute("ewaprevsrc",C.src),C.src=rh.a.current.co(77)):(e=Le.DOMElementExtensions.dZ(C,"ewaprevsrc",""),C.src=e,C.setAttribute("ewaprevsrc",null)))}};mf.prototype.Ghj=function(e){this.w3b=e};mf.yIh=function(e){var C=e.parentNode.menuFetchStates;void 0===C&&(e.parentNode.menuFetchStates=0);return C};mf.TM=null;Object(td.a)(mf,"PivotFilterContextMenuBase",be.a,
[]);vm(me,mf);me.prototype.executeCommand=function(e,C,M){return this.L8c(M,C)?wg.Task.Ta(!0):mg.a(C.command)};me.prototype.Gc=function(e,C,M){return-1065117584===C.command&&!!M};tl.Object.defineProperties(me.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.mIf}}});Object(td.a)(me,"FieldListPivotContextMenu",mf,[]);var bh=b(28),xh=b(852);Object(td.a)(xe,"PivotValueFieldSettingsApplyData",null,
[]);zd.r7g="dataFieldCustomLabel";zd.dDe="dataFieldSourceLabel";zd.kuj="showValueAsSelect";zd.iuj="showValueAsBaseFieldSelect";zd.juj="showValueAsBaseItemSelect";zd.NWd="valueFieldsSettingsFieldName";zd.obg="valueFieldSettingTabs";Object(td.a)(zd,"CssElementIds",null,[]);var Ag=b(114);Object(td.a)(Rd,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);fd.prototype.getActiveCell=function(){return this.activeCell};Object(td.a)(fd,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[98]);var bi=
b(232);Object(td.a)(tc,"PivotValueFieldShowValueAsApplyData",null,[]);var Ti=b(853),Qi=b(39),jj=bi.a;vm(qb,jj);qb.prototype.oja=function(){return this.isVisible};qb.prototype.Uma=function(e){return this.isVisible=e};qb.prototype.setFocus=function(){Le.DOMElementExtensions.setFocus(this.d3.Gn)};qb.prototype.render=function(e){e.appendChild(this.domElement)};qb.prototype.dispose=function(){jf.a.pc([this.d3,this.qT,this.gP,this.X3b,this.OZb]);jj.prototype.dispose.call(this)};qb.prototype.lkj=function(e){jf.a.pc([this.X3b,
this.OZb]);this.d3.clear();for(var C=yl(e.DataFormatTypes),M=C.next();!M.done;M=C.next())M=M.value,this.d3.AL(qb.LGh(M),M.toString(),M===e.SelectedDataFormat);this.X3b=this.Nd.Cd(this.d3.domElement);this.X3b.ja("change",this.Csf);this.qT.clear();C=yl(e.BaseFieldList);for(M=C.next();!M.done;M=C.next())M=M.value,this.qT.AL(M.DisplayString,M.Id.toString(),M.Id===e.SelectedBaseField);this.OZb=this.Nd.Cd(this.d3.domElement);this.OZb.ja("change",this.ezi);this.RE=this.Cha.B_a(this.gP.Gn.parentNode,1E3,
null,"",720);this.Csf(null)};qb.prototype.qQ=function(e){this.d3.qQ(e);this.qT.qQ(e);this.gP.qQ(e)};qb.prototype.Kja=function(){this.domElement.innerHTML=String.format("<div id='showValueAsControlBody'><label for='showValueAsSelect' class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='showValueAsSelect' class='ewa-dlg-body-fullLine'></select></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseFieldSelect'>{1}</label><div><select size=6 id='showValueAsBaseFieldSelect' class='ewa-dlg-body-fullLine'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseItemSelect'>{2}</label><div><select size=6 id='showValueAsBaseItemSelect' class='ewa-dlg-body-fullLine'></select></div></div></div>",
Ae.a.instance.ea(1070),Ae.a.instance.ea(1071),Ae.a.instance.ea(1072));this.Q1d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,zd.kuj),!1);this.o_d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,zd.iuj),!1);this.p_d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,zd.juj),!1)};qb.prototype.cQg=function(e){return this.Mci||!qb.L9e(e)&&!qb.M9e(e)?!0:!!this.qT.count};qb.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var e=this;this.$.userOperationManager.ic(new hg.a(108,
0,function(C,M,ra){var Na=e.$.qa.ta,Ib=parseInt(e.qT.pe.value);C=hh.b.call(null,C,e.WEi);var Gc=vf.mb(Na,e.cell,e.externalSourceIndex,e.mo);Gc.selectedBaseField=Ib;return vf.i(Na,"GetPivotValueFieldSettingsShowValueAsBaseItems",Gc,C,M,ra,null,4)},16),this.ee)};qb.prototype.Hhf=function(){this.gP.clear();this.qT.pe&&(this.RE.jAa(),this.gP.Gn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};qb.prototype.dMb=function(e){var C=document.getElementById("WACDialogActionButton");
this.qKj&&C&&(C.disabled=e)};qb.LGh=function(e){switch(e){case 0:return Ae.a.instance.ea(1073);case 1:return Ae.a.instance.ea(1074);case 2:return Ae.a.instance.ea(1075);case 3:return Ae.a.instance.ea(1076);case 4:return Ae.a.instance.ea(1077);case 5:return Ae.a.instance.ea(1078);case 6:return Ae.a.instance.ea(1079);case 7:return Ae.a.instance.ea(1080);case 8:return Ae.a.instance.ea(1082);case 9:return Ae.a.instance.ea(1083);case 10:return Ae.a.instance.ea(1084);case 11:return Ae.a.instance.ea(1085);
case 12:return Ae.a.instance.ea(1086);case 13:return Ae.a.instance.ea(1087);case 14:return Ae.a.instance.ea(1088);default:return""}};qb.L9e=function(e){return 11===e||12===e||14===e||13===e||4===e};qb.M9e=function(e){return 1===e||3===e||2===e};tl.Object.defineProperties(qb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.ea(1069)}},zub:{configurable:!0,enumerable:!0,get:function(){var e=this.d3.pe?parseInt(this.d3.pe.value):-1,C=this.qT.pe?parseInt(this.qT.pe.value):
-1,M=this.gP.pe?parseInt(this.gP.pe.value):-1;return Object.assign(new tc,{SelectedDataFormat:0<=e?e:-1,SelectedBaseField:C,SelectedBaseItem:M})}},qT:{configurable:!0,enumerable:!0,get:function(){return this.o_d}},gP:{configurable:!0,enumerable:!0,get:function(){return this.p_d}},d3:{configurable:!0,enumerable:!0,get:function(){return this.Q1d}}});Object(td.a)(qb,"ShowValueAsControl",bi.a,[628,3]);Object(td.a)(Qa,"PivotValueFieldSummarizeValueByApplyData",null,[]);var vh=bi.a;vm(ih,vh);ih.prototype.oja=
function(){return this.isVisible};ih.prototype.Uma=function(e){return this.isVisible=e};ih.prototype.setFocus=function(){Le.DOMElementExtensions.setFocus(this.$k.Gn)};ih.prototype.render=function(e){e.appendChild(this.domElement)};ih.prototype.dispose=function(){jf.a.Fa(this.$k);vh.prototype.dispose.call(this)};ih.prototype.focus=function(){Le.DOMElementExtensions.setFocus(this.$k.Gn)};ih.prototype.kkj=function(e){this.$k.IQd();for(var C=yl(e.AggregationTypes),M=C.next();!M.done;M=C.next()){M=M.value;
var ra=M===e.SelectedAggregation;this.$k.iSc(ih.xCh(M),M.toString(),ra,"")}this.$k.x6c();this.$k.Gn.disabled=e.AggregationsDisabled};ih.prototype.K$i=function(){this.$k.L$i()};ih.prototype.Kja=function(){this.domElement.innerHTML=String.format("<div id='summarizeValuesByControlBody'><label class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='ewa-dlg-body-sectionlabel summarizeValuesByControlDescription'>{1}</div><div><select class='ewa-dlg-body-fullLine' size=6 id='pivotDataFieldSelect' style='width: 100%' aria-describedby='pivotDataFieldSelectDescription'></select></div></div>",
Ae.a.instance.ea(1053),Ae.a.instance.ea(1054));this.Xae=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,ih.qDf),!1)};ih.xCh=function(e){switch(e){case 0:return Ae.a.instance.ea(1056);case 1:return Ae.a.instance.ea(1057);case 2:return Ae.a.instance.ea(1058);case 3:return Ae.a.instance.ea(1059);case 4:return Ae.a.instance.ea(1060);case 5:return Ae.a.instance.ea(1061);case 6:return Ae.a.instance.ea(1062);case 7:return Ae.a.instance.ea(1063);case 8:return Ae.a.instance.ea(1064);case 9:return Ae.a.instance.ea(1065);
case 10:return Ae.a.instance.ea(1066);case 11:return Ae.a.instance.ea(1067);default:return""}};tl.Object.defineProperties(ih.prototype,{zub:{configurable:!0,enumerable:!0,get:function(){var e=this.$k.pe?parseInt(this.$k.pe.value):-1;return Object.assign(new Qa,{Aggregation:0<=e?e:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.ea(1068)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.$k.Gn.disabled},set:function(e){this.$k.Gn.disabled=!e}},$k:{configurable:!0,
enumerable:!0,get:function(){return this.Xae}}});ih.qDf="pivotDataFieldSelect";Object(td.a)(ih,"SummarizeValuesByControl",bi.a,[628,3]);var Bi=b(203),li=b(460);qf.prototype.Dzj=function(e,C){e.set_visible(!1);C.set_visible(!0)};Object(td.a)(qf,"DefaultTabSwitchBehaviour",null,[645]);Pg.pAj="TabsContainer";Pg.Zzj="TabTitlesContainer";Pg.Xzj="TabTitle";Pg.Yzj="TabTitleText";Pg.gSd="TabTitleActive";Object(td.a)(Pg,"MultitabControlStyles",null,[]);var T=b(40),Oa=b(91),Kb=b(89),ic=b(87);kh.prototype.dispose=
function(){T.a.removeHandler(this.Ci,"keyup",Object(xb.a)(this,this.R8a,"onTitleKeyUp"));T.a.removeHandler(this.Ci,"click",this.nEc);this.Ci=this.$ea=null};kh.prototype.setActive=function(e){e?Sys.UI.DomElement.addCssClass(this.Ci,Pg.gSd):Sys.UI.DomElement.removeCssClass(this.Ci,Pg.gSd);this.$ea&&this.$ea.setAttribute(Kb.a.Dga,e)};kh.prototype.R8a=function(e){e.keyCode!==Oa.a.$h&&e.keyCode!==Oa.a.iBa||this.nEc(e)};kh.prototype.qzc=function(){this.Ci.setAttribute(Kb.a.Sd,Kb.a.vs);this.$ea.setAttribute(Kb.a.Bv,
this.lp);this.$ea.setAttribute(Kb.a.Sd,Kb.a.enb)};tl.Object.defineProperties(kh.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Ci}},title:{configurable:!0,enumerable:!0,get:function(){return this.lp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Ci,Pg.gSd)},set:function(e){this.setActive(e)}}});Object(td.a)(kh,"TabTitleControl",null,[3]);var pd=b(47);vg.prototype.qNf=function(){this.Zkb=document.createElement("ul");
this.Zkb.className=Pg.Zzj;this.Pkb=document.createElement("div");this.Pkb.className=Pg.pAj;for(var e=0;e<this.xxc;++e){var C=this.NX.na(e),M=this.uEa.na(e);C.set_visible(!1);M.isActive=!1;var ra=document.createElement("div");C.render(ra);this.Pkb.appendChild(ra);this.Zkb.appendChild(M.Jb)}this.Jb.appendChild(this.Zkb);this.Jb.appendChild(this.Pkb);this.npd(this.S0)&&(this.uEa.na(this.S0).isActive=!0,this.NX.na(this.S0).set_visible(!0))};vg.prototype.dispose=function(){for(var e=0;e<this.xxc;++e)this.NX.na(e).dispose(),
this.uEa.na(e).dispose();this.uEa=this.NX=this.Ci=this.Pkb=this.Zkb=null};vg.prototype.setFocus=function(){this.NX.na(this.S0).setFocus()};vg.prototype.npd=function(e){return 0<=e&&e<this.xxc};vg.prototype.U3f=function(e){this.S0!==e&&this.npd(e)&&(this.zsg.Dzj(this.NX.na(this.S0),this.NX.na(e)),this.uEa.na(this.S0).isActive=!1,this.uEa.na(e).isActive=!0,this.S0=e,this.setFocus())};vg.prototype.t1g=function(e){var C=this;return function(){C.U3f(e)}};tl.Object.defineProperties(vg.prototype,{xxc:{configurable:!0,
enumerable:!0,get:function(){return this.NX.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.S0},set:function(e){this.U3f(e)}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.Ci}},visible:{configurable:!0,enumerable:!0,get:function(){return pd.a.isVisible(this.Ci)},set:function(e){this.Ci.style.visibility=e?"visible":"hidden"}}});Object(td.a)(vg,"MultitabControl",null,[627,3]);var Td=xh.a;vm(Sf,Td);Sf.prototype.dispose=function(){this.I3c=this.Dqb=this.sRa=
this.OPc=null;jf.a.Fa(this.kfa);this.kfa=null;Td.prototype.dispose.call(this)};Sf.prototype.initialize=function(){var e="<div id='"+zd.dDe+"' class='"+Ag.a.xu+"'></div><div id='"+zd.r7g+"' class='"+Ag.a.xu+"'><label for='"+zd.NWd+"'>{0}</label><input type='text' id='"+zd.NWd+"' value='{1}' class='"+Ag.a.uU+" UIFont' /></div><div id='"+zd.obg+"'></div>";e=String.format(e,Ae.a.instance.ea(1052),bh.a.If(this.nbg));this.Ob.innerHTML=e;this.Le||(this.e2(),this.Vk());this.Kge=[-103190598];this.nUh();Td.prototype.initialize.call(this)};
Sf.prototype.close=function(e){1===e&&(this.PZf=!1);Td.prototype.close.call(this,e)};Sf.prototype.iFe=function(e){this.vQ=e;this.domElement.disabled=e;for(var C=["input","option","select"],M=0,ra=C.length;M<ra;++M)for(var Na=this.domElement.getElementsByTagName(C[M]),Ib=0;Ib<Na.length;++Ib)Na[Ib].disabled=e};Sf.prototype.Vk=function(){this.Dqb=document.getElementById(zd.NWd);this.I3c=Le.DOMElementExtensions.getElementById(this.Ob,zd.dDe);var e=Le.DOMElementExtensions.getElementById(this.Ob,zd.obg);
this.OPc=new ih(document.createElement("div"));this.sRa=new qb(document.createElement("div"),this.$,this.cell,this.mo,this.externalSourceIndex,this.ee,this.Cha,!this.isOlap);var C;this.kfa=new vg(e,(C=new mc.a,C.add(this.URa),C.add(this.sRa),C));this.kfa.qNf()};Sf.prototype.moc=function(){var e=new Sf(this.cell,this.mo,this.externalSourceIndex,this.nbg,this.$,this.ee,this.Cha,this.isOlap,this.lH);e.initialize();e.nf()};Sf.prototype.ZSa=function(){var e=new li.a;if(!this.PZf)return e.isValid=!0,e;
this.Dqb.value.length?e.isValid=!0:(this.iFe(!0),e.error=mh.a.jd(1,0,735,750,0,1783218700,"PivotTableValueFieldNoBlank"),this.vQ=!0,this.Le||(this.Zw.disabled=!0),e.isValid=!1);return e};Sf.prototype.F2e=function(){this.vQ=!1;this.Le||(this.Zw.disabled=!1);this.iFe(!1)};Sf.prototype.Lxa=function(e){var C=new Rg.a(2105621672,0,this.$.ed,30,null);this.$.Ka.Zb(C);this.nW(5,e.zb,"Number Format");return!0};Sf.prototype.lm=function(){this.FAa=String.format(Ae.a.instance.Cb(60),null);Td.prototype.lm.call(this)};
Sf.prototype.setFocus=function(){if(this.Le){var e=Le.DOMElementExtensions.getElementById(this.Ob,ih.qDf);Bi.a.Pyc(e)}else this.kfa.setFocus()};Sf.prototype.Wl=function(){var e=this,C=this.sRa.zub,M=new Rd(C.SelectedDataFormat,C.SelectedBaseField,C.SelectedBaseItem);return function(){return new fd(e.externalSourceIndex,e.cell,e.Dqb.value,e.URa.zub.Aggregation,M)}};Sf.prototype.Uw=function(){var e=this,C=Object.assign(new xe,{PivotValueFieldSummarizeValueByApplyData:this.URa.zub,PivotValueFieldShowValueAsApplyData:this.sRa.zub,
PivotValueFieldTitle:this.Dqb.value});return function(M,ra,Na){var Ib=e.$.qa.ta;M=hh.b(M,e.Uyi);var Gc=vf.mb(Ib,e.cell,e.externalSourceIndex,e.mo);Gc.pivotValueFieldSettingsApplyData=C;return vf.i(Ib,"ApplyPivotValueFieldSettings",Gc,M,ra,Na,null,0)}};Sf.prototype.qQ=function(e){var C=this;this.$.da.Za(40,function(){C.sRa.qQ(e)})};Sf.prototype.nUh=function(){var e=this;this.$.userOperationManager.ic(new hg.a(123,0,function(C,M,ra){var Na=e.$.qa.ta;C=hh.b.call(null,C,e.VEi);var Ib=vf.mb(Na,e.cell,
e.externalSourceIndex,e.mo);return vf.i(Na,"GetPivotValueFieldSettingsInitial",Ib,C,M,ra,null,4)},16),this.ee)};tl.Object.defineProperties(Sf.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},bea:{configurable:!0,enumerable:!0,get:function(){return this.Kge}},$Ab:{configurable:!0,enumerable:!0,get:function(){return this.kfa}},URa:{configurable:!0,enumerable:!0,get:function(){return this.OPc}},Cw:{configurable:!0,enumerable:!0,get:function(){return 560}}});
Object(td.a)(Sf,"ValueFieldSettingsDialog",xh.a,[]);var Gd=be.a;vm(We,Gd);We.prototype.executeCommand=function(e,C,M,ra){var Na=this;e=C.command;switch(e){case -1453503574:ra=M.domElement;this.Zn=M.fieldItem;this.XXd=M.zoneCount;this.ERa=M.sourceAxis;this.Awc=M.sourceAxisPos;this.mo=M.optionalPivotMenuAnchorParameter;this.bL=M.versionkey;this.isOlap=M.isOlap;this.lH=M.isPpm;this.t1a="fieldItemsupportsImplicitMeasures"in M?M.fieldItemsupportsImplicitMeasures:!1;this.cell=M.cell;this.externalSourceIndex=
M.externalSourceIndex;$e.g(this.$).Dq(!0);e=Le.DOMElementExtensions.getBounds(ra);var Ib=new Sys.UI.Point(e.x,e.y+e.height);this.$.isChromeRtl&&(Ib.x+=e.width);this.ISa(Ib,ra);"isKeyboardInput"in M&&M.isKeyboardInput?this.so(Ib,!1,1):this.so(Ib,!1);break;case 495005930:Ee.a(this.$).Bah();break;case -1170196828:Ee.a(this.$).xG(this.Zn,this.ERa,this.Awc-1,this.bL,C);break;case -889576107:Ee.a(this.$).xG(this.Zn,this.ERa,this.Awc+2,this.bL,C);break;case 2033235475:Ee.a(this.$).xG(this.Zn,this.ERa,this.XXd,
this.bL,C);break;case 389774337:Ee.a(this.$).xG(this.Zn,this.ERa,0,this.bL,C);break;case -96230454:Ee.a(this.$).xG(this.Zn,4,-1,this.bL,C);break;case 74086617:Ee.a(this.$).xG(this.Zn,1,-1,this.bL,C);break;case 1529312473:Ee.a(this.$).xG(this.Zn,2,-1,this.bL,C);break;case 563292088:this.t1a&&Fd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Ee.a(this.$).xG(this.Zn,8,-1,this.bL,C);break;case -1092351914:Ee.a(this.$).xG(this.Zn,0,-1,this.bL,C);break;case -2141589616:var Gc=
ud.GetServiceTaskFactory.Xa(this.$.da,12,477,ra.gja());return xf.TaskExtensions.Ba(Gc,function(){(new Sf(Na.cell,Na.mo,Na.externalSourceIndex,Na.Zn.Name,Na.$,C,Gc.result,Na.isOlap,Na.lH)).initialize()},this.ma);default:return mg.a(e)}return wg.Task.Ta(!0)};We.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case -1453503574:e=!!M;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:e=
!0}return e};We.prototype.yY=function(){var e=this.Sa.zp(this.menuId);this.dSi(e,this.Awc,this.XXd);this.eSi(e,this.ERa);this.fSi(e);8===this.ERa&&this.bSi(e);return e};We.prototype.dSi=function(e,C,M){var ra=this.Sa,Na=ra.Lc();C||C!==M-1?!C&&C<M-1?(Array.add(Na.buttons,ra.yb(64)),Array.add(Na.buttons,ra.yb(61)),Array.add(Na.buttons,ra.yb(66)),Array.add(Na.buttons,ra.yb(63))):0<C&&C<M-1?(Array.add(Na.buttons,ra.yb(60)),Array.add(Na.buttons,ra.yb(61)),Array.add(Na.buttons,ra.yb(62)),Array.add(Na.buttons,
ra.yb(63))):0<C&&C===M-1&&(Array.add(Na.buttons,ra.yb(60)),Array.add(Na.buttons,ra.yb(65)),Array.add(Na.buttons,ra.yb(62)),Array.add(Na.buttons,ra.yb(67))):(Array.add(Na.buttons,ra.yb(64)),Array.add(Na.buttons,ra.yb(65)),Array.add(Na.buttons,ra.yb(66)),Array.add(Na.buttons,ra.yb(67)));Array.add(e.yc,Na)};We.prototype.eSi=function(e,C){var M=this.Sa,ra=M.Lc(),Na=1!==C&&(!this.isOlap||this.lH||8!==C||this.t1a),Ib=2!==C&&(!this.isOlap||this.lH||8!==C||this.t1a),Gc=8!==C&&-2!==this.Zn.PivotTableIndex&&
(!this.isOlap||this.lH||this.t1a);Array.add(ra.buttons,M.yb(4===C||this.Zn.IsSet||-2===this.Zn.PivotTableIndex||this.isOlap&&!this.lH&&8===C&&!this.t1a?72:68));8===this.mo.AnchorType||10===this.mo.AnchorType?(Array.add(ra.buttons,M.yb(Na?95:97)),Array.add(ra.buttons,M.yb(Ib?96:98))):(Array.add(ra.buttons,M.yb(Na?69:73)),Array.add(ra.buttons,M.yb(Ib?70:74)));Array.add(ra.buttons,M.yb(Gc?71:75));Array.add(e.yc,ra)};We.prototype.fSi=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(76));
Array.add(e.yc,C)};We.prototype.bSi=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(77));Array.add(e.yc,C)};tl.Object.defineProperties(We.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.eEd}}});Object(td.a)(We,"FieldWellContextMenu",be.a,[]);var ge=b(1244);vm(Ve,mf);Ve.prototype.executeCommand=function(e,C,M){var ra=!1,Na=C.command;switch(Na){case 37023044:ra=this.L8c(M,C);
break;case 541421805:case -569786022:ra=this.Pgd(e,C)}return ra?wg.Task.Ta(!0):mg.a(Na)};Ve.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 37023044:e=!!M;break;case 541421805:case -569786022:e=!0}return e};Ve.prototype.Pgd=function(e,C){var M=8===e,ra=this.$,Na=pf.a(ra),Ib=$e.g(ra).ha.Qa.nc,Gc=e=null;M&&Na?(e=Na.chartId,Gc=Na.Yc):!M&&Ib&&(e=Ib.floatingObject.id,Gc=Ib.floatingObject.Yc);return Ve.Zoe(Gc,260)?(M={},ra.wj(M),M.FirstColumn=M.FirstRow=-1,ra={},Gc=(ra.rawEvent=null,ra.pivotName=
null,ra.cell=M,ra.requiresConfirmation=Ve.Zoe(Gc,64),ra.dataSourceIndex=Gc.ExternalSourceIndex,ra),Ib?(Na=Ib.floatingObject,Gc.domElement=Ib.domElement,Gc.objectId=Na.id,Gc.objectVersion=Na.version):Na&&(Gc.domElement=Na.Wj,Gc.objectId=Na.chartId,Gc.objectVersion=Na.cve),Ib={AnchorType:7},Ib.ChartId=e,Ib.AnchorValue1=-1,Ib.AnchorValue2=-1,Gc.optionalPivotMenuAnchorParameter=Ib,this.L8c(Gc,C)):!1};Ve.Zoe=function(e,C){return(e.Attributes&C)===C};tl.Object.defineProperties(Ve.prototype,{Kt:{configurable:!0,
enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.sIf}}});Object(td.a)(Ve,"PivotFilterContextMenu",mf,[]);var Pe=b(1276),gf=b(976),kg=b(150),cg=b(41),Wg=b(26),tg=be.a;vm(Tf,tg);Tf.prototype.executeCommand=function(e,C,M){C=C.command;e=null;this.grid=$e.g(this.$);this.activeCell=sg.o(this.grid.ha.va.activeCell,this.$);if(this.$.isEditMode&&(this.Wc=this.grid.Vb.nq(this.grid.ha.va.activeCell),!this.Wc))return Fd.ULS.sendTraceTag(537167007,
0,10,"No PivotTable range found."),xf.TaskExtensions.f4();this.aBc=this.$.qa.ta;this.q_a=Object(qc.a)(aa.a,M.eventArgs);switch(C){case 671488277:!this.$.isEditMode||this.Wc.Jec||this.Wc.Efc()&&!this.OYf(!1)?(this.sab(),this.showPivotTableContextMenu()):this.hOh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.VQa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.VQa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.VQa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.VQa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.VQa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.VQa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:M=Number.parseInvariant(M.MenuItemId.split(".")[2]);this.VQa(11,M);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Ce(-1556797033,pg.a.Wb,8,null);break;case 1514686611:this.Gji();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:M=Number.parseInvariant(M.MenuItemId);this.VTg(M);break;case 1778578888:M=Number.parseInvariant(M.MenuItemId);
this.SFg(M);break;default:e=mg.a(C)}return e||xf.TaskExtensions.f4()};Tf.prototype.Gc=function(e,C){e=!1;switch(C.command){case 671488277:e=gf.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:e=!0;break;case 1600778266:e=!0;break;case -556893687:e=!0;break;case -1966978671:e=!0;break;case -1951357930:e=!0;break;case -1390365353:case -1457478532:e=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:e=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:e=!0;break;case -1007663920:case 234234584:case 1194992911:e=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:e=!0}return e};Tf.prototype.Xc=function(e,C){var M=!1;switch(C){case -1007663920:case 234234584:M=this.Soj();break;case 1194992911:M=this.Toj();break;case 1217404289:M=!Pe.j(this.Bb.LabelOrDateFilterType);
break;case -743135194:M=!Pe.m(this.Bb.ValueFilterType)&&!Pe.l(this.Bb.ValueFilterType);break;case 771421327:M=!this.Bb.LabelOrDateFilterType&&!this.Bb.ValueFilterType&&!this.Bb.HasManualFilter;break;case 1015867427:M=!Pe.i(this.Bb.LabelOrDateFilterType);break;case 1105960559:M=!Pe.k(this.Bb.LabelOrDateFilterType)}return M||tg.prototype.Xc.call(this,e,C)};Tf.prototype.sab=function(){this.O9a=this.Bb=this.Yf=null};Tf.prototype.sRd=function(){this.grid.gT(this.Ms);this.$.Ka.cFa(this.Jt)};Tf.prototype.XUd=
function(){this.grid.wN(this.Ms);this.$.Ka.Y$a(this.Jt)};Tf.prototype.oIb=function(){if(this.Wc&&this.Wc.Do){this.Yf=this.Wc.Do;this.Bb=this.Wc.f$b();if(this.BZf()){var e=this.Wc.JK[4===this.Yf.CellType?this.Wc.L3c-1:this.Yf.CurrentFieldIndex-1];e&&(this.O9a=-2===e.Index?this.Wc.iDe:e.Caption)}this.B3h();this.Bb&&8===this.Yf.CellArea&&(this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Bb.DataFieldAggregationType,this.Cz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Bb.DataFieldFormatType,
this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Bb.BaseFieldIndex,this.Cz.PivotValueFieldTitle=this.Bb.Caption)}};Tf.prototype.OYf=function(e){if(!this.Wc)return!1;e=this.Wc.isOlap&&!this.Wc.i6a(!e);return ld.EwaSettings.la(607)&&e};Tf.prototype.$oj=function(){var e=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Bb.MeasureType&&(!this.Wc.$cf||e&&2===this.Bb.MeasureType)};Tf.prototype.yY=function(){var e=this.Sa.zp(this.menuId),
C=this.Sa.Lc();if(this.Wc)this.Yf&&this.Wc.Do&&this.Yf!==this.Wc.Do&&Fd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Bb&&this.Bb!==this.Wc.f$b()&&Fd.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return e;this.Qzh(e);if(this.$.isEditMode){this.refresh&&this.dBh(e);if(this.Yf&&this.Bb){var M=this.Sa.Lc();this.sBh(M);this.eAh(M);Array.add(e.yc,M)}this.UY&&Array.add(C.buttons,this.Sa.yb(99));
this.Yf&&this.Bb&&this.AAh(e);if(this.expandCollapse){M=this.Sa.Kv("ContextMenu.PivotExpandCollapse",null,Ae.a.instance.ea(1117),589118293);var ra=this.Sa.Lc();Array.add(ra.buttons,this.Sa.yb(243));Array.add(ra.buttons,this.Sa.yb(244));Array.add(ra.buttons,this.Sa.yb(245));Array.add(ra.buttons,this.Sa.yb(246));Array.add(M.menu.yc,ra);M&&0<ra.buttons.length&&Array.add(C.buttons,M)}this.Yf&&this.eBh(e);this.Yf&&this.Bb&&8===this.Yf.CellArea&&8!==this.Yf.CellType&&(M=this.Sa.Lc(),this.$oj()&&this.uBh(M),
3!==this.Yf.CellType&&this.pBh(M),Array.add(e.yc,M));!this.Wc.Efc()&&this.Yf&&0===this.Yf.CellType&&ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.oBh(e);ld.EwaSettings.la(324)&&(this.udi()?Array.add(C.buttons,this.Sa.yb(257)):Array.add(C.buttons,this.Sa.yb(258)));this.Zld?Array.add(C.buttons,this.Sa.yb(59)):Array.add(C.buttons,this.Sa.yb(58))}Array.add(e.yc,C);return e};Tf.prototype.OOd=function(){return this.Bb&&this.Bb.Caption?20<this.Bb.Caption.length:
!1};Tf.prototype.ucd=function(e){return this.Bb&&this.Bb.Caption?e?this.Bb.Caption.substring(0,20)+"...":this.Bb.Caption:""};Tf.prototype.Gua=function(e){return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?K.a.hashCode(e).toString():e};Tf.prototype.sBh=function(e){if(this.Yf&&this.Bb&&4!==this.Yf.CellArea){var C=this.jua(this.KG("PivotTableContextMenu.Sort",this.Gua(this.Bb.Caption)),-1777747317,0,!!this.Bb.SortInfo,Ae.a.instance.ea(228)),M=this.Sa.Lc();Array.add(M.buttons,
this.$d("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Bb.SortInfo,Ae.a.instance.ea(229)));Array.add(M.buttons,this.$d("PivotTableContextMenu.SortDescending",234234584,0,2===this.Bb.SortInfo,Ae.a.instance.ea(230)));1!==this.Yf.CellArea&&2!==this.Yf.CellArea||Array.add(M.buttons,this.$d("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Bb.SortInfo||4===this.Bb.SortInfo,Ae.a.instance.ea(155)));Array.add(C.menu.yc,M);C&&0<M.buttons.length&&Array.add(e.buttons,C)}};Tf.prototype.eAh=
function(e){if(this.Yf&&this.Bb&&(1===this.Yf.CellArea||2===this.Yf.CellArea)){var C=this.nqj(),M=this.jua(this.KG("PivotTableContextMenu.Filter",this.Gua(this.Bb.Caption)),-1777747317,0,C,Ae.a.instance.ea(641)),ra=this.Sa.Lc(),Na="",Ib=this.OOd(),Gc=String.format(Ae.a.instance.Cb(155),this.ucd(Ib));Ib&&(Na=String.format(Ae.a.instance.Cb(155),this.Bb.Caption));C=this.Gua(this.Bb.Caption)+"."+(C?"enabled":"disabled");Na=this.$d(this.KG("PivotTableContextMenu.ClearFilter",C),771421327,0,!1,Gc,"0",Na,
8,pc.a.g1a);C=this.Gua(this.Bb.Caption)+"."+this.Bb.LabelOrDateFilterType.toString();this.Bb.IsDateField?(Gc=this.jua(this.KG("PivotTableContextMenu.DateFilter",C),-1777747317,0,!!this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(96)),this.Tzh(Gc.menu)):(Gc=this.jua(this.KG("PivotTableContextMenu.LabelFilter",C),-1777747317,0,!!this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(639)),this.zAh(Gc.menu));C=this.Gua(this.Bb.Caption)+"."+this.Bb.ValueFilterType.toString();C=this.jua(this.KG("PivotTableContextMenu.ValueFilter",
C),-1777747317,0,!!this.Bb.ValueFilterType,Ae.a.instance.ea(640));this.GBh(C.menu);Ib=this.Sa.Lc();Array.add(Ib.buttons,this.$d("PivotTableContextMenu.ManualFilter",1514686611,0,this.Bb.HasManualFilter,Ae.a.instance.ea(93)));Array.add(ra.buttons,Na);Array.add(ra.buttons,Gc);Array.add(ra.buttons,C);Array.add(M.menu.yc,ra);Array.add(M.menu.yc,Ib);M&&0<ra.buttons.length&&Array.add(e.buttons,M)}};Tf.prototype.Tzh=function(e){Array.add(e.yc,this.E$b(!0,!1));Array.add(e.yc,this.PGh());Array.add(e.yc,this.OGh());
Array.add(e.yc,this.DIh());Array.add(e.yc,this.GIh());Array.add(e.yc,this.EIh());Array.add(e.yc,this.FIh());Array.add(e.yc,this.HIh());Array.add(e.yc,this.IIh());Array.add(e.yc,this.CGh())};Tf.prototype.Kzh=function(e){Array.add(e.yc,this.E$b(!0,!0));Array.add(e.yc,this.dPh());Array.add(e.yc,this.AMh())};Tf.prototype.zAh=function(e){Array.add(e.yc,this.E$b(!0,!1));Array.add(e.yc,this.iWe(!0));Array.add(e.yc,this.sDh());Array.add(e.yc,this.LFh());Array.add(e.yc,this.hVe(!0));Array.add(e.yc,this.mUe(!0))};
Tf.prototype.GBh=function(e){Array.add(e.yc,this.E$b(!1,!1));Array.add(e.yc,this.iWe(!1));Array.add(e.yc,this.hVe(!1));Array.add(e.yc,this.mUe(!1));Array.add(e.yc,this.oTh())};Tf.prototype.oTh=function(){var e=this.Sa.Lc();Array.add(e.buttons,this.$d("PivotTableContextMenu.Top10",-1611233597,0,Pe.l(this.Bb.ValueFilterType),Ae.a.instance.ea(104)));return e};Tf.prototype.LFh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Contains",786260386,0,10===this.Bb.LabelOrDateFilterType,
Ae.a.instance.ea(642),"10")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(643),"11")));return e};Tf.prototype.sDh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(644),"6")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(645),
"7")),Array.add(e.buttons,this.$d("PivotTableContextMenu.EndsWith",786260386,0,8===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(646),"8")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(647),"9")));return e};Tf.prototype.iWe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.Equals",M),786260386,0,e?4===this.Bb.LabelOrDateFilterType:18===this.Bb.ValueFilterType,
Ae.a.instance.ea(99),e?"4":"18"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.DoesNotEqual",M),786260386,0,e?5===this.Bb.LabelOrDateFilterType:19===this.Bb.ValueFilterType,Ae.a.instance.ea(100),e?"5":"19"))}return C};Tf.prototype.hVe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.GreaterThan",M),786260386,0,e?12===this.Bb.LabelOrDateFilterType:20===this.Bb.ValueFilterType,Ae.a.instance.ea(101),e?"12":"20"));Array.add(C.buttons,
this.$d(this.KG("PivotTableContextMenu.GreaterThanOrEqualTo",M),786260386,0,e?13===this.Bb.LabelOrDateFilterType:21===this.Bb.ValueFilterType,Ae.a.instance.ea(648),e?"13":"21"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.LessThan",M),786260386,0,e?14===this.Bb.LabelOrDateFilterType:22===this.Bb.ValueFilterType,Ae.a.instance.ea(102),e?"14":"22"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.LessThanOrEqualTo",M),786260386,0,e?15===this.Bb.LabelOrDateFilterType:23===this.Bb.ValueFilterType,
Ae.a.instance.ea(649),e?"15":"23"))}return C};Tf.prototype.mUe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.Between",M),786260386,0,e?16===this.Bb.LabelOrDateFilterType:24===this.Bb.ValueFilterType,Ae.a.instance.ea(103),e?"16":"24"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.NotBetween",M),786260386,0,e?17===this.Bb.LabelOrDateFilterType:25===this.Bb.ValueFilterType,Ae.a.instance.ea(650),e?"17":"25"))}return C};
Tf.prototype.E$b=function(e,C){var M=this.Sa.Lc();if(this.Bb){var ra=Ae.a.instance.ea(97),Na=e?this.Bb.LabelOrDateFilterType.toString():this.Bb.ValueFilterType.toString(),Ib=["PivotTableContextMenu.ClearFilter",this.Gua(this.Bb.Caption),Na];e=e?this.Bb.IsDateField?C?1015867427:1105960559:1217404289:-743135194;Ib.push(e.toString());ra=this.$d(Ib.join("."),e,0,!1,ra,Na,ra,8,pc.a.g1a);Array.add(M.buttons,ra)}return M};Tf.prototype.PGh=function(){var e=this.Sa.Lc();this.Bb&&Array.add(e.buttons,this.$d(this.KG("PivotTableContextMenu.Equals",
Pe.d),786260386,0,26===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(99),"26"));return e};Tf.prototype.OGh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Before",786260386,0,27===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(111),"27")),Array.add(e.buttons,this.$d("PivotTableContextMenu.After",786260386,0,28===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(112),"28")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Between",786260386,0,29===this.Bb.LabelOrDateFilterType,
Ae.a.instance.ea(103),"29")));return e};Tf.prototype.DIh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(109),"30")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Today",1778578888,0,31===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(108),"31")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(110),
"32")));return e};Tf.prototype.GIh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(114),"33")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(113),"34")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(115),"35")));return e};Tf.prototype.EIh=
function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(116),"36")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(117),"37")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(118),"38")));return e};Tf.prototype.FIh=function(){var e=
this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(119),"39")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(120),"40")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(121),"41")));return e};Tf.prototype.HIh=function(){var e=this.Sa.Lc();
this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextYear",1778578888,0,42===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(122),"42")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(123),"43")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastYear",1778578888,0,44===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(124),"44")));return e};Tf.prototype.IIh=function(){var e=this.Sa.Lc();if(this.Bb){Array.add(e.buttons,
this.$d("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(125),"45"));var C=this.jua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Pe.i(this.Bb.LabelOrDateFilterType),Ae.a.instance.ea(126));this.Kzh(C.menu);Array.add(e.buttons,C)}return e};Tf.prototype.CGh=function(){var e=this.Sa.Lc();this.Bb&&Array.add(e.buttons,this.$d("PivotTableContextMenu.CustomFilter",786260386,0,this.kqj(this.Bb.LabelOrDateFilterType),Ae.a.instance.ea(107),"26"));
return e};Tf.prototype.dPh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(127),"46")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(128),"47")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(129),"48")),Array.add(e.buttons,
this.$d("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(130),"49")));return e};Tf.prototype.AMh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.January",1778578888,0,50===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(131),"50")),Array.add(e.buttons,this.$d("PivotTableContextMenu.February",1778578888,0,51===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(132),"51")),Array.add(e.buttons,this.$d("PivotTableContextMenu.March",
1778578888,0,52===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(133),"52")),Array.add(e.buttons,this.$d("PivotTableContextMenu.April",1778578888,0,53===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(134),"53")),Array.add(e.buttons,this.$d("PivotTableContextMenu.May",1778578888,0,54===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(135),"54")),Array.add(e.buttons,this.$d("PivotTableContextMenu.June",1778578888,0,55===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(136),"55")),Array.add(e.buttons,this.$d("PivotTableContextMenu.July",
1778578888,0,56===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(137),"56")),Array.add(e.buttons,this.$d("PivotTableContextMenu.August",1778578888,0,57===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(138),"57")),Array.add(e.buttons,this.$d("PivotTableContextMenu.September",1778578888,0,58===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(139),"58")),Array.add(e.buttons,this.$d("PivotTableContextMenu.October",1778578888,0,59===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(140),"59")),Array.add(e.buttons,
this.$d("PivotTableContextMenu.November",1778578888,0,60===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(141),"60")),Array.add(e.buttons,this.$d("PivotTableContextMenu.December",1778578888,0,61===this.Bb.LabelOrDateFilterType,Ae.a.instance.ea(142),"61")));return e};Tf.prototype.AAh=function(e){var C=this.Sa.Lc();if(this.BZf()){var M=this.Wc.JK[4===this.Yf.CellType?this.Wc.L3c-1:this.Yf.CurrentFieldIndex-1];if(M&&this.O9a){var ra=this.Sa.Kv("ContextMenu.PivotTableLayout",null,Ae.a.instance.ea(637),
-1777747317);var Na=this.Sa.Lc(),Ib=String.format(Ae.a.instance.Cb(160),this.O9a),Gc=String.format(Ae.a.instance.Cb(161),this.O9a);Array.add(Na.buttons,this.$d("PivotTableContextMenu.LayoutNextColumn",-1457478532,0,!M.IsCompactLayout,Ib));Array.add(Na.buttons,this.$d("PivotTableContextMenu.LayoutSameColumn",-1390365353,0,M.IsCompactLayout,Gc));Array.add(ra.menu.yc,Na);ra&&Array.add(C.buttons,ra)}}if(1===this.Yf.CellArea||2===this.Yf.CellArea)this.Bb.Caption&&(M="",Na=this.OOd(),ra=String.format(Ae.a.instance.Cb(158),
this.ucd(Na)),Na&&(M=String.format(Ae.a.instance.Cb(158),this.Bb.Caption)),1===this.Yf.CellArea?(M=this.jua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Bb.ShowSubtotal,ra),ra=this.Sa.Lc(),Array.add(ra.buttons,this.Sa.yb(259)),Array.add(ra.buttons,this.$d("ContextMenu.PivotTableSubtotalOnTop",671485366,629,this.Bb.ShowSubtotal&&this.Bb.ShowSubtotalAtTop)),Array.add(ra.buttons,this.$d("ContextMenu.PivotTableSubtotalOnBottom",772221736,630,this.Bb.ShowSubtotal&&!this.Bb.ShowSubtotalAtTop)),Array.add(M.menu.yc,
ra),M&&0<ra.buttons.length&&Array.add(C.buttons,M)):(Na=Na?this.KG("PivotTableContextMenu.Subtotal",this.Gua(ra)):"PivotTableContextMenu.Subtotal",Array.add(C.buttons,this.$d(Na,1801458190,0,this.Bb.ShowSubtotal,ra,null,M)))),Array.add(C.buttons,this.$d("ContextMenu.RepeatItemLabels",-556893687,632,this.Bb.RepeatItemLabels));1===this.Yf.CellArea&&Array.add(C.buttons,this.$d("ContextMenu.PivotBlankLineAfterEachItem",1600778266,631,this.Bb.ShowBlankLineAfterEachItem));Array.add(e.yc,C)};Tf.prototype.oBh=
function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(247));Array.add(e.yc,C)};Tf.prototype.eBh=function(e){var C="",M="",ra=!1;3===this.Yf.CellType?C=Ae.a.instance.ea(634):8===this.Yf.CellType?this.Wc&&(C=String.format(Ae.a.instance.Cb(159),this.Wc.iDe)):this.Bb&&((ra=this.OOd())&&(M=String.format(Ae.a.instance.Cb(159),this.Bb.Caption)),C=String.format(Ae.a.instance.Cb(159),this.ucd(ra)));if(C){var Na=this.Sa.Lc();ra=ra?this.KG("PivotTableContextMenu.RemoveField",this.Gua(C)):"PivotTableContextMenu.RemoveField";
C=this.$d(ra,-1951357930,0,!1,C,null,M,8,pc.a.g8c);Array.add(Na.buttons,C);Array.add(e.yc,Na)}};Tf.prototype.Qzh=function(e){var C=this.Sa.Lc();ld.EwaSettings.la(483)&&Array.add(C.buttons,this.Sa.yb(43));this.Bb&&this.Yf&&this.$.isEditMode&&(!this.Yf.CellType||4===this.Yf.CellType)&&Array.add(C.buttons,this.Sa.yb(136));Array.add(e.yc,C)};Tf.prototype.dBh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(100));Array.add(e.yc,C)};Tf.prototype.uBh=function(e){var C=2===this.Bb.MeasureType&&
!this.Bb.IsNumeric,M=this.Sa.Kv("ContextMenu.SummarizeValuesBy",null,Ae.a.instance.ea(635),-249874296),ra=this.Sa.Lc();Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesBySum",-1255320719,1056,!this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByCount",1746132849,1057,1===this.Bb.DataFieldAggregationType));Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByAverage",-771066011,1058,2===this.Bb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,C));Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByMax",835007294,1059,3===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByMin",929115636,1060,4===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByProduct",1935475057,1061,5===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,
this.OYf(!0)||C));2!==this.Bb.MeasureType&&(Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1062,6===this.Bb.DataFieldAggregationType)),Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByStdDeviation",588680636,1063,7===this.Bb.DataFieldAggregationType)),Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1064,8===this.Bb.DataFieldAggregationType)),Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByVariant",
1668427539,1065,9===this.Bb.DataFieldAggregationType)),Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1066,10===this.Bb.DataFieldAggregationType)));this.Wc&&this.Wc.Efc()&&Array.add(ra.buttons,this.$d("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1067,11===this.Bb.DataFieldAggregationType));Array.add(M.menu.yc,ra);Array.add(e.buttons,M)};Tf.prototype.pBh=function(e){var C=this.Sa.Kv("ContextMenu.ShowValuesAs",null,Ae.a.instance.ea(636),-1128612833),
M=this.Sa.Lc();Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsNoCalculation",-841863025,1073,!this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1080,7===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1079,6===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1078,5===this.Bb.DataFieldFormatType));Array.add(M.buttons,
this.$d("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1083,9===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1084,10===this.Bb.DataFieldFormatType));if(this.Wc&&this.Wc.JK&&0<this.Wc.JK.length||this.Wc.Y9&&0<this.Wc.Y9.length){for(var ra=this.jua("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1085,11===this.Bb.DataFieldFormatType),Na=this.Sa.Lc(),Ib=this.tBh(),Gc=0;Gc<Ib.length;Gc++){var id=Ib[Gc];Array.add(Na.buttons,
this.$d("ContextMenu.ShowValuesAsPercentOfParentTotal."+id.Caption,-2031744961,1085,11===this.Bb.DataFieldFormatType&&this.Bb.BaseFieldIndex===id.Index,id.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+id.Index))}Array.add(ra.menu.yc,Na);Array.add(M.buttons,ra)}Array.add(C.menu.yc,M);Array.add(e.buttons,C)};Tf.prototype.showPivotTableContextMenu=function(){this.Zld=!0;this.expandCollapse=this.UY=this.refresh=!1;var e=this.$,C=$e.g(e),M=Yg.a(e).PJa();if(M){var ra=Ee.a(e);if(null===ra||void 0===
ra?0:ra.gOd)this.Zld=oe.f(e.kg);ra=e.lc;this.UY=M.supportsBIExplore&&!!Zd.a(e)&&ra.m2(32768);ra.allowInteractivity&&(e=C.sc(null),(null===e||void 0===e?0:e.cell)&&(e.cell.UXc||e.cell.yZf)&&(this.expandCollapse=!0),ra.allowManualDataRefresh&&(this.refresh=!0))}e=null;M=1;this.q_a&&1!==this.q_a.zb?(e=new Sys.UI.Point(this.q_a.clientPoint.x,this.q_a.clientPoint.y),M=this.q_a.zb):(C=gf.e(C,this.$))&&(e=new Sys.UI.Point(C.x+(this.$.isChromeRtl?0:C.width),C.y+C.height));pg.a.Wb=M;this.Igc=3===M;this.so(e,
!0,M);this.Uaa=!0;this.sRd()};Tf.prototype.X_h=function(){var e=new Rg.a(1114549926,0,this.$.ed,19,null);this.$.Ka.Zb(e)};Tf.prototype.hOh=function(){var e=this;if(this.Wc&&this.Wc.Do){var C=this.Wc.Do.CurrentCol;if(this.Wc.Do.CurrentRow===this.activeCell.FirstRow&&C===this.activeCell.FirstColumn){this.oIb();this.showPivotTableContextMenu();return}}C=new hg.a(228,0,function(M,ra,Na){return vf.B(e.$.qa.ta,e.activeCell,hh.b(M,e.lEi),hh.a(ra,e.kEi),Na,null)},16);this.$.userOperationManager.ic(C,null)};
Tf.prototype.udi=function(){if(cg.a.Gd(this.$)){var e=this.$.da.Aa(441);if(e)return e.Hr}else if(e=this.$.da.Aa(346))return e.Hr;return!1};Tf.prototype.KG=function(e,C){return e+"."+C};Tf.prototype.performPivotTableOperation=function(e,C){var M=this,ra=Wg.a.Ra.Kb;if(!this.Wc||!this.Bb&&this.Yf&&3!==this.Yf.CellType)this.ri();else{var Na=this.Wc.isOlap;Yg.a(this.$).pu(Na,function(Ib){Ib&&M.$.ic(e,function(Gc,id,Uc){if(ld.EwaSettings.la(523)){var Vd=M.aBc,Ye=M.activeCell,Gf=M.Bb?M.Bb.Caption:null,rg=
M.O9a;Gc=hh.b(Gc,M.bIi);id=hh.a(id,M.aIi);var Dg=M.$.qa.ta.Xb();Dg=Vd.Oa(41,void 0===Dg?null:Dg);Dg.activeCell=Ye;Dg.operationType=C;Dg.fieldCaption=Gf;Dg.prevFieldCaption=rg;Uc=vf.i(Vd,"ExecutePivotTableOperation",Dg,Gc,id,Uc,null,0)}else Vd=M.aBc,Ye=M.activeCell,Gf=M.$.qa.ta.Xb(),Gf=Vd.Oa(41,void 0===Gf?null:Gf),Gf.activeCell=Ye,Gf.operationType=C,Uc=vf.i(Vd,"PerformPivotTableOperation",Gf,Gc,id,Uc,null,0);return Uc},ra,0,4,229)})}};Tf.prototype.applyValueFieldSettingsToPivotTable=function(e,C){var M=
this;C=void 0===C?!1:C;var ra=Wg.a.Ra.Kb;this.Wc&&this.Bb?(C&&2===this.Bb.MeasureType&&Fd.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),C=this.Wc.isOlap,Yg.a(this.$).pu(C,function(Na){Na&&M.$.ic(e,function(Ib,Gc,id){var Uc=M.aBc,Vd=M.activeCell,Ye=M.Cz;Ib=hh.b(Ib,M.$yi);Gc=hh.a(Gc,M.Zyi);var Gf=M.$.qa.ta.Xb();Gf=Uc.Oa(41,void 0===Gf?null:Gf);Gf.activeCell=Vd;Gf.pivotValueFieldSettingsApplyData=Ye;return vf.i(Uc,"ApplyValueFieldSettingsToPivotTable",
Gf,Ib,Gc,id,null,0)},ra,0,4,231)})):this.ri()};Tf.prototype.$d=function(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd){Na=void 0===Na?null:Na;Ib=void 0===Ib?null:Ib;Gc=void 0===Gc?null:Gc;id=void 0===id?8:id;Uc=void 0===Uc?null:Uc;Vd=void 0===Vd?!1:Vd;ra&&(e+=".Checked");Vd&&(e+=".Disabled");this.Sa.Rkd(e)&&this.Sa.VFd(e);M=Na||Ae.a.instance.ea(M);e=this.Sa.TGa(e,M,C,null,"None",Ib,Vd,null);e.Ytc(null);Gc&&e.CR(Gc);ra?e.ER("Image16by16",3,pc.a.F$):Uc?e.ER("Image16by16",id,Uc):e.Q0b();return e};Tf.prototype.jua=function(e,
C,M,ra,Na){M=(void 0===Na?null:Na)||Ae.a.instance.ea(M);this.Sa.Rkd(e)?this.Sa.VFd(e):this.Sa.VFd(e+".Checked");ra&&(e+=".Checked");this.Coj&&(M=this.Rch.parseFromString(M,"text/html").body.innerText);e=this.Sa.S1c(e,null,M,C,3,pc.a.F$);e.U6e=ra;!ra&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&e.Q0b();return e};Tf.prototype.B3h=function(){this.Cz=Object.assign(new xe,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new Qa,{Aggregation:-1}),
PivotValueFieldShowValueAsApplyData:Object.assign(new tc,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Tf.prototype.VQa=function(e,C){this.Cz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=e;this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=C;this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Tf.prototype.tBh=function(){var e=[];if(this.Wc&&this.Wc.Y9&&0<this.Wc.Y9.length)for(var C=yl(this.Wc.Y9),M=C.next();!M.done;M=
C.next())(M=M.value)&&Array.add(e,M);if(this.Wc&&this.Wc.JK&&0<this.Wc.JK.length)for(C=yl(this.Wc.JK),M=C.next();!M.done;M=C.next())(M=M.value)&&Array.add(e,M);e.sort(function(ra,Na){return ra.Index-Na.Index});return e};Tf.prototype.BZf=function(){if(!this.Yf||!this.Wc||!this.Wc.JK)return!1;var e=1===this.Yf.CellArea||4===this.Yf.CellType&&this.Yf.IsRowAxis,C=4===this.Yf.CellType?0<this.Wc.L3c:0<this.Yf.CurrentFieldIndex;return 1<this.Wc.JK.length&&e&&C};Tf.prototype.BJa=function(e){var C=[];3===
e?this.$.isEditMode?Array.addRange(C,[ea.a.uDf,ea.a.wDf,ea.a.RQi]):Array.addRange(C,[ea.a.copy]):2===e&&Array.add(C,ea.a.Cue);return C};Tf.prototype.ri=function(){var e=mh.a.jd(1,0,0,638,0,104573951,"PivotTableContextMenuOperationFailure");Qi.a(this.$).ri(e)};Tf.prototype.nqj=function(){return this.Bb?!!this.Bb.LabelOrDateFilterType||!!this.Bb.ValueFilterType||this.Bb.HasManualFilter:!1};Tf.prototype.kqj=function(e){return 62<=e&&65>=e};Tf.prototype.Gji=function(){if(this.activeCell&&this.Bb&&this.Wc){var e=
{};e.cell=this.activeCell;e.dataSourceIndex=this.Wc.externalSourceIndex;e.fieldId=this.Bb.Index.toString();e.isOlap=this.Wc.isOlap;e.confirmationRequired=this.Wc.confirmationRequiredForDataOps;this.$.Ce(492140419,pg.a.Wb,19,{showPivotFilterDialogCommandData:e})}};Tf.prototype.VTg=function(e){var C=this;this.activeCell&&this.Bb&&this.Wc&&this.$.userOperationManager.ic(new hg.a(153,0,function(M,ra,Na){return vf.W(C.$.qa.ta,C.activeCell,C.Wc.externalSourceIndex,C.Bb.Index.toString(),e,M,ra,Na,null,null)}),
null)};Tf.prototype.SFg=function(e){var C=this;!(30>e||61<e)&&this.activeCell&&this.Bb&&this.Wc&&this.$.userOperationManager.ic(new hg.a(152,0,function(M,ra,Na){return vf.g(C.$.qa.ta,C.activeCell,C.Wc.externalSourceIndex,C.Bb.Index.toString(),e,M,ra,Na,null,null)}),null)};Tf.prototype.applyPivotSort=function(e){var C=this;if(this.Wc&&this.Bb&&this.activeCell&&this.Yf){var M=1===this.Yf.CellArea||2===this.Yf.CellArea;8===this.Yf.CellArea?Lg.a(this.$.userOperationManager,function(ra,Na,Ib){return vf.e(C.$.qa.ta,
C.activeCell,e,C.Bb.Caption,ra,Na,Ib,null)},function(ra){return new hg.a(1015,0,ra,void 0,null)},null):M&&(M=1===this.Yf.CellArea?1:2,this.$.la(726)?kg.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Wc.isOlap?"":this.Bb.Caption,M,1===e):kg.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),1===e))}};Tf.prototype.Soj=
function(){return(this.Yf||this.Wc)&&4!==this.Yf.CellType&&(this.Yf.CellType||8!==this.Yf.CellArea||this.Wc.Y9&&this.Wc.Y9.length||this.Wc.JK&&this.Wc.JK.length)?!1:!0};Tf.prototype.Toj=function(){return this.Yf&&this.Wc&&(1===this.Yf.CellArea||2===this.Yf.CellArea)&&this.Wc.YMb&&this.Wc.YMb.length?!1:!0};tl.Object.defineProperties(Tf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.tIf}}});
Object(td.a)(Tf,"PivotTableContextMenu",be.a,[]);de.prototype.compare=function(e,C){return(e||"").localeCompare(C||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(td.a)(de,"DigitsAsNumberComparer",null,[623]);var Jh=b(257),Fh=be.a;vm(Ff,Fh);Ff.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 639960842:this.applyTableFieldList(M);this.$V.Uca();break;case -1085236154:M=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.twd);Fd.ULS.sendTraceTag(537166999,
0,50,M);this.$V.Uca();break;case 1833782813:this.$V.showCallout();break;default:return mg.a(e)}return wg.Task.Ta(!0)};Ff.prototype.applyTableFieldList=function(e){var C=e.MenuItemId.toString();ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(C=C.replace("'","''"),C=C.replace("[","'["),C=C.replace("]","']"));var M=Object(qc.a)(String,e.SourceControlId),ra={};ra.PulloutField=C;ra.PulloutCardPath=e.SourceCardKeyPath;ra.PulloutCardSourceRow=e.SourceCardRow;
ra.PulloutCardSourceColumn=e.SourceCardColumn;if(this.$V.KM){Fd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ra.ParameterType=2;e=e.ColumnIndex;if(void 0===e||null===e){if(void 0===M||null===M){Fd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}e=parseInt(M.substring(20+C.length+1,M.length));if(isNaN(e)){C=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",
M);Fd.ULS.shipAssertTag(537166997,0,!1,C);return}}ra.PulloutRichColumnSourceIndex=e;if(this.HTb.sDg){this.gEg(C,ra);return}}else Fd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ra.ParameterType=4,M=this.$V.selectedRange.right,void 0!==ra.PulloutCardSourceColumn&&null!==ra.PulloutCardSourceColumn&&(M=ra.PulloutCardSourceColumn+1),ra.PulloutRichColumnSourceIndex=M;this.$Ld(C,ra)};Ff.prototype.$Ld=function(e,C,M){M=void 0===M?0:M;var ra=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",
this.twd,C.PulloutRichColumnSourceIndex);Fd.ULS.sendTraceTag(537166996,0,50,ra);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",C.ParameterType,C.PulloutRichColumnSourceIndex);e=Object.assign(new Jh.a,{Text:e});this.grid.setCell(e,this.$V.zxa,0,127,C,M);this.grid.focus();this.B3b=null;this.$V.Uca();this.$V.M9i()};Ff.prototype.Gc=function(e,C,M){if(e=this.$.isEditMode&&ld.EwaSettings.la(135)&&!!this.$V)switch(C.command){case -1085236154:break;
case 639960842:e=!!M;break;case 1833782813:e=this.$V.Nva&&this.$V.Gzb;break;default:e=!1}return e};Ff.prototype.VN=function(e,C,M){this.$.isEditMode&&(this.B3b=this.JAh(Object(qc.a)(611,M)),Fh.prototype.VN.call(this,e,C,null,null,!1))};Ff.prototype.yY=function(){return this.B3b};Ff.prototype.Q1c=function(e){if(!this.$V||!e||!e.Tk)return Fd.ULS.shipAssertTag(537166994,0,!!this.$V,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Fd.ULS.shipAssertTag(537166993,0,!!e,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),
e&&Fd.ULS.shipAssertTag(537166992,0,!!e.Tk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var C=new mc.a;e=yl(e.Tk);for(var M=e.next();!M.done;M=e.next()){var ra=M.value;M=new mc.a;M.add(ra.ColumnName);M.add(ra.ColumnIndex.toString());var Na=new mc.a,Ib=null;Ib=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new de:new yf;Na=ha.OBc(ha.concat(Na,ha.select(ha.asEnumerable(ra.FieldInfoDataList),
function(Gc){return Gc.Name})),function(Gc){return Gc},Ib);ra=new mc.a;ra.add(ha.toArray(ha.concat(M,Na)));C=ha.toList(ha.concat(C,ra))}return ha.toArray(C)};Ff.prototype.JAh=function(e){var C=this.Q1c(e);if(!C||!C.length)return this.B3b=null;var M=this.Sa;e=M.Lc();var ra=1<C.length;this.twd=C.length;C=yl(C);for(var Na=C.next();!Na.done;Na=C.next()){var Ib=Na.value;ra||(e.title=Ib[0]);Na=M.Lc();for(var Gc=2,id=Ib.length;Gc<id;++Gc)Array.add(ra?Na.buttons:e.buttons,M.TGa("ApplyTableFieldList."+Ib[Gc]+
"."+Ib[1],Ib[Gc],639960842,null,"None",Ib[Gc],!1,void 0,!0));ra&&(Ib=M.Kv("ApplyTableFieldList."+Ib[0],this.menuId,Ib[0],798637440),Array.add(Ib.menu.yc,Na),Array.add(e.buttons,Ib))}M=M.zp(this.menuId);Array.add(M.yc,e);return M};Ff.prototype.gEg=function(e,C){var M=this,ra=mh.a.jd(12,1,0,878,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ld.EwaSettings.az()){var Na=new Fg.a(this.$,ra);Na.$O(function(){2===Na.returnValue&&M.$Ld(e,C,8)})}else{var Ib=new Nh.ErrorDialog(this.$,ra);Ib.$O(function(){2===
Ib.returnValue&&M.$Ld(e,C,8)});Ib.nf()}};tl.Object.defineProperties(Ff.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.vIf}},$V:{configurable:!0,enumerable:!0,get:function(){this.HTb||(this.HTb=this.$.da.Aa(261));return this.HTb}}});Object(td.a)(Ff,"PulloutFieldListContextMenu",be.a,[]);var Xg=be.a;vm(jg,Xg);jg.prototype.Gc=function(e,C,M){return-1687037502===C.command&&!!M&&this.grid.isEditing};
jg.prototype.executeCommand=function(e,C,M){this.showRichTextFloatie(M);return wg.Task.Ta(!0)};jg.prototype.BJa=function(){return[ea.a.tRg]};jg.prototype.showRichTextFloatie=function(e){var C=Object(qc.a)(aa.a,e.eventArgs);C&&(e=this.BJa(C.zb),C=new Sys.UI.Point(C.Ea.clientX,C.Ea.clientY),this.showFloatie(e,new Sys.UI.Bounds(C.x,C.y,0,0),2))};tl.Object.defineProperties(jg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},VA:{configurable:!0,enumerable:!0,
get:function(){return Je.a.OYi}}});Object(td.a)(jg,"RichTextContextMenu",be.a,[]);var hi=b(95),Ci=be.a;vm(Yf,Ci);Yf.prototype.executeCommand=function(e,C,M){if(gc.a(this.$))return wg.Task.Ta(!0);this.$.isEditMode&&(e=M[Je.a.nYf],e=e.x&&e.y?new Sys.UI.Point(e.x+(this.$.isChromeRtl?10:-10),e.y):Le.DOMElementExtensions.getLocation(M[Je.a.oYf]),this.so(e,!1));return wg.Task.Ta(!0)};Yf.prototype.Gc=function(e,C,M){return-1075099431===C.command&&!!M};Yf.prototype.yY=function(){var e=this.Sa.zp(this.menuId),
C=this.$.isEditMode;this.kLj();this.vAh(e,C);this.lAh(e);this.nBh(e);return e};Yf.prototype.oXb=function(e,C,M,ra){Array.add(e,this.Sa.yb(C?M:ra))};Yf.prototype.vAh=function(e,C){var M=this.Sa,ra=M.Lc();Array.add(ra.buttons,M.yb(54));this.oXb(ra.buttons,this.xgc,127,56);Array.add(ra.buttons,M.yb(55));C&&this.oXb(ra.buttons,this.xgc,126,125);Array.add(ra.buttons,M.yb(158));this.$.fa.bJb&&(C=Object(qc.a)(hi.a,this.$.oa))&&eh.q(C)&&this.$.isEditMode&&(Array.add(ra.buttons,M.yb(277)),C.isLockPausedInSession?
Array.add(ra.buttons,M.yb(279)):C.ik&&Array.add(ra.buttons,M.yb(278)));C=M.Kv("ContextMenu.TabColor",null,Ae.a.instance.ea(508),1841703919);M=M.M1c(467002767,1549407384,531,-221093529,this.VA);Array.add(C.menu.yc,M);Array.add(ra.buttons,C);Array.add(e.yc,ra)};Yf.prototype.lAh=function(e){var C=this.Sa.Lc();this.oXb(C.buttons,this.xgc,114,112);this.oXb(C.buttons,!this.Zec,115,113);Array.add(e.yc,C)};Yf.prototype.nBh=function(e){if(ld.EwaSettings.la(501)&&!eh.e(this.$.xa.oa)){var C=this.Sa,M=C.Lc();
Array.add(M.buttons,C.yb(263));Array.add(e.yc,M)}};Yf.prototype.kLj=function(){var e=this.$.s1c();var C=e.t1c;e=e.aAe;this.xgc=1===C;this.Zec=0<e};tl.Object.defineProperties(Yf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.xIf}}});Object(td.a)(Yf,"SheetOpsContextMenu",be.a,[]);var Di=b(523),nh=be.a;vm(zg,nh);zg.prototype.Xc=function(e,C){var M=!0;switch(C){case -231711729:M=!1;break;case -1909381757:M=
this.Fac();M=!!M&&M.xai;break;case 1312363469:M=ld.EwaSettings.la(466)}return!M||nh.prototype.Xc.call(this,e,C)};zg.prototype.executeCommand=function(e,C,M){if(!this.$.isEditMode)return xf.TaskExtensions.f4();e=C.command;C=this.Fac();var ra=null;switch(e){case 2108047455:C&&C.Awe();break;case -231711729:Fd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:C&&C.Y0b();break;case 1312363469:this.showSlicerContextMenu(M);break;default:ra=mg.a(e)}return ra||
xf.TaskExtensions.f4()};zg.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case -231711729:case 2108047455:case -1909381757:e=!0;break;case 1312363469:e=ld.EwaSettings.la(466)&&!!M}return e};zg.prototype.yY=function(){var e=this.Sa.zp(this.menuId),C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(252));ld.EwaSettings.la(504)&&Array.add(C.buttons,this.Sa.yb(253));Array.add(C.buttons,this.Sa.yb(254));Array.add(e.yc,C);C=this.Sa.Lc();this.zfi()?Array.add(C.buttons,this.Sa.yb(266)):Array.add(C.buttons,
this.Sa.yb(267));Array.add(e.yc,C);return e};zg.prototype.zfi=function(){if(cg.a.Gd(this.$)){var e=this.$.da.Aa(439);if(e)return e.Hr}else if(e=this.$.da.Aa(371))return e.Hr;return!1};zg.prototype.showSlicerContextMenu=function(e){var C=Object(qc.a)(aa.a,e.eventArgs);e=this.$9b(Object(qc.a)(aa.a,e.eventArgs));C=C.zb;pg.a.Wb=C;this.so(e,!1,C)};zg.prototype.sTe=function(e){var C=this.Sa.Lc(),M=this.Sa.Lc();Array.add(M.buttons,this.Sa.yb(255));Array.add(M.buttons,this.Sa.yb(256));var ra=this.Sa.S1c("ContextMenu.SlicerSort",
null,Ae.a.instance.ea(2108),-814639094,0,pc.a.fMe);Array.add(ra.menu.yc,M);Array.add(C.buttons,ra);Array.add(e.yc,C)};zg.prototype.Dqj=function(e){return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&e.Sb.className===pc.a.HLe||ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===e.zb};zg.prototype.$9b=function(e){var C=$e.g(this.$).ha.Qa.nc,M=e&&1!==e.zb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);
if(this.Dqj(e)){var ra=this.Fac();ra&&(e.Sb.className===pc.a.HLe&&(M=ab.HelperMethods.Ftb(e.Ea)),1===e.zb&&(M=we.a(this.$).OJa(Le.DOMElementExtensions.getLocation(ra.frame))))}else if(e=this.Fac())e=this.CJh(e.frame),(ra=ab.HelperMethods.sA(this.$.Ue,this.$.domElement,$e.g(this.$).rtl,!1))?(e.x=we.a(this.$).Fi(e.x-ra.x)+ra.x,e.y=we.a(this.$).Fi(e.y-ra.y)+ra.y):Fd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),M.y+=e.y,M.x+=e.x;e=this.$.domElement;ra=$e.g(this.$).rtl;C=ab.HelperMethods.sA(C.Bg.domElement,
e,ra);M.y=Math.max(M.y,C.y);M.x=Math.max(M.x,C.x);return M};zg.prototype.Fac=function(){var e=$e.g(this.$).ha.Qa.nc;Fd.ULS.shipAssertTag(537166988,0,!!e);return Di.a(this.$).lC(e.floatingObject.id)};zg.prototype.CJh=function(e){var C=new Sys.UI.Point(e.offsetParent.offsetLeft,e.offsetParent.offsetTop),M=$e.g(this.$);if(!M)return C;var ra=$e.g(this.$).rtl;C=ab.HelperMethods.sA(e,this.$.Oq.ownerDocument.body,ra);M.Rze(C);C.x=ra?this.$.Oq.clientWidth-C.x-e.clientWidth:C.x;e=M.view.Snb;M=ra?-M.FN.Gba(e.x):
e.x;C.x-=M;C.y-=e.y;return C};tl.Object.defineProperties(zg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.yIf}}});Object(td.a)(zg,"SlicerContextMenu",be.a,[]);Object(td.a)(Fe,"TimeSlicerRibbonButtonParameter",null,[]);var Sd=be.a;vm(Vf,Sd);Vf.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 2000085697:e=M.DOMElement;this.Tra=M.ChangeLevelCallback;this.IJa=M.GetLevelLabelCallback;
this.L_a=M.CurrentLevel;var ra=M.DomEvent;$h.g(ra);var Na=M.location;M=M.levelLabelText;this.sHe=Le.DOMElementExtensions.Yy(document.activeElement,"iframe")&&M?M.parentNode:null;M=Sys.UI.DomElement.getBounds(M);M.x=Na.x;M.y=Na.y;this.VN(ra,e,M,C,!0);break;case -649826274:this.Tra(0);break;case 149600865:this.Tra(1);break;case -2012435159:this.Tra(2);break;case -1979934975:this.Tra(3);break;case 1634477200:Le.DOMElementExtensions.setFocus(this.sHe);break;default:return mg.a(e)}return wg.Task.Ta(!0)};
Vf.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 2000085697:e=!!M;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:e=!0}return e};Vf.prototype.VN=function(e,C,M){e=Sys.UI.DomElement.getBounds(C);M.x=we.a(this.$).Fi(M.x);M.y=we.a(this.$).Fi(M.y);e.x=we.a(this.$).Fi(e.x);e.y=we.a(this.$).Fi(e.y);e=new Sys.UI.Point(e.x+M.x,e.y+M.y);this.ISa(e,C);this.showContextMenu(new Sys.UI.Bounds(e.x,e.y-M.height,M.width,M.height))};Vf.prototype.yY=function(){for(var e=
this.Sa,C=e.zp(this.menuId),M=e.Lc(),ra=0;3>=ra;ra++){var Na=this.IJa(ra),Ib=Vf.bEh(ra);Ib=e.z_g(Ib.DYg,Ib.$o,this.L_a===ra,Vf.Fve);Ib.label=Na;Ib.CR(Na);this.L_a===ra?Ib.ER("Image16by16",8,Vf.Fve):Ib.Q0b();Array.add(M.buttons,Ib)}Array.add(C.yc,M);return C};Vf.bEh=function(e){var C=null;switch(e){case 0:C=new Fe(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:C=new Fe(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:C=new Fe(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);
break;case 3:C=new Fe(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return C};tl.Object.defineProperties(Vf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return Je.a.BIf}}});Vf.TBj="TimeSlicerLevelMenu";Vf.cHb="TimeSlicerLevelMenuRootName";Vf.Fve="ewamenu_CheckmarkApplied";Object(td.a)(Vf,"TimeSlicerLevelMenu",be.a,[]);var Cj=b(307),Pf=b(222),X=b(3),ta=af.a;vm(qg,ta);qg.prototype.Md=function(){var e=
this,C=this.$,M=Pf.a.E_a(sd.b(),this.ma,"Task","IRootUser"),ra=Dd.a(C),Na=null;Na=function(id,Uc){ra.KMf(Na);M.setResult(Uc.i2b)};ra.lle(Na);ra.WYe();var Ib=ud.GetServiceTaskFactory.create(C.da,102,C.ma,this.tb),Gc=ud.GetServiceTaskFactory.Xa(C.da,342,338,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([M.task,Ib,Gc],this.ma),function(){var id=Ib.result,Uc=M.task.result,Vd=Gc.result;e.Ed([new Cd(C,Uc,id,Vd),new lf(C,Uc,id,Vd),new Mg(C,Uc,id,Vd),new me(C,Uc,id,Vd),new We(C,Uc,id,Vd),new $f(C,Uc,
id,Vd),new ge.GridContextMenu(C,Uc,id,Vd),new Ve(C,Uc,id,Vd),new Yf(C,Uc,id,Vd),new Vf(C,Uc,id,Vd),new Ff(C,Uc,id,Vd),new dg(C,Uc,id,Vd),new Tf(C,Uc,id,Vd),new zg(C,Uc,id,Vd),new jg(C,Uc,id,Vd)])},C.ma,3)};qg.initData=function(){var e=Cj.a.Z1;e(2000085697,20479,0,0);e(-227942804,X.a.Jc|24576,0,0);e(1634477200,X.a.Jc|131072,0,0);e(-649826274,4095,0,0);e(149600865,4095,0,0);e(-2012435159,4095,0,0);e(-1979934975,4095,0,0);e(1247109494,X.a.Jc|24576,0,0);e(-2064931494,X.a.Jc|131072,0,0);e(-1396319072,
X.a.Ja,128,0);e(-425234874,X.a.Ja,128,0);e(-1253126584,X.a.Ja,0,0);e(274207288,X.a.Jc|24576,0,0);e(-1497523576,X.a.Jc|131072,0,0);e(-498523270,X.a.Jc|24576,64,0);e(1640762262,X.a.Jc|131072,64,0);e(-2017893763,X.a.Jc|24576,0,0);e(1350204367,X.a.Jc|131072,0,0);e(-889576107,X.a.Gv,128,0);e(-1170196828,X.a.Gv,128,0);e(389774337,X.a.Gv,128,0);e(1529312473,X.a.Gv,128,0);e(2033235475,X.a.Gv,128,0);e(-96230454,X.a.Gv,128,0);e(74086617,X.a.Gv,128,0);e(563292088,X.a.Gv,128,0);e(-1092351914,X.a.Gv,128,0);e(-2141589616,
X.a.Gv|16384,128,0);e(745182485,X.a.Gv,0,0);e(359279088,X.a.Gv,128,0);e(-67292059,X.a.Gv,128,0);e(926905850,X.a.Gv,128,0);e(547535945,X.a.Gv,128,0);e(1374696078,X.a.Jc|24576,0,0);e(495005930,X.a.Jc|212992,0,0);e(-1045020714,X.a.Jc|24576,0,0);e(-170383950,X.a.Jc|212992,0,0);e(324156914,X.a.Ja,0,0);e(-1085236154,X.a.mu,0,0);e(-751848458,X.a.il|16384,0,0);e(216058793,X.a.mu,0,0);e(474690375,X.a.il|16384,0,0);e(-1920954846,X.a.Jc|24576,0,0);e(723126814,X.a.Jc|131072,0,0);e(2108047455,128,128,0);e(-231711729,
128,128,0);e(-1909381757,128,128,0);e(-814639094,128,128,0);e(1701016594,X.a.Jc|3072,128,0);e(-1475408662,X.a.Jc|24576,0,0);e(1114549926,X.a.Jc|131072,32,0)};qg.ja=function(e){af.a.de(10,new qg(e))};Object(td.a)(qg,"ContextMenuCommandHandlerFactory",af.a,[]);var tb=b(216),Rb=b(1372),Fc=b(97),lc=b(250);If.prototype.dispose=function(){};If.prototype.t$=function(){this.Ipb.i3()};If.prototype.bC=function(){this.Ipb.bC()};If.prototype.bPd=function(e,C,M){gf.h(this.$,gf.b);this.Ipb.showContextMenu(Object.assign(new Rb.a,
{x:C.x,y:C.y}),M,e);Fc.EventHandlerManager.instance.U$c()};If.prototype.Ovc=function(e,C,M){gf.h(this.$,gf.b);this.Ipb.showFloatie(Object.assign(new Rb.a,{x:C.x,y:C.y}),e,M);lc.a(function(){Fc.EventHandlerManager.instance.U$c()},this.$.ma)};If.prototype.aPd=function(e,C,M,ra){gf.h(this.$,gf.b);this.Ipb.aPd(Object.assign(new Rb.a,{x:C.x,y:C.y}),e,M,ra)};Object(td.a)(If,"ReactContextMenuController",null,[603,3]);var Jd=tb.a;vm(Zf,Jd);Zf.prototype.dispose=function(){this.H7e&&this.$&&this.$.fa.hr(this.wjd);
Jd.prototype.dispose.call(this)};Zf.prototype.create=function(){this.$.fa.Mh?(Fd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.fa.Mh),this.wjd(null,null)):(this.H7e=!0,this.$.fa.sn(this.wjd))};Zf.ja=function(e){e.da.Ha(338,new Zf(e))};Object(td.a)(Zf,"ContextMenuControllerFactory",tb.a,[]);var he=b(158);Object(td.a)(og,"RibbonCommandParams",null,[]);Object(td.a)(bg,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);
Af.prototype.mEh=function(e){return(e=this.Zbc[e.toString()])?e.menuModel:null};Af.prototype.Mse=function(e,C){this.Zbc[C.toString()]=Object.assign(new bg,{menuModel:e,zCe:ab.HelperMethods.jc()})};Af.prototype.rrb=function(e){this.Zbc[e.toString()]=null};Af.prototype.eTh=function(e){return(e=this.Zbc[e.toString()])?e.zCe:-1};Object(td.a)(Af,"FilterMenuCache",null,[]);var Te=b(12),yg=b(207),Kg=b(276);Object(td.a)(bf,"AutoFilterEventRegistrationArgs",null,[]);var Ug=b(24);pe.prototype.dispose=function(){window.cancelAnimationFrame(this.Hzb);
this.gridView&&this.gridView.Kqc(this.nCb);this.gridView=null};pe.prototype.J2h=function(){if(this.vOd=ab.HelperMethods.B5a)this.AYa=[];this.Dxg();this.gridView.KXb(this.nCb)};pe.prototype.Dxg=function(){for(var e=yl(this.gridView.jn),C=e.next();!C.done;C=e.next()){C=C.value.nBa;for(var M in C){var ra=C[M];this.WGf(ra.domElement,ra.hashCode)}}};pe.prototype.WGf=function(e,C){if($e.g(this.$).Ca.Hl.u0a(C))if(e){e=e.querySelectorAll('[id^="'+Je.a.M9c+'"]');for(var M=0;M<e.length;M++){var ra=e[M],Na=
ra.getAttribute(Je.a.Iuh),Ib=ra.getAttribute(Je.a.Buh);Fd.ULS.shipAssertTag(537167053,0,!!Na&&!!Ib,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",ra.id,C);Na=Ug.Range.ld(parseInt(Na),parseInt(Ib));ra=Object.assign(new bf,{cell:Na,qqe:ra,Xd:C});this.vOd?(this.AYa.push(ra),this.Hzb||(this.MJe=window.performance.now(),this.Hzb=window.requestAnimationFrame(this.vKf))):this.Fje(ra)}}else Fd.ULS.sendTraceTag(537167054,
0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",C);else Fd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",C)};pe.prototype.Fje=function(e){var C=this.gridView.Ca.oub(e.cell,e.Xd);C?this.Cxg(e.qqe,C):Fd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",
e.Xd,e.cell)};pe.prototype.Cxg=function(e,C){C.hasAutoFilter?this.Hvg(e,C.L9c):C.n4?this.Axg(e,C.L9c,C.vcf):Fd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");he.a.instance.pa(Te.a.Ff,e,this.onPointerDown);yg.a.instance.pa(Te.a.txa,e,this.onPointerDown)};pe.prototype.Hvg=function(e,C){Kg.a.instance.pa(Te.a.click,e,function(M){C&&kg.a.hrc(M.Ea.rawEvent,966232027,C,null);return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?
!0:!1})};pe.prototype.Axg=function(e,C,M){var ra=$g.a.li(C);Kg.a.instance.pa(Te.a.click,e,function(Na){M?kg.a.spf(document.getElementById(ra.EwaElementId),ra.Cell,ra.DataSourceIndex,ra.FieldId,ra.IsOlap,ra.RequiresConfirmation,Na.Ea.rawEvent,ra.OptionalPivotMenuAnchor):kg.a.spfm(Na.Ea.rawEvent,ra.RequiresConfirmation,ra.Cell,ra.DataSourceIndex,ra.PivotName,ra.OptionalPivotMenuAnchor);return!1})};Object(td.a)(pe,"FilterMenuPointerEventsManager",null,[3]);wd.prototype.dispose=function(){ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&
ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.cQe.dispose();this.$=null};wd.prototype.nKh=function(e){var C=$e.g(this.$).Ca.E9(e,this.$.activeItemName);return C&&C.blockPresentInViewportTimeStamp>this.nxa.eTh(e.left)?C.Ds(e).autoFilterMenu:this.nxa.mEh(e.left)};wd.prototype.cFi=function(e,C,M){this.nxa&&(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.nxa.Mse(e.menuModel[C],M):
this.nxa.Mse(e.menuModel[C],e.left+C))};wd.prototype.dFi=function(e,C,M){this.nxa&&(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.nxa.rrb(M):this.nxa.rrb(e.left+C))};Object(td.a)(wd,"FilterMenuManager",null,[607,3]);var ae=b(224),Re=b(173);yd.prototype.Qbd=function(e){return gi.a.Ec(this.kwc,e)};yd.prototype.dispose=function(){this.Ld?Fd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):
(this.Ld=!0,this.$&&(this.$.ml(yd.od),this.$.da.fU(8),this.ha&&this.ha.Dqc(this.Zk),this.$.Ka.Y$a(this.vsf),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.T$a(this.Jxa),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.v6(this.I5)),this.$=this.ha=null,this.U7b.dispose(),this.kwc=this.J3d=null)};yd.prototype.showContextMenu=function(e,C,M){C=void 0===C?null:C;M=void 0===
M?null:M;this.jqj(e)&&(gf.h(this.$,gf.i),e=this.J0g(e,C,M),this.$.Ka.Zb(e.ee,e.dictionary))};yd.prototype.i3=function(){this.contextMenuController?this.contextMenuController.t$():Fd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};yd.prototype.jqj=function(e){return Qi.a(this.$).sq()?(Fd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Qi.a(this.$).C_(Re.a.grid,ae.a.showContextMenu),!1):!this.$.Ka.dsh&&(!e||e.Sb!==$e.g(this.$).domElement&&!K.a.equals(e.Sb.tagName,"INPUT",!0))};yd.prototype.J0g=function(e,C,M){C=void 0===C?null:C;var ra={};M=(ra.eventArgs=e,ra.creationParams=void 0===M?null:M,ra);e=e?e.zb:-1;ra=this.ha.Qa.nc;var Na=1441131127;ra?(C=ra.floatingObject,Fd.ULS.shipAssertTag(537167059,0,!!C,"floatingObj shouldn't be null."),yd.Iod(C)?Na=1312363469:yd.isPivotChart(C)?(M[lf.$Yc]=C?C.Yc:null,Na=-149612405):Na=-1372040782):
yd.ucf(C)?(M[lf.$Yc]=C,Na=-149612405):!gf.g(this.$)&&gf.f($e.g(this.$))&&(Na=671488277);C=new Rg.a(Na,e,this.$.ed,30,null);return Object.assign(new og,{ee:C,dictionary:M})};yd.ja=function(e){e.Rk(yd.od)};yd.isPivotChart=function(e){return!!e&&!e.type&&yd.ucf(e.Yc)};yd.Iod=function(e){return!!e&&2===e.type};yd.ucf=function(e){return!!e&&!!(e.Attributes&4)};tl.Object.defineProperties(yd.prototype,{U7b:{configurable:!0,enumerable:!0,get:function(){return this.J3d}}});yd.EYg="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
yd.LVh="GridContextMenu";yd.od=function(e){(e=Object(qc.a)(6,e))&&ud.GetServiceTaskFactory.create(e.da,9,e.ma,0)};Object(td.a)(yd,"ContextMenuManager",null,[572,3]);var Ri=tb.a;vm(ad,Ri);ad.prototype.create=function(){var e=this,C=this.$,M=C.lc;if(M.allowSelection||M.allowEdits||M.allowFiltering||M.allowSorting||M.allowPivotSpecificOperations){var ra=ud.GetServiceTaskFactory.create(C.da,10,C.ma,this.tb),Na=ud.GetServiceTaskFactory.Xa(C.da,342,338,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([ra,
Na],this.ma),function(){e.Fb(Cf.a(C)||new yd(C,ra.result,Na.result))},this.$.ma,3)}else Fd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),C.da.fU(8),this.Fb(null)};ad.ja=function(e){e.da.Ha(9,new ad(e))};Object(td.a)(ad,"ContextMenuManagerFactory",tb.a,[]);fe.prototype.isEqual=function(e){return e?this.J4===e.J4&&this.K4===e.K4&&this.nN===e.nN&&this.oN===e.oN&&this.$A===e.$A&&this.ruleType===e.ruleType&&
this.vZ===e.vZ&&this.lT===e.lT&&this.kT===e.kT&&this.cV===e.cV&&this.yE===e.yE&&this.W4===e.W4&&this.X4===e.X4:(Fd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(td.a)(fe,"DataValidationEditDialogState",null,[]);Wc.prototype.Xc=function(){return!1};Wc.prototype.executeCommand=function(e,C){-1728432249!==C.command&&mg.a(C.command);this.selectedRanges=sg.r($e.g(this.$).ha.va.selectedRanges,this.$);$e.g(this.$).j0(!0);this.getDataValidationInitialState();
this.dh=this.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogOpen");this.cHe?Fd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Fd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.cHe=!0);return wg.Task.Ta(!0)};Wc.prototype.Gc=function(e,C){return-1728432249===C.command};Wc.prototype.fd=function(){return!1};Wc.prototype.getDataValidationInitialState=function(){var e=this,C=this.$.qa.ta.Xb();Lg.a(this.$.userOperationManager,
function(M,ra,Na){return vf.u(e.$.qa.ta,e.selectedRanges,hh.b(M,e.xDi),hh.a(ra),Na,C)},function(M){return new hg.a(120,0,M,16)},null)};Wc.prototype.yTi=function(){var e=this.iB={};switch(this.X_a.Command){case 0:var C="CreateNew";break;case 1:C="CreateNewFromRule";break;case 2:C="ExpandExisitng";break;case 3:C="OverrideExisitng";break;default:C="Unknown"}e.a=C;this.dh&&(this.dh.stop(),this.iB.r=this.dh.id);switch(this.X_a.Command){case 0:this.iB.b=!1;this.iB.c="None";this.UGa(new fe);break;case 1:this.iB.b=
!1;this.iB.c="None";this.UGa(new fe(this.X_a));break;case 2:this.iB.b=!0;this.O3c.I_g(this.$,this.lsh);break;case 3:this.iB.b=!0;this.O3c.K_g(this.$,this.BOi);break;default:Fd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};Wc.prototype.UGa=function(e){this.O3c.UGa(this.$,this.selectedRanges,e,this.X_a.Command);this.Loi(e)};Wc.prototype.Loi=function(e){Wc.Sqb(e,this.iB);this.iB.d=!0;sd.b().Ne(48,this.iB,!0)};Wc.prototype.wjf=function(){this.iB.d=
!1;sd.b().Ne(48,this.iB,!0)};Wc.prototype.nW=function(e,C){var M={};e=(M.ButtonType=Wc.Rha(C),M.DialogName=e,M.Location="dialog",M.NumberOfSelectedRanges=$e.g(this.$).ha.va.nK,M);qi.b(this.$).ae(Dh.a.E4b,e)};Wc.Sqb=function(e,C){C.e=ve(e.ruleType);C.f=kc(e.$A);C.g=!!e.nN;C.h=!!e.oN;C.i=e.J4;C.j=e.K4;C.k=e.X4;C.l=!!e.yE;C.m=!!e.cV;C.n=e.W4;C.o=e.vZ;C.p=!!e.lT;C.q=!!e.kT};Wc.Rha=function(e){switch(e){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Fd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(td.a)(Wc,"DataValidationEditCommandHandler",null,[147]);var yj=b(973),fg;(function(e){e[e.between=0]="between";e[e.notBetween=1]="notBetween";e[e.equal=2]="equal";e[e.notEqual=3]="notEqual";e[e.greaterThan=4]="greaterThan";e[e.lessThan=5]="lessThan";e[e.greaterThanOrEqual=6]="greaterThanOrEqual";e[e.lessThanOrEqual=7]="lessThanOrEqual"})(fg||(fg={}));Object(td.b)("DataValidationRuleConditionType",
fg);var Dj;(function(e){e[e.anyValue=0]="anyValue";e[e.wholeNumber=1]="wholeNumber";e[e.decimal=2]="decimal";e[e.list=3]="list";e[e.date=4]="date";e[e.time=5]="time";e[e.textLength=6]="textLength";e[e.custom=7]="custom"})(Dj||(Dj={}));Object(td.b)("DataValidationRuleType",Dj);var tj=b(140),Bh=b(156);tl.Object.defineProperties(Rc,{xf:{configurable:!0,enumerable:!0,get:function(){return tj.a.jj(Rc.Tj,"")}},R$g:{configurable:!0,enumerable:!0,get:function(){return tj.a.jj(Rc.V$g,Bh.a.ea(1618),Bh.a.ea(1633),
Bh.a.ea(1634),Bh.a.ea(1635),Bh.a.ea(1636),Bh.a.ea(1637),Bh.a.ea(1638),Bh.a.ea(1639),Bh.a.ea(1640),Bh.a.ea(1619),Bh.a.ea(1643),Bh.a.ea(1644),Bh.a.ea(1645),Bh.a.ea(1646),Bh.a.ea(1647),Bh.a.ea(1648),Bh.a.ea(1649),Bh.a.ea(1650),Bh.a.ea(1620),Bh.a.ea(1621),Bh.a.ea(1641),Bh.a.ea(1642),Bh.a.ea(1632),"255")}},Y$g:{configurable:!0,enumerable:!0,get:function(){return tj.a.jj(Rc.W$g,Bh.a.ea(1655),Bh.a.ea(1659),Bh.a.ea(1660),"255","32")}},bah:{configurable:!0,enumerable:!0,get:function(){return tj.a.jj(Rc.X$g,
Bh.a.ea(1654),Bh.a.ea(1657),Bh.a.ea(1656),Bh.a.ea(1658),Bh.a.ea(1659),Bh.a.ea(1660),"255","32")}}});Rc.R4f=255;Rc.Tj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";Rc.V$g="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Rc.W$g="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Rc.X$g="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(td.a)(Rc,"DataValidationEditDialogHtml",null,[]);var uh=b(576),Ph=bi.a;vm(Nc,Ph);Nc.prototype.Nza=function(e){this.mT.selectedIndex=e.ruleType;this.qK.selectedIndex=e.$A;this.adc.checked=e.K4;this.Ava.checked=e.J4;this.gya.value=e.nN;this.hya.value=e.oN;this.Sba(null)};Nc.prototype.kob=function(e){e.J4=this.Ava.checked;e.K4=this.adc.checked;e.$A=this.qK.selectedIndex;e.ruleType=this.mT.selectedIndex;e.nN=this.gya.value;e.oN=this.hya.value};Nc.prototype.dispose=function(){this.mm();this.xk=
this.bAd=this.gnc=this.oOa=this.c9a=this.KMa=this.p4a=this.adc=this.hya=this.gya=this.qK=this.mT=this.Ava=null;Ph.prototype.dispose.call(this)};Nc.prototype.render=function(e){e.appendChild(this.domElement)};Nc.prototype.oja=function(){return this.isVisible};Nc.prototype.Uma=function(e){return this.isVisible=e};Nc.prototype.setFocus=function(){};Nc.prototype.Wtb=function(e,C){return this.SYe(e,C,this.lwh)};Nc.prototype.Jed=function(e,C){return C&&1!==C?"":this.SYe(e,C,this.Rdj)};Nc.prototype.Kja=
function(){this.domElement.innerHTML=Rc.R$g;this.Ava=Le.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.mT=Le.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.qK=Le.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.gya=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.hya=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.gnc=Le.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.bAd=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.p4a=Le.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.KMa=Le.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.c9a=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.oOa=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.adc=Le.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.ak()};Nc.prototype.SYe=function(e,C,M){return M.length<e||M[e].length<C?(Fd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",e,C),""):this.JQ.na(M[e][C])};Nc.prototype.ak=function(){uh.a.instance.pa(Te.a.Rb,this.mT,this.Glc);uh.a.instance.pa(Te.a.Rb,this.qK,this.Glc);uh.a.instance.pa(Te.a.change,this.mT,this.Sba);uh.a.instance.pa(Te.a.change,this.qK,this.Sba);uh.a.instance.pa(Te.a.change,
this.qK,this.xk);uh.a.instance.pa(Te.a.change,this.mT,this.xk);uh.a.instance.pa(Te.a.change,this.gya,this.xk);uh.a.instance.pa(Te.a.Rb,this.gya,this.xk);uh.a.instance.pa(Te.a.change,this.hya,this.xk);uh.a.instance.pa(Te.a.Rb,this.hya,this.xk)};Nc.prototype.mm=function(){uh.a.instance.za(Te.a.Rb,this.mT,this.Glc);uh.a.instance.za(Te.a.Rb,this.qK,this.Glc);uh.a.instance.za(Te.a.change,this.mT,this.Sba);uh.a.instance.za(Te.a.change,this.qK,this.Sba);uh.a.instance.za(Te.a.change,this.qK,this.xk);uh.a.instance.za(Te.a.change,
this.mT,this.xk);uh.a.instance.za(Te.a.change,this.gya,this.xk);uh.a.instance.za(Te.a.Rb,this.gya,this.xk);uh.a.instance.za(Te.a.change,this.hya,this.xk);uh.a.instance.za(Te.a.Rb,this.hya,this.xk)};Nc.eZ=function(){var e;return e=new mc.a,e.add("operatorInputId1"),e.add("operatorInputId2"),e};tl.Object.defineProperties(Nc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.ea(1651)}},lXg:{configurable:!0,enumerable:!0,get:function(){return this.mT.selectedIndex}}});
Object(td.a)(Nc,"DataValidationEditConditionsControl",bi.a,[628,3,631]);var ah=b(194),zj=yj.a;vm(cb,zj);cb.prototype.NPd=function(){var e={};e=(e.RuleType=this.Dd.ruleType,e.RuleOperatorType=this.Dd.$A,e.OperatorInput1=this.Dd.nN,e.OperatorInput2=this.Dd.oN,e.IsIgnoreBlank=this.Dd.J4,e.IsInCellDropDown=this.Dd.K4,e.IsAlertBlocking=this.Dd.vZ,e.AlertTitle=this.Dd.lT,e.AlertMessage=this.Dd.kT,e.InputTitle=this.Dd.yE,e.InputMessage=this.Dd.cV,e.IsShowErrorAlert=this.Dd.W4,e.IsShowInputMessage=this.Dd.X4,
e);this.Cc(2,Ae.a.instance.ea(1617));var C={};e=(C[cb.Ly]=this.xc,C.validateDialogValues=this.lNj,C.RangePickerController=$e.g(this.$).Bh.vac(),C.isModal=!1,C.bodyProps=e,C);this.initializeAndShow(Ae.a.instance.ea(1616),this.N3c,e);Fd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};cb.prototype.dispose=function(){this.disposed||(zj.prototype.dispose.call(this),this.disposed=!0)};cb.prototype.eZ=function(){return Nc.eZ()};cb.prototype.MGh=function(e,C){var M=this;return function(ra,
Na,Ib){var Gc=e.qa.ta.Xb();return nc(M.$.qa.ta,M.selectedRanges,M.DMg(),M.AZa(ra,M.Exd(C)),hh.a(Na),Ib,Gc)}};cb.prototype.Exd=function(e){var C=this;return function(M){Fd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ra;yh.a(M)?(Fd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",M?mh.a.Uc(M.Errors):null),M.Errors&&1===M.Errors.length&&((ra=C.acd(M.Errors[0].MessageId))?
C.Hka("OkInvalidByServer",M.Errors[0].MessageIdName):(C.Hka("OkValid","None"),C.hide()),e(ra)),Fd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",mh.a.Uc(M.Errors))):C.hide()}};cb.prototype.DMg=function(){var e={};e.Command=this.command;e.RuleType=this.Dd.ruleType;e.ConditionType=this.Dd.$A;e.IsIgnoreBlank=this.Dd.J4;e.IsInCellDropDown=this.Dd.K4;e.LowerBoundary=this.Dd.nN;e.UpperBoundary=this.Dd.oN;e.IsAlertBlocking=
this.Dd.vZ;e.IsShowErrorAlert=this.Dd.W4;e.IsShowInputMessage=this.Dd.X4;e.AlertTitle=this.Dd.lT;e.AlertMessage=this.Dd.kT;e.InputTitle=this.Dd.yE;e.InputMessage=this.Dd.cV;e.ShouldIgnoreFormulaError=this.lMa;return e};cb.prototype.acd=function(e){switch(e){case 1173235830:return Ae.a.instance.ea(1666);case 43935303:return Ae.a.instance.ea(1667);case -1323438439:return Ae.a.instance.ea(1669);case 2112020473:return Ae.a.instance.ea(1663);case -219503282:return Ae.a.instance.ea(1664);case 1689335445:return Ae.a.instance.ea(1665);
case 2146493810:return Ae.a.instance.ea(1668);case -2104909922:return String.format(Ae.a.instance.Cb(104),this.Bsb,this.yKd);case -869372599:return String.format(Ae.a.instance.Cb(103),this.Bsb);case -1181828368:return Ae.a.instance.ea(1671);case -758480861:return Ae.a.instance.ea(1672);case -13729088:return Ae.a.instance.ea(1673);case -846654055:return Ae.a.instance.ea(1674);case 751854001:return Ae.a.instance.ea(1675);case -453846397:return Ae.a.instance.ea(1676);case 1102013489:return Ae.a.instance.ea(1677);
case 835813260:return Ae.a.instance.ea(1678);case 1577787509:return Ae.a.instance.ea(1679);case 2083564019:return Ae.a.instance.ea(1670);default:Fd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};cb.prototype.jla=function(){this.Hka("Cancel","None")};cb.prototype.nW=function(e){Fd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===e?"Ok":"Cancel");var C={};e=(C.ButtonType=
cb.Rha(e),C.DialogName=this.xc,C.Location="dialog",C.NumberOfSelectedRanges=$e.g(this.$).ha.va.nK,C);qi.b(this.$).ae(Dh.a.E4b,e)};cb.prototype.Hka=function(e,C){var M={};cb.Sqb(this.Dd,M);M.o=e;M.p=C;M.n=this.Xja;this.dh&&(this.dh.stop(),M.q=this.dh.id);sd.b().Ne(49,M,!0)};cb.prototype.k$b=function(e){this.Dd.ruleType=e.RuleType;this.Dd.$A=e.RuleOperatorType;this.Dd.nN=e.OperatorInput1;this.Dd.oN=e.OperatorInput2;this.Dd.vZ=e.IsAlertBlocking;this.Dd.W4=e.IsShowErrorAlert;this.Dd.lT=e.AlertTitle;this.Dd.kT=
e.AlertMessage;this.Dd.X4=e.IsShowInputMessage;this.Dd.yE=e.InputTitle;this.Dd.cV=e.InputMessage;this.Dd.J4=e.IsIgnoreBlank;this.Dd.K4=e.IsInCellDropDown;this.Bsb=e.firstOperatorLabel;this.yKd=e.secondOperatorLabel};cb.prototype.VMb=function(e,C,M){var ra;var Na=ra=null;if(!e)return M?(ra=String.format(Ae.a.instance.Cb(104),this.Bsb,this.yKd),Na="DataValidationEditNoMinMaxError"):(ra=String.format(Ae.a.instance.Cb(103),this.Bsb),Na="DataValidationEditNoValueError"),{returnValue:!1,errorString:ra,
lq:Na};if(e.length>Rc.R4f)return ra=Ae.a.instance.ea(1670),{returnValue:!1,errorString:ra,lq:Na};if(ah.d(e))return{returnValue:!0,errorString:ra,lq:Na};if(1===C||2===C||6===C){if(!K.a.iV(e))return ra=Ae.a.instance.ea(1663),{returnValue:!1,errorString:ra,lq:Na};if(1===C&&!K.a.isInteger(e))return ra=Ae.a.instance.ea(1664),{returnValue:!1,errorString:ra,lq:Na};if(6===C){if(!K.a.isInteger(e))return ra=Ae.a.instance.ea(1664),{returnValue:!1,errorString:ra,lq:Na};if(0>parseInt(e))return ra=Ae.a.instance.ea(1665),
{returnValue:!1,errorString:ra,lq:Na}}}return{returnValue:!0,errorString:ra,lq:Na}};cb.prototype.KWd=function(){var e=this,C;var M=C=null;var ra=this.Dd.nN,Na=this.Dd.oN,Ib=Dj[this.Dd.ruleType],Gc=fg[this.Dd.$A];if(!Ib)return{returnValue:!0,errorString:C,lq:M};var id=(!Gc||1===Gc)&&3!==Ib&&7!==Ib;return!function(){var Uc=e.VMb(ra,Ib,id);C=Uc.errorString;M=Uc.lq;return Uc}().returnValue||id&&!function(){var Uc=e.VMb(Na,Ib,id);C=Uc.errorString;M=Uc.lq;return Uc}().returnValue?{returnValue:!1,errorString:C,
lq:M}:id&&(1===Ib||2===Ib||6===Ib)&&!ah.d(ra)&&!ah.d(Na)&&parseFloat(ra)>parseFloat(Na)?(C=Ae.a.instance.ea(1668),M="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:C,lq:M}):{returnValue:!0,errorString:C,lq:M}};cb.Rha=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Fd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};cb.Sqb=function(e,C){C.a=ve(e.ruleType);
C.b=kc(e.$A);C.c=!!e.nN;C.d=!!e.oN;C.e=e.J4;C.f=e.K4;C.g=e.X4;C.h=!!e.yE;C.i=!!e.cV;C.j=e.W4;C.k=e.vZ;C.l=!!e.lT;C.m=!!e.kT};tl.Object.defineProperties(cb.prototype,{Dd:{configurable:!0,enumerable:!0,get:function(){return this.kQb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},j0b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Dd.ruleType}}});Object(td.a)(cb,"DataValidationEditDialog",yj.a,[]);var Rf=b(303);ye.G7g="DataValidationDialogPanel";ye.F7g=
"DataValidationButtonPanel";ye.E7g="DataValidationButtonClearAll";Object(td.a)(ye,"CssClassNames",null,[]);var ti=bi.a;vm(Bc,ti);Bc.prototype.render=function(e){e.appendChild(this.domElement)};Bc.prototype.oja=function(){return this.isVisible};Bc.prototype.Uma=function(e){return this.isVisible=e};Bc.prototype.setFocus=function(){};Bc.prototype.dispose=function(){this.mm();this.xk=this.Gaa=this.Faa=this.q8e=this.Eaa=null;ti.prototype.dispose.call(this)};Bc.prototype.Kja=function(){this.domElement.innerHTML=
Rc.Y$g;this.Eaa=Le.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.q8e=Le.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Gaa=Le.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Faa=Le.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Eaa.checked=!0;this.ak();this.Ilc(null)};Bc.prototype.Nza=function(e){this.Gaa.value=void 0===e.yE||null===e.yE?"":e.yE;this.Faa.value=void 0===
e.cV||null===e.cV?"":e.cV;this.Eaa.checked=e.X4;this.Ilc(null)};Bc.prototype.kob=function(e){e.yE=this.Gaa.value;e.cV=this.Faa.value;e.X4=this.Eaa.checked};Bc.prototype.ak=function(){uh.a.instance.pa(Te.a.change,this.Eaa,this.Ilc);uh.a.instance.pa(Te.a.change,this.Eaa,this.xk);uh.a.instance.pa(Te.a.change,this.Gaa,this.xk);uh.a.instance.pa(Te.a.Rb,this.Gaa,this.xk);uh.a.instance.pa(Te.a.change,this.Faa,this.xk);uh.a.instance.pa(Te.a.Rb,this.Faa,this.xk)};Bc.prototype.mm=function(){uh.a.instance.za(Te.a.change,
this.Eaa,this.Ilc);uh.a.instance.za(Te.a.change,this.Eaa,this.xk);uh.a.instance.za(Te.a.change,this.Gaa,this.xk);uh.a.instance.za(Te.a.Rb,this.Gaa,this.xk);uh.a.instance.za(Te.a.change,this.Faa,this.xk);uh.a.instance.za(Te.a.Rb,this.Faa,this.xk)};tl.Object.defineProperties(Bc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.ea(1653)}}});Object(td.a)(Bc,"DataValidationEditInputControl",bi.a,[628,3,630]);var Zj=bi.a;vm(Jc,Zj);Jc.prototype.render=function(e){e.appendChild(this.domElement)};
Jc.prototype.oja=function(){return this.isVisible};Jc.prototype.Uma=function(e){return this.isVisible=e};Jc.prototype.setFocus=function(){};Jc.prototype.dispose=function(){this.mm();this.xk=this.o9=this.n9=this.iTa=this.Nga=this.m9=null;Zj.prototype.dispose.call(this)};Jc.prototype.Kja=function(){this.domElement.innerHTML=Rc.bah;this.m9=Le.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Nga=Le.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.iTa=
Le.DOMElementExtensions.getElementById(this.domElement,"warningId");this.o9=Le.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.n9=Le.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.m9.checked=!0;this.Nga.checked=!0;this.ak();this.Hlc(null)};Jc.prototype.Nza=function(e){this.Nga.checked=e.vZ;this.iTa.checked=!e.vZ;this.o9.value=void 0===e.lT||null===e.lT?"":e.lT;this.n9.value=void 0===e.kT||null===e.kT?"":e.kT;this.m9.checked=e.W4;this.Hlc(null)};
Jc.prototype.kob=function(e){e.lT=this.o9.value;e.kT=this.n9.value;e.vZ=this.Nga.checked;e.W4=this.m9.checked};Jc.prototype.ak=function(){uh.a.instance.pa(Te.a.change,this.m9,this.Hlc);uh.a.instance.pa(Te.a.change,this.m9,this.xk);uh.a.instance.pa(Te.a.change,this.Nga,this.xk);uh.a.instance.pa(Te.a.change,this.iTa,this.xk);uh.a.instance.pa(Te.a.change,this.o9,this.xk);uh.a.instance.pa(Te.a.Rb,this.o9,this.xk);uh.a.instance.pa(Te.a.change,this.n9,this.xk);uh.a.instance.pa(Te.a.Rb,this.n9,this.xk)};
Jc.prototype.mm=function(){uh.a.instance.za(Te.a.change,this.m9,this.Hlc);uh.a.instance.za(Te.a.change,this.m9,this.xk);uh.a.instance.pa(Te.a.change,this.Nga,this.xk);uh.a.instance.pa(Te.a.change,this.iTa,this.xk);uh.a.instance.za(Te.a.change,this.o9,this.xk);uh.a.instance.za(Te.a.Rb,this.o9,this.xk);uh.a.instance.za(Te.a.change,this.n9,this.xk);uh.a.instance.za(Te.a.Rb,this.n9,this.xk)};tl.Object.defineProperties(Jc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Ae.a.instance.ea(1652)}}});
Object(td.a)(Jc,"DataValidationEditMessagesControl",bi.a,[628,3,629]);re.prototype.p2a=function(){return this.cellRange};Object(td.a)(re,"MacroRecorderRangeDataValidationChangedPayload",null,[98]);var uj=b(63),lj=Rf.a;vm(xd,lj);xd.prototype.NPd=function(){var e={};e=(e.key=this.Dd,e);this.initializeAndShow(Ae.a.instance.ea(1616),this.N3c,e);Fd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};xd.prototype.dispose=function(){this.disposed||(this.xdc=this.Cjc=this.R2=
null,jf.a.Fa(this.$Ab),this.$Ab=null,qi.b(this.$)&&qi.b(this.$).dRd("DataValidationDialogCorellation"),lj.prototype.dispose.call(this),this.disposed=!0)};xd.prototype.$u=function(e){lj.prototype.$u.call(this,e);this.Cc(2,Ae.a.instance.ea(1617));e=this.BU(2);var C=this.BU(1),M=this.BU(0),ra=C.parentNode;ra.appendChild(e);ra.appendChild(C);ra.appendChild(M);e.parentNode.classList.add(ye.F7g);e.classList.add(ye.E7g);e=document.getElementById("dataValidationTabsId");C=new Nc(this.$,document.createElement("div"),
this.Sba);M=new Bc(document.createElement("div"),this.Sba);ra=new Jc(document.createElement("div"),this.Sba);this.A5h(C,M,ra);var Na;this.$Ab=new vg(e,(Na=new mc.a,Na.add(C),Na.add(M),Na.add(ra),Na));this.$Ab.qNf();this.sU=document.getElementById("validationErrorMessageId");this.Nza();qi.b(this.$)&&qi.b(this.$).RQd("DataValidationDialogCorellation")};xd.prototype.WN=function(){lj.prototype.WN.call(this);document.getElementById(this.mi("WACDialogPanel")).classList.add(ye.G7g)};xd.prototype.eZ=function(){return Nc.eZ()};
xd.prototype.s$b=function(){return"validationErrorMessageId"};xd.prototype.A5h=function(e,C,M){this.R2=e;this.xdc=C;this.Cjc=M};xd.prototype.$ej=function(){function e(){return new re(C.selectedRanges,M)}var C=this,M={};M.IsClearAll=this.Xja;M.Command=this.command;M.RuleType=this.Dd.ruleType;M.ConditionType=this.Dd.$A;M.IsIgnoreBlank=this.Dd.J4;M.IsInCellDropDown=this.Dd.K4;M.LowerBoundary=this.Dd.nN;M.UpperBoundary=this.Dd.oN;M.IsAlertBlocking=this.Dd.vZ;M.IsShowErrorAlert=this.Dd.W4;M.IsShowInputMessage=
this.Dd.X4;M.AlertTitle=this.Dd.lT;M.AlertMessage=this.Dd.kT;M.InputTitle=this.Dd.yE;M.InputMessage=this.Dd.cV;M.ShouldIgnoreFormulaError=this.lMa;var ra=this.$.qa.ta.Xb();Lg.a(this.$.userOperationManager,function(Na,Ib,Gc){return nc(C.$.qa.ta,C.selectedRanges,M,hh.b(Na,C.Exd),hh.a(Ib),Gc,ra)},function(Na){return new hg.a(121,0,Na,void 0,e)},null)};xd.prototype.Pqj=function(e){return 1577787509===e};xd.prototype.emj=function(e){this.sU.innerText=e;this.uz(this.BU(0));this.lMa=!0};xd.prototype.uwe=
function(){this.lMa=!1;this.sU.innerText=""};xd.prototype.acd=function(e){switch(e){case 1173235830:return Ae.a.instance.ea(1666);case 43935303:return Ae.a.instance.ea(1667);case -1323438439:return Ae.a.instance.ea(1669);case 2112020473:return Ae.a.instance.ea(1663);case -219503282:return Ae.a.instance.ea(1664);case 1689335445:return Ae.a.instance.ea(1665);case 2146493810:return Ae.a.instance.ea(1668);case -2104909922:return String.format(Ae.a.instance.Cb(104),this.R2.Wtb(this.Dd.ruleType,this.Dd.$A),
this.R2.Jed(this.Dd.ruleType,this.Dd.$A));case -869372599:return String.format(Ae.a.instance.Cb(103),this.R2.Wtb(this.Dd.ruleType,this.Dd.$A));case -1181828368:return Ae.a.instance.ea(1671);case -758480861:return Ae.a.instance.ea(1672);case -13729088:return Ae.a.instance.ea(1673);case -846654055:return Ae.a.instance.ea(1674);case 751854001:return Ae.a.instance.ea(1675);case -453846397:return Ae.a.instance.ea(1676);case 1102013489:return Ae.a.instance.ea(1677);case 835813260:return Ae.a.instance.ea(1678);
case 1577787509:return Ae.a.instance.ea(1679);case 2083564019:return Ae.a.instance.ea(1670);default:Fd.ULS.sendTraceTag(537163265,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};xd.prototype.G8a=function(){Fd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.k$b();var e=this.KWd();var C=e.errorString;var M=e.lq;if(!e.returnValue)return this.St(C),this.Hka("OkInvalidByClient",
M),!1;this.$ej();return!0};xd.prototype.jla=function(){this.k$b();this.Hka("Cancel","None");this.hide()};xd.prototype.Lxa=function(){Fd.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.lMa?this.uwe():this.M0b();this.s9i();this.Xja=!0};xd.prototype.nW=function(e){var C={};e=(C.ButtonType=xd.Rha(e),C.DialogName=this.xc,C.Location="dialog",C.NumberOfSelectedRanges=$e.g(this.$).ha.va.nK,C);qi.b(this.$).ae(Dh.a.E4b,e)};xd.prototype.s9i=function(){this.kQb=
new fe;this.Nza()};xd.prototype.Nza=function(){this.Cjc.Nza(this.Dd);this.xdc.Nza(this.Dd);this.R2.Nza(this.Dd)};xd.prototype.k$b=function(){this.R2.kob(this.Dd);this.Cjc.kob(this.Dd);this.xdc.kob(this.Dd)};xd.prototype.Hka=function(e,C){var M={};xd.Sqb(this.Dd,M);M.o=e;M.p=C;M.n=this.Xja;this.dh&&(this.dh.stop(),M.q=this.dh.id);sd.b().Ne(49,M,!0)};xd.prototype.VMb=function(e,C){var M;var ra=M=null;if(!e)return C?(M=String.format(Ae.a.instance.Cb(104),this.R2.Wtb(this.Dd.ruleType,this.Dd.$A),this.R2.Jed(this.Dd.ruleType,
this.Dd.$A)),ra="DataValidationEditNoMinMaxError"):(M=String.format(Ae.a.instance.Cb(103),this.R2.Wtb(this.Dd.ruleType,this.Dd.$A)),ra="DataValidationEditNoValueError"),{returnValue:!1,errorString:M,lq:ra};if(e.length>Rc.R4f)return M=Ae.a.instance.ea(1670),{returnValue:!1,errorString:M,lq:ra};if(ah.d(e))return{returnValue:!0,errorString:M,lq:ra};if(1===this.Dd.ruleType||2===this.Dd.ruleType||6===this.Dd.ruleType){if(!K.a.iV(e))return M=Ae.a.instance.ea(1663),{returnValue:!1,errorString:M,lq:ra};if(1===
this.Dd.ruleType&&!K.a.isInteger(e))return M=Ae.a.instance.ea(1664),{returnValue:!1,errorString:M,lq:ra};if(6===this.Dd.ruleType){if(!K.a.isInteger(e))return M=Ae.a.instance.ea(1664),{returnValue:!1,errorString:M,lq:ra};if(0>parseInt(e))return M=Ae.a.instance.ea(1665),{returnValue:!1,errorString:M,lq:ra}}}return{returnValue:!0,errorString:M,lq:ra}};xd.prototype.KWd=function(){var e=this,C;var M=C=null;if(this.Xja||!this.Dd.ruleType)return{returnValue:!0,errorString:C,lq:M};var ra=(!this.Dd.$A||1===
this.Dd.$A)&&3!==this.Dd.ruleType&&7!==this.Dd.ruleType;return!function(){var Na=e.VMb(e.Dd.nN,ra);C=Na.errorString;M=Na.lq;return Na}().returnValue||ra&&!function(){var Na=e.VMb(e.Dd.oN,ra);C=Na.errorString;M=Na.lq;return Na}().returnValue?{returnValue:!1,errorString:C,lq:M}:ra&&(1===this.Dd.ruleType||2===this.Dd.ruleType||6===this.Dd.ruleType)&&!ah.d(this.Dd.nN)&&!ah.d(this.Dd.oN)&&parseFloat(this.Dd.nN)>parseFloat(this.Dd.oN)?(C=Ae.a.instance.ea(1668),M="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:C,lq:M}):{returnValue:!0,errorString:C,lq:M}};xd.Rha=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Fd.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};xd.Sqb=function(e,C){C.a=ve(e.ruleType);C.b=kc(e.$A);C.c=!!e.nN;C.d=!!e.oN;C.e=e.J4;C.f=e.K4;C.g=e.X4;C.h=!!e.yE;C.i=!!e.cV;C.j=e.W4;C.k=e.vZ;C.l=!!e.lT;C.m=!!e.kT};tl.Object.defineProperties(xd.prototype,
{Dd:{configurable:!0,enumerable:!0,get:function(){return this.kQb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var e=this;return function(){e.nW(1);e.G8a()}},set:function(e){Object(uj.b)(xd.prototype,this,"onCommitDialogHandler",e)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},j0b:{configurable:!0,enumerable:!0,get:function(){return 3===this.R2.lXg}}});Object(td.a)(xd,
"DataValidationEditDialogDeprecated",Rf.a,[]);gd.prototype.UGa=function(e,C,M,ra){ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new cb(e,C,M,ra)).NPd():(new xd(e,C,M,ra)).NPd()};gd.prototype.I_g=function(e,C){var M=new kf.StandardDialog;M.kc=3;M.cAa(e.Ab.cZ,Ae.a.instance.ea(1661),C)};gd.prototype.K_g=function(e,C){var M=new kf.StandardDialog;M.kc=1;M.GW(e.Ab.cZ,Ae.a.instance.ea(1662),C)};Object(td.a)(gd,"DataValidationEditDialogFactory",null,[605]);var Gh=
af.a;vm(hc,Gh);hc.prototype.Md=function(){this.Ed([new Wc(this.$,new gd)])};hc.ja=function(e){af.a.de(245,new hc(e))};Object(td.a)(hc,"DataValidationEditCommandHandlerFactory",af.a,[]);le.Ceg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(td.a)(le,"FileUploadDialogHTML",null,[]);var fi=b(369),wi=tj.a;vm(Be,wi);Be.prototype.ri=function(e,C,M,ra,Na){Na=void 0===Na?!0:Na;this.dtd=void 0===ra?!1:ra;this.Qrj(C);this.kkf=e;Na&&jd.AFrameworkApplication.nF(e)};Be.prototype.Qrj=function(e){if(Be.gy)this.Ctj(e);else{var C={};C[Be.lOg]=e;C[Be.rOg]=CommonUIStrings.l_SendFileErrorReportMessage;C[Be.sOg]=CommonUIStrings.l_SendFileErrorReportTextCaption;C[Be.wXc]="";C[Be.oOg]=CommonUIStrings.l_UserReportLinkText;C[Be.A_b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(xb.a)(this,this.gki,"legacyDialogHandler"),C);this.zW(Be.xOg)}};Be.prototype.Ctj=function(e){var C={},M={},ra={},Na={},Ib={};e=(Ib.id=this.Me,Ib.bodyControls=(Na.reportErrorCheckboxProps=this.dtd?(C.label=CommonUIStrings.l_UserReportLinkText,C):null,Na.textAreaProps=this.Wkf?{}:null,Na.privacyStatementLinkProps=(ra.text=CommonUIStrings.l_PrivacyStatement,ra.handler=(M.href=jd.AFrameworkApplication.Tla,M.target="_blank",M),ra),Na),Ib.errorMessage=e,Ib.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
Ib.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,Ib);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(xb.a)(this,this.cEd,"reactDialogHandler"),e)};Be.prototype.q8a=function(){if(!Be.gy){var e=document.getElementById(Be.uOg);e&&(e.className=Be.tOg,e.appendChild(fi.createClusteredImage(32,32,Be.qOg,null,!0,CommonUIStrings.l_DialogError)));if(e=document.getElementById(Be.vOg))e.innerText=CommonUIStrings.l_PrivacyStatement,e.href=jd.AFrameworkApplication.Tla,T.a.addHandler(e,
"click",Object(xb.a)(this,this.qIi,"onPrivacyClickHandler"));this.Wkf||(e=document.getElementById(Be.wXc))&&e.parentNode&&e.parentNode.removeChild(e);this.dtd||(e=document.getElementById(Be.nOg))&&e.parentNode&&e.parentNode.removeChild(e)}};Be.prototype.WN=function(){Be.gy||(wi.prototype.WN.call(this),document.getElementById(this.mi("WACDialogPanel")).style.width=String.format("{0}px",400))};Be.prototype.gki=function(e,C){var M=C[Be.wXc]||"",ra=!0;void 0!==C[Be.A_b]&&null!==C[Be.A_b]&&(ra=C[Be.A_b]);
this.Ov(e,M,ra)};Be.prototype.cEd=function(e,C){this.Ov(e,C.text||"",C.reportErrorChecked)};Be.prototype.Ov=function(e,C,M){this.ekf&&(M&&Fd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.kkf),this.ekf(e,C,M))};Be.prototype.qIi=function(e){jd.AFrameworkApplication.Eb.ze(qa.a.Eya,2,e)};tl.Object.defineProperties(Be.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});tl.Object.defineProperties(Be,{gy:{configurable:!0,enumerable:!0,get:function(){return jd.AFrameworkApplication.sa.Pa.Lu&&
jd.AFrameworkApplication.sa.Pa.Xdi}}});Be.lOg="WACDialogErrorMessage";Be.rOg="WACDialogErrorReportMessage";Be.sOg="WACDialogErrorTextPrompt";Be.wXc="WACDialogInput";Be.vOg="WACDialogPrivacyText";Be.uOg="WACDialogIconPanel";Be.qOg="CancelRequest_32x32x32";Be.tOg="WACDialogIcon";Be.xOg="WACDialogTextPanel";Be.A_b="WACDialogSendFileCheckbox";Be.nOg="WACDialogSendFileCheckboxContainer";Be.oOg="WACDialogSendFileCheckboxText";Be.pOg="FileUploadErrorDialog";Object(td.a)(Be,"FileUploadErrorDialog",tj.a,[]);
var ej=Zg.a;vm(Ce,ej);Ce.prototype.Izg=function(e){this.addHandler("fileCollectionComplete",e)};Ce.prototype.$3i=function(e){this.removeHandler("fileCollectionComplete",e)};Ce.prototype.nVg=function(e,C,M){this.iFf=C;this.AG=e;this.Izg(M);jd.AFrameworkApplication.Tla=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;e=new Be(this.oVg);jd.AFrameworkApplication.Eb.$b(qa.a.Eya,ya.a.frame,Ce.uUi);e.ri(0,"",null,!1,!1)};Ce.prototype.L2i=function(e){this.$3i(e)};Ce.uUi=function(e,C,M,ra,Na){T.a.nt(Na);
jd.AFrameworkApplication.Tla&&ab.HelperMethods.sf(jd.AFrameworkApplication.Tla,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(td.a)(Ce,"FileCollectionOperation",Zg.a,[606,3]);var gj=tb.a;vm(ue,gj);ue.prototype.create=function(){var e=this;xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){e.Fb(e.Oth)},this.ma,3)};ue.prototype.dispose=function(){jf.a.Fa(this.MQb);this.MQb=null;gj.prototype.dispose.call(this)};ue.ja=function(e){e.da.Ha(125,
new ue(e))};tl.Object.defineProperties(ue.prototype,{Oth:{configurable:!0,enumerable:!0,get:function(){return this.MQb||(this.MQb=new Ce(this.$))}}});Object(td.a)(ue,"FileCollectionCommandHandlerFactory",tb.a,[]);var ig=b(928),Hj=b(177),rj=b(261),Wi=b(1022);ie.zzh="GalleryGeneral";ie.Bzh="GalleryNumber";ie.xzh="GalleryCurrency";ie.vzh="GalleryAccounting";ie.Ezh="GalleryShortDate";ie.Azh="GalleryLongDate";ie.Gzh="GalleryTime";ie.Czh="GalleryPercentage";ie.yzh="GalleryFraction";ie.Dzh="GalleryScientific";
ie.Fzh="GalleryText";ie.QNg="ButtonComma";ie.buttonPercentage="ButtonPercentage";ie.keyboardNumber="KeyboardNumber";ie.keyboardCurrency="KeyboardCurrency";ie.keyboardDate="KeyboardDate";ie.keyboardTime="KeyboardTime";ie.keyboardPercentage="KeyboardPercentage";Object(td.a)(ie,"RibbonFormatKind",null,[]);var Nk=b(287),ek=b(665),Yi=b(664),Mj=b(663),vj=Nk.a;vm(Qc,vj);Qc.prototype.t2=function(e){return vj.prototype.t2.call(this,e)||this.Uxh.t2(this.Z$c,this.activeCell,this.format,this.Koe,this.ADf,this.vDf,
this.BYb,this.DEa,this.clientCorrelationId,this.Nkb,this.chb)};Qc.prototype.Wl=function(){var e=[];if(this.obc)for(var C=yl(this.obc),M=C.next();!M.done;M=C.next())e.push(Mj.a(M.value));else e.push(new Yi.a(this.format,this.Z$c,this.activeCell));return function(){return new ek.a(e)}};Qc.prototype.fdb=function(){var e={OperationType:0};e.FormatCellsMultiRange=this.Z$c;e.ActiveCell=this.activeCell;e.Format=this.format;e.ApplyFormatOnPivotTableValueField=this.Koe;e.PivotTableXluid=this.ADf;e.PivotTableFieldCaption=
this.vDf;return e};tl.Object.defineProperties(Qc.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ld.EwaSettings.tc()?Object(uj.a)(Qc.prototype,this,"operationWorkingState"):0}},lr:{configurable:!0,enumerable:!0,get:function(){return this.Nkb}},I3:{configurable:!0,enumerable:!0,get:function(){return this.chb}},pAc:{configurable:!0,enumerable:!0,get:function(){return this.DEa}}});Object(td.a)(Qc,"FormatCellsBatchOperation",Nk.a,[]);var Qj=b(201);Sc.editCell="Edited";
Sc.dependentCell="Dependents";Object(td.a)(Sc,"RecalcPriorityGroupType",null,[]);var Aj=b(217),Mi=b(9);Object(td.a)(Lf,"RecalcAccuracyObject",null,[]);Ig.string="String";Ig.blank="Blank";Ig.general="General";Ig.Dwh="Flexible";Object(td.a)(Ig,"FormattedUnitKind",null,[]);Object(td.a)(Ne,"RecalcResultProcessingStatistics",null,[]);Object(td.a)(Xe,"RecalcedCellInfo",null,[]);var Ad=b(106),Se=b(60),Vg=b(586);je.prototype.dispose=function(){this.calcManager=this.nxc=this.hi=this.grid=this.$=null};je.prototype.eGf=
function(e){var C;if(e&&e.rangeDeltas){for(var M=this.wca.length,ra=0;ra<e.rangeDeltas.length;ra++)(null===(C=e.rangeDeltas[ra])||void 0===C?0:C.data)&&void 0!==e.rangeDeltas[ra].data.value&&null!==e.rangeDeltas[ra].data.value&&void 0!==e.rangeDeltas[ra].range&&null!==e.rangeDeltas[ra].range&&Array.add(this.wca,new Xe(e.rangeDeltas[ra],e.stateId,e.isFinished,e.priorityGroup));Fd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
e.stateId,e.priorityGroup,e.isFinished,e.rangeDeltas.length,M,this.wca.length,this.lastSetCellInstantaneousOperation);!M&&this.wca.length&&this.Uxf(!1,0)}};je.prototype.Q9c=function(e,C,M,ra,Na,Ib,Gc){if(!C)return Object(Vg.a)("Null");var id=excelOnlineCalc.numfmt.renderCallback(ra,function(Vd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(Vd,Na,!0,ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Gc),Uc=e.renderValue(C,id);if(!excelOnlineCalc.util.isSuccess(Uc))return Object(Vg.a)("Finalize");
ra=null;if(Gc=excelOnlineCalc.numfmt.isHashesValue(Uc.value)){if(Uc=e.renderHashesValue(Uc.value,id),!excelOnlineCalc.util.isSuccess(Uc))return Object(Vg.a)("Hashes")}else ra=je.gyh(C,Uc.value);id=Uc.value;e=excelOnlineCalc.numfmt.renderedValueToString(id);C=sc(id);id=xg(id);return Object(Vg.d)({text:e,valueType:M,fontColor:id,Gm:Ib,T7a:ra,horizontalAlignment:C,isHashesValue:Gc})};je.prototype.Uxf=function(e,C){var M=this;this.$&&this.grid&&this.calcManager&&this.nxc&&this.calcManager.Np?(e&&(this.qca=
this.nxc.G8e),this.YUi(this.grid,this.calcManager.Np,e,C),!this.qca&&this.wca.length?wg.Task.delay(0).CWRCT(function(ra){M.Uxf(!0,ra.id);return!0},null,0,Se.a.current):wg.Task.Ta(!0)):(Fd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),wg.Task.Ta(!1))};je.prototype.YUi=function(e,C,M,ra){var Na=ab.HelperMethods.jc();for(M=new Ne(this.wca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.qca,void 0,void 0,void 0,M,void 0,ra,!0,0,0,0,0,0,0);0<this.wca.length;){ra=ab.HelperMethods.jc()-Na;if(!this.qca||ra>this.qca){M.numberOfCellsSkippedDueToTimeout=this.wca.length;break}ra=Array.dequeue(this.wca);if(sf(ra,M)){var Ib=Ug.Range.ld(ra.rangeDelta.range.row+1,ra.rangeDelta.range.column+1);(Ib=e.sc(Ib))?je.MPg(ra.stateId,Ib.cell)?(je.vkc(e,Ib,ra,M),this.dGg(C,Ib,ra,M)):M.numberOfCellsUpdatedAlreadyByServer++:M.numberOfCellsWithNoFormattedCell++}}ra=Math.round(ab.HelperMethods.jc()-
Na);this.ILj(ra);this.bzj(M,ra);this.z8i(M)};je.prototype.dGg=function(e,C,M,ra){var Na=ag(C,M),Ib=M.rangeDelta.data.formatted,Gc=uf(M);e=this.Q9c(e,Ib,Gc,C.cell.aSa,C.cell.Fsa,Na,!1);if(Object(Vg.c)(e))C.text!==e.value.text&&(this.hi.Vmb(C,e.value),(Na=Hf(M))?1===Na?Na=2:(Fd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),Na=0):Na=1,this.hi.qIe(C,this.lastSetCellInstantaneousOperation,2,Na,!0,!0),ra.numberOfUpdatedCells++);else switch(e.reason){case "Null":ra.numberOfRecalcedCellsWithoutFormattedValue=
null==ra.numberOfRecalcedCellsWithoutFormattedValue?0:ra.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":ra.numberOfHashFormattedValues=null==ra.numberOfHashFormattedValues?0:ra.numberOfHashFormattedValues+1;break;case "Finalize":ra.newNumberFormatterFinalizeFailures=null==ra.newNumberFormatterFinalizeFailures?0:ra.newNumberFormatterFinalizeFailures+1}Object(Vg.b)(e)&&"Null"!==e.reason&&(ra.numberOfRecalcedCellsWithFormattedValue=null==ra.numberOfRecalcedCellsWithFormattedValue?0:
ra.numberOfRecalcedCellsWithFormattedValue+1);ra=(M=Hf(M))?C.formulaBarText:C.cell.userInput;Na=Object(Vg.c)(e)?e.value.text:"";Ib=Object(Vg.b)(e)?e.reason:"";Fd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",C.range.top,C.range.left,e.success,Ib,M,C.cell.Gm,ra?K.a.dJ(ra):"null",Na?K.a.dJ(Na):"null")};je.prototype.ILj=function(e){this.qca=Math.max(this.qca-
Math.max(e,1),0)};je.prototype.bzj=function(e,C){e.numberOfNonUpdatedCells=this.wca.length;e.totalExecutionTime=C;e.newProcessingTimeLimit=this.qca;e.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};je.prototype.z8i=function(e){e=Sys.Serialization.JavaScriptSerializer.serialize(e);Fd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",e)};je.gyh=function(e,C){e=e.units;var M=C.units;if(e.length!==M.length)return Fd.ULS.sendTraceTag(537162179,
0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;C=[];for(var ra=-1,Na=0;Na<e.length;Na++)switch(e[Na].kind){case Ig.blank:C.push.apply(C,Ad.h(" ",M[Na].str.length));break;case Ig.string:C.push(e[Na].str);break;case Ig.Dwh:C.push("");ra=Na;break;case Ig.general:C.push(M[Na].str);break;default:Fd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=
ra||""===M[ra].str)return null;M={};M.Start=C.slice(0,ra).join("");M.Separator=e[ra].str;M.End=C.slice(ra+1,C.length).join("");return M};je.AEh=function(e){return e&&e&&e.Eu?e.Eu.fJ:Mi.a.Se};je.MPg=function(e,C){if(!C)return!1;C=je.AEh(C);return C===Mi.a.Se||C===e};je.vkc=function(e,C,M,ra){var Na=M.rangeDelta.data.value.toString(),Ib=uf(M),Gc=ag(C,M);Na=new Lf(Ib,Na,Gc,M.priorityGroup);C.cell.vkc(Na,e.Ca.OE);1===Hf(M)?ra.numberOfDependentRecalcedCellsInBatch++:ra.numberOfEditedRecalcedCellsInBatch++};
je.TDe=20;Object(td.a)(je,"CalcResultProcessor",null,[634,3]);Object(td.a)(nd,"GetRibbonNumberFormatResult",null,[]);Xd.prototype.mIb=function(e,C,M){var ra=C.Border;C=C.BorderFormat;var Na=0,Ib=!1;if(ra){for(var Gc=0;3>=Gc;Gc++)Xd.toj(e,M,Gc,ra)&&(Na|=ab.HelperMethods.xtb(Gc),this.hVd(e.cell.getRange(),Gc,C),Ib=!0);ab.HelperMethods.yQ(ra,16)&&!ah.c(e,0,M)&&(Na|=2,this.hVd(e.cell.getRange(),0,C),Ib=!0);ab.HelperMethods.yQ(ra,32)&&!ah.c(e,2,M)&&(Na|=4,this.hVd(e.cell.getRange(),2,C),Ib=!0);Ib&&(M=
e.cell.Eu.Wf,ab.HelperMethods.yQ(Na,2)&&this.mZf(e,M,0)&&(Na&=-3),ab.HelperMethods.yQ(Na,1)&&this.lZf(e,M,1)&&(Na&=-2),ab.HelperMethods.yQ(Na,4)&&this.mZf(e,M,2)&&(Na&=-5),ab.HelperMethods.yQ(Na,8)&&this.lZf(e,M,3)&&(Na&=-9),e.cell.setBorders(C,Na,!1))}else e.cell.YKf(),this.o2i(e.cell.getRange())};Xd.prototype.oua=function(e,C){e=Xd.ITe(e,C);return e.isValidRange?(e=this.Ca.nJa(e))&&e.length?e:null:null};Xd.prototype.o2i=function(e){for(var C=0;3>=C;C++){var M=Xd.ITe(e,C);if(M.isValidRange&&(M=this.Ca.nJa(M))&&
M.length)for(var ra=Xd.TYe(C),Na=0;Na<M.length;Na++)M[Na].QFd(ra)}};Xd.prototype.hVd=function(e,C,M){if(e=this.oua(e,C))for(var ra=Xd.TYe(C),Na=ab.HelperMethods.xtb(ra),Ib=0;Ib<e.length;Ib++){var Gc=e[Ib];this.i9h(Gc,ra)&&Xd.setBorders(Gc,M,Na,C,ra)}};Xd.prototype.i9h=function(e,C){var M=e.Eu.Wf,ra=e.getRange();ra=this.oua(ra,C);var Na=!1,Ib=!1,Gc=!1,id=!1;ra&&(Na=Xd.q5a(ra,!0),Ib=Xd.q5a(ra,!1),id=Xd.Vmd(ra),Gc=1===ra.length?!0:!1);switch(C){case 0:return Xd.z8h(e,M,id,Ib,Gc);case 1:return Xd.w8h(e,
M,id,Na,Gc);case 2:return Xd.x8h(e,M,id,Na,Gc);case 3:return Xd.y8h(e,M,id,Ib,Gc)}return!1};Xd.prototype.mZf=function(e,C,M){if(!e.cell.FM)return!1;var ra=e.range,Na=this.oua(ra,M),Ib=ah.c(e,M,C),Gc=!1;C=M?ra.left<C.left:ra.top<C.top;!Xd.Yxb(e.cell)&&Na&&1!==Na.length&&(Gc=(M?Xd.q5a(Na,!1):Xd.q5a(Na,!0))?!1:!0);return!Ib&&Gc||C?!0:!1};Xd.prototype.lZf=function(e,C,M){var ra=e.cell,Na=this.oua(ra.getRange(),M);e=ah.c(e,M,C);C=!1;if(Na){var Ib=Xd.q5a(Na,!0),Gc=Xd.q5a(Na,!1),id=Ib&&!Gc;Gc=Gc&&!Ib;1!==
M||Xd.Myb(ra)?3!==M||Xd.Nxb(ra)||Xd.Aoj(ra,Na,Gc,id)&&(C=!0):Xd.zoj(ra,Na,Ib,Gc)&&(C=!0)}return!e&&C||Xd.Yxb(ra)?!0:!1};Xd.qLg=function(e,C,M){var ra={};ra.LineStyle=Array(4);ra.LineStyle[M]=e.LineStyle[C];ra.Color=Array(4);ra.Color[M]=e.Color[C];return ra};Xd.O9e=function(e,C,M,ra,Na){return ab.HelperMethods.yQ(e,Na)&&ah.c(C,M,ra)};Xd.toj=function(e,C,M,ra){return Xd.O9e(ra,e,M,C,ab.HelperMethods.xtb(M))||Xd.O9e(ra,e,M,C,64)||112===ra};Xd.setBorders=function(e,C,M,ra,Na){C=Xd.qLg(C,ra,Na);e.setBorders(C,
M,!1)};Xd.ITe=function(e,C){switch(C){case 0:return new Ug.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new Ug.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new Ug.Range(e.bottom+1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new Ug.Range(e.top,e.right+1,e.bottom,e.right+1,!1,!1)}return e};Xd.TYe=function(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Xd.q5a=function(e,C){for(var M=0;M<e.length;M++){var ra=e[M];if(ra.FM)return C?Xd.Nxb(ra):
Xd.Myb(ra)}return!1};Xd.Yxb=function(e){var C=e.Eu.Wf,M=e.getRange();return e.FM&&(M.top<C.top||M.bottom>C.bottom||M.left<C.left||M.right>C.right)?!0:!1};Xd.Vmd=function(e){for(var C=0;C<e.length;C++)if(Xd.Yxb(e[C]))return!0;return!1};Xd.zoj=function(e,C,M,ra){if(!e.FM){if(!M||Xd.Vmd(C))return!0}else if(Xd.Nxb(e)&&(1===C.length&&Xd.xGg(e,C[0])||!M))return!0;return ra};Xd.Aoj=function(e,C,M,ra){if(!e.FM){if(!M||Xd.Vmd(C))return!0}else if(Xd.Myb(e)&&(1===C.length&&Xd.yGg(e,C[0])||!M))return!0;return e.oka||
ra};Xd.z8h=function(e,C,M,ra,Na){var Ib=e.getRange();return Xd.Nxb(e)?Xd.Yxb(e)||Na:C.top===Ib.top||!ra||M};Xd.w8h=function(e,C,M,ra,Na){var Ib=e.getRange();return Xd.Nxb(e)?C.bottom===Ib.bottom&&Na:ra&&!M||C.bottom===Ib.bottom};Xd.x8h=function(e,C,M,ra,Na){var Ib=e.getRange();return Xd.Myb(e)?Xd.Yxb(e)||Na:C.left===Ib.left||!ra||M};Xd.y8h=function(e,C,M,ra,Na){var Ib=e.getRange();return e.oka?!1:Xd.Myb(e)?C.right===Ib.right&&Na:ra&&!M||C.right===Ib.right};Xd.Nxb=function(e){return 0<e.getRange().right-
e.getRange().left};Xd.Myb=function(e){return 0<e.getRange().bottom-e.getRange().top};Xd.yGg=function(e,C){e=e.getRange();C=C.getRange();return e.top===C.top&&e.bottom===C.bottom};Xd.xGg=function(e,C){e=e.getRange();C=C.getRange();return e.left===C.left&&e.right===C.right};Object(td.a)(Xd,"BorderModelAccessorHelper",null,[]);ce.prototype.rbb=function(e,C,M,ra,Na,Ib){e&&(e.L6(C,M,void 0===Na?!1:Na,void 0===Ib?!1:Ib),e.verticalAlignment=ra)};ce.prototype.mIb=function(e,C,M){this.fY||(this.fY=new Xd(this.Ca,
this.r1a));this.fY.mIb(e,C,M)};Object(td.a)(ce,"FormatCellsActionModelAccessor",null,[633]);Xc.prototype.isValid=function(){return this.Al&&this.Np?!(void 0===this.formatString||null===this.formatString):!1};Xc.prototype.BKh=function(){return null!=this.mE?this.mE:this.formatString};tl.Object.defineProperties(Xc.prototype,{mE:{configurable:!0,enumerable:!0,get:function(){return this.vkg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.W7a)return this.W7a;if(this.$pa)return this.$pa.formatString;
if(!this.Al)return null;if(null!=this.mE){var e=this.mE;return 0>e?(Fd.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(e=this.Al.Jba[e])?this.W7a=e.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.$pa?this.$pa:this.Np&&this.formatString?this.$pa=this.Np.createFormat(this.formatString,this.JNg).value:null}},JNg:{configurable:!0,enumerable:!0,get:function(){if(!this.Al||null==this.mE||0>this.mE)return!1;
var e=this.Al.Jba[this.mE];return e?e.Builtin:!1}}});Object(td.a)(Xc,"NumberFormatHolder",null,[632]);var Wj=b(247);Object(td.a)(ed,"FormatCellInstantaneousResult",null,[]);Object(td.a)(Pb,"FormatStringResult",null,[]);var Ck=b(1187),zf=b(525),Vh=b(193),ji;(function(e){e.InvalidInput="invalid input";e.UnsupportedZeroResize="resizing to 0 - ignore";e.UnsupportedSkeletonInView="skeleton in view - ignore";e.NullSPD="ActiveSheetProcessedData is null";e.UnsupportedHiddenInRange="hiddens in resizeRanges";
e.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ji||(ji={}));Object(td.b)("InstantaneousRowColumnResizeFailureReason",ji);Hb.prototype.dispose=function(){jf.a.pc([this.wRa,this.w2]);this.$=this.w2=this.wRa=null};Hb.prototype.pRa=function(e,C,M,ra,Na,Ib,Gc,id,Uc){return this.Gsj(e,C,M,void 0===Na?!1:Na,void 0===id?0:id,void 0===Ib?"":Ib,void 0===Uc?null:Uc)};Hb.prototype.qIe=function(e,C,M,ra,Na,Ib){e.cell.Eu.JP|=ra;Hb.$Wg($e.g(this.$),e,M,Na);this.w2.lastSetCellInstantaneousOperation=
C;Ib&&$e.g(this.$).Ji.m0(C,fh.BasicTelemetryCalculator.sQ)};Hb.prototype.gna=function(e,C,M,ra,Na,Ib){ra=void 0===ra?!1:ra;Na=void 0===Na?null:Na;var Gc=void 0===Gc?null:Gc;Ib=(void 0===Ib?null:Ib)||e.ha.va.selectedRanges;if(!(-1690267012===C&&1<Ib.length)){-1690267012===C&&Fd.ULS.shipAssertTag(537162176,0,1===Ib.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Ib.length);var id=e.l$("FormatCellsAction.ShowInstantaneousFormatting",Ib);try{id.$$rst();for(var Uc=!1;id.$$mn();){var Vd=
void 0,Ye=id.$$cu().VJ?e.ctc(id.$$cu().range):(Vd=new mc.a,Vd.add(id.$$cu()),Vd);Vd={};for(var Gf=yl(Ye),rg=Gf.next();!rg.done;Vd={Neb:Vd.Neb},rg=Gf.next()){var Dg=rg.value;if($e.g(this.$).Xy&&Dg&&Gc&&-1690267012===C&&(Vd.Neb=Dg.range,Vd.Neb&&Gc.contains(Vd.Neb)&&ai.a.all(Ib,function(Eg){return function(Ch){return!sg.c(Ch,Eg.Neb)}}(Vd))))continue;if(!Dg||id.gd.contains(Dg.range))if(this.Hsj(C,Dg,M,ra,Na,id.$$cu().VJ),Uc||(e.Ca.fV(),Uc=!0),Na)break}}}finally{id&&id.dispose()}}};Hb.prototype.Vmb=function(e,
C,M){if(M=void 0===M?null:M)M.UKa=!0;M=!C.text;var ra=K.a.fcf(C.text),Na,Ib=e.VJ?$e.g(this.$).ctc(e.range):(Na=new mc.a,Na.add(e),Na);Na=yl(Ib);for(Ib=Na.next();!Ib.done;Ib=Na.next())this.bGg(this.$,Ib.value,C.text,C.horizontalAlignment,C.fontColor,C.Gm,e.cell.Gm,M,ra,C.valueType,C.T7a);e.cell.eAc()};Hb.prototype.XPi=function(e,C,M,ra,Na){Na=void 0===Na?null:Na;try{var Ib=sg.D(C),Gc=sg.D(M);if(e.Vb.r5a(Ib)||e.Vb.r5a(Gc))return 8;if(-185374993!==ra&&this.Dfi(e,Ib,Gc))return 9;if(-185374993!==ra&&(e.Vb.S4(Gc)||
e.Vb.jyb(Ib)))return 10;if(1804571062!==ra&&e.Vb.R4(Gc))return 11;if(this.Nch(Gc))return 12;if(this.rgi(Ib,Gc))return 13;var id=this.$.Ub.Fc("UserAction","PasteInstantaneous");id.start();zf.a(id);Na&&sd.b().CB(id.id,Na.id,"actions","actions");!Ib.isSingle&&Gc.isSingle&&(Gc=Hb.expandRange(Ib,Gc),e.ha.updateSelection(Gc,Gc,0));switch(ra){case 237279923:case 808159687:if(!this.pQi(Ib,Gc))return 14;this.h1c(e,Ib,Gc,!0,!1);break;case 1804571062:this.h1c(e,Ib,Gc,!0,!1);break;case -185374993:this.h1c(e,
Ib,Gc,!1,!0);break;default:return 2}Fd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Uc){return Fd.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Uc)),15}};Hb.prototype.YTg=function(e,C){e=yl(e);for(var M=e.next();!M.done;M=e.next())this.KZc(M.value,!0,C)};Hb.prototype.KZc=function(e,C,M){M=void 0===M?"":M;if(e){var ra=$e.g(this.$);if(C){if(C=ra.sl("FormatCellsAction.ClearRangeInstantaneous",
e),e=e.isSingle?null:e,C.$$mn()&&void 0!==C.$$cu()&&null!==C.$$cu())for(ra=Object.assign(new Jh.a,{Text:""}),this.pRa(C.$$cu(),ra,!1,void 0,cg.a.Fmd(this.$),M,void 0,void 0,e);C.$$mn();)void 0!==C.$$cu()&&null!==C.$$cu()&&this.pRa(C.$$cu(),ra,!1,void 0,!1,M)}else this.gna(ra,-1228228458,{},void 0,void 0,[e])}else Fd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};Hb.prototype.z_i=function(e,C){if(!C){C=ab.HelperMethods.jc();var M=$e.g(this.$),
ra=M.l$("FormatCellsAction.ReformatCells",e);try{ra.$$rst();for(var Na=!1;ra.$$mn();){var Ib=ra.$$cu().cell;Ib.HT&&2!==Ib.HT||(this.sLj(Ib,e),Na||(M.Ca.fV(),Na=!0))}}finally{ra&&ra.dispose()}Fd.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",ab.HelperMethods.jc()-C)}};Hb.prototype.Xgd=function(e,C){if(this.zg){if(e.formulaBarText)return!K.a.equals(C.Text,e.formulaBarText,!1);var M=e.cell.formattedText;this.Cod&&(M=Wj.a(M,e.cell.getCellFont()));
return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(M,C).isEqual}return!K.a.equals(C.Text,e.text,!1)};Hb.prototype.byh=function(e){if(void 0===e||null===e)return new Pb(!1,"1234.56");e=new Xc(this.Al,this.Np,void 0,e);if(!e.isValid())return new Pb(!1,"1234.56");e=this.N1a({value:"1234.56",type:1},e,244,"12px sans-serif");return Object(Vg.b)(e)?new Pb(!1,"1234.56"):new Pb(!0,e.value.text)};Hb.prototype.Isj=function(e,C,M,ra){return Me(e,this,C,M,ra,!0)};Hb.prototype.Esj=function(e,C,M){if(!this.Xgd(C,
M))return Object(Vg.d)("Skip unchanged cell content");C=C.cell;var ra=new Xc(this.Al,this.Np,C.Gm);M=this.cSe(M.Text,ra,C.aSa,C.Fsa,!0);Object(Vg.b)(M)?e=M:(M=M.value,ra=C.hasRichValueIcon?"Unsupported rich value icon":C.B7?"Unsupported wrapped text":C.Oyb||null!=C.S4f&&0!==C.S4f?"Unsupported rotated text":!0,!0!==ra?e=Object(Vg.a)(ra):(C.isCellWidthFixed?ra="Skip fixed width cell":(ra=M.valueType,ra=0===ra?"Skip empty cell value":2===ra?"Skip string cell value":C.FM&&!C.xfi?"Skip merged cell":C.ewc?
"Skip shrunk to fit":M.isHashesValue?"Skip hashes cell value":!0),!0!==ra?e=Object(Vg.d)(ra):(M=C.vYg(M.text),M>C.offsetWidth?(C=[C.getRange().clone()],e=Me(e,this,C,M,!1,!1),e=Object(Vg.b)(e)?e:Object(Vg.d)(M)):e=Object(Vg.d)("Column is wide enough"))));return e};Hb.prototype.ayh=function(e,C,M){var ra=Number.POSITIVE_INFINITY;C=new Xc(this.Al,this.Np,C);if(!C.isValid())return new Pb(!1,e);var Na={};Na.value=e;Na.type=1;M=this.N1a(Na,C,ra,M);return Object(Vg.b)(M)?new Pb(!1,e):new Pb(!0,M.value.text)};
Hb.prototype.sLj=function(e,C){var M=e.getRange(),ra=!1;C=yl(C);for(var Na=C.next();!Na.done;Na=C.next())if(M.left===Na.value.left){ra=!0;break}e.BIj(ra)};Hb.prototype.Gsj=function(e,C,M,ra,Na,Ib,Gc){var id=void 0;Ib=void 0===Ib?"":Ib;id=void 0===id?1:id;Gc=void 0===Gc?null:Gc;var Uc=new ed;Uc.source=0;Uc.UKa=!1;e.cell.jnc=e.cell.Gm;var Vd=C.Text,Ye=!Vd,Gf=K.a.fcf(Vd);K.a.wn(Vd)&&(Fd.ULS.shipAssertTag(537162142,0,!((void 0===Vd||null===Vd)&&void 0!==C.TextRuns&&null!==C.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),
C=Object.assign(new Jh.a,{Text:""}),Vd="");e.cell.userInput=Vd;if(!this.Xgd(e,C))return this.vRg(e,Na,Ye,Gf,Uc);M?this.oRg(e,Vd,this.$.workbookContext.DefaultHyperlinkStyle,Uc):this.iRg(e,C,Vd,Ye,Gf,ra,Uc,Gc);this.qIe(e,Ib,Na,id,Uc.Zfc,Uc.UKa);return Uc};Hb.prototype.vRg=function(e,C,M,ra,Na){Na.rbg=!0;Na.Zfc=!0;Na.UKa=!1;C||$e.g(this.$).Ca.fV();e.cell.pOa||(M?e.cell.L6(0,!1):ra&&e.cell.L6(1,!1));return Na};Hb.prototype.oRg=function(e,C,M,ra){ra.UKa=!0;e.insertHyperlink(C,Qj.a.q$c(C),M)};Hb.prototype.iRg=
function(e,C,M,ra,Na,Ib,Gc,id){id=void 0===id?null:id;Gc.UKa=!1;var Uc=e.cell;this.Al||(this.Al=this.$.da.Aa(268));this.FEj(this.Al,Uc.Gm);ra||Na?this.kRg(e,ra,Na,Gc):(ra=new Xc(this.Al,this.Np,Uc.Gm),ra=this.cSe(M,ra,Uc.aSa,Uc.Fsa,!1),Object(Vg.c)(ra)?(this.Gpj(C.TextRuns,C.Fonts)&&this.mRg(e,C,ra.value),this.Vmb(e,ra.value,Gc)):this.sRg(e,C.Text),C=Object(Vg.c)(ra)?ra.value.text:"",Na=Object(Vg.b)(ra)?ra.reason:"",Fd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",
e.range.top,e.range.left,ra.success,Na,Uc.Gm,K.a.Nmb(Uc.userInput),K.a.Nmb(C)));Uc.formulaBarText=M;Ib&&this.jEj(this.Al,e,M,id);Gc.Zfc=!0};Hb.prototype.kRg=function(e,C,M,ra){ra.UKa=!0;e.text="";e.formulaBarText="";e.cell.userInput="";this.HYc(e,null,null,C,M)};Hb.prototype.mRg=function(e,C,M){this.eec&&1===C.TextRuns.length&&e.cell.OFg(C.Fonts[C.TextRuns[0].FontID]);C.Text===M.text&&2===M.valueType&&(this.eec&&1===C.TextRuns.length?e.cell.text=C.Text:e.cell.formattedText=C)};Hb.prototype.sRg=function(e,
C){e.text=C;e.formulaBarText=C;this.HYc(e,1)};Hb.prototype.HYc=function(e,C,M,ra,Na,Ib){M=void 0===M?null:M;ra=void 0===ra?!1:ra;Na=void 0===Na?!1:Na;Ib=void 0===Ib?!1:Ib;var Gc=e.horizontalAlignment;M=null!=M?M:e.verticalAlignment;!e.cell.pOa&&(null!=C||ra||Na||Ib)&&(ra?Gc=0:Na||Ib?Gc=1:null!=C&&(Gc=C),this.cua.rbb(e,Gc,!1,M,!0))};Hb.prototype.FEj=function(e,C){(null===e||void 0===e?0:e.Jba)&&C>=Hb.iwh&&C>e.Jba.length-1&&(Fd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",
C),e.VRe())};Hb.prototype.jEj=function(e,C,M,ra){ra=void 0===ra?null:ra;if(void 0!==e&&null!==e)if(this.Al.kkd)Fd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Na=this.$.da.Aa(266);Na&&(this.w2.qca=je.TDe,e&&(this.w2.qca=e.G8e),Na.aPg(C,M,Object(xb.a)(this.w2,this.w2.eGf,"processResults"),ra))}};Hb.prototype.N1a=function(e,C,M,ra){var Na=this.$.da.Aa(266);if(!Na)return Object(Vg.a)("calcManager is null");if(!Na.Np)return Object(Vg.a)("calcManager.NumberFormatter is null");
if(!this.Al)return Object(Vg.a)("instantaneousManager is null");if(!C||!C.isValid())return Object(Vg.a)("numberFormatHolder is invalid or null");var Ib=Na.Mdd(C);if(null===Ib)return Object(Vg.a)("cellFormat is null");var Gc=Na.Np,id=Bg(e);if(void 0===id||null===id)return Object(Vg.a)("cellValue is null");Na=excelOnlineCalc.calc.cellValueToReadOper(Na.config.mathpack,id);if(void 0===Na||null===Na)return Object(Vg.a)("readOper is null");Ib=Gc.applyFormat(Ib,Na);return excelOnlineCalc.util.isSuccess(Ib)?
this.w2.Q9c(Gc,Ib.value,e.type,M,ra,null!=C.mE?C.mE:-1,!1):Object(Vg.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Ib.reason.kind))};Hb.prototype.cSe=function(e,C,M,ra,Na){var Ib=this.$.da.Aa(266);if(void 0===Ib||null===Ib)return Object(Vg.a)("calcManager is null");if(void 0===Ib.Np||null===Ib.Np)return Object(Vg.a)("calcManager.NumberFormatter is null");if(void 0===this.Al||null===this.Al)return Object(Vg.a)("instantaneousManager is null");if(void 0===C||null===C||!C.isValid())return Object(Vg.a)("numberFormatHolder is invalid or null");
var Gc=Ib.Mdd(C);if(void 0===Gc||null===Gc)return Object(Vg.a)("cellFormat is null");var id=Ib.Np;e=id.parseEdit(e,Gc);if(!excelOnlineCalc.util.isSuccess(e))return Object(Vg.a)("ParseEdit failure: "+JSON.stringify(e.reason.kind));if(e.value.kind===Wi.a.formula)return Object(Vg.a)("Main thread - skipping formula edit");Ib=excelOnlineCalc.numfmt.applyValueEdit(id,Ib.localeInfo,Gc,e.value);if(!excelOnlineCalc.util.isSuccess(Ib))return Object(Vg.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Ib.reason.kind));
Gc=e.value;Fd.ULS.shipAssertTag(537162190,0,Gc.kind!==Wi.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");Gc=excelOnlineCalc.numfmt.getValueEditOperKind(Gc);e=0;switch(Gc){case 0:case 128:e=0;break;case 1:e=1;break;case 2:e=2;break;case 4:e=3;break;case 8:e=4;break;case 16:case 32:case 64:case 256:Fd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",Gc);break;
default:Fd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",Gc)}return this.w2.Q9c(id,Ib.value,e,M,ra,null!=C.mE?C.mE:-1,Na)};Hb.prototype.Dfi=function(e,C,M){if(C.width<M.width)for(var ra=e.sl("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new Ug.Range(C.top,C.left,C.bottom,C.left,!0,!0));ra.$$mn();){var Na=ra.$$cu();if(Na&&Na.K3a())return Fd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(C.height<M.height)for(e=e.sl("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new Ug.Range(C.top,C.left,C.top,C.right,!0,!0));e.$$mn();)if((C=e.$$cu())&&C.O3a())return Fd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};Hb.prototype.h1c=function(e,C,M,ra,Na){for(var Ib=C.PW().FirstRow,Gc=C.PW().LastRow,id=M.PW().LastRow,Uc=Ib,Vd=M.PW().FirstRow;Vd<=id;Vd++,Uc++){Uc>Gc&&(Uc=Ib);var Ye=C.PW();Ye.FirstRow=Ye.LastRow=
Uc;var Gf=M.PW();Gf.FirstRow=Gf.LastRow=Vd;this.KZg(e,Hj.a.fQ(Ye),Hj.a.fQ(Gf),ra,Na)}};Hb.prototype.pQi=function(e,C){var M=this.$.da.Aa(266);return void 0!==M&&null!==M?(M.VOg(e,C.topLeft,Object(xb.a)(this.w2,this.w2.eGf,"processResults")),!0):!1};Hb.prototype.rgi=function(e,C){var M=e.right-e.left+1;e=e.bottom-e.top+1;var ra=C.right-C.left+1;C=C.bottom-C.top+1;if(ra>M&&C>e){if(!(ra%M&&C%e))return!0}else if(ra===M&&C>e){if(!(C%e))return!0}else if(ra>M&&C===e&&!(ra%M))return!0;return!1};Hb.prototype.Nch=
function(e){if(ld.EwaSettings.la(102)){e=$e.g(this.$).L0(e).gridView.getRangeInformation(e);e=yl(e);for(var C=e.next();!C.done;C=e.next())if(C=C.value,Object(eg.a)(rj.DynamicArrayRange,C)&&!Object(qc.a)(rj.DynamicArrayRange,C).nkc)return!0}return!1};Hb.prototype.KZg=function(e,C,M,ra,Na){if(M){this.wRa&&M.equals(this.wRa.range)||(jf.a.Fa(this.wRa),this.wRa=e.sl("FormatCellsAction.CopyBetweenRows",M));C=e.sl("FormatCellsAction.CopyBetweenRows2",C);M=this.wRa;M.$$rst();for(var Ib=!1;M.$$mn();){C.$$mn()||
(C.$$rst(),C.$$mn());var Gc=C.$$cu(),id=void 0,Uc=M.$$cu().VJ?e.ctc(M.$$cu().range):(id=new mc.a,id.add(M.$$cu()),id);id=yl(Uc);for(var Vd=id.next();!Vd.done;Vd=id.next())Vd=Vd.value,Gc&&(ra&&(this.OZg(Vd,Gc),Vd.setCell(!0)),Na&&(Ib=this.UXh(Gc,Vd)),Ib||(e.Ca.fV(),Ib=!0));ha.lastOrDefault(Uc)}}else Fd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};Hb.prototype.Z_f=function(){var e=mh.a.jd(1,0,0,638,0,104573951,"PivotTableContextMenuOperationFailure");Qi.a(this.$).ri(e)};
Hb.prototype.Dqi=function(e,C){var M={ValidMembers:32},ra=C.NumberFormat;switch(e){case 1890566896:if(1001===ra||1002===ra||1003===ra){M.NumberFormat=14;M.NumberFormatOptions={};switch(ra){case 1001:M.NumberFormatOptions.TimeType=2;break;case 1002:M.NumberFormatOptions.DateType=7;break;case 1003:M.NumberFormatOptions.DecimalPlaces=0}M.NumberFormatOptions.NumberFormatCategory=this.QFg(ra)}else M.NumberFormat=ra;break;case 1886928607:M.NumberFormat=13;break;case -992833457:M.NumberFormat=11;break;case 218524921:M.NumberFormat=
12;break;case 996232352:M.NumberFormat=14;M.NumberFormatOptions=Object.assign(new ig.a,{DecimalPlaces:0});M.NumberFormatOptions.NumberFormatCategory=6;break;default:return C}return M};Hb.prototype.formatCells=function(e,C,M,ra,Na,Ib,Gc){ra=void 0===ra?null:ra;Na=void 0===Na?null:Na;Ib=void 0===Ib?null:Ib;Gc=void 0===Gc?null:Gc;var id=this.$.Ub.Fc("UserAction","FormatCellsInstantaneous, command = "+sd.b().pi(e)),Uc=this.$.Ub.Xh("UserAction","FormatCellsInstantaneousFrame");Uc.start();zf.a(Uc);var Vd=
sd.b().pi(e),Ye=this.$,Gf=$e.g(Ye),rg=Gf.ha.va,Dg=Na||rg.selectedRanges,Eg=Ad.g(Dg,function(Jk){return Jk.DT});Vd=String.format("{0}, cellCount={1}",Vd,Eg);$e.g(this.$).Ji.X6(1,id.id,Vd);Dg=sg.r(Dg,this.$);rg=rg.activeCell;Vd=-168056295===M.command;var Ch=Eg=null;if(Vd){Ch=Gf.Vb.nq(rg);if(!Ch){this.Z_f();return}Eg=Ch.fca.substring(1,Ch.fca.length-1);Ch=Ch.f$b();if(!Ch){this.Z_f();return}Ch=Ch.Caption}Gf.Bh.qG(!1,!0);var kj=sg.o(rg,Ye),Lj=Ye.qa.ta.Xb(!0),Rj=this.Dqi(M.command,C);Vd||this.gna(Gf,e,
C,!1,ra,Na);id.stop();$e.g(this.$).Ji.m0(id.id,fh.BasicTelemetryCalculator.sQ);M.D6h=Wg.a.Ra.Kb;ra=this.$.Ub.Fc("UserAction","FormatCellsUserAction");this.Wmi(e,M.taskId,C,Dg,rg,ra.id);sd.b().CB(id.id,ra.id,"actions","actions");sd.b().CB(Uc.id,ra.id,"actions","actions");ld.EwaSettings.tc()?Ye.userOperationManager.ic(new Qc(this,Dg,kj,Rj,Vd,Eg,Ch,Lj,ra,id.id,64,Ib,Gc),M):Ye.userOperationManager.ic(new Qc(this,Dg,kj,Rj,Vd,Eg,Ch,Lj,ra,id.id,0,Ib,Gc),M)};Hb.prototype.t2=function(e,C,M,ra,Na,Ib,Gc,id,
Uc,Vd,Ye){var Gf=this,rg=this.$;return function(Dg,Eg,Ch){rg.Xu();Dg=[Dg,Gf.$Ci];Eg=[Eg];Vd&&Dg.push(Vd);Ye&&Eg.push(Ye);return vf.q(rg.qa.ta,e,C,M,ra,Na,Ib,hh.b.apply(null,Dg),hh.a.apply(null,Eg),Ch,Uc,Gc,id)}};Hb.prototype.Hsj=function(e,C,M,ra,Na,Ib){if(C&&M){var Gc=M.Font,id=M.HorizontalAlignment,Uc=M.VerticalAlignment;M.ValidMembers&2||(id=C.horizontalAlignment);M.ValidMembers&1||(Uc=C.verticalAlignment);var Vd=!!id;Hb.E8h(e)&&!id&&(id=this.lXe(C));var Ye=!1;switch(e){case -394785302:this.cua.rbb(C,
id,Vd,0);break;case 1041132226:this.cua.rbb(C,id,Vd,1);break;case -571165336:this.cua.rbb(C,id,Vd,2);break;case -1150205178:case -1142465846:case -286432209:this.cua.rbb(C,id,Vd,Uc,!1,!1);break;case 1650812936:this.setFillColor(C,M,Ib);break;case -287251124:C.bold=Gc.Bold;break;case -1690267012:$e.g(this.$).ha.va.Dh&&(Gc=$e.g(this.$).ha.va.Qd,this.cua.mIb(C,M,Gc));break;case 1970784898:M=Aj.a.Gp(C.color,C.backgroundColor);if(Th.a.compare(M,Th.a.red)&&(K.a.iV(C.text)||K.a.e4e(C.text)))break;Gc=Th.a.GG(Gc.FontColor);
C.color=Vh.c(Aj.a.zF(Gc));break;case -1925065947:C.italic=Gc.Italic;break;case -1293291468:M=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");C.gMd(Gc.FontName,M,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:C.fontSize=Gc.FontSize;this.$.Gf();break;case -1077965542:C.fontSize=Gc.FontSize;break;case 1764140053:C.underline=Gc.Underline;break;case -1685033574:C.doubleUnderline=Gc.DoubleUnderline;break;case -1590502662:C.fontStrikethrough=
Gc.Strikethrough;break;case -848953656:case 2045211913:Ye=C.Uob();break;case 2105621672:Gc=Object(qc.a)(Ck.a,Na);if(!Gc)break;M=Th.a.azh(Gc.color);C.color=Vh.c(Aj.a.zF(M));this.Qoe(C,Gc.W7a);break;case -1409276245:this.Qoe(C,M.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.aGg(C,M);break;case -1228228458:C.Uob();C.clearFormat();this.SUc(C,0);Ye=!0;break;case -730106152:C.clearFormat();this.SUc(C,0);break;case 932244020:this.nhj(C,M,Ib);break;case -1942512156:case -1920201820:this.gjj(C,
M)}ra||(Ye?C.L$a(!0):C.setCell(!0))}else Fd.ULS.shipAssertTag(537162135,0,!C,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Fd.ULS.shipAssertTag(537162134,0,!M,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};Hb.prototype.OZg=function(e,C){e&&C?(e.cpb(C),e.e_c(C),this.SUc(e,C.cell.Gm)):Fd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};Hb.prototype.SUc=function(e,C){if(0>
C)this.WZ("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(C=new Xc(this.Al,this.Np,C),C.isValid()){var M=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);Object(Vg.b)(M)?this.WZ("ApplyNumberFormatIndexOnCell",e,!1,M.reason):(this.Vmb(e,M.value),this.WZ("ApplyNumberFormatIndexOnCell",e,!0,void 0,M.value,C))}else this.WZ("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};Hb.prototype.Qoe=function(e,
C){if(void 0===C||null===C)this.WZ("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(C=new Xc(this.Al,this.Np,void 0,C),C.isValid()){var M=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);Object(Vg.b)(M)?this.WZ("ApplyNumberFormatStringOnCell",e,!1,M.reason):(this.Vmb(e,M.value),this.WZ("ApplyNumberFormatStringOnCell",e,!0,void 0,M.value,C))}else this.WZ("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};
Hb.prototype.aGg=function(e,C){if(C=void 0===C?null:C)if(C=this.pQh(e,C),C.success){var M=this.N1a(e.aL,C.Akc,e.cell.aSa,e.cell.Fsa);Object(Vg.b)(M)?this.WZ("ApplyNumberFormatCategoryOnCell",e,!1,M.reason,void 0,C.Akc):(this.Vmb(e,M.value),this.WZ("ApplyNumberFormatCategoryOnCell",e,!0,void 0,M.value,C.Akc))}else this.WZ("ApplyNumberFormatCategoryOnCell",e,!1,C.reason,void 0,C.Akc);else this.WZ("ApplyNumberFormatCategoryOnCell",e,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};Hb.prototype.QFg=
function(e){switch(e){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<e?-1:e};Hb.prototype.pQh=function(e,C){if(!this.Al||!this.localeInfo||!C)return e=this.Al?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new nd(!1,void 0,"GetRibbonNumberFormat: "+e);C=C.NumberFormat;switch(C){case 0:e=ie.zzh;break;case 1:e=ie.Bzh;break;case 2:e=ie.xzh;break;
case 3:e=ie.vzh;break;case 4:e=ie.Ezh;break;case 5:e=ie.Azh;break;case 6:e=ie.Gzh;break;case 7:e=ie.Czh;break;case 8:e=ie.yzh;break;case 9:e=ie.Dzh;break;case 10:e=ie.Fzh;break;case 11:case 12:return this.Al.VRe(),this.SGh(e,C);case 13:e=ie.QNg;break;case 1006:e=ie.buttonPercentage;break;case 1004:e=ie.keyboardNumber;break;case 1005:e=ie.keyboardCurrency;break;case 1002:e=ie.keyboardDate;break;case 1001:e=ie.keyboardTime;break;case 1003:e=ie.keyboardPercentage;break;case 14:return e="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
Fd.ULS.shipAssertTag(537162132,0,!1,e),new nd(!1,void 0,e);default:return e="GetRibbonNumberFormat: unknown NumberFormatType!",Fd.ULS.shipAssertTag(537162131,0,!1,e),new nd(!1,void 0,e)}if(!e)return new nd(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");e=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,e);if(!e)return new nd(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");e=new Xc(this.Al,this.Np,
void 0,e);return new nd(!0,e)};Hb.prototype.SGh=function(e,C){if(!this.calcManager||!this.Np)return C=this.calcManager?"numberFormatter is null":"calcManager is null",new nd(!1,void 0,"GetDecimalChangeNumberFormat: "+C);e=this.calcManager.Mdd(new Xc(this.Al,this.Np,e.cell.Gm));if(!e)return new nd(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");C=this.Np.changeFormatDecimals(e,11===C?1:-1);if(!excelOnlineCalc.util.isSuccess(C))return new nd(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");
if(void 0===C.value||null===C.value)return new nd(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");C=new Xc(this.Al,this.Np,void 0,void 0,C.value);return new nd(!0,C)};Hb.prototype.WZ=function(e,C,M,ra,Na,Ib){ra=void 0===ra?"":ra;Na=void 0===Na?null:Na;Ib=(Ib=void 0===Ib?null:Ib)?Ib.mE?Ib.mE.toString():K.a.Nmb(Ib.formatString):"null";var Gc=K.a.Nmb(C.aL.value)||"null";Na=Na?K.a.Nmb(Na.text)||"null":"null";e=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",
e,C.range.top,C.range.left,M,ra,Gc,C.aL.type,Ib,Na);Fd.ULS.sendTraceTag(537162130,0,50,e)};Hb.prototype.bGg=function(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd,Ye){id=void 0===id?!1:id;Uc=void 0===Uc?!1:Uc;var Gf=C.cell;Gf.HT=void 0===Vd?0:Vd;Vd=C.text;Vd!==M&&(Gf.text=M);Gf.T7a=void 0===Ye?null:Ye;ah.e(Vd)?C.formulaBarText=Vd:C.formulaBarText="";e=$e.g(e).Vb.Qcf(C.range);this.HYc(C,ra,null,id,Uc,e);Na&&(C.color=Vh.c(Aj.a.zF(Na)));C.cell.Gm=Ib;C.cell.jnc=Gc;C.cell.FQd=Ib};Hb.prototype.Wmi=function(e,C,M,ra,Na,Ib){var Gc=
{};Gc.a=this.$.ya.UserSessionId;Gc.b=C;Gc.c=ra.Ranges.length;Gc.d=this.L2g(ra.Ranges);Gc.e=Na.toString();Gc.f=e;Gc.h=Ib;1890566896===e?Gc.g=M.NumberFormat.toString():2105621672===e&&(Gc.g=M.NumberFormatOptions.NumberFormatCategory.toString());sd.b().Ne(3,Gc,!0)};Hb.prototype.L2g=function(e){if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5656060_logRangesAccomulativeDataForFormatCellInvestigation")){for(var C=0,M=0,ra=0,Na=0;Na<e.length;Na++){var Ib=sg.B(e[Na]).DT;C+=Ib;Ib>ra&&(ra=Ib,M=Na)}e=sg.B(e[M]).toString();
return"TotalCellCount:"+C+"; Max range:"+e+"; MaxRangeSize:"+ra+";"}C=Math.min(Hb.Hlf,e.length);ra="";for(M=0;M<C;M++)ra+=sg.B(e[M]).toString()+" ; ";e.length>Hb.Hlf&&(ra+="and more");return ra};Hb.prototype.nhj=function(e,C,M){64===(C.ValidMembers&64)&&this.setFillColor(e,C,M);16===(C.ValidMembers&16)&&Hb.Mij(e,C);128===(C.ValidMembers&128)&&this.cua.mIb(e,C,e.range);if(2===(C.ValidMembers&2)||1===(C.ValidMembers&1)){M=C.VerticalAlignment;C=C.HorizontalAlignment;var ra=!!C;ld.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&
!ra&&this.lXe(e);this.cua.rbb(e,C,ra,M)}};Hb.prototype.setFillColor=function(e,C,M){(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?e.uaa:e.uaa&&e.Nbc&&!e.svb&&!e.Rbc)||(C=-1===C.FillColor?M?Aj.a.zF(Th.a.white):null:Aj.a.zF(Th.a.GG(C.FillColor)),e.backgroundColor=C?Vh.c(C):null)};Hb.prototype.gjj=function(e,C){e.horizontalAlignment&&2!==e.horizontalAlignment||e.L6(1,!1);0<=e.indentation+C.IndentationIncrease&&(e.indentation+=C.IndentationIncrease)};
Hb.prototype.lXe=function(e){var C=new Xc(this.Al,this.Np,e.cell.Gm);if(!C.isValid())return 0;e=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);return Object(Vg.b)(e)?0:null!=e.value.horizontalAlignment?e.value.horizontalAlignment:0};Hb.prototype.qkj=function(e,C,M){this.fY||(this.fY=new Xd($e.g(this.$).Ca,this.$));this.fY.mIb(e,C,M)};Hb.prototype.UXh=function(e,C){var M=new Jh.a;if(e.cell.formulaBarText&&e.cell.formulaBarText.startsWith("'"))M.Text=e.cell.formulaBarText;else{var ra=e.cellValue;ra&&4!==e.cell.HT||
(ra=e.text);M.Text=ra}this.pRa(C,M,!1,void 0,cg.a.Fmd(this.$));return!0};Hb.prototype.Gpj=function(e,C){return this.zg&&!!e&&!!C};Hb.$Wg=function(e,C,M,ra){ra&&C.setCell(!0);M||e.Ca.fV()};Hb.expandRange=function(e,C){C=C.clone();C.height<e.height&&(C.bottom=C.top+e.height-1);C.width<e.width&&(C.right=C.left+e.width-1);return C};Hb.E8h=function(e){switch(e){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};Hb.Mij=function(e,
C){C=C.Font;var M=!!(C.ValidMembers&16),ra=!!(C.ValidMembers&16),Na=!!(C.ValidMembers&16);e.bold=!!(C.ValidMembers&4);e.italic=!!(C.ValidMembers&8);M&&(e.underline=M);ra&&(e.doubleUnderline=ra);Na&&(e.fontStrikethrough=Na);M=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");e.gMd(C.FontName,M,"SetFont");e.fontSize=C.FontSize;M=Aj.a.Gp(e.color,e.backgroundColor);Th.a.compare(M,Th.a.red)&&(K.a.iV(e.text)||K.a.e4e(e.text))||(C=Th.a.GG(C.FontColor),e.color=Vh.c(Aj.a.zF(C)))};
tl.Object.defineProperties(Hb.prototype,{cua:{configurable:!0,enumerable:!0,get:function(){return this.Vxh}},Np:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.Np}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});Hb.Hlf=10;Hb.iwh=36;Object(td.a)(Hb,"FormatCellsAction",null,[601,3]);var Hh=tb.a;vm(Bb,Hh);Bb.prototype.create=
function(){this.Fb(new Hb(this.$))};Bb.ja=function(e){e.da.Ha(18,new Bb(e))};Object(td.a)(Bb,"FormatCellsActionFactory",tb.a,[]);Object(td.a)(Cb,"FormulaAssistanceUIContext",null,[]);var Ij=tb.a;vm(Lc,Ij);Lc.prototype.create=function(){var e=this,C=this.$.da.Aa(448);if(C)this.Fb(C);else{var M=ud.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);xf.TaskExtensions.Ba(M,function(){xf.TaskExtensions.Ba(qe.c(M.result.wo.loadScript(e.idj)),function(){C=e.$.da.Aa(448);if(!C){var ra=Object.assign(new Cb,
{isFeedbackAllowed:e.$.isFeedbackEnabled});C=e.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(ra));e.$.tve(function(){var Na={};Na.isFeedbackAllowed=e.$.isFeedbackEnabled;C.updateContext(Na)})}e.Fb(C)},e.$.ma,3)},this.$.ma,3)}};Lc.ja=function(e){e.da.Ha(449,new Lc(e))};Object(td.a)(Lc,"FormulaAssistanceUIControlFactory",tb.a,[]);var ci=b(690);Object(td.a)(kd,"FreezePanesCommandParameters",null,[]);var Ej=b(174),L=b(386),Fa=b(263),Qb=b(284),yc=b(118);gb.prototype.getSheetName=
function(){return this.freezeOptions.SheetName};Object(td.a)(gb,"MacroRecorderSheetPaneFrozenPayload",null,[98]);wc.prototype.Xc=function(e,C){var M=!1;switch(C){case 1844679312:M=1!==e&&!this.gridView.$a.m4}return M};wc.prototype.executeCommand=function(e,C){e=this.gridView.$a;var M=this.gridView.Qfd();jd.AFrameworkApplication.sa.Pa.Cx&&this.$.nka&&(1844679312===C.command||340334732===C.command||-806625837===C.command)&&ci.ShyRibbon.tP(1,2);switch(C.command){case 1844679312:return this.setFreezePanes(C,
M,e.Zi);case 340334732:return e.m8b?wg.Task.Ta(!1):this.Qij(C,M);case -806625837:return e.rSa?wg.Task.Ta(!1):this.Rij(C,M)}return wg.Task.Ta(!1)};wc.prototype.Gc=function(e,C){e=!1;switch(C.command){case 1844679312:case 340334732:case -806625837:case 1745254833:e=!0}return e};wc.prototype.fd=function(){return!1};wc.prototype.setFreezePanes=function(e,C,M){if(M)return this.stc(e,!1,0,0,0,0,C,null);var ra=this.gridView.ha.va;M=ra.activeCell.clone();ra=ra.activeRange;ra.Lh&&(Fd.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",M.top,M.bottom,C.top),M.top=M.bottom=C.top);ra.isRow&&(Fd.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",M.left,M.right,C.left),M.left=M.right=C.left);M.top===C.top&&M.left===
C.left&&(M=Ug.Range.ld(M.top+1,M.left));ra=M.top-1;var Na=M.left-1,Ib=ra-(C.top-1),Gc=Na-(C.left-1);return this.nNj(M,Ib,Gc)?this.stc(e,!0,ra,Na,Ib,Gc,C,M):(this.$.Gf(),this.JBf(),wg.Task.Ta(!0))};wc.prototype.Qij=function(e,C){return this.stc(e,!0,0,C.left,0,1,C,null)};wc.prototype.Rij=function(e,C){return this.stc(e,!0,C.top,0,1,0,C,null)};wc.prototype.nNj=function(e,C,M){var ra=this.gridView.Lg(e),Na=this.gridView.view.visibleArea;return!ra||Na.topLeft.y>ra.bottomRight.y||Na.topLeft.x>ra.bottomRight.x||
Na.bottomRight.y<ra.bottomRight.y||Na.bottomRight.x<ra.bottomRight.x?(Fd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",e,ra?ra.toString():"null",Na.toString()),e=mh.a.jd(1,0,26,1439,0,2105967339,"FreezePaneSelectionNotInViewErr"),ld.EwaSettings.az()?new Fg.a(this.$,e):(e=new Nh.ErrorDialog(this.$,e),e.initialize(),e.nf()),!1):0>=C&&0>=M?(Fd.ULS.sendTraceTag(537159582,
0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),e=$e.g(this.$).rtl?1441:1440,C=$e.g(this.$).rtl?-2131054257:-1953454131,e=mh.a.jd(1,0,26,e,0,C,"FreezePaneA1SelectedErr"),ld.EwaSettings.az()?new Fg.a(this.$,e):(e=new Nh.ErrorDialog(this.$,e),e.initialize(),e.nf()),!1):!0};wc.prototype.stc=function(e,C,M,ra,Na,Ib,Gc,id){function Uc(){return new gb(Ye)}var Vd=this;this.iDd=Qi.a(this.$).h9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.gT(this.duf);
this.RE.jAa();this.gridView.mxj(C?"":"UnsetFreezePane");this.klj(e,C,this.gridView.$a);var Ye=Object.assign(new kd,{SheetName:this.$.oa.name,Freeze:C,FrozenRows:Na,FrozenColumns:Ib,FirstRow:M,FirstColumn:ra});Fd.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",C,Na,Ib,M,ra);this.W8b=Wg.a.Ra.se;return Lg.a(this.$.userOperationManager,function(Gf,rg,Dg){if(ld.EwaSettings.la(60)){var Eg=window.performance;
Eg.clearMarks();Eg.mark("FreezePanes request sent")}Eg=Vd.gridView.ns;Vd.$.la(720)&&Eg?(Eg=Vd.Khh(Ye,Eg,Gc,id),Vd.lEj(Eg)):Vd.$.Xu();Eg=Vd.$.qa.ta;var Ch=Eg.Oa(9,null);Ch.freezeSettings=Ye;return vf.i(Eg,"FreezeOrUnfreezePanes",Ch,Gf,rg,Dg,C,0)},function(Gf){return new hg.a(151,0,Gf,void 0,Uc)},e)};wc.prototype.Khh=function(e,C,M,ra){Fd.ULS.shipAssertTag(537159580,1,!!C,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!e.Freeze)return null;var Na=
Qb.a();Na.State=1;Na.IsEstimated=!0;var Ib=!1,Gc=!1,id=C.CU(Ug.Range.ld(M.top,M.left)),Uc=e.FrozenRows,Vd=e.FrozenColumns;1!==e.FrozenRows||e.FrozenColumns?e.FrozenRows||1!==e.FrozenColumns?(Vd=C.CU(Ug.Range.ld(e.FirstRow+1,e.FirstColumn+1)),C=C.CU(Ug.Range.ld(M.top,M.left)),Na.Width=Vd.Xl-id.Xl,Na.Height=Vd.Mm-id.Mm,0<e.FrozenRows&&(Na.AbsoluteTop=Vd.Mm,Gc=!0),0<e.FrozenColumns&&(Na.AbsoluteLeft=Vd.Xl,Ib=!0),Uc=Vd.LK-C.LK,Vd=Vd.lJ-C.lJ):(Na.Width=C.uPh(Ej.a.ld(M.top,M.left)),ra=Ug.Range.ld(M.top,
M.left+1),Na.AbsoluteLeft=id.Xl+Na.Width,Ib=!0):(Na.Height=C.sPh(Ej.a.ld(M.top,M.left)),ra=Ug.Range.ld(M.top+1,M.left),Na.AbsoluteTop=id.Mm+Na.Height,Gc=!0);Gc&&(Na.FirstFrozenRow=M.top,Na.FirstScrollableRow=ra.top);Ib&&(Na.FirstFrozenColumn=M.left,Na.FirstScrollableColumn=ra.left);Na.VisibleRows=Uc;Na.VisibleColumns=Vd;return Na};wc.prototype.lEj=function(e){var C=this;wg.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){C.$.oa&&C.$.fa&&(C.$.fa.YW(Mi.a.Se,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
L.b(C.$.oa,e,-1,void 0,!0))})};wc.prototype.klj=function(e,C,M){if(!ld.EwaSettings.la(691))switch(e.command){case 1844679312:if(C||-1===this.gKa&&-1===this.hKa)this.gKa=M.Pw-M.width+this.gridView.scrollLeft,this.hKa=M.Qw-M.height+this.gridView.scrollTop;break;case 340334732:if(C||-1===this.gKa)this.gKa=M.Pw-M.width+this.gridView.scrollLeft;break;case -806625837:if(C||-1===this.hKa)this.hKa=M.Qw-M.height+this.gridView.scrollTop}};wc.prototype.Mrc=function(){var e=this.gridView.$a;0<e.width?this.gridView.scrollLeft=
yc.a.i_b(this.gridView.domElement,$e.g(this.$).rtl,0):-1!==this.gKa&&(this.gridView.scrollLeft=this.gKa,this.gKa=-1);0<e.height?this.gridView.scrollTop=0:-1!==this.hKa&&(this.gridView.scrollTop=this.hKa,this.hKa=-1)};wc.prototype.JBf=function(){this.RE.NRa();jf.a.Fa(this.iDd);this.iDd=null;this.gridView.wN(this.duf)};Object(td.a)(wc,"FreezePanesCommandHandler",null,[147]);var Yc=af.a;vm(hd,Yc);hd.prototype.Md=function(){var e=this;xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(this.$.da,12,477,
this.tb),function(C){e.Ed([new wc(e.$,C.result)])},this.$.ma)};hd.ja=function(e){e.da.Ha(116,new hd(e))};Object(td.a)(hd,"FreezePanesCommandHandlerFactory",af.a,[]);var Ke=b(938),De=tb.a;vm(oc,De);oc.prototype.create=function(){var e=this,C=ud.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),M=ud.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([C,M],this.ma),function(){e.Fb(e.$.da.Aa(296)||e.$.da.Ha(296,new Ke.BorderFormatManager(e.$,
C.result,M.result)))},this.ma,3)};oc.ja=function(e){ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&e.da.Ha(468,new oc(e))};Object(td.a)(oc,"BorderFormatManagerFactory",tb.a,[]);var tf=b(959),Mf=b(23),Cg=b(100),sh=b(275),Of=b(353),dh=b(350),xi=b(93),ui;(function(e){e[e.insert=1]="insert";e[e.delete=2]="delete";e[e.rows=4]="rows";e[e.columns=8]="columns";e[e.cellsShiftHorizontal=16]="cellsShiftHorizontal";e[e.cellsShiftVertical=32]="cellsShiftVertical";e[e.insertRows=
5]="insertRows";e[e.insertColumns=9]="insertColumns";e[e.insertCellsShiftRight=17]="insertCellsShiftRight";e[e.insertCellsShiftDown=33]="insertCellsShiftDown";e[e.deleteRows=6]="deleteRows";e[e.deleteColumns=10]="deleteColumns";e[e.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";e[e.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(ui||(ui={}));Object(td.b)("InsertDeleteCellFlags",ui);var zi=b(415);Object(td.a)(Jf,"MacroRecorderRangeInsertedOrDeletedPayload",null,[98]);var mj=b(119),nj=b(253),bj=b(1144);
b(823);ze.prototype.bTe=function(e,C,M){var ra=Object.assign(new kb.a,{Id:"FontDropdownMenu"});ra.MenuSectionList=[];var Na=Object.assign(new Xb.a,{ControlsId:"FontsMenuSectionControl"});Na.ControlList=this.nJh(e,C,M);Array.add(ra.MenuSectionList,Na);return ra};ze.prototype.nJh=function(e,C,M){var ra=[],Na=this.l9h&&!this.Bcf;ze.N$c||ze.t4h();var Ib=ze.N$c,Gc;for(Gc in Ib){var id=Gc,Uc=Ib[Gc],Vd=bh.a.Mf(id),Ye=bh.a.Mf(ab.HelperMethods.GRd[id]);id=bh.a.Mf(id);Na||(Uc=0);Vd=Object.assign(new bj.a,{MenuItemId:Vd,
CommandValueId:Vd,LabelText:Na&&0<Uc?bh.a.Mf(String.fromCodePoint(Uc)):Ye,LabelCss:String.format("font-size:12pt;font-family:{0};",Na&&0<Uc?"msofp":id),Styles:ze.lac(Na&&0<Uc?"msofp":id),AriaLabel:Ye,Alt:Ye,Command:e.toString(),CommandPreviewId:C.toString(),CommandRevertId:M.toString()});Array.add(ra,Vd)}Na&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.oIi);return ra};ze.t4h=function(){var e={};ze.N$c=(e["Angsana New"]=983046,e["Arial Black"]=983051,e.Arial=983050,e.Batang=983061,e["Book Antiqua"]=
983077,e["Browallia New"]=983082,e.Calibri=983085,e.Cambria=983089,e.Candara=983091,e.Century=983095,e["Comic Sans MS"]=983100,e.Consolas=983101,e.Constantia=983102,e.Corbel=983106,e["Cordia New"]=983107,e["Courier New"]=983109,e.DilleniaUPC=983121,e.Dotum=983123,e.FangSong=983138,e.Garamond=983154,e.Georgia=983156,e.Gulim=983182,e.GungSuh=983186,e.KaiTi=983222,e.JasmineUPC=983218,e["Malgun Gothic"]=983258,e.Mangal=983262,e.Meiryo=983264,e["Microsoft JhengHei"]=983272,e["Microsoft YaHei"]=983284,
e.MingLiU=983292,e.MingLiU_HKSCS=983296,e["MS Gothic"]=983245,e["MS Mincho"]=983247,e["MS PGothic"]=983249,e["MS PMincho"]=983251,e.PMingliU=983322,e["PMingLiU-ExtB"]=983324,e.SimHei=983382,e.SimSun=983384,e["SimSun-ExtB"]=983386,e["Source Sans Pro"]=983396,e.Tahoma=983405,e.THSarabunPSK=983404,e["Times New Roman"]=983415,e["Trebuchet MS"]=983419,e.Verdana=983443,e["Yu Gothic"]=983464,e["Yu Mincho"]=983474,e)};ze.lac=function(e){var C={};C["font-family"]=e;C["font-size"]="12pt";return{optionText:C}};
ze.N$c=null;Object(td.a)(ze,"FontDropdownHelper",null,[]);Pd.IMg=function(e,C){return new Pd(e,C,null,null)};Pd.eXc=function(e,C){return new Pd(e,null,C,null)};Pd.JMg=function(e,C){return new Pd(e,null,null,C)};tl.Object.defineProperties(Pd.prototype,{O1a:{configurable:!0,enumerable:!0,get:function(){return this.wkg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.xkg}},style:{configurable:!0,enumerable:!0,get:function(){return this.msg}},size:{configurable:!0,enumerable:!0,
get:function(){return this.hVb}}});Object(td.a)(Pd,"CachedPreviewCellGroup",null,[]);var hj=b(64);Bd.prototype.fL=function(){var e=this;this.HBc=!1;if(yh.b(this.EBa,514846606)){this.HBc=!0;Fd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");hj.a(this.wf.$).nd.AD(514846606);if(this.BNb&&this.hYd)window.setTimeout(function(){e.wf.A$(e.wf.gridView,e.DBa,!0,!0)},0);else return this.xYd=$e.g(this.wf.$).rtl,this.zYd=mh.a.jd(3,2,0,this.xYd?625:624,0,514846606,"MergeCellsLoseData"),this.ej=
Qi.a(this.wf.$).ri(this.zYd).G(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.ABc;return this.Geb}return this.Q0};Bd.prototype.Q0=function(){this.wf.Aif(this.HBc,this.hYd,this.$cg.scenario,this.BNb);this._state=3};Bd.prototype.Geb=function(){return this.Q0};Bd.prototype.ABc=function(){if(this.DBc=this.ej.Sy())1===this.DBc&&Fd.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Fd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
this.ej=this.wf.A$(this.wf.gridView,this.DBa,!0,!1).g(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.BBc;return this.Ieb};Bd.prototype.Ieb=function(){return this.Geb};Bd.prototype.BBc=function(){this.ej.Sy();return this.Ieb};Bd.prototype.dispose=function(){};Object(td.a)(Bd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);ne.prototype.fL=function(){return yh.b(this.EBa,514846606)?(Fd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),
hj.a(this.wf.$).nd.AD(514846606),this.uYd=$e.g(this.wf.$).rtl,this.vYd=mh.a.jd(3,2,0,this.uYd?625:624,0,514846606,"MergeCellsLoseData"),this.ej=Qi.a(this.wf.$).ri(this.vYd).G(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.Feb):this.Q0};ne.prototype.Q0=function(){this._state=3};ne.prototype.Feb=function(){if(this.GBc=this.ej.Sy())1===this.GBc&&Fd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Fd.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
this.ej=this.wf.A$(this.wf.gridView,this.DBa,!0,this.BNb).g(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.kdg;return this.Heb};ne.prototype.Heb=function(){return this.Q0};ne.prototype.kdg=function(){this.ej.Sy();return this.Heb};ne.prototype.dispose=function(){};Object(td.a)(ne,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var Ni=b(521),Sj=Ni.a;vm(ee,Sj);ee.prototype.Kh=function(){1896159024===this.$o?
(this.Wn=Ae.a.instance.ea(23),this.V4c=0):(this.Wn=Ae.a.instance.ea(22),this.V4c=1);var e=this.selectedRanges[0].Y4&&!this.selectedRanges[0].bba?0:1;this.kc=1;var C={};e=(C[ee.Ly]=this.xc,C.dialogToDisplay=this.V4c,C.defaultSelectedKey=e,C.isRtl=this.isRtl,C);this.initializeAndShow(this.Wn,this.h6h,e)};tl.Object.defineProperties(ee.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(td.a)(ee,"InsertDeleteCellsDialog",Ni.a,[]);Object(td.a)(Wd,"MacroRecorderRangeFilledPayload",
null,[98]);Object(td.a)(Qd,"RangeBorders",null,[]);Object(td.a)(cc,"ScenarioInfo",null,[]);Ie.prototype.dispose=function(){this.$=null};Ie.prototype.u$h=function(e,C){return!(void 0===C||null===C)&&!!(C.scenario&16384)&&155820588!==e&&this.Q9e(C,e)};Ie.prototype.bYe=function(){var e=pd.a.me(),C=$e.g(this.$),M=C.ha.va.selectedRanges,ra=0,Na=0,Ib=M.length,Gc=new cc;if(1<Ib)return Gc.scenario=4,Gc;this.Umd&&$e.g(this.$).rtl&&(ra|=65536);if(!C.hka(M[0]))if(this.lxb)ra|=32;else return Gc.scenario=32,Gc;
if(C=C.Ca.G2a(M[0],this.$.activeItemName))for(C=yl(C),Ib=C.next();!Ib.done;Ib=C.next())if(Na+=1,1<Na)return this.lxb?(ra|=256,Gc.scenario=ra):Gc.scenario=256,Gc;Na=$e.g(this.$).Ca.nJa(M[0]);if(!Na)return Gc.scenario=32768,Gc;C=Na.length;M=M[0];Ib=M.bottom-M.top+1;for(var id=M.right-M.left+1,Uc=new Qd,Vd=0;Vd<C;Vd++)if(this.Mcf&&this.lPh(Na[Vd],M,Uc),ra=ra|(void 0!==Na[Vd].text&&null!==Na[Vd].text&&""!==Na[Vd].text?1:0)|(Na[Vd].FM?2:0)|(Na[Vd].lKa?8:0)|(Na[Vd].pvb?16:0)|(Na[Vd].MJ?64:0)|(Na[Vd].uaa?
128:0),void 0!==Na[Vd].text&&null!==Na[Vd].text&&""!==Na[Vd].text||Na[Vd].lKa)void 0===Gc.RIa||null===Gc.RIa?Gc.RIa=$e.g(this.$).sc(Na[Vd].getRange()):ra|=16384;this.Mcf&&(Uc.pSa===id&&(ra|=512),Uc.RFa===id&&(ra|=2048),Uc.FMa===Ib&&(ra|=4096),Uc.XPa===Ib&&(ra|=1024),0<Uc.pSa&&Uc.pSa<id||0<Uc.RFa&&Uc.RFa<id||0<Uc.FMa&&Uc.FMa<Ib||0<Uc.XPa&&Uc.XPa<Ib)&&(ra|=8192);e=pd.a.me()-e;Fd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenrio is : {0}",e);Gc.scenario=ra;return Gc};Ie.prototype.tmf=
function(e,C){e=e.command;if(void 0===C||null===C)C=this.bYe();if(!this.Q9e(C,e))return!1;var M=$e.g(this.$).ha.va.selectedRanges,ra=$e.g(this.$).Ca.nJa(M[0]);if(!ra)return!1;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===ra.length&&!ra[0].FM)return-167499203===e?(ra[0].L6(2,!0),!0):!1;ra=$e.g(this.$).ha.va.wA;var Na=this.$.oa.sheetName;switch(e){case -167499203:2===(C.scenario&2)&&this.tfc?this.p8f(M,e):this.qsi(C,M);break;case 1097660126:this.umf(C,
M);break;case 155820588:this.p8f(M,e);break;default:return!1}$e.g(this.$).OU(M,ra,Na,null,M[0],null,null,0,"MergeCellCommandAction");return!0};Ie.prototype.Q9e=function(e,C){if(-255094134===C||this.Umd&&65536===(e.scenario&65536))return!1;if(this.Fgi(C,e))return this.Egi(e);this.lxb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||16===(e.scenario&16)||4===e.scenario||256===e.scenario||128===(e.scenario&128)||!this.lxb&&32===e.scenario||void 0!==e.RIa&&null!==e.RIa&&e.RIa.B7?!1:
e.scenario?16384===(e.scenario&16384)?ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(e.scenario&1)&&8!==(e.scenario&8)||!ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:!0};Ie.prototype.Fgi=function(e,C){return 155820588===e||-167499203===e&&2===(C.scenario&2)&&this.tfc?!0:!1};Ie.prototype.Egi=function(e){if(!ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1))return!1;this.lxb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||4===e.scenario||256===e.scenario||128===(e.scenario&128)?!1:2===(e.scenario&2)&&512!==(e.scenario&512)&&4096!==(e.scenario&4096)&&1024!==(e.scenario&1024)&&2048!==(e.scenario&2048)?!0:!1};Ie.prototype.lPh=function(e,C,M){var ra=e.getRange();if(ra.top===C.top)if(e.O3a)M.pSa+=ra.right-ra.left+1;else{var Na=this.fY.oua(ra,0);if(Na){var Ib=yl(Na);for(Na=Ib.next();!Na.done;Na=Ib.next())Na=Na.value,Na.qvb&&(M.pSa+=
Na.getRange().right-Na.getRange().left+1)}}if(ra.left===C.left)if(e.K3a)M.FMa+=ra.bottom-ra.top+1;else if(Na=this.fY.oua(ra,2))for(Ib=yl(Na),Na=Ib.next();!Na.done;Na=Ib.next())Na=Na.value,Na.yvb&&(M.FMa+=Na.getRange().bottom-Na.getRange().top+1);if(ra.bottom===C.bottom)if(e.qvb)M.RFa+=ra.right-ra.left+1;else if(Na=this.fY.oua(ra,1))for(Ib=yl(Na),Na=Ib.next();!Na.done;Na=Ib.next())Na=Na.value,Na.O3a&&(M.RFa+=Na.getRange().right-Na.getRange().left+1);if(ra.right===C.right)if(e.yvb)M.XPa+=ra.bottom-
ra.top+1;else if(e=this.fY.oua(ra,3))for(e=yl(e),Na=e.next();!Na.done;Na=e.next())C=Na.value,C.K3a&&(M.XPa+=C.getRange().bottom-C.getRange().top+1)};Ie.prototype.t2i=function(e){e=$e.g(this.$).Ca.nJa(e);for(var C=e.length,M=1;M<C;M++){var ra=$e.g(this.$).sc(e[M].getRange());ra.Uob();ra.clearFormat();ra.cell.v2i();ra.L$a(!0)}};Ie.prototype.GLj=function(e,C){e.backgroundColor=C.backgroundColor;e.color=C.color};Ie.prototype.hQh=function(e,C,M){C.cell.Fjj(M.bottom-M.top,M.right-M.left);if(void 0!==e&&
null!==e){var ra=e.cell.formattedText,Na=Object.assign(new Jh.a,{TextRuns:ra.TextRuns,Fonts:ra.Fonts});Na.Text=void 0!==e.cell.originalText&&null!==e.cell.originalText?e.cell.originalText:void 0!==e.cell.userInput&&null!==e.cell.userInput?e.cell.userInput:ra.Text;this.hi.pRa(C,Na,!1,null,!0,"MergeCells",void 0,2);this.Umd?C.cpb(e):this.GLj(C,e);C.cell.MZg(e.cell)}this.t2i(M);C.cell.eAc(!1);return C};Ie.prototype.qsi=function(e,C){this.umf(e,C).L6(2,!0)};Ie.prototype.umf=function(e,C){e=e.RIa;var M=
$e.g(this.$).sc(C[0]);M=this.hQh(e,M,C[0]);$e.g(this.$).Ca.E9(C[0],this.$.activeItemName).s$f(C[0],!0);return M};Ie.prototype.VGj=function(e,C){for(var M=e.length,ra=0;ra<M;ra++){e[ra].cell.eAc();var Na=e[ra].cell.getRange();Na=$e.g(this.$).Ca.nJa(Na);var Ib=Na.length;if(-167499203===C&&this.tfc){var Gc=0;2===e[ra].cell.tEd||1===e[ra].cell.HT?Gc=3:2===e[ra].cell.HT&&(Gc=1);e[ra].L6(Gc,!1)}for(Gc=1;Gc<Ib;Gc++)Na[Gc].attachCellToModel(),Na[Gc].cpb(e[ra]),-167499203===C&&this.tfc&&Na[Gc].L6(null,!1)}};
Ie.prototype.p8f=function(e,C){var M=$e.g(this.$).Ca.Eua(e[0],this.$.activeItemName),ra=$e.g(this.$).Ca.E9(e[0],this.$.activeItemName),Na=[];if(void 0!==M&&null!==M&&(e=$e.g(this.$).Dua(e[0],M),void 0!==e&&null!==e)){for(M=e.$$ge();M.$$mn();)e=M.$$cu(),e.VJ&&(Na.push(e),e.cell.NTg(),ra.s$f(e.cell.getRange(),!1));0<Na.length&&(ra.yf.resetCellLookup(),this.VGj(Na,C))}};Object(td.a)(Ie,"MergeCellCommandAction",null,[]);var Bj=b(105),rk=b(458),Oi=b(375),oi=b(818);qd.prototype.Lbi=function(e){return 1896159024===
e||-1554384558===e||-1113896058===e||1554436520===e||1415868706===e||674605324===e||1035996630===e};qd.prototype.Xc=function(e,C){return 2054778433===C&&e&1?!Yg.a(this.$).dgc:600686207===C?!1:this.Lbi(C)&&ai.a.any(this.gridView.ha.va.selectedRanges,function(M){return M.Lh||M.isRow})&&!this.Edf&&!this.Bdf?!0:this.vgc(e,C)};qd.prototype.executeCommand=function(e,C,M){return this.Zb(C,M)};qd.prototype.Gc=function(e,C,M){if(e=1===e)switch(C.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:e=
!!M;break;case 862825906:case 1532790410:case 46555851:case -1522760979:e=!0;break;default:e=!1}return e};qd.prototype.fd=function(e,C,M){switch(C){case "PopulateFontColor":M.MenuItems=this.UA.S9b(1970784898,-803000997,532,null,null,-128950598,2036397036,1688184685,862825906,M.MenuId);break;case "PopulateFillColor":M.MenuItems=this.UA.S9b(1650812936,null,null,87208751,530,673562736,1457172838,-446735083,1532790410,M.MenuId);break;case "PopulateBorderColor":M.MenuItems=this.UA.S9b(-236759591,-1803452024,
532,void 0,void 0,void 0,void 0,void 0,46555851,M.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.YXh(M);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":M.MenuItems=this.Jxh.bTe(-1293291468,324978188,-1428968098);break;default:return!1}return!0};qd.prototype.vgc=function(e,C){var M=$e.g(this.$).ha.va.selectedRanges;return!(new Oh.a(this.$.xa)).xn(e,C,M,this.gridView)};qd.prototype.Zb=function(e,C){var M=this,ra=this.gridView,Na=e.command,Ib=xf.TaskExtensions.om(),
Gc=!0;switch(Na){case -1077965542:Gc=this.U2e(C,e,!1);break;case 909774670:this.lob(Na);Gc=this.U2e(C,e,!0);break;case -1293291468:Gc=this.S2e(C,e,!1);break;case 324978188:ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Fd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.lob(Na);Gc=this.S2e(C,e,!0);break;case 862890474:case 963349338:Gc=this.tXh(e);break;case -1832800737:Gc=this.xbc(Na,C,!1,e);break;case 1970784898:Gc=
this.xbc(Na,C,!1,e);break;case -803000997:Gc=this.xbc(Na,C,!1,e);break;case -128950598:case 1688184685:this.lob(Na);Gc=this.xbc(Na,C,!0,e);break;case 1597684571:Gc=this.cvb(Na,C,!1,e);break;case 87208751:C.Color="-1";C.IntColor=!0;Gc=this.cvb(Na,C,!1,e);break;case -446735083:this.lob(Na);C.Color="-1";C.IntColor=!0;Gc=this.cvb(Na,C,!0,e);break;case 1650812936:Gc=this.cvb(Na,C,!1,e);break;case 673562736:this.lob(Na);Gc=this.cvb(Na,C,!0,e);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(e=sd.b().pi(Na),Fd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",e));this.TPf(Na);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Gc=this.eXh(Na,e);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Gc=this.qWh(Na,e);break;case -1803452024:case -236759591:Gc=this.qgd(Na,C,e);break;case -2118943501:Gc=this.borderFormatManager.AWh(C,e);break;case 1012765228:Gc=
this.borderFormatManager.lYh(C,e);break;case 1256700402:Gc=this.borderFormatManager.vgd(e);break;case -1756763834:Gc=this.borderFormatManager.wgd(e);break;case -1418159950:Gc=this.borderFormatManager.E2e(e);break;case -1920201820:case -1942512156:Gc=this.uXh(Na,e);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Gc=this.borderFormatManager.p2e(C,e);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Gc=this.QXh(Na,C,e);break;case -693675336:case 322710748:break;
case 1696566924:Gc=this.fXh(e);break;case -167499203:case -255094134:case 1097660126:case 155820588:Ib=this.handleMergeCellsCommand(this.gridView,e);break;case 1896159024:case -1554384558:C=this.gridView.ha.va.selectedRanges;if(this.qqj(e,C))Fd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new ee(this.$,Na,C)).Kh(),Gc=!0;else if(ai.a.any(C,function(Uc){return M.gridView.Vb.TLa(Uc)})){ra="";Ib=1461300262;var id=-1554384558===Na&&this.gridView.Vb.Jdi(C[0]);
C=C[0].height>C[0].width&&!id;switch(Na){case 1896159024:ra=C?"InsertColumnsTable":"InsertRowsTable";Ib=C?622604322:942362098;break;case -1554384558:ra=C?"DeleteColumnsTable":"DeleteRowsTable",Ib=C?284490184:1405456548}C=gi.a.Jn(qd.ckd,ra,1);new Rg.a(Ib,1,2,6,null);Ib=this.insertOrDeleteCells(C,e,!0)}else Ib=this.insertOrDeleteCells(1896159024===Na?1:2,e,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Ib=this.insertOrDeleteCells(gi.a.Jn(qd.ckd,C[pg.a.hd],1),e,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Ib=
this.insertOrDeleteCells(gi.a.Jn(qd.ckd,C[pg.a.hd],1),e,!1);break;case 504848446:Ib=ra.startEdit(!1,1,C[Je.a.event],void 0,void 0,!0);break;case 1504715724:if($e.g(this.$).Xy&&this.borderFormatManager.kU.yA)break;Ib=ra.startEdit(!0,0,C[Je.a.event],void 0,void 0,!0);break;case 1872288872:this.Yob();break;case 41465729:Ib=this.fill(ra.ha.va.Qd,null,0,1,e);break;case -1451655532:case 1972143101:Ib=this.fillDownAbsoluteValueAndStartEdit(ra,C[Je.a.event],-1451655532===Na);break;case -475861485:Ib=this.fill(ra.ha.va.Qd,
null,ra.rtl?1:2,1,e);break;case -978843926:Ib=this.fill(ra.ha.va.Qd,null,3,1,e);break;case 2098035706:Ib=this.fill(ra.ha.va.Qd,null,ra.rtl?2:1,1,e);break;case -2142700828:Ib=this.fill(ra.ha.sourceRange,ra.ha.va.Qd,qd.vWe(ra.ha.va.Qd,ra.ha.sourceRange),2,e);break;case 1405660955:Ib=this.fill(ra.ha.sourceRange,ra.ha.va.Qd,qd.vWe(ra.ha.va.Qd,ra.ha.sourceRange),4,e);break;case 1983983164:Ib=this.fill(ra.ha.va.Qd,null,0,0,e);break;case 478842689:(e=this.$.da.Aa(376))?(e.SWi(),Gc=!0):Fd.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Gc=ra.ha.Zb(null,Na);break;case -208772570:this.LXh();Gc=!0;break;case -987339782:this.IWh();Gc=!0;break;case -1770246794:ra.ha.JWh();Gc=!0;break;case 748067091:case -381232414:this.LWh(Na);Gc=!0;break;case -1522760979:this.gridView.toggleFormulaView();Gc=!0;break;case 886009118:Ib=this.rXh();break;case 894341014:this.wXh();
Gc=!0;break;case 862825906:Ib=this.i3e(1970784898,e);break;case 1532790410:Ib=this.i3e(1650812936,e);break;case 46555851:Ib=this.HXh(e);break;default:Gc=!1}Gc||(Ib=mg.a(Na));return Ib};qd.prototype.qqj=function(e,C){var M=this,ra=ai.a.all(C,function(Gc){return!M.gridView.Vb.TLa(Gc)}),Na=1<C.length&&!!this.gridView.Vb.lfd(C),Ib=ai.a.all(C,function(Gc){return!M.gridView.Vb.R4(Gc)});C=!ai.a.any(C,function(Gc){return Gc.isRow||Gc.Lh});return 1===e.method&&6===e.df&&(ra||Na)&&Ib&&C};qd.prototype.fillDownAbsoluteValueAndStartEdit=
function(e,C,M){var ra=this,Na=e.ha.va.activeCell,Ib=sg.E(Na,this.gridView.ns);return e.startEdit(!0,0,C).CWR(function(){var Gc=e.sc(Ib),id=e.sc(Na);if(!Gc||!id)return Fd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Na.toString(),Ib.toString()),wg.Task.Ta(!1);ra.gridView.Kc.text=M?Gc.B0:Gc.text;ra.gridView.Kc.textBox.setCaretPositionToEnd();return wg.Task.Ta(!0)})};qd.prototype.insertOrDeleteCells=
function(e,C,M){function ra(){return new Jf(Vd)}var Na=this,Ib=Ng.a.create().toString(),Gc=Enum.toString(ui,e);this.gridView.Ji.X6(17,Ib,Gc);Gc=this.gridView.ha.va.selectedRanges;var id=this.Edf,Uc=this.Bdf;if(!this.$.xs(null,!1,void 0,C.df)&&!Uc&&!id&&5!==e&&9!==e)return wg.Task.Ta(!0);2===e?e=Uc?10:id?6:Gc[0].height>Gc[0].width?18:34:1===e?e=Uc?9:id?5:Gc[0].height>Gc[0].width?17:33:18===e&&id?e=34:34===e&&Uc&&(e=18);Gc=this.JDg(Gc,e);if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5931745_AllowDeleteRowColFromDialog")){if((10===
e||6===e)&&!this.$.xs(Gc,!0,1,C.df))return wg.Task.Ta(!0)}else if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&(10===e||6===e)&&!this.$.xs(Gc,!0))return wg.Task.Ta(!0);var Vd={};Vd.InsertDeleteRangeItems=Array(Gc.length);Vd.SheetName=this.$.oa.sheetName;Vd.IsTableCommand=M;for(M=0;M<Gc.length;M++){id=Gc[M];var Ye={},Gf=Uc=void 0;e&4?(Ye.FirstRow=id.top-1,Ye.LastRow=Mi.a.dz,Ye.FirstColumn=0,Ye.LastColumn=Mi.a.ew,Uc=id.bottom-id.top+1,Gf=0,6===e&&(id.Lh||
(Ye.FirstRow=id.bottom),Uc=-Uc)):e&8?(Ye.FirstRow=0,Ye.LastRow=Mi.a.dz,Ye.FirstColumn=id.left-1,Ye.LastColumn=Mi.a.ew,Uc=0,Gf=id.right-id.left+1,10===e&&(id.isRow||(Ye.FirstColumn=id.right),Gf=-Gf)):e&16?(Ye.FirstRow=id.top-1,Ye.LastRow=id.bottom-1,Ye.FirstColumn=id.left-1,Ye.LastColumn=Mi.a.ew,Uc=0,Gf=id.right-id.left+1,18===e&&(Ye.FirstColumn=id.right,Gf=-Gf)):(Ye.FirstRow=id.top-1,Ye.LastRow=Mi.a.dz,Ye.FirstColumn=id.left-1,Ye.LastColumn=id.right-1,Uc=id.bottom-id.top+1,Gf=0,34===e&&(Ye.FirstRow=
id.bottom,Uc=-Uc));Ye={InsertDeleteRange:Ye};Ye.DeltaRow=Uc;Ye.DeltaColumn=Gf;Ye.AdjustedSelectedRange=sg.j(id);Vd.InsertDeleteRangeItems[M]=Ye}this.gridView.Bh.qG(!1);var rg=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Vd.IsDecoupleRecalc=rg;var Dg=this.$.qa.ta.Xb();return Lg.a(this.$.userOperationManager,function(Eg,Ch,kj){rg&&!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Na.$.Xu();var Lj=Na.$.qa.ta;Eg=hh.b(Eg,Na.FFi);var Rj=Lj.Oa(41,
void 0===Dg?null:Dg);Rj.insertDeleteMultiRangeParameters=Vd;return vf.i(Lj,"InsertDeleteCells",Rj,Eg,Ch,kj,Ib,0)},function(Eg){return new hg.a(237,0,Eg,void 0,ra)},C)};qd.prototype.JDg=function(e,C){return C&32?this.TXa(e,function(M){return M.bottom},function(M){return M.top},function(M,ra){M.bottom=ra},!1,!0):C&16?this.gridView.rtl?this.TXa(e,function(M){return M.left},function(M){return M.right},function(M,ra){M.left=ra},!1,!1):this.TXa(e,function(M){return M.right},function(M){return M.left},function(M,
ra){M.right=ra},!1,!1):C&4?this.TXa(e,function(M){return M.bottom},function(M){return M.top},function(M,ra){M.bottom=ra},!0,!0):C&8?this.gridView.rtl?this.TXa(e,function(M){return M.left},function(M){return M.right},function(M,ra){M.left=ra},!0,!1):this.TXa(e,function(M){return M.right},function(M){return M.left},function(M,ra){M.right=ra},!0,!1):e};qd.prototype.TXa=function(e,C,M,ra,Na,Ib){e=sg.d(e);e.sort(function(Uc,Vd){return C(Vd)-C(Uc)});if(Na){Na=[];Ib=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?
Ib?Mi.a.Fh+1:Mi.a.Qh+1:Ib?Mi.a.dz:Mi.a.ew;for(var Gc=0;Gc<e.length;Gc++){var id=e[Gc];M(id)<Ib&&(ra(id,Math.min(C(id),Ib-1)),Array.add(Na,id),Ib=M(id))}e=Na}return e};qd.prototype.fill=function(e,C,M,ra,Na){function Ib(){return new Wd(Uc,Vd,ra,M)}var Gc=this,id=this.$;if(!id.xs([C],!0))return wg.Task.Ta(!0);var Uc=sg.v(e,id),Vd=C?sg.v(C,id):Uc,Ye=this.$.qa.ta.Xb();return Lg.a(this.$.userOperationManager,function(Gf,rg,Dg){Gc.$.Xu();var Eg=Gc.$.qa.ta,Ch=Eg.Oa(9,Ye);Ch.sourceRange=Uc;Ch.targetRange=
Vd;Ch.fillDirection=M;Ch.fillType=ra;return vf.i(Eg,"FillRange",Ch,Gf,rg,Dg,null,0)},function(Gf){return new hg.a(155,0,Gf,void 0,Ib)},Na)};qd.prototype.QXh=function(e,C,M){var ra={ValidMembers:32};switch(e){case 1890566896:e=parseInt(C[pg.a.hd].toString());if(14===e)return M=new Rg.a(2105621672,M.method,M.mode,M.df,M.tabName),C[pg.a.hd]=null,this.$.Ka.Zb(M,C),Fd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;ra.NumberFormat=e;break;case 1886928607:ra.NumberFormat=13;break;case -992833457:ra.NumberFormat=11;break;case 218524921:ra.NumberFormat=12;break;case 996232352:ra.NumberFormat=1006;break;default:return Fd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+sd.b().pi(M.command)),!1}Fd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",sd.b().pi(M.command),C[pg.a.hd]);this.hi.formatCells(1890566896,ra,M);
this.$.Gf();return!0};qd.prototype.tXh=function(e){var C=this.gridView.sc(this.gridView.ha.va.activeCell);if(this.zg&&this.gridView.isEditing){C=this.gridView.Jj.F2a(C?ah.a(C).Font:null);if(!C)return Fd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.va.activeCell.toString()),!1;var M=C.FontSize}else if(C)M=C.fontSize;else return!1;C=e.command;var ra=0;if(862890474===C)for(;ra<qd.ZIa.length-
1&&qd.ZIa[ra]<=M;)ra++;else if(963349338===C)for(ra=qd.ZIa.length-1;0<ra&&qd.ZIa[ra]>=M;)ra--;Fd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",M,qd.ZIa[ra]);if(M===qd.ZIa[ra])return!0;M=qd.Rtc(2);M.Font.FontSize=qd.ZIa[ra];this.zg&&this.gridView.isEditing?(this.Tmb(e,!1,M),this.$.Gf()):this.hi.formatCells(C,M,e);return!0};qd.prototype.U2e=function(e,C,M){e=e[e[tf.a.IsFreeForm]?tf.a.Value:pg.a.Kg].toString();if(!qd.rSi.test(e))return Fd.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",e),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;e=parseFloat(e);if(8>e||72<e)return Fd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",e,8,72),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var ra=
Math.round(2*e)/2,Na=qd.Rtc(2);Na.Font.FontSize=ra;this.zg&&this.gridView.isEditing?(this.Tmb(C,M,Na,!0),ra===e||M||this.$.Gf()):M?this.hi.gna(this.gridView,-1077965542,Na,M):(this.hi.formatCells(-1077965542,Na,C),this.KZa());return!0};qd.prototype.S2e=function(e,C,M){e=ab.HelperMethods.GRd[e[pg.a.Kg]];if(!e)return!0;var ra=qd.Rtc(1);ra.Font.FontName=e;this.zg&&this.gridView.isEditing?(this.Tmb(C,M,ra),this.$.Gf()):M?this.hi.gna(this.gridView,-1293291468,ra,M):(this.hi.formatCells(-1293291468,ra,
C),this.KZa());return!0};qd.prototype.xbc=function(e,C,M,ra){var Na=-803000997===e||1688184685===e?"black":C.Color;this.moreColorsHelper&&(-1832800737===e?Na=K.a.compare(Na,"WindowText",!0)?this.moreColorsHelper.qFb:"black":M||(this.moreColorsHelper.qFb=Na,this.moreColorsHelper.xca(C,Na,ra)));e=qd.Rtc(32);e.Font.FontColor=Aj.a.HG(Na,gi.a.ug(C,"IntColor"));this.zg&&this.gridView.isEditing?this.Tmb(ra,M,e,17===ra.df):M?this.hi.gna(this.gridView,1970784898,e,M):(this.qH&&(M=this.getThemeColor(C),C=M.themeColor,
M.returnValue&&(e.Font.ThemeFontColor=C,e.Font.ColorTypeOption=1)),this.hi.formatCells(1970784898,e,ra),this.KZa());return!0};qd.prototype.LWh=function(e){var C=(new Date).format(748067091===e?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),M=this.gridView.xj?mj.a(this.gridView.$):this.gridView.Kc;e=M.textBox;if(this.gridView.isEditing)M.insertText(C);else{var ra=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,
ra);M.text=C;C=C.length;e.BQa(C);e.caretPosition=C}};qd.prototype.LXh=function(){this.gridView.hka(this.gridView.ha.va.activeCell)||this.gridView.ltc||this.gridView.OLa()||this.gridView.yt(this.gridView.ha.va.activeCell,3,Bj.a.Y1e)};qd.prototype.IWh=function(){if(!(this.gridView.ltc||this.gridView.OLa()||this.gridView.isEditing&&Mf.a.isMac)){var e=this.gridView.ha.va.T3;this.gridView.yi(sg.v(e,this.$),e,null,null,60,Bj.a.Y1e)}};qd.prototype.fXh=function(e){var C=this;this.N8b=eh.d(this.$.xa.oa);var M=
this.$.da.Aa(254,!0);if(this.gridView.c5a)return this.gridView.Bh.qG(!1),!!M;if(!M)return Fd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.i2(this.$$c);var ra=String.format(Je.a.Nsa,rh.a.current.co(84));this.gridView.Bh.Rt(ra);e=new Rg.a(-911352779,e.method,e.mode,e.df,e.tabName);ra={};this.$.Ka.Zb(e,(ra[Je.a.silentClipboardAccessFailures]=!0,ra[Je.a.isFormatPainter]=!0,ra)).continueWith(function(Na){(6>Na.status||6===
Na.status&&!Na.result)&&C.Yob()});this.gridView.c5a=!0;M.FBg(this.Yob);return!0};qd.prototype.cvb=function(e,C,M,ra){var Na=87208751===e?"-1":C.Color;this.moreColorsHelper&&(1597684571===e?Na=this.moreColorsHelper.u$a:M||(this.moreColorsHelper.u$a=Na===qd.notSet?qd.RTd:Na,this.moreColorsHelper.xca(C,Na,ra)));e={ValidMembers:64};e.FillColor=Aj.a.HG(Na,gi.a.ug(C,"IntColor"));M?this.hi.gna(this.gridView,1650812936,e,!0):(this.qH&&(M=this.getThemeColor(C),C=M.themeColor,M.returnValue&&(e.ThemeFillColor=
C,e.ColorTypeOption=1)),this.hi.formatCells(1650812936,e,ra),this.KZa());return!0};qd.prototype.wXh=function(){Fd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var e=this.$.da.Aa(221);if(e){var C=this.gridView.Jj;if(C){var M=e.j6h(C.text,C.textBox.caretPosition);var ra=M.Znf;var Na=M.WQe;(M=M.returnValue)?(e.isListVisible=!1,C.text=M,C.textBox.selectRange(ra,ra+Na),Fd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):
Fd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Fd.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Fd.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};qd.prototype.eXh=function(e,C){var M=0,ra=this.gridView,Na=ah.a(ra.sc(null));this.zg&&ra.isEditing&&
(Na.Font=ra.Jj.F2a(Na.Font));var Ib=Na.Font;Ib||(Ib={ValidMembers:0});switch(e){case -287251124:M|=4;nj.e(Ib,4)?Ib.Bold=!Ib.Bold:Ib.Bold=!0;break;case -1925065947:M|=8;nj.e(Ib,8)?Ib.Italic=!Ib.Italic:Ib.Italic=!0;break;case 1764140053:M|=16;nj.e(Ib,16)?Ib.Underline=!Ib.Underline:Ib.Underline=!0;break;case -1685033574:M|=64;nj.e(Ib,64)?Ib.DoubleUnderline=!Ib.DoubleUnderline:Ib.DoubleUnderline=!0;break;case -1590502662:M|=128,nj.e(Ib,128)?Ib.Strikethrough=!Ib.Strikethrough:Ib.Strikethrough=!0}if(!M)return!1;
Ib.ValidMembers=M;Na.Font=Ib;Na.ValidMembers=16;this.zg&&this.gridView.isEditing?this.Tmb(C,!1,Na):(ld.EwaSettings.la(686)||ra.Bh.qG(!1),this.hi.formatCells(e,Na,C));this.$.Gf();return!0};qd.prototype.qWh=function(e,C){var M=0,ra=this.gridView,Na=ah.a(ra.sc(null));-571165336===e||1041132226===e||-394785302===e?(M|=1,Na.VerticalAlignment=gi.a.Jn(qd.YXa,e.toString(),2)):qd.vbi(e)?(M|=2,this.oXh(Na,e)):-1116189897===e&&(M|=8,Na.Wrap=Na.ValidMembers&8?!Na.Wrap:!0);if(!M)return!1;Na.ValidMembers=M;ld.EwaSettings.la(686)||
ra.Bh.qG(!1);this.hi.formatCells(e,Na,C);this.$.Gf();return!0};qd.prototype.oXh=function(e,C){!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==C&&(C=-1150205178===C?-286432209:-1150205178);C=gi.a.Jn(qd.YXa,C.toString(),0);e.HorizontalAlignment=C===e.HorizontalAlignment?0:C};qd.prototype.bGf=function(e,C,M,ra){var Na=this,Ib=!1;ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&
(Ib=this.Ajc.tmf(C,M))&&$e.g(this.$).Ji.m0(this.t7a,fh.BasicTelemetryCalculator.sQ);return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.A$(e,C,!1,Ib,function(Gc){Na.SGi(Gc,M,C,Ib,ra)}):this.A$(e,C,!1,Ib,function(Gc,id,Uc){Na.UGi(Gc,id,Uc,M,C,Ib,ra)})};qd.prototype.handleMergeCellsCommand=function(e,C){var M=this;this.t7a=Ng.a.create().toString();var ra=null;ra=this.Ajc.bYe();var Na=zi.a(C.command),Ib=this.Ajc.u$h(C.command,
ra),Gc=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),id=0;Gc&&Ib?id=pd.a.me():$e.g(this.$).Ji.X6(4,this.t7a,Na+", Scenario = "+ra.scenario.toString());Na=e.ha.va.selectedRanges;Fd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",sd.b().pi(C.command),Na.length,sg.i(Na,",",this.$,!1));Na=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",
!1);e.Bh.qG(!1,Na);if(10===gi.a.Jn(qd.vmf,C.command.toString(),10))return wg.Task.Ta(!1);var Uc=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Na&&Uc)return Ib?(Gc?this.fPd(ra,C,!0,!0,id):this.fPd(ra,C,!0),wg.Task.Ta(!0)):this.bGf(e,C,ra,!1);var Vd=!1;Na&&(Vd=this.Ajc.tmf(C,ra))&&$e.g(this.$).Ji.m0(this.t7a,fh.BasicTelemetryCalculator.sQ);return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.A$(e,C,!1,Vd,function(Ye){M.TGi(Ye,C,Vd)}):this.A$(e,C,!1,Vd,function(Ye,Gf,rg){M.VGi(Ye,Gf,rg,C,Vd)})};qd.prototype.A$=function(e,C,M,ra,Na){function Ib(rg,Dg,Eg){Uc.$.Xu();rg=Na?hh.b(rg,Na):rg;rg=hh.b(rg,Gc);return vf.f(Uc.$.qa.ta,Ye,Gf,M,rg,Dg,Eg,null,Vd)}function Gc(rg){var Dg=!!rg&&!!rg.RequestTelemetryData;$e.g(Uc.$).Ji.Pka(Uc.t7a,rg.StateId,Dg?rg.RequestTelemetryData.EcsOperationDuration:0,Dg?rg.RequestTelemetryData.EcsRequestDuration:0,Dg?rg.RequestTelemetryData.WfeRequestDuration:0)}
function id(){return new ac(Ye,Gf)}var Uc=this;Na=void 0===Na?null:Na;var Vd=this.$.qa.ta.Xb(),Ye=gi.a.Jn(qd.vmf,C.command.toString(),10),Gf=sg.r(e.ha.va.selectedRanges,e.$);return ra?ld.EwaSettings.tc()?Lg.a(this.$.userOperationManager,Ib,function(rg){return new hg.a(156,0,rg,64,id)},C):Lg.a(this.$.userOperationManager,Ib,function(rg){return new Ze.a(156,0,rg,void 0,id)},C):Lg.a(this.$.userOperationManager,Ib,function(rg){return new hg.a(156,0,rg,void 0,id)},C)};qd.prototype.fPd=function(e,C,M,ra,
Na){var Ib=this;ra=void 0===ra?!1:ra;Na=void 0===Na?0:Na;Fd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",M);var Gc=$e.g(this.$).rtl,id=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Gc=mh.a.jd(3,2,0,Gc?625:624,0,514846606,"MergeCellsLoseData");xf.TaskExtensions.Ba(Qi.a(this.$).ri(Gc),function(Uc){Uc=Uc.result;if(ra){var Vd=pd.a.me()-Na;Fd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",
Vd,Uc)}Uc?1===Uc&&Fd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Fd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),M?(ra&&id&&(Uc=zi.a(C.command),$e.g(Ib.$).Ji.X6(4,Ib.t7a,Uc+", Scenario = "+e.scenario.toString())),Ib.bGf($e.g(Ib.$),C,e,!0)):Ib.A$(Ib.gridView,C,!0,!1))},this.$.ma,11)};qd.prototype.Aif=function(e,C,M,ra){C!==e&&Fd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",
C,e,M,ra)};qd.prototype.TGi=function(e,C,M){var ra=this;yh.b(e,514846606)&&(Fd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),hj.a(this.$).nd.AD(514846606),e=$e.g(this.$).rtl,e=mh.a.jd(3,2,0,e?625:624,0,514846606,"MergeCellsLoseData"),xf.TaskExtensions.Ba(Qi.a(this.$).ri(e),function(Na){(Na=Na.result)?1===Na&&Fd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Fd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),ra.A$(ra.gridView,
C,!0,M))},this.$.ma,11))};qd.prototype.VGi=function(e,C,M,ra,Na){new ne(this,e,C,M,ra,Na)};qd.prototype.SGi=function(e,C,M,ra,Na){var Ib=this,Gc=!1;yh.b(e,514846606)&&(Gc=!0,hj.a(this.$).nd.AD(514846606),ra&&Na?window.setTimeout(function(){Ib.A$(Ib.gridView,M,!0,!0)},0):this.fPd(C,M,!1));this.Aif(Gc,Na,C.scenario,ra)};qd.prototype.UGi=function(e,C,M,ra,Na,Ib,Gc){new Bd(this,e,C,M,ra,Na,Ib,Gc)};qd.prototype.lob=function(e){var C=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
if(C&&this.hZa!==e&&1461300262!==this.hZa){this.TPf(this.hZa);var M=sd.b().pi(e),ra=sd.b().pi(this.hZa);Fd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",ra,M)}C&&(this.hZa=e);if(this.zg&&this.gridView.isEditing)this.dZa||(this.dZa=this.gridView.Jj.formattedText);else if(!this.LD){this.LD=[];C=this.gridView.l$("GridCommandHandler.CacheFontStyles",this.gridView.ha.va.selectedRanges);try{for(C.$$rst();C.$$mn();){var Na=
C.$$cu(),Ib=Na.cell.hasRichText;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Gc=sd.b().pi(e);Fd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Gc,Ib,this.LD.length)}if(Ib)Array.add(this.LD,Pd.IMg(Na,Na.cell.formattedText));else switch(e){case 673562736:case -446735083:Array.add(this.LD,Pd.eXc(Na,Na.backgroundColor));ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Na.backgroundColor&&Fd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Na.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.LD,Pd.eXc(Na,Na.color));ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Na.color&&Fd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Na.color);break;case 909774670:Array.add(this.LD,
Pd.JMg(Na,Na.fontSize));if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var id=oi.c(Na.fontSize)?"null or undefined":Na.fontSize.toString();Fd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",id)}break;case 324978188:Array.add(this.LD,Pd.eXc(Na,Na.fontName)),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Na.fontName?Fd.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",
gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Na.fontName),Na.fontName.length):Fd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!Na.fontName))}}}finally{C&&C.dispose()}}};qd.prototype.Juj=function(){return this.zg&&this.gridView.isEditing?!this.dZa:!this.LD};qd.prototype.t9h=function(e){return!!this.LD&&this.LD.length>e&&!!this.LD[e].formattedText};qd.prototype.ubd=function(e){return this.LD[e].style};qd.prototype.nEh=
function(e){return this.LD[e].size};qd.prototype.TPf=function(e){if(this.Juj())ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Fd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",e);else{if(this.zg&&this.gridView.isEditing)ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(e=sd.b().pi(e),Fd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",
e)),this.dZa&&(this.gridView.Kc.formattedText=this.dZa);else for(var C=this.LD.length,M=0;M<C;M++){var ra,Na=this.LD[M].O1a.cell.getRange();if(ra=this.gridView.sc(Na)){Na=void 0;var Ib=ra.VJ?this.gridView.ctc(ra.range):(Na=new mc.a,Na.add(ra),Na);Na=yl(Ib);for(Ib=Na.next();!Ib.done;Ib=Na.next()){Ib=Ib.value;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Gc=sd.b().pi(e);Fd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Gc,Ib.cell.hasRichText,M,ra.VJ,C)}if(Ib.cell.hasRichText&&1457172838!==e)this.t9h(M)&&(Ib.cell.formattedText=this.LD[M].formattedText,ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ib.cell.formattedText&&Fd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(e){case 1457172838:Ib.backgroundColor=this.ubd(M);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Ib.backgroundColor&&Fd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!Ib.backgroundColor);break;case 2036397036:Ib.color=this.ubd(M);ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ib.color&&Fd.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!Ib.color);break;case -1904244080:Ib.fontSize=this.nEh(M);
ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Ib=oi.c(Ib.fontSize)?"null or undefined":Ib.fontSize.toString(),Fd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",Ib));break;case -1428968098:Gc=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),Ib.gMd(this.ubd(M),Gc,"RestoreCachedStyles")}}}else Fd.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",
Na.qE(!1))}ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.hZa=1461300262);this.KZa()}};qd.prototype.KZa=function(){this.zg&&this.gridView.isEditing?this.dZa=null:this.LD=null;ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Fd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};qd.prototype.uXh=function(e,C){var M={IndentationIncrease:0};if(-1942512156===e)M.IndentationIncrease=1;
else if(-1920201820===e)M.IndentationIncrease=-1;else return!0;M.ValidMembers=256;this.hi.formatCells(e,M,C);return!0};qd.prototype.rXh=function(){var e=this,C=$e.g(this.$),M=sg.r(C.ha.va.selectedRanges,this.$),ra=sg.o(C.ha.va.activeCell,this.$);Fd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return Lg.a(this.$.userOperationManager,function(Na,Ib,Gc){return vf.K(e.$.qa.ta,ra,M,Na,Ib,Gc,null)},function(Na){return new hg.a(201,0,Na)},null)};qd.prototype.i3e=
function(e,C){var M=null,ra=$e.g(this.$).ha.va.selectedRanges;ra=this.gridView.l$("MoreColors",ra,1,!0);try{for(ra.$$rst();ra.$$mn();){var Na=ra.$$cu().cell;if(Na){var Ib=qd.black;if(1970784898===e)Ib=Na.color;else if(1650812936===e){var Gc=Na.backgroundColor;Ib=K.a.compare(Gc,qd.RTd,!0)&&K.a.compare(Gc,qd.empty,!0)?Na.backgroundColor:qd.white}if(!M)M=Ib;else if(M!==Ib){M=qd.black;break}}}}finally{ra&&ra.dispose()}this.zg&&this.gridView.isEditing&&1970784898===e&&this.gridView.Jj.textBox.ire();return this.moreColorsHelper.Nwa(e,
C,M)};qd.prototype.HXh=function(e){var C=bh.a.Y2a(this.borderFormatManager.X2);return this.moreColorsHelper.Nwa(-236759591,e,C)};qd.prototype.Tmb=function(e,C,M,ra){var Na=this;ra=void 0===ra?!1:ra;C?this.gridView.Jj.bFf(M.Font):(this.Boi(e),ra?window.requestAnimationFrame(function(){Cg.FocusManager.instance().dk(sh.AFrame.Vha);Na.gridView.Jj.bSe(M.Font)}):(Cg.FocusManager.instance().dk(sh.AFrame.Vha),this.gridView.Jj.bSe(M.Font)),this.KZa())};qd.prototype.Boi=function(e){var C=zi.a(e.command);e=
Of.a[e.df]+"_"+dh.a[e.method];var M=this.gridView.rc.Lue.toString(),ra=new Map;ra.set("Command",C);ra.set("Source",e);ra.set("Ribbon","React");ra.set("CellTextRuns",M);xi.Health.instance.recordKpiUsage(Oi.a.Xxh,0,rk.a.qQf,ra)};qd.prototype.qgd=function(e,C,M){e=this.borderFormatManager.qgd(e,C,M);this.moreColorsHelper&&this.moreColorsHelper.xca(C,this.borderFormatManager.X2,M);return e};qd.prototype.getThemeColor=function(e){var C={};var M=!1;if((e.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Fd.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:C};M=this.themesManager.getThemeColor(e.Color);e=M.themeIndex;var ra=M.AAa;if(M=M.returnValue)C.ThemeColorIndex=e,C.ThemeColorRow=ra}return{returnValue:M,themeColor:C}};qd.vbi=function(e){return-1150205178===e||-1142465846===e||-286432209===e};qd.Rtc=function(e){var C={},M={};C.ValidMembers=16;C.Font=M;M.ValidMembers=e;return C};qd.vWe=function(e,C){var M=e.top<C.top?3:e.bottom>C.bottom?0:-1;return M=e.left<
C.left?1:e.right>C.right?2:M};tl.Object.defineProperties(qd.prototype,{Edf:{configurable:!0,enumerable:!0,get:function(){return ai.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.isRow})}},Bdf:{configurable:!0,enumerable:!0,get:function(){return ai.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.Lh})}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.zB||(this.zB=this.$.da.Aa(422));return this.zB}}});tl.Object.defineProperties(qd,{rSi:{configurable:!0,enumerable:!0,
get:function(){return qd.fbe||(qd.fbe=RegExp("^[0-9]+[.]?[0-9]*$"))}},ckd:{configurable:!0,enumerable:!0,get:function(){var e={};return qd.I5d||(qd.I5d=(e.InsertRows=5,e.InsertColumns=9,e.InsertCellsShiftRight=17,e.InsertCellsShiftDown=33,e.DeleteRows=6,e.DeleteColumns=10,e.DeleteCellsShiftLeft=18,e.DeleteCellsShiftUp=34,e.DeleteRowsTable=6,e.DeleteColumnsTable=10,e.InsertRowsTable=5,e.InsertColumnsTable=9,e))}},YXa:{configurable:!0,enumerable:!0,get:function(){var e={};return qd.tfb||(qd.tfb=(e["-394785302"]=
0,e["-571165336"]=2,e["1041132226"]=1,e["-1150205178"]=1,e["-1142465846"]=2,e["-286432209"]=3,e))}},vmf:{configurable:!0,enumerable:!0,get:function(){var e={};return qd.t9d||(qd.t9d=(e["-167499203"]=2,e["-255094134"]=5,e["1097660126"]=6,e["155820588"]=7,e))}}});qd.RTd="transparent";qd.notSet="-1";qd.black="#000000";qd.empty="";qd.white="#FFFFFF";qd.I5d=null;qd.tfb=null;qd.t9d=null;qd.fbe=null;qd.ZIa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(td.a)(qd,"GridCommandHandler",null,[147]);var Qk=
af.a;vm(Yd,Qk);Yd.prototype.Md=function(){var e=this;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var C=ud.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.tb),M=ud.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),ra=ud.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.tb),Na=ud.GetServiceTaskFactory.Xa(this.$.da,296,468,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([C,M,ra,Na],this.ma),function(){e.Ed([new qd(e.$,$e.g(e.$),
M.result,C.result,Na.result,ra.result)])},this.ma,3)}else{var Ib=ud.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.tb),Gc=ud.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),id=ud.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb),Uc=ud.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([Ib,Gc,id,Uc],this.ma),function(){e.Ed([new qd(e.$,$e.g(e.$),Gc.result,Ib.result,new Ke.BorderFormatManager(e.$,Gc.result,id.result),Uc.result)])},
this.ma,3)}};Yd.ja=function(e){af.a.de(80,new Yd(e))};Object(td.a)(Yd,"GridCommandHandlerFactory",af.a,[]);var fk=b(30),Zk=b(204),uk=b(1188);Kd.prototype.dispose=function(){var e=this;this.deactivate();this.gridView&&(this.tableManager.NMf(this.Gxf),this.gridView.I4i(this.Yuf),this.gridView.J4i(this.Zuf),this.$.xa.rg(this.Oe),this.$.xb.rg(this.Oe),this.Poe(function(C){C.qHd(e.rKa)}));this.gridView=this.tableManager=this.aga=null};Kd.prototype.nyc=function(e,C,M,ra){if(!eh.b(this.$.oa)||this.$.fa.isNamedObjectViewMode||
this.gridView.$a.rSa)return!0;if(!M.length)return!1;var Na=ra.length;if(ra[Na-1]<e.left)return!1;var Ib=ab.HelperMethods.Tw(new Zk.a(ra),0,Na,e.left,ab.HelperMethods.xC);if(0>Ib)return!1;var Gc=e.H5f,id=!!e.v_b&&0<e.v_b.length,Uc=!!e.menuModel&&0<e.menuModel.length,Vd=Ib,Ye=0;for(Na=Math.min(Gc.length+Ib,Na);Vd<Na;Vd++,Ye++)if(Ib=M[Vd],!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||Ib){var Gf=null,rg=Ib.getElementsByClassName(fk.a.t8c);rg&&(Gf=rg[0]);if(Gf&&
Gf.innerText){if(rg=Ib.getElementsByClassName(fk.a.Fme))for(var Dg=rg.length-1;0<=Dg;Dg--)Ib.removeChild(rg[Dg]);rg=ra[Vd];C?(Gf.innerText=Gc[Ye],Ib.classList.add(fk.a.CNe),id&&e.v_b[Ye]&&(Gf=document.createElement("div"),Gf.innerHTML=e.v_b[Ye],Uc&&e.menuModel[Ye]&&this.fxg(e,Ye,rg),Ib.appendChild(Gf.firstChild))):(Ib.classList.remove(fk.a.CNe),Gf.textContent=Ug.Range.rY(rg),this.ydh(e,Ye,rg))}}e.CRa=C;return!0};Kd.prototype.fxg=function(e,C,M){this.$.da.Za(8,function(ra){ra.U7b.cFi(e,C,M)})};Kd.prototype.ydh=
function(e,C,M){this.$.da.Za(8,function(ra){ra.U7b.dFi(e,C,M)})};Kd.prototype.l1f=function(e,C,M,ra){for(var Na=!1,Ib=this.NTh(e,C),Gc=this.aga.length-1;0<=Gc;Gc--){var id=this.aga[Gc];C>=id.left&&e<=id.right&&(this.nyc(id,!1,M,ra),Array.removeAt(this.aga,Gc),Na=!0)}e=0;for(C=Ib.length;e<C;e++)this.nyc(Ib[e],!0,M,ra)&&(Array.add(this.aga,Ib[e]),Na=!0);return Na};Kd.prototype.activate=function(){this.te()&&!this.active&&(this.gridView.view.it(this.iw),this.active=!0)};Kd.prototype.deactivate=function(){this.active&&
(this.gridView.view.Wr(this.iw),this.active=!1)};Kd.prototype.te=function(){return eh.b(this.$.oa)&&!this.$.fa.isNamedObjectViewMode&&0>=this.gridView.$a.oO&&0<this.tableManager.rangeList.length};Kd.prototype.Poe=function(e){var C=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.gridView.ync:[this.gridView.J2];C=yl(C);for(var M=C.next();!M.done;M=C.next()){M=yl(M.value);for(var ra=M.next();!ra.done;ra=M.next()){ra=yl(ra.value);for(var Na=
ra.next();!Na.done;Na=ra.next())e(Na.value)}}};Kd.prototype.NTh=function(e,C){var M=[];if(!this.active)return M;this.xMa=this.gridView.Afd();for(var ra=this.tableManager.rangeList.length-1;0<=ra;ra--){var Na=this.tableManager.rangeList[ra];Na.bottom>=this.xMa&&this.zfd(Na)<=this.xMa&&Na.left>=e&&Na.right<=C&&Na.mva&&Array.add(M,Na)}return M};Kd.prototype.zfd=function(e){var C=this.gridView.Vb.vk(e);return C&&this.tableManager.Maf(e,C.usedRange.topLeft)?e.top+1:e.top};Object(td.a)(Kd,"HeaderSnappingFeature",
null,[3]);var Jj=tb.a;vm(bd,Jj);bd.prototype.create=function(){var e=this,C=ud.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([C],this.ma),function(){e.Fb(e.$.da.Aa(68)||new Kd(C.result,$e.g(e.$)))},this.ma,11)};bd.ja=function(e){e.da.Ha(67,new bd(e))};Object(td.a)(bd,"HeaderSnappingFactory",tb.a,[]);var Dk=b(1245),Ek=tb.a;vm(Ac,Ek);Ac.prototype.create=function(){var e=this,C=this.$.da,M=ud.GetServiceTaskFactory.create(C,134,this.ma,this.tb),
ra=ud.GetServiceTaskFactory.Xa(C,213,214,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([M,ra],this.ma),function(){var Na=C.Aa(1);Na||(Na=new Dk.CellAutoCompleteControl(e.$,M.result),ra.result.ja(Na));e.Fb(Na)},this.ma,3)};Ac.ja=function(e){e.da.Ha(151,new Ac(e))};Object(td.a)(Ac,"CellAutoCompleteControlFactory",tb.a,[]);dc.prototype.dispose=function(){this.OUd();this.zYa=null};dc.prototype.ja=function(e){e&&(this.zYa=e,e.tTc(this.Mxf),e.h2(this.Nxf),e.PAg(this.Oxf))};dc.prototype.OUd=function(){this.zYa&&
(this.zYa.UGd(this.Mxf),this.zYa.Mca(this.Nxf),this.zYa.U4i(this.Oxf))};Object(td.a)(dc,"CellAutoCompleteReadoutHandler",null,[600,3]);var vk=tb.a;vm(mb,vk);mb.prototype.create=function(){var e=this,C=this.$.da;xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(C,211,212,this.tb),function(M){M=C.Aa(213)||new dc(M.result,C);e.Fb(M)},this.ma,3)};mb.ja=function(e){e.da.Ha(214,new mb(e))};Object(td.a)(mb,"CellAutoCompleteReadoutHandlerFactory",tb.a,[]);Aa.Tjh="ewa-dv";Aa.Ujh="ewa-dv-buttonarea";Aa.$ih=
"ewa-dlb";Aa.Tzb="list-table";Aa.listItem="list-item";Aa.Qzb="list-item-selected";Aa.Uzb="list-table-touch";Aa.Sjh="ewa-dpb";Object(td.a)(Aa,"CssClassNames",null,[]);var Fj=b(520),sj=b(45),Kj=b(428),Zi=b(961),gk=Nh.ErrorDialog;vm(uc,gk);uc.prototype.dispose=function(){$e.g(this.$).ha.mF(this.kd);gk.prototype.dispose.call(this)};uc.prototype.setFocus=function(){switch(this.error.Severity){case 0:var e=4;break;case 1:e=3;break;case 2:e=0;break;default:e=this.closeAction}(e=this.getButton(e))?e.get_element().focus():
gk.prototype.setFocus.call(this)};uc.prototype.qpb=function(){var e=$e.g(this.$);e.isEditing&&e.Kc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.MQd(1);if(2===this.returnValue||!this.returnValue){var C=e.sc(null);if(C){e.Ca.fV();var M=Object.assign(new Jh.a,{Text:C.originalText});e.setCell(M,C.range,0,63,null)}this.$.Ce(-798660877,pg.a.Wb,8,null)}gk.prototype.qpb.call(this)};uc.prototype.dGa=function(){var e=$e.g(this.$);e.isEditing&&e.Kc.endEdit(!1,
"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.MQd(0);gk.prototype.dGa.call(this)};uc.prototype.MQd=function(e){var C=$e.g(this.$);xf.TaskExtensions.Ba(C.startEdit(!1,e),function(){var M=C.Kc.textBox;M.text&&M.selectRange(0,M.text.length)},this.ma,11,Se.a.current)};uc.iQ=function(e,C,M){M=C.da.Aa(14).v2a(M);e.MessageId=-1083021405;e.MessageIdName="DataValidationError";e.MessageIdHash=bh.a.lu(e.MessageIdName);e.Severity=M?M.h7c:1;C=(null===M||void 0===M?0:M.oIa)?
bh.a.If(M.oIa):null;M=(null===M||void 0===M?0:M.error)?bh.a.If(M.error):String.format("<p>{0}</p><p>{1}</p>",Ae.a.instance.ea(874),Ae.a.instance.ea(875));switch(e.Severity){case 0:e.Appearance=18;break;case 1:e.Appearance=12;M+=String.format("<p>{0}</p>",Ae.a.instance.ea(876));break;default:e.Appearance=3}e.Caption=C;e.Description=M;e.HelpDescription=Ae.a.instance.ea(1273);e.HelpTopicId=Zi.a.kDe;return e};Object(td.a)(uc,"DataValidationErrorDeprecatedDialog",Nh.ErrorDialog,[]);var Rh=b(180),Ok=b(166),
wk=Ni.a;vm(Hc,wk);Hc.prototype.dispose=function(){this===this.Ab.Ap&&(this.Ab.Ap=null);jf.a.Fa(this.xm);this.xm=null;wk.prototype.dispose.call(this)};Hc.prototype.Whj=function(){this.su&&this.su.error?this.errorMessage=this.su.error:this.su&&this.su.options&1?(Fd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=Ae.a.instance.ea(1682),this.g5e=rh.a.current.co(96)):(this.errorMessage=Ae.a.instance.ea(1681),this.NGh(this.xJe));
var e=this.su?this.su.h7c:1,C={};this.s$=(C[Hc.Ly]=this.xc,C.errorDescription=this.errorMessage,C.helpImageUri=this.g5e,C);switch(e){case 0:this.kc=1;this.Cc(1,"Retry");this.s$.dialogIcon=2;this.idf=!0;break;case 1:this.kc=4;this.s$.dialogIcon=1;this.s$.additionalInformation=Ae.a.instance.ea(876);break;default:this.kc=1,this.s$.dialogIcon=3}e={};this.s$.helpLink=(e.type="AppLinkProps",e[Hc.Ly]=this.error.HelpTopicId,e.text=Ae.a.instance.ea(1273),e.handler=this.n8a,e);e=mh.a.YUc([this.error]);C={};
this.rU=(C[Je.a.F7b]=!0,C[Je.a.o9c]=e,C[Je.a.p9c]=Ok.a(this.$).Qrb(this.error.MessageIdHash),C[Je.a.N$]=this.xc,C.DismissHandler=this.Uxd,C);e={};this.s$.giveFeedbackLink=(e.type="AppLinkProps",e[Hc.Ly]=Je.a.Zfd,e.text=Ae.a.instance.ea(1718),e.handler=this.XEi,e)};Hc.prototype.NGh=function(e){var C=this.$.qa.ta.Xb();vf.u(this.$.qa.ta,sg.q(e,this.$),hh.b(this.zDi),hh.a(this.yDi),null,C)};Hc.prototype.AQh=function(e){switch(e.RuleType){case 1:switch(e.ConditionType){case 0:var C=Ae.a.instance.Cb(107);
return String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=Ae.a.instance.Cb(108),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=Ae.a.instance.Cb(109),String.format(C,e.LowerBoundary);case 3:return C=Ae.a.instance.Cb(110),String.format(C,e.LowerBoundary);case 4:return C=Ae.a.instance.Cb(111),String.format(C,e.LowerBoundary);case 5:return C=Ae.a.instance.Cb(112),String.format(C,e.UpperBoundary);case 6:return C=Ae.a.instance.Cb(113),String.format(C,e.LowerBoundary);case 7:return C=
Ae.a.instance.Cb(114),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(e.ConditionType){case 0:return C=Ae.a.instance.Cb(115),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=Ae.a.instance.Cb(116),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=Ae.a.instance.Cb(117),String.format(C,e.LowerBoundary);case 3:return C=Ae.a.instance.Cb(118),String.format(C,e.LowerBoundary);case 4:return C=Ae.a.instance.Cb(119),String.format(C,e.LowerBoundary);
case 5:return C=Ae.a.instance.Cb(120),String.format(C,e.UpperBoundary);case 6:return C=Ae.a.instance.Cb(121),String.format(C,e.LowerBoundary);case 7:return C=Ae.a.instance.Cb(122),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(e.ConditionType){case 0:return C=Ae.a.instance.Cb(123),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=Ae.a.instance.Cb(124),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=Ae.a.instance.Cb(125),String.format(C,
e.LowerBoundary);case 3:return C=Ae.a.instance.Cb(126),String.format(C,e.LowerBoundary);case 4:return C=Ae.a.instance.Cb(127),String.format(C,e.LowerBoundary);case 5:return C=Ae.a.instance.Cb(128),String.format(C,e.UpperBoundary);case 6:return C=Ae.a.instance.Cb(129),String.format(C,e.LowerBoundary);case 7:return C=Ae.a.instance.Cb(130),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(e.ConditionType){case 0:return C=Ae.a.instance.Cb(131),String.format(C,
e.LowerBoundary,e.UpperBoundary);case 1:return C=Ae.a.instance.Cb(132),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=Ae.a.instance.Cb(133),String.format(C,e.LowerBoundary);case 3:return C=Ae.a.instance.Cb(134),String.format(C,e.LowerBoundary);case 4:return C=Ae.a.instance.Cb(135),String.format(C,e.LowerBoundary);case 5:return C=Ae.a.instance.Cb(136),String.format(C,e.UpperBoundary);case 6:return C=Ae.a.instance.Cb(137),String.format(C,e.LowerBoundary);case 7:return C=Ae.a.instance.Cb(138),
String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(e.ConditionType){case 0:return C=Ae.a.instance.Cb(139),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=Ae.a.instance.Cb(140),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=Ae.a.instance.Cb(141),String.format(C,e.LowerBoundary);case 3:return C=Ae.a.instance.Cb(142),String.format(C,e.LowerBoundary);case 4:return C=Ae.a.instance.Cb(143),String.format(C,e.LowerBoundary);case 5:return C=
Ae.a.instance.Cb(144),String.format(C,e.UpperBoundary);case 6:return C=Ae.a.instance.Cb(145),String.format(C,e.LowerBoundary);case 7:return C=Ae.a.instance.Cb(146),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 3:return C=Ae.a.instance.Cb(105),String.format(C,e.LowerBoundary);case 7:return C=Ae.a.instance.Cb(106),String.format(C,e.LowerBoundary);default:return"we couldn't get the details"}};Hc.prototype.MQd=function(e){var C=$e.g(this.$);xf.TaskExtensions.Ba(C.startEdit(!1,
e),function(){var M=C.Kc.textBox;M.text&&M.selectRange(0,M.text.length)},this.ma,11,Se.a.current)};Hc.iQ=function(e,C,M){C=C.da.Aa(14).v2a(M);e.MessageId=-1083021405;e.MessageIdName="DataValidationError";e.MessageIdHash=bh.a.lu(e.MessageIdName);e.Severity=C?C.h7c:1;e.HelpDescription=Ae.a.instance.ea(1273);e.HelpTopicId=Zi.a.kDe;return e};tl.Object.defineProperties(Hc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=
this.xm||new Rh.a;return this.xm.token}}});Object(td.a)(Hc,"DataValidationErrorDialog",Ni.a,[91,92,3,93]);var Pk=b(1046),lk=b(381),Gj=Pk.a;vm(Jb,Gj);Jb.prototype.dispose=function(){this.dataValidationControl=null;Gj.prototype.dispose.call(this)};Jb.prototype.ki=function(e,C){this.dataValidationControl.qb=this.qb;var M=e.keyCode;return 1461300262!==C||16!==M&&17!==M&&18!==M?Gj.prototype.ki.call(this,e,C):!1};Jb.prototype.Zwd=function(){this.kV&&(this.dataValidationControl.qb=this.qb,this.dataValidationControl.show(this.dataValidationControl.BQ,
!0,!0,Mf.a.Pr||3===pg.a.Wb))};Jb.prototype.Rh=function(){};Jb.prototype.Mj=function(){this.dataValidationControl.show(this.dataValidationControl.BQ,!0,!0,Mf.a.Pr||3===pg.a.Wb)};Jb.prototype.lDd=function(e,C){return this.dataValidationControl.ki(C)};tl.Object.defineProperties(Jb.prototype,{qxb:{configurable:!0,enumerable:!0,get:function(){return Object(eg.a)(Hc,this.$.Ab.rh)}},kV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(e){this.dataValidationControl.isListVisible=
e}},swb:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return lk.a.P3c}}});Object(td.a)(Jb,"DataValidationListAutoCompleteBehavior",Pk.a,[]);var Xj=b(978),xk=b(1045),ak=Xj.a;vm($b,ak);$b.prototype.dispose=function(){ak.prototype.dispose.call(this);this.T6a=this.rkb=null};$b.prototype.Sda=function(e,C,M,ra){if(e&&(!e||e.length)){this.d7(!1);this.tHa=e;this.wV=[];for(var Na=0;Na<e.length;Na++)this.wV[Na]=e[Na]?e[Na].Name:null;Na=String.format("<table class='{0}' aria-live='polite'><tbody>",
this.rba);var Ib="",Gc="";e=0;var id=$e.g(this.$).sc(null);ra=this.isEditing?ra?ra.text:this.editText:id?id.originalText:null;id=!ra;var Uc=0;Array.clear(this.DDb);var Vd=[],Ye=[],Gf=[],rg=ra?ra.split(" "):[""];ra=ra.trim();for(var Dg={},Eg=0;Eg<this.wV.length;Dg={RBc:Dg.RBc},Eg++){var Ch=this.wV[Eg],kj=void 0;Dg.RBc=Ch.split(" ");kj=ai.a.all(rg,function(Jk){return function(Sk){return ai.a.any(Jk.RBc,function(al){return K.a.eI(al,Sk)})}}(Dg));var Lj=!Ch,Rj=Array.contains(Gf,Ch);Lj||Rj||this.isEditing&&
!kj||(kj=Ch?bh.a.If(bh.a.f6b(Ch)):"",kj=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.QZ,kj),Array.add(Gf,Ch),this.isEditing&&K.a.eI(Ch,ra)?(Ib+=kj,Array.add(Vd,Eg)):(Gc+=kj,Array.add(Ye,Eg)),!id&&K.a.equals(ra,Ch,!0)&&(e=this.isEditing?Vd.length-1:Uc,id=!0),Uc++)}this.Swa=Uc;Array.addRange(this.DDb,Vd);Array.addRange(this.DDb,Ye);this.dg.innerHTML=Na+(Ib+Gc+"</tbody></table>");Na=this.zn=Le.DOMElementExtensions.vj(this.domElement,this.rba);this.Zlb(Na,C);this.d7(!0);this.hra(C,
M);this.Nk=0<this.Swa?Na.rows[e]:null}};$b.prototype.CQa=function(e){var C=!1;this.isEditing&&e&&(C=!this.Swa,e.endEdit(C,"DataValidationListBox.SetCellContent",0));if(!C&&(e=$e.g(this.$),C=e.sc(null))){var M=null;this.bda&&-1!==this.bda.SheetId&&-1!==this.bda.Row&&-1!==this.bda.Column&&(M={},M.SheetName=this.bda.SheetId.toString(),M.FirstRow=this.bda.Row,M.FirstColumn=this.bda.Column,M={ParameterType:6,SourceRange:M});var ra=Object.assign(new Jh.a,{Text:this.pe});e.setCell(ra,C.range,0,63,M)}return!0};
$b.prototype.hra=function(e,C){var M=e?this.CAb:this.xH;e=e?this.Yhc:this.Zhc;if(0>=this.Swa)this.dg.style.height=ab.HelperMethods.Qb(e);else if(this.dg.style.height="auto",this.Swa>M){var ra=this.M9f?Math.floor(e*M):Math.floor(this.dg.offsetHeight*M/this.Swa);!this.M9f&&this.Dmi&&Fd.ULS.sendTraceTag(529056667,0,50,"DataValidationListBox.adjustHeightAndWidth:\n            old height: "+ra+",\n            new height: "+Math.floor(e*M)+",\n            maxItems: "+M+", listItemHeight: "+e+", listItemCount: "+
this.Swa);Le.DOMElementExtensions.HF(this.dg,ra);this.dg.style.overflowY="auto"}else this.dg.style.height="auto",this.dg.style.overflowY="hidden";Le.DOMElementExtensions.Gq(this.dg,C);Le.DOMElementExtensions.Gq(this.zn,C-(this.Swa>M?yc.a.Sp:0))};tl.Object.defineProperties($b.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this.rkb},set:function(e){this.GAa(this.rkb);if(e){this.rkb=e;this.T6a.innerText="";this.GAa(this.rkb);var C=this.DDb[e.rowIndex];this.pe=this.wV[C];this.tHa&&
(this.bda=this.tHa[C],Fd.ULS.shipAssertTag(537163286,0,!this.DDb.length||!!this.bda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.T6a.innerText=this.pe;this.Psc(e)}else this.bda=this.pe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return $e.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return $e.g(this.$).Kc.text}}});Object(td.a)($b,"DataValidationListBox",Xj.a,[]);var Fk=b(241),hk=b(117),oj=b(169),Gk=
bi.a;vm(db,Gk);db.prototype.aTc=function(e){this.get_events().addHandler("ClickButton",e)};db.prototype.DGd=function(e){this.get_events().removeHandler("ClickButton",e)};db.prototype.rTc=function(e){this.get_events().addHandler("KeyDown",e)};db.prototype.TGd=function(e){this.get_events().removeHandler("KeyDown",e)};db.prototype.VXb=function(e){this.get_events().addHandler("PointerOver",e)};db.prototype.fHd=function(e){this.get_events().removeHandler("PointerOver",e)};db.prototype.UXb=function(e){this.get_events().addHandler("PointerOut",
e)};db.prototype.eHd=function(e){this.get_events().removeHandler("PointerOut",e)};db.prototype.dmb=function(e){this.get_events().addHandler("Blur",e)};db.prototype.bGb=function(e){this.get_events().removeHandler("Blur",e)};db.prototype.j9=function(e){this.get_events().addHandler("Focus",e)};db.prototype.Kca=function(e){this.get_events().removeHandler("Focus",e)};db.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(Fj.a.AY),this.domElement.style.cursor="",Kg.a.instance.pa(Te.a.click,
this.domElement,this.Vc),hk.KeyInputManager.instance.pa(Te.a.Rb,this.domElement,this.onKeyDown),oj.a.instance.pa(Te.a.pointerOver,this.domElement,this.hw),oj.a.instance.pa(Te.a.pointerOut,this.domElement,this.kN),this.wc.Bt("blur")||this.wc.ja("blur",this.onBlur),this.wc.Bt("focus")||this.wc.ja("focus",this.onFocus),this.domElement.title=this.dgh,this.pl=!0)};db.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(Fj.a.AY),this.domElement.style.cursor="",this.isEnabled&&(Kg.a.instance.za(Te.a.click,
this.domElement,this.Vc),hk.KeyInputManager.instance.za(Te.a.Rb,this.domElement,this.onKeyDown),oj.a.instance.za(Te.a.pointerOver,this.domElement,this.hw),oj.a.instance.za(Te.a.pointerOut,this.domElement,this.kN)),this.domElement.title=this.Oah,this.pl=!1)};db.prototype.dispose=function(){this.isEnabled&&(Kg.a.instance.za(Te.a.click,this.domElement,this.Vc),hk.KeyInputManager.instance.za(Te.a.Rb,this.domElement,this.onKeyDown),oj.a.instance.za(Te.a.pointerOver,this.domElement,this.hw),oj.a.instance.za(Te.a.pointerOut,
this.domElement,this.kN),this.pl=!1);Le.DOMElementExtensions.setVisible(this.domElement,!1);Gk.prototype.dispose.call(this)};db.yb=function(e,C,M,ra,Na,Ib,Gc,id){e.removeAttribute("Href");e.setAttribute(Je.a.Sd,Je.a.zr);e.className=C;e.tabIndex=id;C=document.createElement("span");C.className=Gc;C.classList.add(M);C.tabIndex=-1;e.appendChild(C);e=document.createElement("img");e.src=rh.a.Be(ra);e.className=Na;e.alt=Ib;e.tabIndex=-1;C.appendChild(e);return e};tl.Object.defineProperties(db.prototype,
{Wj:{configurable:!0,enumerable:!0,get:function(){return this.EI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.pl}}});Object(td.a)(db,"ListButton",bi.a,[644,3]);var Gg=b(123),Hk=pc.a.vUg,Ik=bi.a;vm(Ca,Ik);Ca.prototype.dispose=function(){this.$&&(this.BKb(!1),this.gridView.ha.vN(this.Gh),this.gridView.Us(this.onContentReady),this.gridView.rc.p4i(this.htf),this.$.En(this.qd));this.GBe(!1);this.HBe(!1);jf.a.pc(this.Z3b);this.Z3b=this.Vga=this.dg=this.ZV=this.yI=this.gridView=
this.$=null;Ik.prototype.dispose.call(this)};Ca.prototype.y5c=function(e){return!!this.v2a(e)};Ca.prototype.Xpb=function(e,C){return ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new Hc(this.$,e,C):new uc(this.$,e,C)};Ca.prototype.v2a=function(e){e=this.gridView.getRangeInformation(e);for(var C=0;C<e.length;C++){var M=e[C];if(Object(eg.a)(Kj.DataValidationRange,M))return M}return null};Ca.prototype.ZCh=function(){if(!this.E3a)return"";var e=this.B4e?String.format("{0} {1}",
this.su.qGf,this.su.prompt):"",C=this.wvb?Ae.a.instance.ea(822):"";return String.format(Ae.a.instance.Cb(17),e,C)};Ca.prototype.ki=function(e){var C=!1;if(this.isListVisible||(-569786022===e||541421805===e)&&this.wvb||1872288872===e&&this.BQ)switch(e){case -569786022:case 541421805:this.show(this.BQ,!this.isListVisible,!0,Mf.a.Pr||3===pg.a.Wb);C=!0;break;case 1872288872:this.isListVisible?(this.show(this.BQ,!1,!0,!1),C=!0):this.BQ?(this.show(!1,!1,!0,!1),C=!0):this.qb&&(this.qb.endEdit(!1,"DataValidationControl.HandleKeyDown",
0),C=!0);break;case -798660877:this.Oh.MA(1);C=!0;break;case 137938150:this.Oh.MA(-1);C=!0;break;case 2091832999:this.Oh.MA(this.Oh.xH-1);C=!0;break;case 742457698:this.Oh.MA(-(this.Oh.xH-1));C=!0;break;case 125627505:case 267796030:C=this.CQa()}return C};Ca.prototype.show=function(e,C,M,ra){this.wx();if(this.Jyb&&this.E3a){var Na=this.BNa;if(Na){if(e||C||M)this.isVisible=!0;Wj.d(this.style,this.isGridRtl);M&&this.wvb&&(this.HBe(!0),this.o$f(Na,!1));C&&this.wvb&&this.qRa(ra,Na);e&&this.B4e&&this.Atj(Na);
this.Cgi||(this.isVisible=!1)}}};Ca.prototype.Kua=function(e,C){if(!C||!C.cell.tk)return null;var M=this.gridView.rc.textBox.domElement;var ra=0<Le.DOMElementExtensions.getHeight(M)&&0<Le.DOMElementExtensions.getWidth(M)&&0<=M.offsetTop&&0<=M.offsetLeft;if(ra)M=Le.DOMElementExtensions.Kua(M,e.Ui);else{M=e.getCellBounds(C.cell);var Na=Le.DOMElementExtensions.getBoundingClientRect(e.Ui);M=new Sys.UI.Bounds(M.x-Na.x,M.y-Na.y,M.width,M.height)}if(M)if(ra)2<M.height&&2<M.height&&(M.x+=1,M.y+=1,M.height-=
2,M.width-=2);else if(ra=$e.g(this.$).BJ(C.cell))ra=ra.width+1,Na=K.a.equals(Fk.a.u2a(C.cell,e.rtl),"right",!0),e.rtl&&Na&&(M.x=M.x+M.width-ra),C.oka&&e.rtl===Na&&(M.width=ra);else return null;return M};Ca.prototype.l_f=function(e){var C=this.E3a;this.BKb(C);C?this.show(!0,e,!0,!1):this.wx()};Ca.prototype.CQa=function(){var e=!1;this.isListVisible&&(e=this.Oh.CQa(this.qb),this.show(this.BQ,!1,!0,!1));return e};Ca.prototype.wx=function(){this.x$h?(this.isListVisible&&(this.isListVisible=!1),this.jLa&&
(this.jLa=!1),this.BQ&&(this.BQ=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.jLa=this.BQ=this.isVisible=!1;this.Pmd=this.Skd=this.Lnd=!1};Ca.prototype.qRa=function(e,C){this.wvb&&!this.su.tHa?this.jLa&&this.Eh.disable():(this.GBe(!0),this.Oh.Sda(this.su.tHa,e,this.NLh(C),this.qb),this.XAa(C,!1))};Ca.prototype.Atj=function(e){this.su.prompt&&(this.BQ=!0,this.TKj(this.su.qGf,this.su.prompt),this.H$f(e,!1))};Ca.prototype.o$f=function(e,C){var M=e.y;this.Vga.style.top=ab.HelperMethods.Qb(M);
e=this.isGridRtl?e.x-this.Vga.offsetWidth+1:e.x+e.width+1;this.Vga.style.left=ab.HelperMethods.Qb(e);C?this.jLa=this.gridView.Vgc(new sj.a(e,M))&&this.Skd:this.Skd=!0};Ca.prototype.XAa=function(e,C){var M=e.y+e.height;e=this.isGridRtl?e.x+e.width-this.dg.offsetWidth:e.x;this.dg.style.top=ab.HelperMethods.Qb(M);this.dg.style.left=ab.HelperMethods.Qb(e);C?this.isListVisible=this.gridView.Vgc(new sj.a(e,M))&&this.Pmd:this.Pmd=!0};Ca.prototype.H$f=function(e,C){var M=e.y+e.height+5,ra=this.activeCell;
ra=ra?ra.width/2:32;e=this.isGridRtl?e.x-this.ZV.offsetWidth+ra:e.x+e.width-ra;this.ZV.style.top=ab.HelperMethods.Qb(M);this.ZV.style.left=ab.HelperMethods.Qb(e);C?this.BQ=this.gridView.Vgc(new sj.a(e,M))&&this.Lnd:this.Lnd=!0};Ca.prototype.TKj=function(e,C){if(C){var M="";e&&(M+=String.format("<p class='dv-prompt-title'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",bh.a.If(e)));M+=String.format("<p class='dv-prompt-message'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",
bh.a.If(C));this.ZV.innerHTML=M;e=Le.DOMElementExtensions.vj(this.ZV,"dv-prompt-titletext");if(C=Le.DOMElementExtensions.vj(this.ZV,"dv-prompt-messagetext"))for(e=e?parseInt(String(Math.max(e.offsetWidth,C.offsetWidth))):C.offsetWidth,e+=6,Le.DOMElementExtensions.Gq(this.ZV,e),C=0,M=this.ZV.children.length;C<M;C++)Le.DOMElementExtensions.Gq(this.ZV.children[C],e)}};Ca.prototype.NLh=function(e){if(this.y$h)return e.width+17-2+1;var C=this.Vga.clientWidth;this.mci&&17!==C&&Fd.ULS.sendTraceTag(528855200,
0,15,"DataValidationControl.getListBoxWidth: buttonWidth is "+C);return e.width+C-2+1};Ca.prototype.HBe=function(e){this.$&&!this.Jyb||!e?(this.l3f(!1),jf.a.Fa(this.Eh),this.Eh=null):(this.Eh||(this.Eh=new db(this.Vga,"ewa-dv-listbutton",Fj.a.Iha,1,"ewa-dv-listbutton",Ae.a.instance.ea(873),Hk,Ae.a.instance.ea(872),"",-1),this.l3f(!0)),this.jLa=!0,this.su.tHa?this.Eh.isEnabled||this.Eh.enable():this.Eh.disable())};Ca.prototype.GBe=function(e){this.$&&!this.Jyb||!e?(this.QRa(!1),jf.a.Fa(this.Oh),this.Oh=
null):(this.Oh||(this.Oh=new $b(this.$,this.dg,this.T6a),this.QRa(!0)),this.isListVisible=!0)};Ca.prototype.QRa=function(e){this.Oh&&(e&&!this.KQ?(this.Oh.j9(this.Fxd),this.Oh.LXb(this.JKa),this.Oh.umb(this.Zxa),this.KQ=!0):!e&&this.KQ&&(this.Oh.Kca(this.Fxd),this.Oh.Lqc(this.JKa),this.Oh.rGb(this.Zxa),this.KQ=!1))};Ca.prototype.BKb=function(e){e&&!this.pQ?(this.gridView.view.it(this.Ns),this.pQ=!0):!e&&this.pQ&&(this.gridView.view.Wr(this.Ns),this.pQ=!1)};Ca.prototype.l3f=function(e){this.Eh&&(e&&
!this.u_b?(this.Eh.aTc(this.VNa),this.Eh.rTc(this.VNa),this.Eh.dmb(this.JKa),this.u_b=!0):!e&&this.u_b&&(this.Eh.DGd(this.VNa),this.Eh.TGd(this.VNa),this.Eh.bGb(this.JKa),this.u_b=!1))};Ca.prototype.w$f=function(){if(this.E3a){var e=this.BNa;e&&(this.o$f(e,!0),this.XAa(e,!0),this.H$f(e,!0))}};tl.Object.defineProperties(Ca.prototype,{Jyb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Fd&16)}},Cgi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.BQ||this.jLa}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.dg)},set:function(e){Le.DOMElementExtensions.setVisible(this.dg,e)}},BQ:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.ZV)},set:function(e){Le.DOMElementExtensions.setVisible(this.ZV,e)}},jLa:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.Vga)&&!!this.Eh&&Le.DOMElementExtensions.isVisible(this.Eh.domElement)},
set:function(e){Le.DOMElementExtensions.setVisible(this.Vga,e);this.Eh&&Le.DOMElementExtensions.setVisible(this.Eh.domElement,e)}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI},set:function(e){this.yI=e}},E3a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.y5c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.sc(null)}},B4e:{configurable:!0,enumerable:!0,get:function(){return this.E3a&&!!this.su&&!!(this.su.options&
2)&&!!this.su.prompt}},wvb:{configurable:!0,enumerable:!0,get:function(){return this.E3a&&!!this.su&&!!(this.su.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},su:{configurable:!0,enumerable:!0,get:function(){return this.v2a(this.activeCell.range)}},BNa:{configurable:!0,enumerable:!0,get:function(){var e=this.activeCell;return e?this.Kua(this.gridView,e):null}}});Object(td.a)(Ca,"DataValidationControl",bi.a,[593,3]);var yk=tb.a;vm(Wa,yk);Wa.prototype.create=
function(){this.Fb(this.$.da.Aa(14)||new Ca(this.$))};Object(td.a)(Wa,"DataValidationControlFactory",tb.a,[]);Za.F8c="!";Za.PBf="[";Za.OBf="]";Za.openParen="(";Za.closeParen=")";Za.Acg=" /.(*\\".split("");Za.X5b="...";Za.NDb="param_help_link";Za.yAd="param_help_udf";Za.Aad="function_list_box";Za.qzh="function_param_box";Za.Cad="function_reader_description";Za.vad="function_description_box";Za.CSe="function_param_table";Za.UOi="param_row_";Za.zAd="param_set";Za.vCf="param_row_0";Za.wCf="param_row_1";
Za.rzh="<div id='{0}' class='{1}'></div>";Za.pzh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";Za.xCf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";Za.mzh="<div id='{0}' class='{1} {2} {3}'></div>";Za.jzh="<div id='{0}' class='{1} {2} {3} {4}'></div>";Za.ehf="[@";Za.b_g=1;Za.a_g=3;Za.d9g=500;Za.$lf=50;Object(td.a)(Za,
"FormulaAssistanceConstants",null,[]);var bk=b(68),Sg=b(219);Object(td.a)(ec,"FormulaAuthoringUsageDetails",null,[]);Object(td.a)(Yb,"FormulaSuggestionsUsageDetails",null,[]);Object(td.a)($a,"AutocompleteCardInteractionUsageDetails",null,[]);Object(td.a)(jb,"AutocompleteRenderOptimizationDetails",null,[]);Object(td.a)(Ua,"SessionDetails",null,[]);Object(td.a)(Ga,"PerfMetrics",null,[]);Object(td.a)(Ha,"AggregatedPerfMetrics",null,[]);bb.prototype.IRa=function(){this.rjc=Wg.a.Ra.se.m};bb.prototype.aia=
function(e){-1!==this.rjc&&(e?(this.Xlb(Wg.a.Ra.se.m-this.rjc),this.rjc=-1):this.r_.failedCount++)};bb.prototype.Ouh=function(){this.r_.excludingFirstAction=bb.iQe(this.M5b);Array.add(this.M5b,this.r_.firstAction);this.r_.includingFirstAction=bb.iQe(this.M5b)};bb.prototype.Xlb=function(e){var C=this;this.r_.count?1E3>this.r_.count&&Array.add(this.M5b,e):this.r_.firstAction=e;this.Fmf&&this.Gmf&&this.Gmf.forEach(function(M){e>M&&C.r_.countAboveThresholds[M]++});this.r_.count++};bb.iQe=function(e){var C=
new Ha;0<e.length&&(Ad.i(e),C.median=e[Math.floor(.5*e.length)],C.P75=e[Math.floor(.75*e.length)],C.P95=e[Math.floor(.95*e.length)],C.max=e[e.length-1],C.average=Ad.g(e,function(M){return M})/e.length);return C};Object(td.a)(bb,"PerformanceMeasurement",null,[]);var zk=b(38),Nj=b(101),cj={},ck=(cj.argumentAssistanceOverall=[50,80,100,130,150,170,200],cj);ka.prototype.Y6=function(e){var C=this;e.forEach(function(M){C.x9a.wb(M)||C.x9a.ia(M,new bb(ck[M]));C.x9a.na(M).IRa()})};ka.prototype.RY=function(e,
C){var M=this;C=void 0===C?!0:C;e.forEach(function(ra){M.x9a.wb(ra)&&M.x9a.na(ra).aia(C)})};ka.prototype.nUf=function(e){var C="Undefined";switch(e){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.Fia.argumentAssistanceCardInitialMode=C};ka.prototype.i6b=function(e){var C=this;window.requestAnimationFrame(function(){C.RY([e])})};ka.prototype.getJsonForLogging=function(){return"{"+this.S2("SessionDetails",this.Ftc)+","+this.S2("FormulaAuthoringUsage",this.Fia)+","+this.S2("FormulaSuggestionsUsage",
this.T8b)+","+this.S2("AutocompleteCardInteraction",this.p2)+","+this.S2("AutocompleteRenderOptimization",this.Anb)+","+this.cRh()+"}"};ka.prototype.plj=function(){this.Ftc.argumentAssistanceFlight=this.Ccd("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Ftc.autoCompleteUIFlight=this.Ccd("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Ftc.smartFormulaBarAutoCompleteFlight=this.Ccd("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled")};ka.prototype.cRh=function(){for(var e=
new mc.a,C=yl(this.x9a),M=C.next();!M.done;M=C.next())M=M.value,M.value.Ouh(),e.add(String.format('"{0}":{1}',M.key,$g.a.Hc(M.value.r_)));return String.format('"PerfMeasurements": {{{0}}}',e.toArray().join(","))};ka.prototype.Ccd=function(e,C){return K.a.contains(this.vb.ya.FlightHolder.FlightId,C,!0)?ld.EwaSettings.getBooleanFeatureGate(e+C,!1)?"T":"C":"None"};ka.prototype.S2=function(e,C){return String.format('"{0}":{1}',e.toString(),zk.c(C))};tl.Object.defineProperties(ka.prototype,{$:{configurable:!0,
enumerable:!0,get:function(){return this.vb},set:function(e){this.vb||(this.vb=e,this.vb.Vl(this.qd))}}});tl.Object.defineProperties(ka,{instance:{configurable:!0,enumerable:!0,get:function(){ka.Na||(ka.Na=new ka);return ka.Na}}});ka.Na=null;Object(td.a)(ka,"FormulaAssistanceTelemetryManager",null,[]);var V=b(351),ua=Bi.a;vm(vb,ua);vb.prototype.initialize=function(){this.Ob.classList.add(bk.a.Cjh);this.Ob.innerHTML=vb.tG();this.Le||(this.Vk(),this.e2());ua.prototype.initialize.call(this);var e=Le.DOMElementExtensions.vj(this.Ob,
"ewa-dlg-function-link-container");this.rtl&&(e.align="right",this.ftb.style.marginLeft="5px");this.Le&&(e.style.padding="1px");this.functionInfoManager.Krb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};vb.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Jqc(this.onFunctionInfoLoaded),this.functionInfoManager.$.fa.kk(this.Zc));jf.a.pc([this.f0b,this.u5,this.Ovb,this.eJa,this.gtb]);ua.prototype.dispose.call(this)};vb.prototype.Vk=function(){this.fJa=Le.DOMElementExtensions.vj(this.Ob,
"ewa-dlg-function-category-select");this.Iia=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-select");this.fJa.setAttribute(Je.a.Sd,Je.a.EFa);this.eJa=new Ti.a(this.fJa,!0);this.gtb=new Ti.a(this.Iia,!0);this.ASe=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-loading");this.ftb=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-help-link");this.ESe=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-udf-name");this.hif=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-icon");this.BSe=$get(vb.wad,this.Ob);
this.Hia=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-help-string");this.Le&&(this.Hia.style.paddingLeft="1px");this.functionInfoManager.mmb(this.onFunctionInfoLoaded);this.functionInfoManager.$.fa.Sj(this.Zc)};vb.prototype.qQ=function(e){var C=this;this.$.da.Za(40,function(){C.eJa.qQ(e)})};vb.prototype.lm=function(){this.formulaAssistanceControl.set_visible(!1);ua.prototype.lm.call(this);this.nhd||(this.getButton(0).get_element().disabled=!0)};vb.prototype.setFocus=function(){!this.fJa.disabled&&
this.nhd&&Le.DOMElementExtensions.setFocus(this.fJa)};vb.prototype.commit=function(){return!0};vb.prototype.qpb=function(){var e=this,C=this.n$.NameDataStrings;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var M=new Rg.a(-433697611,0,this.$.ed,8,null),ra={};ra=(ra[pg.a.hd]=C,ra);this.$.Ka.Zb(M,ra)}else{C+=Za.openParen;M=$e.g(this.$);M.view.visibleArea.contains(M.Lg(null))||M.yt(M.ha.va.activeCell,3,Bj.a.kzh);var Na=this.cIa.textBox;if(this.cIa.isEditing&&this.cIa.text){ra=
this.cIa.text;var Ib=this.BYc?ra.substring(0,this.BYc):"=";this.cIa.text=Ib+C+ra.substring(this.BYc+(Na.Zu?Na.Zu.length:0),ra.length);Na.caretPosition=Ib.length+C.length}else xf.TaskExtensions.Ba(M.startEdit(!0,1),function(){e.cIa.text="="+C;var Gc=C.length+1;Na.BQa(Gc);Na.caretPosition=Gc},this.ma,11,Se.a.current);M.xj&&(M=M.Kc,M.text=Na.text,M.setCaretPosition(Na.caretPosition));(M=this.cIa.eP.get(lk.a.iua))&&M.NT(!1)}};vb.prototype.dGa=function(){this.formulaAssistanceControl.jnb()};vb.prototype.kua=
function(e){this.gtb.clear();for(var C=vb.wad+" "+vb.wSe,M=0,ra=e.length;M<ra;++M){var Na=this.gtb.AL(e[M].NameUI,e[M].FunctionIndex.toString(),!1);Mf.a.Ku&&Na.classList.add("ewa-dlg-select-option-explorer-edge");Na.setAttribute(Je.a.JD,vb.xSe);Na.setAttribute(Je.a.HL,C)}this.gtb.selectedIndex=0};vb.prototype.VUf=function(){if(this.n$){this.ftb.parentNode.className=bk.a.Ijh+(this.functionInfoManager.mmd(this.n$)?"-udf":"");var e=this.n$.NameDataStrings;this.ESe.innerText=e;this.ftb.innerText=e;this.Hia.innerText=
this.n$.Help;e=this.n$.Params.split(Za.F8c);this.BSe.innerText=Za.openParen+(1<e.length?Za.X5b:e[0])+Za.closeParen}};vb.tG=function(){return String.format("<div class='"+bk.a.Djh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Ag.a.xu+"'>{1}</div>\r\n<div class='"+bk.a.nKe+"'>\r\n\t<select id='{16}' class='{17} "+pc.a.yu+" "+pc.a.Ir+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+bk.a.Gjh+
"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+pc.a.yu+"'>\r\n\t\t\t<span class='"+pc.a.OB+" "+bk.a.Hjh+"'>\r\n\t\t\t\t<img title='{3}' class='"+pc.a.Boh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",Ae.a.instance.ea(1002),Ae.a.instance.ea(1003),Ae.a.instance.ea(720),Ae.a.instance.Cb(3),
rh.a.Be(13),Ae.a.instance.ea(1004),vb.izh,vb.wad,7,"ewa-dlg-function-category-select","ewa-dlg-function-help-link","ewa-dlg-function-loading","ewa-dlg-function-help-string","ewa-dlg-udf-name","ewa-dlg-function-icon","ewa-dlg-function-link-container",vb.nzh,"ewa-dlg-select"+(Mf.a.Ku?" ewa-dlg-select-explorer-edge":""),vb.wSe,vb.xSe)};tl.Object.defineProperties(vb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},n$:{configurable:!0,enumerable:!0,get:function(){if(!this.Iia||
!this.Iia.firstChild)return null;var e=Number.parseInvariant(this.Iia.children[this.Iia.selectedIndex].value);return this.functionInfoManager.JJh(e)}}});vb.wad="function_dialog_param_string";vb.wSe="function_dialog_function_description";vb.xSe="function_dialog_function_name";vb.nzh="function_list";vb.izh="function_category";Object(td.a)(vb,"FunctionDialog",Bi.a,[]);rc.prototype.Xc=function(e,C){if(!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(C){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return e=
$e.g(this.$).Jj,(C=e.eP.get(lk.a.iua))&&(C.swb||!e.isEditing||0>=e.text.length)?!1:!0;default:return!1}};rc.prototype.executeCommand=function(e,C,M){C=C.command;e=$e.g(this.$);switch(C){case 753860909:case -2060563418:ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(M=e.Jj,e.inRangePicker&&M.MD(!1),this.create(M)):e.sc(null)&&(M=e.Jj,(C=M.eP.get(lk.a.iua))&&(C.swb||!M.isEditing||0>=M.text.length)&&(e.inRangePicker&&M.MD(!1),this.create(M)));break;case -433697611:var ra=
M[pg.a.hd]+Za.openParen;M.UILocation&&this.$.Ce(-1075437823,-1,0,null);e.view.visibleArea.contains(e.Lg(null))||e.yt(e.ha.va.activeCell,3,Bj.a.lyh);var Na=e.Jj,Ib=Na.textBox;M=Na.textBox.caretPosition;if(Na.isEditing&&Na.text){C=Na.text;var Gc=M?C.substring(0,M):"=";Na.text=Gc+ra+C.substring(M+(Ib.Zu?Ib.Zu.length:0),C.length);Ib.caretPosition=Gc.length+ra.length}else xf.TaskExtensions.Ba(e.startEdit(!0,1),function(){Na.text="="+ra;var id=ra.length+1;Ib.BQa(id);Ib.caretPosition=id},this.$.ma,11,Se.a.current);
e.xj&&(e=e.Kc,e.text=Ib.text,e.setCaretPosition(Ib.caretPosition));(e=Na.eP.get(lk.a.iua))&&e.NT(!1)}return wg.Task.Ta(!0)};rc.prototype.Gc=function(e,C){switch(C.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};rc.prototype.gAh=function(e,C){C=this.Sa.zp(C);var M=this.Sa.Lc(),ra=this.functionInfoManager.RWe(e);if(!ra)return Fd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),C.JB();for(var Na=0;Na<ra.length;++Na){var Ib=
ra[Na].NameUI,Gc=this.Sa.AP(280,"Formulas."+e+"MenuItem_"+ra[Na].FunctionIndex.toString(),-433697611,null,1,"None",0,0,Ib,!1,0);Gc.label=Ib;var id=ra[Na].Params.split(Za.F8c);Gc.CR(Ib+" "+(Za.openParen+(1<id.length?Za.X5b:id[0])+Za.closeParen)+"\n"+ra[Na].Help);Array.add(M.buttons,Gc)}e=this.Sa.Lc();ra=this.Sa.AP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,pc.a.xNe,3,"Image16by16",1001,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(e.buttons,ra);Array.add(C.yc,M);Array.add(C.yc,e);return C.JB()};
rc.prototype.fd=function(e,C,M){e=this.IJh(C);if(-1===e)return!1;this.menuId=M.MenuId;if(!this.functionInfoManager.H4)return this.functionInfoManager.Krb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;e=this.functionInfoManager.vSe[e];this.LL[e]=this.LL[e]||this.gAh(e,M.MenuId);M.MenuItems=this.LL[e];return!0};rc.prototype.create=function(e){(new vb(this.$,e)).nf()};rc.prototype.IJh=function(e){switch(e){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(td.a)(rc,"FormulaAssistanceCommandHandler",null,[147]);var ib=af.a;vm(pb,ib);pb.prototype.Md=function(){var e=this,C=ud.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.tb),M=ud.GetServiceTaskFactory.create(this.$.da,153,this.ma,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([C,M],this.ma),function(){e.Ed([new rc(e.$,C.result,M.result)])},this.ma,3)};pb.ja=function(e){af.a.de(92,new pb(e))};Object(td.a)(pb,"FormulaAssistanceCommandHandlerFactory",af.a,[]);fb.prototype.dispose=function(){this.OUd();this.gJa=this.dua=this.Eia=null};fb.prototype.CVc=function(e){e&&(this.Eia=e,this.Eia.Qke(this.Pxf),this.Eia.Gle(this.Rxf),this.G4a&&this.Eia.Fle(this.Qxf))};
fb.prototype.DVc=function(e){e&&(this.dua=e,this.ALa&&(this.dua.Oke(this.cuf),this.dua.Mke(this.Wtf)),this.zLa&&this.dua.Nke(this.Ztf))};fb.prototype.Rpe=function(e){e&&(this.gJa=e,this.gJa.Hle(this.Sxf),this.gJa.tTc(this.Lxf))};fb.prototype.OUd=function(){var e,C,M;this.Eia&&(this.Eia.uMf(this.Pxf),this.Eia.TMf(this.Rxf),this.G4a&&this.Eia.SMf(this.Qxf));this.gJa&&(this.gJa.UMf(this.Sxf),this.gJa.UGd(this.Lxf));this.ALa&&(null===(e=this.dua)||void 0===e?void 0:e.tMf(this.cuf),null===(C=this.dua)||
void 0===C?void 0:C.rMf(this.Wtf));this.zLa&&(null===(M=this.dua)||void 0===M?void 0:M.sMf(this.Ztf))};fb.prototype.YYi=function(e,C){if(C){var M="";this.G4a||(M+=Ae.a.instance.Cb(56)+this.ariaLiveNotifier.Zwa);for(var ra=0;ra<C.length;ra++)M+=e+this.ariaLiveNotifier.Zwa+this.dXc(C[ra])+fb.DBd(ra,C.length);this.G4a&&(M+=Ae.a.instance.ea(861)+this.ariaLiveNotifier.Zwa);this.ariaLiveNotifier.readText(M)}};fb.prototype.XYi=function(e,C,M){if(e){var ra="",Na=0;if(C){for(var Ib=0;Ib<C.length;Ib++)if(M>=
e[Ib].split(this.$.listSeparator).length)Na++;else{var Gc=C[Ib].trim();if(!Gc)return;Gc=this.dXc(Gc);var id=fb.DBd(Ib-Na,C.length-Na);ra+=Gc+id;id&&(ra+=this.ariaLiveNotifier.Zwa)}this.ariaLiveNotifier.readText(ra)}}};fb.prototype.dXc=function(e){if(!e)return"";var C=e.split(this.$.listSeparator);e="";C=yl(C);for(var M=C.next();!M.done;M=C.next()){var ra=M.value;fb.Lld(ra)?e+=ra:(ra=(M=fb.adi(ra))?ra.replace("[","").replace("]",""):ra,e+=String.format(M?Ae.a.instance.Cb(58):Ae.a.instance.Cb(57),ra));
e+=this.ariaLiveNotifier.Zwa}return e};fb.DBd=function(e,C){if(e>=C||1===C)return Fd.ULS.shipAssertTag(537161997,0,e<C,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};fb.Lld=function(e){return K.a.contains(e,Za.X5b,!0)};fb.adi=function(e){return e.trimStart().startsWith(Za.PBf)||e.trimEnd().endsWith(Za.OBf)};Object(td.a)(fb,"FormulaAssistanceReadoutHandler",null,[592,3]);var bc=tb.a;vm(Ta,bc);Ta.prototype.create=function(){var e=this,C=this.$.da;xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(C,
211,212,this.tb),function(M){M=C.Aa(219)||new fb(M.result,e.$);e.Fb(M)},this.ma,3)};Ta.ja=function(e){e.da.Ha(220,new Ta(e))};Object(td.a)(Ta,"FormulaAssistanceReadoutHandlerFactory",tb.a,[]);var Kc=b(687),cd=b(110),zc=b(1132);eb.prototype.gfd=function(e){return this.RPa&&e in this.RPa?this.RPa[e]:null};eb.prototype.I2f=function(e,C){this.RPa||(this.RPa={});this.RPa[e]=C};eb.prototype.tZ=function(){this.RPa=null};Object(td.a)(eb,"FormulaAssistanceContextualPreviewCache",null,[]);Tc.prototype.dispose=
function(){this.Ld||(this.$&&(this.$.fa.TC(this.Nx),this.$=null),this.$ga=this.aEb=null,this.Ld=!0)};Tc.prototype.Rbd=function(e,C,M,ra){var Na=this;if(C&&0>=C.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!e)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var Ib="="+C.substring(M.start,M.end);ld.EwaSettings.la(622)&&(Ib=this.calcManager.oSh($e.g(this.$).ha.va.activeCell,e,M));var Gc=this.RFh(Ib,M);if(ld.EwaSettings.la(622)){if(Gc&&!this.calcManager.isFormulaSubExpressionVolatile(e))return Promise.resolve(Gc)}else if(Gc)return Promise.resolve(Gc);return this.TFh(Ib,M).then(function(id){if(Na.kZc(ra))throw Error.create("OperationCanceledException");if(!id||id.U$i||id.nma.startsWith("##UNSUPPORTED:"))return Na.mVe(C,Ib,M,ra);Na.$ga.I2f(Ib,id.nma);return Promise.resolve(id)})};
Tc.prototype.RFh=function(e,C){return(e=this.$ga.gfd(e))?new zc.a(e,C.start,C.end,0):null};Tc.prototype.TFh=function(e,C){if(!e||0>=e.length||!C)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.QOg($e.g(this.$).ha.va.activeCell,e,this.nri,C)};Tc.prototype.mVe=function(e,C,M,ra){var Na=this;if(!e||0>=e.length||!C||0>=C.length||!M)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.iOa)return this.SFh(e,C,M,ra);var Ib={};Ib.PartialFormula=C;Ib.Formula=e;Ib.SourceRange=sg.v($e.g(this.$).ha.va.activeCell,this.$);return this.iOa=new Promise(function(Gc,id){Na.aEb=new Kc.a;Na.WOf=Na.$.fa.rf;Na.w9a=rb(Na.$.qa.ta,Ib,function(Uc){Na.JMi(C,M,ra,Uc,Gc,id)},function(Uc){Na.iOa=null;Na.w9a=null;id(Uc)},null,null,null);Na.aEb.token.R(function(){Na.tQg(id)})})};Tc.prototype.JMi=function(e,C,M,ra,Na,Ib){this.w9a=this.iOa=null;if(this.WOf!==this.$.fa.rf)Ib(Error.create("OperationCanceledException"));
else if(ra.Result)if(ra=$g.a.li(ra.Result),!ra||cd.a.isEmpty(ra))Na(null);else{for(var Gc in ra)this.$ga.I2f(Gc,ra[Gc]);this.kZc(M)?Ib(Error.create("OperationCanceledException")):(e=this.$ga.gfd(e))?(""===e&&(e=" "),Na(new zc.a(e,C.start,C.end,0))):Ib(Error.create("SubexpressionNotFoundException"))}else Na(null)};Tc.prototype.SFh=function(e,C,M,ra){var Na=this;return new Promise(function(Ib,Gc){Na.iOa.then(function(){Na.GPf(e,C,M,ra,Ib,Gc)}).catch(function(){Na.GPf(e,C,M,ra,Ib,Gc)})})};Tc.prototype.GPf=
function(e,C,M,ra,Na,Ib){if(this.kZc(ra))Ib(Error.create("OperationCanceledException"));else{var Gc=this.$ga.gfd(C);Gc?Na(new zc.a(Gc,M.start,M.end,0)):this.mVe(e,C,M,ra).then(function(id){Na(id)}).catch(function(id){Ib(id)})}};Tc.prototype.tQg=function(e){this.w9a&&(Li.a.Zt(this.w9a.kt)?(this.iOa=this.w9a=null,e(Error.create("PendingWebReqeuestCancelled"))):Fd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Tc.prototype.tZ=function(){this.uQg();this.$ga&&this.$ga.tZ()};
Tc.prototype.uQg=function(){this.aEb&&this.aEb.C()};Tc.prototype.kZc=function(e){return this.Ld||e.TJ};Object(td.a)(Tc,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var Mc=b(139),md=b(209);vd.nkh="ewa-facp-text-box";Object(td.a)(vd,"CssClassNames",null,[]);Pc.prototype.dispose=function(){(this.g$||this.zP)&&this.r5e();this.qb=this.Lpa=null};Pc.prototype.OIj=function(e,C,M,ra){e&&C&&ra&&C.nma&&!(1>C.nma.length)&&(this.qb=e,this.yLf(),this.Z0a=C,this.SRa=ra,this.Jrj(C,M,ra))};Pc.prototype.r5e=
function(){this.M_h();this.yLf();this.SRa=this.Z0a=null};Pc.prototype.Jrj=function(e,C,M){var ra=this;if(e.nma&&!(1>e.nma.length)){var Na=this.Nc.da.Aa(266);if(Na){var Ib=Na.OLh();Ib&&xf.TaskExtensions.Ba(this.Yzb,function(){if(C)if(ld.EwaSettings.la(622)&&ra.qb.isEditing&&0<M.length){ra.Zvb(e.cJa,M[0].start,null);var Gc=ra.g0e(M[0],Ib),id=ra.qb.text.substring(M[0].start,M[0].end).trim();id=ra.qb.text.indexOf(id);id=ra.qb.text.substring(0,id).lastIndexOf("\n");ra.Zvb(0>id||1>=M.length?M[0].start:
id+1,M[0].end,Gc?String.format(Gc,.3):null);for(var Uc=1;Uc<M.length;Uc++)Gc=ra.g0e(M[Uc],Ib),id=ra.qb.text.substring(M[Uc].start,M[Uc].end).trim(),id=ra.qb.text.indexOf(id),id=ra.qb.text.substring(M[Uc-1].end,id).lastIndexOf("\n"),ra.Zvb(0>id?M[Uc-1].end:id+1+M[Uc-1].end,M[Uc].end,Gc?String.format(Gc,.3):null);id=ra.qb.text.substring(M[M.length-1].end,e.fua).indexOf("\n");ra.Zvb(0>id?M[M.length-1].end:id+1+M[M.length-1].end,e.fua,null);Fd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else ra.Zvb(e.cJa,
e.fua,null),Fd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");ra.g$||(ra.g$=document.createElement(md.a.div),ra.qb.textBox.domElement.appendChild(ra.g$));ra.zP||(ra.zP=document.createElement(md.a.div),ra.zP.className=vd.nkh,ra.Nc.domElement.appendChild(ra.zP));Gc=e.fua;ld.EwaSettings.la(622)&&ra.qb.isEditing&&M&&0<M.length&&M[0].start<Gc&&M[0].start!==e.cJa&&!ra.qb.textBox.Zu.length&&
(Gc=M[0].start);Uc=K.a.contains(ra.qb.textBox.pf.id,"FormulaBar",!0)&&K.a.contains(ra.qb.text.substring(e.cJa,e.fua),"\n",!0);id=ra.qb.isEditing?ra.qb.textBox.caretPosition:0;Gc=excelOnline.utils.getBoundingRectForText(ra.qb.textBox.pf,Uc?id:e.cJa,Uc?id:Gc,ld.EwaSettings.la(622));ra.zP.style.left=ab.HelperMethods.Qb(Gc.left);ra.zP.style.top=ab.HelperMethods.Qb(Gc.top);ra.zP.style.width=ab.HelperMethods.Qb(Gc.width);ra.zP.style.height=ab.HelperMethods.Qb(Gc.height);Gc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
e.fua,e.fua);dialogControls.renderToolTip(ra.g$,Gc,e.nma,ra.zP,0,!1,!1,1)},this.Nc.ma,3)}}};Pc.prototype.g0e=function(e,C){var M=this.qb.text,ra=M.substring(e.start,e.end);ra=ra.trim();e=M.indexOf(ra,e.start);C=M.indexOf(C,e);ra=M.substring(e,C);ra=ra.trim();return this.qb.colors.getItem(e+"-"+(e+ra.length))};Pc.prototype.M_h=function(){var e=this;this.qb&&this.g$&&this.zP&&xf.TaskExtensions.Ba(this.Yzb,function(){e.qb.textBox.domElement.contains(e.g$)&&(dialogControls.clearToolTip(e.g$),e.qb.textBox.domElement.removeChild(e.g$),
e.g$=null);e.Nc.domElement.contains(e.zP)&&(e.Nc.domElement.removeChild(e.zP),e.zP=null)},this.Nc.ma,3)};Pc.prototype.Zvb=function(e,C,M){if(this.qb&&!(e>=C)){var ra={};this.qb.textBox.formatText(e,C-e,(ra.background=M||"#E3DDCC",ra));this.dhd=!0}};Pc.prototype.yLf=function(){if(this.qb&&this.Z0a&&this.dhd){var e=this.Z0a.fua;ld.EwaSettings.la(622)&&0<this.SRa.length&&this.SRa[this.SRa.length-1].end>e&&(e=this.SRa[this.SRa.length-1].end);var C={};this.qb.textBox.formatText(this.Z0a.cJa,e-this.Z0a.cJa,
(C.background=!1,C));this.dhd=!1}};tl.Object.defineProperties(Pc.prototype,{Yzb:{configurable:!0,enumerable:!0,get:function(){var e=this;if(this.Lpa)return this.Lpa;var C=new Mc.a;this.Nc.rE(function(M){xf.TaskExtensions.Ba(M.yrd(),function(){C.setResult(!0)},e.Nc.ma,3)});return this.Lpa=C.task}}});Object(td.a)(Pc,"FormulaAssistanceContextualPreviewControl",null,[3]);var Nd=b(44),Ud=b(42);Zc.prototype.i_f=function(e,C,M){M?this.Y0g(e,C,M):this.w2e(e,C,M,!0)};Zc.prototype.B9i=function(){this.j7=0};
Zc.prototype.Y0g=function(e,C,M){var ra=this;this.j7++;var Na=this.j7;Nd.a.instance.create(function(){ra.w2e(e,C,M,Na===ra.j7)},500,Ud.a.myh,!0,!0)};Zc.prototype.w2e=function(e,C,M,ra){var Na=this,Ib=this.cad.Rbd(e,C);Ib&&Ib.then(function(Gc){ra&&Na.cad.wmd(C)&&Na.cad.NIj(e,Gc,M)}).catch(function(Gc){Gc=Object(qc.a)(Error,Gc);"OperationCanceledException"===Gc.message?Fd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Gc):Fd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Gc)})};Object(td.a)(Zc,"FormulaAssistanceContextualPreviewHoverManager",null,[]);Ic.prototype.dispose=function(){this.jYc();jf.a.pc([this.Ysb,this.O8b]);this.P8b=this.O8b=this.Ysb=null;this.$&&$e.g(this.$).Kc.Rp(this.l8a);this.Yga=this.qb=this.$=null};Ic.prototype.Krj=function(e,C){C&&ah.e(C.text)&&!(C.Wva||C.textBox.Zu||this.qb&&this.qb.textBox.Zu)&&(this.qb=C,this.calcManager=this.$.da.Aa(266))&&(Fd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),e=ab.HelperMethods.Ftb(e),e=this.calcManager.lSh($e.g(this.$).ha.va.activeCell,this.qb.text,e.x,e.y),C=this.calcManager.getSubExpressionSpan(e),!C||C.end<=C.start||this.wmd(C)||(this.Yga=C,this.P8b.i_f(e,C,!0)))};Ic.prototype.dPd=function(e){if(e&&ah.e(e.text))if(e.textBox.Zu&&e.textBox.Zu.trim()){if(this.qb=e,this.calcManager=this.$.da.Aa(266)){Fd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");e={};var C=this.qb.textBox.Zu.trim();e.start=this.qb.text.indexOf(C,this.qb.textBox.caretPosition);e.end=e.start+C.length;(C=this.calcManager.getFormulaSubExpressionObject($e.g(this.$).ha.va.activeCell,this.qb.text,this.qb.textBox.Zu))&&!this.wmd(e)&&(this.Yga=e,this.P8b.i_f(C,e,!1))}}else this.W3a(!1,!0)};Ic.prototype.W3a=function(e,C){!this.qb||C&&this.qb.textBox.Zu||
(this.Yga=null,e&&(this.jYc(),this.O8b.tZ(),this.P8b.B9i()),this.Ysb&&this.Ysb.r5e(),this.qb.Wva||(this.qb.Wva=!1,this.qb=null))};Ic.prototype.Rbd=function(e,C){if(!this.qb||this.qb.Wva)return null;this.jYc();this.pqb=new Kc.a;return this.O8b.Rbd(e,this.qb.text,C,this.pqb.token)};Ic.prototype.NIj=function(e,C,M){this.pqb=null;!e||!C||!C.nma||0>=C.nma.length?this.W3a(!1,!1):(e=this.calcManager.mSh($e.g(this.$).ha.va.activeCell,e,this.qb.text),this.Ysb.OIj(this.qb,C,M,e))};Ic.prototype.wmd=function(e){return this.Yga?
e.start===this.Yga.start&&e.end===this.Yga.end&&e.pre===this.Yga.pre&&e.post===this.Yga.post:!1};Ic.prototype.jYc=function(){this.pqb&&this.pqb.C()};Object(td.a)(Ic,"FormulaAssistanceContextualPreviewManager",null,[650,3,651]);var Oe=b(1189),of=b(929),Nf=b(245),Kf=b(153);Eb.prototype.CVf=function(e){this.wS=0;this.h6d=e.IsCompatibility;this.set_name(e.NameDataStrings);this.SUa=e.Help};Eb.prototype.rij=function(e){this.wS=1;this.set_name(e.Name)};Eb.prototype.Shj=function(e){this.wS=2;this.set_name(e.name);
this.SUa=e.tooltip};Eb.prototype.rjj=function(e){this.wS=3;this.set_name(e.name);this.SUa=e.toolTip};Eb.prototype.$Wf=function(e){this.wS=4;this.set_name(e.name)};Eb.prototype.Llj=function(e){this.wS=5;this.set_name(e.name);this.SUa=e.toolTip};Eb.prototype.Klj=function(e){this.wS=7;this.set_name(e.name)};Eb.prototype.gkj=function(){this.wS=6;this.set_name(Ae.a.instance.Cb(182));this.SUa=Ae.a.instance.Cb(183)};Eb.prototype.set_name=function(e){return this.D7d=e};Eb.r5g=function(){return Object.assign(new Eb,
{k7d:!0})};tl.Object.defineProperties(Eb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.wS}},$9h:{configurable:!0,enumerable:!0,get:function(){return this.h6d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.D7d}},Hia:{configurable:!0,enumerable:!0,get:function(){return this.SUa}},Byb:{configurable:!0,enumerable:!0,get:function(){return this.k7d}}});Object(td.a)(Eb,"AutoCompleteItem",
null,[643]);Object(td.a)(Mb,"DefinedNameInfo",null,[]);wb.prototype.tFj=function(e){var C=this.eEe[e.toUpperCase()];if(!C)return{returnValue:!1,sheetName:"",range:null};e=C.sheetName;C=this.XYg(C.namedRange);return{returnValue:!0,sheetName:e,range:C}};wb.prototype.nZg=function(e){if(null!=e&&void 0!=e)return{top:e.top,left:e.left,bottom:e.bottom,right:e.right,maxRows:e.maxRows,maxColumns:e.maxColumns,sheetName:void 0}};wb.prototype.XYg=function(e){if(null!=e&&void 0!=e)return new Hj.a(e.top,e.left,
e.bottom,e.right,e.maxRows,e.maxColumns)};wb.prototype.gZg=function(e){switch(e){case 2:return 0;case 3:return 1;default:return-1}};tl.Object.defineProperties(wb.prototype,{dEe:{configurable:!0,enumerable:!0,get:function(){var e=[];if(!this.$.xb||!this.$.xb.items)return e;for(var C=0,M=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&cg.a.gV(this.$),ra=yl(this.$.xb.items),Na=ra.next();!Na.done;Na=ra.next())if((Na=Na.value)&&(3===Na.type&&Na.usedRange||
M&&2===Na.type)){var Ib=new Mb;Ib.tooltip=Na.sheetName+Ed.a.exclamation+Na.usedRange.toString();Ib.name=Na.name;Ib.namedRange=this.nZg(Na.usedRange);Ib.sheetName=Na.sheetName;Ib.type=this.gZg(Na.type);Array.add(e,Ib);this.eEe[Na.name.toUpperCase()]=Ib;++C;if(C===Za.$lf){Fd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",Za.$lf);break}}return e}}});Object(td.a)(wb,"DefinedNameInfoManager",null,[]);var ug=b(135),qh=Sys.EventArgs;vm(Ja,qh);Object(td.a)(Ja,
"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Eh=Sys.EventArgs;vm(Lb,Eh);Object(td.a)(Lb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Yh=Sys.EventArgs;vm(Ra,Yh);Object(td.a)(Ra,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Fi=b(256);Sa.prototype.Qe=function(e,C){e=!1;C||($e.g(this.$).Jj.textBox.QJ=!0,e=this.formulaAssistanceUIControl.focus(this.gSe));return e};Sa.prototype.Ah=function(e){var C=this.Jb;return!(void 0===C||
null===C)&&Le.DOMElementExtensions.Ye(C,e)};Sa.prototype.ji=function(){this.R2e&&this.R2e()};Sa.prototype.Vh=function(){};Sa.prototype.dispose=function(){Fi.a(this.$).XA(this)};tl.Object.defineProperties(Sa.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.XXc},set:function(e){this.XXc!==e&&(e?Fi.a(this.$).Tg(this):Fi.a(this.$).XA(this),this.XXc=e)}},Zd:{configurable:!0,enumerable:!0,get:function(){return this.aej}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.gSe)}}});
Object(td.a)(Sa,"FormulaAssistanceFocusManager",null,[107,3]);var Qh=b(1047),Wh=Zg.a;vm(Da,Wh);Da.prototype.mmb=function(e){this.addHandler("FunctionInfoLoaded",e)};Da.prototype.Jqc=function(e){this.removeHandler("FunctionInfoLoaded",e)};Da.prototype.rAg=function(e){this.addHandler("FunctionInfoReset",e)};Da.prototype.E4i=function(e){this.removeHandler("FunctionInfoReset",e)};Da.prototype.dispose=function(){var e=this.$.da.Aa(268);e&&e.MGd(this.guf);this.vb=null;Wh.prototype.dispose.call(this)};Da.prototype.mPf=
function(){this.raiseEvent("FunctionInfoReset")};Da.prototype.lId=function(){this.mPf();this.YIc=!1;this.tS=null;this.WIc=!0};Da.prototype.Krb=function(e,C){var M=this;C=void 0===C?!1:C;if(this.H4)this.oHf();else{Fd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var ra=null;(ra=this.$.da.Aa(268))||Fd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===ra||void 0===ra?0:ra.Jia)&&
0<ra.Jia.length)ld.EwaSettings.la(121)?ra.Nxh(this.vuf):this.XEd(ra.Jia,!0,!1);else{var Na=this.$.qa.ta.Xb();e&&(this.$.fa.oc||C)&&!this.Rai&&(C?Lg.a(this.$.userOperationManager,function(Ib,Gc,id){return vf.w(M.$.qa.ta,e,hh.b(Ib,M.xuf),hh.a(Gc,M.wuf),id,e,Na)},function(Ib){return new hg.a(130,0,Ib,16)},null):vf.w(this.$.qa.ta,e,this.xuf,this.wuf,null,e,Na));!this.H4&&this.$.fa.oc&&(ra?(Fd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.H4,this.$.fa.oc),ra.Pke(this.guf)):(Fd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),vf.w(this.$.qa.ta,{FilterType:0},this.vuf,null,null,null,Na),this.WIc=!1))}}};Da.prototype.JJh=function(e){return 0>e||e>=this.tS.length?null:this.tS[e]};Da.prototype.Rcd=function(e){return gi.a.Ec(this.Ead,e.toUpperCase())};Da.prototype.RWe=function(e){return gi.a.Ec(this.hJa,e)};Da.prototype.mmd=function(e){return!e.GroupUI};
Da.prototype.juf=function(e,C,M){var ra=yh.a(e);Fd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",ra);ra?($e.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.fa.Yo(e.Errors)):(this.XEd(e.Result,C,M),cg.a.bka()&&!cg.a.gV(this.$)&&this.$Kj())};Da.prototype.XEd=function(e,C,M){Fd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
e.length,C,M,this.H4);this.H4||(this.tS=e,this.BLg(C),this.YIc=!M,this.oHf())};Da.prototype.oHf=function(){this.raiseEvent("FunctionInfoLoaded")};Da.prototype.$Kj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.zad)};Da.prototype.BLg=function(e){function C(Gf,rg){return Gf.NameUI.localeCompare(rg.NameUI)}var M=Ae.a.instance.ea(998),ra=[];this.hJa={};this.j8=[];this.hJa[M]=ra;var Na=Ae.a.instance.ea(999),Ib=[];Array.add(this.j8,M);Array.add(this.j8,Na);M=0;for(var Gc=this.tS.length;M<
Gc;M++){var id=this.tS[M];id.IsCompatibility||Array.add(Ib,id);var Uc=id.NameUI,Vd=id.NameDataStrings;this.Ead[Vd.toUpperCase()]||(this.Ead[Vd.toUpperCase()]=id);this.GSe[Uc.toUpperCase()]||(this.GSe[Uc.toUpperCase()]=id);if(!this.mmd(id)){if(e){Uc=id.GroupUI;var Ye=gi.a.Ec(this.hJa,Uc);Ye||(Ye=[],this.hJa[Uc]=Ye,Array.add(this.j8,Uc));Array.add(Ye,id)}id.IsCommonlyUsed&&Array.add(ra,id);id.IsCompatibility||Array.add(this.Dkg,Vd)}}this.hJa[Na]=Ib;e&&(Da.PKf(ra,[2,3,0,5,4,9,1,7,8,6]),ra=Array(14),
ra[0]=0,ra[1]=1,ra[2]=7,ra[3]=11,ra[4]=5,ra[5]=2,ra[6]=6,ra[7]=10,ra[8]=9,ra[9]=3,ra[10]=4,ra[11]=13,ra[12]=12,ra[13]=8,Da.PKf(this.j8,ra),ra=[],Array.addRange(ra,this.j8),Array.removeAt(ra,13),this.j8=ra);this.tS=Array.clone(this.tS);this.tS.sort(function(Gf,rg){return Gf.NameDataStrings.localeCompare(rg.NameDataStrings)});ra=1;for(Na=this.j8.length;ra<Na&&e;ra++)this.hJa[this.j8[ra]].sort(C);e=0;for(ra=this.tS.length;e<ra;e++)this.tS[e].FunctionIndex=e};Da.PKf=function(e,C){for(var M=Array.clone(e),
ra=0;ra<M.length&&ra<C.length;ra++)e[ra]=M[C[ra]]};tl.Object.defineProperties(Da.prototype,{H4:{configurable:!0,enumerable:!0,get:function(){return this.YIc}},Rai:{configurable:!0,enumerable:!0,get:function(){return this.WIc}},zad:{configurable:!0,enumerable:!0,get:function(){var e=this.tS,C=Qh.a(this.$);if(!C)return e;C=C.YIh();var M=C.length;if(0>=M)return e;var ra=[];Array.addRange(ra,e);for(e=0;e<M;e++){var Na=C[e],Ib={};Ib.FunctionIndex=ra.length;Ib.HelpId=Ib.GroupUI=null;Ib.Help=Na.description;
Ib.IsCommonlyUsed=Ib.IsCompatibility=!1;Ib.NameDataStrings=Na.name;Ib.NameUI=Na.name;Ib.Params=null;Ib.ParamsHelp=null;Array.add(ra,Ib)}return ra}},vSe:{configurable:!0,enumerable:!0,get:function(){return this.j8}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(td.a)(Da,"FunctionInfoManager",Zg.a,[590,591,3]);var gh=b(1128),zh=gh.a;vm(Tb,zh);Tb.prototype.setVisible=function(e){Le.DOMElementExtensions.setVisible(this.domElement,e);e||(this.domElement.style.top="auto",this.domElement.style.left=
"auto")};Tb.prototype.isRtl=function(){return this.fj};Tb.prototype.gZe=function(){return this.domElement.parentNode};Tb.prototype.SQa=function(e){var C=this.domElement.style;C.cursor="move";C.position=e?"relative":"absolute"};Object(td.a)(Tb,"FunctionParamBoxDraggableItem",gh.a,[]);Object(td.a)(sb,"FormulaArgumentAssistanceCallbacks",null,[]);Object(td.a)(sa,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(td.a)(va,"ArgumentAssistanceRequest",null,[]);var wh=b(269);wa.prototype.Paa=function(){return this.Bt&&
!!this.render&&!!this.dismiss&&!!this.root&&!!this.cva};wa.prototype.NNa=function(e){this.cva.style.cursor="grabbing";this.Exj=e.clientPoint.x;this.Fxj=e.clientPoint.y;this.Nwc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);this.placeholder.firstChild.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);this.dismiss();return!0};wa.prototype.ola=function(e){var C=e.clientPoint.x-this.Exj;e=e.clientPoint.y-this.Fxj;C=Math.min(Math.max(C,
this.cBc-this.Nwc.left),window.innerWidth-this.Nwc.right-this.cBc);e=Math.min(Math.max(e,this.cBc-this.Nwc.top),window.innerHeight-this.Nwc.bottom-this.cBc);this.placeholder.firstChild.style.transform="translate("+C+"px, "+e+"px)";return!0};wa.prototype.nla=function(){this.rt()};wa.prototype.lla=function(){this.rt()};wa.prototype.ja=function(e,C,M,ra){this.root=e;this.cva=C;this.render=M;this.dismiss=ra;this.detach();this.cva&&(this.cva.style.cursor="grab",wh.a.instance.hW(this.cva,this),this.Bt=
!0)};wa.prototype.detach=function(){this.Bt&&(this.cva.style.cursor="",wh.a.instance.hW(this.cva,this),this.Bt=!1);Le.DOMElementExtensions.Sf(this.placeholder)};wa.prototype.clear=function(){this.Q8b.setOverrideTarget(void 0);this.detach()};wa.prototype.rt=function(){var e=this,C=this.placeholder.firstChild.getBoundingClientRect(),M=this.Q8b.getDirectionalHint({top:C.top,left:C.left});this.cva.style.cursor="grab";this.Q8b.setOverrideTarget({top:1===M?C.bottom:C.top,left:C.left});this.render();window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){Le.DOMElementExtensions.Sf(e.placeholder)})})};
Object(td.a)(wa,"FormulaAssistanceDragAdapter",null,[652]);var pi=bi.a;vm(Fb,pi);Fb.prototype.Qke=function(e){this.addHandler("FAFunctionNameUpdated",e)};Fb.prototype.uMf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};Fb.prototype.Gle=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};Fb.prototype.TMf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};Fb.prototype.Fle=function(e){this.addHandler("FAParameterSelectionChanged",e)};Fb.prototype.SMf=function(e){this.removeHandler("FAParameterSelectionChanged",
e)};Fb.prototype.set_visible=function(e){this.Wm?e||this.Wqb():Sys.UI.Control.prototype.set_visible.call(this,e);return e};Fb.prototype.Wqb=function(){this.formulaAssistanceUIControl&&(this.Aq=null,this.wQ&&this.VM.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Bka=null,this.Uq.canReceiveFocus=!1)};Fb.prototype.show=function(e){this.Wm||(ka.instance.Y6(["argumentAssistanceRender"]),this.B0a.setVisible(!!e),ka.instance.RY(["argumentAssistanceRender"]),this.cVc&&(this.cVc=!1,
ka.instance.i6b("argumentAssistanceOverall")))};Fb.prototype.Q8i=function(){var e=this;if(!this.Maa||this.fRa){ka.instance.Y6(["argumentAssistanceComputation","argumentAssistanceOverall"]);var C=$e.g(this.$).Jj;this.pluginScheduler.requester().argumentAssistance(Object.assign(new va,{content:C.text,caretPosition:C.textBox.caretPosition})).then(function(M){M.kind?ka.instance.RY(["argumentAssistanceComputation"],!1):M.payload?(ka.instance.RY(["argumentAssistanceComputation"]),e.prj(e.WBd(M.payload),
C.textBox.domElement)):e.Wqb();return null})}};Fb.prototype.update=function(e,C,M,ra){if(!this.Wm&&e){ka.instance.Y6(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.cVc=!0;var Na=this.$.listSeparator;try{var Ib=$get(Za.Cad,this.Ui),Gc=$get(Za.vad,this.Ui);Ib.innerText="";Gc.innerText="";var id=$get(Za.CSe,this.Ui),Uc=e.Params.split(Za.F8c);Ib=[];Gc=0;for(var Vd=id.rows.length;Gc<Vd;Gc++){var Ye=id.rows[Gc];Le.DOMElementExtensions.setVisible(Ye,Gc<Uc.length);var Gf=Uc[Gc],rg=Za.UOi+
Gc+"_",Dg=e.NameDataStrings;$get(rg+Za.NDb,Ye).innerText=Dg;$get(rg+Za.yAd,Ye).innerText=Dg;if(Gf){var Eg=Uc[Gc].split(Na),Ch=Fb.Lld(Eg[Eg.length-1]),kj=Fb.edi(e);Ch&&(kj&&(2<Eg.length?(Eg[Eg.length-2]+="1",Eg[Eg.length-3]+="1"):Fd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Dg,Eg.length.toString(),C)),Fb.AFg(Eg,kj,C,e));Gf=Eg.join(Na.toString()+" ");Uc[Gc]=Gf;M<Eg.length?
(Ib[Gc]=Eg[M],Fd.ULS.shipAssertTag(537162072,0,!!Eg[M]&&1<=Eg[M].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",M,Eg.length,Dg,Gc),Eg[M]=String.format("{0}{1}{2}","<b>",Eg[M],"</b>"),Gf=Eg.join(Na.toString()+" ")):Fd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+M+"currRowParamsArray.Length = "+Eg.length+", current row = "+
Gc);ra&&Fd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Dg,Eg.length,Ch,kj,C)}$get(rg+Za.zAd,Ye).innerHTML="("+(Gf||"")+")"}ra?this.raiseEvent("FAFunctionNameUpdated",new Ja(e.NameDataStrings,Uc)):this.raiseEvent("FAParameterSelectionChangedOld",new Ra(Uc,Ib,M));id.className=of.a.Wkh+(this.functionInfoManager.mmd(e)?"-udf":"")}catch(Lj){throw Fd.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
e.NameDataStrings,C,Lj),Lj;}ka.instance.RY(["argumentAssistanceComputation"])}};Fb.prototype.dispose=function(){this.Wm||(this.wc.kA(),jf.a.Fa(this.wc),$e.g(this.$).view.Wr(this.Ns),jf.a.Fa(this.B0a),this.B0a=null);this.Wm&&jf.a.Fa(this.Uq);this.Maa&&$e.g(this.$).rc.Rp(this.Rh);this.functionInfoManager=this.$=null;pi.prototype.dispose.call(this)};Fb.prototype.WBd=function(e){var C=new sa;C.functionRenderingInfo=e;C.cardMode=this.n2;this.CFd(C);return C};Fb.prototype.CFd=function(e){e.callbacks=new sb;
e.callbacks.onHelpLink=this.Zcd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.tQa;this.Maa&&(e.callbacks.onDismissClick=this.onDismissClick)};Fb.prototype.prj=function(e,C){var M=this;if(this.formulaAssistanceUIControl){ka.instance.Y6(["argumentAssistanceRender"]);var ra={};ra.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(ra);this.Aq=function(){M.formulaAssistanceUIControl.renderArgumentAssistanceCard(M.domElement,C,e)};
this.Aq();this.ZAd(e);this.wQ&&this.VM.ja(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Aq,function(){return M.formulaAssistanceUIControl.dismiss(M.domElement)});this.Uq.canReceiveFocus=!0;ka.instance.RY(["argumentAssistanceRender"]);ka.instance.i6b("argumentAssistanceOverall")}};Fb.prototype.Zcd=function(e){var C=this;return function(){Nb(C.$,e.helpID,e.isUDF)}};Fb.prototype.lMd=function(){var e=ug.a.get(Je.a.hZb);this.n2=e?parseInt(e):
Fb.o4c;ka.instance.nUf(this.n2)};Fb.prototype.ZAd=function(e){var C=e.functionRenderingInfo.functionName;this.Bka&&K.a.equals(this.Bka,C,!0)?(C=ai.a.map(e.functionRenderingInfo.signatures,function(M){var ra="";0<=M.signatureParams.activeParam&&M.signatureParams.activeParam<M.signatureParams.params.length&&(ra=M.signatureParams.params[M.signatureParams.activeParam]);return ra}),this.raiseEvent("FAParameterSelectionChanged",new Lb(C))):(this.Bka=C,e=ai.a.map(e.functionRenderingInfo.signatures,function(M){return M.signatureParams.params.join(", ")}),
this.raiseEvent("FAFunctionNameUpdated",new Ja(C,e)))};Fb.prototype.fMb=function(e){this.n2=e;try{ug.a.vw(Je.a.hZb,e.toString(),sh.AFrame.Qda)}catch(C){Fd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",C.message)}};Fb.Lld=function(e){return K.a.contains(e,Za.X5b,!0)};Fb.edi=function(e){return!!e&&K.a.M0a(e.NameDataStrings,"IFS")};Fb.AFg=function(e,C,M,ra){try{if(!e||2>e.length)Fd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
ra.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",C,M);else{for(var Na=e.pop().toString(),Ib=e.length-1;Ib<M;Ib++){var Gc=e[Ib].trim();if(C){var id=e[Ib-1].trim();e.push(Fb.VAh(id,Gc))}else{var Uc=Fb.g7e(Gc);e.push(Fb.jTe(Uc))}}e.push(Na)}}catch(Vd){throw Fd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",ra.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",
C,M,Vd),Vd;}};Fb.VAh=function(e,C){e=Fb.g7e(e);var M=Fb.fZe(e);C=Fb.fZe(C);return Fb.jTe(e,!0,!!M&&!!C&&M!==C)};Fb.g7e=function(e){var C=e.match(Fb.zwd);e=K.a.trimEnd(K.a.trimStart(e,Za.PBf),Za.OBf);if(C&&C.length){C=C[C.length-1];var M=Number.parseLocale(C)+1;e=e.replace(C,M.toString())}else e=String.format("{0}{1}",e,1);return e};Fb.jTe=function(e,C,M){var ra="[{0}]";(void 0===C?0:C)&&(ra=(void 0===M?0:M)?"[{0}":"{0}]");return String.format(ra,e)};Fb.fZe=function(e){return(e=e.match(Fb.zwd))&&e.length?
e[0]:null};Fb.lJa=function(e){if(e)return document.createElement("div");e=String.format(Za.xCf,Za.vCf,Za.yAd,of.a.JKe,Za.NDb,of.a.IKe,Za.zAd);var C=String.format(Za.xCf,Za.wCf,Za.yAd,of.a.JKe,Za.NDb,of.a.IKe,Za.zAd);e=String.format(Za.pzh,Za.qzh,of.a.zLe,of.a.bih,pc.a.yu,Za.CSe,e,C);C=document.createElement("div");C.innerHTML=e;return C.firstChild};Fb.zwd=RegExp("\\d+");Fb.o4c=0;Object(td.a)(Fb,"FormulaArgumentAssistanceControlDeprecated",bi.a,[638]);Object(td.a)(Sb,"ParseContext",null,[]);var vi=
b(313),$i=Pk.a;vm(Gb,$i);Gb.prototype.ki=function(e,C){this.formulaAssistanceControl.qb=this.qb;-1470715894!==C&&-1231471547!==C||this.H4a&&!this.ZEe()||(this.kV=!1);return $i.prototype.ki.call(this,e,C)};Gb.prototype.Zwd=function(){var e=this.swb;if(e||this.HOd){this.formulaAssistanceControl.qb=this.qb;if(this.H4a&&(ka.instance.Anb.formulaAssistanceRequestAttemptedCounter++,!this.ZEe())){ka.instance.Anb.formulaAssistanceRequestOptimizedCounter++;return}if(!e&&this.HOd)this.formulaAssistanceControl.zpe();
else if(ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.W1h){if(e=this.$.Ub.Fc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Bpe(),e.stop(),this.tYa.text.endsWith("[")&&"["!==this.tYa.text.charAt(this.tYa.text.length-2)){var C=""===this.oHa?this.formulaAssistanceControl.tableManager.Wg:Object(qc.a)(vi.a,this.$.xb.getItemByName(this.oHa));Fd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
C.pj,e.Ac,this.cjd,this.kV)}}else this.formulaAssistanceControl.jnb(),this.tBf&&(this.tBf=this.kV=!1)}else this.kV=!1};Gb.prototype.Mj=function(){this.P2i||(this.jRa=null,this.HOd&&this.formulaAssistanceControl.gZ())};Gb.prototype.Rh=function(){this.kV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Jrc();this.Wm&&this.Xmi()};Gb.prototype.lDd=function(e,C){return this.formulaAssistanceControl.ki(e,C)};Gb.prototype.Xmi=function(){this.formulaAssistanceControl.wcb&&(ka.instance.T8b.smartSuggestionShownCounter++,
this.formulaAssistanceControl.wcb=!1);this.formulaAssistanceControl.gKb&&(ka.instance.T8b.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.gKb=!1);this.formulaAssistanceControl.fKb&&(ka.instance.T8b.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.fKb=!1)};Gb.prototype.OQg=function(e,C){for(var M=0,ra;-1!==M;)if(M=e.indexOf("[",M+1),-1!==M&&M<C&&(ra=e.indexOf("]",M+1),-1===ra||ra>=C))return M;return-1};Gb.prototype.ZEe=function(){var e=this.qb.text,C=this.qb.textBox.caretPosition,
M=this.formulaAssistanceControl.wMa,ra=this.formulaAssistanceControl.vMa;if(this.kV&&K.a.equals(e,M,!0)&&C===ra)return!1;this.formulaAssistanceControl.wMa=e;this.formulaAssistanceControl.vMa=C;return!0};tl.Object.defineProperties(Gb.prototype,{qxb:{configurable:!0,enumerable:!0,get:function(){return Object(eg.a)(vb,this.$.Ab.rh)}},kV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(e){this.formulaAssistanceControl.isListVisible=e}},swb:{configurable:!0,
enumerable:!0,get:function(){var e=this.tYa.text;e=0<e.length?e.charCodeAt(0):-1;return 61===e||43===e||45===e||64===e}},W1h:{configurable:!0,enumerable:!0,get:function(){var e=this.tYa.text,C=!1;if(0>=e.length)return C;var M=this.$.Ub.Fc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),ra=$e.g(this.$).ha.va.activeCell.clone(),Na=e.charCodeAt(0);this.oHa="";this.NP=this.OQg(e,this.tYa.caretPosition);Na=61===Na&&-1!==this.NP;if(!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Na&&
(C=!0);else if(Na){if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Na=0;for(var Ib=this.NP-1;1<=Ib&&!(this.NP-Ib>Gb.Wlf);Ib--)if(Array.contains(Gb.Are,e.charAt(Ib))){Na=Ib;break}Na=e.substring(Na+1,this.NP);e=""!==Na?this.$.xb.getItemByName(Na):null;Ib=this.NP;for(var Gc=this.NP+1;Gc<=this.qb.textBox.caretPosition;Gc++)if("["===this.qb.text.charAt(Gc))Ib=Gc;else break;this.NP=Ib}else{Na=e.lastIndexOf("[");Ib=0;for(Gc=Na-1;1<=Gc&&!(Na-Gc>Gb.Wlf);Gc--)if(Array.contains(Gb.Are,
e.charAt(Gc))){Ib=Gc;break}Na=e.substring(Ib+1,Na);e=""!==Na?this.$.xb.getItemByName(Na):null}e&&2===e.type?(C=!0,this.oHa=Na):$e.g(this.$).Vb.vk(ra)&&(C=!0,this.oHa="")}M.stop();this.cjd=M.Ac;Fd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.cjd);return C}},key:{configurable:!0,enumerable:!0,get:function(){return lk.a.iua}},calcManager:{configurable:!0,enumerable:!0,
get:function(){this.VDc||(this.VDc=this.$.da.Aa(266,!1));return this.VDc}},HOd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.jRa)return this.jRa;if(!ld.EwaSettings.la(135))return this.jRa=!1;var e=$e.g(this.$).ha.va.activeCell.clone();if(1!==e.Dlf||!e.left||$e.g(this.$).ha.va.ufc())return!1;var C=this.formulaAssistanceControl.tableManager.eo(e);if(C)return this.jRa=!1;--e.left;--e.right;if(!e.isValidRange)return!1;C=this.formulaAssistanceControl.tableManager.eo(e);return this.jRa=!!C&&
e.top===C.top&&this.formulaAssistanceControl.tableManager.ZZg(C,$e.g(this.$))}}});Gb.Are=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Gb.Wlf=255;Object(td.a)(Gb,"FormulaAutoCompleteListAutoCompleteBehavior",Pk.a,[]);var Ui;(function(e){e[e.function=0]="function";e[e.field=1]="field";e[e.definedName=2]="definedName";e[e.letVariable=3]="letVariable";e[e.tableColHeaderName=4]="tableColHeaderName";e[e.tableSpecialStructRef=5]="tableSpecialStructRef";e[e.pendingData=6]="pendingData";e[e.tableNamedObject=7]="tableNamedObject"})(Ui||
(Ui={}));Object(td.b)("ItemType",Ui);var di=b(1191),ri=b(1190);hb.prototype.execute=function(e){Array.add(e,this.index)};Object(td.a)(hb,"AppendIndexOperation",null,[669]);za.prototype.execute=function(){};Object(td.a)(za,"NopIndexOperation",null,[669]);da.prototype.execute=function(e){for(var C=0;C<e.length;C++)e[C]===this.NTi&&(e[C]=this.cof)};Object(td.a)(da,"ReplaceIndexOperation",null,[669]);Zb.prototype.DBe=function(e,C){var M=new hb(C);if(!cg.a.jmd())return M;e=this.Ghi(e,C);return null!=e?
this.items[e].Byb?new da(e,C):new za:M};Zb.prototype.Ghi=function(e,C){var M=this,ra=this.items[C];Fd.ULS.shipAssertTag(537162075,0,!!ra,"Internal error: invalid item index");e=ha.where(ha.asEnumerable(e),function(Na){return M.items[Na].name===ra.name});return ha.Ct(e)?ha.first(e):null};Object(td.a)(Zb,"FilterItemOperationFactory",null,[]);Object(td.a)(Wb,"CompletionItem",null,[]);var Hi=di.a;vm(Ya,Hi);Ya.prototype.Hle=function(e){this.addHandler("FLBSelectedRowChanged",e)};Ya.prototype.UMf=function(e){this.removeHandler("FLBSelectedRowChanged",
e)};Ya.prototype.tTc=function(e){this.addHandler("ACLBUpdated",e)};Ya.prototype.UGd=function(e){this.removeHandler("ACLBUpdated",e)};Ya.prototype.dispose=function(){Hi.prototype.dispose.call(this);this.Bqa=this.DSe=this.etb=null};Ya.prototype.uxc=function(e,C,M,ra){ra=void 0===ra?0:ra;this.Ybf||this.d7(!1);var Na="";M&&(Na+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",of.a.yVg,M));Na+=String.format("<table class='{0}' aria-live='off'><tbody>",
this.rba);for(var Ib=new mc.a,Gc=0,id=this.XV.length;Gc<id;Gc++)Na+=this.n0e(e[this.XV[Gc]],Gc+1,C,ra),this.Wm&&Ib.add(this.iVe(e[this.XV[Gc]]));Gc=this.XV.length;id=0;for(var Uc=this.Kr.length;id<Uc;id++)Array.contains(this.XV,this.Kr[id])||(Gc++,Na+=this.n0e(e[this.Kr[id]],Gc,C,ra),this.Wm&&Ib.add(this.iVe(e[this.Kr[id]])));this.dg.innerHTML=Na+"</tbody></table>";this.zn=Le.DOMElementExtensions.vj(this.domElement,this.rba);this.Wm&&(this.p0c=Ib.toArray());this.Ybf?(this.isListVisible=!0,this.JFa.set_visible(!0)):
(this.d7(!0),this.ADg(!!M))};Ya.prototype.NIa=function(e,C,M,ra,Na,Ib){ra=void 0===ra?"":ra;Na=void 0===Na?0:Na;Ib=void 0===Ib?!1:Ib;if(e){var Gc=[],id=[];this.eKb=0;var Uc=new Zb(this.$,e);if(C){var Vd=!!C&&0<Na,Ye=Vd&&91===C.charCodeAt(Na+1)?Na+2:Na+1;Ib=Vd?C.length===Ye:!1;Vd&&C.length===Na&&ld.EwaSettings.la(135)&&(Ib=!0);var Gf=null;!Ib&&Vd&&C.length>Na+1&&(Gf=C.substring(Ye,C.length));if(C)for(Vd=0,Ye=e.length;Vd<Ye;Vd++){var rg=e[Vd].name;if(!e[Vd].$9h){var Dg=Uc.DBe(Gc,Vd);e[Vd].Byb&&this.eKb++;
(Gf||Ib)&&e[Vd].itemType||(id=this.bQe(C,rg,M,Dg,Gc,id),Gc=id.o7e,id=id.BEf);Gf&&1===e[Vd].itemType&&(id=this.bQe(Gf,rg,!0,Dg,Gc,id),Gc=id.o7e,id=id.BEf);Ib&&1===e[Vd].itemType&&Dg.execute(Gc)}}}else for(M=0;M<e.length;++M)if(e[M].Byb||Ib)Gf=Uc.DBe(Gc,M),Gf.execute(Gc),Gf.execute(id),e[M].Byb&&this.eKb++;this.XV=id;this.Kr=Gc;this.uxc(e,C,ra,Na)}};Ya.prototype.dKj=function(e){if(e&&!(1<e.length)){var C=[],M=[];C.push(0);M.push(0);this.XV=C;this.Kr=M;this.uxc(e,"","",0)}};Ya.prototype.qxa=function(){this.Nk&&
Hi.prototype.qxa.call(this)};Ya.prototype.eXi=function(e,C){this.raiseEvent("ACLBUpdated",new ri.a(e,void 0,void 0,C))};Ya.prototype.Q$f=function(e){var C=this.zn.rows[e];return(!this.Nk||this.Nk!==C)&&e<this.zn.rows.length?(this.Nk=C,!0):!1};Ya.prototype.Klc=function(e){$h.g(e.Ea);this.rw&&2!==this.rw&&3!==this.rw&&4!==this.rw&&5!==this.rw&&7!==this.rw?1===this.rw?this.JFa.wy(!1):(this.JFa.wy(!1),e=$e.g(this.$),e.Dq(!1),e.focus()):(this.raiseEvent(Xj.a.m3a),this.qxa());return!0};Ya.prototype.ADg=
function(e){this.hra();if(e){var C=this.zn.offsetWidth+(this.Kr.length>this.xH?yc.a.Sp:0);e=$get("list_column_header");e.offsetWidth>C&&Le.DOMElementExtensions.Gq(this.dg,e.offsetWidth);C=this.dg.getElementsByClassName(this.QZ);for(var M=0;M<C.length;M++)C[M].style.width=ab.HelperMethods.Qb(e.offsetWidth)}};Ya.prototype.n0e=function(e,C,M,ra){if(1===e.itemType){var Na=bh.a.If(e.name),Ib=bh.a.If(ra?M.substring(ra+1,M.length):M),Gc=0;Na.substring(0,Ib.length).toLowerCase()!==Ib.toLowerCase()&&(Gc=Ya.kxj(Na,
Za.Acg,Ib));M="";M=0<=Gc?M+(Na.substring(0,Gc)+"<b>"+Na.substring(Gc,Gc+Ib.length)+"</b>"+Na.substring(Gc+Ib.length,Na.length)):M+Na;ra=ra?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",pc.a.dMe,bh.a.ZU(rh.a.Be(0)),Ae.a.instance.ea(696)):"";return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'></td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
ra,C,Ui[e.itemType],this.QZ,M)}if(5===e.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>","",C,Ui[e.itemType],this.QZ,bh.a.If(e.name),bh.a.If(e.Hia));if(4===e.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
"(...)",C,Ui[e.itemType],this.QZ,bh.a.If(e.name));if(6===e.itemType)return ra=ra?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",pc.a.dMe,bh.a.ZU(rh.a.Be(0)),Ae.a.instance.ea(696)):"",String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",ra,this.QZ,bh.a.If(e.name),bh.a.If(e.Hia),
C,Ui[e.itemType]);ra=String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",2===e.itemType||3===e.itemType?pc.a.Knh:pc.a.Inh,bh.a.ZU(rh.a.Be(0)),Ae.a.instance.ea(693));return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",ra,this.QZ,bh.a.If(e.name),bh.a.If(e.Hia),C,Ui[e.itemType])};
Ya.prototype.iVe=function(e){var C=new Wb;C.label=e.label;C.textEdit=e.textEdit;C.kind=Ya.CFh(e.itemType);C.type=e.Byb?1:0;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===C.kind){var M=this.formulaAssistanceControl.KJh(e.label);C.detail=M?M:e.Hia}else C.detail=e.Hia;return C};Ya.prototype.bQe=function(e,C,M,ra,Na,Ib){K.a.equals(C,"Pretend this is the line.",!1)&&0<Na.length||K.a.eI(C,e)?(ra.execute(Na),ra.execute(Ib)):M&&e.length>=Za.b_g&&Ya.I9g(C,Za.Acg,
e)?ra.execute(Na):!M&&e.length>=Za.a_g&&K.a.contains(C,e,!0)&&ra.execute(Na);return{o7e:Na,BEf:Ib}};Ya.CFh=function(e){switch(e){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};Ya.I9g=function(e,C,M){C=yl(C);for(var ra=C.next();!ra.done;ra=C.next())if(ra=e.split(ra.value),!(2>ra.length)){ra=yl(ra);for(var Na=ra.next();!Na.done;Na=ra.next())if(K.a.eI(Na.value,M))return!0}return!1};Ya.kxj=function(e,
C,M){C=yl(C);for(var ra=C.next();!ra.done;ra=C.next())if(ra=e.toLowerCase().indexOf((ra.value+M).toLowerCase()),0<ra)return ra+1;return-1};tl.Object.defineProperties(Ya.prototype,{Aod:{configurable:!0,enumerable:!0,get:function(){return 0<this.eKb&&this.eKb===this.Kr.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(uj.a)(Ya.prototype,this,"isListVisible")},set:function(e){Object(uj.b)(Ya.prototype,this,"isListVisible",e);e||(this.htc=0,this.pe=null);this.htc?Le.DOMElementExtensions.setVisible(this.etb,
!1):Le.DOMElementExtensions.setVisible(this.etb,e&&!this.Wm)}},Nk:{configurable:!0,enumerable:!0,get:function(){return this.Bqa},set:function(e){this.GAa(this.Nk);if(e){this.DSe.innerText="";this.Bqa=e;var C=this.GAa(this.Nk),M=e.rowIndex+1,ra=$get("description_cell"+M,e);this.etb.innerText=ra.innerText;var Na=$get("item_type_cell",e);this.pe=C=C.innerText;this.htc="field"===Na.innerText?1:"definedName"===Na.innerText?2:"letVariable"===Na.innerText?3:"tableColHeaderName"===Na.innerText?4:"tableSpecialStructRef"===
Na.innerText?5:"pendingData"===Na.innerText?6:"tableNamedObject"===Na.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ri.a(this.Kr.length,M,C,ra.innerText));this.Psc(e)}}},nSa:{configurable:!0,enumerable:!0,get:function(){return this.etb}},JFa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},rw:{configurable:!0,enumerable:!0,get:function(){return this.htc}}});Object(td.a)(Ya,"FormulaAutoCompleteListBox",di.a,[635]);tl.Object.defineProperties(zb.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.X8}}});Object(td.a)(zb,"LETVariableInfo",null,[]);tl.Object.defineProperties(lb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(td.a)(lb,"TableColHeaderNameInfo",null,[]);tl.Object.defineProperties(Ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(td.a)(Ma,"TableNamedObjectInfo",
null,[]);tl.Object.defineProperties(Ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.X8}}});Object(td.a)(Ia,"TableSpecialStructRefInfo",null,[]);var Ii=b(186),Sh=b(176);Object(td.a)(pa,"FormulaAutoCompleteCallbacks",null,[]);Object(td.a)(na,"FormulaAutoCompleteRenderingInfo",null,[]);Object(td.a)(xa,"CellMessage",null,[]);Object(td.a)(Z,"FunctionSuggestionRequest",null,[]);Object(td.a)(ma,"RunExperimentRequest",
null,[]);var si=Oe.a;vm(Y,si);Y.prototype.Oke=function(e){this.addHandler(Y.kad,e)};Y.prototype.tMf=function(e){this.removeHandler(Y.kad,e)};Y.prototype.Mke=function(e){this.addHandler(Y.J$c,e)};Y.prototype.rMf=function(e){this.removeHandler(Y.J$c,e)};Y.prototype.Nke=function(e){this.addHandler("FormulaAutoCompleteShown",e)};Y.prototype.sMf=function(e){this.removeHandler("FormulaAutoCompleteShown",e)};Y.prototype.set_visible=function(e){this.Dia.set_visible(e);this.Wm&&!e&&this.q0a();Sys.UI.Control.prototype.set_visible.call(this,
e);return e};Y.prototype.VPg=function(e,C){this.isListVisible&&(e+=Za.openParen,C++,this.DAd(e,C));var M=0<C&&e.charAt(C-1)===Za.openParen,ra=C===e.length||e.charAt(C)===Za.closeParen;if(!M||!ra)return Fd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",C,!e.length,!!this.MP),!1;M=e.substring(0,C).lastIndexOf(this.$.listSeparator);ra=e.substring(0,C-1).lastIndexOf(Za.openParen);e=e.substring(-1===
M&&-1===ra?1:Math.max(M,ra)+1,C-1).trim();return this.functionInfoManager.Rcd(e)?!0:(Fd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.MP),!1)};Y.prototype.j6h=function(e,C){var M=this.VPg(e,C);if(!M||!this.MP)return Fd.ULS.shipAssertTag(537162051,0,!M||M&&!!this.MP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Znf:0,WQe:0};
M=this.MP.Params;M=M.replace(RegExp("[\\[\\]]","g"),"");var ra=e.charAt(C-1)===Za.openParen,Na=ra?"":"(",Ib=C===e.length?")":"";var Gc=this.$.listSeparator;Gc=M.includes(Gc)?M.indexOf(Gc):M.length;return{returnValue:e.substring(0,C)+Na+M+Ib+e.substring(C,e.length),Znf:ra?C:C+1,WQe:Gc}};Y.prototype.Ns=function(e,C){this.Wm&&void 0!==this.Aq&&null!==this.Aq&&this.Aq();this.Wm||si.prototype.Ns.call(this,e,C)};Y.prototype.dispose=function(){if(this.$){this.QRa(!1);var e=$e.g(this.$);e&&(e.ha&&(this.Wm?
e.ha.mF(this.kd):e.ha.Nca(this.kd),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&e.ha.aza(this.Pwd)),e.view.Wr(this.Blc));this.Wm&&this.$.xa&&this.$.xa.rg(this.Yh)}this.functionInfoManager&&(this.functionInfoManager.Jqc(this.onFunctionInfoLoaded),this.functionInfoManager.E4i(this.iuf));this.wi&&this.wi.Iqc(this.Oxa);this.Wm&&this.Rf&&this.Rf.UMf(this.$yf);this.m3f(!1);jf.a.Fa(this.Rf);jf.a.Fa(this.rZb);jf.a.Fa(this.Dia);this.Vja&&jf.a.Fa(this.Uq);this.qb=this.functionInfoManager=
this.wi=null;jf.a.pc(this.aJa);this.Wg=this.L7=this.Dia=this.aJa=null;si.prototype.dispose.call(this)};Y.prototype.JLa=function(){return!this.Cv};Y.prototype.Ubi=function(){return!this.KFa};Y.prototype.ki=function(e,C){if(!this.JLa()){if(this.Wm&&this.DM){if(125627505===C||267796030===C)return this.Naa&&this.rzc(C),this.cye(),!1;if(1872288872===C)return this.Hca(),this.isListVisible=!1,!0;if(this.Rf.Aod&&(-798660877===C||137938150===C))return!1}if(1!==this.Rf.rw||125627505!==C&&267796030!==C)if(6===
this.Rf.rw){var M=e.keyCode;13!==M&&9!==M||this.wy(!1)}else{if(4===this.Rf.rw||5===this.Rf.rw)return si.prototype.ki.call(this,e,C,!0);1===this.Rf.XV.length&&(M=e.keyCode,this.Tte=8===M||127===M||46===M?!0:!1)}else{if(this.wy(!1)&&!this.Hja)return $e.g(this.$).ha.ki(e,C);if(125627505===C&&this.Hja)return!0}}return si.prototype.ki.call(this,e,C)};Y.prototype.Jrc=function(){this.wi.uab();this.L7=null;null==this.qia||this.qia||this.mic("NoFieldChosen",1,2,1);this.qia=null;this.n3=0;this.b5=this.Cpd=
this.Jnc=null};Y.prototype.jnb=function(){var e=this,C=!!this.qb&&!eh.f(this.$.oa);if((this.hAa||this.vwc)&&C){var M=this.qb.text;this.pluginScheduler.requester().functionSuggestion(Object.assign(new Z,{content:M})).then(function(ra){ra.kind||(Fd.ULS.shipAssertTag(537162050,0,!!ra&&!!ra.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),ra=ha.toArray(ha.select(ha.asEnumerable(ra.payload.items),function(Na){return Y.UYg(Na)})),e.vwc&&"="===M&&0<ra.length&&
e.gridView.D0a.ujj("="+ra[0].textEdit.newText),e.hAa&&(e.BRa=ra,jd.AFrameworkApplication.Gg||e.Ape(C,!0)));return null})}this.hAa&&C||this.Ape(C,!1)};Y.prototype.l0e=function(){if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var e=$e.g(this.$).xj?this.Zsb.NP:this.Eob.NP;"@"===this.qb.text.charAt(e+1)&&this.qb.textBox.caretPosition>e+1?this.Qcb=e+2:this.Qcb=e+1}else{e=this.qb.text.lastIndexOf(Za.ehf);var C=this.qb.text.lastIndexOf("[");this.Qcb=
e+1>=C?e+2:C+1}return this.qb.text.substring(this.Qcb,this.qb.textBox.caretPosition)};Y.prototype.Bpe=function(){this.r0f()&&(this.I5g(),this.Cv&&(this.qia=!1,this.rV=this.l0e(),this.Rf.NIa(this.Cv,this.rV,!0,void 0,void 0,!0),this.show(),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Dia.Wqb()))};Y.prototype.zpe=function(){this.r0f()&&(this.rZb&&this.rZb.cancel(),this.wi.Axb?(this.JLa()&&this.tAe(!0),this.get_visible()?this.XPe():this.b_d=
Ii.AsyncMethodContext.Ky(this.XPe,Za.d9g,Ud.a.nyh,this.rZb)):this.gZ())};Y.prototype.r0f=function(){return this.qb?0<this.$.Ab.dR||!this.qb.text||!this.qb.isEditing?(this.set_visible(!1),!1):eh.f(this.$.oa)?!1:!0:!1};Y.prototype.f_a=function(e){this.qb&&this.isListVisible&&(this.gkd(this.qb.text,e),this.qb.textBox.caretPosition=e.range.start.character+e.newText.length,this.set_visible(!1))};Y.prototype.wy=function(){var e;if(!this.qb||!this.isListVisible)return!1;var C="",M=0,ra=$e.g(this.$),Na=this.qb.text,
Ib=0,Gc=this.Rf.pe,id=!1;if(this.Rf.rw&&2!==this.Rf.rw&&3!==this.Rf.rw&&7!==this.Rf.rw)if(1===this.Rf.rw)if(this.qia=!0,this.Hja){C+=Na.substr(0,this.n3+2);!C.toString().endsWith(Ed.a.jU)&&ld.EwaSettings.la(135)&&(C+=Ed.a.jU);Ib=this.Rf.pe;Ib=Ib.replace("'","''");Ib=Ib.replace("[","'[");Ib=Ib.replace("]","']");if(this.z4c||this.Mth(Ib))Ib=Ed.a.cki+Ib+Ed.a.Raj,id=!0;C+=Ib;M=C.length;Ib=3;Sh.a("PulloutFieldAccepted")}else return this.qb.text=this.Rf.pe,this.set_visible(!1),ra.Dq(!1),ra.focus(),this.mic("FieldName",
1,1,1),Sh.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Rf.rw)Fd.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),C+=Na.substr(0,this.Qcb),K.a.equals(this.Rf.pe,"@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString,!1)?C+="@":(C+=this.Rf.pe,id=!0,this.set_visible(!1)),M=C.length;else if(4===this.Rf.rw){Fd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");
C+=Na.substr(0,this.Qcb);id="";M=!1;for(var Uc=[39,91,93,64,35],Vd=0;Vd<this.Rf.pe.length;Vd++){var Ye=this.Rf.pe.charCodeAt(Vd);Array.contains(Uc,Ye)&&(id+="'");id+=this.Rf.pe.charAt(Vd).toString();M||K.a.isNumeral(Ye)||K.a.tbf(Ye)||(M=!0)}Uc=$e.g(this.$).xj?this.Zsb.NP:this.Eob.NP;Na=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Na.charAt(Uc+1)&&M:Na.lastIndexOf(Za.ehf)+1>=Na.lastIndexOf("[")&&M;C+=Na?"["+id+"]":id;id=!0;this.set_visible(!1);
M=C.toString().length}else if(6===this.Rf.rw)C+=Na.substr(0,this.irb);else return Fd.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;else C+=Na.substr(0,this.Z1a)+this.Rf.pe,this.Rf.rw||this.Rf.pe.endsWith(")")||(C+="("),M=C.toString().length,C+=Na.substr(this.$8b),2===this.Rf.rw&&(Ib=4,Gc="DefinedName",id=!0,this.set_visible(!1));this.qb.text=C;this.qb.textBox.caretPosition=M;this.qb.fMa()&&(null===(e=ra.hx)||void 0===e?0:e.eua)&&ra.hx.XHb(this.qb.text,
this.qb.textBox.caretPosition,this.qb.textBox.caretPosition,this.qb.textBox.Zu.length);ra.xj&&(e=ra.Kc,e.text=this.qb.text,e.setCaretPosition(this.qb.textBox.caretPosition));Gc=(null==this.qia?0:this.qia)?"FieldName":Gc;this.Rf.Nk.sectionRowIndex>=this.Rf.XV.length?this.mic(Gc,4,Ib,0):this.mic(Gc,1,Ib,0);id||(5===this.Rf.rw||4===this.Rf.rw?this.Bpe():this.jnb());return!0};Y.prototype.gZ=function(e,C){e=void 0===e?null:e;C=void 0===C?null:C;e?(this.wi.uab(),this.wi.gZ(e,!1,!1,C)):(e=$e.g(this.$),e.ha.va.Dh&&
(e=sg.v(e.ha.va.Qd,this.$),this.wi.gZ(e,!0,!0,C)))};Y.prototype.Hca=function(){this.bfa=!1;this.qb.CFe()};Y.prototype.KJh=function(e){e=this.calcManager.getWorksheetFuncId(e);return this.HSe?this.HSe.descriptionsMap.get(e):null};Y.prototype.tAe=function(e){if(this.Ubi()){if(this.wi.Axb&&this.wi.Tk&&(!this.wi.Tk.length||!this.wi.Tk[0].FieldInfoDataList))return;this.hIj(e)}e=ha.asEnumerable(this.KFa);e=ha.concat(e,this.FLh(this.qb.text));ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&
this.Wm&&(e=ha.concat(e,this.NMh()));ha.OBc(e,function(C){return C.name},new yf);this.hAa&&(e=ha.concat(ha.asEnumerable(this.BRa),e),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.BRa.length&&(this.wcb=!0),this.BRa=[]));this.L7=ha.toArray(e)};Y.prototype.I5g=function(){var e=this.qb.text;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var C=$e.g(this.$).xj?this.Zsb.oHa:this.Eob.oHa,M=!0;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==
C&&(this.Wg=Object(qc.a)(vi.a,this.$.xb.getItemByName(C))),this.Wg||(this.Wg=this.tableManager.Wg,M=!1),!this.Wg){Fd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",this.$.xb.count,""===C);return}}else this.Wg=Object(qc.a)(vi.a,this.$.xb.getItemByName(C)),this.Wg||(this.Wg=this.tableManager.Wg,M=!1);this.Wg.q0&&this.Wg.q0.IsFullTableHeaders?
this.$Df(M):Kf.d(this.Wg)?(Fd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Wg.pj),vf.H(this.$.qa.ta,this.Wg.pj,this.LEi,this.KEi,null,null)):Fd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Wg.pj)}else if(this.calcManager&&this.tableManager.Wg)if(C=this.calcManager.Sub(this.tableManager.Wg))if(this.calcManager.mEg(this.tableManager.Wg,
C)){e=ha.empty();if(91===this.qb.text.charCodeAt(this.qb.text.length-1)){var ra=this.D_a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);e=ha.concat(e,(M=new mc.a,M.add(ra),M))}e=ha.concat(e,ha.select(ha.asEnumerable(C.toArray()),function(Na){var Ib=new Eb,Gc=new lb;Gc._name=Na.toString();Ib.$Wf(Gc);return Ib}));this.L7=ha.toArray(e)}else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Fd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
C.count,this.tableManager.Wg.pj,this.tableManager.Wg.usedRange.right-this.tableManager.Wg.usedRange.left+1);else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Fd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};Y.prototype.Mth=function(e){if(!e)return!1;var C=e.charCodeAt(0);if(46===C||48<=C&&57>=C||63===C)return!0;for(var M=0;M<e.length;M++,
C=e.charCodeAt(M))if(!((ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?K.a.isLetter(C):K.a.Nmd(C))||92===C||95===C||63===C||48<=C&&57>=C))return!0;return!1};Y.prototype.DAd=function(e,C){var M=!1,ra=!1,Na=!1,Ib=0,Gc=0;this.Z1a=0;this.$8b=C;this.D3b=1;for(var id=C-1;0<=id;--id)switch(e.charCodeAt(id)){case 39:ra=!ra;break;case 34:M=!M;break;case 91:++Ib;Na=Ib>Gc;break;case 93:++Gc}Na=Object.assign(new Sb,{csa:!M,dsa:!ra,pha:!Na,ODb:1});
Ib=this.pPi(e,C,Na);C=this.qPi(e,C,Na.csa,Na.dsa,Na.pha);this.D3b=Ib+C;if(this.BOc=Ib-1)this.rvc=!1;this.zuh(e,M,ra,Na.fAd,Na.gAd)};Y.prototype.Sjd=function(){ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?$e.g(this.$).ha.bra(this.Pwd):$e.g(this.$).ha.fG(this.Pwd);this.qBb();Y.HJd(this.pluginScheduler);this.hAa&&this.rSg()};Y.prototype.Ysh=function(){return this.hAa||this.dPe};Y.prototype.rPi=function(){var e=this.b5;if(!this.Dpj||!e)return this.n3=0,this.KFa=this.L7=
null,!1;e=e.endsWith(Ed.a.jU);var C;if(C=ld.EwaSettings.la(135)){C=this.JFj(this.b5.substring(0,this.o3));var M=C.sheetRange;C=C.returnValue}return C&&(C=this.b5.substring(0,this.n3),e&&C!==this.Cpd)?(this.Cpd=C,this.n3=this.b5.length-(e?1:0),this.gZ(M,this.b5),this.qia=!1,Fd.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};Y.prototype.FLh=function(e){var C=new mc.a;this.calcManager&&ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Fd.ULS.shipAssertTag(537162014,
0,!!this.calcManager.rsa(Ug.Range.ld(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.dPe&&(e=this.calcManager.extractLetVariables(e,this.qb.textBox.caretPosition))){e=yl(e);for(var M=e.next();!M.done;M=e.next()){var ra=M.value;M=new zb;M._name=ra;M.X8=Ae.a.instance.ea(2145);ra=new Eb;ra.rjj(M);C.add(ra)}}return C};Y.prototype.NMh=function(){for(var e=new mc.a,C=this.$.xb.items,M=0,ra=C.length;M<ra;M++){var Na=C[M];if(eh.o(Na)){var Ib=
new Ma;Ib._name=Na.name;Na=new Eb;Na.Klj(Ib);e.add(Na)}}return e};Y.prototype.D_a=function(e){var C=new Eb,M=new Ia;M._name=e;C.Llj(M);return C};Y.prototype.$Df=function(e){var C=new mc.a,M=this.qb.text.charCodeAt(this.qb.text.length-1),ra=this.qb.textBox.caretPosition-1;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.qb.text.charCodeAt(ra):91===M){var Na=this.D_a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);
C.add(Na)}Na=yl(this.Wg.q0.HeadersList);for(var Ib=Na.next();!Ib.done;Ib=Na.next()){Ib=Ib.value;var Gc=new Eb,id=new lb;id._name=Ib.Name;Gc.$Wf(id);C.add(Gc)}Na=$e.g(this.$).xj?this.Zsb.NP:this.Eob.NP;Ib=this.qb.text.charCodeAt(Na+1);(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!e||ra!==Na&&35!==Ib:!e||91!==M&&35!==M)||(e=this.D_a("#"+this.instantaneousSupportInformationManager.He.AllStructRefString),C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.DataStructRefString),
C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.HeadersStructRefString),C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.TotalsStructRefString),C.add(e));C&&(this.L7=C.toArray())};Y.prototype.hIj=function(e){var C=ha.empty();!e&&this.functionInfoManager.H4&&(C=ha.concat(C,ha.select(ha.asEnumerable(this.functionInfoManager.zad),function(M){var ra=new Eb;ra.CVf(M);return ra})),e=this.n4b.dEe,0<e.length&&(C=ha.OBc(ha.concat(C,ha.select(ha.asEnumerable(e),
function(M){var ra=new Eb;ra.Shj(M);return ra})),function(M){return M.name},new yf)));if(this.wi.Axb&&this.wi.Tk){if(!this.wi.Tk.length||!this.wi.Tk[0].FieldInfoDataList)return;C=ha.OBc(ha.concat(C,ha.select(ha.asEnumerable(this.wi.Tk[0].FieldInfoDataList),function(M){var ra=new Eb;ra.rij(M);return ra})),function(M){return M.name},new yf);this.columnName=this.wi.Tk[0].ColumnName}this.KFa=ha.toArray(C)};Y.prototype.qBb=function(){var e=$e.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.rsa(e);
if(C){var M=this.$.xa,ra=C.sheet.index;0>=M.count||0>ra||ra>=M.count||(ra=M=null,this.cwd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=$e.g(this.$).Ca.Mr(e))&&(e=this.calcManager.Ndd(e.Gm),void 0!==e&&null!==e&&(M=e.FormatString,ra=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new xa,{colIndex:C.range.col,rowIndex:C.range.row,sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:M,builtIn:ra})))}}};
Y.prototype.rSg=function(){$e.g(this.$).xj?this.Zsb.NT(!1):this.Eob.NT(!1)};Y.prototype.Pef=function(e){var C=ld.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?K.a.isLetter(e):K.a.Nmd(e);return 48<=e&&57>=e||46===e||95===e||C};Y.prototype.show=function(){if(this.Cv){var e=this.Rf.Q$f(0);this.Wm?0<this.Rf.Kr.length?e||this.e0f():this.q0a():((e=0<this.Rf.Kr.length)&&ka.instance.Y6(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&
e&&this.Rf.eXi(this.Rf.Kr.length,this.columnName),this.isListVisible=e,this.Dia.show(this.MP),this.XAa(!0),this.Rf.qxa(),e&&ka.instance.RY(["autoCompleteRender"]))}};Y.prototype.qPi=function(e,C,M,ra,Na){for(M=Object.assign(new Sb,{FBf:41,Zwe:40,csa:M,dsa:ra,pha:Na});C<e.length&&!this.BCf(e,C,M);++C);return M.ODb};Y.prototype.pPi=function(e,C,M){for(--C;0<=C&&!this.BCf(e,C,M);--C);return M.ODb};Y.prototype.BCf=function(e,C,M){var ra=e.charCodeAt(C);0>=this.o3&&(this.o3=e.substring(0,C).lastIndexOf(Ed.a.jU));
46===ra&&(C<this.o3?this.o3=C:C>this.irb&&(this.n3=this.irb=C));if(!this.Pef(ra)&&!Y.ahi(ra)&&(!this.Hja||C<=this.o3||!Y.y1h(ra,M))){M.zsf&&(M.zsf=!1,this.Z1a=C+1);if(M.Ryd){M.gAd=C+1;if(this.functionInfoManager.Rcd(e.substring(M.gAd,M.fAd)))return!0;M.Ryd=!1}switch(ra){case 39:M.dsa=!M.dsa;break;case 34:M.csa=!M.csa;break;case 91:M.pha=!1;break;case 93:M.pha=!0}ra===this.$.listSeparator.toString().charCodeAt(0)&&M.dsa&&M.csa&&!M.PZa&&(!this.Hja||M.pha)&&(C<M.wKd||-1===M.wKd)&&(M.ODb+=1,this.D3b++);
ra===M.Zwe&&M.csa&&M.dsa&&(!this.Hja||M.pha)?M.PZa+=1:ra===M.FBf&&M.csa&&M.dsa&&(!this.Hja||M.pha)?0<M.PZa?--M.PZa:(M.wKd=M.VQe,M.VQe=C,0<C&&this.Pef(e.charCodeAt(C-1))&&(M.Ryd=!0,M.fAd=C)):this.Hja&&46===ra&&C>this.o3&&(C<this.o3?this.o3=C:C>this.irb&&(this.n3=this.irb=C))}return!1};Y.prototype.zuh=function(e,C,M,ra,Na){this.$8b>this.Z1a&&0<=this.Z1a?C||M||(this.rV=e.substring(this.Z1a,this.$8b)):this.rV=null;ra!==Na?(e=e.substring(Na,ra),this.MP&&K.a.equals(this.MP.NameDataStrings,e,!0)||(this.rvc=
!0),this.MP=this.functionInfoManager.Rcd(e)):(this.rvc=!1,this.MP=null)};Y.prototype.m3f=function(e){var C=$get(Za.vCf+"_"+Za.NDb,this.domElement),M=$get(Za.wCf+"_"+Za.NDb,this.domElement);e&&!this.ccc?(C&&Kg.a.instance.pa(Te.a.click,C,this.Qba),M&&Kg.a.instance.pa(Te.a.click,M,this.Qba),this.ccc=!0):this.ccc&&(C&&Kg.a.instance.za(Te.a.click,C,this.Qba),M&&Kg.a.instance.za(Te.a.click,M,this.Qba),this.ccc=!1)};Y.prototype.JFj=function(e){var C=this;var M=null;var ra;if(function(){var id=sg.Z(e,C.$.fa.xa);
Ib=id.sheetName;ra=id.range;return id}().returnValue&&ra){if(!Ib){var Na=Object(qc.a)(hi.a,this.$.oa);if(!Na)return{returnValue:!1,sheetRange:M};var Ib=Na.name}M=sg.v(ra,this.$);M.SheetName=Ib;this.z4c=!1;return{returnValue:!0,sheetRange:M}}var Gc=null;return function(){var id=C.n4b.tFj(e);Ib=id.sheetName;Gc=id.range;return id}().returnValue?(M=sg.v(Gc,this.$),M.SheetName=Ib,this.z4c=!0,{returnValue:!0,sheetRange:M}):{returnValue:!1,sheetRange:M}};Y.prototype.$cc=function(){if(1===this.Rf.XV.length&&
this.Cv.length){var e=this.Cv[this.Rf.XV[0]];if(1===e.itemType){var C=e.name;e=this.qb.text;C=C.substring(e.length,C.length);C.length&&(this.qb.text=e+C,this.qb.textBox.selectRange(e.length,this.qb.text.length))}}else Fd.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Rf.XV.length)};Y.prototype.mic=function(e,C,M,ra){var Na={};Na.a=e;Na.b=C;Na.c=M;Na.d=ra;sd.b().Ne(38,Na,!0)};Y.prototype.Ape=function(e,C){if(!this.functionInfoManager.H4){if(e)if(this.DAd(this.qb.text,
this.qb.textBox.caretPosition),this.hAa||this.rV){var M={};M.Filter=this.rV?this.rV.charAt(0).toString():"";M.FilterType=1;M.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Krb(M)}else ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!C)return}0<this.$.Ab.dR||this.qb&&!this.qb.isEditing?this.set_visible(!1):e&&(this.DAd(this.qb.text,this.qb.textBox.caretPosition),this.Dia.update(this.MP,this.D3b,this.BOc,
this.rvc),this.b5=this.qb.text.substring(1,this.qb.textBox.caretPosition),this.o3=this.b5.indexOf(Ed.a.jU),this.n3=this.b5.lastIndexOf(Ed.a.jU),this.rPi()?(e=new Eb,e.gkj(),this.KFa=this.L7=e=[e],this.Rf.dKj(e),this.show()):((this.Ysh()||this.JLa())&&this.tAe(!1),0<this.n3?this.Rf.NIa(this.Cv,this.b5,!1,void 0,this.b5.lastIndexOf(Ed.a.jU),!1):this.Rf.NIa(this.Cv,this.rV,!1,void 0,this.n3,!1),this.show(),this.Wm&&(this.Rf.Kr.length||$e.g(this.$).Jj.zK?this.Dia.Wqb():(this.Dia.Q8i(),this.Wm&&this.q0a()))))};
Y.prototype.e0f=function(){var e=this;if(0<this.Rf.Kr.length){ka.instance.Y6(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Aq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,$e.g(e.$).Jj.textBox.domElement,e.Ocd())};this.Aq();this.ALa&&this.Rf.Aod&&this.raiseEvent(Y.kad,null);!this.zLa||this.Jkd||this.Rf.Aod||this.raiseEvent("FormulaAutoCompleteShown");this.Vja&&(this.Uq.canReceiveFocus=
!0);this.Jkd=!0}ka.instance.RY(["autoCompleteRender"]);!ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.BRa&&null!==this.BRa&&0<this.BRa.length&&(this.wcb=!0)}};Y.prototype.Prd=function(){this.KHa&&(ka.instance.p2.selectByArrowKeyCounter++,this.KHa=!1);this.LHa&&(ka.instance.p2.selectByMouseHoverCounter++,this.LHa=!1);this.JHa&&(ka.instance.p2.commitByTabKeyCounter++,this.JHa=!1);this.HHa&&(ka.instance.p2.commitByEnterKeyCounter++,this.HHa=!1);
this.IHa&&(ka.instance.p2.commitByMouseClickCounter++,this.IHa=!1)};Y.prototype.Ocd=function(){var e=new na;e.completionItems=this.Rf.p0c;e.activeItemIndex=this.Rf.Nk?this.Rf.Nk.rowIndex:-1;this.AFd(e);return e};Y.prototype.AFd=function(e){e.callbacks=new pa;e.callbacks.onCompletionItemSelected=this.Axd;e.callbacks.onCompletionItemCommitted=this.zxd;e.callbacks.onFeedback=this.tQa;ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(e.callbacks.onDismiss=
this.yld?this.onDismiss:this.q0a)};Y.prototype.mCd=function(e){this.bfa=!0;var C=e.textEdit.newText;this.qb.kcb(C.substring(this.qb.text.length-e.textEdit.range.start.character,C.length))};Y.prototype.cye=function(){this.wy(!0);this.bfa=this.isListVisible=!1;this.fKb=!0};Y.prototype.gkd=function(e,C){this.qb.text=e.substring(0,C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);$e.g(this.$).xj&&($e.g(this.$).Kc.text=this.qb.text)};Y.HJd=function(e){e.requester().runExperiment(new ma)};
Y.UYg=function(e){var C=Eb.r5g(),M={IsCompatibility:!1};M.NameDataStrings=e.label;M.Help=e.detail;C.CVf(M);C.textEdit=e.textEdit;return C};Y.lJa=function(){var e=String.format(Za.rzh,Za.Cad,fk.a.NKe),C=String.format(Za.mzh,Za.Aad,of.a.MKe,pc.a.Ir,pc.a.yu),M=String.format(Za.jzh,Za.vad,of.a.MKe,pc.a.Ir,of.a.zLe,pc.a.yu);return String.format("{0}\r\n{1}\r\n{2}",e,C,M)};Y.ahi=function(e){return 36===e||58===e||33===e||39===e||32===e};Y.y1h=function(e,C){return 32===e||91===e||!C.pha};tl.Object.defineProperties(Y.prototype,
{mt:{configurable:!0,enumerable:!0,get:function(){return this.Rf}},Cv:{configurable:!0,enumerable:!0,get:function(){return this.L7}},PHb:{configurable:!0,enumerable:!0,get:function(){return this.Rf.pe}},zSe:{configurable:!0,enumerable:!0,get:function(){return this.Rf}},fSe:{configurable:!0,enumerable:!0,get:function(){return this.Dia}},Rf:{configurable:!0,enumerable:!0,get:function(){return this.ykg}},rqb:{configurable:!0,enumerable:!0,get:function(){return this.hAa?this.qb?this.qb.text:null:this.rV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.mt.isListVisible},set:function(e){this.Wm&&!e&&this.q0a();this.mt.isListVisible=e}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Asg}},Hja:{configurable:!0,enumerable:!0,get:function(){return 0<this.n3}},DM:{configurable:!0,enumerable:!0,get:function(){return this.bfa}},rZb:{configurable:!0,enumerable:!0,get:function(){return this.b_d}},n3:{configurable:!0,enumerable:!0,get:function(){return this.uGe},
set:function(e){this.uGe=e;e||(this.o3=0)}},Dpj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Jnc){var e=this.$.lc;this.Jnc=!!e&&!e.inEmbedView}return this.Jnc}},dTf:{configurable:!0,enumerable:!0,get:function(){return this.Rf.p0c[this.Rf.Nk.rowIndex]}},HSe:{configurable:!0,enumerable:!0,get:function(){!this.Dad&&this.pluginScheduler&&(this.Dad=this.pluginScheduler.getFunctionsShortDescriptions());return this.Dad}}});Y.kad="FACardOpened";Y.J$c="FAFocusOnSmartSuggestionsCard";Y.nid=null;
Object(td.a)(Y,"FormulaAssistanceControl",Oe.a,[594,595,3,596,597]);var Lh=bi.a;vm(S,Lh);S.prototype.Qke=function(e){this.addHandler("FAFunctionNameUpdated",e)};S.prototype.uMf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};S.prototype.Gle=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};S.prototype.TMf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};S.prototype.Fle=function(e){this.addHandler("FAParameterSelectionChanged",e)};S.prototype.SMf=function(e){this.removeHandler("FAParameterSelectionChanged",
e)};S.prototype.Vzg=function(e){this.addHandler("DC",e)};S.prototype.m4i=function(e){this.removeHandler("DC",e)};S.prototype.get_visible=function(){return this.visible};S.prototype.set_visible=function(e){e||this.dismiss();return this.visible=e};S.prototype.dismiss=function(){this.visible=!1;this.formulaAssistanceUIControl&&(this.Aq=null,this.wQ&&this.VM.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Bka=null,this.Uq.canReceiveFocus=!1)};S.prototype.show=function(e,C){var M=
this;this.visible=!0;this.RSc();var ra=this.WBd(e);this.formulaAssistanceUIControl&&(ka.instance.Y6(["argumentAssistanceRender"]),e={},e.zoomLevel=E(this.$),this.formulaAssistanceUIControl.updateContext(e),ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Aq=function(){M.formulaAssistanceUIControl.renderArgumentAssistanceCard(M.domElement,C,ra)},this.Aq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,C,ra),this.ZAd(ra),this.wQ&&this.VM.ja(this.formulaAssistanceUIControl.getCalloutElement(0),
this.formulaAssistanceUIControl.getDraggableElement(0),this.Aq,function(){return M.formulaAssistanceUIControl.dismiss(M.domElement)}),this.Uq.canReceiveFocus=!0,ka.instance.RY(["argumentAssistanceRender"]),ka.instance.i6b("argumentAssistanceOverall"))};S.prototype.dispose=function(){if(this.$){var e=$e.g(this.$);e&&(e.ha&&e.ha.mF(this.kd),e.view.Wr(this.Ns),this.wQ&&e.rc.Rp(this.Rh))}jf.a.Fa(this.Uq);this.$=null};S.prototype.RSc=function(){$e.g(this.$).Jj.iNb.add(this)};S.prototype.WBd=function(e){var C=
new sa;C.functionRenderingInfo=e;C.cardMode=this.n2;this.CFd(C);return C};S.prototype.CFd=function(e){e.callbacks=new sb;e.callbacks.onHelpLink=this.Zcd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.tQa;this.Maa&&(e.callbacks.onDismissClick=this.onDismissClick)};S.prototype.Zcd=function(e){var C=this;return function(){Nb(C.$,e.helpID,e.isUDF)}};S.prototype.lMd=function(){var e=ug.a.get(Je.a.hZb);this.n2=e?parseInt(e):S.o4c;ka.instance.nUf(this.n2)};
S.prototype.ZAd=function(e){var C=e.functionRenderingInfo.functionName;this.Bka&&K.a.equals(this.Bka,C,!0)?(C=ai.a.map(e.functionRenderingInfo.signatures,function(M){var ra="";0<=M.signatureParams.activeParam&&M.signatureParams.activeParam<M.signatureParams.params.length&&(ra=M.signatureParams.params[M.signatureParams.activeParam]);return ra}),this.raiseEvent("FAParameterSelectionChanged",new Lb(C))):(this.Bka=C,e=ai.a.map(e.functionRenderingInfo.signatures,function(M){return M.signatureParams.params.join(", ")}),
this.raiseEvent("FAFunctionNameUpdated",new Ja(C,e)))};S.prototype.fMb=function(e){this.n2=e;try{ug.a.vw(Je.a.hZb,e.toString(),sh.AFrame.Qda)}catch(C){Fd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",C.message)}};S.lJa=function(){return document.createElement("div")};S.o4c=0;Object(td.a)(S,"FormulaArgumentAssistanceControl",bi.a,[638]);var jh;(function(e){e[e.Dismissed=0]="Dismissed";e[e.Smart=1]="Smart";e[e.Simple=2]="Simple";
e[e.Mixed=3]="Mixed"})(jh||(jh={}));Object(td.b)("UIState",jh);var dj=bi.a;vm(ca,dj);ca.prototype.Oke=function(e){this.addHandler("FACardOpened",e)};ca.prototype.tMf=function(e){this.removeHandler("FACardOpened",e)};ca.prototype.Mke=function(e){this.addHandler("FAFocusOnSmartSuggestionsCard",e)};ca.prototype.rMf=function(e){this.removeHandler("FAFocusOnSmartSuggestionsCard",e)};ca.prototype.Nke=function(e){this.addHandler("FormulaAutoCompleteShown",e)};ca.prototype.sMf=function(e){this.removeHandler("FormulaAutoCompleteShown",
e)};ca.prototype.dispose=function(){if(this.$){var e=$e.g(this.$);e&&(e.ha&&e.ha.mF(this.kd),e.view.Wr(this.Ns));this.$.xa&&this.$.xa.rg(this.Yh)}this.Vja&&jf.a.Fa(this.Uq);this.$=null};ca.prototype.Hzg=function(e){this.addHandler("CVIC",e)};ca.prototype.Z3i=function(e){this.removeHandler("CVIC",e)};ca.prototype.get_visible=function(){return this.visible};ca.prototype.set_visible=function(e){e||this.dismiss();return this.visible=e};ca.prototype.ki=function(e,C){if(!this.get_visible())return!1;this.Naa&&
this.rzc(C);if(this.DM){if(125627505===C||this.Old&&267796030===C)return this.f_a(this.Cv.items[this.$_].textEdit),!this.Old;if(1872288872===C)return this.Hca(),this.set_visible(!1),!0;if(!this.Old&&267796030===C)this.Hca();else if(this.hNi&&(-798660877===C||137938150===C))return!1}e=!1;switch(C){case 1872288872:this.set_visible(!1);e=!0;break;case -798660877:this.aeb(this.Lub(this.$_+1));e=!0;break;case 137938150:this.aeb(this.Lub(this.$_-1));e=!0;break;case 2091832999:this.aeb(this.Lub(this.$_+
8));e=!0;break;case 742457698:this.aeb(this.Lub(this.$_-8));e=!0;break;case 125627505:this.f_a(this.Cv.items[this.$_].textEdit);e=!0;break;case 267796030:ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.f_a(this.Cv.items[this.$_].textEdit),e=!0)}return e};ca.prototype.show=function(e){this.qb=$e.g(this.$).Jj;this.visible=!0;this.RSc();this.$_=0;this.Cv=e;0<this.Cv.items.length&&(this.render(),this.aeb(this.Lub(this.$_)),1===this.Cv.items[0].type&&
this.imd&&(this.wcb=!0))};ca.prototype.Hca=function(){this.bfa=!1;this.qb.CFe()};ca.prototype.render=function(){var e=this;ka.instance.Y6(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Aq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,e.qb.textBox.domElement,e.Ocd())};this.Aq();this.zLa&&(C=this.WLb,this.WLb=this.GTh(this.Cv.items),C!==jh.Dismissed&&C!==jh.Smart||this.WLb!==
jh.Simple&&this.WLb!==jh.Mixed||this.raiseEvent("FormulaAutoCompleteShown"));this.Vja&&(this.Uq.canReceiveFocus=!0);ka.instance.RY(["autoCompleteRender"]);ka.instance.i6b("autoCompleteOverall")}};ca.prototype.RSc=function(){this.qb.iNb.add(this)};ca.prototype.f_a=function(e){this.qb&&this.get_visible()&&(this.gkd(this.qb.text,e),this.qb.textBox.caretPosition=e.range.start.character+e.newText.length,this.DM&&(this.bfa=!1,this.imd&&(this.fKb=!0),this.qb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",
0)),this.set_visible(!1),this.raiseEvent("CVIC"))};ca.prototype.Ocd=function(){var e=new na;e.completionItems=this.Cv.items;e.activeItemIndex=this.$_;this.AFd(e);return e};ca.prototype.AFd=function(e){e.callbacks=new pa;e.callbacks.onCompletionItemSelected=this.Axd;e.callbacks.onCompletionItemCommitted=this.zxd;e.callbacks.onFeedback=this.tQa;ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(e.callbacks.onDismiss=this.yld?this.NBi:this.dismiss)};ca.prototype.mCd=
function(e){this.bfa=!0;var C=e.textEdit.newText;this.qb.kcb(C.substring(this.qb.text.length-e.textEdit.range.start.character,C.length))};ca.prototype.aeb=function(e){var C=this.$_;this.$_=e;var M=this.Cv.items[e];this.DM&&this.Hca();C!==e&&this.render();1===M.type&&ld.EwaSettings.kgc()&&!$e.g(this.$).Jj.text.includes("\n")&&(this.mCd(M),this.imd&&(this.gKb=!0))};ca.prototype.Lub=function(e){return 0>e?0:Math.min(e,this.Cv.items.length-1)};ca.prototype.gkd=function(e,C){this.qb.text=e.substring(0,
C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);$e.g(this.$).xj&&($e.g(this.$).Kc.text=this.qb.text)};ca.prototype.Prd=function(){this.KHa&&(ka.instance.p2.selectByArrowKeyCounter++,this.KHa=!1);this.LHa&&(ka.instance.p2.selectByMouseHoverCounter++,this.LHa=!1);this.JHa&&(ka.instance.p2.commitByTabKeyCounter++,this.JHa=!1);this.HHa&&(ka.instance.p2.commitByEnterKeyCounter++,this.HHa=!1);this.IHa&&(ka.instance.p2.commitByMouseClickCounter++,this.IHa=!1)};ca.prototype.rzc=
function(e){switch(e){case -798660877:case 137938150:case 2091832999:case 742457698:this.KHa=!0;break;case 125627505:this.JHa=!0;break;case 267796030:ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HHa=!0)}};ca.lJa=function(){return document.createElement("div")};ca.prototype.GTh=function(e){return e.reduce(function(C,M){return C|=0===M.type?jh.Simple:jh.Smart},jh.Dismissed)};tl.Object.defineProperties(ca.prototype,{DM:{configurable:!0,
enumerable:!0,get:function(){return this.bfa}},hNi:{configurable:!0,enumerable:!0,get:function(){return 1===this.Cv.items.length&&1===this.Cv.items[0].type}}});Object(td.a)(ca,"FormulaAutoCompleteControl",bi.a,[646,3,596]);ba.prototype.then=function(e,C){return this.promise.then(e,C)};ba.prototype.resolve=function(e){this.oqg(e);return null!=e&&"function"===typeof e.then?this.promise.then():void 0};ba.prototype.reject=function(e){this.Ypg(e);return null!=e&&"function"===typeof e.then?this.promise.then():
void 0};Object(td.a)(ba,"ResolvablePromise",null,[]);O.prototype.getRichValueFieldListContext=function(e,C,M,ra){this.dgf&&e!==this.dgf&&this.wi.uab();this.dgf=e;this.wi.gZ(e,M,ra,C);this.I7b=new ba;this.wi.Axb?this.I7b.resolve(this.wi.Tk):this.x0i();return this.I7b.promise};O.prototype.x0i=function(){this.wi.JXb(this.Oxa);this.wi.tAg(this.quf)};O.prototype.a8f=function(){this.wi.Iqc(this.Oxa);this.wi.G4i(this.quf)};Object(td.a)(O,"ServerDataProvider",null,[619]);Q.prototype.dispose=function(){if(this.$){var e=
$e.g(this.$);e&&(e.ha&&cg.a.bka()&&e.ha.aza(this.Gh),this.Wbf&&e.Ca&&e.Ca.yq(this.Hg))}this.Maa&&($e.g(this.$).rc.Rp(this.Rh),this.TCa.m4i(this.Fqf));this.ppa.Z3i(this.Nqf);this.functionInfoManager&&this.functionInfoManager.Jqc(this.onFunctionInfoLoaded);jf.a.Fa(this.TCa);jf.a.Fa(this.ppa);this.ppa=this.TCa=this.functionInfoManager=this.$=null};Q.prototype.k9i=function(){this.vMa=-1;this.wMa=null};Q.prototype.jza=function(e){var C=this;e=void 0===e?0:e;if(27!==e&&9!==e&&13!==e&&!this.qb.zK){if(this.H4a&&
(ka.instance.Anb.formulaAssistanceRequestAttemptedCounter++,!this.Wpj())){ka.instance.Anb.formulaAssistanceRequestOptimizedCounter++;return}this.functionInfoManager.H4||this.functionInfoManager.Krb({});var M=this.qb;e=M.text;M=M.textBox.caretPosition;!this.Maa||this.fRa?(ka.instance.Y6(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:e,
caretPosition:M},argumentAssistance:{content:e,caretPosition:M}}).then(function(ra){0===ra.kind&&(C.o2e(ra.payload.argumentAssistance),C.W2e(ra.payload.functionSuggestion));return null})):(ka.instance.Y6(["autoCompleteComputation","autoCompleteOverall"]),this.pluginScheduler.requester().functionSuggestion(Object.assign(new Z,{content:e,caretPosition:M})).then(function(ra){0===ra.kind&&C.W2e(ra.payload);return null}))}};Q.prototype.ki=function(){this.jza();return!1};Q.prototype.Wpj=function(){var e=
this.qb,C=e.text;e=e.textBox.caretPosition;if(this.ppa.get_visible()&&K.a.equals(C,this.wMa,!0)&&e===this.vMa)return!1;this.wMa=C;this.vMa=e;return!0};Q.prototype.HJd=function(){this.pluginScheduler.requester().runExperiment(new ma)};Q.prototype.o2e=function(e){e&&this.qb.isEditing?(ka.instance.RY(["argumentAssistanceComputation"]),this.TCa.show(e,this.qb.textBox.domElement)):this.TCa.dismiss()};Q.prototype.W2e=function(e){e&&0<e.items.length&&this.qb.isEditing?(ka.instance.RY(["autoCompleteComputation"]),
this.ppa.show(e)):this.ppa.dismiss()};Q.prototype.qBb=function(){var e=$e.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.rsa(e);if(C){var M=this.$.xa,ra=C.sheet.index;0>=M.count||0>ra||ra>=M.count||(ra=M=null,this.cwd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=$e.g(this.$).Ca.Mr(e))&&(e=this.calcManager.Ndd(e.Gm),void 0!==e&&null!==e&&(M=e.FormatString,ra=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new xa,{colIndex:C.range.col,rowIndex:C.range.row,
sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:M,builtIn:ra})))}else Fd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};Q.prototype.aLj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.zad)};Q.prototype.Sjd=function(){$e.g(this.$).ha.bra(this.Gh);this.qBb();this.HJd();this.ppa.Hzg(this.Nqf);this.pluginScheduler.setServerDataProvider(new O(this.wi,
this.$));this.jza()};tl.Object.defineProperties(Q.prototype,{$Ia:{configurable:!0,enumerable:!0,get:function(){return this.ppa}},eSe:{configurable:!0,enumerable:!0,get:function(){return this.TCa}},qb:{configurable:!0,enumerable:!0,get:function(){return $e.g(this.$).Jj}}});Object(td.a)(Q,"FormulaAssistanceManager",null,[589,3]);var dk=tb.a;vm(I,dk);I.prototype.create=function(){var e=this,C=cg.a.bka(),M=ld.EwaSettings.la(382),ra=ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Na=cg.a.gV(this.$),Ib=this.$.da,Gc=ud.GetServiceTaskFactory.create(Ib,134,this.ma,this.tb),id=ud.GetServiceTaskFactory.Xa(this.$.da,12,477,this.tb);var Uc=cg.a.AM(this.$)?ud.GetServiceTaskFactory.create(this.$.da,449,this.$.ma,1):wg.Task.Ta(null);var Vd=cg.a.bka()?ud.GetServiceTaskFactory.create(this.$.da,414,this.$.ma,1):wg.Task.Ta(null);if(ra||C){var Ye=ud.GetServiceTaskFactory.Xa(Ib,266,265,this.tb),Gf=ud.GetServiceTaskFactory.Xa(Ib,219,220,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([Ye,
Vd,Uc,Gf],this.ma),function(){var Dg=Ib.Aa(19)||new Da(e.$,Vd.result),Eg=Gf.result;if(Na){var Ch=Ib.Aa(464);Ch||(Ch=new Q(e.$,Dg,Ye.result,Vd.result,Uc.result,id.result.X1c(e.$,Gc.result)),Eg.CVc(Ch.eSe),Eg.DVc(Ch.$Ia))}else Ch=Ib.Aa(221),Ch||(Ch=new Y(e.$,Dg,Gc.result,Ye.result,null,id.result,Uc.result,Vd.result),Eg.CVc(Ch.fSe),Eg.Rpe(Ch.zSe),Eg.DVc(Ch)),M&&(Ib.Aa(317)||new Ic(e.$));e.Fb(Dg)},this.ma,3)}else{var rg=ud.GetServiceTaskFactory.Xa(Ib,219,220,this.tb);xf.TaskExtensions.Ba(xf.TaskExtensions.ve([rg,
Uc,Vd],this.ma),function(){var Dg=Ib.Aa(19)||new Da(e.$,Vd.result),Eg=rg.result,Ch=Ib.Aa(221);Ch||(Ch=new Y(e.$,Dg,Gc.result,null,null,id.result,Uc.result,Vd.result),Eg.CVc(Ch.fSe),Eg.Rpe(Ch.zSe),Eg.DVc(Ch));M&&(Ib.Aa(317)||new Ic(e.$));e.Fb(Dg)},this.ma,3)}};I.ja=function(e){e.da.Ha(153,new I(e))};Object(td.a)(I,"FunctionInfoManagerFactory",tb.a,[]);var mk=b(200),Oj=b(74),nk=b(113);R.prototype.cWe=function(){return nk.a(Wg.a.Ra,this.startTime)};Object(td.a)(R,"OngoingAction",null,[]);var Ak=Oj.a;
vm(W,Ak);W.prototype.eEb=function(e){Fd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Kka,this.$Ka,this.D4a);this.Fmb=this.Iug.Dmb(e,this.Fmb);this.qkd()};W.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.dGb(this.Nxa);this.fue();Ak.prototype.dispose.call(this)};W.prototype.qWf=function(e){this.mXc?(this.hOa=e?new R:null,e?this.startTimer():this.fue()):
this.hOa=e?{}:null};W.prototype.LQe=function(e){e=void 0===e?null:e;this.mXc&&e&&e.TJ?Fd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.Kka):(Fd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Kka,this.$Ka,this.D4a),this.qWf(!1),this.qkd())};W.prototype.qkd=function(){var e=this;if(!this.lRa()){var C=this.Fmb;this.Fmb=null;this.qWf(!0);Fd.ULS.sendTraceTag(537153857,
0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.Kka);var M=this.mXc?this.hOa.Ww.token:mk.a.none;xf.TaskExtensions.Ba(this.Hug.dEb(C),function(){e.LQe(M)},M,0,this.aO)}};W.prototype.lRa=function(){return!this.D4a||this.$Ka?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.kj?(Fd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.Kka),!0):!1};W.prototype.fue=function(){this.dnc&&
this.dnc.cancel()};W.prototype.startTimer=function(){this.nXc<=this.Fse&&(this.dnc=Nd.a.instance.create(this.tJi,this.fOg,Ud.a.yhe))};tl.Object.defineProperties(W.prototype,{$Ka:{configurable:!0,enumerable:!0,get:function(){return!!this.hOa}},D4a:{configurable:!0,enumerable:!0,get:function(){return!!this.Fmb}}});Object(td.a)(W,"ActionAggregator",Oj.a,[648,3]);var sk=b(121),Pi=Zg.a;vm(ia,Pi);ia.prototype.TAg=function(e){this.addHandler("KBIS",e)};ia.prototype.Y4i=function(e){this.removeHandler("KBIS",
e)};ia.prototype.dispose=function(){this.firstElement&&T.a.removeHandler(this.firstElement,Te.a.focus,this.Ntf);this.ds&&this.ds.detach("focus");this.ho&&(T.a.removeHandler(this.ho,Te.a.focus,this.Gvf),T.a.removeHandler(this.ho,Te.a.blur,ia.onBlur),hk.KeyInputManager.instance.za(Te.a.Rb,this.ho,this.Hvf));hk.KeyInputManager.instance.za(Te.a.Rb,this.$.domElement,this.jBf);this.ds=this.ho=this.firstElement=this.$=null;Pi.prototype.dispose.call(this)};ia.prototype.E1g=function(){this.koj?(this.firstElement=
document.documentElement,this.ds=sk.a.instance.VD(document.parentWindow),this.ds.ja("focus",this.QMi)):(this.firstElement=ia.WAe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),T.a.addHandler(this.firstElement,Te.a.focus,this.Ntf))};ia.prototype.D2g=function(){this.ho=ia.WAe();this.ho.id=Je.a.WHe;this.ho.setAttribute(Je.a.Bv,Ae.a.instance.ea(842));document.body.appendChild(this.ho);T.a.addHandler(this.ho,Te.a.focus,this.Gvf);T.a.addHandler(this.ho,Te.a.blur,ia.onBlur);
hk.KeyInputManager.instance.pa(Te.a.Rb,this.ho,this.Hvf)};ia.prototype.hsh=function(e){this.x6f(e);return!1};ia.prototype.mCi=function(){this.yLa=!0;$e.g(this.$).focus();$e.g(this.$).ha.O2e();this.raiseEvent("KBIS");return!0};ia.prototype.x6f=function(e){this.yLa?this.yLa=!1:(this.yLa=!0,e&&e.focus())};ia.WAe=function(){var e=document.createElement("div");e.tabIndex=0;return e};ia.I5e=function(){document.body.classList.add(pc.a.uKe)};ia.onBlur=function(){document.body.classList.remove(pc.a.uKe)};
Object(td.a)(ia,"EmbedViewFocusControl",Zg.a,[647,3]);var Vi=b(58),ki=b(527),Ai=Zg.a;vm(P,Ai);P.prototype.JXb=function(e){this.addHandler("FieldInfoListContextLoaded",e)};P.prototype.Iqc=function(e){this.removeHandler("FieldInfoListContextLoaded",e)};P.prototype.tAg=function(e){this.addHandler("GetFieldInfoListContextOperationFailed",e)};P.prototype.G4i=function(e){this.removeHandler("GetFieldInfoListContextOperationFailed",e)};P.prototype.dispose=function(){this.vb=null;this.uab();Ai.prototype.dispose.call(this)};
P.prototype.gZ=function(e,C,M,ra){ra=void 0===ra?null:ra;if(e){this.gYc();var Na=null,Ib=!1,Gc;if(Gc=!ra)Gc=this.lFj(e,C,M),Ib=Gc.TDb,Na=Gc.Tk,Gc=Gc.returnValue;if(Gc&&(Na&&Fd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",Na.length),this.HKc=!0,(this.k1=Na)&&0<this.k1.length&&(this.JRb=!0,this.mHf()),!Ib))return;this.i$f(e,ra,C,M,!1)}};P.prototype.i$f=function(e,C,M,ra,Na){if(this.$.fa.oc){this.$.Ub&&(this.TGb=this.$.Ub.Fc("WebServiceCall","GetRichValueFieldInfoListContext"));
this.Vtb=null;var Ib=this.$.qa.ta.Xb(),Gc=this.$.qa.ta,id=this.GDi,Uc=this.FDi,Vd=Gc.Oa(1,null);Vd.selectedRange=e;Vd.richValueKeyPath=C;Vd.singleColumn=M;Vd.searchForRange=ra;Vd.calculateMajorityDataType=Na;this.Vtb=vf.i(Gc,"GetRichValueFieldListContextList",Vd,id,Uc,null,Ib,4)}else this.k1=null};P.prototype.uab=function(){this.k1=null;this.JRb=!1;this.gYc();this.Vtb=null};P.prototype.gYc=function(){P.a0b(this.Vtb)};P.prototype.mHf=function(){this.raiseEvent("FieldInfoListContextLoaded")};P.prototype.eo=
function(e){e=sg.D(e);--e.left;--e.right;return this.tableManager.eo(e)};P.prototype.lFj=function(e,C,M){var ra=null;var Na=!1;if(e.SheetName!==this.$.fa.oa.sheetName)return{returnValue:!1,TDb:Na,Tk:ra};if(M){var Ib=this.eo(e);if(!Ib||!Ib.mva)return{returnValue:!1,TDb:Na,Tk:ra};Ib.top+=1;Ib.right=sg.D(e).right-1}else Ib=new ki.AutofilterRange(e.FirstRow+1,e.FirstColumn+1,e.LastRow+1,e.LastColumn+1,null,null,null,0,!1);if(Ib.top>Ib.bottom||Ib.left>Ib.right)return{returnValue:!0,TDb:Na,Tk:ra};e=$e.g(this.$);
var Gc=e.$a.width,id=e.$a.height,Uc=e.view.visibleArea;Gc=new Vi.a(Uc.x-Gc,Uc.y-id,Uc.width+Gc,Uc.height+id);id=e.Lg(Ib);if(!Uc||!id||!e.bgc(Ib))return{returnValue:!1,TDb:Na,Tk:ra};Gc.contains(id)||(Na=!0);e=Ib.clone();if(M)for(M=Ib.right,Uc=0;M>=Ib.left;--M){if(e.left=M,e.right=M,Gc=this.sWe(e,!0,Ib.left)){ra||(ra=[]);ra[Uc]=Gc;if(C)break;++Uc}}else if(C=this.sWe(e,!1))ra=[],ra[0]=C;return{returnValue:!0,TDb:Na,Tk:ra}};P.prototype.sWe=function(e,C,M){M=void 0===M?0:M;var ra=null;if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Na=
$e.g(this.$).Vb.rQh(e);if(Na&&0<Na.count){var Ib=Array(Na.count),Gc=0;Na=yl(Na.values);for(ra=Na.next();!ra.done;ra=Na.next()){var id={};id.Name=ra.value;Ib[Gc]=id;++Gc}Gc="";Na=-1;0<e.top&&C&&(e=new Ug.Range(e.top-1,e.left,e.top-1,e.left,!1,!1),Gc=$e.g(this.$).sc(e).originalText,Na=e.left-M);ra={};ra.ColumnName=Gc;ra.ColumnIndex=Na;ra.FieldInfoDataList=Ib}}else if((Na=$e.g(this.$).Vb.sQh(e))&&0<Na.count){Ib=Array(Na.count);Gc=0;Na=yl(Na);for(ra=Na.next();!ra.done;ra=Na.next())id={},id.Name=ra.value,
Ib[Gc]=id,++Gc;Gc="";Na=-1;0<e.top&&C&&(e=new Ug.Range(e.top-1,e.left,e.top-1,e.left,!1,!1),Gc=$e.g(this.$).sc(e).originalText,Na=e.left-M);ra={};ra.ColumnName=Gc;ra.ColumnIndex=Na;ra.FieldInfoDataList=Ib}return ra};P.a0b=function(e){e&&jd.AFrameworkApplication.Hd.Zt(e.kt)};tl.Object.defineProperties(P.prototype,{Axb:{configurable:!0,enumerable:!0,get:function(){return this.JRb}},Cli:{configurable:!0,enumerable:!0,get:function(){return this.HKc}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},
Tk:{configurable:!0,enumerable:!0,get:function(){return this.k1}},zIh:{configurable:!0,enumerable:!0,get:function(){return!!this.Vtb}}});Object(td.a)(P,"FieldInfoManager",Zg.a,[611,3]);vm(N,P);N.prototype.JIh=function(e,C){this.F0a=C;Fd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",e.FirstRow,e.FirstColumn,e.LastRow,e.LastColumn);this.i$f(e,null,!0,!1,!0)};tl.Object.defineProperties(N.prototype,
{lG:{configurable:!0,enumerable:!0,get:function(){return this.Sgg}}});Object(td.a)(N,"FilterInfoManager",P,[615,611,3]);U.umh="ewa-sharedUi-launchButton";U.wmh="ewa-sharedUi-launchButtonWithText";U.vmh="ewa-sharedUi-launchButtonClick";U.xmh="ewa-sharedUi-launchButtonWithTextClick";Object(td.a)(U,"CssClassNames",null,[]);var pj=b(279),Pj=bi.a;vm(B,Pj);B.prototype.f2=function(e){this.addHandler(this.mEb,e)};B.prototype.Jca=function(e){this.get_events().removeHandler(this.mEb,e)};B.prototype.jBg=function(e){this.addHandler("OnObjectButtonMouseOver",
e)};B.prototype.n5i=function(e){this.get_events().removeHandler("OnObjectButtonMouseOver",e)};B.prototype.iBg=function(e){this.addHandler("OnObjectButtonMouseOut",e)};B.prototype.m5i=function(e){this.get_events().removeHandler("OnObjectButtonMouseOut",e)};B.prototype.o9f=function(e){e&&(this.aZa.innerHTML=e)};B.prototype.rIj=function(e,C,M){this.aZa.innerHTML="";e?e.Haa(C,16,16,this.aZa,16,16,void 0,M):Fd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};
B.prototype.sIj=function(e,C){e&&(this.fLb.innerText=e);this.domElement.title=C};B.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.wc.kA(),jf.a.pc([this.LY,this.TYa]),Kg.a.instance.za(Te.a.click,this.domElement,this.Vc),oj.a.instance.za(Te.a.pointerDown,this.domElement,this.dN),this.tRa&&this.tRa.dispose(),Pj.prototype.dispose.call(this))};B.prototype.rab=function(){this.X0b&&this.domElement.classList.remove(this.X0b);this.pkc&&this.domElement.classList.add(this.pkc)};B.prototype.lEb=
function(){this.pkc&&this.domElement.classList.remove(this.pkc);this.X0b&&this.domElement.classList.add(this.X0b);this.T0a()};B.prototype.T0a=function(){this.wgc&&(this.tRa.cancel(),this.x2f(),this.setOpacity(1));this.set_visible(!0)};B.prototype.so=function(e,C,M,ra,Na){Na=void 0===Na?!1:Na;e=we.a(ra).Fi(e);C=we.a(ra).Fi(C);we.a(ra).vuc(this.domElement);this.domElement.style.top=ab.HelperMethods.Qb(C);this.domElement.style.left=this.domElement.style.right="";C=e;Na&&(C=e-this.domElement.offsetWidth);
Wj.c(this.domElement.style,M,ab.HelperMethods.Qb(C));this.set_visible(!0);this.setOpacity(1);this.wgc&&(this.OPd=!1,this.ixj(),this.tRa.Bq())};B.prototype.hide=function(){this.rab();this.set_visible(!1);this.wgc&&(this.x2f(),this.tRa.cancel())};B.prototype.b6b=function(){this.wc.ja("mouseover",this.ZE,!0);this.wc.ja("mouseout",this.HH,!0)};B.prototype.ixj=function(){this.LY.Bt("mousemove")||this.LY.ja("mousemove",this.Mxa)};B.prototype.x2f=function(){this.LY.Bt("mousemove")&&this.LY.detach("mousemove")};
B.prototype.Ggd=function(e){if(this.domElement.parentNode){var C=Sys.UI.DomElement.getBounds(this.domElement),M=new Sys.UI.Point(Math.round(C.x+C.width),Math.round(C.y+C.height));C=Math.abs(M.x-e.x);e=Math.abs(M.y-e.y);e=C>e?C:e;this.OPd?this.setOpacity(B.gPg(e)):100>=e&&this.Lhe()}};B.prototype.Lhe=function(){this.OPd=!0;this.tRa.cancel()};B.prototype.setOpacity=function(e){Mf.a.setOpacity(this.domElement,e);this.rgf=Wg.a.Ra.Kb};B.gPg=function(e){return 100>=e?1:250<=e?0:.01*(100-(e-100)/150*100)};
Object(td.a)(B,"OnObjectButton",bi.a,[624,361,3]);var jk=b(924),ok=Oj.a;vm(w,ok);w.prototype.dispose=function(){this.Abh();this.$=null;ok.prototype.dispose.call(this)};w.prototype.getButton=function(e,C){return this.sua(e,void 0===C?!0:C)};w.prototype.sua=function(e,C){var M=e.toString();M in this.buttons||this.F2g(e,void 0===C?!0:C);return this.buttons[M]};w.prototype.so=function(e,C,M,ra,Na,Ib){Na=void 0===Na?!0:Na;Ib=void 0===Ib?!1:Ib;this.hide();if(this.$.fa.isNamedObjectViewMode&&eh.i(this.$.oa)){var Gc=
$e.g(this.$).FN.domElement,id=e+this.buttonWidth-Gc.scrollWidth;Gc=C+this.buttonWidth-Gc.scrollHeight;e=0<id?e-id:e;C=0<Gc?C-Gc:C}this.sua(ra,Na).so(e,C,M,this.$,Ib)};w.prototype.hide=function(){var e=this.buttons,C;for(C in e)e[C].hide()};w.prototype.b6b=function(e,C){!this.i6e&&(C=this.buttons[C.toString()])&&(this.Njc=function(M,ra){e(ra,!0)},C.jBg(this.Njc),this.Mjc=function(M,ra){e(ra,!1)},C.iBg(this.Mjc),this.i6e=!0,C.b6b())};w.prototype.F2g=function(e,C){function M(Ib,Gc){ra.oAi(Gc,e)}var ra=
this;this.Eva=String.format(this.Rid===pc.a.O6b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',bh.a.If(this.Rid),bh.a.If(this.Qid),"{0}");var Na=String.format(this.Eva,bh.a.If(this.altText));C=new B(""===this.buttonText?U.umh:U.wmh,""===this.buttonText?U.vmh:U.xmh,pc.a.OB,Na,C,this.mEb,this.buttonText,"ewa-sharedUi-launchButtonText");C.f2(M);this.buttons[e.toString()]=C;this.JJe[e.toString()]=
M;Na=$e.g(this.$).fg(e);Na.domElement.insertBefore(C.domElement,Na.domElement.firstChild)};w.prototype.Abh=function(){for(var e=yl(jk.a(this.buttons)),C=e.next();!C.done;C=e.next()){C=C.value;var M=this.buttons[C];M.Jca(this.JJe[C]);jf.a.Fa(M);delete this.buttons[C];this.Njc&&M.n5i(this.Njc);this.Mjc&&M.m5i(this.Mjc)}};w.prototype.domElement=function(e){return this.sua(e).domElement};w.prototype.T0a=function(e){this.sua(e).T0a()};w.prototype.DMb=function(e,C,M){M=void 0===M?!0:M;this.Eva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
bh.a.If(this.Rid),bh.a.If(this.Qid),"{0}");e=String.format(this.Eva,bh.a.If(e));this.sua(C,M).o9f(e)};w.prototype.LSa=function(e,C,M){this.sua(M,!1).sIj(e,C)};w.prototype.f$f=function(){var e=void 0===e?!1:e;this.Eva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",bh.a.If(this.Qid),"{1}");var C=String.format(this.Eva,void 0,bh.a.If(void 0));this.sua(void 0,e).o9f(C)};w.prototype.g$f=function(e,C,M){this.sua(M,!1).rIj(this.svgIconProvider,
e,C)};tl.Object.defineProperties(w.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return we.a(this.$).nFa(Mi.a.JHi)}},x0b:{configurable:!0,enumerable:!0,get:function(){return Mi.a.IHi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return we.a(this.$).nFa(Mi.a.KHi)}}});Object(td.a)(w,"OnObjectLaunchButton",Oj.a,[618,3]);var Yj=b(83),Tk=Yj.a;vm(G,Tk);G.prototype.dispose=function(){jf.a.Fa(this.$zb);this.$zb=null;Tk.prototype.dispose.call(this)};G.prototype.jAa=function(){jf.a.Fa(this.$zb);
this.$zb=Nd.a.instance.create(Object(xb.a)(this,this.display,"display"),this.r2h,Ud.a.Gli)};G.prototype.NRa=function(){jf.a.Fa(this.$zb);this.hide()};Object(td.a)(G,"LoadingIndicatorBehavior",Yj.a,[625,3]);vm(r,G);r.prototype.dispose=function(){this.Zzb=null;G.prototype.dispose.call(this)};r.prototype.display=function(){this.ljg(this.Zzb)};r.prototype.hide=function(){this.G_h(this.Zzb)};r.prototype.Ywg=function(){this.Zzb=document.createElement("div");this.domElement.appendChild(this.Zzb)};Object(td.a)(r,
"ShimmerLoadingIndicatorBehavior",G,[]);vm(z,G);z.prototype.dispose=function(){this.OMa=null;G.prototype.dispose.call(this)};z.prototype.display=function(){Le.DOMElementExtensions.setVisible(this.OMa,!0)};z.prototype.hide=function(){Le.DOMElementExtensions.setVisible(this.OMa,!1)};z.prototype.Xwg=function(){this.OMa=document.createElement("div");this.OMa.classList.add(bk.a.qlh);var e=document.createElement("div");e.classList.add(bk.a.rlh);this.v3c&&""!=this.v3c&&e.classList.add(this.v3c);var C=this.fif?
Ae.a.instance.ea(this.fif):"",M=String.format('<div class="'+bk.a.slh+'">{0}</div>',C);this.Zcc?(C=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.Zcc,C),e.innerHTML=C+M):e.innerHTML=M;this.OMa.appendChild(e);this.domElement.appendChild(this.OMa)};Object(td.a)(z,"SpinnerLoadingIndicatorBehavior",G,[]);t.prototype.u2c=function(e,C,M){return new Xj.a(e,C,M)};t.prototype.W2b=function(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd){return new db(e,C,M,ra,Na,Ib,Gc,id,Uc,Vd)};t.prototype.B_a=function(e,C,M,ra,
Na){return new z(e,C,M,ra,void 0===Na?0:Na)};t.prototype.Xdd=function(e){return e.da.Aa(238)||new ia(e)};t.prototype.Z2b=function(e,C,M,ra,Na,Ib,Gc,id){return new w(e,C,M,ra,Na,Ib,Gc,void 0===id?"":id)};t.prototype.X1c=function(e,C){return new P(e,C)};t.prototype.A1g=function(e,C,M,ra){return new N(e,C,M,ra)};t.prototype.Qpb=function(e,C,M,ra){return new W(e,C,M,ra)};Object(td.a)(t,"SharedUIControlsFactory",null,[588]);var dl=tb.a;vm(x,dl);x.prototype.create=function(){ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1)?this.Fb(this.$.da.Aa(12)||new t):this.Fb(new t)};x.ja=function(e){e.da.Ha(477,new x(e))};Object(td.a)(x,"SharedUIControlsFactoryServiceFactory",tb.a,[]);var il=b(1023),cl=tb.a;vm(A,cl);A.prototype.create=function(){var e=this;Fd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");il.a.then(this.Z3g(),function(C){e.Fb(C);return!0})};A.prototype.Z3g=function(){var e=this;if(this.b3b)return this.b3b;var C=Pf.a.E_a(sd.b(),mk.a.none,"LoadResource","x10Scheduler loading");
if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Mf.a.Ku){var M=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,M);C.setResult(M);return this.b3b=C.task}this.$.da.Za(266,function(){e.$.da.Za(283,function(ra){var Na=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();ra=qe.b(wg.Task.Ta(ra.wo));if(ld.EwaSettings.isChangeGateEnabled("OfficeVSO:6035660_attachX10PluginsOnOouiSide"))excelOnlineCalc.x10.ensureAllPluginsAttached(ra).then(function(){e.$.da.Ha(413,
Na);C.setResult(Na)});else{var Ib=excelOnlineCalc.x10.ensurePluginAttached(1,ra),Gc=excelOnlineCalc.x10.ensurePluginAttached(5,ra),id=excelOnlineCalc.x10.ensurePluginAttached(1E3,ra),Uc=excelOnlineCalc.x10.ensurePluginAttached(1002,ra),Vd=excelOnlineCalc.x10.ensurePluginAttached(10,ra),Ye=excelOnlineCalc.x10.ensurePluginAttached(11,ra),Gf=excelOnlineCalc.x10.ensurePluginAttached(12,ra),rg=excelOnlineCalc.x10.ensurePluginAttached(13,ra),Dg=excelOnlineCalc.x10.ensurePluginAttached(1004,ra);Ib=[Ib,Gc,
id,Uc,Vd,Ye,rg,Dg,Gf];ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(ra=excelOnlineCalc.x10.ensurePluginAttached(1003,ra),Ib.push(ra));Promise.all(Ib).then(function(){e.$.da.Ha(413,Na);C.setResult(Na)})}})});return this.b3b=C.task};A.ja=function(e){e.da.Ha(414,new A(e))};Object(td.a)(A,"PluginSchedulerFactory",tb.a,[]);var Bk=Oj.a;vm(m,Bk);m.prototype.dispose=function(){this.xp.dispose();this.$=null;Bk.prototype.dispose.call(this)};m.prototype.domElement=function(e){return this.xp.domElement(e)};
m.prototype.getButton=function(e){return this.xp.getButton(e,!1)};m.prototype.DMb=function(e,C){this.xp.DMb(e,C,!1)};m.prototype.aAa=function(e,C){var M=$e.g(this.$),ra=M.$a.Kj(e);this.xp.DMb(C?Ae.a.instance.ea(1684):Ae.a.instance.ea(1685),ra);C=this.isMac?C?Ae.a.instance.ea(1688):Ae.a.instance.ea(1689):C?Ae.a.instance.ea(1686):Ae.a.instance.ea(1687);var Na=M.Lg(e,ra);e=M.fg(ra).Cn;if(Na&&0<=Na.x&&0<=Na.y){var Ib=Na.bottomRight.x+this.Uy;Na=Na.topLeft.y-this.Uy-this.buttonWidth;if(Na<e.topLeft.y+
this.Uy){if(M.$a.rSa){this.hide();return}Na=e.topLeft.y+this.Uy}this.so(Ib,Na,M.rtl,ra);this.ariaLiveNotifier.ePa(C)}else this.hide()};m.prototype.so=function(e,C,M,ra){this.xp.so(e,C,M,ra,!1)};m.prototype.hide=function(){this.xp.hide()};tl.Object.defineProperties(m.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.xp.Uy}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.xp.buttonWidth}}});Object(td.a)(m,"PulloutLaunchButton",Oj.a,[]);var Rk=Oj.a;vm(v,Rk);
v.prototype.dispose=function(){this.gridView&&(this.gridView.ha.Nca(this.Sh),this.gridView.view.Wr(this.Ns),this.gridView.Kc&&this.gridView.Kc.im(this.Mj));if(this.$){var e=this.$;e.ml(this.od);e.En(this.qd);e.RC(this.aj);$e.g(e).Us(this.ZQ)}this.wi&&this.wi.Iqc(this.Oxa);jf.a.Fa(this.Nh);this.wi=this.$=this.gridView=this.mnb=this.Nh=null;Rk.prototype.dispose.call(this)};v.prototype.wx=function(){this.Nh.hide()};v.prototype.Uca=function(){this.Nh?this.Nh.getButton(this.Yda).rab():Fd.ULS.sendTraceTag(537154142,
0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};v.prototype.M9i=function(){this.R_=null};v.prototype.UFf=function(){this.Nh&&this.Nh.hide()};v.prototype.lUh=function(){if(!this.jgd||1!==this.selectedRange.width)return null;for(var e=this.selectedRange.clone();this.gridView.GZ(e);){e.left+=1;e.right+=1;if(!this.gridView.fg(this.gridView.$a.Kj(e)).Ph.Jf(e))break;if(this.gridView.Ca.Mr(e)){var C=this.gridView.sl("PulloutManager.GetValidatedRangeToFill",e,2);try{if(v.aNj(C))return e}finally{C&&
C.dispose()}}}return null};v.prototype.Jrc=function(){this.wi.uab()};v.prototype.showCallout=function(){var e=this;this.Nva&&(this.wi.Axb?(this.Nh.getButton(this.Yda).lEb(),ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?xf.TaskExtensions.Ba(ud.GetServiceTaskFactory.Xa(this.$.da,8,9,0),function(C){e.$Zf(C.result)},this.$.ma,3):this.$Zf(this.contextMenuManager)):(this.jXc=!0,this.gZ()))};v.prototype.$Zf=function(e){e.Qbd("tableFieldList").VN(null,this.Nh.domElement(this.Yda),
this.wi,null,!0);this.Jrc()};v.prototype.CQe=function(){if(!this.Nva||!this.gridView||this.gridView.ha.Qa.nc||!this.gridView.ha.va.Dh)return null;var e=this.gridView.ha.va.activeCell,C=$e.g(this.$).$a.Kj(e);if(!e)return null;this.NEa=e.clone();var M=this.tableManager.eo(e);this.BJc=!!M;if(this.KM){this.Nh.DMb(Ae.a.instance.ea(1684),C);this.jO=v.lbg(M);if(!this.jO)return null;C=this.tableManager.Wze(M,this.gridView);e=C.eY;C=C.returnValue||e;this.FCc=e;if(C)return this.Wsc=new Ug.Range(M.top,M.left,
M.bottom,M.right,!1,!1),this.OLc=new Ug.Range(this.jO.top,this.jO.right+1,this.jO.top,this.jO.right+1,!1,!1),this.jO}else if(this.jgd){this.Nh.DMb(Ae.a.instance.ea(1685),C);this.uWa=this.gridView.ha.va.Qd.clone();M=$e.g(this.$).Vb.YLa(this.selectedRange);this.jO=v.lbg(this.selectedRange);if(!M||!this.jO||!this.selectedRange||ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.NJa(this.selectedRange))return null;this.OLc=this.lUh();if((ld.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.GZ(this.selectedRange):this.gridView.GZ(this.jO))&&this.zxa)return this.Wsc=this.jO,M=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.zxa?this.zxa.toString():"null",this.jO?this.jO.toString():"null",e?e.toString():"null"),Fd.ULS.sendTraceTag(537154137,0,50,M),this.jO}return null};v.prototype.gZ=function(){this.KM?this.wi.gZ(sg.v(this.zxa,this.$),!1,!0):ld.EwaSettings.la(135)&&this.wi.gZ(sg.v(this.selectedRange,this.$),!0,!1)};
v.prototype.v5a=function(){return this.$.fa.isNamedObjectViewMode&&eh.f(this.$.oa)};v.aNj=function(e){for(;e.$$mn();)if(e.$$cu().text||e.$$cu().VJ||e.$$cu().kj||e.Vn.s4e)return!1;return!0};v.lbg=function(e){return e.right===Mi.a.Qh?null:new Ug.Range(e.top,e.right,e.top,e.right,!1,!1)};tl.Object.defineProperties(v.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Nh.domElement(1)}},zxa:{configurable:!0,enumerable:!0,get:function(){return this.OLc}},selectedRange:{configurable:!0,
enumerable:!0,get:function(){return this.uWa}},KM:{configurable:!0,enumerable:!0,get:function(){return this.BJc}},Gzb:{configurable:!0,enumerable:!0,get:function(){var e=this.Nh.domElement(this.Yda);return e?Le.DOMElementExtensions.isVisible(e):!1}},Nva:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&ld.EwaSettings.la(135)?!(new Oh.a(this.$.xa)).ik:!1}},sDg:{configurable:!0,enumerable:!0,get:function(){return this.FCc}},Yda:{configurable:!0,enumerable:!0,get:function(){return this.zxa?
this.gridView.$a.Kj(this.jO):1}}});Object(td.a)(v,"PulloutManager",Oj.a,[586,3]);var pk=tb.a;vm(u,pk);u.prototype.create=function(){var e=this;ph.a.Ga(function(C){var M=ud.GetServiceTaskFactory.Xa(C.da,12,477,e.tb),ra=ud.GetServiceTaskFactory.Xa(C.da,66,134,e.tb),Na=ud.GetServiceTaskFactory.Xa(C.da,211,212,e.tb),Ib=null,Gc=!ld.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);Gc&&(Ib=ud.GetServiceTaskFactory.Xa(C.da,8,9,e.tb));xf.TaskExtensions.Ba(xf.TaskExtensions.ve([M,
ra,Ib,Na],C.ma),function(){Gc?e.Fb(e.$.da.Aa(261)||new v(e.$,M.result,ra.result,Ib.result,Na.result)):e.Fb(e.$.da.Aa(261)||new v(e.$,M.result,ra.result,null,Na.result))},C.ma)})};u.ja=function(e){e.da.Ha(262,new u(e))};Object(td.a)(u,"PulloutManagerFactory",tb.a,[]);var $k=b(383);Object(td.a)(f,"GestureAdapterInfo",null,[]);var el=b(373),Xi=b(221);l.prototype.$ki=function(){if(!this.wFc){var e="hammer.min.js";jd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",
!1)&&(e=jd.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");e=jd.AFrameworkApplication.C6(String.format("{0}",e),5);e=Xi.a.create(e,null,null);el.a.bia(e);this.wFc=e.U6a}return this.wFc};tl.Object.defineProperties(l,{instance:{configurable:!0,enumerable:!0,get:function(){l.Na||(l.Na=new l);return l.Na}}});l.Na=null;Object(td.a)(l,"HammerJsDependencyLoader",null,[609]);var wj;(function(e){e[e.none=-1]="none";e[e.pinch=0]="pinch";e[e.pan=1]="pan";e[e.swipe=2]="swipe"})(wj||
(wj={}));Object(td.b)("GestureEvent",wj);var J=b(71),oa=J.a;vm(n,oa);n.create=function(e,C,M,ra,Na,Ib){if(M.rawEvent)if(Ib){var Gc=M.rawEvent;Gc=new Sys.UI.Point(Gc.clientX,Gc.clientY)}else Gc=J.a.Gtb(M);else Gc=new Sys.UI.Point(M.clientX,M.clientY);return new n(e,Gc,C,M,ra,Na,M.shiftKey,M.ctrlKey,Ib)};tl.Object.defineProperties(n.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.Lfa}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.oX}},clientPoint:{configurable:!0,
enumerable:!0,get:function(){return this.Xfb}},mua:{configurable:!0,enumerable:!0,get:function(){return this.Ikg}}});Object(td.a)(n,"GestureEventArgs",J.a,[]);Object(td.a)(k,"GestureManagerData",null,[]);c.ffg=2;c.gfg=4;c.hfg=8;c.ifg=8;Object(td.a)(c,"HammerConstants",null,[]);var Va=b(198),Ub=T.a;vm(d,Ub);d.prototype.QJh=function(){return this.WMc?0:this.Yfe?1:2};d.prototype.dn=function(e){Ub.prototype.dn.call(this,e);this.Ud.Lja(this.TUa,e,0,this.ijb)};d.prototype.Yl=function(e){Ub.prototype.Yl.call(this,
e);this.Ud.AHa(e,this.TUa)};d.prototype.F0i=function(e,C,M){var ra=this;M=void 0===M?null:M;var Na=void 0===Na?null:Na;jd.AFrameworkApplication.xfc()?l.instance.$ki().continueWith(function(Ib){ra.txj();if(Ib.jg||Ib.Ch)Fd.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Ib.status);else{Fd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Ib.status);if(ra.q0d){Ib=window.Hammer;if("undefined"===typeof Ib){Fd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");
ra.Ywc();return}if("undefined"===typeof Ib.inputHandler){Fd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");ra.Ywc();return}}if(!e)throw ra.Ywc(),Error.argumentNull("source element can not be null");Ib=Va.a.Jua(e,ra.vpa);if(void 0===Ib||null===Ib)Ib=new Nj.a,Va.a.zbb(e,ra.vpa,Ib),ra.G0i(e);var Gc=null;if(!Ib.wb(wj[0])){Gc=Object;var id=Gc.assign,Uc=new f,Vd=wj[0],Ye=Na;Ye=void 0===Ye?null:Ye;if(void 0===ra||null===ra)throw Fd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),
Error.argumentNull("manager can not be null");var Gf=null;switch(Vd){case Te.a.pinch:Gf=new Hammer.Pinch(Ye);break;case Te.a.pan:Gf=new Hammer.Pan(Ye)}Gf&&(Gf.manager=ra);Gc=id.call(Gc,Uc,{yca:Gf,xTe:C});Ib.add(wj[0],Gc)}if(void 0!==M&&null!==M)for(id=0;id<M.length;id++)Ib.wb(wj[M[id]])&&(Uc=Ib.na(wj[M[id]]),Gc.yca.recognizeWith(Uc.yca))}ra.Ywc()}):Fd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};d.prototype.txj=function(){this.hHc&&(this.vh?
this.FPc=this.vh.Fc("Task","RegisterGestureAdapterAfterLoad"):Fd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.Ywc=function(){this.hHc&&(this.FPc?this.FPc.stop():Fd.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};d.prototype.G0i=function(e){this.Jkg.add(e);this.Ud.Lja(this.TUa,e,0,this.ijb)};d.prototype.recognize=function(e){for(var C=Array(e.pointers.length),M=0;M<e.pointers.length;M++)C[M]=e.pointers[M].target;M=null;for(this.Roa=
this.cMh(C);void 0!==this.Roa&&null!==this.Roa&&(M=Va.a.Jua(this.Roa,this.vpa),void 0===M||null===M);this.Roa=this.Roa.parentNode);if(void 0!==M&&null!==M){this.curRecognizer&&this.curRecognizer.state===c.ifg&&(this.curRecognizer=null);C=yl(M.keys);for(var ra=C.next();!ra.done;ra=C.next()){ra=M.na(ra.value);void 0!==ra&&null!==ra&&void 0!==ra.yca&&null!==ra.yca&&(void 0===this.curRecognizer||null===this.curRecognizer||ra.yca===this.curRecognizer||ra.yca.canRecognizeWith(this.curRecognizer))&&ra.yca.recognize(e);
var Na=ra.yca.state;this.curRecognizer||c.ffg!==Na&&c.gfg!==Na&&c.hfg!==Na||(this.curRecognizer=ra.yca)}}};d.prototype.emit=function(e,C){if("hammer.input"!==e){this.k8=!1;C=n.create(e,this.Roa,C.srcEvent,C,3,this.WMc);var M=Va.a.Jua(this.Roa,this.vpa);if(this.rdi(e))var ra=0;else if(this.gdi(e))ra=1;else if(this.Yfi(e))ra=2;else{Fd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}M=M.Ec(wj[ra]).value;void 0!==M&&null!==M&&((M=M.xTe,M.cbi())?e.endsWith("start")?
this.k8=M.mDi(C):e.endsWith("end")?(M.kDi(C),this.k8=!0):e.endsWith("cancel")?(M.jDi(C),this.k8=!0):e.endsWith("move")&&(this.k8=M.lDi(C)):Fd.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",e))}};d.prototype.get=function(e){return Object(qc.a)(Hammer.Recognizer,e)};d.prototype.cMh=function(e){if(1>e.length)return null;if(1===e.length)return e[0];for(var C=e[0],M=!0,ra=1;ra<e.length;ra++){if(!e[ra])return null;if(C!==e[ra]){M=!1;break}}if(M)return C;C=this.OTe(e[0]);M=
0;e=yl(e);for(ra=e.next();!ra.done;ra=e.next()){ra=this.OTe(ra.value);if(C.na(C.count-1)!==ra.na(ra.count-1))return null;for(var Na=C.count-2,Ib=ra.count-2;Na>=M&&0<=Ib;Na--,Ib--)if(C.na(Na)!==ra.na(Ib)){M=Na+1;break}}return C.na(M)};d.prototype.OTe=function(e){for(var C=new mc.a;void 0!==e&&null!==e;e=e.parentNode)C.add(e);return C};d.prototype.yXe=function(e){switch(e){case Te.a.Ff:case Te.a.Gra:return 1;case Te.a.Ig:case Te.a.h_b:return 2;case Te.a.De:case Te.a.Rnb:return 4;case Te.a.Ayc:case Te.a.NWc:return 8}return 0};
d.prototype.cya=function(e,C,M){e=this.yXe(e);C=this.OKh(M);Hammer.inputHandler(this,e,C);this.k8&&M.preventDefault();return this.k8};d.prototype.Q3e=function(){return 1<this.zS.count};d.prototype.Y_b=function(){Fd.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.flb)for(var e=yl(this.zS),C=e.next();!C.done;C=e.next())this.ALf(C.value.key);else this.zS=new Nj.a;this.session=null};d.prototype.nxg=function(e,C,M){Fd.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
e);if(!this.Djb.wb(e)){try{C.setPointerCapture(e)}catch(ra){Fd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ra)}this.Djb.add(e,C)}this.zS.ia(e,M);this.YTa&&1<this.zS.count&&this.Kea&&!this.Kea.yob&&(this.Kea.yob=!0)};d.prototype.ALf=function(e){Fd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",e);if(this.Djb.wb(e)){try{this.Djb.na(e).releasePointerCapture(e)}catch(C){Fd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",C)}this.Djb.remove(e)}else Fd.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",e);this.zS.remove(e);this.YTa&&1>=this.zS.count&&this.Kea&&this.Kea.yob&&(this.Kea.yob=!1)};d.prototype.omc=function(e,C,M){var ra=M.rawEvent.pointerType.toString(),Na=M.rawEvent.pointerId.toString();if("touch"!==ra)return!1;e=this.yXe(e);if(1!==e&&!this.zS.wb(Na))return!1;this.w0d&&1===e&&M.rawEvent.isPrimary&&this.zS.count&&(Fd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Y_b());this.flb?this.nxg(Na,C,
M):this.zS.ia(Na,M);this.NKc&&2===e&&(!this.fEc||this.fEc&&"function"===typeof M.rawEvent.getCoalescedEvents)&&(C=M.rawEvent.getCoalescedEvents())&&this.Q3e()&&(this.Jib=Math.max(this.Jib,C.length));this.qce&&(this.k8=!1);ra=this.NKh(this.zS,M,ra);Hammer.inputHandler(this,e,ra);if(4===e||8===e)this.flb?this.ALf(Na):this.zS.remove(Na),this.zS.count||(this.session=null,this.NKc&&-1!==this.Jib&&(Fd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Jib),this.Jib=-1));this.k8&&
M.preventDefault();return this.k8};d.prototype.$lc=function(){return!1};d.prototype.OKh=function(e){var C=new k,M=e.rawEvent,ra=M.touches;M=M.changedTouches;C.pointers=Array.clone(ra);C.pointers=Array.clone(0<ra.length?ra:M);C.changedPointers=Array.clone(M);C.srcEvent=e;C.pointerType="touch";return C};d.prototype.NKh=function(e,C,M){var ra=new k;ra.pointers=ha.toArray(e.values);ra.changedPointers=[C];ra.pointerType=M;ra.srcEvent=C;return ra};d.prototype.rdi=function(e){return bh.a.startsWith(e,Te.a.pinch)};
d.prototype.gdi=function(e){return bh.a.startsWith(e,Te.a.pan)};d.prototype.Yfi=function(e){return bh.a.startsWith(e,Te.a.swipe)};Object(td.a)(d,"GestureInputManager",T.a,[576,577]);a.prototype.di=function(e){e.register(d,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").zc().Ic(function(){return new d(wh.a.instance,jd.AFrameworkApplication.sa.fD)});this.rb=e};a.prototype.init=function(){this.Hw||(this.rb.resolve("Common.App.GestureManager.GestureInputManager"),this.Hw=
!0)};a.prototype.dispose=function(){};a.main=function(){ub.a.instance.mj(new a)};tl.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(td.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");se.a.Yi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
ph.a.Ga(vc.ja);ph.a.Ga(Ea.ja);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Qe.main();se.a.Yi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){qg.initData();ph.a.Ga(function(e){Zf.ja(e);ad.ja(e);qg.ja(e);yd.ja(e)})})();se.a.Yi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
se.a.Yi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
ph.a.Ga(hc.ja);ph.a.Ga(ue.ja);ph.a.Ga(Bb.ja);se.a.Yi(".ewa-facp-text-box{position:absolute}");(function(){ph.a.Ga(function(e){Lc.ja(e)})})();(function(){ph.a.Ga(function(e){hd.ja(e)})})();ph.a.Ga(Yd.ja);ph.a.Ga(oc.ja);ph.a.Ga(bd.ja);se.a.Yi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
ph.a.Ga(Ac.ja);ph.a.Ga(mb.ja);(function(){ph.a.Ga(function(e){e.da.Ha(150,new Wa(e))})})();(function(){ph.a.Ga(function(e){pb.ja(e);Ta.ja(e);I.ja(e)})})();ph.a.Ga(x.ja);(function(){ph.a.Ga(function(e){A.ja(e)})})();(function(){ph.a.Ga(function(e){e.la(135)&&u.ja(e)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},843:function(y,D,b){function a(S,Y,ma,Z,xa,na,pa,Ia,Ma,lb,zb,Ya){var Wb=ca.call(this)||this;Wb.tjc=!1;Wb.contextMenuController=null;Wb.MGc=null;Wb.aEc=null;Wb.dmd=!1;Wb.oSj=
0;Wb.nSj=0;Wb.$qb=null;Wb.jsc=null;Wb.bC=function(){Wb.contextMenuController?Wb.contextMenuController.bC():d.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");Wb.B8f()};Wb.vb=S;Wb.qmf=xa;Wb.WNc=lb;Wb.JRj=ma;Wb.IRj=Z;Wb.oRj=Y;Wb.RDf=na;Wb.populateOnlyOnce=pa;Wb.DZh=zb;Wb.gKf(Ya);return Wb}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(892),k=b(88),n=b(23),l=b(864),f=b(845),u=b(998),v=b(914),
m=b(110),A=b(308),x=b(86),t=b(408),z=b(814);D=b(74);var r=b(16),G=b(4),w=b(976),B=b(78),U=b(43),N=b(57),P=b(141),ia=b(119),W=b(1),R=b(8),I=b(19),Q=b(14),O=b(20),ba=b(34),ca=D.a;vm(a,ca);a.prototype.Xc=function(S,Y){S=!0;switch(Y){case 1651433993:case 1675506831:case 966232027:S=this.te(4096)||this.te(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:S=this.te(8192)}return!S};a.prototype.fd=function(S,Y,ma){ma.IsShadowMenuOpen||w.h(this.$,w.d);S=!1;Y===this.Kt&&(ma.IsShadowMenuOpen||
w.h(this.$,w.a),Y=Object.assign(new c.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.tBd(Y,ma.IsShadowMenuOpen),ma.MenuItems=Y,ma.IsShadowMenuOpen||w.h(this.$,w.c),S=!0);S&&this.tjc&&R.HelperMethods.j_b&&!ma.IsShadowMenuOpen&&w.j(this.$);return S};a.prototype.tBd=function(S,Y){(Y=this.yY(Y))?(this.p6e(Y),Array.addRange(S.MenuSectionList,Y.JB().MenuSectionList),this.Gxg(S)):d.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};
a.prototype.yY=function(){d.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.VN=function(S,Y,ma,Z,xa){S=Sys.UI.DomElement.getBounds(Y);ma=new Sys.UI.Point(S.x,S.y+S.height);this.ISa(ma,Y);this.$.isChromeRtl&&(ma.x+=S.width);this.so(ma,xa)};a.prototype.so=function(S,Y,ma){ma=void 0===ma?0:ma;Y&&(S=ba.a(this.$).OJa(S));Y=!0;if(this.DZh){var Z;3===ma?(Z=this.BJa(3))&&0<Z.length?(Y=!1,this.showFloatie(Z,
new Sys.UI.Bounds(S.x,S.y,0,0),ma)):d.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===ma&&this.$.isEditMode&&((Z=this.BJa(2))&&0<Z.length?Z[0]!==a.kRe?(Y=!1,this.cPd(Z,new Sys.UI.Bounds(S.x,S.y,0,0),ma)):d.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):d.ULS.sendTraceTag(537167073,
0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}Y&&this.showContextMenu(new Sys.UI.Bounds(S.x,S.y,0,0),ma)};a.prototype.BJa=function(){return null};a.prototype.oed=function(S,Y){var ma="";3===S?ma="touch":2===S&&(ma="mouse");S={};return S.ContextMenuId=this.menuId,S.IsEditMode=this.$.isEditMode,S.IsSLR=!!N.a.Qf&&N.a.Qf.uC,S.IsReactMLR=!!N.a.Qf&&N.a.Qf.mV,S.IsNov=this.$.fa.isNamedObjectViewMode,
S.InputType=ma,S.FloatieGroups=JSON.stringify(void 0===Y?null:Y),S};a.prototype.showContextMenu=function(S,Y){Y=void 0===Y?0:Y;var ma=this.oed(Y);d.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(ma));this.contextMenuController?this.VA!==G.a.dEd&&this.VA!==G.a.eEd||!Y?this.contextMenuController.bPd(this.VA,S,B.a.Wb):this.contextMenuController.bPd(this.VA,S,Y):d.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};
a.prototype.showFloatie=function(S,Y,ma){var Z=this.oed(ma,S);d.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Z));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.mKf(),this.contextMenuController.Ovc(S,Y,ma)):d.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",
JSON.stringify(S))};a.prototype.cPd=function(S,Y,ma){var Z=this.oed(ma,S);d.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Z));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.mKf(),this.contextMenuController.aPd(S,Y,ma,this.VA)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};
a.prototype.gKf=function(S){this.contextMenuController=S};a.prototype.dispose=function(){this.$&&this.$.Ka.M$a(this);this.vb=null;W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.B8f();this.jsc&&(k.a.Fa(this.jsc),this.jsc=null);ca.prototype.dispose.call(this)};a.prototype.cAh=function(S){var Y=this.$.da.Aa(204);Y&&(Y=Y.KAh(this.qmf))&&Array.add(S.yc,Y)};a.prototype.ISa=function(S,Y){S&&Y&&this.$.fa.lc.isDivSyndicated&&n.a.Af&&(Y=Y.ownerDocument.documentElement,
S.x-=Y.scrollLeft,S.y-=Y.scrollTop)};a.prototype.te=function(S){return(new P.a(this.$.xa)).te(S)};a.prototype.p6e=function(S){S=yl(S.yc);for(var Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,Object(t.a)(477,Y)){Y.title&&(Y.title=a.ym(Y.title));Y=yl(Y.buttons);for(var ma=Y.next();!ma.done;ma=Y.next())ma=ma.value,Object(t.a)(389,ma)?(ma.label=a.ym(ma.label),ma.CR(a.ym(ma.alt))):Object(t.a)(509,ma)&&this.p6e(ma.menu)}};a.prototype.eud=function(S,Y){Y=void 0===Y?!1:Y;var ma=[];S=yl(S);for(var Z=S.next();!Z.done;Z=
S.next())ma.push(this.WT(Z.value,Y));return ma};a.prototype.WT=function(S){for(var Y=[],ma=yl(S.MenuItems),Z=ma.next();!Z.done;Z=ma.next())switch(Z=Z.value,Z.Type){case 3:Array.add(Y,this.yAe(Z,!1));break;case 2:W.EwaSettings.isChangeGateEnabled("OfficeVSO:5775701_ContextMenuToggleButtonFix")?Array.add(Y,this.S5g(Z)):Array.add(Y,this.yAe(Z,!0));break;case 1:Array.add(Y,this.J1g(Z))}return Object.assign(new l.a,{ControlList:Y,Title:S.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,
ShowMenuSectionTitleIcon:!0})};a.prototype.Lad=function(S,Y){Y=[this.$qb,S.RibbonCommand.toString(),Y||S.Label,S.Disabled?S.Disabled.toString():"False"];var ma=S.CommandData;ma=I.a.hashCode(ma).toString();Y.push(ma,S.Identifier.toString());Y=Y.join("_");S.IsChecked&&(Y+="_Checked");return Y};a.prototype.LAh=function(S){var Y=[this.$qb,I.a.hashCode(S.Title).toString()];S=yl(S.MenuItems);for(var ma=S.next();!ma.done;ma=S.next())Y.push(ma.value.RibbonCommand.toString());return Y.join("_")};a.prototype.aTe=
function(S){var Y=S.Label;Y=I.a.hashCode(Y).toString();Y=[this.$qb,Y];W.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&S.Id&&Y.push(I.a.hashCode(S.Id).toString());Y=Y.join("_");S.IsChecked&&(Y+="_Checked");return Y};a.prototype.yAe=function(S,Y){var ma=this.g9b(S,Y&&S.IsChecked);Y=ma.label;var Z=ma.HKa;ma=ma.$o;var xa=this.Lad(S,Y);return Object.assign(new f.a,{Command:S.Disabled?(-251203935).toString():ma.toString(),ExternalId:xa,Id:xa,Image16by16Class:Z,
LabelText:Y||S.Label,MenuItemId:S.CommandData,CommandValueId:S.CommandData})};a.prototype.S5g=function(S){var Y=this.g9b(S,S.IsChecked);var ma=Y.label;var Z=Y.HKa;Y=Y.$o;var xa=this.Lad(S,ma);return Object.assign(new u.a,{Command:S.Disabled?(-251203935).toString():Y.toString(),ExternalId:xa,Id:xa,Image16by16Class:Z,LabelText:ma||S.Label,MenuItemId:S.CommandData,CommandValueId:S.CommandData,IsChecked:S.IsChecked})};a.prototype.J1g=function(S){var Y=this.mTe(S);var ma=Y.label;Y=Y.HKa;var Z=Object.assign(new c.a,
{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(Z.MenuSectionList,this.eud(S.SubMenu.Sections,!0));var xa=this.aTe(S);S=ma||S.Label;return Object.assign(new v.a,{ExternalId:xa,Id:xa,LabelText:S,PopulateOnlyOnce:!1,Menu:Z,Image16by16Class:Y,ImageIsVisible:!!Y})};a.prototype.mTe=function(S){S=this.g9b(S,!0);return{label:S.label,HKa:S.HKa,$o:S.$o}};a.prototype.g9b=function(S,Y){var ma=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(S.Identifier){case 26:var Z=
912804500;Y=r.a.lNe;S=Q.a.instance.ea(1892);break;case 3:Z=-1902148570;Y=Y?r.a.F$:null;S=Q.a.instance.ea(1852);break;case 4:Z=-1902148570;Y=Y?r.a.F$:null;S=Q.a.instance.ea(1853);break;case 5:Z=-1902148570;Y=Y?r.a.F$:null;S=null;break;case 1:Z=-1677817820;Y=r.a.T6b;S=Q.a.instance.ea(231);break;case 2:Z=-1649376918;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(2055);break;case 23:Z=1701016594;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(2055);break;case 6:Z=-87741481;Y=null;S=Q.a.instance.ea(2056);break;
case 7:Z=1948650742;Y=r.a.aMe;S=Q.a.instance.ea(1890);break;case 8:Z=1933713114;Y=r.a.$Le;S=Q.a.instance.ea(1891);break;case 14:Z=504133448;Y=ma?r.a.D3:Y?r.a.Hta:r.a.D3;S=Q.a.instance.ea(144);break;case 30:Z=504133448;Y=ma?r.a.D3:Y?r.a.Hta:r.a.D3;S=Q.a.instance.ea(148);break;case 32:Z=504133448;Y=ma?r.a.D3:Y?r.a.Hta:r.a.D3;S=Q.a.instance.ea(150);break;case 34:Z=504133448;Y=ma?r.a.D3:Y?r.a.Hta:r.a.D3;S=Q.a.instance.ea(152);break;case 27:Z=1701016594;Y=Y?r.a.Hta:r.a.D3;S=Q.a.instance.ea(144);break;
case 15:Z=-798968736;Y=ma?r.a.E3:Y?r.a.Ita:r.a.E3;S=Q.a.instance.ea(146);break;case 31:Z=-798968736;Y=ma?r.a.E3:Y?r.a.Ita:r.a.E3;S=Q.a.instance.ea(149);break;case 33:Z=-798968736;Y=ma?r.a.E3:Y?r.a.Ita:r.a.E3;S=Q.a.instance.ea(151);break;case 35:Z=-798968736;Y=ma?r.a.E3:Y?r.a.Ita:r.a.E3;S=Q.a.instance.ea(153);break;case 28:Z=1701016594;Y=Y?r.a.Ita:r.a.E3;S=Q.a.instance.ea(146);break;case 21:Z=-2058042992;Y=r.a.g1a;S=null;break;case 29:Z=1701016594;Y=r.a.g1a;S=null;break;case 9:Z=1701016594;S=Y=null;
break;case 11:Z=-1494291901;S=Y=null;break;case 25:Z=-1045020714;Y=S.IsChecked?r.a.jia:null;S=null;break;case 13:Z=1701016594;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(155);break;case 16:Z=1701016594;Y=r.a.uIa;S=Q.a.instance.ea(1032);break;case 17:Z=1701016594;Y=r.a.Fta;S=null;break;case 18:Z=1701016594;Y=r.a.Eta;S=null;break;case 19:Z=1701016594;Y=r.a.f1a;S=Q.a.instance.ea(1037);break;case 20:Z=1701016594;Y=r.a.O7c;S=Q.a.instance.ea(1038);break;case 24:Z=1675506831;Y=ma?null:S.IsChecked?r.a.jia:
null;S=null;break;case 22:Z=S.RibbonCommand;Y=S.IsChecked?ma?r.a.F$:r.a.jia:null;S=null;break;case 36:Z=1461300262;Y=null;S=Q.a.instance.ea(154);break;default:d.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(S)),Z=1461300262,S=Y=null}return{label:S,HKa:Y,$o:Z}};a.prototype.Gxg=function(S){if(!this.$.fa.amIAlone){var Y=this.$.da.Aa(25);if((void 0!==Y&&null!==Y||!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!m.a.isEmpty(Y.dBa)&&(Y=Y.AUh(),
!A.a.yj(Y))){var ma=[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").j4g(Y,ma);Array.addRange(S.MenuSectionList,ma)}}};a.prototype.mKf=function(){this.dmd||(this.$sb&&this.$sb.NXb(this.bC),this.Fob&&this.Fob.NXb(this.bC),this.dmd=!!this.$sb||!!this.Fob)};a.prototype.B8f=function(){this.$sb&&this.$sb.Nqc(this.bC);this.Fob&&this.Fob.Nqc(this.bC);this.dmd=!1};a.a$b=function(S,Y,ma){Y=U.C(Y);var Z=O.g(S).Ca.oub(Y);Y=O.g(S).getCellBounds(Z);var xa=Z.vIg;Z=Z.uIg;var na=Y.x+xa.x;
Y=Y.y+xa.y;ma&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(O.g(S).rtl||(na+=Z),Y-=Z);return new Sys.UI.Point(na,Y)};a.Prh=function(S){try{Object(z.a)(S.CommandValueId)}catch(Y){}};a.ym=function(S){var Y=a.eta.parseFromString(S,"text/html");return Y?Y.body.innerText:(d.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),S)};tl.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.jsc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.WNc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Ib+this.qmf}},$sb:{configurable:!0,enumerable:!0,get:function(){this.MGc||(this.MGc=ia.a(this.$));return this.MGc}},Fob:{configurable:!0,enumerable:!0,get:function(){this.aEc||(this.aEc=O.g(this.$).Kc);return this.aEc}}});a.eta=new DOMParser;a.kRe="Unsupported";Object(y.a)(a,"ContextMenuBase",D.a,[147,
621,3])},929:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.TJe="ewa-ac";a.bih="ewa-ac-param";a.IKe="ewa-function-help-link";a.MKe="ewa-lb";a.BKe="ewa-fb-refactor";a.listItem="list-item";a.Qzb="list-item-selected";a.Uzb="list-table-touch";a.Tzb="list-table";a.yVg="columnName-header";a.zLe="ewa-tt";a.Wkh="ewa-function-link-container";a.JKe="ewa-function-udf-name";a.rtl="rtl";Object(y.a)(a,"CssClassNames",null,[])},938:function(y,D,b){function a(ca,S,Y){this.ZOb=null;this.gF=
{};this.PPb=this.zB=null;l.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=ca;this.A1d=a.g4c;this.B1d=a.borderStyleSolidLine;this.hi=S;this.Sa=Y;z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.kU=new d(this.$,this.hi);this.qH=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);l.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}",
"296")}function d(ca,S){var Y=this;this.EEb=this.ribbonCommandInfo=this.cellFormat=this.Ar=this.Nb=this.ha=null;this.Tpc=!1;this.fFf=this.RKa=this.pFf=this.n5d=this.Bya=this.Pla=null;this.c_b=this.lta=this.nFf=0;this.borderStyle=this.RYa=this.borderColor=null;this.yA=!1;this.I3b=this.R9a=null;this.O_=function(){if(!Y.yA||O.g(Y.$).Xy)Y.yA=!1,O.g(Y.$).Xy=!1,Y.lta=0,O.g(Y.$).Bh.Rt(v.a.saa),1===Y.$.Ka.LG()&&(O.g(Y.$).OU(G.a.clone(Y.pFf),Y.nFf,Y.$.oa?Y.$.oa.sheetName:null,null,Y.fFf.clone(),null,null,
0,Q.a.qdh,!0),O.g(Y.$).j0(!0)),Y.Xs(),Y.LUd(),Y.mm(),Y.Tpc=!1,Y.Pla=null,Y.Bya=null,Y.Ar&&(Y.Ar.cancel(),Y.Ar.dispose()),l.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ma){try{if(ma=Y.Fe(ma),O.g(Y.$).Xy=!0,Y.Pla={},Y.Bya={},Y.R9a=null,Y.Wnb(Y.c_b),2===ma.zb){var Z=O.g(Y.$).ha.gr(ma.clientPoint,ma.Sb,5,void 0,void 0,!1);Z&&(Y.RKa=Z,Y.I3b=Z,Y.q0i())}}catch(xa){O.g(Y.$).Xy=!1}return!0};this.Nj=function(ma){try{ma=Y.Fe(ma);var Z=
O.g(Y.$).ha.gr(ma.clientPoint,ma.Sb,5,void 0,void 0,!1),xa=O.g(Y.$).Ca.Mr(Z);if(!Y.EEb||xa&&(xa.SJ!==Y.EEb.SJ||xa.RJ!==Y.EEb.RJ))if(Y.yA=!0,Y.EEb=xa,Z){var na=new P.Range(Y.RKa.top,Y.RKa.left,Y.RKa.top,Y.RKa.left,!0,!1);na.union(Z);na=O.g(Y.$).ha.kPh(na);Y.g_b(Z);Y.RPf(Y.R9a,na);if(Y.bottomRightCorner(na.bottom,na.right))return l.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var pa=new P.Range(na.top,na.left,na.bottom+
1,na.right+1,!0,!1),Ia=O.g(Y.$).l$("DrawBorderBehavior.OnPointerMove",[pa]);if(Y.Pla&&Y.Bya)for(;Ia.$$mn();){var Ma=Ia.$$cu(),lb=Ma.cell.getRange().toString();lb in Y.Pla&&1!==Y.lta||(Y.Pla[lb]=Ma,Y.Bya[lb]=Ma.cell.BUe())}Y.R9a=pa;Y.I3b=na;O.g(Y.$).OU([na],0,Y.$.oa.sheetName,null,na.topLeft,null,null,0,Q.a.ndh,!0);Y.hi.gna(O.g(Y.$),-1690267012,Y.cellFormat,!0,null,[na])}return!0}catch(zb){return O.g(Y.$).Xy=!1}};this.Zg=function(ma){ma=Y.Fe(ma);(ma=O.g(Y.$).ha.gr(ma.clientPoint,ma.Sb,5,void 0,void 0,
!1))?Y.yA&&(Y.g_b(ma),Y.RKa.union(ma),3===Y.lta?Y.Wnb(0):Y.Wnb(Y.c_b),O.g(Y.$).OU([Y.RKa],0,Y.$.oa.sheetName,null,null,null,null,0,Q.a.odh,!0),Y.hi.formatCells(-1690267012,Y.cellFormat,Y.ribbonCommandInfo)):(3===Y.lta?Y.Wnb(0):Y.Wnb(Y.c_b),O.g(Y.$).OU([Y.I3b],0,Y.$.oa.sheetName,null,null,null,null,0,Q.a.pdh,!0),Y.hi.formatCells(-1690267012,Y.cellFormat,Y.ribbonCommandInfo));Y.yA=!1;Y.LUd();Y.Pla=null;Y.Bya=null;return!0};this.onKeyDown=function(ma){ma=Y.Fe(ma);if(Y.yA||Array.contains([17,16,18,20],
ma.Ea.keyCode))return!0;Y.O_();return!1};this.onKeyUp=function(ma){ma=Y.Fe(ma);if(ma.Ea.keyCode===w.a.lO&&Y.yA)return Y.yA=!1,Y.RPf(Y.R9a,Y.I3b,!0),Y.LUd(),!0;if(Y.yA||ma.Ea.keyCode===w.a.eBa||ma.Ea.keyCode===w.a.dZd||ma.Ea.keyCode===w.a.cZd||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ma.Ea.keyCode)||ma.Ea.keyCode===w.a.Kfg||ma.Ea.keyCode===w.a.Gfg||ma.Ea.keyCode===w.a.Dfg)return!0;Y.O_();return!1};this.Jxa=function(ma,Z){O.g(Y.$).Xy&&!Array.contains(Y.x1h,Z.ee.command)&&(l.ULS.sendTraceTag(537159512,
0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",Z.ee),Y.O_())};this.$=ca;this.hi=S}function c(ca){ca.wKf()}function k(){this.iconName=this.title=this.key=null}function n(ca,S,Y,ma,Z,xa,na,pa){this.ghg=ca;this.hhg=S;this.fhg=Y;this.XO=ma;this.jsg=Z;this.vog=xa;this.vib=na;this.qng=pa}b.r(D);y=b(0);var l=b(13),f=b(948),u=b(850),v=b(4),m=b(78),A=b(51),x=b(217),t=b(32),z=b(1),r=b(14);n.vLg=function(){return new n("BorderStyleSolidLine",1896,1,"1","",1,8,0)};n.rLg=function(){return new n("BorderStyleDashedLine",
1897,3,"1","5,3",1,8,0)};n.sLg=function(){return new n("BorderStyleDottedLine",1898,4,"1","1,1",1,8,0)};n.uLg=function(){return new n("BorderStyleMediumLine",1899,2,"2","",1,8,0)};n.wLg=function(){return new n("BorderStyleThickLine",1900,5,"3","",1,8,0)};n.tLg=function(){return new n("BorderStyleDoubleLine",1901,6,"1","",2,8,3)};tl.Object.defineProperties(n.prototype,{vre:{configurable:!0,enumerable:!0,get:function(){return this.ghg}},a_b:{configurable:!0,enumerable:!0,get:function(){return this.hhg}},
ure:{configurable:!0,enumerable:!0,get:function(){return this.fhg}},width:{configurable:!0,enumerable:!0,get:function(){return this.XO}},yyj:{configurable:!0,enumerable:!0,get:function(){return this.jsg}},zxi:{configurable:!0,enumerable:!0,get:function(){return this.vog}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.vib}},Cki:{configurable:!0,enumerable:!0,get:function(){return this.qng}}});Object(y.a)(n,"BorderLineStyleProperties",null,[]);Object(y.a)(k,"BorderLineStyleProps",
null,[]);c.prototype.getBorderLineStyleProps=function(){var ca=b(938).BorderFormatManager.QYa,S=Array(Object.keys(ca).length),Y=0,ma;for(ma in ca){var Z=ma,xa=ca[ma];S[Y]=new k;S[Y].key=Z;Z=xa;S[Y].title=r.a.instance.ea(Z.a_b);S[Y].iconName=Z.vre;Y++}return S};Object(y.a)(c,"BorderMenuController",null,[622]);var G=b(308),w=b(91),B=b(169),U=b(12),N=b(117),P=b(24),ia=b(44),W=b(42),R=b(202),I=b(8),Q=b(105),O=b(20),ba=b(34);d.prototype.Pug=function(ca){l.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");
this.ha=O.g(this.$).ha;this.Nb=O.g(this.$).Nb;this.ribbonCommandInfo=ca;this.pFf=G.a.clone(this.ha.va.selectedRanges);this.nFf=this.ha.va.wA;this.fFf=this.ha.va.activeCell.clone();this.Nb&&this.Nb.Hhd();this.Wu();this.ak()};d.prototype.dispose=function(){this.O_();this.EEb=this.ribbonCommandInfo=this.cellFormat=null};d.prototype.Wnb=function(ca){var S=b(938).BorderFormatManager;this.cellFormat={};var Y={};this.borderColor=this.borderColor||S.g4c;var ma=x.a.HG(this.borderColor,!1);Y.Color=[ma,ma,ma,
ma];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.RYa&&(Y.ThemeBorderColor=[this.RYa,this.RYa,this.RYa,this.RYa],Y.ColorTypeOption=1);ma=b(938).BorderFormatManager.QYa;this.borderStyle=this.borderStyle||S.borderStyleSolidLine;S=ma[this.borderStyle].ure;Y.LineStyle=[S,S,S,S];this.cellFormat.BorderFormat=Y;this.cellFormat.ValidMembers=128;this.cellFormat.Border=ca};d.prototype.Wu=function(){for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())B.a.instance.pa(U.a.pointerDown,
S.value.domElement,this.onPointerDown);N.KeyInputManager.instance.pa(U.a.Rb,document.documentElement,this.onKeyDown);N.KeyInputManager.instance.pa(U.a.Vd,document.documentElement,this.onKeyUp)};d.prototype.q0i=function(){for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())S=S.value,B.a.instance.pa(U.a.lh,S.domElement,this.Nj),B.a.instance.pa(U.a.Wd,S.domElement,this.Zg);B.a.instance.pa(U.a.Wd,document.documentElement,this.Zg);B.a.instance.pa(U.a.nz,document.documentElement,this.Zg);this.Tpc=
!0};d.prototype.Xs=function(){try{for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())B.a.instance.za(U.a.pointerDown,S.value.domElement,this.onPointerDown);N.KeyInputManager.instance.za(U.a.Rb,document.documentElement,this.onKeyDown);N.KeyInputManager.instance.za(U.a.Vd,document.documentElement,this.onKeyUp)}catch(Y){O.g(this.$).Xy=!1,l.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",Y)}};d.prototype.LUd=function(){if(this.Tpc)try{this.Tpc=
!1;for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next()){var Y=S.value;B.a.instance.za(U.a.lh,Y.domElement,this.Nj);B.a.instance.za(U.a.Wd,Y.domElement,this.Zg)}B.a.instance.za(U.a.Wd,document.documentElement,this.Zg);B.a.instance.za(U.a.nz,document.documentElement,this.Zg)}catch(ma){O.g(this.$).Xy=!1,l.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ma)}};d.prototype.ak=function(){this.$.xa.Pf(this.O_);O.g(this.$).Kc.wm(this.O_);
O.g(this.$).DD(this.O_);this.$.Ka.gmb(this.Jxa)};d.prototype.mm=function(){this.$.xa.rg(this.O_);O.g(this.$).Kc.im(this.O_);O.g(this.$).lF(this.O_);this.$.Ka.T$a(this.Jxa)};d.prototype.RPf=function(ca,S,Y){Y=void 0===Y?!1:Y;if(ca&&this.Pla&&this.Bya)for(ca=O.g(this.$).l$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[ca]);ca.$$mn();){var ma=ca.$$cu().cell.getRange();if(Y||!S.contains(ma)||1===this.lta){ma=ma.toString();var Z=t.a.Ec(this.Pla,ma);if(Z){var xa=t.a.Ec(this.Bya,ma);this.setBorders(Z,
xa);delete this.Pla[ma];delete this.Bya[ma]}}}};d.prototype.setBorders=function(ca,S){var Y=ca.cell,ma=Y.getRange();Y.YKf();ma.right!==this.R9a.right&&(Y=new P.Range(ma.top,ma.left-1,ma.bottom,ma.left-1,!0,!1),O.g(this.$).Ca.Mr(Y).QFd(3));ma.bottom!==this.R9a.bottom&&(Y=new P.Range(ma.top-1,ma.left,ma.top-1,ma.right,!0,!1),O.g(this.$).Ca.Mr(Y).QFd(1));if(null===S||void 0===S?0:S.Borders.length){var Z={};Y=0;for(var xa=Array(4),na=Array(4),pa=0;4>pa;pa++)xa[pa]=1,na[pa]=0;S=yl(S.Borders);for(pa=S.next();!pa.done;pa=
S.next()){pa=pa.value;var Ia=pa.BorderPosition;xa[Ia]=pa.BorderLineStyle;var Ma=new R.a(pa.Color.Red,pa.Color.Green,pa.Color.Blue);na[Ia]=Ma.y0();Y|=I.HelperMethods.xtb(pa.BorderPosition)}Z.LineStyle=xa;Z.Color=na;Z={BorderFormat:Z};Z.Border=Y;this.hi.qkj(ca,Z,ma)}};d.prototype.g_b=function(ca){var S=this,Y=new P.Range(Math.max(1,ca.top-1),Math.max(1,ca.left-1),ca.bottom+1,ca.right+1,!1,!1);O.g(this.$).hka(Y)||this.Ar&&this.Ar.Qo||(this.Ar=ia.a.instance.create(function(){O.g(S.$).yt(Y,60,Q.a.ldh)},
40,W.a.mdh))};d.prototype.bottomRightCorner=function(ca,S){return 1048576<=ca||16384<=S?!0:!1};d.prototype.Fe=function(ca){return ba.a(this.$).Fe(ca)};tl.Object.defineProperties(d.prototype,{x1h:{configurable:!0,enumerable:!0,get:function(){return this.n5d||(this.n5d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(y.a)(d,"DrawBorderBehavior",
null,[3]);b.d(D,"BorderFormatManager",function(){return a});a.prototype.p2e=function(ca,S){l.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",S.command.toString());var Y={},ma={};var Z=x.a.HG(this.X2,!1);ma.Color=[Z,Z,Z,Z];this.qH&&this.Isa&&(ma.ThemeBorderColor=[this.Isa,this.Isa,this.Isa,this.Isa],ma.ColorTypeOption=1);ca=-600086683===S.command?"OutsideBorders":ca[m.a.hd];ma.LineStyle=t.a.Ec(a.uEf,ca);ma.LineStyle?l.ULS.sendTraceTag(537159562,0,
50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",ca):(Z=a.QYa[this.eHa].ure,ma.LineStyle=[Z,Z,Z,Z],l.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.eHa));Z=t.a.Jn(a.rKg,ca,0);l.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",ca,this.X2);
Y.BorderFormat=ma;4!==Z&&8!==Z||!this.$.oa.displayRtl||(Z=4===Z?8:4);Y.ValidMembers=128;Y.Border=Z;this.hi.formatCells(-1690267012,Y,S);l.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",S.command.toString());return!0};a.prototype.qgd=function(ca,S,Y){l.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",ca.toString(),this.X2);if(this.qH){if((S.SqmControlId||"").includes("ThemeColorPicker")){var ma=
this.themesManager.getThemeColor(S.Color);var Z=ma.themeIndex;var xa=ma.AAa;ma.returnValue?(this.PPb={},this.Isa.ThemeColorIndex=Z,this.Isa.ThemeColorRow=xa):this.PPb=null}else this.PPb=null;this.kU.RYa=this.Isa}this.A1d=-1803452024===ca?a.g4c:S.Color;this.kU.borderColor=this.X2;this.iIe(Y);this.$.Gf();l.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",ca.toString(),this.X2);return!0};a.prototype.YXh=function(ca){l.ULS.sendTraceTag(537159559,0,
50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var S=this.Sa.zp(),Y=this.Sa.Lc();S.yc.push(Y);var ma=this.Sa.iA("StyleDashGallery",1,"Size120by20");Y.buttons.push(ma);Y=a.QYa;for(var Z in Y){var xa=Z,na=Y[Z],pa=r.a.instance.ea(na.a_b);ma.ht(xa,-2118943501,"QueryBorderStyle",na.a_b,xa,xa,void 0,void 0,pa)}l.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");ca.MenuItems=S.JB();l.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.AWh=
function(ca,S){l.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.eHa);ca=ca[m.a.hd];if(a.Qgi(ca))this.B1d=ca,l.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.eHa);else return l.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",ca),!0;this.kU.borderStyle=this.eHa;this.iIe(S);this.$.Gf();l.ULS.sendTraceTag(40944220,0,50,
"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.eHa);return!0};a.prototype.vgd=function(ca){l.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.DRc(ca,64,this.X2,86,1);return!0};a.prototype.wgd=function(ca){l.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.DRc(ca,112,this.X2,87,2);return!0};a.prototype.E2e=
function(ca){l.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.DRc(ca,112,"white",88,3);return!0};a.prototype.aYh=function(ca){this.$ij(this.sKg,ca,ca.MenuItemId?ca.MenuItemId:a.borderStyleSolidLine)};a.prototype.$ij=function(ca,S,Y){Y in ca?(ca=ca[Y],l.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",Y),this.bjj(S,ca)):l.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",
Y)};a.prototype.lYh=function(ca,S){var Y=ca[m.a.hd];return"DrawBorder"===Y?this.vgd(S):"DrawBorderGrid"===Y?this.wgd(S):"EraseBorder"===Y?this.E2e(S):this.p2e(ca,S)};a.prototype.wKf=function(){this.ZOb||this.xLg()};a.prototype.NDh=function(){return new c(this)};a.prototype.xLg=function(){this.ZOb={};var ca=0,S=a.QYa,Y={},ma;for(ma in S){Y.gea=S[ma];var Z=Y.gea.vre;r.a.instance.ea(Y.gea.a_b);var xa=function(na){return function(){return appChrome.buildBorderStyleIconNew(na.gea.yyj,na.gea.width,na.gea.zxi,
na.gea.lineHeight,na.gea.Cki)}}(Y);this.ZOb[Z]=Z;this.E$a(Z,xa);ca++;Y={gea:Y.gea}}};a.prototype.E$a=function(ca,S){if(!(ca in this.gF)){var Y={};S=S();Y[ca]=S;appChrome.api.registerIconProvider(function(){return Y});this.gF[ca]=!0}return ca};a.prototype.bjj=function(ca,S){ca.MenuItemId&&(ca[f.a.On]=ca.MenuItemId===this.eHa,ca[u.a.Icon]=S)};a.prototype.DRc=function(ca,S,Y,ma,Z){l.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");
this.oSg(ca,Z)?(l.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.kU.O_()):(O.g(this.$).Xy&&this.kU.O_(),A.a.current&&(ma=String.format(v.a.Nsa,A.a.current.co(ma)),O.g(this.$).Bh.Rt(ma)),this.kU.c_b=S,this.kU.borderColor=Y,O.g(this.$).Xy=!0,this.kU.Pug(ca),this.kU.lta=Z)};a.prototype.iIe=function(ca){if(ca)switch(this.kU.lta){case 2:this.wgd(ca);break;default:this.vgd(ca)}};a.prototype.oSg=function(ca,S){return this.kU.lta===
S&&-236759591!==ca.command&&-2118943501!==ca.command?!0:!1};a.Qgi=function(ca){return ca?ca in a.uEf||ca in a.QYa:!1};tl.Object.defineProperties(a.prototype,{eHa:{configurable:!0,enumerable:!0,get:function(){return this.B1d}},X2:{configurable:!0,enumerable:!0,get:function(){return this.A1d}},Isa:{configurable:!0,enumerable:!0,get:function(){return this.PPb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.zB||(this.zB=this.$.da.Aa(422));return this.zB}},sKg:{configurable:!0,enumerable:!0,
get:function(){this.wKf();return this.ZOb}}});tl.Object.defineProperties(a,{QYa:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.C_d||(a.C_d=(ca.BorderStyleSolidLine=n.vLg(),ca.BorderStyleDashedLine=n.rLg(),ca.BorderStyleDottedLine=n.sLg(),ca.BorderStyleMediumLine=n.uLg(),ca.BorderStyleThickLine=n.wLg(),ca.BorderStyleDoubleLine=n.tLg(),ca))}},rKg:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.B_d||(a.B_d=(ca.NoBorder=0,ca.BottomBorder=1,ca.TopBorder=2,ca.LeftBorder=
4,ca.RightBorder=8,ca.OutsideBorders=64,ca.AllBorders=112,ca.ThickOutsideBorders=64,ca.InsideBorders=48,ca.InsideHorizontalBorders=16,ca.InsideVerticalBorders=32,ca.BottomDoubleBorder=1,ca.ThickBottomBorder=1,ca.TopBottomBorder=3,ca.TopThickBottomBorder=3,ca.TopDoubleBottomBorder=3,ca))}},uEf:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.ibe||(a.ibe=(ca.ThickOutsideBorders=[2,2,2,2],ca.BottomDoubleBorder=[1,6,1,1],ca.ThickBottomBorder=[1,2,1,1],ca.TopBottomBorder=a.I8g,ca.TopThickBottomBorder=
[1,2,1,1],ca.TopDoubleBottomBorder=[1,6,1,1],ca))}}});a.B_d=null;a.C_d=null;a.ibe=null;a.g4c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.I8g=[1,1,1,1];Object(y.a)(a,"BorderFormatManager",null,[604])},976:function(y,D,b){function a(G,w,B){window.performance.measure(G,w,B);w=window.performance.getEntriesByName(G);w.length||v.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",G);return w[w.length-1]?w[w.length-1].duration:-1}function d(){if(m.a.Tnb){var G=
a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),w=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),B=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");v.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",G,w,B)}}function c(G,w){z.HelperMethods.QWc&&window.performance.mark(w)}function k(G){G=r.g(G).ha.va;return G.Dh&&(G.Qd.isRow||G.Qd.Lh)}function n(G){return G.Vb.R4(G.ha.va.activeCell)}
function l(G,w,B,U,N){G=U.sl("ContextMenuHelper.FindFirstCellInViewportArea",G,w,B);try{for(G.$$rst();G.$$mn();){var P=G.$$cu();if(P&&f(P,U,N))return P.cell}}finally{G&&G.dispose()}return null}function f(G,w,B){var U=w.rtl,N=B.isChromeRtl;G=G.cell;return(B=r.g(B).BJ(G))?(B=B.topLeft,U=B.x+=U===N?G.offsetWidth:0,N=B.y+=G.offsetHeight,w.view.visibleArea.contains(new x.a(U,N,0,0))):!1}function u(G,w){var B=G.sc(null);if((null===B||void 0===B?0:B.cell.tk)&&f(B,G,w))return G.getCellBounds(B.cell);B=G.ha.va.activeCell;
return(w=l(new t.Range(B.top,B.left,A.a.Fh,B.left,!1,!1),2,!0,G,w)||l(new t.Range(1,B.left,B.top,B.left,!1,!1),2,!1,G,w)||l(new t.Range(B.top,B.right,B.top,A.a.Qh,!1,!1),1,!0,G,w)||l(new t.Range(B.top,1,B.top,B.right,!1,!1),1,!1,G,w)||null)&&w.tk?G.getCellBounds(w):Sys.UI.DomElement.getBounds(G.Jvb.Jb)}b.d(D,"i",function(){return"ContextMenuPerf.A"});b.d(D,"b",function(){return"ContextMenuPerf.B"});b.d(D,"d",function(){return"ContextMenuPerf.C1"});b.d(D,"a",function(){return"ContextMenuPerf.C2"});
b.d(D,"c",function(){return"ContextMenuPerf.D"});b.d(D,"e",function(){return u});b.d(D,"f",function(){return n});b.d(D,"g",function(){return k});b.d(D,"h",function(){return c});b.d(D,"j",function(){return d});var v=b(13),m=b(315),A=b(9),x=b(58),t=b(24),z=b(8),r=b(20)},977:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.sIg="AutoFill";a.cbj="RowOperations";a.zVg="ColumnOperations";a.hOj="ViewModeRowOperations";
a.gOj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.mnj="ShapeStyle";a.Mwh="FloatingObjectClipboard";a.uDf="PivotTableCopyDelete";a.wDf="PivotTableFieldListActions";a.Cue="CellFloatie";a.inj="ShapeFloatie";a.contextMenu="ContextMenu";a.KVh="GridContextMenu";a.RQi="PivotTableContextMenu";a.Nwh="FloatingObjectContextMenu";a.tRg="CellRTEFloatie";a.QXf="ShapeRTEFloatie";Object(y.a)(a,"FloatieGroupIdentifiers",null,[])},978:function(y,D,b){function a(m,A,x){var t=
v.call(this,A)||this;t.KQ=!1;t.aic=!1;t.JMa=null;t._selectedRowListBox=null;t.zn=null;t.svf=function(z){return t.Klc(z)};t.wyd=function(z){f.g(z.Ea);t.raiseEvent(a.m3a);t.raiseEvent(a.JLd);return!0};t.onScroll=function(z){f.g(z);t.HDd();t.raiseEvent(a.m3a)};t.onBlur=function(z){f.g(z);t.HDd()};t.onPointerDown=function(){t.HDd();t.raiseEvent(a.m3a);t.raiseEvent(a.FOa);return!1};t.sCb=function(z){var r=z.Ea;r.button&&r.button!==Sys.UI.MouseButton.rightButton||(t.Nk=t.O9b(r),t.onPointerDown(z));t.raiseEvent(a.Dpd);
return!1};t.vb=m;t.Pzb=x;t.oAa(!0);return t}b.d(D,"a",function(){return a});y=b(0);var d=b(88),c=b(276),k=b(12),n=b(169);D=b(232);var l=b(11),f=b(69),u=b(20),v=D.a;vm(a,v);a.prototype.j9=function(m){this.get_events().addHandler(a.m3a,m)};a.prototype.Kca=function(m){this.get_events().removeHandler(a.m3a,m)};a.prototype.LXb=function(m){this.get_events().addHandler(a.Eid,m)};a.prototype.Lqc=function(m){this.get_events().removeHandler(a.Eid,m)};a.prototype.umb=function(m){this.get_events().addHandler(a.JLd,
m)};a.prototype.rGb=function(m){this.get_events().removeHandler(a.JLd,m)};a.prototype.HXa=function(m){this.get_events().addHandler(a.FOa,m)};a.prototype.$$a=function(m){this.get_events().removeHandler(a.FOa,m)};a.prototype.pTc=function(m){this.get_events().addHandler(a.Dpd,m)};a.prototype.SGd=function(m){this.get_events().removeHandler(a.Dpd,m)};a.prototype.dispose=function(){this.d7(!1);this.oAa(!1);d.a.pc([this.JMa]);this.JMa=null;v.prototype.dispose.call(this)};a.prototype.O9b=function(m){return l.DOMElementExtensions.zcd(m.target,
"tr",!0)};a.prototype.MA=function(m){if(m){if(!this.Nk){var A=this.zn;if(!A||!A.rows.length)return;this.Nk=A.rows[0];0<m?m--:m++}A=this.Nk;for(var x=0,t=Math.abs(m);x<t;x++)if(0>m){if(!A.previousSibling)break;A=A.previousSibling}else{if(!A.nextSibling)break;A=A.nextSibling}A&&(this.Nk=A)}};a.prototype.Zlb=function(m,A){l.DOMElementExtensions.toggleCssClass(m,this.Pzb.ListTableClassInTouch,A)};a.prototype.d7=function(m){var A=this.zn;A&&(m&&!this.aic?(c.a.instance.pa(k.a.click,A,this.svf),c.a.instance.pa(k.a.Ij,
A,this.wyd),n.a.instance.pa(k.a.pointerDown,A,this.sCb),this.aic=!0):this.aic&&(c.a.instance.za(k.a.click,A,this.svf),c.a.instance.za(k.a.Ij,A,this.wyd),n.a.instance.za(k.a.pointerDown,A,this.sCb),this.aic=!1))};a.prototype.GAa=function(m){var A=null;m&&(A=l.DOMElementExtensions.vj(m,this.Pzb.ListCellClass))&&A.classList.toggle(this.Pzb.ListCellSelectedClass);return A};a.prototype.oAa=function(m){this.dg&&(m&&!this.KQ?(this.JMa=this.Nd.Cd(this.dg),this.JMa.ja("scroll",this.onScroll),this.JMa.ja("blur",
this.onBlur),n.a.instance.pa(k.a.pointerDown,this.domElement,this.onPointerDown),this.KQ=!0):this.KQ&&(d.a.Fa(this.JMa),this.JMa=null,n.a.instance.za(k.a.pointerDown,this.domElement,this.onPointerDown),this.KQ=!1))};a.prototype.Klc=function(m){return this.wyd(m)};a.prototype.Psc=function(m){if(m){var A=m.offsetTop,x=this.dg.scrollTop;A<x?this.FSf(!0):A+m.offsetHeight>x+this.dg.clientHeight&&this.FSf(!1)}};a.prototype.FSf=function(m){this.dg.scrollTop=m?this.Nk.offsetTop:this.Nk.offsetTop+this.Nk.offsetHeight-
this.dg.clientHeight};a.prototype.HDd=function(){u.g(this.$).isEditing&&this.raiseEvent(a.Eid)};tl.Object.defineProperties(a.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(m){this.GAa(this._selectedRowListBox);m?(this._selectedRowListBox=m,this.GAa(this._selectedRowListBox),this.Psc(m)):this._selectedRowListBox=null}},QZ:{configurable:!0,enumerable:!0,get:function(){return this.Pzb.ListCellClass}},rba:{configurable:!0,enumerable:!0,get:function(){return this.Pzb.ListTableClass}},
xH:{configurable:!0,enumerable:!0,get:function(){return 8}},CAb:{configurable:!0,enumerable:!0,get:function(){return 5}},Zhc:{configurable:!0,enumerable:!0,get:function(){return 24}},Yhc:{configurable:!0,enumerable:!0,get:function(){return 35}},dg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.m3a="GotFocus";a.Eid="IgnoreBlur";a.JLd="SetCell";a.FOa="PointerDown";a.Dpd="ItemPointerDown";Object(y.a)(a,"ListBox",
D.a,[639,3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/80750b1f5cac7fd15e6c48e8d51ffcbc/EwaDS.kpae.js.map